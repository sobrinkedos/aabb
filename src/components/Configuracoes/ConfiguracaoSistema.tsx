import React, { useState } from 'react';\nimport { Save, Database, Server, Clock, Monitor, AlertTriangle } from 'lucide-react';\nimport { useConfiguracaoCategoria } from '../../hooks/useConfiguracaoHierarquica';\nimport { CategoriaConfiguracaoHierarquica } from '../../types/configuracoes';\n\nexport function ConfiguracaoSistema() {\n  const {\n    configuracao,\n    isLoading,\n    isSaving,\n    error,\n    successMessage,\n    temAcesso,\n    controleAcesso,\n    atualizarCampo,\n    salvar\n  } = useConfiguracaoCategoria(CategoriaConfiguracaoHierarquica.SISTEMA);\n\n  const [alteracoesPendentes, setAlteracoesPendentes] = useState(false);\n\n  if (isLoading) {\n    return (\n      <div className=\"flex items-center justify-center p-8\">\n        <div className=\"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600\"></div>\n      </div>\n    );\n  }\n\n  if (!temAcesso) {\n    return (\n      <div className=\"text-center p-8\">\n        <div className=\"text-red-500 mb-4\">\n          <Database className=\"w-12 h-12 mx-auto\" />\n        </div>\n        <h3 className=\"text-lg font-medium text-gray-900 mb-2\">\n          Acesso Restrito\n        </h3>\n        <p className=\"text-gray-600\">\n          Apenas Super Administradores podem acessar as configurações do sistema.\n        </p>\n        <div className=\"mt-4 p-4 bg-red-50 border border-red-200 rounded-lg\">\n          <p className=\"text-sm text-red-800\">\n            <strong>Motivo:</strong> Estas configurações afetam a infraestrutura e \n            performance do sistema inteiro.\n          </p>\n        </div>\n      </div>\n    );\n  }\n\n  const handleFieldChange = async (campo: string, valor: any) => {\n    await atualizarCampo(campo as any, valor);\n    setAlteracoesPendentes(true);\n  };\n\n  const handleSave = async () => {\n    const success = await salvar();\n    if (success) {\n      setAlteracoesPendentes(false);\n    }\n  };\n\n  return (\n    <div className=\"space-y-6\">\n      {/* Header */}\n      <div className=\"flex items-center justify-between\">\n        <div>\n          <h3 className=\"text-lg font-medium text-gray-900 flex items-center\">\n            <Database className=\"w-5 h-5 mr-2 text-blue-500\" />\n            {controleAcesso.descricao}\n          </h3>\n          {controleAcesso.alertaImpacto && (\n            <div className=\"mt-2 p-3 bg-amber-50 border border-amber-200 rounded-lg\">\n              <p className=\"text-sm text-amber-800\">\n                {controleAcesso.alertaImpacto}\n              </p>\n            </div>\n          )}\n        </div>\n        \n        <button\n          onClick={handleSave}\n          disabled={isSaving || !alteracoesPendentes}\n          className={`\n            inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm\n            ${alteracoesPendentes\n              ? 'text-white bg-blue-600 hover:bg-blue-700 focus:ring-blue-500'\n              : 'text-gray-400 bg-gray-200 cursor-not-allowed'\n            }\n            focus:outline-none focus:ring-2 focus:ring-offset-2 disabled:opacity-50\n          `}\n        >\n          {isSaving ? (\n            <>\n              <div className=\"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2\"></div>\n              Salvando...\n            </>\n          ) : (\n            <>\n              <Save className=\"w-4 h-4 mr-2\" />\n              Salvar Alterações\n            </>\n          )}\n        </button>\n      </div>\n\n      {/* Messages */}\n      {error && (\n        <div className=\"rounded-md bg-red-50 p-4\">\n          <div className=\"text-sm text-red-700\">{error}</div>\n        </div>\n      )}\n      \n      {successMessage && (\n        <div className=\"rounded-md bg-green-50 p-4\">\n          <div className=\"text-sm text-green-700\">{successMessage}</div>\n        </div>\n      )}\n\n      {/* Configurações de Backup */}\n      <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\n        <h4 className=\"text-md font-medium text-gray-900 mb-4 flex items-center\">\n          <Database className=\"w-4 h-4 mr-2\" />\n          Backup Automático\n        </h4>\n        \n        <div className=\"space-y-4\">\n          <label className=\"flex items-center\">\n            <input\n              type=\"checkbox\"\n              checked={configuracao.backup_automatico}\n              onChange={(e) => handleFieldChange('backup_automatico', e.target.checked)}\n              className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n            />\n            <span className=\"ml-2 text-sm text-gray-700\">\n              Habilitar backup automático\n            </span>\n          </label>\n\n          {configuracao.backup_automatico && (\n            <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mt-4 p-4 bg-gray-50 rounded-lg\">\n              {/* Frequência */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Frequência\n                </label>\n                <select\n                  value={configuracao.backup_frequencia}\n                  onChange={(e) => handleFieldChange('backup_frequencia', e.target.value)}\n                  className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                >\n                  <option value=\"diario\">Diário</option>\n                  <option value=\"semanal\">Semanal</option>\n                  <option value=\"mensal\">Mensal</option>\n                </select>\n              </div>\n\n              {/* Horário */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Horário\n                </label>\n                <input\n                  type=\"time\"\n                  value={configuracao.backup_horario}\n                  onChange={(e) => handleFieldChange('backup_horario', e.target.value)}\n                  className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                />\n              </div>\n\n              {/* Retenção */}\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Retenção (dias)\n                </label>\n                <input\n                  type=\"number\"\n                  min=\"7\"\n                  max=\"365\"\n                  value={configuracao.backup_retencao_dias}\n                  onChange={(e) => handleFieldChange('backup_retencao_dias', parseInt(e.target.value))}\n                  className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                />\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Configurações de Performance */}\n      <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\n        <h4 className=\"text-md font-medium text-gray-900 mb-4 flex items-center\">\n          <Server className=\"w-4 h-4 mr-2\" />\n          Performance e Cache\n        </h4>\n        \n        <div className=\"space-y-4\">\n          <label className=\"flex items-center\">\n            <input\n              type=\"checkbox\"\n              checked={configuracao.cache_habilitado}\n              onChange={(e) => handleFieldChange('cache_habilitado', e.target.checked)}\n              className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n            />\n            <span className=\"ml-2 text-sm text-gray-700\">\n              Habilitar cache do sistema\n            </span>\n          </label>\n\n          {configuracao.cache_habilitado && (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 p-4 bg-gray-50 rounded-lg\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  TTL do Cache (minutos)\n                </label>\n                <input\n                  type=\"number\"\n                  min=\"5\"\n                  max=\"1440\"\n                  value={configuracao.cache_ttl_minutos}\n                  onChange={(e) => handleFieldChange('cache_ttl_minutos', parseInt(e.target.value))}\n                  className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                />\n              </div>\n            </div>\n          )}\n\n          <label className=\"flex items-center\">\n            <input\n              type=\"checkbox\"\n              checked={configuracao.compressao_dados}\n              onChange={(e) => handleFieldChange('compressao_dados', e.target.checked)}\n              className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n            />\n            <span className=\"ml-2 text-sm text-gray-700\">\n              Habilitar compressão de dados\n            </span>\n          </label>\n        </div>\n      </div>\n\n      {/* Limites do Sistema */}\n      <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\n        <h4 className=\"text-md font-medium text-gray-900 mb-4 flex items-center\">\n          <AlertTriangle className=\"w-4 h-4 mr-2\" />\n          Limites do Sistema\n        </h4>\n        \n        <div className=\"grid grid-cols-1 md:grid-cols-3 gap-6\">\n          {/* Limite de Usuários */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Limite de Usuários\n            </label>\n            <input\n              type=\"number\"\n              min=\"10\"\n              max=\"10000\"\n              value={configuracao.limite_usuarios}\n              onChange={(e) => handleFieldChange('limite_usuarios', parseInt(e.target.value))}\n              className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            />\n          </div>\n\n          {/* Limite de Armazenamento */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Limite de Armazenamento (GB)\n            </label>\n            <input\n              type=\"number\"\n              min=\"1\"\n              max=\"1000\"\n              value={configuracao.limite_armazenamento_gb}\n              onChange={(e) => handleFieldChange('limite_armazenamento_gb', parseInt(e.target.value))}\n              className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            />\n          </div>\n\n          {/* Limite de Requisições */}\n          <div>\n            <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n              Requisições por Minuto\n            </label>\n            <input\n              type=\"number\"\n              min=\"100\"\n              max=\"10000\"\n              value={configuracao.limite_requisicoes_por_minuto}\n              onChange={(e) => handleFieldChange('limite_requisicoes_por_minuto', parseInt(e.target.value))}\n              className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n            />\n          </div>\n        </div>\n      </div>\n\n      {/* Manutenção Automática */}\n      <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\n        <h4 className=\"text-md font-medium text-gray-900 mb-4 flex items-center\">\n          <Clock className=\"w-4 h-4 mr-2\" />\n          Manutenção Automática\n        </h4>\n        \n        <div className=\"space-y-4\">\n          <label className=\"flex items-center\">\n            <input\n              type=\"checkbox\"\n              checked={configuracao.manutencao_automatica}\n              onChange={(e) => handleFieldChange('manutencao_automatica', e.target.checked)}\n              className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n            />\n            <span className=\"ml-2 text-sm text-gray-700\">\n              Habilitar manutenção automática\n            </span>\n          </label>\n\n          {configuracao.manutencao_automatica && (\n            <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4 p-4 bg-gray-50 rounded-lg\">\n              <div>\n                <label className=\"block text-sm font-medium text-gray-700 mb-2\">\n                  Horário da Manutenção\n                </label>\n                <input\n                  type=\"time\"\n                  value={configuracao.manutencao_horario}\n                  onChange={(e) => handleFieldChange('manutencao_horario', e.target.value)}\n                  className=\"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500\"\n                />\n                <p className=\"text-xs text-gray-500 mt-1\">\n                  Recomendado: horário de menor uso (madrugada)\n                </p>\n              </div>\n            </div>\n          )}\n\n          <label className=\"flex items-center\">\n            <input\n              type=\"checkbox\"\n              checked={configuracao.limpeza_logs_automatica}\n              onChange={(e) => handleFieldChange('limpeza_logs_automatica', e.target.checked)}\n              className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n            />\n            <span className=\"ml-2 text-sm text-gray-700\">\n              Limpeza automática de logs antigos\n            </span>\n          </label>\n        </div>\n      </div>\n\n      {/* Monitoramento */}\n      <div className=\"bg-white border border-gray-200 rounded-lg p-6\">\n        <h4 className=\"text-md font-medium text-gray-900 mb-4 flex items-center\">\n          <Monitor className=\"w-4 h-4 mr-2\" />\n          Monitoramento e Alertas\n        </h4>\n        \n        <div className=\"space-y-4\">\n          <label className=\"flex items-center\">\n            <input\n              type=\"checkbox\"\n              checked={configuracao.monitoramento_performance}\n              onChange={(e) => handleFieldChange('monitoramento_performance', e.target.checked)}\n              className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n            />\n            <span className=\"ml-2 text-sm text-gray-700\">\n              Monitoramento de performance\n            </span>\n          </label>\n\n          <label className=\"flex items-center\">\n            <input\n              type=\"checkbox\"\n              checked={configuracao.alertas_sistema}\n              onChange={(e) => handleFieldChange('alertas_sistema', e.target.checked)}\n              className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n            />\n            <span className=\"ml-2 text-sm text-gray-700\">\n              Alertas automáticos do sistema\n            </span>\n          </label>\n\n          <label className=\"flex items-center\">\n            <input\n              type=\"checkbox\"\n              checked={configuracao.notificar_erros_criticos}\n              onChange={(e) => handleFieldChange('notificar_erros_criticos', e.target.checked)}\n              className=\"rounded border-gray-300 text-blue-600 focus:ring-blue-500\"\n            />\n            <span className=\"ml-2 text-sm text-gray-700\">\n              Notificar erros críticos imediatamente\n            </span>\n          </label>\n        </div>\n      </div>\n\n      {/* Informações do Sistema */}\n      <div className=\"bg-blue-50 border border-blue-200 rounded-lg p-6\">\n        <h4 className=\"text-md font-medium text-blue-900 mb-4 flex items-center\">\n          <Monitor className=\"w-4 h-4 mr-2\" />\n          Informações do Sistema\n        </h4>\n        \n        <div className=\"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm\">\n          <div>\n            <span className=\"font-medium text-blue-800\">Versão do Sistema:</span>\n            <span className=\"ml-2 text-blue-700\">v2.1.0</span>\n          </div>\n          <div>\n            <span className=\"font-medium text-blue-800\">Última Atualização:</span>\n            <span className=\"ml-2 text-blue-700\">15/01/2024</span>\n          </div>\n          <div>\n            <span className=\"font-medium text-blue-800\">Uptime:</span>\n            <span className=\"ml-2 text-blue-700\">15 dias, 8 horas</span>\n          </div>\n          <div>\n            <span className=\"font-medium text-blue-800\">Uso de Memória:</span>\n            <span className=\"ml-2 text-blue-700\">2.1 GB / 8 GB</span>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}