var AC=Object.defineProperty;var MC=(t,s,a)=>s in t?AC(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var dt=(t,s,a)=>MC(t,typeof s!="symbol"?s+"":s,a);(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function a(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=a(o);fetch(o.href,l)}})();function __(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function RC(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var s=t.default;if(typeof s=="function"){var a=function r(){return this instanceof r?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};a.prototype=s.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var o=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(a,r,o.get?o:{enumerable:!0,get:function(){return t[r]}})}),a}var Hf={exports:{}},Zl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Ev;function OC(){if(Ev)return Zl;Ev=1;var t=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function a(r,o,l){var c=null;if(l!==void 0&&(c=""+l),o.key!==void 0&&(c=""+o.key),"key"in o){l={};for(var u in o)u!=="key"&&(l[u]=o[u])}else l=o;return o=l.ref,{$$typeof:t,type:r,key:c,ref:o!==void 0?o:null,props:l}}return Zl.Fragment=s,Zl.jsx=a,Zl.jsxs=a,Zl}var Cv;function DC(){return Cv||(Cv=1,Hf.exports=OC()),Hf.exports}var e=DC(),Gf={exports:{}},Xe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var kv;function PC(){if(kv)return Xe;kv=1;var t=Symbol.for("react.transitional.element"),s=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.iterator;function v(O){return O===null||typeof O!="object"?null:(O=g&&O[g]||O["@@iterator"],typeof O=="function"?O:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,w={};function E(O,H,B){this.props=O,this.context=H,this.refs=w,this.updater=B||b}E.prototype.isReactComponent={},E.prototype.setState=function(O,H){if(typeof O!="object"&&typeof O!="function"&&O!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,O,H,"setState")},E.prototype.forceUpdate=function(O){this.updater.enqueueForceUpdate(this,O,"forceUpdate")};function T(){}T.prototype=E.prototype;function N(O,H,B){this.props=O,this.context=H,this.refs=w,this.updater=B||b}var k=N.prototype=new T;k.constructor=N,_(k,E.prototype),k.isPureReactComponent=!0;var S=Array.isArray,C={H:null,A:null,T:null,S:null,V:null},M=Object.prototype.hasOwnProperty;function z(O,H,B,Y,ne,ie){return B=ie.ref,{$$typeof:t,type:O,key:H,ref:B!==void 0?B:null,props:ie}}function A(O,H){return z(O.type,H,void 0,void 0,void 0,O.props)}function $(O){return typeof O=="object"&&O!==null&&O.$$typeof===t}function P(O){var H={"=":"=0",":":"=2"};return"$"+O.replace(/[=:]/g,function(B){return H[B]})}var F=/\/+/g;function I(O,H){return typeof O=="object"&&O!==null&&O.key!=null?P(""+O.key):H.toString(36)}function J(){}function pe(O){switch(O.status){case"fulfilled":return O.value;case"rejected":throw O.reason;default:switch(typeof O.status=="string"?O.then(J,J):(O.status="pending",O.then(function(H){O.status==="pending"&&(O.status="fulfilled",O.value=H)},function(H){O.status==="pending"&&(O.status="rejected",O.reason=H)})),O.status){case"fulfilled":return O.value;case"rejected":throw O.reason}}throw O}function te(O,H,B,Y,ne){var ie=typeof O;(ie==="undefined"||ie==="boolean")&&(O=null);var oe=!1;if(O===null)oe=!0;else switch(ie){case"bigint":case"string":case"number":oe=!0;break;case"object":switch(O.$$typeof){case t:case s:oe=!0;break;case p:return oe=O._init,te(oe(O._payload),H,B,Y,ne)}}if(oe)return ne=ne(O),oe=Y===""?"."+I(O,0):Y,S(ne)?(B="",oe!=null&&(B=oe.replace(F,"$&/")+"/"),te(ne,H,B,"",function(q){return q})):ne!=null&&($(ne)&&(ne=A(ne,B+(ne.key==null||O&&O.key===ne.key?"":(""+ne.key).replace(F,"$&/")+"/")+oe)),H.push(ne)),1;oe=0;var me=Y===""?".":Y+":";if(S(O))for(var D=0;D<O.length;D++)Y=O[D],ie=me+I(Y,D),oe+=te(Y,H,B,ie,ne);else if(D=v(O),typeof D=="function")for(O=D.call(O),D=0;!(Y=O.next()).done;)Y=Y.value,ie=me+I(Y,D++),oe+=te(Y,H,B,ie,ne);else if(ie==="object"){if(typeof O.then=="function")return te(pe(O),H,B,Y,ne);throw H=String(O),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(O).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return oe}function L(O,H,B){if(O==null)return O;var Y=[],ne=0;return te(O,Y,"","",function(ie){return H.call(B,ie,ne++)}),Y}function G(O){if(O._status===-1){var H=O._result;H=H(),H.then(function(B){(O._status===0||O._status===-1)&&(O._status=1,O._result=B)},function(B){(O._status===0||O._status===-1)&&(O._status=2,O._result=B)}),O._status===-1&&(O._status=0,O._result=H)}if(O._status===1)return O._result.default;throw O._result}var ee=typeof reportError=="function"?reportError:function(O){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof O=="object"&&O!==null&&typeof O.message=="string"?String(O.message):String(O),error:O});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",O);return}console.error(O)};function xe(){}return Xe.Children={map:L,forEach:function(O,H,B){L(O,function(){H.apply(this,arguments)},B)},count:function(O){var H=0;return L(O,function(){H++}),H},toArray:function(O){return L(O,function(H){return H})||[]},only:function(O){if(!$(O))throw Error("React.Children.only expected to receive a single React element child.");return O}},Xe.Component=E,Xe.Fragment=a,Xe.Profiler=o,Xe.PureComponent=N,Xe.StrictMode=r,Xe.Suspense=h,Xe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,Xe.__COMPILER_RUNTIME={__proto__:null,c:function(O){return C.H.useMemoCache(O)}},Xe.cache=function(O){return function(){return O.apply(null,arguments)}},Xe.cloneElement=function(O,H,B){if(O==null)throw Error("The argument must be a React element, but you passed "+O+".");var Y=_({},O.props),ne=O.key,ie=void 0;if(H!=null)for(oe in H.ref!==void 0&&(ie=void 0),H.key!==void 0&&(ne=""+H.key),H)!M.call(H,oe)||oe==="key"||oe==="__self"||oe==="__source"||oe==="ref"&&H.ref===void 0||(Y[oe]=H[oe]);var oe=arguments.length-2;if(oe===1)Y.children=B;else if(1<oe){for(var me=Array(oe),D=0;D<oe;D++)me[D]=arguments[D+2];Y.children=me}return z(O.type,ne,void 0,void 0,ie,Y)},Xe.createContext=function(O){return O={$$typeof:c,_currentValue:O,_currentValue2:O,_threadCount:0,Provider:null,Consumer:null},O.Provider=O,O.Consumer={$$typeof:l,_context:O},O},Xe.createElement=function(O,H,B){var Y,ne={},ie=null;if(H!=null)for(Y in H.key!==void 0&&(ie=""+H.key),H)M.call(H,Y)&&Y!=="key"&&Y!=="__self"&&Y!=="__source"&&(ne[Y]=H[Y]);var oe=arguments.length-2;if(oe===1)ne.children=B;else if(1<oe){for(var me=Array(oe),D=0;D<oe;D++)me[D]=arguments[D+2];ne.children=me}if(O&&O.defaultProps)for(Y in oe=O.defaultProps,oe)ne[Y]===void 0&&(ne[Y]=oe[Y]);return z(O,ie,void 0,void 0,null,ne)},Xe.createRef=function(){return{current:null}},Xe.forwardRef=function(O){return{$$typeof:u,render:O}},Xe.isValidElement=$,Xe.lazy=function(O){return{$$typeof:p,_payload:{_status:-1,_result:O},_init:G}},Xe.memo=function(O,H){return{$$typeof:f,type:O,compare:H===void 0?null:H}},Xe.startTransition=function(O){var H=C.T,B={};C.T=B;try{var Y=O(),ne=C.S;ne!==null&&ne(B,Y),typeof Y=="object"&&Y!==null&&typeof Y.then=="function"&&Y.then(xe,ee)}catch(ie){ee(ie)}finally{C.T=H}},Xe.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},Xe.use=function(O){return C.H.use(O)},Xe.useActionState=function(O,H,B){return C.H.useActionState(O,H,B)},Xe.useCallback=function(O,H){return C.H.useCallback(O,H)},Xe.useContext=function(O){return C.H.useContext(O)},Xe.useDebugValue=function(){},Xe.useDeferredValue=function(O,H){return C.H.useDeferredValue(O,H)},Xe.useEffect=function(O,H,B){var Y=C.H;if(typeof B=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Y.useEffect(O,H)},Xe.useId=function(){return C.H.useId()},Xe.useImperativeHandle=function(O,H,B){return C.H.useImperativeHandle(O,H,B)},Xe.useInsertionEffect=function(O,H){return C.H.useInsertionEffect(O,H)},Xe.useLayoutEffect=function(O,H){return C.H.useLayoutEffect(O,H)},Xe.useMemo=function(O,H){return C.H.useMemo(O,H)},Xe.useOptimistic=function(O,H){return C.H.useOptimistic(O,H)},Xe.useReducer=function(O,H,B){return C.H.useReducer(O,H,B)},Xe.useRef=function(O){return C.H.useRef(O)},Xe.useState=function(O){return C.H.useState(O)},Xe.useSyncExternalStore=function(O,H,B){return C.H.useSyncExternalStore(O,H,B)},Xe.useTransition=function(){return C.H.useTransition()},Xe.version="19.1.0",Xe}var Tv;function C0(){return Tv||(Tv=1,Gf.exports=PC()),Gf.exports}var y=C0();const Ye=__(y);var Zf={exports:{}},Wl={},Wf={exports:{}},Yf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Av;function zC(){return Av||(Av=1,function(t){function s(L,G){var ee=L.length;L.push(G);e:for(;0<ee;){var xe=ee-1>>>1,O=L[xe];if(0<o(O,G))L[xe]=G,L[ee]=O,ee=xe;else break e}}function a(L){return L.length===0?null:L[0]}function r(L){if(L.length===0)return null;var G=L[0],ee=L.pop();if(ee!==G){L[0]=ee;e:for(var xe=0,O=L.length,H=O>>>1;xe<H;){var B=2*(xe+1)-1,Y=L[B],ne=B+1,ie=L[ne];if(0>o(Y,ee))ne<O&&0>o(ie,Y)?(L[xe]=ie,L[ne]=ee,xe=ne):(L[xe]=Y,L[B]=ee,xe=B);else if(ne<O&&0>o(ie,ee))L[xe]=ie,L[ne]=ee,xe=ne;else break e}}return G}function o(L,G){var ee=L.sortIndex-G.sortIndex;return ee!==0?ee:L.id-G.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}var h=[],f=[],p=1,g=null,v=3,b=!1,_=!1,w=!1,E=!1,T=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,k=typeof setImmediate<"u"?setImmediate:null;function S(L){for(var G=a(f);G!==null;){if(G.callback===null)r(f);else if(G.startTime<=L)r(f),G.sortIndex=G.expirationTime,s(h,G);else break;G=a(f)}}function C(L){if(w=!1,S(L),!_)if(a(h)!==null)_=!0,M||(M=!0,I());else{var G=a(f);G!==null&&te(C,G.startTime-L)}}var M=!1,z=-1,A=5,$=-1;function P(){return E?!0:!(t.unstable_now()-$<A)}function F(){if(E=!1,M){var L=t.unstable_now();$=L;var G=!0;try{e:{_=!1,w&&(w=!1,N(z),z=-1),b=!0;var ee=v;try{t:{for(S(L),g=a(h);g!==null&&!(g.expirationTime>L&&P());){var xe=g.callback;if(typeof xe=="function"){g.callback=null,v=g.priorityLevel;var O=xe(g.expirationTime<=L);if(L=t.unstable_now(),typeof O=="function"){g.callback=O,S(L),G=!0;break t}g===a(h)&&r(h),S(L)}else r(h);g=a(h)}if(g!==null)G=!0;else{var H=a(f);H!==null&&te(C,H.startTime-L),G=!1}}break e}finally{g=null,v=ee,b=!1}G=void 0}}finally{G?I():M=!1}}}var I;if(typeof k=="function")I=function(){k(F)};else if(typeof MessageChannel<"u"){var J=new MessageChannel,pe=J.port2;J.port1.onmessage=F,I=function(){pe.postMessage(null)}}else I=function(){T(F,0)};function te(L,G){z=T(function(){L(t.unstable_now())},G)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(L){L.callback=null},t.unstable_forceFrameRate=function(L){0>L||125<L?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<L?Math.floor(1e3/L):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_next=function(L){switch(v){case 1:case 2:case 3:var G=3;break;default:G=v}var ee=v;v=G;try{return L()}finally{v=ee}},t.unstable_requestPaint=function(){E=!0},t.unstable_runWithPriority=function(L,G){switch(L){case 1:case 2:case 3:case 4:case 5:break;default:L=3}var ee=v;v=L;try{return G()}finally{v=ee}},t.unstable_scheduleCallback=function(L,G,ee){var xe=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?xe+ee:xe):ee=xe,L){case 1:var O=-1;break;case 2:O=250;break;case 5:O=1073741823;break;case 4:O=1e4;break;default:O=5e3}return O=ee+O,L={id:p++,callback:G,priorityLevel:L,startTime:ee,expirationTime:O,sortIndex:-1},ee>xe?(L.sortIndex=ee,s(f,L),a(h)===null&&L===a(f)&&(w?(N(z),z=-1):w=!0,te(C,ee-xe))):(L.sortIndex=O,s(h,L),_||b||(_=!0,M||(M=!0,I()))),L},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(L){var G=v;return function(){var ee=v;v=G;try{return L.apply(this,arguments)}finally{v=ee}}}}(Yf)),Yf}var Mv;function $C(){return Mv||(Mv=1,Wf.exports=zC()),Wf.exports}var Kf={exports:{}},_s={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rv;function LC(){if(Rv)return _s;Rv=1;var t=C0();function s(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var r={d:{f:a,r:function(){throw Error(s(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(h,f,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:g==null?null:""+g,children:h,containerInfo:f,implementation:p}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return _s.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,_s.createPortal=function(h,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(s(299));return l(h,f,null,p)},_s.flushSync=function(h){var f=c.T,p=r.p;try{if(c.T=null,r.p=2,h)return h()}finally{c.T=f,r.p=p,r.d.f()}},_s.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(h,f))},_s.prefetchDNS=function(h){typeof h=="string"&&r.d.D(h)},_s.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var p=f.as,g=u(p,f.crossOrigin),v=typeof f.integrity=="string"?f.integrity:void 0,b=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?r.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:g,integrity:v,fetchPriority:b}):p==="script"&&r.d.X(h,{crossOrigin:g,integrity:v,fetchPriority:b,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},_s.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=u(f.as,f.crossOrigin);r.d.M(h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(h)},_s.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,g=u(p,f.crossOrigin);r.d.L(h,p,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},_s.preloadModule=function(h,f){if(typeof h=="string")if(f){var p=u(f.as,f.crossOrigin);r.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(h)},_s.requestFormReset=function(h){r.d.r(h)},_s.unstable_batchedUpdates=function(h,f){return h(f)},_s.useFormState=function(h,f,p){return c.H.useFormState(h,f,p)},_s.useFormStatus=function(){return c.H.useHostTransitionStatus()},_s.version="19.1.0",_s}var Ov;function IC(){if(Ov)return Kf.exports;Ov=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(s){console.error(s)}}return t(),Kf.exports=LC(),Kf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dv;function UC(){if(Dv)return Wl;Dv=1;var t=$C(),s=C0(),a=IC();function r(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)i+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var i=n,d=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(d=i.return),n=i.return;while(n)}return i.tag===3?d:null}function c(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function u(n){if(l(n)!==n)throw Error(r(188))}function h(n){var i=n.alternate;if(!i){if(i=l(n),i===null)throw Error(r(188));return i!==n?null:n}for(var d=n,m=i;;){var x=d.return;if(x===null)break;var j=x.alternate;if(j===null){if(m=x.return,m!==null){d=m;continue}break}if(x.child===j.child){for(j=x.child;j;){if(j===d)return u(x),n;if(j===m)return u(x),i;j=j.sibling}throw Error(r(188))}if(d.return!==m.return)d=x,m=j;else{for(var R=!1,U=x.child;U;){if(U===d){R=!0,d=x,m=j;break}if(U===m){R=!0,m=x,d=j;break}U=U.sibling}if(!R){for(U=j.child;U;){if(U===d){R=!0,d=j,m=x;break}if(U===m){R=!0,m=j,d=x;break}U=U.sibling}if(!R)throw Error(r(189))}}if(d.alternate!==m)throw Error(r(190))}if(d.tag!==3)throw Error(r(188));return d.stateNode.current===d?n:i}function f(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=f(n),i!==null)return i;n=n.sibling}return null}var p=Object.assign,g=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),T=Symbol.for("react.provider"),N=Symbol.for("react.consumer"),k=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),$=Symbol.for("react.activity"),P=Symbol.for("react.memo_cache_sentinel"),F=Symbol.iterator;function I(n){return n===null||typeof n!="object"?null:(n=F&&n[F]||n["@@iterator"],typeof n=="function"?n:null)}var J=Symbol.for("react.client.reference");function pe(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===J?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case _:return"Fragment";case E:return"Profiler";case w:return"StrictMode";case C:return"Suspense";case M:return"SuspenseList";case $:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case b:return"Portal";case k:return(n.displayName||"Context")+".Provider";case N:return(n._context.displayName||"Context")+".Consumer";case S:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case z:return i=n.displayName||null,i!==null?i:pe(n.type)||"Memo";case A:i=n._payload,n=n._init;try{return pe(n(i))}catch{}}return null}var te=Array.isArray,L=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,G=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},xe=[],O=-1;function H(n){return{current:n}}function B(n){0>O||(n.current=xe[O],xe[O]=null,O--)}function Y(n,i){O++,xe[O]=n.current,n.current=i}var ne=H(null),ie=H(null),oe=H(null),me=H(null);function D(n,i){switch(Y(oe,i),Y(ie,n),Y(ne,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?ev(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=ev(i),n=tv(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}B(ne),Y(ne,n)}function q(){B(ne),B(ie),B(oe)}function Q(n){n.memoizedState!==null&&Y(me,n);var i=ne.current,d=tv(i,n.type);i!==d&&(Y(ie,n),Y(ne,d))}function K(n){ie.current===n&&(B(ne),B(ie)),me.current===n&&(B(me),Vl._currentValue=ee)}var he=Object.prototype.hasOwnProperty,we=t.unstable_scheduleCallback,_e=t.unstable_cancelCallback,Re=t.unstable_shouldYield,ze=t.unstable_requestPaint,Ie=t.unstable_now,Me=t.unstable_getCurrentPriorityLevel,$e=t.unstable_ImmediatePriority,Z=t.unstable_UserBlockingPriority,se=t.unstable_NormalPriority,de=t.unstable_LowPriority,Ce=t.unstable_IdlePriority,ke=t.log,ye=t.unstable_setDisableYieldValue,Te=null,Oe=null;function Ge(n){if(typeof ke=="function"&&ye(n),Oe&&typeof Oe.setStrictMode=="function")try{Oe.setStrictMode(Te,n)}catch{}}var Je=Math.clz32?Math.clz32:W,rs=Math.log,Ue=Math.LN2;function W(n){return n>>>=0,n===0?32:31-(rs(n)/Ue|0)|0}var re=256,Ee=4194304;function Le(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function rt(n,i,d){var m=n.pendingLanes;if(m===0)return 0;var x=0,j=n.suspendedLanes,R=n.pingedLanes;n=n.warmLanes;var U=m&134217727;return U!==0?(m=U&~j,m!==0?x=Le(m):(R&=U,R!==0?x=Le(R):d||(d=U&~n,d!==0&&(x=Le(d))))):(U=m&~j,U!==0?x=Le(U):R!==0?x=Le(R):d||(d=m&~n,d!==0&&(x=Le(d)))),x===0?0:i!==0&&i!==x&&(i&j)===0&&(j=x&-x,d=i&-i,j>=d||j===32&&(d&4194048)!==0)?i:x}function Lt(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function Ta(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Or(){var n=re;return re<<=1,(re&4194048)===0&&(re=256),n}function Qi(){var n=Ee;return Ee<<=1,(Ee&62914560)===0&&(Ee=4194304),n}function po(n){for(var i=[],d=0;31>d;d++)i.push(n);return i}function Dr(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Wc(n,i,d,m,x,j){var R=n.pendingLanes;n.pendingLanes=d,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=d,n.entangledLanes&=d,n.errorRecoveryDisabledLanes&=d,n.shellSuspendCounter=0;var U=n.entanglements,X=n.expirationTimes,ue=n.hiddenUpdates;for(d=R&~d;0<d;){var ve=31-Je(d),Se=1<<ve;U[ve]=0,X[ve]=-1;var fe=ue[ve];if(fe!==null)for(ue[ve]=null,ve=0;ve<fe.length;ve++){var ge=fe[ve];ge!==null&&(ge.lane&=-536870913)}d&=~Se}m!==0&&Yc(n,m,0),j!==0&&x===0&&n.tag!==0&&(n.suspendedLanes|=j&~(R&~i))}function Yc(n,i,d){n.pendingLanes|=i,n.suspendedLanes&=~i;var m=31-Je(i);n.entangledLanes|=i,n.entanglements[m]=n.entanglements[m]|1073741824|d&4194090}function Dm(n,i){var d=n.entangledLanes|=i;for(n=n.entanglements;d;){var m=31-Je(d),x=1<<m;x&i|n[m]&i&&(n[m]|=i),d&=~x}}function bn(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Pm(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function Bg(){var n=G.p;return n!==0?n:(n=window.event,n===void 0?32:vv(n.type))}function bS(n,i){var d=G.p;try{return G.p=n,i()}finally{G.p=d}}var Pr=Math.random().toString(36).slice(2),ws="__reactFiber$"+Pr,As="__reactProps$"+Pr,go="__reactContainer$"+Pr,zm="__reactEvents$"+Pr,vS="__reactListeners$"+Pr,wS="__reactHandles$"+Pr,Vg="__reactResources$"+Pr,Ji="__reactMarker$"+Pr;function $m(n){delete n[ws],delete n[As],delete n[zm],delete n[vS],delete n[wS]}function xo(n){var i=n[ws];if(i)return i;for(var d=n.parentNode;d;){if(i=d[go]||d[ws]){if(d=i.alternate,i.child!==null||d!==null&&d.child!==null)for(n=nv(n);n!==null;){if(d=n[ws])return d;n=nv(n)}return i}n=d,d=n.parentNode}return null}function yo(n){if(n=n[ws]||n[go]){var i=n.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return n}return null}function el(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(r(33))}function bo(n){var i=n[Vg];return i||(i=n[Vg]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function us(n){n[Ji]=!0}var qg=new Set,Fg={};function vn(n,i){vo(n,i),vo(n+"Capture",i)}function vo(n,i){for(Fg[n]=i,n=0;n<i.length;n++)qg.add(i[n])}var jS=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Hg={},Gg={};function _S(n){return he.call(Gg,n)?!0:he.call(Hg,n)?!1:jS.test(n)?Gg[n]=!0:(Hg[n]=!0,!1)}function Kc(n,i,d){if(_S(i))if(d===null)n.removeAttribute(i);else{switch(typeof d){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var m=i.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+d)}}function Xc(n,i,d){if(d===null)n.removeAttribute(i);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+d)}}function Xa(n,i,d,m){if(m===null)n.removeAttribute(d);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(d);return}n.setAttributeNS(i,d,""+m)}}var Lm,Zg;function wo(n){if(Lm===void 0)try{throw Error()}catch(d){var i=d.stack.trim().match(/\n( *(at )?)/);Lm=i&&i[1]||"",Zg=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Lm+n+Zg}var Im=!1;function Um(n,i){if(!n||Im)return"";Im=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(i){var Se=function(){throw Error()};if(Object.defineProperty(Se.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Se,[])}catch(ge){var fe=ge}Reflect.construct(n,[],Se)}else{try{Se.call()}catch(ge){fe=ge}n.call(Se.prototype)}}else{try{throw Error()}catch(ge){fe=ge}(Se=n())&&typeof Se.catch=="function"&&Se.catch(function(){})}}catch(ge){if(ge&&fe&&typeof ge.stack=="string")return[ge.stack,fe.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var j=m.DetermineComponentFrameRoot(),R=j[0],U=j[1];if(R&&U){var X=R.split(`
`),ue=U.split(`
`);for(x=m=0;m<X.length&&!X[m].includes("DetermineComponentFrameRoot");)m++;for(;x<ue.length&&!ue[x].includes("DetermineComponentFrameRoot");)x++;if(m===X.length||x===ue.length)for(m=X.length-1,x=ue.length-1;1<=m&&0<=x&&X[m]!==ue[x];)x--;for(;1<=m&&0<=x;m--,x--)if(X[m]!==ue[x]){if(m!==1||x!==1)do if(m--,x--,0>x||X[m]!==ue[x]){var ve=`
`+X[m].replace(" at new "," at ");return n.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",n.displayName)),ve}while(1<=m&&0<=x);break}}}finally{Im=!1,Error.prepareStackTrace=d}return(d=n?n.displayName||n.name:"")?wo(d):""}function NS(n){switch(n.tag){case 26:case 27:case 5:return wo(n.type);case 16:return wo("Lazy");case 13:return wo("Suspense");case 19:return wo("SuspenseList");case 0:case 15:return Um(n.type,!1);case 11:return Um(n.type.render,!1);case 1:return Um(n.type,!0);case 31:return wo("Activity");default:return""}}function Wg(n){try{var i="";do i+=NS(n),n=n.return;while(n);return i}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}function Xs(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Yg(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function SS(n){var i=Yg(n)?"checked":"value",d=Object.getOwnPropertyDescriptor(n.constructor.prototype,i),m=""+n[i];if(!n.hasOwnProperty(i)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var x=d.get,j=d.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return x.call(this)},set:function(R){m=""+R,j.call(this,R)}}),Object.defineProperty(n,i,{enumerable:d.enumerable}),{getValue:function(){return m},setValue:function(R){m=""+R},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function Qc(n){n._valueTracker||(n._valueTracker=SS(n))}function Kg(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var d=i.getValue(),m="";return n&&(m=Yg(n)?n.checked?"true":"false":n.value),n=m,n!==d?(i.setValue(n),!0):!1}function Jc(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var ES=/[\n"\\]/g;function Qs(n){return n.replace(ES,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Bm(n,i,d,m,x,j,R,U){n.name="",R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"?n.type=R:n.removeAttribute("type"),i!=null?R==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+Xs(i)):n.value!==""+Xs(i)&&(n.value=""+Xs(i)):R!=="submit"&&R!=="reset"||n.removeAttribute("value"),i!=null?Vm(n,R,Xs(i)):d!=null?Vm(n,R,Xs(d)):m!=null&&n.removeAttribute("value"),x==null&&j!=null&&(n.defaultChecked=!!j),x!=null&&(n.checked=x&&typeof x!="function"&&typeof x!="symbol"),U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?n.name=""+Xs(U):n.removeAttribute("name")}function Xg(n,i,d,m,x,j,R,U){if(j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(n.type=j),i!=null||d!=null){if(!(j!=="submit"&&j!=="reset"||i!=null))return;d=d!=null?""+Xs(d):"",i=i!=null?""+Xs(i):d,U||i===n.value||(n.value=i),n.defaultValue=i}m=m??x,m=typeof m!="function"&&typeof m!="symbol"&&!!m,n.checked=U?n.checked:!!m,n.defaultChecked=!!m,R!=null&&typeof R!="function"&&typeof R!="symbol"&&typeof R!="boolean"&&(n.name=R)}function Vm(n,i,d){i==="number"&&Jc(n.ownerDocument)===n||n.defaultValue===""+d||(n.defaultValue=""+d)}function jo(n,i,d,m){if(n=n.options,i){i={};for(var x=0;x<d.length;x++)i["$"+d[x]]=!0;for(d=0;d<n.length;d++)x=i.hasOwnProperty("$"+n[d].value),n[d].selected!==x&&(n[d].selected=x),x&&m&&(n[d].defaultSelected=!0)}else{for(d=""+Xs(d),i=null,x=0;x<n.length;x++){if(n[x].value===d){n[x].selected=!0,m&&(n[x].defaultSelected=!0);return}i!==null||n[x].disabled||(i=n[x])}i!==null&&(i.selected=!0)}}function Qg(n,i,d){if(i!=null&&(i=""+Xs(i),i!==n.value&&(n.value=i),d==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=d!=null?""+Xs(d):""}function Jg(n,i,d,m){if(i==null){if(m!=null){if(d!=null)throw Error(r(92));if(te(m)){if(1<m.length)throw Error(r(93));m=m[0]}d=m}d==null&&(d=""),i=d}d=Xs(i),n.defaultValue=d,m=n.textContent,m===d&&m!==""&&m!==null&&(n.value=m)}function _o(n,i){if(i){var d=n.firstChild;if(d&&d===n.lastChild&&d.nodeType===3){d.nodeValue=i;return}}n.textContent=i}var CS=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function ex(n,i,d){var m=i.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?m?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":m?n.setProperty(i,d):typeof d!="number"||d===0||CS.has(i)?i==="float"?n.cssFloat=d:n[i]=(""+d).trim():n[i]=d+"px"}function tx(n,i,d){if(i!=null&&typeof i!="object")throw Error(r(62));if(n=n.style,d!=null){for(var m in d)!d.hasOwnProperty(m)||i!=null&&i.hasOwnProperty(m)||(m.indexOf("--")===0?n.setProperty(m,""):m==="float"?n.cssFloat="":n[m]="");for(var x in i)m=i[x],i.hasOwnProperty(x)&&d[x]!==m&&ex(n,x,m)}else for(var j in i)i.hasOwnProperty(j)&&ex(n,j,i[j])}function qm(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var kS=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),TS=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function ed(n){return TS.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}var Fm=null;function Hm(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var No=null,So=null;function sx(n){var i=yo(n);if(i&&(n=i.stateNode)){var d=n[As]||null;e:switch(n=i.stateNode,i.type){case"input":if(Bm(n,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),i=d.name,d.type==="radio"&&i!=null){for(d=n;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+Qs(""+i)+'"][type="radio"]'),i=0;i<d.length;i++){var m=d[i];if(m!==n&&m.form===n.form){var x=m[As]||null;if(!x)throw Error(r(90));Bm(m,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(i=0;i<d.length;i++)m=d[i],m.form===n.form&&Kg(m)}break e;case"textarea":Qg(n,d.value,d.defaultValue);break e;case"select":i=d.value,i!=null&&jo(n,!!d.multiple,i,!1)}}}var Gm=!1;function ax(n,i,d){if(Gm)return n(i,d);Gm=!0;try{var m=n(i);return m}finally{if(Gm=!1,(No!==null||So!==null)&&(Id(),No&&(i=No,n=So,So=No=null,sx(i),n)))for(i=0;i<n.length;i++)sx(n[i])}}function tl(n,i){var d=n.stateNode;if(d===null)return null;var m=d[As]||null;if(m===null)return null;d=m[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(n=n.type,m=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!m;break e;default:n=!1}if(n)return null;if(d&&typeof d!="function")throw Error(r(231,i,typeof d));return d}var Qa=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Zm=!1;if(Qa)try{var sl={};Object.defineProperty(sl,"passive",{get:function(){Zm=!0}}),window.addEventListener("test",sl,sl),window.removeEventListener("test",sl,sl)}catch{Zm=!1}var zr=null,Wm=null,td=null;function rx(){if(td)return td;var n,i=Wm,d=i.length,m,x="value"in zr?zr.value:zr.textContent,j=x.length;for(n=0;n<d&&i[n]===x[n];n++);var R=d-n;for(m=1;m<=R&&i[d-m]===x[j-m];m++);return td=x.slice(n,1<m?1-m:void 0)}function sd(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function ad(){return!0}function nx(){return!1}function Ms(n){function i(d,m,x,j,R){this._reactName=d,this._targetInst=x,this.type=m,this.nativeEvent=j,this.target=R,this.currentTarget=null;for(var U in n)n.hasOwnProperty(U)&&(d=n[U],this[U]=d?d(j):j[U]);return this.isDefaultPrevented=(j.defaultPrevented!=null?j.defaultPrevented:j.returnValue===!1)?ad:nx,this.isPropagationStopped=nx,this}return p(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=ad)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=ad)},persist:function(){},isPersistent:ad}),i}var wn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},rd=Ms(wn),al=p({},wn,{view:0,detail:0}),AS=Ms(al),Ym,Km,rl,nd=p({},al,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Qm,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==rl&&(rl&&n.type==="mousemove"?(Ym=n.screenX-rl.screenX,Km=n.screenY-rl.screenY):Km=Ym=0,rl=n),Ym)},movementY:function(n){return"movementY"in n?n.movementY:Km}}),ox=Ms(nd),MS=p({},nd,{dataTransfer:0}),RS=Ms(MS),OS=p({},al,{relatedTarget:0}),Xm=Ms(OS),DS=p({},wn,{animationName:0,elapsedTime:0,pseudoElement:0}),PS=Ms(DS),zS=p({},wn,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),$S=Ms(zS),LS=p({},wn,{data:0}),ix=Ms(LS),IS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},US={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},BS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function VS(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=BS[n])?!!i[n]:!1}function Qm(){return VS}var qS=p({},al,{key:function(n){if(n.key){var i=IS[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=sd(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?US[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Qm,charCode:function(n){return n.type==="keypress"?sd(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?sd(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),FS=Ms(qS),HS=p({},nd,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),lx=Ms(HS),GS=p({},al,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Qm}),ZS=Ms(GS),WS=p({},wn,{propertyName:0,elapsedTime:0,pseudoElement:0}),YS=Ms(WS),KS=p({},nd,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),XS=Ms(KS),QS=p({},wn,{newState:0,oldState:0}),JS=Ms(QS),eE=[9,13,27,32],Jm=Qa&&"CompositionEvent"in window,nl=null;Qa&&"documentMode"in document&&(nl=document.documentMode);var tE=Qa&&"TextEvent"in window&&!nl,cx=Qa&&(!Jm||nl&&8<nl&&11>=nl),dx=" ",ux=!1;function mx(n,i){switch(n){case"keyup":return eE.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function hx(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Eo=!1;function sE(n,i){switch(n){case"compositionend":return hx(i);case"keypress":return i.which!==32?null:(ux=!0,dx);case"textInput":return n=i.data,n===dx&&ux?null:n;default:return null}}function aE(n,i){if(Eo)return n==="compositionend"||!Jm&&mx(n,i)?(n=rx(),td=Wm=zr=null,Eo=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return cx&&i.locale!=="ko"?null:i.data;default:return null}}var rE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function fx(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!rE[n.type]:i==="textarea"}function px(n,i,d,m){No?So?So.push(m):So=[m]:No=m,i=Hd(i,"onChange"),0<i.length&&(d=new rd("onChange","change",null,d,m),n.push({event:d,listeners:i}))}var ol=null,il=null;function nE(n){Yb(n,0)}function od(n){var i=el(n);if(Kg(i))return n}function gx(n,i){if(n==="change")return i}var xx=!1;if(Qa){var eh;if(Qa){var th="oninput"in document;if(!th){var yx=document.createElement("div");yx.setAttribute("oninput","return;"),th=typeof yx.oninput=="function"}eh=th}else eh=!1;xx=eh&&(!document.documentMode||9<document.documentMode)}function bx(){ol&&(ol.detachEvent("onpropertychange",vx),il=ol=null)}function vx(n){if(n.propertyName==="value"&&od(il)){var i=[];px(i,il,n,Hm(n)),ax(nE,i)}}function oE(n,i,d){n==="focusin"?(bx(),ol=i,il=d,ol.attachEvent("onpropertychange",vx)):n==="focusout"&&bx()}function iE(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return od(il)}function lE(n,i){if(n==="click")return od(i)}function cE(n,i){if(n==="input"||n==="change")return od(i)}function dE(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var Is=typeof Object.is=="function"?Object.is:dE;function ll(n,i){if(Is(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var d=Object.keys(n),m=Object.keys(i);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var x=d[m];if(!he.call(i,x)||!Is(n[x],i[x]))return!1}return!0}function wx(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function jx(n,i){var d=wx(n);n=0;for(var m;d;){if(d.nodeType===3){if(m=n+d.textContent.length,n<=i&&m>=i)return{node:d,offset:i-n};n=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=wx(d)}}function _x(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?_x(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function Nx(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=Jc(n.document);i instanceof n.HTMLIFrameElement;){try{var d=typeof i.contentWindow.location.href=="string"}catch{d=!1}if(d)n=i.contentWindow;else break;i=Jc(n.document)}return i}function sh(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var uE=Qa&&"documentMode"in document&&11>=document.documentMode,Co=null,ah=null,cl=null,rh=!1;function Sx(n,i,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;rh||Co==null||Co!==Jc(m)||(m=Co,"selectionStart"in m&&sh(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),cl&&ll(cl,m)||(cl=m,m=Hd(ah,"onSelect"),0<m.length&&(i=new rd("onSelect","select",null,i,d),n.push({event:i,listeners:m}),i.target=Co)))}function jn(n,i){var d={};return d[n.toLowerCase()]=i.toLowerCase(),d["Webkit"+n]="webkit"+i,d["Moz"+n]="moz"+i,d}var ko={animationend:jn("Animation","AnimationEnd"),animationiteration:jn("Animation","AnimationIteration"),animationstart:jn("Animation","AnimationStart"),transitionrun:jn("Transition","TransitionRun"),transitionstart:jn("Transition","TransitionStart"),transitioncancel:jn("Transition","TransitionCancel"),transitionend:jn("Transition","TransitionEnd")},nh={},Ex={};Qa&&(Ex=document.createElement("div").style,"AnimationEvent"in window||(delete ko.animationend.animation,delete ko.animationiteration.animation,delete ko.animationstart.animation),"TransitionEvent"in window||delete ko.transitionend.transition);function _n(n){if(nh[n])return nh[n];if(!ko[n])return n;var i=ko[n],d;for(d in i)if(i.hasOwnProperty(d)&&d in Ex)return nh[n]=i[d];return n}var Cx=_n("animationend"),kx=_n("animationiteration"),Tx=_n("animationstart"),mE=_n("transitionrun"),hE=_n("transitionstart"),fE=_n("transitioncancel"),Ax=_n("transitionend"),Mx=new Map,oh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");oh.push("scrollEnd");function fa(n,i){Mx.set(n,i),vn(i,[n])}var Rx=new WeakMap;function Js(n,i){if(typeof n=="object"&&n!==null){var d=Rx.get(n);return d!==void 0?d:(i={value:n,source:i,stack:Wg(i)},Rx.set(n,i),i)}return{value:n,source:i,stack:Wg(i)}}var ea=[],To=0,ih=0;function id(){for(var n=To,i=ih=To=0;i<n;){var d=ea[i];ea[i++]=null;var m=ea[i];ea[i++]=null;var x=ea[i];ea[i++]=null;var j=ea[i];if(ea[i++]=null,m!==null&&x!==null){var R=m.pending;R===null?x.next=x:(x.next=R.next,R.next=x),m.pending=x}j!==0&&Ox(d,x,j)}}function ld(n,i,d,m){ea[To++]=n,ea[To++]=i,ea[To++]=d,ea[To++]=m,ih|=m,n.lanes|=m,n=n.alternate,n!==null&&(n.lanes|=m)}function lh(n,i,d,m){return ld(n,i,d,m),cd(n)}function Ao(n,i){return ld(n,null,null,i),cd(n)}function Ox(n,i,d){n.lanes|=d;var m=n.alternate;m!==null&&(m.lanes|=d);for(var x=!1,j=n.return;j!==null;)j.childLanes|=d,m=j.alternate,m!==null&&(m.childLanes|=d),j.tag===22&&(n=j.stateNode,n===null||n._visibility&1||(x=!0)),n=j,j=j.return;return n.tag===3?(j=n.stateNode,x&&i!==null&&(x=31-Je(d),n=j.hiddenUpdates,m=n[x],m===null?n[x]=[i]:m.push(i),i.lane=d|536870912),j):null}function cd(n){if(50<Dl)throw Dl=0,pf=null,Error(r(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var Mo={};function pE(n,i,d,m){this.tag=n,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Us(n,i,d,m){return new pE(n,i,d,m)}function ch(n){return n=n.prototype,!(!n||!n.isReactComponent)}function Ja(n,i){var d=n.alternate;return d===null?(d=Us(n.tag,i,n.key,n.mode),d.elementType=n.elementType,d.type=n.type,d.stateNode=n.stateNode,d.alternate=n,n.alternate=d):(d.pendingProps=i,d.type=n.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=n.flags&65011712,d.childLanes=n.childLanes,d.lanes=n.lanes,d.child=n.child,d.memoizedProps=n.memoizedProps,d.memoizedState=n.memoizedState,d.updateQueue=n.updateQueue,i=n.dependencies,d.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},d.sibling=n.sibling,d.index=n.index,d.ref=n.ref,d.refCleanup=n.refCleanup,d}function Dx(n,i){n.flags&=65011714;var d=n.alternate;return d===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=d.childLanes,n.lanes=d.lanes,n.child=d.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=d.memoizedProps,n.memoizedState=d.memoizedState,n.updateQueue=d.updateQueue,n.type=d.type,i=d.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function dd(n,i,d,m,x,j){var R=0;if(m=n,typeof n=="function")ch(n)&&(R=1);else if(typeof n=="string")R=xC(n,d,ne.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case $:return n=Us(31,d,i,x),n.elementType=$,n.lanes=j,n;case _:return Nn(d.children,x,j,i);case w:R=8,x|=24;break;case E:return n=Us(12,d,i,x|2),n.elementType=E,n.lanes=j,n;case C:return n=Us(13,d,i,x),n.elementType=C,n.lanes=j,n;case M:return n=Us(19,d,i,x),n.elementType=M,n.lanes=j,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case T:case k:R=10;break e;case N:R=9;break e;case S:R=11;break e;case z:R=14;break e;case A:R=16,m=null;break e}R=29,d=Error(r(130,n===null?"null":typeof n,"")),m=null}return i=Us(R,d,i,x),i.elementType=n,i.type=m,i.lanes=j,i}function Nn(n,i,d,m){return n=Us(7,n,m,i),n.lanes=d,n}function dh(n,i,d){return n=Us(6,n,null,i),n.lanes=d,n}function uh(n,i,d){return i=Us(4,n.children!==null?n.children:[],n.key,i),i.lanes=d,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var Ro=[],Oo=0,ud=null,md=0,ta=[],sa=0,Sn=null,er=1,tr="";function En(n,i){Ro[Oo++]=md,Ro[Oo++]=ud,ud=n,md=i}function Px(n,i,d){ta[sa++]=er,ta[sa++]=tr,ta[sa++]=Sn,Sn=n;var m=er;n=tr;var x=32-Je(m)-1;m&=~(1<<x),d+=1;var j=32-Je(i)+x;if(30<j){var R=x-x%5;j=(m&(1<<R)-1).toString(32),m>>=R,x-=R,er=1<<32-Je(i)+x|d<<x|m,tr=j+n}else er=1<<j|d<<x|m,tr=n}function mh(n){n.return!==null&&(En(n,1),Px(n,1,0))}function hh(n){for(;n===ud;)ud=Ro[--Oo],Ro[Oo]=null,md=Ro[--Oo],Ro[Oo]=null;for(;n===Sn;)Sn=ta[--sa],ta[sa]=null,tr=ta[--sa],ta[sa]=null,er=ta[--sa],ta[sa]=null}var Es=null,It=null,ct=!1,Cn=null,Aa=!1,fh=Error(r(519));function kn(n){var i=Error(r(418,""));throw ml(Js(i,n)),fh}function zx(n){var i=n.stateNode,d=n.type,m=n.memoizedProps;switch(i[ws]=n,i[As]=m,d){case"dialog":st("cancel",i),st("close",i);break;case"iframe":case"object":case"embed":st("load",i);break;case"video":case"audio":for(d=0;d<zl.length;d++)st(zl[d],i);break;case"source":st("error",i);break;case"img":case"image":case"link":st("error",i),st("load",i);break;case"details":st("toggle",i);break;case"input":st("invalid",i),Xg(i,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0),Qc(i);break;case"select":st("invalid",i);break;case"textarea":st("invalid",i),Jg(i,m.value,m.defaultValue,m.children),Qc(i)}d=m.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||i.textContent===""+d||m.suppressHydrationWarning===!0||Jb(i.textContent,d)?(m.popover!=null&&(st("beforetoggle",i),st("toggle",i)),m.onScroll!=null&&st("scroll",i),m.onScrollEnd!=null&&st("scrollend",i),m.onClick!=null&&(i.onclick=Gd),i=!0):i=!1,i||kn(n)}function $x(n){for(Es=n.return;Es;)switch(Es.tag){case 5:case 13:Aa=!1;return;case 27:case 3:Aa=!0;return;default:Es=Es.return}}function dl(n){if(n!==Es)return!1;if(!ct)return $x(n),ct=!0,!1;var i=n.tag,d;if((d=i!==3&&i!==27)&&((d=i===5)&&(d=n.type,d=!(d!=="form"&&d!=="button")||Mf(n.type,n.memoizedProps)),d=!d),d&&It&&kn(n),$x(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));e:{for(n=n.nextSibling,i=0;n;){if(n.nodeType===8)if(d=n.data,d==="/$"){if(i===0){It=ga(n.nextSibling);break e}i--}else d!=="$"&&d!=="$!"&&d!=="$?"||i++;n=n.nextSibling}It=null}}else i===27?(i=It,Qr(n.type)?(n=Pf,Pf=null,It=n):It=i):It=Es?ga(n.stateNode.nextSibling):null;return!0}function ul(){It=Es=null,ct=!1}function Lx(){var n=Cn;return n!==null&&(Ds===null?Ds=n:Ds.push.apply(Ds,n),Cn=null),n}function ml(n){Cn===null?Cn=[n]:Cn.push(n)}var ph=H(null),Tn=null,sr=null;function $r(n,i,d){Y(ph,i._currentValue),i._currentValue=d}function ar(n){n._currentValue=ph.current,B(ph)}function gh(n,i,d){for(;n!==null;){var m=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,m!==null&&(m.childLanes|=i)):m!==null&&(m.childLanes&i)!==i&&(m.childLanes|=i),n===d)break;n=n.return}}function xh(n,i,d,m){var x=n.child;for(x!==null&&(x.return=n);x!==null;){var j=x.dependencies;if(j!==null){var R=x.child;j=j.firstContext;e:for(;j!==null;){var U=j;j=x;for(var X=0;X<i.length;X++)if(U.context===i[X]){j.lanes|=d,U=j.alternate,U!==null&&(U.lanes|=d),gh(j.return,d,n),m||(R=null);break e}j=U.next}}else if(x.tag===18){if(R=x.return,R===null)throw Error(r(341));R.lanes|=d,j=R.alternate,j!==null&&(j.lanes|=d),gh(R,d,n),R=null}else R=x.child;if(R!==null)R.return=x;else for(R=x;R!==null;){if(R===n){R=null;break}if(x=R.sibling,x!==null){x.return=R.return,R=x;break}R=R.return}x=R}}function hl(n,i,d,m){n=null;for(var x=i,j=!1;x!==null;){if(!j){if((x.flags&524288)!==0)j=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var R=x.alternate;if(R===null)throw Error(r(387));if(R=R.memoizedProps,R!==null){var U=x.type;Is(x.pendingProps.value,R.value)||(n!==null?n.push(U):n=[U])}}else if(x===me.current){if(R=x.alternate,R===null)throw Error(r(387));R.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(n!==null?n.push(Vl):n=[Vl])}x=x.return}n!==null&&xh(i,n,d,m),i.flags|=262144}function hd(n){for(n=n.firstContext;n!==null;){if(!Is(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function An(n){Tn=n,sr=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function js(n){return Ix(Tn,n)}function fd(n,i){return Tn===null&&An(n),Ix(n,i)}function Ix(n,i){var d=i._currentValue;if(i={context:i,memoizedValue:d,next:null},sr===null){if(n===null)throw Error(r(308));sr=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else sr=sr.next=i;return d}var gE=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(d,m){n.push(m)}};this.abort=function(){i.aborted=!0,n.forEach(function(d){return d()})}},xE=t.unstable_scheduleCallback,yE=t.unstable_NormalPriority,ns={$$typeof:k,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function yh(){return{controller:new gE,data:new Map,refCount:0}}function fl(n){n.refCount--,n.refCount===0&&xE(yE,function(){n.controller.abort()})}var pl=null,bh=0,Do=0,Po=null;function bE(n,i){if(pl===null){var d=pl=[];bh=0,Do=jf(),Po={status:"pending",value:void 0,then:function(m){d.push(m)}}}return bh++,i.then(Ux,Ux),i}function Ux(){if(--bh===0&&pl!==null){Po!==null&&(Po.status="fulfilled");var n=pl;pl=null,Do=0,Po=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function vE(n,i){var d=[],m={status:"pending",value:null,reason:null,then:function(x){d.push(x)}};return n.then(function(){m.status="fulfilled",m.value=i;for(var x=0;x<d.length;x++)(0,d[x])(i)},function(x){for(m.status="rejected",m.reason=x,x=0;x<d.length;x++)(0,d[x])(void 0)}),m}var Bx=L.S;L.S=function(n,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&bE(n,i),Bx!==null&&Bx(n,i)};var Mn=H(null);function vh(){var n=Mn.current;return n!==null?n:wt.pooledCache}function pd(n,i){i===null?Y(Mn,Mn.current):Y(Mn,i.pool)}function Vx(){var n=vh();return n===null?null:{parent:ns._currentValue,pool:n}}var gl=Error(r(460)),qx=Error(r(474)),gd=Error(r(542)),wh={then:function(){}};function Fx(n){return n=n.status,n==="fulfilled"||n==="rejected"}function xd(){}function Hx(n,i,d){switch(d=n[d],d===void 0?n.push(i):d!==i&&(i.then(xd,xd),i=d),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Zx(n),n;default:if(typeof i.status=="string")i.then(xd,xd);else{if(n=wt,n!==null&&100<n.shellSuspendCounter)throw Error(r(482));n=i,n.status="pending",n.then(function(m){if(i.status==="pending"){var x=i;x.status="fulfilled",x.value=m}},function(m){if(i.status==="pending"){var x=i;x.status="rejected",x.reason=m}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Zx(n),n}throw xl=i,gl}}var xl=null;function Gx(){if(xl===null)throw Error(r(459));var n=xl;return xl=null,n}function Zx(n){if(n===gl||n===gd)throw Error(r(483))}var Lr=!1;function jh(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function _h(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ir(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Ur(n,i,d){var m=n.updateQueue;if(m===null)return null;if(m=m.shared,(ht&2)!==0){var x=m.pending;return x===null?i.next=i:(i.next=x.next,x.next=i),m.pending=i,i=cd(n),Ox(n,null,d),i}return ld(n,m,i,d),cd(n)}function yl(n,i,d){if(i=i.updateQueue,i!==null&&(i=i.shared,(d&4194048)!==0)){var m=i.lanes;m&=n.pendingLanes,d|=m,i.lanes=d,Dm(n,d)}}function Nh(n,i){var d=n.updateQueue,m=n.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var x=null,j=null;if(d=d.firstBaseUpdate,d!==null){do{var R={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};j===null?x=j=R:j=j.next=R,d=d.next}while(d!==null);j===null?x=j=i:j=j.next=i}else x=j=i;d={baseState:m.baseState,firstBaseUpdate:x,lastBaseUpdate:j,shared:m.shared,callbacks:m.callbacks},n.updateQueue=d;return}n=d.lastBaseUpdate,n===null?d.firstBaseUpdate=i:n.next=i,d.lastBaseUpdate=i}var Sh=!1;function bl(){if(Sh){var n=Po;if(n!==null)throw n}}function vl(n,i,d,m){Sh=!1;var x=n.updateQueue;Lr=!1;var j=x.firstBaseUpdate,R=x.lastBaseUpdate,U=x.shared.pending;if(U!==null){x.shared.pending=null;var X=U,ue=X.next;X.next=null,R===null?j=ue:R.next=ue,R=X;var ve=n.alternate;ve!==null&&(ve=ve.updateQueue,U=ve.lastBaseUpdate,U!==R&&(U===null?ve.firstBaseUpdate=ue:U.next=ue,ve.lastBaseUpdate=X))}if(j!==null){var Se=x.baseState;R=0,ve=ue=X=null,U=j;do{var fe=U.lane&-536870913,ge=fe!==U.lane;if(ge?(nt&fe)===fe:(m&fe)===fe){fe!==0&&fe===Do&&(Sh=!0),ve!==null&&(ve=ve.next={lane:0,tag:U.tag,payload:U.payload,callback:null,next:null});e:{var Ze=n,Fe=U;fe=i;var yt=d;switch(Fe.tag){case 1:if(Ze=Fe.payload,typeof Ze=="function"){Se=Ze.call(yt,Se,fe);break e}Se=Ze;break e;case 3:Ze.flags=Ze.flags&-65537|128;case 0:if(Ze=Fe.payload,fe=typeof Ze=="function"?Ze.call(yt,Se,fe):Ze,fe==null)break e;Se=p({},Se,fe);break e;case 2:Lr=!0}}fe=U.callback,fe!==null&&(n.flags|=64,ge&&(n.flags|=8192),ge=x.callbacks,ge===null?x.callbacks=[fe]:ge.push(fe))}else ge={lane:fe,tag:U.tag,payload:U.payload,callback:U.callback,next:null},ve===null?(ue=ve=ge,X=Se):ve=ve.next=ge,R|=fe;if(U=U.next,U===null){if(U=x.shared.pending,U===null)break;ge=U,U=ge.next,ge.next=null,x.lastBaseUpdate=ge,x.shared.pending=null}}while(!0);ve===null&&(X=Se),x.baseState=X,x.firstBaseUpdate=ue,x.lastBaseUpdate=ve,j===null&&(x.shared.lanes=0),Wr|=R,n.lanes=R,n.memoizedState=Se}}function Wx(n,i){if(typeof n!="function")throw Error(r(191,n));n.call(i)}function Yx(n,i){var d=n.callbacks;if(d!==null)for(n.callbacks=null,n=0;n<d.length;n++)Wx(d[n],i)}var zo=H(null),yd=H(0);function Kx(n,i){n=dr,Y(yd,n),Y(zo,i),dr=n|i.baseLanes}function Eh(){Y(yd,dr),Y(zo,zo.current)}function Ch(){dr=yd.current,B(zo),B(yd)}var Br=0,Qe=null,gt=null,Xt=null,bd=!1,$o=!1,Rn=!1,vd=0,wl=0,Lo=null,wE=0;function qt(){throw Error(r(321))}function kh(n,i){if(i===null)return!1;for(var d=0;d<i.length&&d<n.length;d++)if(!Is(n[d],i[d]))return!1;return!0}function Th(n,i,d,m,x,j){return Br=j,Qe=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,L.H=n===null||n.memoizedState===null?Oy:Dy,Rn=!1,j=d(m,x),Rn=!1,$o&&(j=Qx(i,d,m,x)),Xx(n),j}function Xx(n){L.H=Ed;var i=gt!==null&&gt.next!==null;if(Br=0,Xt=gt=Qe=null,bd=!1,wl=0,Lo=null,i)throw Error(r(300));n===null||ms||(n=n.dependencies,n!==null&&hd(n)&&(ms=!0))}function Qx(n,i,d,m){Qe=n;var x=0;do{if($o&&(Lo=null),wl=0,$o=!1,25<=x)throw Error(r(301));if(x+=1,Xt=gt=null,n.updateQueue!=null){var j=n.updateQueue;j.lastEffect=null,j.events=null,j.stores=null,j.memoCache!=null&&(j.memoCache.index=0)}L.H=kE,j=i(d,m)}while($o);return j}function jE(){var n=L.H,i=n.useState()[0];return i=typeof i.then=="function"?jl(i):i,n=n.useState()[0],(gt!==null?gt.memoizedState:null)!==n&&(Qe.flags|=1024),i}function Ah(){var n=vd!==0;return vd=0,n}function Mh(n,i,d){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~d}function Rh(n){if(bd){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}bd=!1}Br=0,Xt=gt=Qe=null,$o=!1,wl=vd=0,Lo=null}function Rs(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xt===null?Qe.memoizedState=Xt=n:Xt=Xt.next=n,Xt}function Qt(){if(gt===null){var n=Qe.alternate;n=n!==null?n.memoizedState:null}else n=gt.next;var i=Xt===null?Qe.memoizedState:Xt.next;if(i!==null)Xt=i,gt=n;else{if(n===null)throw Qe.alternate===null?Error(r(467)):Error(r(310));gt=n,n={memoizedState:gt.memoizedState,baseState:gt.baseState,baseQueue:gt.baseQueue,queue:gt.queue,next:null},Xt===null?Qe.memoizedState=Xt=n:Xt=Xt.next=n}return Xt}function Oh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function jl(n){var i=wl;return wl+=1,Lo===null&&(Lo=[]),n=Hx(Lo,n,i),i=Qe,(Xt===null?i.memoizedState:Xt.next)===null&&(i=i.alternate,L.H=i===null||i.memoizedState===null?Oy:Dy),n}function wd(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return jl(n);if(n.$$typeof===k)return js(n)}throw Error(r(438,String(n)))}function Dh(n){var i=null,d=Qe.updateQueue;if(d!==null&&(i=d.memoCache),i==null){var m=Qe.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(i={data:m.data.map(function(x){return x.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),d===null&&(d=Oh(),Qe.updateQueue=d),d.memoCache=i,d=i.data[i.index],d===void 0)for(d=i.data[i.index]=Array(n),m=0;m<n;m++)d[m]=P;return i.index++,d}function rr(n,i){return typeof i=="function"?i(n):i}function jd(n){var i=Qt();return Ph(i,gt,n)}function Ph(n,i,d){var m=n.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=d;var x=n.baseQueue,j=m.pending;if(j!==null){if(x!==null){var R=x.next;x.next=j.next,j.next=R}i.baseQueue=x=j,m.pending=null}if(j=n.baseState,x===null)n.memoizedState=j;else{i=x.next;var U=R=null,X=null,ue=i,ve=!1;do{var Se=ue.lane&-536870913;if(Se!==ue.lane?(nt&Se)===Se:(Br&Se)===Se){var fe=ue.revertLane;if(fe===0)X!==null&&(X=X.next={lane:0,revertLane:0,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null}),Se===Do&&(ve=!0);else if((Br&fe)===fe){ue=ue.next,fe===Do&&(ve=!0);continue}else Se={lane:0,revertLane:ue.revertLane,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},X===null?(U=X=Se,R=j):X=X.next=Se,Qe.lanes|=fe,Wr|=fe;Se=ue.action,Rn&&d(j,Se),j=ue.hasEagerState?ue.eagerState:d(j,Se)}else fe={lane:Se,revertLane:ue.revertLane,action:ue.action,hasEagerState:ue.hasEagerState,eagerState:ue.eagerState,next:null},X===null?(U=X=fe,R=j):X=X.next=fe,Qe.lanes|=Se,Wr|=Se;ue=ue.next}while(ue!==null&&ue!==i);if(X===null?R=j:X.next=U,!Is(j,n.memoizedState)&&(ms=!0,ve&&(d=Po,d!==null)))throw d;n.memoizedState=j,n.baseState=R,n.baseQueue=X,m.lastRenderedState=j}return x===null&&(m.lanes=0),[n.memoizedState,m.dispatch]}function zh(n){var i=Qt(),d=i.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=n;var m=d.dispatch,x=d.pending,j=i.memoizedState;if(x!==null){d.pending=null;var R=x=x.next;do j=n(j,R.action),R=R.next;while(R!==x);Is(j,i.memoizedState)||(ms=!0),i.memoizedState=j,i.baseQueue===null&&(i.baseState=j),d.lastRenderedState=j}return[j,m]}function Jx(n,i,d){var m=Qe,x=Qt(),j=ct;if(j){if(d===void 0)throw Error(r(407));d=d()}else d=i();var R=!Is((gt||x).memoizedState,d);R&&(x.memoizedState=d,ms=!0),x=x.queue;var U=sy.bind(null,m,x,n);if(_l(2048,8,U,[n]),x.getSnapshot!==i||R||Xt!==null&&Xt.memoizedState.tag&1){if(m.flags|=2048,Io(9,_d(),ty.bind(null,m,x,d,i),null),wt===null)throw Error(r(349));j||(Br&124)!==0||ey(m,i,d)}return d}function ey(n,i,d){n.flags|=16384,n={getSnapshot:i,value:d},i=Qe.updateQueue,i===null?(i=Oh(),Qe.updateQueue=i,i.stores=[n]):(d=i.stores,d===null?i.stores=[n]:d.push(n))}function ty(n,i,d,m){i.value=d,i.getSnapshot=m,ay(i)&&ry(n)}function sy(n,i,d){return d(function(){ay(i)&&ry(n)})}function ay(n){var i=n.getSnapshot;n=n.value;try{var d=i();return!Is(n,d)}catch{return!0}}function ry(n){var i=Ao(n,2);i!==null&&Hs(i,n,2)}function $h(n){var i=Rs();if(typeof n=="function"){var d=n;if(n=d(),Rn){Ge(!0);try{d()}finally{Ge(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:n},i}function ny(n,i,d,m){return n.baseState=d,Ph(n,gt,typeof m=="function"?m:rr)}function _E(n,i,d,m,x){if(Sd(n))throw Error(r(485));if(n=i.action,n!==null){var j={payload:x,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(R){j.listeners.push(R)}};L.T!==null?d(!0):j.isTransition=!1,m(j),d=i.pending,d===null?(j.next=i.pending=j,oy(i,j)):(j.next=d.next,i.pending=d.next=j)}}function oy(n,i){var d=i.action,m=i.payload,x=n.state;if(i.isTransition){var j=L.T,R={};L.T=R;try{var U=d(x,m),X=L.S;X!==null&&X(R,U),iy(n,i,U)}catch(ue){Lh(n,i,ue)}finally{L.T=j}}else try{j=d(x,m),iy(n,i,j)}catch(ue){Lh(n,i,ue)}}function iy(n,i,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(m){ly(n,i,m)},function(m){return Lh(n,i,m)}):ly(n,i,d)}function ly(n,i,d){i.status="fulfilled",i.value=d,cy(i),n.state=d,i=n.pending,i!==null&&(d=i.next,d===i?n.pending=null:(d=d.next,i.next=d,oy(n,d)))}function Lh(n,i,d){var m=n.pending;if(n.pending=null,m!==null){m=m.next;do i.status="rejected",i.reason=d,cy(i),i=i.next;while(i!==m)}n.action=null}function cy(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function dy(n,i){return i}function uy(n,i){if(ct){var d=wt.formState;if(d!==null){e:{var m=Qe;if(ct){if(It){t:{for(var x=It,j=Aa;x.nodeType!==8;){if(!j){x=null;break t}if(x=ga(x.nextSibling),x===null){x=null;break t}}j=x.data,x=j==="F!"||j==="F"?x:null}if(x){It=ga(x.nextSibling),m=x.data==="F!";break e}}kn(m)}m=!1}m&&(i=d[0])}}return d=Rs(),d.memoizedState=d.baseState=i,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:dy,lastRenderedState:i},d.queue=m,d=Ay.bind(null,Qe,m),m.dispatch=d,m=$h(!1),j=qh.bind(null,Qe,!1,m.queue),m=Rs(),x={state:i,dispatch:null,action:n,pending:null},m.queue=x,d=_E.bind(null,Qe,x,j,d),x.dispatch=d,m.memoizedState=n,[i,d,!1]}function my(n){var i=Qt();return hy(i,gt,n)}function hy(n,i,d){if(i=Ph(n,i,dy)[0],n=jd(rr)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var m=jl(i)}catch(R){throw R===gl?gd:R}else m=i;i=Qt();var x=i.queue,j=x.dispatch;return d!==i.memoizedState&&(Qe.flags|=2048,Io(9,_d(),NE.bind(null,x,d),null)),[m,j,n]}function NE(n,i){n.action=i}function fy(n){var i=Qt(),d=gt;if(d!==null)return hy(i,d,n);Qt(),i=i.memoizedState,d=Qt();var m=d.queue.dispatch;return d.memoizedState=n,[i,m,!1]}function Io(n,i,d,m){return n={tag:n,create:d,deps:m,inst:i,next:null},i=Qe.updateQueue,i===null&&(i=Oh(),Qe.updateQueue=i),d=i.lastEffect,d===null?i.lastEffect=n.next=n:(m=d.next,d.next=n,n.next=m,i.lastEffect=n),n}function _d(){return{destroy:void 0,resource:void 0}}function py(){return Qt().memoizedState}function Nd(n,i,d,m){var x=Rs();m=m===void 0?null:m,Qe.flags|=n,x.memoizedState=Io(1|i,_d(),d,m)}function _l(n,i,d,m){var x=Qt();m=m===void 0?null:m;var j=x.memoizedState.inst;gt!==null&&m!==null&&kh(m,gt.memoizedState.deps)?x.memoizedState=Io(i,j,d,m):(Qe.flags|=n,x.memoizedState=Io(1|i,j,d,m))}function gy(n,i){Nd(8390656,8,n,i)}function xy(n,i){_l(2048,8,n,i)}function yy(n,i){return _l(4,2,n,i)}function by(n,i){return _l(4,4,n,i)}function vy(n,i){if(typeof i=="function"){n=n();var d=i(n);return function(){typeof d=="function"?d():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function wy(n,i,d){d=d!=null?d.concat([n]):null,_l(4,4,vy.bind(null,i,n),d)}function Ih(){}function jy(n,i){var d=Qt();i=i===void 0?null:i;var m=d.memoizedState;return i!==null&&kh(i,m[1])?m[0]:(d.memoizedState=[n,i],n)}function _y(n,i){var d=Qt();i=i===void 0?null:i;var m=d.memoizedState;if(i!==null&&kh(i,m[1]))return m[0];if(m=n(),Rn){Ge(!0);try{n()}finally{Ge(!1)}}return d.memoizedState=[m,i],m}function Uh(n,i,d){return d===void 0||(Br&1073741824)!==0?n.memoizedState=i:(n.memoizedState=d,n=Eb(),Qe.lanes|=n,Wr|=n,d)}function Ny(n,i,d,m){return Is(d,i)?d:zo.current!==null?(n=Uh(n,d,m),Is(n,i)||(ms=!0),n):(Br&42)===0?(ms=!0,n.memoizedState=d):(n=Eb(),Qe.lanes|=n,Wr|=n,i)}function Sy(n,i,d,m,x){var j=G.p;G.p=j!==0&&8>j?j:8;var R=L.T,U={};L.T=U,qh(n,!1,i,d);try{var X=x(),ue=L.S;if(ue!==null&&ue(U,X),X!==null&&typeof X=="object"&&typeof X.then=="function"){var ve=vE(X,m);Nl(n,i,ve,Fs(n))}else Nl(n,i,m,Fs(n))}catch(Se){Nl(n,i,{then:function(){},status:"rejected",reason:Se},Fs())}finally{G.p=j,L.T=R}}function SE(){}function Bh(n,i,d,m){if(n.tag!==5)throw Error(r(476));var x=Ey(n).queue;Sy(n,x,i,ee,d===null?SE:function(){return Cy(n),d(m)})}function Ey(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:ee},next:null};var d={};return i.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:rr,lastRenderedState:d},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function Cy(n){var i=Ey(n).next.queue;Nl(n,i,{},Fs())}function Vh(){return js(Vl)}function ky(){return Qt().memoizedState}function Ty(){return Qt().memoizedState}function EE(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var d=Fs();n=Ir(d);var m=Ur(i,n,d);m!==null&&(Hs(m,i,d),yl(m,i,d)),i={cache:yh()},n.payload=i;return}i=i.return}}function CE(n,i,d){var m=Fs();d={lane:m,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null},Sd(n)?My(i,d):(d=lh(n,i,d,m),d!==null&&(Hs(d,n,m),Ry(d,i,m)))}function Ay(n,i,d){var m=Fs();Nl(n,i,d,m)}function Nl(n,i,d,m){var x={lane:m,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null};if(Sd(n))My(i,x);else{var j=n.alternate;if(n.lanes===0&&(j===null||j.lanes===0)&&(j=i.lastRenderedReducer,j!==null))try{var R=i.lastRenderedState,U=j(R,d);if(x.hasEagerState=!0,x.eagerState=U,Is(U,R))return ld(n,i,x,0),wt===null&&id(),!1}catch{}finally{}if(d=lh(n,i,x,m),d!==null)return Hs(d,n,m),Ry(d,i,m),!0}return!1}function qh(n,i,d,m){if(m={lane:2,revertLane:jf(),action:m,hasEagerState:!1,eagerState:null,next:null},Sd(n)){if(i)throw Error(r(479))}else i=lh(n,d,m,2),i!==null&&Hs(i,n,2)}function Sd(n){var i=n.alternate;return n===Qe||i!==null&&i===Qe}function My(n,i){$o=bd=!0;var d=n.pending;d===null?i.next=i:(i.next=d.next,d.next=i),n.pending=i}function Ry(n,i,d){if((d&4194048)!==0){var m=i.lanes;m&=n.pendingLanes,d|=m,i.lanes=d,Dm(n,d)}}var Ed={readContext:js,use:wd,useCallback:qt,useContext:qt,useEffect:qt,useImperativeHandle:qt,useLayoutEffect:qt,useInsertionEffect:qt,useMemo:qt,useReducer:qt,useRef:qt,useState:qt,useDebugValue:qt,useDeferredValue:qt,useTransition:qt,useSyncExternalStore:qt,useId:qt,useHostTransitionStatus:qt,useFormState:qt,useActionState:qt,useOptimistic:qt,useMemoCache:qt,useCacheRefresh:qt},Oy={readContext:js,use:wd,useCallback:function(n,i){return Rs().memoizedState=[n,i===void 0?null:i],n},useContext:js,useEffect:gy,useImperativeHandle:function(n,i,d){d=d!=null?d.concat([n]):null,Nd(4194308,4,vy.bind(null,i,n),d)},useLayoutEffect:function(n,i){return Nd(4194308,4,n,i)},useInsertionEffect:function(n,i){Nd(4,2,n,i)},useMemo:function(n,i){var d=Rs();i=i===void 0?null:i;var m=n();if(Rn){Ge(!0);try{n()}finally{Ge(!1)}}return d.memoizedState=[m,i],m},useReducer:function(n,i,d){var m=Rs();if(d!==void 0){var x=d(i);if(Rn){Ge(!0);try{d(i)}finally{Ge(!1)}}}else x=i;return m.memoizedState=m.baseState=x,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:x},m.queue=n,n=n.dispatch=CE.bind(null,Qe,n),[m.memoizedState,n]},useRef:function(n){var i=Rs();return n={current:n},i.memoizedState=n},useState:function(n){n=$h(n);var i=n.queue,d=Ay.bind(null,Qe,i);return i.dispatch=d,[n.memoizedState,d]},useDebugValue:Ih,useDeferredValue:function(n,i){var d=Rs();return Uh(d,n,i)},useTransition:function(){var n=$h(!1);return n=Sy.bind(null,Qe,n.queue,!0,!1),Rs().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,d){var m=Qe,x=Rs();if(ct){if(d===void 0)throw Error(r(407));d=d()}else{if(d=i(),wt===null)throw Error(r(349));(nt&124)!==0||ey(m,i,d)}x.memoizedState=d;var j={value:d,getSnapshot:i};return x.queue=j,gy(sy.bind(null,m,j,n),[n]),m.flags|=2048,Io(9,_d(),ty.bind(null,m,j,d,i),null),d},useId:function(){var n=Rs(),i=wt.identifierPrefix;if(ct){var d=tr,m=er;d=(m&~(1<<32-Je(m)-1)).toString(32)+d,i=""+i+"R"+d,d=vd++,0<d&&(i+="H"+d.toString(32)),i+=""}else d=wE++,i=""+i+"r"+d.toString(32)+"";return n.memoizedState=i},useHostTransitionStatus:Vh,useFormState:uy,useActionState:uy,useOptimistic:function(n){var i=Rs();i.memoizedState=i.baseState=n;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=d,i=qh.bind(null,Qe,!0,d),d.dispatch=i,[n,i]},useMemoCache:Dh,useCacheRefresh:function(){return Rs().memoizedState=EE.bind(null,Qe)}},Dy={readContext:js,use:wd,useCallback:jy,useContext:js,useEffect:xy,useImperativeHandle:wy,useInsertionEffect:yy,useLayoutEffect:by,useMemo:_y,useReducer:jd,useRef:py,useState:function(){return jd(rr)},useDebugValue:Ih,useDeferredValue:function(n,i){var d=Qt();return Ny(d,gt.memoizedState,n,i)},useTransition:function(){var n=jd(rr)[0],i=Qt().memoizedState;return[typeof n=="boolean"?n:jl(n),i]},useSyncExternalStore:Jx,useId:ky,useHostTransitionStatus:Vh,useFormState:my,useActionState:my,useOptimistic:function(n,i){var d=Qt();return ny(d,gt,n,i)},useMemoCache:Dh,useCacheRefresh:Ty},kE={readContext:js,use:wd,useCallback:jy,useContext:js,useEffect:xy,useImperativeHandle:wy,useInsertionEffect:yy,useLayoutEffect:by,useMemo:_y,useReducer:zh,useRef:py,useState:function(){return zh(rr)},useDebugValue:Ih,useDeferredValue:function(n,i){var d=Qt();return gt===null?Uh(d,n,i):Ny(d,gt.memoizedState,n,i)},useTransition:function(){var n=zh(rr)[0],i=Qt().memoizedState;return[typeof n=="boolean"?n:jl(n),i]},useSyncExternalStore:Jx,useId:ky,useHostTransitionStatus:Vh,useFormState:fy,useActionState:fy,useOptimistic:function(n,i){var d=Qt();return gt!==null?ny(d,gt,n,i):(d.baseState=n,[n,d.queue.dispatch])},useMemoCache:Dh,useCacheRefresh:Ty},Uo=null,Sl=0;function Cd(n){var i=Sl;return Sl+=1,Uo===null&&(Uo=[]),Hx(Uo,n,i)}function El(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function kd(n,i){throw i.$$typeof===g?Error(r(525)):(n=Object.prototype.toString.call(i),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function Py(n){var i=n._init;return i(n._payload)}function zy(n){function i(le,ae){if(n){var ce=le.deletions;ce===null?(le.deletions=[ae],le.flags|=16):ce.push(ae)}}function d(le,ae){if(!n)return null;for(;ae!==null;)i(le,ae),ae=ae.sibling;return null}function m(le){for(var ae=new Map;le!==null;)le.key!==null?ae.set(le.key,le):ae.set(le.index,le),le=le.sibling;return ae}function x(le,ae){return le=Ja(le,ae),le.index=0,le.sibling=null,le}function j(le,ae,ce){return le.index=ce,n?(ce=le.alternate,ce!==null?(ce=ce.index,ce<ae?(le.flags|=67108866,ae):ce):(le.flags|=67108866,ae)):(le.flags|=1048576,ae)}function R(le){return n&&le.alternate===null&&(le.flags|=67108866),le}function U(le,ae,ce,je){return ae===null||ae.tag!==6?(ae=dh(ce,le.mode,je),ae.return=le,ae):(ae=x(ae,ce),ae.return=le,ae)}function X(le,ae,ce,je){var Be=ce.type;return Be===_?ve(le,ae,ce.props.children,je,ce.key):ae!==null&&(ae.elementType===Be||typeof Be=="object"&&Be!==null&&Be.$$typeof===A&&Py(Be)===ae.type)?(ae=x(ae,ce.props),El(ae,ce),ae.return=le,ae):(ae=dd(ce.type,ce.key,ce.props,null,le.mode,je),El(ae,ce),ae.return=le,ae)}function ue(le,ae,ce,je){return ae===null||ae.tag!==4||ae.stateNode.containerInfo!==ce.containerInfo||ae.stateNode.implementation!==ce.implementation?(ae=uh(ce,le.mode,je),ae.return=le,ae):(ae=x(ae,ce.children||[]),ae.return=le,ae)}function ve(le,ae,ce,je,Be){return ae===null||ae.tag!==7?(ae=Nn(ce,le.mode,je,Be),ae.return=le,ae):(ae=x(ae,ce),ae.return=le,ae)}function Se(le,ae,ce){if(typeof ae=="string"&&ae!==""||typeof ae=="number"||typeof ae=="bigint")return ae=dh(""+ae,le.mode,ce),ae.return=le,ae;if(typeof ae=="object"&&ae!==null){switch(ae.$$typeof){case v:return ce=dd(ae.type,ae.key,ae.props,null,le.mode,ce),El(ce,ae),ce.return=le,ce;case b:return ae=uh(ae,le.mode,ce),ae.return=le,ae;case A:var je=ae._init;return ae=je(ae._payload),Se(le,ae,ce)}if(te(ae)||I(ae))return ae=Nn(ae,le.mode,ce,null),ae.return=le,ae;if(typeof ae.then=="function")return Se(le,Cd(ae),ce);if(ae.$$typeof===k)return Se(le,fd(le,ae),ce);kd(le,ae)}return null}function fe(le,ae,ce,je){var Be=ae!==null?ae.key:null;if(typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint")return Be!==null?null:U(le,ae,""+ce,je);if(typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case v:return ce.key===Be?X(le,ae,ce,je):null;case b:return ce.key===Be?ue(le,ae,ce,je):null;case A:return Be=ce._init,ce=Be(ce._payload),fe(le,ae,ce,je)}if(te(ce)||I(ce))return Be!==null?null:ve(le,ae,ce,je,null);if(typeof ce.then=="function")return fe(le,ae,Cd(ce),je);if(ce.$$typeof===k)return fe(le,ae,fd(le,ce),je);kd(le,ce)}return null}function ge(le,ae,ce,je,Be){if(typeof je=="string"&&je!==""||typeof je=="number"||typeof je=="bigint")return le=le.get(ce)||null,U(ae,le,""+je,Be);if(typeof je=="object"&&je!==null){switch(je.$$typeof){case v:return le=le.get(je.key===null?ce:je.key)||null,X(ae,le,je,Be);case b:return le=le.get(je.key===null?ce:je.key)||null,ue(ae,le,je,Be);case A:var et=je._init;return je=et(je._payload),ge(le,ae,ce,je,Be)}if(te(je)||I(je))return le=le.get(ce)||null,ve(ae,le,je,Be,null);if(typeof je.then=="function")return ge(le,ae,ce,Cd(je),Be);if(je.$$typeof===k)return ge(le,ae,ce,fd(ae,je),Be);kd(ae,je)}return null}function Ze(le,ae,ce,je){for(var Be=null,et=null,Ve=ae,He=ae=0,fs=null;Ve!==null&&He<ce.length;He++){Ve.index>He?(fs=Ve,Ve=null):fs=Ve.sibling;var it=fe(le,Ve,ce[He],je);if(it===null){Ve===null&&(Ve=fs);break}n&&Ve&&it.alternate===null&&i(le,Ve),ae=j(it,ae,He),et===null?Be=it:et.sibling=it,et=it,Ve=fs}if(He===ce.length)return d(le,Ve),ct&&En(le,He),Be;if(Ve===null){for(;He<ce.length;He++)Ve=Se(le,ce[He],je),Ve!==null&&(ae=j(Ve,ae,He),et===null?Be=Ve:et.sibling=Ve,et=Ve);return ct&&En(le,He),Be}for(Ve=m(Ve);He<ce.length;He++)fs=ge(Ve,le,He,ce[He],je),fs!==null&&(n&&fs.alternate!==null&&Ve.delete(fs.key===null?He:fs.key),ae=j(fs,ae,He),et===null?Be=fs:et.sibling=fs,et=fs);return n&&Ve.forEach(function(an){return i(le,an)}),ct&&En(le,He),Be}function Fe(le,ae,ce,je){if(ce==null)throw Error(r(151));for(var Be=null,et=null,Ve=ae,He=ae=0,fs=null,it=ce.next();Ve!==null&&!it.done;He++,it=ce.next()){Ve.index>He?(fs=Ve,Ve=null):fs=Ve.sibling;var an=fe(le,Ve,it.value,je);if(an===null){Ve===null&&(Ve=fs);break}n&&Ve&&an.alternate===null&&i(le,Ve),ae=j(an,ae,He),et===null?Be=an:et.sibling=an,et=an,Ve=fs}if(it.done)return d(le,Ve),ct&&En(le,He),Be;if(Ve===null){for(;!it.done;He++,it=ce.next())it=Se(le,it.value,je),it!==null&&(ae=j(it,ae,He),et===null?Be=it:et.sibling=it,et=it);return ct&&En(le,He),Be}for(Ve=m(Ve);!it.done;He++,it=ce.next())it=ge(Ve,le,He,it.value,je),it!==null&&(n&&it.alternate!==null&&Ve.delete(it.key===null?He:it.key),ae=j(it,ae,He),et===null?Be=it:et.sibling=it,et=it);return n&&Ve.forEach(function(TC){return i(le,TC)}),ct&&En(le,He),Be}function yt(le,ae,ce,je){if(typeof ce=="object"&&ce!==null&&ce.type===_&&ce.key===null&&(ce=ce.props.children),typeof ce=="object"&&ce!==null){switch(ce.$$typeof){case v:e:{for(var Be=ce.key;ae!==null;){if(ae.key===Be){if(Be=ce.type,Be===_){if(ae.tag===7){d(le,ae.sibling),je=x(ae,ce.props.children),je.return=le,le=je;break e}}else if(ae.elementType===Be||typeof Be=="object"&&Be!==null&&Be.$$typeof===A&&Py(Be)===ae.type){d(le,ae.sibling),je=x(ae,ce.props),El(je,ce),je.return=le,le=je;break e}d(le,ae);break}else i(le,ae);ae=ae.sibling}ce.type===_?(je=Nn(ce.props.children,le.mode,je,ce.key),je.return=le,le=je):(je=dd(ce.type,ce.key,ce.props,null,le.mode,je),El(je,ce),je.return=le,le=je)}return R(le);case b:e:{for(Be=ce.key;ae!==null;){if(ae.key===Be)if(ae.tag===4&&ae.stateNode.containerInfo===ce.containerInfo&&ae.stateNode.implementation===ce.implementation){d(le,ae.sibling),je=x(ae,ce.children||[]),je.return=le,le=je;break e}else{d(le,ae);break}else i(le,ae);ae=ae.sibling}je=uh(ce,le.mode,je),je.return=le,le=je}return R(le);case A:return Be=ce._init,ce=Be(ce._payload),yt(le,ae,ce,je)}if(te(ce))return Ze(le,ae,ce,je);if(I(ce)){if(Be=I(ce),typeof Be!="function")throw Error(r(150));return ce=Be.call(ce),Fe(le,ae,ce,je)}if(typeof ce.then=="function")return yt(le,ae,Cd(ce),je);if(ce.$$typeof===k)return yt(le,ae,fd(le,ce),je);kd(le,ce)}return typeof ce=="string"&&ce!==""||typeof ce=="number"||typeof ce=="bigint"?(ce=""+ce,ae!==null&&ae.tag===6?(d(le,ae.sibling),je=x(ae,ce),je.return=le,le=je):(d(le,ae),je=dh(ce,le.mode,je),je.return=le,le=je),R(le)):d(le,ae)}return function(le,ae,ce,je){try{Sl=0;var Be=yt(le,ae,ce,je);return Uo=null,Be}catch(Ve){if(Ve===gl||Ve===gd)throw Ve;var et=Us(29,Ve,null,le.mode);return et.lanes=je,et.return=le,et}finally{}}}var Bo=zy(!0),$y=zy(!1),aa=H(null),Ma=null;function Vr(n){var i=n.alternate;Y(os,os.current&1),Y(aa,n),Ma===null&&(i===null||zo.current!==null||i.memoizedState!==null)&&(Ma=n)}function Ly(n){if(n.tag===22){if(Y(os,os.current),Y(aa,n),Ma===null){var i=n.alternate;i!==null&&i.memoizedState!==null&&(Ma=n)}}else qr()}function qr(){Y(os,os.current),Y(aa,aa.current)}function nr(n){B(aa),Ma===n&&(Ma=null),B(os)}var os=H(0);function Td(n){for(var i=n;i!==null;){if(i.tag===13){var d=i.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||Df(d)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function Fh(n,i,d,m){i=n.memoizedState,d=d(m,i),d=d==null?i:p({},i,d),n.memoizedState=d,n.lanes===0&&(n.updateQueue.baseState=d)}var Hh={enqueueSetState:function(n,i,d){n=n._reactInternals;var m=Fs(),x=Ir(m);x.payload=i,d!=null&&(x.callback=d),i=Ur(n,x,m),i!==null&&(Hs(i,n,m),yl(i,n,m))},enqueueReplaceState:function(n,i,d){n=n._reactInternals;var m=Fs(),x=Ir(m);x.tag=1,x.payload=i,d!=null&&(x.callback=d),i=Ur(n,x,m),i!==null&&(Hs(i,n,m),yl(i,n,m))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var d=Fs(),m=Ir(d);m.tag=2,i!=null&&(m.callback=i),i=Ur(n,m,d),i!==null&&(Hs(i,n,d),yl(i,n,d))}};function Iy(n,i,d,m,x,j,R){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(m,j,R):i.prototype&&i.prototype.isPureReactComponent?!ll(d,m)||!ll(x,j):!0}function Uy(n,i,d,m){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(d,m),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(d,m),i.state!==n&&Hh.enqueueReplaceState(i,i.state,null)}function On(n,i){var d=i;if("ref"in i){d={};for(var m in i)m!=="ref"&&(d[m]=i[m])}if(n=n.defaultProps){d===i&&(d=p({},d));for(var x in n)d[x]===void 0&&(d[x]=n[x])}return d}var Ad=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)};function By(n){Ad(n)}function Vy(n){console.error(n)}function qy(n){Ad(n)}function Md(n,i){try{var d=n.onUncaughtError;d(i.value,{componentStack:i.stack})}catch(m){setTimeout(function(){throw m})}}function Fy(n,i,d){try{var m=n.onCaughtError;m(d.value,{componentStack:d.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Gh(n,i,d){return d=Ir(d),d.tag=3,d.payload={element:null},d.callback=function(){Md(n,i)},d}function Hy(n){return n=Ir(n),n.tag=3,n}function Gy(n,i,d,m){var x=d.type.getDerivedStateFromError;if(typeof x=="function"){var j=m.value;n.payload=function(){return x(j)},n.callback=function(){Fy(i,d,m)}}var R=d.stateNode;R!==null&&typeof R.componentDidCatch=="function"&&(n.callback=function(){Fy(i,d,m),typeof x!="function"&&(Yr===null?Yr=new Set([this]):Yr.add(this));var U=m.stack;this.componentDidCatch(m.value,{componentStack:U!==null?U:""})})}function TE(n,i,d,m,x){if(d.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(i=d.alternate,i!==null&&hl(i,d,x,!0),d=aa.current,d!==null){switch(d.tag){case 13:return Ma===null?xf():d.alternate===null&&Ut===0&&(Ut=3),d.flags&=-257,d.flags|=65536,d.lanes=x,m===wh?d.flags|=16384:(i=d.updateQueue,i===null?d.updateQueue=new Set([m]):i.add(m),bf(n,m,x)),!1;case 22:return d.flags|=65536,m===wh?d.flags|=16384:(i=d.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([m])},d.updateQueue=i):(d=i.retryQueue,d===null?i.retryQueue=new Set([m]):d.add(m)),bf(n,m,x)),!1}throw Error(r(435,d.tag))}return bf(n,m,x),xf(),!1}if(ct)return i=aa.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=x,m!==fh&&(n=Error(r(422),{cause:m}),ml(Js(n,d)))):(m!==fh&&(i=Error(r(423),{cause:m}),ml(Js(i,d))),n=n.current.alternate,n.flags|=65536,x&=-x,n.lanes|=x,m=Js(m,d),x=Gh(n.stateNode,m,x),Nh(n,x),Ut!==4&&(Ut=2)),!1;var j=Error(r(520),{cause:m});if(j=Js(j,d),Ol===null?Ol=[j]:Ol.push(j),Ut!==4&&(Ut=2),i===null)return!0;m=Js(m,d),d=i;do{switch(d.tag){case 3:return d.flags|=65536,n=x&-x,d.lanes|=n,n=Gh(d.stateNode,m,n),Nh(d,n),!1;case 1:if(i=d.type,j=d.stateNode,(d.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(Yr===null||!Yr.has(j))))return d.flags|=65536,x&=-x,d.lanes|=x,x=Hy(x),Gy(x,n,d,m),Nh(d,x),!1}d=d.return}while(d!==null);return!1}var Zy=Error(r(461)),ms=!1;function xs(n,i,d,m){i.child=n===null?$y(i,null,d,m):Bo(i,n.child,d,m)}function Wy(n,i,d,m,x){d=d.render;var j=i.ref;if("ref"in m){var R={};for(var U in m)U!=="ref"&&(R[U]=m[U])}else R=m;return An(i),m=Th(n,i,d,R,j,x),U=Ah(),n!==null&&!ms?(Mh(n,i,x),or(n,i,x)):(ct&&U&&mh(i),i.flags|=1,xs(n,i,m,x),i.child)}function Yy(n,i,d,m,x){if(n===null){var j=d.type;return typeof j=="function"&&!ch(j)&&j.defaultProps===void 0&&d.compare===null?(i.tag=15,i.type=j,Ky(n,i,j,m,x)):(n=dd(d.type,null,m,i,i.mode,x),n.ref=i.ref,n.return=i,i.child=n)}if(j=n.child,!ef(n,x)){var R=j.memoizedProps;if(d=d.compare,d=d!==null?d:ll,d(R,m)&&n.ref===i.ref)return or(n,i,x)}return i.flags|=1,n=Ja(j,m),n.ref=i.ref,n.return=i,i.child=n}function Ky(n,i,d,m,x){if(n!==null){var j=n.memoizedProps;if(ll(j,m)&&n.ref===i.ref)if(ms=!1,i.pendingProps=m=j,ef(n,x))(n.flags&131072)!==0&&(ms=!0);else return i.lanes=n.lanes,or(n,i,x)}return Zh(n,i,d,m,x)}function Xy(n,i,d){var m=i.pendingProps,x=m.children,j=n!==null?n.memoizedState:null;if(m.mode==="hidden"){if((i.flags&128)!==0){if(m=j!==null?j.baseLanes|d:d,n!==null){for(x=i.child=n.child,j=0;x!==null;)j=j|x.lanes|x.childLanes,x=x.sibling;i.childLanes=j&~m}else i.childLanes=0,i.child=null;return Qy(n,i,m,d)}if((d&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&pd(i,j!==null?j.cachePool:null),j!==null?Kx(i,j):Eh(),Ly(i);else return i.lanes=i.childLanes=536870912,Qy(n,i,j!==null?j.baseLanes|d:d,d)}else j!==null?(pd(i,j.cachePool),Kx(i,j),qr(),i.memoizedState=null):(n!==null&&pd(i,null),Eh(),qr());return xs(n,i,x,d),i.child}function Qy(n,i,d,m){var x=vh();return x=x===null?null:{parent:ns._currentValue,pool:x},i.memoizedState={baseLanes:d,cachePool:x},n!==null&&pd(i,null),Eh(),Ly(i),n!==null&&hl(n,i,m,!0),null}function Rd(n,i){var d=i.ref;if(d===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(r(284));(n===null||n.ref!==d)&&(i.flags|=4194816)}}function Zh(n,i,d,m,x){return An(i),d=Th(n,i,d,m,void 0,x),m=Ah(),n!==null&&!ms?(Mh(n,i,x),or(n,i,x)):(ct&&m&&mh(i),i.flags|=1,xs(n,i,d,x),i.child)}function Jy(n,i,d,m,x,j){return An(i),i.updateQueue=null,d=Qx(i,m,d,x),Xx(n),m=Ah(),n!==null&&!ms?(Mh(n,i,j),or(n,i,j)):(ct&&m&&mh(i),i.flags|=1,xs(n,i,d,j),i.child)}function eb(n,i,d,m,x){if(An(i),i.stateNode===null){var j=Mo,R=d.contextType;typeof R=="object"&&R!==null&&(j=js(R)),j=new d(m,j),i.memoizedState=j.state!==null&&j.state!==void 0?j.state:null,j.updater=Hh,i.stateNode=j,j._reactInternals=i,j=i.stateNode,j.props=m,j.state=i.memoizedState,j.refs={},jh(i),R=d.contextType,j.context=typeof R=="object"&&R!==null?js(R):Mo,j.state=i.memoizedState,R=d.getDerivedStateFromProps,typeof R=="function"&&(Fh(i,d,R,m),j.state=i.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof j.getSnapshotBeforeUpdate=="function"||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(R=j.state,typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount(),R!==j.state&&Hh.enqueueReplaceState(j,j.state,null),vl(i,m,j,x),bl(),j.state=i.memoizedState),typeof j.componentDidMount=="function"&&(i.flags|=4194308),m=!0}else if(n===null){j=i.stateNode;var U=i.memoizedProps,X=On(d,U);j.props=X;var ue=j.context,ve=d.contextType;R=Mo,typeof ve=="object"&&ve!==null&&(R=js(ve));var Se=d.getDerivedStateFromProps;ve=typeof Se=="function"||typeof j.getSnapshotBeforeUpdate=="function",U=i.pendingProps!==U,ve||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(U||ue!==R)&&Uy(i,j,m,R),Lr=!1;var fe=i.memoizedState;j.state=fe,vl(i,m,j,x),bl(),ue=i.memoizedState,U||fe!==ue||Lr?(typeof Se=="function"&&(Fh(i,d,Se,m),ue=i.memoizedState),(X=Lr||Iy(i,d,X,m,fe,ue,R))?(ve||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(i.flags|=4194308)):(typeof j.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=m,i.memoizedState=ue),j.props=m,j.state=ue,j.context=R,m=X):(typeof j.componentDidMount=="function"&&(i.flags|=4194308),m=!1)}else{j=i.stateNode,_h(n,i),R=i.memoizedProps,ve=On(d,R),j.props=ve,Se=i.pendingProps,fe=j.context,ue=d.contextType,X=Mo,typeof ue=="object"&&ue!==null&&(X=js(ue)),U=d.getDerivedStateFromProps,(ue=typeof U=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(R!==Se||fe!==X)&&Uy(i,j,m,X),Lr=!1,fe=i.memoizedState,j.state=fe,vl(i,m,j,x),bl();var ge=i.memoizedState;R!==Se||fe!==ge||Lr||n!==null&&n.dependencies!==null&&hd(n.dependencies)?(typeof U=="function"&&(Fh(i,d,U,m),ge=i.memoizedState),(ve=Lr||Iy(i,d,ve,m,fe,ge,X)||n!==null&&n.dependencies!==null&&hd(n.dependencies))?(ue||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(m,ge,X),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(m,ge,X)),typeof j.componentDidUpdate=="function"&&(i.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof j.componentDidUpdate!="function"||R===n.memoizedProps&&fe===n.memoizedState||(i.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||R===n.memoizedProps&&fe===n.memoizedState||(i.flags|=1024),i.memoizedProps=m,i.memoizedState=ge),j.props=m,j.state=ge,j.context=X,m=ve):(typeof j.componentDidUpdate!="function"||R===n.memoizedProps&&fe===n.memoizedState||(i.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||R===n.memoizedProps&&fe===n.memoizedState||(i.flags|=1024),m=!1)}return j=m,Rd(n,i),m=(i.flags&128)!==0,j||m?(j=i.stateNode,d=m&&typeof d.getDerivedStateFromError!="function"?null:j.render(),i.flags|=1,n!==null&&m?(i.child=Bo(i,n.child,null,x),i.child=Bo(i,null,d,x)):xs(n,i,d,x),i.memoizedState=j.state,n=i.child):n=or(n,i,x),n}function tb(n,i,d,m){return ul(),i.flags|=256,xs(n,i,d,m),i.child}var Wh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Yh(n){return{baseLanes:n,cachePool:Vx()}}function Kh(n,i,d){return n=n!==null?n.childLanes&~d:0,i&&(n|=ra),n}function sb(n,i,d){var m=i.pendingProps,x=!1,j=(i.flags&128)!==0,R;if((R=j)||(R=n!==null&&n.memoizedState===null?!1:(os.current&2)!==0),R&&(x=!0,i.flags&=-129),R=(i.flags&32)!==0,i.flags&=-33,n===null){if(ct){if(x?Vr(i):qr(),ct){var U=It,X;if(X=U){e:{for(X=U,U=Aa;X.nodeType!==8;){if(!U){U=null;break e}if(X=ga(X.nextSibling),X===null){U=null;break e}}U=X}U!==null?(i.memoizedState={dehydrated:U,treeContext:Sn!==null?{id:er,overflow:tr}:null,retryLane:536870912,hydrationErrors:null},X=Us(18,null,null,0),X.stateNode=U,X.return=i,i.child=X,Es=i,It=null,X=!0):X=!1}X||kn(i)}if(U=i.memoizedState,U!==null&&(U=U.dehydrated,U!==null))return Df(U)?i.lanes=32:i.lanes=536870912,null;nr(i)}return U=m.children,m=m.fallback,x?(qr(),x=i.mode,U=Od({mode:"hidden",children:U},x),m=Nn(m,x,d,null),U.return=i,m.return=i,U.sibling=m,i.child=U,x=i.child,x.memoizedState=Yh(d),x.childLanes=Kh(n,R,d),i.memoizedState=Wh,m):(Vr(i),Xh(i,U))}if(X=n.memoizedState,X!==null&&(U=X.dehydrated,U!==null)){if(j)i.flags&256?(Vr(i),i.flags&=-257,i=Qh(n,i,d)):i.memoizedState!==null?(qr(),i.child=n.child,i.flags|=128,i=null):(qr(),x=m.fallback,U=i.mode,m=Od({mode:"visible",children:m.children},U),x=Nn(x,U,d,null),x.flags|=2,m.return=i,x.return=i,m.sibling=x,i.child=m,Bo(i,n.child,null,d),m=i.child,m.memoizedState=Yh(d),m.childLanes=Kh(n,R,d),i.memoizedState=Wh,i=x);else if(Vr(i),Df(U)){if(R=U.nextSibling&&U.nextSibling.dataset,R)var ue=R.dgst;R=ue,m=Error(r(419)),m.stack="",m.digest=R,ml({value:m,source:null,stack:null}),i=Qh(n,i,d)}else if(ms||hl(n,i,d,!1),R=(d&n.childLanes)!==0,ms||R){if(R=wt,R!==null&&(m=d&-d,m=(m&42)!==0?1:bn(m),m=(m&(R.suspendedLanes|d))!==0?0:m,m!==0&&m!==X.retryLane))throw X.retryLane=m,Ao(n,m),Hs(R,n,m),Zy;U.data==="$?"||xf(),i=Qh(n,i,d)}else U.data==="$?"?(i.flags|=192,i.child=n.child,i=null):(n=X.treeContext,It=ga(U.nextSibling),Es=i,ct=!0,Cn=null,Aa=!1,n!==null&&(ta[sa++]=er,ta[sa++]=tr,ta[sa++]=Sn,er=n.id,tr=n.overflow,Sn=i),i=Xh(i,m.children),i.flags|=4096);return i}return x?(qr(),x=m.fallback,U=i.mode,X=n.child,ue=X.sibling,m=Ja(X,{mode:"hidden",children:m.children}),m.subtreeFlags=X.subtreeFlags&65011712,ue!==null?x=Ja(ue,x):(x=Nn(x,U,d,null),x.flags|=2),x.return=i,m.return=i,m.sibling=x,i.child=m,m=x,x=i.child,U=n.child.memoizedState,U===null?U=Yh(d):(X=U.cachePool,X!==null?(ue=ns._currentValue,X=X.parent!==ue?{parent:ue,pool:ue}:X):X=Vx(),U={baseLanes:U.baseLanes|d,cachePool:X}),x.memoizedState=U,x.childLanes=Kh(n,R,d),i.memoizedState=Wh,m):(Vr(i),d=n.child,n=d.sibling,d=Ja(d,{mode:"visible",children:m.children}),d.return=i,d.sibling=null,n!==null&&(R=i.deletions,R===null?(i.deletions=[n],i.flags|=16):R.push(n)),i.child=d,i.memoizedState=null,d)}function Xh(n,i){return i=Od({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function Od(n,i){return n=Us(22,n,null,i),n.lanes=0,n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},n}function Qh(n,i,d){return Bo(i,n.child,null,d),n=Xh(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function ab(n,i,d){n.lanes|=i;var m=n.alternate;m!==null&&(m.lanes|=i),gh(n.return,i,d)}function Jh(n,i,d,m,x){var j=n.memoizedState;j===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:x}:(j.isBackwards=i,j.rendering=null,j.renderingStartTime=0,j.last=m,j.tail=d,j.tailMode=x)}function rb(n,i,d){var m=i.pendingProps,x=m.revealOrder,j=m.tail;if(xs(n,i,m.children,d),m=os.current,(m&2)!==0)m=m&1|2,i.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&ab(n,d,i);else if(n.tag===19)ab(n,d,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}m&=1}switch(Y(os,m),x){case"forwards":for(d=i.child,x=null;d!==null;)n=d.alternate,n!==null&&Td(n)===null&&(x=d),d=d.sibling;d=x,d===null?(x=i.child,i.child=null):(x=d.sibling,d.sibling=null),Jh(i,!1,x,d,j);break;case"backwards":for(d=null,x=i.child,i.child=null;x!==null;){if(n=x.alternate,n!==null&&Td(n)===null){i.child=x;break}n=x.sibling,x.sibling=d,d=x,x=n}Jh(i,!0,d,null,j);break;case"together":Jh(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function or(n,i,d){if(n!==null&&(i.dependencies=n.dependencies),Wr|=i.lanes,(d&i.childLanes)===0)if(n!==null){if(hl(n,i,d,!1),(d&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(r(153));if(i.child!==null){for(n=i.child,d=Ja(n,n.pendingProps),i.child=d,d.return=i;n.sibling!==null;)n=n.sibling,d=d.sibling=Ja(n,n.pendingProps),d.return=i;d.sibling=null}return i.child}function ef(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&hd(n)))}function AE(n,i,d){switch(i.tag){case 3:D(i,i.stateNode.containerInfo),$r(i,ns,n.memoizedState.cache),ul();break;case 27:case 5:Q(i);break;case 4:D(i,i.stateNode.containerInfo);break;case 10:$r(i,i.type,i.memoizedProps.value);break;case 13:var m=i.memoizedState;if(m!==null)return m.dehydrated!==null?(Vr(i),i.flags|=128,null):(d&i.child.childLanes)!==0?sb(n,i,d):(Vr(i),n=or(n,i,d),n!==null?n.sibling:null);Vr(i);break;case 19:var x=(n.flags&128)!==0;if(m=(d&i.childLanes)!==0,m||(hl(n,i,d,!1),m=(d&i.childLanes)!==0),x){if(m)return rb(n,i,d);i.flags|=128}if(x=i.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Y(os,os.current),m)break;return null;case 22:case 23:return i.lanes=0,Xy(n,i,d);case 24:$r(i,ns,n.memoizedState.cache)}return or(n,i,d)}function nb(n,i,d){if(n!==null)if(n.memoizedProps!==i.pendingProps)ms=!0;else{if(!ef(n,d)&&(i.flags&128)===0)return ms=!1,AE(n,i,d);ms=(n.flags&131072)!==0}else ms=!1,ct&&(i.flags&1048576)!==0&&Px(i,md,i.index);switch(i.lanes=0,i.tag){case 16:e:{n=i.pendingProps;var m=i.elementType,x=m._init;if(m=x(m._payload),i.type=m,typeof m=="function")ch(m)?(n=On(m,n),i.tag=1,i=eb(null,i,m,n,d)):(i.tag=0,i=Zh(null,i,m,n,d));else{if(m!=null){if(x=m.$$typeof,x===S){i.tag=11,i=Wy(null,i,m,n,d);break e}else if(x===z){i.tag=14,i=Yy(null,i,m,n,d);break e}}throw i=pe(m)||m,Error(r(306,i,""))}}return i;case 0:return Zh(n,i,i.type,i.pendingProps,d);case 1:return m=i.type,x=On(m,i.pendingProps),eb(n,i,m,x,d);case 3:e:{if(D(i,i.stateNode.containerInfo),n===null)throw Error(r(387));m=i.pendingProps;var j=i.memoizedState;x=j.element,_h(n,i),vl(i,m,null,d);var R=i.memoizedState;if(m=R.cache,$r(i,ns,m),m!==j.cache&&xh(i,[ns],d,!0),bl(),m=R.element,j.isDehydrated)if(j={element:m,isDehydrated:!1,cache:R.cache},i.updateQueue.baseState=j,i.memoizedState=j,i.flags&256){i=tb(n,i,m,d);break e}else if(m!==x){x=Js(Error(r(424)),i),ml(x),i=tb(n,i,m,d);break e}else{switch(n=i.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for(It=ga(n.firstChild),Es=i,ct=!0,Cn=null,Aa=!0,d=$y(i,null,m,d),i.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(ul(),m===x){i=or(n,i,d);break e}xs(n,i,m,d)}i=i.child}return i;case 26:return Rd(n,i),n===null?(d=cv(i.type,null,i.pendingProps,null))?i.memoizedState=d:ct||(d=i.type,n=i.pendingProps,m=Zd(oe.current).createElement(d),m[ws]=i,m[As]=n,bs(m,d,n),us(m),i.stateNode=m):i.memoizedState=cv(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return Q(i),n===null&&ct&&(m=i.stateNode=ov(i.type,i.pendingProps,oe.current),Es=i,Aa=!0,x=It,Qr(i.type)?(Pf=x,It=ga(m.firstChild)):It=x),xs(n,i,i.pendingProps.children,d),Rd(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&ct&&((x=m=It)&&(m=rC(m,i.type,i.pendingProps,Aa),m!==null?(i.stateNode=m,Es=i,It=ga(m.firstChild),Aa=!1,x=!0):x=!1),x||kn(i)),Q(i),x=i.type,j=i.pendingProps,R=n!==null?n.memoizedProps:null,m=j.children,Mf(x,j)?m=null:R!==null&&Mf(x,R)&&(i.flags|=32),i.memoizedState!==null&&(x=Th(n,i,jE,null,null,d),Vl._currentValue=x),Rd(n,i),xs(n,i,m,d),i.child;case 6:return n===null&&ct&&((n=d=It)&&(d=nC(d,i.pendingProps,Aa),d!==null?(i.stateNode=d,Es=i,It=null,n=!0):n=!1),n||kn(i)),null;case 13:return sb(n,i,d);case 4:return D(i,i.stateNode.containerInfo),m=i.pendingProps,n===null?i.child=Bo(i,null,m,d):xs(n,i,m,d),i.child;case 11:return Wy(n,i,i.type,i.pendingProps,d);case 7:return xs(n,i,i.pendingProps,d),i.child;case 8:return xs(n,i,i.pendingProps.children,d),i.child;case 12:return xs(n,i,i.pendingProps.children,d),i.child;case 10:return m=i.pendingProps,$r(i,i.type,m.value),xs(n,i,m.children,d),i.child;case 9:return x=i.type._context,m=i.pendingProps.children,An(i),x=js(x),m=m(x),i.flags|=1,xs(n,i,m,d),i.child;case 14:return Yy(n,i,i.type,i.pendingProps,d);case 15:return Ky(n,i,i.type,i.pendingProps,d);case 19:return rb(n,i,d);case 31:return m=i.pendingProps,d=i.mode,m={mode:m.mode,children:m.children},n===null?(d=Od(m,d),d.ref=i.ref,i.child=d,d.return=i,i=d):(d=Ja(n.child,m),d.ref=i.ref,i.child=d,d.return=i,i=d),i;case 22:return Xy(n,i,d);case 24:return An(i),m=js(ns),n===null?(x=vh(),x===null&&(x=wt,j=yh(),x.pooledCache=j,j.refCount++,j!==null&&(x.pooledCacheLanes|=d),x=j),i.memoizedState={parent:m,cache:x},jh(i),$r(i,ns,x)):((n.lanes&d)!==0&&(_h(n,i),vl(i,null,null,d),bl()),x=n.memoizedState,j=i.memoizedState,x.parent!==m?(x={parent:m,cache:m},i.memoizedState=x,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=x),$r(i,ns,m)):(m=j.cache,$r(i,ns,m),m!==x.cache&&xh(i,[ns],d,!0))),xs(n,i,i.pendingProps.children,d),i.child;case 29:throw i.pendingProps}throw Error(r(156,i.tag))}function ir(n){n.flags|=4}function ob(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!fv(i)){if(i=aa.current,i!==null&&((nt&4194048)===nt?Ma!==null:(nt&62914560)!==nt&&(nt&536870912)===0||i!==Ma))throw xl=wh,qx;n.flags|=8192}}function Dd(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?Qi():536870912,n.lanes|=i,Ho|=i)}function Cl(n,i){if(!ct)switch(n.tailMode){case"hidden":i=n.tail;for(var d=null;i!==null;)i.alternate!==null&&(d=i),i=i.sibling;d===null?n.tail=null:d.sibling=null;break;case"collapsed":d=n.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:m.sibling=null}}function Dt(n){var i=n.alternate!==null&&n.alternate.child===n.child,d=0,m=0;if(i)for(var x=n.child;x!==null;)d|=x.lanes|x.childLanes,m|=x.subtreeFlags&65011712,m|=x.flags&65011712,x.return=n,x=x.sibling;else for(x=n.child;x!==null;)d|=x.lanes|x.childLanes,m|=x.subtreeFlags,m|=x.flags,x.return=n,x=x.sibling;return n.subtreeFlags|=m,n.childLanes=d,i}function ME(n,i,d){var m=i.pendingProps;switch(hh(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Dt(i),null;case 1:return Dt(i),null;case 3:return d=i.stateNode,m=null,n!==null&&(m=n.memoizedState.cache),i.memoizedState.cache!==m&&(i.flags|=2048),ar(ns),q(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(n===null||n.child===null)&&(dl(i)?ir(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Lx())),Dt(i),null;case 26:return d=i.memoizedState,n===null?(ir(i),d!==null?(Dt(i),ob(i,d)):(Dt(i),i.flags&=-16777217)):d?d!==n.memoizedState?(ir(i),Dt(i),ob(i,d)):(Dt(i),i.flags&=-16777217):(n.memoizedProps!==m&&ir(i),Dt(i),i.flags&=-16777217),null;case 27:K(i),d=oe.current;var x=i.type;if(n!==null&&i.stateNode!=null)n.memoizedProps!==m&&ir(i);else{if(!m){if(i.stateNode===null)throw Error(r(166));return Dt(i),null}n=ne.current,dl(i)?zx(i):(n=ov(x,m,d),i.stateNode=n,ir(i))}return Dt(i),null;case 5:if(K(i),d=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==m&&ir(i);else{if(!m){if(i.stateNode===null)throw Error(r(166));return Dt(i),null}if(n=ne.current,dl(i))zx(i);else{switch(x=Zd(oe.current),n){case 1:n=x.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:n=x.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":n=x.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":n=x.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":n=x.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof m.is=="string"?x.createElement("select",{is:m.is}):x.createElement("select"),m.multiple?n.multiple=!0:m.size&&(n.size=m.size);break;default:n=typeof m.is=="string"?x.createElement(d,{is:m.is}):x.createElement(d)}}n[ws]=i,n[As]=m;e:for(x=i.child;x!==null;){if(x.tag===5||x.tag===6)n.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===i)break e;for(;x.sibling===null;){if(x.return===null||x.return===i)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}i.stateNode=n;e:switch(bs(n,d,m),d){case"button":case"input":case"select":case"textarea":n=!!m.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&ir(i)}}return Dt(i),i.flags&=-16777217,null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==m&&ir(i);else{if(typeof m!="string"&&i.stateNode===null)throw Error(r(166));if(n=oe.current,dl(i)){if(n=i.stateNode,d=i.memoizedProps,m=null,x=Es,x!==null)switch(x.tag){case 27:case 5:m=x.memoizedProps}n[ws]=i,n=!!(n.nodeValue===d||m!==null&&m.suppressHydrationWarning===!0||Jb(n.nodeValue,d)),n||kn(i)}else n=Zd(n).createTextNode(m),n[ws]=i,i.stateNode=n}return Dt(i),null;case 13:if(m=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(x=dl(i),m!==null&&m.dehydrated!==null){if(n===null){if(!x)throw Error(r(318));if(x=i.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[ws]=i}else ul(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Dt(i),x=!1}else x=Lx(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=x),x=!0;if(!x)return i.flags&256?(nr(i),i):(nr(i),null)}if(nr(i),(i.flags&128)!==0)return i.lanes=d,i;if(d=m!==null,n=n!==null&&n.memoizedState!==null,d){m=i.child,x=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(x=m.alternate.memoizedState.cachePool.pool);var j=null;m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(j=m.memoizedState.cachePool.pool),j!==x&&(m.flags|=2048)}return d!==n&&d&&(i.child.flags|=8192),Dd(i,i.updateQueue),Dt(i),null;case 4:return q(),n===null&&Ef(i.stateNode.containerInfo),Dt(i),null;case 10:return ar(i.type),Dt(i),null;case 19:if(B(os),x=i.memoizedState,x===null)return Dt(i),null;if(m=(i.flags&128)!==0,j=x.rendering,j===null)if(m)Cl(x,!1);else{if(Ut!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(j=Td(n),j!==null){for(i.flags|=128,Cl(x,!1),n=j.updateQueue,i.updateQueue=n,Dd(i,n),i.subtreeFlags=0,n=d,d=i.child;d!==null;)Dx(d,n),d=d.sibling;return Y(os,os.current&1|2),i.child}n=n.sibling}x.tail!==null&&Ie()>$d&&(i.flags|=128,m=!0,Cl(x,!1),i.lanes=4194304)}else{if(!m)if(n=Td(j),n!==null){if(i.flags|=128,m=!0,n=n.updateQueue,i.updateQueue=n,Dd(i,n),Cl(x,!0),x.tail===null&&x.tailMode==="hidden"&&!j.alternate&&!ct)return Dt(i),null}else 2*Ie()-x.renderingStartTime>$d&&d!==536870912&&(i.flags|=128,m=!0,Cl(x,!1),i.lanes=4194304);x.isBackwards?(j.sibling=i.child,i.child=j):(n=x.last,n!==null?n.sibling=j:i.child=j,x.last=j)}return x.tail!==null?(i=x.tail,x.rendering=i,x.tail=i.sibling,x.renderingStartTime=Ie(),i.sibling=null,n=os.current,Y(os,m?n&1|2:n&1),i):(Dt(i),null);case 22:case 23:return nr(i),Ch(),m=i.memoizedState!==null,n!==null?n.memoizedState!==null!==m&&(i.flags|=8192):m&&(i.flags|=8192),m?(d&536870912)!==0&&(i.flags&128)===0&&(Dt(i),i.subtreeFlags&6&&(i.flags|=8192)):Dt(i),d=i.updateQueue,d!==null&&Dd(i,d.retryQueue),d=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(d=n.memoizedState.cachePool.pool),m=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(m=i.memoizedState.cachePool.pool),m!==d&&(i.flags|=2048),n!==null&&B(Mn),null;case 24:return d=null,n!==null&&(d=n.memoizedState.cache),i.memoizedState.cache!==d&&(i.flags|=2048),ar(ns),Dt(i),null;case 25:return null;case 30:return null}throw Error(r(156,i.tag))}function RE(n,i){switch(hh(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return ar(ns),q(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return K(i),null;case 13:if(nr(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(r(340));ul()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return B(os),null;case 4:return q(),null;case 10:return ar(i.type),null;case 22:case 23:return nr(i),Ch(),n!==null&&B(Mn),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return ar(ns),null;case 25:return null;default:return null}}function ib(n,i){switch(hh(i),i.tag){case 3:ar(ns),q();break;case 26:case 27:case 5:K(i);break;case 4:q();break;case 13:nr(i);break;case 19:B(os);break;case 10:ar(i.type);break;case 22:case 23:nr(i),Ch(),n!==null&&B(Mn);break;case 24:ar(ns)}}function kl(n,i){try{var d=i.updateQueue,m=d!==null?d.lastEffect:null;if(m!==null){var x=m.next;d=x;do{if((d.tag&n)===n){m=void 0;var j=d.create,R=d.inst;m=j(),R.destroy=m}d=d.next}while(d!==x)}}catch(U){vt(i,i.return,U)}}function Fr(n,i,d){try{var m=i.updateQueue,x=m!==null?m.lastEffect:null;if(x!==null){var j=x.next;m=j;do{if((m.tag&n)===n){var R=m.inst,U=R.destroy;if(U!==void 0){R.destroy=void 0,x=i;var X=d,ue=U;try{ue()}catch(ve){vt(x,X,ve)}}}m=m.next}while(m!==j)}}catch(ve){vt(i,i.return,ve)}}function lb(n){var i=n.updateQueue;if(i!==null){var d=n.stateNode;try{Yx(i,d)}catch(m){vt(n,n.return,m)}}}function cb(n,i,d){d.props=On(n.type,n.memoizedProps),d.state=n.memoizedState;try{d.componentWillUnmount()}catch(m){vt(n,i,m)}}function Tl(n,i){try{var d=n.ref;if(d!==null){switch(n.tag){case 26:case 27:case 5:var m=n.stateNode;break;case 30:m=n.stateNode;break;default:m=n.stateNode}typeof d=="function"?n.refCleanup=d(m):d.current=m}}catch(x){vt(n,i,x)}}function Ra(n,i){var d=n.ref,m=n.refCleanup;if(d!==null)if(typeof m=="function")try{m()}catch(x){vt(n,i,x)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(x){vt(n,i,x)}else d.current=null}function db(n){var i=n.type,d=n.memoizedProps,m=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":d.autoFocus&&m.focus();break e;case"img":d.src?m.src=d.src:d.srcSet&&(m.srcset=d.srcSet)}}catch(x){vt(n,n.return,x)}}function tf(n,i,d){try{var m=n.stateNode;JE(m,n.type,d,i),m[As]=i}catch(x){vt(n,n.return,x)}}function ub(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Qr(n.type)||n.tag===4}function sf(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||ub(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Qr(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function af(n,i,d){var m=n.tag;if(m===5||m===6)n=n.stateNode,i?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(n,i):(i=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,i.appendChild(n),d=d._reactRootContainer,d!=null||i.onclick!==null||(i.onclick=Gd));else if(m!==4&&(m===27&&Qr(n.type)&&(d=n.stateNode,i=null),n=n.child,n!==null))for(af(n,i,d),n=n.sibling;n!==null;)af(n,i,d),n=n.sibling}function Pd(n,i,d){var m=n.tag;if(m===5||m===6)n=n.stateNode,i?d.insertBefore(n,i):d.appendChild(n);else if(m!==4&&(m===27&&Qr(n.type)&&(d=n.stateNode),n=n.child,n!==null))for(Pd(n,i,d),n=n.sibling;n!==null;)Pd(n,i,d),n=n.sibling}function mb(n){var i=n.stateNode,d=n.memoizedProps;try{for(var m=n.type,x=i.attributes;x.length;)i.removeAttributeNode(x[0]);bs(i,m,d),i[ws]=n,i[As]=d}catch(j){vt(n,n.return,j)}}var lr=!1,Ft=!1,rf=!1,hb=typeof WeakSet=="function"?WeakSet:Set,hs=null;function OE(n,i){if(n=n.containerInfo,Tf=Jd,n=Nx(n),sh(n)){if("selectionStart"in n)var d={start:n.selectionStart,end:n.selectionEnd};else e:{d=(d=n.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var x=m.anchorOffset,j=m.focusNode;m=m.focusOffset;try{d.nodeType,j.nodeType}catch{d=null;break e}var R=0,U=-1,X=-1,ue=0,ve=0,Se=n,fe=null;t:for(;;){for(var ge;Se!==d||x!==0&&Se.nodeType!==3||(U=R+x),Se!==j||m!==0&&Se.nodeType!==3||(X=R+m),Se.nodeType===3&&(R+=Se.nodeValue.length),(ge=Se.firstChild)!==null;)fe=Se,Se=ge;for(;;){if(Se===n)break t;if(fe===d&&++ue===x&&(U=R),fe===j&&++ve===m&&(X=R),(ge=Se.nextSibling)!==null)break;Se=fe,fe=Se.parentNode}Se=ge}d=U===-1||X===-1?null:{start:U,end:X}}else d=null}d=d||{start:0,end:0}}else d=null;for(Af={focusedElem:n,selectionRange:d},Jd=!1,hs=i;hs!==null;)if(i=hs,n=i.child,(i.subtreeFlags&1024)!==0&&n!==null)n.return=i,hs=n;else for(;hs!==null;){switch(i=hs,j=i.alternate,n=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((n&1024)!==0&&j!==null){n=void 0,d=i,x=j.memoizedProps,j=j.memoizedState,m=d.stateNode;try{var Ze=On(d.type,x,d.elementType===d.type);n=m.getSnapshotBeforeUpdate(Ze,j),m.__reactInternalSnapshotBeforeUpdate=n}catch(Fe){vt(d,d.return,Fe)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,d=n.nodeType,d===9)Of(n);else if(d===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Of(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(r(163))}if(n=i.sibling,n!==null){n.return=i.return,hs=n;break}hs=i.return}}function fb(n,i,d){var m=d.flags;switch(d.tag){case 0:case 11:case 15:Hr(n,d),m&4&&kl(5,d);break;case 1:if(Hr(n,d),m&4)if(n=d.stateNode,i===null)try{n.componentDidMount()}catch(R){vt(d,d.return,R)}else{var x=On(d.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(x,i,n.__reactInternalSnapshotBeforeUpdate)}catch(R){vt(d,d.return,R)}}m&64&&lb(d),m&512&&Tl(d,d.return);break;case 3:if(Hr(n,d),m&64&&(n=d.updateQueue,n!==null)){if(i=null,d.child!==null)switch(d.child.tag){case 27:case 5:i=d.child.stateNode;break;case 1:i=d.child.stateNode}try{Yx(n,i)}catch(R){vt(d,d.return,R)}}break;case 27:i===null&&m&4&&mb(d);case 26:case 5:Hr(n,d),i===null&&m&4&&db(d),m&512&&Tl(d,d.return);break;case 12:Hr(n,d);break;case 13:Hr(n,d),m&4&&xb(n,d),m&64&&(n=d.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(d=VE.bind(null,d),oC(n,d))));break;case 22:if(m=d.memoizedState!==null||lr,!m){i=i!==null&&i.memoizedState!==null||Ft,x=lr;var j=Ft;lr=m,(Ft=i)&&!j?Gr(n,d,(d.subtreeFlags&8772)!==0):Hr(n,d),lr=x,Ft=j}break;case 30:break;default:Hr(n,d)}}function pb(n){var i=n.alternate;i!==null&&(n.alternate=null,pb(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&$m(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var At=null,Os=!1;function cr(n,i,d){for(d=d.child;d!==null;)gb(n,i,d),d=d.sibling}function gb(n,i,d){if(Oe&&typeof Oe.onCommitFiberUnmount=="function")try{Oe.onCommitFiberUnmount(Te,d)}catch{}switch(d.tag){case 26:Ft||Ra(d,i),cr(n,i,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:Ft||Ra(d,i);var m=At,x=Os;Qr(d.type)&&(At=d.stateNode,Os=!1),cr(n,i,d),Ll(d.stateNode),At=m,Os=x;break;case 5:Ft||Ra(d,i);case 6:if(m=At,x=Os,At=null,cr(n,i,d),At=m,Os=x,At!==null)if(Os)try{(At.nodeType===9?At.body:At.nodeName==="HTML"?At.ownerDocument.body:At).removeChild(d.stateNode)}catch(j){vt(d,i,j)}else try{At.removeChild(d.stateNode)}catch(j){vt(d,i,j)}break;case 18:At!==null&&(Os?(n=At,rv(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,d.stateNode),Gl(n)):rv(At,d.stateNode));break;case 4:m=At,x=Os,At=d.stateNode.containerInfo,Os=!0,cr(n,i,d),At=m,Os=x;break;case 0:case 11:case 14:case 15:Ft||Fr(2,d,i),Ft||Fr(4,d,i),cr(n,i,d);break;case 1:Ft||(Ra(d,i),m=d.stateNode,typeof m.componentWillUnmount=="function"&&cb(d,i,m)),cr(n,i,d);break;case 21:cr(n,i,d);break;case 22:Ft=(m=Ft)||d.memoizedState!==null,cr(n,i,d),Ft=m;break;default:cr(n,i,d)}}function xb(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Gl(n)}catch(d){vt(i,i.return,d)}}function DE(n){switch(n.tag){case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new hb),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new hb),i;default:throw Error(r(435,n.tag))}}function nf(n,i){var d=DE(n);i.forEach(function(m){var x=qE.bind(null,n,m);d.has(m)||(d.add(m),m.then(x,x))})}function Bs(n,i){var d=i.deletions;if(d!==null)for(var m=0;m<d.length;m++){var x=d[m],j=n,R=i,U=R;e:for(;U!==null;){switch(U.tag){case 27:if(Qr(U.type)){At=U.stateNode,Os=!1;break e}break;case 5:At=U.stateNode,Os=!1;break e;case 3:case 4:At=U.stateNode.containerInfo,Os=!0;break e}U=U.return}if(At===null)throw Error(r(160));gb(j,R,x),At=null,Os=!1,j=x.alternate,j!==null&&(j.return=null),x.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)yb(i,n),i=i.sibling}var pa=null;function yb(n,i){var d=n.alternate,m=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Bs(i,n),Vs(n),m&4&&(Fr(3,n,n.return),kl(3,n),Fr(5,n,n.return));break;case 1:Bs(i,n),Vs(n),m&512&&(Ft||d===null||Ra(d,d.return)),m&64&&lr&&(n=n.updateQueue,n!==null&&(m=n.callbacks,m!==null&&(d=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=d===null?m:d.concat(m))));break;case 26:var x=pa;if(Bs(i,n),Vs(n),m&512&&(Ft||d===null||Ra(d,d.return)),m&4){var j=d!==null?d.memoizedState:null;if(m=n.memoizedState,d===null)if(m===null)if(n.stateNode===null){e:{m=n.type,d=n.memoizedProps,x=x.ownerDocument||x;t:switch(m){case"title":j=x.getElementsByTagName("title")[0],(!j||j[Ji]||j[ws]||j.namespaceURI==="http://www.w3.org/2000/svg"||j.hasAttribute("itemprop"))&&(j=x.createElement(m),x.head.insertBefore(j,x.querySelector("head > title"))),bs(j,m,d),j[ws]=n,us(j),m=j;break e;case"link":var R=mv("link","href",x).get(m+(d.href||""));if(R){for(var U=0;U<R.length;U++)if(j=R[U],j.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&j.getAttribute("rel")===(d.rel==null?null:d.rel)&&j.getAttribute("title")===(d.title==null?null:d.title)&&j.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){R.splice(U,1);break t}}j=x.createElement(m),bs(j,m,d),x.head.appendChild(j);break;case"meta":if(R=mv("meta","content",x).get(m+(d.content||""))){for(U=0;U<R.length;U++)if(j=R[U],j.getAttribute("content")===(d.content==null?null:""+d.content)&&j.getAttribute("name")===(d.name==null?null:d.name)&&j.getAttribute("property")===(d.property==null?null:d.property)&&j.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&j.getAttribute("charset")===(d.charSet==null?null:d.charSet)){R.splice(U,1);break t}}j=x.createElement(m),bs(j,m,d),x.head.appendChild(j);break;default:throw Error(r(468,m))}j[ws]=n,us(j),m=j}n.stateNode=m}else hv(x,n.type,n.stateNode);else n.stateNode=uv(x,m,n.memoizedProps);else j!==m?(j===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):j.count--,m===null?hv(x,n.type,n.stateNode):uv(x,m,n.memoizedProps)):m===null&&n.stateNode!==null&&tf(n,n.memoizedProps,d.memoizedProps)}break;case 27:Bs(i,n),Vs(n),m&512&&(Ft||d===null||Ra(d,d.return)),d!==null&&m&4&&tf(n,n.memoizedProps,d.memoizedProps);break;case 5:if(Bs(i,n),Vs(n),m&512&&(Ft||d===null||Ra(d,d.return)),n.flags&32){x=n.stateNode;try{_o(x,"")}catch(ge){vt(n,n.return,ge)}}m&4&&n.stateNode!=null&&(x=n.memoizedProps,tf(n,x,d!==null?d.memoizedProps:x)),m&1024&&(rf=!0);break;case 6:if(Bs(i,n),Vs(n),m&4){if(n.stateNode===null)throw Error(r(162));m=n.memoizedProps,d=n.stateNode;try{d.nodeValue=m}catch(ge){vt(n,n.return,ge)}}break;case 3:if(Kd=null,x=pa,pa=Wd(i.containerInfo),Bs(i,n),pa=x,Vs(n),m&4&&d!==null&&d.memoizedState.isDehydrated)try{Gl(i.containerInfo)}catch(ge){vt(n,n.return,ge)}rf&&(rf=!1,bb(n));break;case 4:m=pa,pa=Wd(n.stateNode.containerInfo),Bs(i,n),Vs(n),pa=m;break;case 12:Bs(i,n),Vs(n);break;case 13:Bs(i,n),Vs(n),n.child.flags&8192&&n.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(mf=Ie()),m&4&&(m=n.updateQueue,m!==null&&(n.updateQueue=null,nf(n,m)));break;case 22:x=n.memoizedState!==null;var X=d!==null&&d.memoizedState!==null,ue=lr,ve=Ft;if(lr=ue||x,Ft=ve||X,Bs(i,n),Ft=ve,lr=ue,Vs(n),m&8192)e:for(i=n.stateNode,i._visibility=x?i._visibility&-2:i._visibility|1,x&&(d===null||X||lr||Ft||Dn(n)),d=null,i=n;;){if(i.tag===5||i.tag===26){if(d===null){X=d=i;try{if(j=X.stateNode,x)R=j.style,typeof R.setProperty=="function"?R.setProperty("display","none","important"):R.display="none";else{U=X.stateNode;var Se=X.memoizedProps.style,fe=Se!=null&&Se.hasOwnProperty("display")?Se.display:null;U.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(ge){vt(X,X.return,ge)}}}else if(i.tag===6){if(d===null){X=i;try{X.stateNode.nodeValue=x?"":X.memoizedProps}catch(ge){vt(X,X.return,ge)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;d===i&&(d=null),i=i.return}d===i&&(d=null),i.sibling.return=i.return,i=i.sibling}m&4&&(m=n.updateQueue,m!==null&&(d=m.retryQueue,d!==null&&(m.retryQueue=null,nf(n,d))));break;case 19:Bs(i,n),Vs(n),m&4&&(m=n.updateQueue,m!==null&&(n.updateQueue=null,nf(n,m)));break;case 30:break;case 21:break;default:Bs(i,n),Vs(n)}}function Vs(n){var i=n.flags;if(i&2){try{for(var d,m=n.return;m!==null;){if(ub(m)){d=m;break}m=m.return}if(d==null)throw Error(r(160));switch(d.tag){case 27:var x=d.stateNode,j=sf(n);Pd(n,j,x);break;case 5:var R=d.stateNode;d.flags&32&&(_o(R,""),d.flags&=-33);var U=sf(n);Pd(n,U,R);break;case 3:case 4:var X=d.stateNode.containerInfo,ue=sf(n);af(n,ue,X);break;default:throw Error(r(161))}}catch(ve){vt(n,n.return,ve)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function bb(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;bb(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function Hr(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)fb(n,i.alternate,i),i=i.sibling}function Dn(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:Fr(4,i,i.return),Dn(i);break;case 1:Ra(i,i.return);var d=i.stateNode;typeof d.componentWillUnmount=="function"&&cb(i,i.return,d),Dn(i);break;case 27:Ll(i.stateNode);case 26:case 5:Ra(i,i.return),Dn(i);break;case 22:i.memoizedState===null&&Dn(i);break;case 30:Dn(i);break;default:Dn(i)}n=n.sibling}}function Gr(n,i,d){for(d=d&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var m=i.alternate,x=n,j=i,R=j.flags;switch(j.tag){case 0:case 11:case 15:Gr(x,j,d),kl(4,j);break;case 1:if(Gr(x,j,d),m=j,x=m.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(ue){vt(m,m.return,ue)}if(m=j,x=m.updateQueue,x!==null){var U=m.stateNode;try{var X=x.shared.hiddenCallbacks;if(X!==null)for(x.shared.hiddenCallbacks=null,x=0;x<X.length;x++)Wx(X[x],U)}catch(ue){vt(m,m.return,ue)}}d&&R&64&&lb(j),Tl(j,j.return);break;case 27:mb(j);case 26:case 5:Gr(x,j,d),d&&m===null&&R&4&&db(j),Tl(j,j.return);break;case 12:Gr(x,j,d);break;case 13:Gr(x,j,d),d&&R&4&&xb(x,j);break;case 22:j.memoizedState===null&&Gr(x,j,d),Tl(j,j.return);break;case 30:break;default:Gr(x,j,d)}i=i.sibling}}function of(n,i){var d=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(d=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==d&&(n!=null&&n.refCount++,d!=null&&fl(d))}function lf(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&fl(n))}function Oa(n,i,d,m){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)vb(n,i,d,m),i=i.sibling}function vb(n,i,d,m){var x=i.flags;switch(i.tag){case 0:case 11:case 15:Oa(n,i,d,m),x&2048&&kl(9,i);break;case 1:Oa(n,i,d,m);break;case 3:Oa(n,i,d,m),x&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&fl(n)));break;case 12:if(x&2048){Oa(n,i,d,m),n=i.stateNode;try{var j=i.memoizedProps,R=j.id,U=j.onPostCommit;typeof U=="function"&&U(R,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(X){vt(i,i.return,X)}}else Oa(n,i,d,m);break;case 13:Oa(n,i,d,m);break;case 23:break;case 22:j=i.stateNode,R=i.alternate,i.memoizedState!==null?j._visibility&2?Oa(n,i,d,m):Al(n,i):j._visibility&2?Oa(n,i,d,m):(j._visibility|=2,Vo(n,i,d,m,(i.subtreeFlags&10256)!==0)),x&2048&&of(R,i);break;case 24:Oa(n,i,d,m),x&2048&&lf(i.alternate,i);break;default:Oa(n,i,d,m)}}function Vo(n,i,d,m,x){for(x=x&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var j=n,R=i,U=d,X=m,ue=R.flags;switch(R.tag){case 0:case 11:case 15:Vo(j,R,U,X,x),kl(8,R);break;case 23:break;case 22:var ve=R.stateNode;R.memoizedState!==null?ve._visibility&2?Vo(j,R,U,X,x):Al(j,R):(ve._visibility|=2,Vo(j,R,U,X,x)),x&&ue&2048&&of(R.alternate,R);break;case 24:Vo(j,R,U,X,x),x&&ue&2048&&lf(R.alternate,R);break;default:Vo(j,R,U,X,x)}i=i.sibling}}function Al(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var d=n,m=i,x=m.flags;switch(m.tag){case 22:Al(d,m),x&2048&&of(m.alternate,m);break;case 24:Al(d,m),x&2048&&lf(m.alternate,m);break;default:Al(d,m)}i=i.sibling}}var Ml=8192;function qo(n){if(n.subtreeFlags&Ml)for(n=n.child;n!==null;)wb(n),n=n.sibling}function wb(n){switch(n.tag){case 26:qo(n),n.flags&Ml&&n.memoizedState!==null&&bC(pa,n.memoizedState,n.memoizedProps);break;case 5:qo(n);break;case 3:case 4:var i=pa;pa=Wd(n.stateNode.containerInfo),qo(n),pa=i;break;case 22:n.memoizedState===null&&(i=n.alternate,i!==null&&i.memoizedState!==null?(i=Ml,Ml=16777216,qo(n),Ml=i):qo(n));break;default:qo(n)}}function jb(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function Rl(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var d=0;d<i.length;d++){var m=i[d];hs=m,Nb(m,n)}jb(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)_b(n),n=n.sibling}function _b(n){switch(n.tag){case 0:case 11:case 15:Rl(n),n.flags&2048&&Fr(9,n,n.return);break;case 3:Rl(n);break;case 12:Rl(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,zd(n)):Rl(n);break;default:Rl(n)}}function zd(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var d=0;d<i.length;d++){var m=i[d];hs=m,Nb(m,n)}jb(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:Fr(8,i,i.return),zd(i);break;case 22:d=i.stateNode,d._visibility&2&&(d._visibility&=-3,zd(i));break;default:zd(i)}n=n.sibling}}function Nb(n,i){for(;hs!==null;){var d=hs;switch(d.tag){case 0:case 11:case 15:Fr(8,d,i);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var m=d.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:fl(d.memoizedState.cache)}if(m=d.child,m!==null)m.return=d,hs=m;else e:for(d=n;hs!==null;){m=hs;var x=m.sibling,j=m.return;if(pb(m),m===d){hs=null;break e}if(x!==null){x.return=j,hs=x;break e}hs=j}}}var PE={getCacheForType:function(n){var i=js(ns),d=i.data.get(n);return d===void 0&&(d=n(),i.data.set(n,d)),d}},zE=typeof WeakMap=="function"?WeakMap:Map,ht=0,wt=null,tt=null,nt=0,ft=0,qs=null,Zr=!1,Fo=!1,cf=!1,dr=0,Ut=0,Wr=0,Pn=0,df=0,ra=0,Ho=0,Ol=null,Ds=null,uf=!1,mf=0,$d=1/0,Ld=null,Yr=null,ys=0,Kr=null,Go=null,Zo=0,hf=0,ff=null,Sb=null,Dl=0,pf=null;function Fs(){if((ht&2)!==0&&nt!==0)return nt&-nt;if(L.T!==null){var n=Do;return n!==0?n:jf()}return Bg()}function Eb(){ra===0&&(ra=(nt&536870912)===0||ct?Or():536870912);var n=aa.current;return n!==null&&(n.flags|=32),ra}function Hs(n,i,d){(n===wt&&(ft===2||ft===9)||n.cancelPendingCommit!==null)&&(Wo(n,0),Xr(n,nt,ra,!1)),Dr(n,d),((ht&2)===0||n!==wt)&&(n===wt&&((ht&2)===0&&(Pn|=d),Ut===4&&Xr(n,nt,ra,!1)),Da(n))}function Cb(n,i,d){if((ht&6)!==0)throw Error(r(327));var m=!d&&(i&124)===0&&(i&n.expiredLanes)===0||Lt(n,i),x=m?IE(n,i):yf(n,i,!0),j=m;do{if(x===0){Fo&&!m&&Xr(n,i,0,!1);break}else{if(d=n.current.alternate,j&&!$E(d)){x=yf(n,i,!1),j=!1;continue}if(x===2){if(j=i,n.errorRecoveryDisabledLanes&j)var R=0;else R=n.pendingLanes&-536870913,R=R!==0?R:R&536870912?536870912:0;if(R!==0){i=R;e:{var U=n;x=Ol;var X=U.current.memoizedState.isDehydrated;if(X&&(Wo(U,R).flags|=256),R=yf(U,R,!1),R!==2){if(cf&&!X){U.errorRecoveryDisabledLanes|=j,Pn|=j,x=4;break e}j=Ds,Ds=x,j!==null&&(Ds===null?Ds=j:Ds.push.apply(Ds,j))}x=R}if(j=!1,x!==2)continue}}if(x===1){Wo(n,0),Xr(n,i,0,!0);break}e:{switch(m=n,j=x,j){case 0:case 1:throw Error(r(345));case 4:if((i&4194048)!==i)break;case 6:Xr(m,i,ra,!Zr);break e;case 2:Ds=null;break;case 3:case 5:break;default:throw Error(r(329))}if((i&62914560)===i&&(x=mf+300-Ie(),10<x)){if(Xr(m,i,ra,!Zr),rt(m,0,!0)!==0)break e;m.timeoutHandle=sv(kb.bind(null,m,d,Ds,Ld,uf,i,ra,Pn,Ho,Zr,j,2,-0,0),x);break e}kb(m,d,Ds,Ld,uf,i,ra,Pn,Ho,Zr,j,0,-0,0)}}break}while(!0);Da(n)}function kb(n,i,d,m,x,j,R,U,X,ue,ve,Se,fe,ge){if(n.timeoutHandle=-1,Se=i.subtreeFlags,(Se&8192||(Se&16785408)===16785408)&&(Bl={stylesheets:null,count:0,unsuspend:yC},wb(i),Se=vC(),Se!==null)){n.cancelPendingCommit=Se(Pb.bind(null,n,i,j,d,m,x,R,U,X,ve,1,fe,ge)),Xr(n,j,R,!ue);return}Pb(n,i,j,d,m,x,R,U,X)}function $E(n){for(var i=n;;){var d=i.tag;if((d===0||d===11||d===15)&&i.flags&16384&&(d=i.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var m=0;m<d.length;m++){var x=d[m],j=x.getSnapshot;x=x.value;try{if(!Is(j(),x))return!1}catch{return!1}}if(d=i.child,i.subtreeFlags&16384&&d!==null)d.return=i,i=d;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Xr(n,i,d,m){i&=~df,i&=~Pn,n.suspendedLanes|=i,n.pingedLanes&=~i,m&&(n.warmLanes|=i),m=n.expirationTimes;for(var x=i;0<x;){var j=31-Je(x),R=1<<j;m[j]=-1,x&=~R}d!==0&&Yc(n,d,i)}function Id(){return(ht&6)===0?(Pl(0),!1):!0}function gf(){if(tt!==null){if(ft===0)var n=tt.return;else n=tt,sr=Tn=null,Rh(n),Uo=null,Sl=0,n=tt;for(;n!==null;)ib(n.alternate,n),n=n.return;tt=null}}function Wo(n,i){var d=n.timeoutHandle;d!==-1&&(n.timeoutHandle=-1,tC(d)),d=n.cancelPendingCommit,d!==null&&(n.cancelPendingCommit=null,d()),gf(),wt=n,tt=d=Ja(n.current,null),nt=i,ft=0,qs=null,Zr=!1,Fo=Lt(n,i),cf=!1,Ho=ra=df=Pn=Wr=Ut=0,Ds=Ol=null,uf=!1,(i&8)!==0&&(i|=i&32);var m=n.entangledLanes;if(m!==0)for(n=n.entanglements,m&=i;0<m;){var x=31-Je(m),j=1<<x;i|=n[x],m&=~j}return dr=i,id(),d}function Tb(n,i){Qe=null,L.H=Ed,i===gl||i===gd?(i=Gx(),ft=3):i===qx?(i=Gx(),ft=4):ft=i===Zy?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,qs=i,tt===null&&(Ut=1,Md(n,Js(i,n.current)))}function Ab(){var n=L.H;return L.H=Ed,n===null?Ed:n}function Mb(){var n=L.A;return L.A=PE,n}function xf(){Ut=4,Zr||(nt&4194048)!==nt&&aa.current!==null||(Fo=!0),(Wr&134217727)===0&&(Pn&134217727)===0||wt===null||Xr(wt,nt,ra,!1)}function yf(n,i,d){var m=ht;ht|=2;var x=Ab(),j=Mb();(wt!==n||nt!==i)&&(Ld=null,Wo(n,i)),i=!1;var R=Ut;e:do try{if(ft!==0&&tt!==null){var U=tt,X=qs;switch(ft){case 8:gf(),R=6;break e;case 3:case 2:case 9:case 6:aa.current===null&&(i=!0);var ue=ft;if(ft=0,qs=null,Yo(n,U,X,ue),d&&Fo){R=0;break e}break;default:ue=ft,ft=0,qs=null,Yo(n,U,X,ue)}}LE(),R=Ut;break}catch(ve){Tb(n,ve)}while(!0);return i&&n.shellSuspendCounter++,sr=Tn=null,ht=m,L.H=x,L.A=j,tt===null&&(wt=null,nt=0,id()),R}function LE(){for(;tt!==null;)Rb(tt)}function IE(n,i){var d=ht;ht|=2;var m=Ab(),x=Mb();wt!==n||nt!==i?(Ld=null,$d=Ie()+500,Wo(n,i)):Fo=Lt(n,i);e:do try{if(ft!==0&&tt!==null){i=tt;var j=qs;t:switch(ft){case 1:ft=0,qs=null,Yo(n,i,j,1);break;case 2:case 9:if(Fx(j)){ft=0,qs=null,Ob(i);break}i=function(){ft!==2&&ft!==9||wt!==n||(ft=7),Da(n)},j.then(i,i);break e;case 3:ft=7;break e;case 4:ft=5;break e;case 7:Fx(j)?(ft=0,qs=null,Ob(i)):(ft=0,qs=null,Yo(n,i,j,7));break;case 5:var R=null;switch(tt.tag){case 26:R=tt.memoizedState;case 5:case 27:var U=tt;if(!R||fv(R)){ft=0,qs=null;var X=U.sibling;if(X!==null)tt=X;else{var ue=U.return;ue!==null?(tt=ue,Ud(ue)):tt=null}break t}}ft=0,qs=null,Yo(n,i,j,5);break;case 6:ft=0,qs=null,Yo(n,i,j,6);break;case 8:gf(),Ut=6;break e;default:throw Error(r(462))}}UE();break}catch(ve){Tb(n,ve)}while(!0);return sr=Tn=null,L.H=m,L.A=x,ht=d,tt!==null?0:(wt=null,nt=0,id(),Ut)}function UE(){for(;tt!==null&&!Re();)Rb(tt)}function Rb(n){var i=nb(n.alternate,n,dr);n.memoizedProps=n.pendingProps,i===null?Ud(n):tt=i}function Ob(n){var i=n,d=i.alternate;switch(i.tag){case 15:case 0:i=Jy(d,i,i.pendingProps,i.type,void 0,nt);break;case 11:i=Jy(d,i,i.pendingProps,i.type.render,i.ref,nt);break;case 5:Rh(i);default:ib(d,i),i=tt=Dx(i,dr),i=nb(d,i,dr)}n.memoizedProps=n.pendingProps,i===null?Ud(n):tt=i}function Yo(n,i,d,m){sr=Tn=null,Rh(i),Uo=null,Sl=0;var x=i.return;try{if(TE(n,x,i,d,nt)){Ut=1,Md(n,Js(d,n.current)),tt=null;return}}catch(j){if(x!==null)throw tt=x,j;Ut=1,Md(n,Js(d,n.current)),tt=null;return}i.flags&32768?(ct||m===1?n=!0:Fo||(nt&536870912)!==0?n=!1:(Zr=n=!0,(m===2||m===9||m===3||m===6)&&(m=aa.current,m!==null&&m.tag===13&&(m.flags|=16384))),Db(i,n)):Ud(i)}function Ud(n){var i=n;do{if((i.flags&32768)!==0){Db(i,Zr);return}n=i.return;var d=ME(i.alternate,i,dr);if(d!==null){tt=d;return}if(i=i.sibling,i!==null){tt=i;return}tt=i=n}while(i!==null);Ut===0&&(Ut=5)}function Db(n,i){do{var d=RE(n.alternate,n);if(d!==null){d.flags&=32767,tt=d;return}if(d=n.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!i&&(n=n.sibling,n!==null)){tt=n;return}tt=n=d}while(n!==null);Ut=6,tt=null}function Pb(n,i,d,m,x,j,R,U,X){n.cancelPendingCommit=null;do Bd();while(ys!==0);if((ht&6)!==0)throw Error(r(327));if(i!==null){if(i===n.current)throw Error(r(177));if(j=i.lanes|i.childLanes,j|=ih,Wc(n,d,j,R,U,X),n===wt&&(tt=wt=null,nt=0),Go=i,Kr=n,Zo=d,hf=j,ff=x,Sb=m,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,FE(se,function(){return Ub(),null})):(n.callbackNode=null,n.callbackPriority=0),m=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||m){m=L.T,L.T=null,x=G.p,G.p=2,R=ht,ht|=4;try{OE(n,i,d)}finally{ht=R,G.p=x,L.T=m}}ys=1,zb(),$b(),Lb()}}function zb(){if(ys===1){ys=0;var n=Kr,i=Go,d=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||d){d=L.T,L.T=null;var m=G.p;G.p=2;var x=ht;ht|=4;try{yb(i,n);var j=Af,R=Nx(n.containerInfo),U=j.focusedElem,X=j.selectionRange;if(R!==U&&U&&U.ownerDocument&&_x(U.ownerDocument.documentElement,U)){if(X!==null&&sh(U)){var ue=X.start,ve=X.end;if(ve===void 0&&(ve=ue),"selectionStart"in U)U.selectionStart=ue,U.selectionEnd=Math.min(ve,U.value.length);else{var Se=U.ownerDocument||document,fe=Se&&Se.defaultView||window;if(fe.getSelection){var ge=fe.getSelection(),Ze=U.textContent.length,Fe=Math.min(X.start,Ze),yt=X.end===void 0?Fe:Math.min(X.end,Ze);!ge.extend&&Fe>yt&&(R=yt,yt=Fe,Fe=R);var le=jx(U,Fe),ae=jx(U,yt);if(le&&ae&&(ge.rangeCount!==1||ge.anchorNode!==le.node||ge.anchorOffset!==le.offset||ge.focusNode!==ae.node||ge.focusOffset!==ae.offset)){var ce=Se.createRange();ce.setStart(le.node,le.offset),ge.removeAllRanges(),Fe>yt?(ge.addRange(ce),ge.extend(ae.node,ae.offset)):(ce.setEnd(ae.node,ae.offset),ge.addRange(ce))}}}}for(Se=[],ge=U;ge=ge.parentNode;)ge.nodeType===1&&Se.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof U.focus=="function"&&U.focus(),U=0;U<Se.length;U++){var je=Se[U];je.element.scrollLeft=je.left,je.element.scrollTop=je.top}}Jd=!!Tf,Af=Tf=null}finally{ht=x,G.p=m,L.T=d}}n.current=i,ys=2}}function $b(){if(ys===2){ys=0;var n=Kr,i=Go,d=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||d){d=L.T,L.T=null;var m=G.p;G.p=2;var x=ht;ht|=4;try{fb(n,i.alternate,i)}finally{ht=x,G.p=m,L.T=d}}ys=3}}function Lb(){if(ys===4||ys===3){ys=0,ze();var n=Kr,i=Go,d=Zo,m=Sb;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?ys=5:(ys=0,Go=Kr=null,Ib(n,n.pendingLanes));var x=n.pendingLanes;if(x===0&&(Yr=null),Pm(d),i=i.stateNode,Oe&&typeof Oe.onCommitFiberRoot=="function")try{Oe.onCommitFiberRoot(Te,i,void 0,(i.current.flags&128)===128)}catch{}if(m!==null){i=L.T,x=G.p,G.p=2,L.T=null;try{for(var j=n.onRecoverableError,R=0;R<m.length;R++){var U=m[R];j(U.value,{componentStack:U.stack})}}finally{L.T=i,G.p=x}}(Zo&3)!==0&&Bd(),Da(n),x=n.pendingLanes,(d&4194090)!==0&&(x&42)!==0?n===pf?Dl++:(Dl=0,pf=n):Dl=0,Pl(0)}}function Ib(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,fl(i)))}function Bd(n){return zb(),$b(),Lb(),Ub()}function Ub(){if(ys!==5)return!1;var n=Kr,i=hf;hf=0;var d=Pm(Zo),m=L.T,x=G.p;try{G.p=32>d?32:d,L.T=null,d=ff,ff=null;var j=Kr,R=Zo;if(ys=0,Go=Kr=null,Zo=0,(ht&6)!==0)throw Error(r(331));var U=ht;if(ht|=4,_b(j.current),vb(j,j.current,R,d),ht=U,Pl(0,!1),Oe&&typeof Oe.onPostCommitFiberRoot=="function")try{Oe.onPostCommitFiberRoot(Te,j)}catch{}return!0}finally{G.p=x,L.T=m,Ib(n,i)}}function Bb(n,i,d){i=Js(d,i),i=Gh(n.stateNode,i,2),n=Ur(n,i,2),n!==null&&(Dr(n,2),Da(n))}function vt(n,i,d){if(n.tag===3)Bb(n,n,d);else for(;i!==null;){if(i.tag===3){Bb(i,n,d);break}else if(i.tag===1){var m=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Yr===null||!Yr.has(m))){n=Js(d,n),d=Hy(2),m=Ur(i,d,2),m!==null&&(Gy(d,m,i,n),Dr(m,2),Da(m));break}}i=i.return}}function bf(n,i,d){var m=n.pingCache;if(m===null){m=n.pingCache=new zE;var x=new Set;m.set(i,x)}else x=m.get(i),x===void 0&&(x=new Set,m.set(i,x));x.has(d)||(cf=!0,x.add(d),n=BE.bind(null,n,i,d),i.then(n,n))}function BE(n,i,d){var m=n.pingCache;m!==null&&m.delete(i),n.pingedLanes|=n.suspendedLanes&d,n.warmLanes&=~d,wt===n&&(nt&d)===d&&(Ut===4||Ut===3&&(nt&62914560)===nt&&300>Ie()-mf?(ht&2)===0&&Wo(n,0):df|=d,Ho===nt&&(Ho=0)),Da(n)}function Vb(n,i){i===0&&(i=Qi()),n=Ao(n,i),n!==null&&(Dr(n,i),Da(n))}function VE(n){var i=n.memoizedState,d=0;i!==null&&(d=i.retryLane),Vb(n,d)}function qE(n,i){var d=0;switch(n.tag){case 13:var m=n.stateNode,x=n.memoizedState;x!==null&&(d=x.retryLane);break;case 19:m=n.stateNode;break;case 22:m=n.stateNode._retryCache;break;default:throw Error(r(314))}m!==null&&m.delete(i),Vb(n,d)}function FE(n,i){return we(n,i)}var Vd=null,Ko=null,vf=!1,qd=!1,wf=!1,zn=0;function Da(n){n!==Ko&&n.next===null&&(Ko===null?Vd=Ko=n:Ko=Ko.next=n),qd=!0,vf||(vf=!0,GE())}function Pl(n,i){if(!wf&&qd){wf=!0;do for(var d=!1,m=Vd;m!==null;){if(n!==0){var x=m.pendingLanes;if(x===0)var j=0;else{var R=m.suspendedLanes,U=m.pingedLanes;j=(1<<31-Je(42|n)+1)-1,j&=x&~(R&~U),j=j&201326741?j&201326741|1:j?j|2:0}j!==0&&(d=!0,Gb(m,j))}else j=nt,j=rt(m,m===wt?j:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(j&3)===0||Lt(m,j)||(d=!0,Gb(m,j));m=m.next}while(d);wf=!1}}function HE(){qb()}function qb(){qd=vf=!1;var n=0;zn!==0&&(eC()&&(n=zn),zn=0);for(var i=Ie(),d=null,m=Vd;m!==null;){var x=m.next,j=Fb(m,i);j===0?(m.next=null,d===null?Vd=x:d.next=x,x===null&&(Ko=d)):(d=m,(n!==0||(j&3)!==0)&&(qd=!0)),m=x}Pl(n)}function Fb(n,i){for(var d=n.suspendedLanes,m=n.pingedLanes,x=n.expirationTimes,j=n.pendingLanes&-62914561;0<j;){var R=31-Je(j),U=1<<R,X=x[R];X===-1?((U&d)===0||(U&m)!==0)&&(x[R]=Ta(U,i)):X<=i&&(n.expiredLanes|=U),j&=~U}if(i=wt,d=nt,d=rt(n,n===i?d:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),m=n.callbackNode,d===0||n===i&&(ft===2||ft===9)||n.cancelPendingCommit!==null)return m!==null&&m!==null&&_e(m),n.callbackNode=null,n.callbackPriority=0;if((d&3)===0||Lt(n,d)){if(i=d&-d,i===n.callbackPriority)return i;switch(m!==null&&_e(m),Pm(d)){case 2:case 8:d=Z;break;case 32:d=se;break;case 268435456:d=Ce;break;default:d=se}return m=Hb.bind(null,n),d=we(d,m),n.callbackPriority=i,n.callbackNode=d,i}return m!==null&&m!==null&&_e(m),n.callbackPriority=2,n.callbackNode=null,2}function Hb(n,i){if(ys!==0&&ys!==5)return n.callbackNode=null,n.callbackPriority=0,null;var d=n.callbackNode;if(Bd()&&n.callbackNode!==d)return null;var m=nt;return m=rt(n,n===wt?m:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),m===0?null:(Cb(n,m,i),Fb(n,Ie()),n.callbackNode!=null&&n.callbackNode===d?Hb.bind(null,n):null)}function Gb(n,i){if(Bd())return null;Cb(n,i,!0)}function GE(){sC(function(){(ht&6)!==0?we($e,HE):qb()})}function jf(){return zn===0&&(zn=Or()),zn}function Zb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:ed(""+n)}function Wb(n,i){var d=i.ownerDocument.createElement("input");return d.name=i.name,d.value=i.value,n.id&&d.setAttribute("form",n.id),i.parentNode.insertBefore(d,i),n=new FormData(n),d.parentNode.removeChild(d),n}function ZE(n,i,d,m,x){if(i==="submit"&&d&&d.stateNode===x){var j=Zb((x[As]||null).action),R=m.submitter;R&&(i=(i=R[As]||null)?Zb(i.formAction):R.getAttribute("formAction"),i!==null&&(j=i,R=null));var U=new rd("action","action",null,m,x);n.push({event:U,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(zn!==0){var X=R?Wb(x,R):new FormData(x);Bh(d,{pending:!0,data:X,method:x.method,action:j},null,X)}}else typeof j=="function"&&(U.preventDefault(),X=R?Wb(x,R):new FormData(x),Bh(d,{pending:!0,data:X,method:x.method,action:j},j,X))},currentTarget:x}]})}}for(var _f=0;_f<oh.length;_f++){var Nf=oh[_f],WE=Nf.toLowerCase(),YE=Nf[0].toUpperCase()+Nf.slice(1);fa(WE,"on"+YE)}fa(Cx,"onAnimationEnd"),fa(kx,"onAnimationIteration"),fa(Tx,"onAnimationStart"),fa("dblclick","onDoubleClick"),fa("focusin","onFocus"),fa("focusout","onBlur"),fa(mE,"onTransitionRun"),fa(hE,"onTransitionStart"),fa(fE,"onTransitionCancel"),fa(Ax,"onTransitionEnd"),vo("onMouseEnter",["mouseout","mouseover"]),vo("onMouseLeave",["mouseout","mouseover"]),vo("onPointerEnter",["pointerout","pointerover"]),vo("onPointerLeave",["pointerout","pointerover"]),vn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),vn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),vn("onBeforeInput",["compositionend","keypress","textInput","paste"]),vn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),vn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),vn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var zl="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),KE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(zl));function Yb(n,i){i=(i&4)!==0;for(var d=0;d<n.length;d++){var m=n[d],x=m.event;m=m.listeners;e:{var j=void 0;if(i)for(var R=m.length-1;0<=R;R--){var U=m[R],X=U.instance,ue=U.currentTarget;if(U=U.listener,X!==j&&x.isPropagationStopped())break e;j=U,x.currentTarget=ue;try{j(x)}catch(ve){Ad(ve)}x.currentTarget=null,j=X}else for(R=0;R<m.length;R++){if(U=m[R],X=U.instance,ue=U.currentTarget,U=U.listener,X!==j&&x.isPropagationStopped())break e;j=U,x.currentTarget=ue;try{j(x)}catch(ve){Ad(ve)}x.currentTarget=null,j=X}}}}function st(n,i){var d=i[zm];d===void 0&&(d=i[zm]=new Set);var m=n+"__bubble";d.has(m)||(Kb(i,n,2,!1),d.add(m))}function Sf(n,i,d){var m=0;i&&(m|=4),Kb(d,n,m,i)}var Fd="_reactListening"+Math.random().toString(36).slice(2);function Ef(n){if(!n[Fd]){n[Fd]=!0,qg.forEach(function(d){d!=="selectionchange"&&(KE.has(d)||Sf(d,!1,n),Sf(d,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[Fd]||(i[Fd]=!0,Sf("selectionchange",!1,i))}}function Kb(n,i,d,m){switch(vv(i)){case 2:var x=_C;break;case 8:x=NC;break;default:x=Uf}d=x.bind(null,i,d,n),x=void 0,!Zm||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(x=!0),m?x!==void 0?n.addEventListener(i,d,{capture:!0,passive:x}):n.addEventListener(i,d,!0):x!==void 0?n.addEventListener(i,d,{passive:x}):n.addEventListener(i,d,!1)}function Cf(n,i,d,m,x){var j=m;if((i&1)===0&&(i&2)===0&&m!==null)e:for(;;){if(m===null)return;var R=m.tag;if(R===3||R===4){var U=m.stateNode.containerInfo;if(U===x)break;if(R===4)for(R=m.return;R!==null;){var X=R.tag;if((X===3||X===4)&&R.stateNode.containerInfo===x)return;R=R.return}for(;U!==null;){if(R=xo(U),R===null)return;if(X=R.tag,X===5||X===6||X===26||X===27){m=j=R;continue e}U=U.parentNode}}m=m.return}ax(function(){var ue=j,ve=Hm(d),Se=[];e:{var fe=Mx.get(n);if(fe!==void 0){var ge=rd,Ze=n;switch(n){case"keypress":if(sd(d)===0)break e;case"keydown":case"keyup":ge=FS;break;case"focusin":Ze="focus",ge=Xm;break;case"focusout":Ze="blur",ge=Xm;break;case"beforeblur":case"afterblur":ge=Xm;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=ox;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=RS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=ZS;break;case Cx:case kx:case Tx:ge=PS;break;case Ax:ge=YS;break;case"scroll":case"scrollend":ge=AS;break;case"wheel":ge=XS;break;case"copy":case"cut":case"paste":ge=$S;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=lx;break;case"toggle":case"beforetoggle":ge=JS}var Fe=(i&4)!==0,yt=!Fe&&(n==="scroll"||n==="scrollend"),le=Fe?fe!==null?fe+"Capture":null:fe;Fe=[];for(var ae=ue,ce;ae!==null;){var je=ae;if(ce=je.stateNode,je=je.tag,je!==5&&je!==26&&je!==27||ce===null||le===null||(je=tl(ae,le),je!=null&&Fe.push($l(ae,je,ce))),yt)break;ae=ae.return}0<Fe.length&&(fe=new ge(fe,Ze,null,d,ve),Se.push({event:fe,listeners:Fe}))}}if((i&7)===0){e:{if(fe=n==="mouseover"||n==="pointerover",ge=n==="mouseout"||n==="pointerout",fe&&d!==Fm&&(Ze=d.relatedTarget||d.fromElement)&&(xo(Ze)||Ze[go]))break e;if((ge||fe)&&(fe=ve.window===ve?ve:(fe=ve.ownerDocument)?fe.defaultView||fe.parentWindow:window,ge?(Ze=d.relatedTarget||d.toElement,ge=ue,Ze=Ze?xo(Ze):null,Ze!==null&&(yt=l(Ze),Fe=Ze.tag,Ze!==yt||Fe!==5&&Fe!==27&&Fe!==6)&&(Ze=null)):(ge=null,Ze=ue),ge!==Ze)){if(Fe=ox,je="onMouseLeave",le="onMouseEnter",ae="mouse",(n==="pointerout"||n==="pointerover")&&(Fe=lx,je="onPointerLeave",le="onPointerEnter",ae="pointer"),yt=ge==null?fe:el(ge),ce=Ze==null?fe:el(Ze),fe=new Fe(je,ae+"leave",ge,d,ve),fe.target=yt,fe.relatedTarget=ce,je=null,xo(ve)===ue&&(Fe=new Fe(le,ae+"enter",Ze,d,ve),Fe.target=ce,Fe.relatedTarget=yt,je=Fe),yt=je,ge&&Ze)t:{for(Fe=ge,le=Ze,ae=0,ce=Fe;ce;ce=Xo(ce))ae++;for(ce=0,je=le;je;je=Xo(je))ce++;for(;0<ae-ce;)Fe=Xo(Fe),ae--;for(;0<ce-ae;)le=Xo(le),ce--;for(;ae--;){if(Fe===le||le!==null&&Fe===le.alternate)break t;Fe=Xo(Fe),le=Xo(le)}Fe=null}else Fe=null;ge!==null&&Xb(Se,fe,ge,Fe,!1),Ze!==null&&yt!==null&&Xb(Se,yt,Ze,Fe,!0)}}e:{if(fe=ue?el(ue):window,ge=fe.nodeName&&fe.nodeName.toLowerCase(),ge==="select"||ge==="input"&&fe.type==="file")var Be=gx;else if(fx(fe))if(xx)Be=cE;else{Be=iE;var et=oE}else ge=fe.nodeName,!ge||ge.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?ue&&qm(ue.elementType)&&(Be=gx):Be=lE;if(Be&&(Be=Be(n,ue))){px(Se,Be,d,ve);break e}et&&et(n,fe,ue),n==="focusout"&&ue&&fe.type==="number"&&ue.memoizedProps.value!=null&&Vm(fe,"number",fe.value)}switch(et=ue?el(ue):window,n){case"focusin":(fx(et)||et.contentEditable==="true")&&(Co=et,ah=ue,cl=null);break;case"focusout":cl=ah=Co=null;break;case"mousedown":rh=!0;break;case"contextmenu":case"mouseup":case"dragend":rh=!1,Sx(Se,d,ve);break;case"selectionchange":if(uE)break;case"keydown":case"keyup":Sx(Se,d,ve)}var Ve;if(Jm)e:{switch(n){case"compositionstart":var He="onCompositionStart";break e;case"compositionend":He="onCompositionEnd";break e;case"compositionupdate":He="onCompositionUpdate";break e}He=void 0}else Eo?mx(n,d)&&(He="onCompositionEnd"):n==="keydown"&&d.keyCode===229&&(He="onCompositionStart");He&&(cx&&d.locale!=="ko"&&(Eo||He!=="onCompositionStart"?He==="onCompositionEnd"&&Eo&&(Ve=rx()):(zr=ve,Wm="value"in zr?zr.value:zr.textContent,Eo=!0)),et=Hd(ue,He),0<et.length&&(He=new ix(He,n,null,d,ve),Se.push({event:He,listeners:et}),Ve?He.data=Ve:(Ve=hx(d),Ve!==null&&(He.data=Ve)))),(Ve=tE?sE(n,d):aE(n,d))&&(He=Hd(ue,"onBeforeInput"),0<He.length&&(et=new ix("onBeforeInput","beforeinput",null,d,ve),Se.push({event:et,listeners:He}),et.data=Ve)),ZE(Se,n,ue,d,ve)}Yb(Se,i)})}function $l(n,i,d){return{instance:n,listener:i,currentTarget:d}}function Hd(n,i){for(var d=i+"Capture",m=[];n!==null;){var x=n,j=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||j===null||(x=tl(n,d),x!=null&&m.unshift($l(n,x,j)),x=tl(n,i),x!=null&&m.push($l(n,x,j))),n.tag===3)return m;n=n.return}return[]}function Xo(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Xb(n,i,d,m,x){for(var j=i._reactName,R=[];d!==null&&d!==m;){var U=d,X=U.alternate,ue=U.stateNode;if(U=U.tag,X!==null&&X===m)break;U!==5&&U!==26&&U!==27||ue===null||(X=ue,x?(ue=tl(d,j),ue!=null&&R.unshift($l(d,ue,X))):x||(ue=tl(d,j),ue!=null&&R.push($l(d,ue,X)))),d=d.return}R.length!==0&&n.push({event:i,listeners:R})}var XE=/\r\n?/g,QE=/\u0000|\uFFFD/g;function Qb(n){return(typeof n=="string"?n:""+n).replace(XE,`
`).replace(QE,"")}function Jb(n,i){return i=Qb(i),Qb(n)===i}function Gd(){}function xt(n,i,d,m,x,j){switch(d){case"children":typeof m=="string"?i==="body"||i==="textarea"&&m===""||_o(n,m):(typeof m=="number"||typeof m=="bigint")&&i!=="body"&&_o(n,""+m);break;case"className":Xc(n,"class",m);break;case"tabIndex":Xc(n,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":Xc(n,d,m);break;case"style":tx(n,m,j);break;case"data":if(i!=="object"){Xc(n,"data",m);break}case"src":case"href":if(m===""&&(i!=="a"||d!=="href")){n.removeAttribute(d);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){n.removeAttribute(d);break}m=ed(""+m),n.setAttribute(d,m);break;case"action":case"formAction":if(typeof m=="function"){n.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof j=="function"&&(d==="formAction"?(i!=="input"&&xt(n,i,"name",x.name,x,null),xt(n,i,"formEncType",x.formEncType,x,null),xt(n,i,"formMethod",x.formMethod,x,null),xt(n,i,"formTarget",x.formTarget,x,null)):(xt(n,i,"encType",x.encType,x,null),xt(n,i,"method",x.method,x,null),xt(n,i,"target",x.target,x,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){n.removeAttribute(d);break}m=ed(""+m),n.setAttribute(d,m);break;case"onClick":m!=null&&(n.onclick=Gd);break;case"onScroll":m!=null&&st("scroll",n);break;case"onScrollEnd":m!=null&&st("scrollend",n);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(r(61));if(d=m.__html,d!=null){if(x.children!=null)throw Error(r(60));n.innerHTML=d}}break;case"multiple":n.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":n.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){n.removeAttribute("xlink:href");break}d=ed(""+m),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?n.setAttribute(d,""+m):n.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?n.setAttribute(d,""):n.removeAttribute(d);break;case"capture":case"download":m===!0?n.setAttribute(d,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?n.setAttribute(d,m):n.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?n.setAttribute(d,m):n.removeAttribute(d);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?n.removeAttribute(d):n.setAttribute(d,m);break;case"popover":st("beforetoggle",n),st("toggle",n),Kc(n,"popover",m);break;case"xlinkActuate":Xa(n,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":Xa(n,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":Xa(n,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":Xa(n,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":Xa(n,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":Xa(n,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":Xa(n,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":Xa(n,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":Xa(n,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":Kc(n,"is",m);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=kS.get(d)||d,Kc(n,d,m))}}function kf(n,i,d,m,x,j){switch(d){case"style":tx(n,m,j);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(r(61));if(d=m.__html,d!=null){if(x.children!=null)throw Error(r(60));n.innerHTML=d}}break;case"children":typeof m=="string"?_o(n,m):(typeof m=="number"||typeof m=="bigint")&&_o(n,""+m);break;case"onScroll":m!=null&&st("scroll",n);break;case"onScrollEnd":m!=null&&st("scrollend",n);break;case"onClick":m!=null&&(n.onclick=Gd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Fg.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(x=d.endsWith("Capture"),i=d.slice(2,x?d.length-7:void 0),j=n[As]||null,j=j!=null?j[d]:null,typeof j=="function"&&n.removeEventListener(i,j,x),typeof m=="function")){typeof j!="function"&&j!==null&&(d in n?n[d]=null:n.hasAttribute(d)&&n.removeAttribute(d)),n.addEventListener(i,m,x);break e}d in n?n[d]=m:m===!0?n.setAttribute(d,""):Kc(n,d,m)}}}function bs(n,i,d){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":st("error",n),st("load",n);var m=!1,x=!1,j;for(j in d)if(d.hasOwnProperty(j)){var R=d[j];if(R!=null)switch(j){case"src":m=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:xt(n,i,j,R,d,null)}}x&&xt(n,i,"srcSet",d.srcSet,d,null),m&&xt(n,i,"src",d.src,d,null);return;case"input":st("invalid",n);var U=j=R=x=null,X=null,ue=null;for(m in d)if(d.hasOwnProperty(m)){var ve=d[m];if(ve!=null)switch(m){case"name":x=ve;break;case"type":R=ve;break;case"checked":X=ve;break;case"defaultChecked":ue=ve;break;case"value":j=ve;break;case"defaultValue":U=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(r(137,i));break;default:xt(n,i,m,ve,d,null)}}Xg(n,j,U,X,ue,R,x,!1),Qc(n);return;case"select":st("invalid",n),m=R=j=null;for(x in d)if(d.hasOwnProperty(x)&&(U=d[x],U!=null))switch(x){case"value":j=U;break;case"defaultValue":R=U;break;case"multiple":m=U;default:xt(n,i,x,U,d,null)}i=j,d=R,n.multiple=!!m,i!=null?jo(n,!!m,i,!1):d!=null&&jo(n,!!m,d,!0);return;case"textarea":st("invalid",n),j=x=m=null;for(R in d)if(d.hasOwnProperty(R)&&(U=d[R],U!=null))switch(R){case"value":m=U;break;case"defaultValue":x=U;break;case"children":j=U;break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(r(91));break;default:xt(n,i,R,U,d,null)}Jg(n,m,x,j),Qc(n);return;case"option":for(X in d)if(d.hasOwnProperty(X)&&(m=d[X],m!=null))switch(X){case"selected":n.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:xt(n,i,X,m,d,null)}return;case"dialog":st("beforetoggle",n),st("toggle",n),st("cancel",n),st("close",n);break;case"iframe":case"object":st("load",n);break;case"video":case"audio":for(m=0;m<zl.length;m++)st(zl[m],n);break;case"image":st("error",n),st("load",n);break;case"details":st("toggle",n);break;case"embed":case"source":case"link":st("error",n),st("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(ue in d)if(d.hasOwnProperty(ue)&&(m=d[ue],m!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:xt(n,i,ue,m,d,null)}return;default:if(qm(i)){for(ve in d)d.hasOwnProperty(ve)&&(m=d[ve],m!==void 0&&kf(n,i,ve,m,d,void 0));return}}for(U in d)d.hasOwnProperty(U)&&(m=d[U],m!=null&&xt(n,i,U,m,d,null))}function JE(n,i,d,m){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,j=null,R=null,U=null,X=null,ue=null,ve=null;for(ge in d){var Se=d[ge];if(d.hasOwnProperty(ge)&&Se!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":X=Se;default:m.hasOwnProperty(ge)||xt(n,i,ge,null,m,Se)}}for(var fe in m){var ge=m[fe];if(Se=d[fe],m.hasOwnProperty(fe)&&(ge!=null||Se!=null))switch(fe){case"type":j=ge;break;case"name":x=ge;break;case"checked":ue=ge;break;case"defaultChecked":ve=ge;break;case"value":R=ge;break;case"defaultValue":U=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,i));break;default:ge!==Se&&xt(n,i,fe,ge,m,Se)}}Bm(n,R,U,X,ue,ve,j,x);return;case"select":ge=R=U=fe=null;for(j in d)if(X=d[j],d.hasOwnProperty(j)&&X!=null)switch(j){case"value":break;case"multiple":ge=X;default:m.hasOwnProperty(j)||xt(n,i,j,null,m,X)}for(x in m)if(j=m[x],X=d[x],m.hasOwnProperty(x)&&(j!=null||X!=null))switch(x){case"value":fe=j;break;case"defaultValue":U=j;break;case"multiple":R=j;default:j!==X&&xt(n,i,x,j,m,X)}i=U,d=R,m=ge,fe!=null?jo(n,!!d,fe,!1):!!m!=!!d&&(i!=null?jo(n,!!d,i,!0):jo(n,!!d,d?[]:"",!1));return;case"textarea":ge=fe=null;for(U in d)if(x=d[U],d.hasOwnProperty(U)&&x!=null&&!m.hasOwnProperty(U))switch(U){case"value":break;case"children":break;default:xt(n,i,U,null,m,x)}for(R in m)if(x=m[R],j=d[R],m.hasOwnProperty(R)&&(x!=null||j!=null))switch(R){case"value":fe=x;break;case"defaultValue":ge=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==j&&xt(n,i,R,x,m,j)}Qg(n,fe,ge);return;case"option":for(var Ze in d)if(fe=d[Ze],d.hasOwnProperty(Ze)&&fe!=null&&!m.hasOwnProperty(Ze))switch(Ze){case"selected":n.selected=!1;break;default:xt(n,i,Ze,null,m,fe)}for(X in m)if(fe=m[X],ge=d[X],m.hasOwnProperty(X)&&fe!==ge&&(fe!=null||ge!=null))switch(X){case"selected":n.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:xt(n,i,X,fe,m,ge)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Fe in d)fe=d[Fe],d.hasOwnProperty(Fe)&&fe!=null&&!m.hasOwnProperty(Fe)&&xt(n,i,Fe,null,m,fe);for(ue in m)if(fe=m[ue],ge=d[ue],m.hasOwnProperty(ue)&&fe!==ge&&(fe!=null||ge!=null))switch(ue){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(r(137,i));break;default:xt(n,i,ue,fe,m,ge)}return;default:if(qm(i)){for(var yt in d)fe=d[yt],d.hasOwnProperty(yt)&&fe!==void 0&&!m.hasOwnProperty(yt)&&kf(n,i,yt,void 0,m,fe);for(ve in m)fe=m[ve],ge=d[ve],!m.hasOwnProperty(ve)||fe===ge||fe===void 0&&ge===void 0||kf(n,i,ve,fe,m,ge);return}}for(var le in d)fe=d[le],d.hasOwnProperty(le)&&fe!=null&&!m.hasOwnProperty(le)&&xt(n,i,le,null,m,fe);for(Se in m)fe=m[Se],ge=d[Se],!m.hasOwnProperty(Se)||fe===ge||fe==null&&ge==null||xt(n,i,Se,fe,m,ge)}var Tf=null,Af=null;function Zd(n){return n.nodeType===9?n:n.ownerDocument}function ev(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function tv(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function Mf(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Rf=null;function eC(){var n=window.event;return n&&n.type==="popstate"?n===Rf?!1:(Rf=n,!0):(Rf=null,!1)}var sv=typeof setTimeout=="function"?setTimeout:void 0,tC=typeof clearTimeout=="function"?clearTimeout:void 0,av=typeof Promise=="function"?Promise:void 0,sC=typeof queueMicrotask=="function"?queueMicrotask:typeof av<"u"?function(n){return av.resolve(null).then(n).catch(aC)}:sv;function aC(n){setTimeout(function(){throw n})}function Qr(n){return n==="head"}function rv(n,i){var d=i,m=0,x=0;do{var j=d.nextSibling;if(n.removeChild(d),j&&j.nodeType===8)if(d=j.data,d==="/$"){if(0<m&&8>m){d=m;var R=n.ownerDocument;if(d&1&&Ll(R.documentElement),d&2&&Ll(R.body),d&4)for(d=R.head,Ll(d),R=d.firstChild;R;){var U=R.nextSibling,X=R.nodeName;R[Ji]||X==="SCRIPT"||X==="STYLE"||X==="LINK"&&R.rel.toLowerCase()==="stylesheet"||d.removeChild(R),R=U}}if(x===0){n.removeChild(j),Gl(i);return}x--}else d==="$"||d==="$?"||d==="$!"?x++:m=d.charCodeAt(0)-48;else m=0;d=j}while(d);Gl(i)}function Of(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var d=i;switch(i=i.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":Of(d),$m(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}n.removeChild(d)}}function rC(n,i,d,m){for(;n.nodeType===1;){var x=d;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!m&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(m){if(!n[Ji])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(j=n.getAttribute("rel"),j==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(j!==x.rel||n.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||n.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||n.getAttribute("title")!==(x.title==null?null:x.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(j=n.getAttribute("src"),(j!==(x.src==null?null:x.src)||n.getAttribute("type")!==(x.type==null?null:x.type)||n.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&j&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var j=x.name==null?null:""+x.name;if(x.type==="hidden"&&n.getAttribute("name")===j)return n}else return n;if(n=ga(n.nextSibling),n===null)break}return null}function nC(n,i,d){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!d||(n=ga(n.nextSibling),n===null))return null;return n}function Df(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState==="complete"}function oC(n,i){var d=n.ownerDocument;if(n.data!=="$?"||d.readyState==="complete")i();else{var m=function(){i(),d.removeEventListener("DOMContentLoaded",m)};d.addEventListener("DOMContentLoaded",m),n._reactRetry=m}}function ga(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return n}var Pf=null;function nv(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var d=n.data;if(d==="$"||d==="$!"||d==="$?"){if(i===0)return n;i--}else d==="/$"&&i++}n=n.previousSibling}return null}function ov(n,i,d){switch(i=Zd(d),n){case"html":if(n=i.documentElement,!n)throw Error(r(452));return n;case"head":if(n=i.head,!n)throw Error(r(453));return n;case"body":if(n=i.body,!n)throw Error(r(454));return n;default:throw Error(r(451))}}function Ll(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);$m(n)}var na=new Map,iv=new Set;function Wd(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var ur=G.d;G.d={f:iC,r:lC,D:cC,C:dC,L:uC,m:mC,X:fC,S:hC,M:pC};function iC(){var n=ur.f(),i=Id();return n||i}function lC(n){var i=yo(n);i!==null&&i.tag===5&&i.type==="form"?Cy(i):ur.r(n)}var Qo=typeof document>"u"?null:document;function lv(n,i,d){var m=Qo;if(m&&typeof i=="string"&&i){var x=Qs(i);x='link[rel="'+n+'"][href="'+x+'"]',typeof d=="string"&&(x+='[crossorigin="'+d+'"]'),iv.has(x)||(iv.add(x),n={rel:n,crossOrigin:d,href:i},m.querySelector(x)===null&&(i=m.createElement("link"),bs(i,"link",n),us(i),m.head.appendChild(i)))}}function cC(n){ur.D(n),lv("dns-prefetch",n,null)}function dC(n,i){ur.C(n,i),lv("preconnect",n,i)}function uC(n,i,d){ur.L(n,i,d);var m=Qo;if(m&&n&&i){var x='link[rel="preload"][as="'+Qs(i)+'"]';i==="image"&&d&&d.imageSrcSet?(x+='[imagesrcset="'+Qs(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(x+='[imagesizes="'+Qs(d.imageSizes)+'"]')):x+='[href="'+Qs(n)+'"]';var j=x;switch(i){case"style":j=Jo(n);break;case"script":j=ei(n)}na.has(j)||(n=p({rel:"preload",href:i==="image"&&d&&d.imageSrcSet?void 0:n,as:i},d),na.set(j,n),m.querySelector(x)!==null||i==="style"&&m.querySelector(Il(j))||i==="script"&&m.querySelector(Ul(j))||(i=m.createElement("link"),bs(i,"link",n),us(i),m.head.appendChild(i)))}}function mC(n,i){ur.m(n,i);var d=Qo;if(d&&n){var m=i&&typeof i.as=="string"?i.as:"script",x='link[rel="modulepreload"][as="'+Qs(m)+'"][href="'+Qs(n)+'"]',j=x;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":j=ei(n)}if(!na.has(j)&&(n=p({rel:"modulepreload",href:n},i),na.set(j,n),d.querySelector(x)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(Ul(j)))return}m=d.createElement("link"),bs(m,"link",n),us(m),d.head.appendChild(m)}}}function hC(n,i,d){ur.S(n,i,d);var m=Qo;if(m&&n){var x=bo(m).hoistableStyles,j=Jo(n);i=i||"default";var R=x.get(j);if(!R){var U={loading:0,preload:null};if(R=m.querySelector(Il(j)))U.loading=5;else{n=p({rel:"stylesheet",href:n,"data-precedence":i},d),(d=na.get(j))&&zf(n,d);var X=R=m.createElement("link");us(X),bs(X,"link",n),X._p=new Promise(function(ue,ve){X.onload=ue,X.onerror=ve}),X.addEventListener("load",function(){U.loading|=1}),X.addEventListener("error",function(){U.loading|=2}),U.loading|=4,Yd(R,i,m)}R={type:"stylesheet",instance:R,count:1,state:U},x.set(j,R)}}}function fC(n,i){ur.X(n,i);var d=Qo;if(d&&n){var m=bo(d).hoistableScripts,x=ei(n),j=m.get(x);j||(j=d.querySelector(Ul(x)),j||(n=p({src:n,async:!0},i),(i=na.get(x))&&$f(n,i),j=d.createElement("script"),us(j),bs(j,"link",n),d.head.appendChild(j)),j={type:"script",instance:j,count:1,state:null},m.set(x,j))}}function pC(n,i){ur.M(n,i);var d=Qo;if(d&&n){var m=bo(d).hoistableScripts,x=ei(n),j=m.get(x);j||(j=d.querySelector(Ul(x)),j||(n=p({src:n,async:!0,type:"module"},i),(i=na.get(x))&&$f(n,i),j=d.createElement("script"),us(j),bs(j,"link",n),d.head.appendChild(j)),j={type:"script",instance:j,count:1,state:null},m.set(x,j))}}function cv(n,i,d,m){var x=(x=oe.current)?Wd(x):null;if(!x)throw Error(r(446));switch(n){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(i=Jo(d.href),d=bo(x).hoistableStyles,m=d.get(i),m||(m={type:"style",instance:null,count:0,state:null},d.set(i,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){n=Jo(d.href);var j=bo(x).hoistableStyles,R=j.get(n);if(R||(x=x.ownerDocument||x,R={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},j.set(n,R),(j=x.querySelector(Il(n)))&&!j._p&&(R.instance=j,R.state.loading=5),na.has(n)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},na.set(n,d),j||gC(x,n,d,R.state))),i&&m===null)throw Error(r(528,""));return R}if(i&&m!==null)throw Error(r(529,""));return null;case"script":return i=d.async,d=d.src,typeof d=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=ei(d),d=bo(x).hoistableScripts,m=d.get(i),m||(m={type:"script",instance:null,count:0,state:null},d.set(i,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,n))}}function Jo(n){return'href="'+Qs(n)+'"'}function Il(n){return'link[rel="stylesheet"]['+n+"]"}function dv(n){return p({},n,{"data-precedence":n.precedence,precedence:null})}function gC(n,i,d,m){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?m.loading=1:(i=n.createElement("link"),m.preload=i,i.addEventListener("load",function(){return m.loading|=1}),i.addEventListener("error",function(){return m.loading|=2}),bs(i,"link",d),us(i),n.head.appendChild(i))}function ei(n){return'[src="'+Qs(n)+'"]'}function Ul(n){return"script[async]"+n}function uv(n,i,d){if(i.count++,i.instance===null)switch(i.type){case"style":var m=n.querySelector('style[data-href~="'+Qs(d.href)+'"]');if(m)return i.instance=m,us(m),m;var x=p({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return m=(n.ownerDocument||n).createElement("style"),us(m),bs(m,"style",x),Yd(m,d.precedence,n),i.instance=m;case"stylesheet":x=Jo(d.href);var j=n.querySelector(Il(x));if(j)return i.state.loading|=4,i.instance=j,us(j),j;m=dv(d),(x=na.get(x))&&zf(m,x),j=(n.ownerDocument||n).createElement("link"),us(j);var R=j;return R._p=new Promise(function(U,X){R.onload=U,R.onerror=X}),bs(j,"link",m),i.state.loading|=4,Yd(j,d.precedence,n),i.instance=j;case"script":return j=ei(d.src),(x=n.querySelector(Ul(j)))?(i.instance=x,us(x),x):(m=d,(x=na.get(j))&&(m=p({},d),$f(m,x)),n=n.ownerDocument||n,x=n.createElement("script"),us(x),bs(x,"link",m),n.head.appendChild(x),i.instance=x);case"void":return null;default:throw Error(r(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(m=i.instance,i.state.loading|=4,Yd(m,d.precedence,n));return i.instance}function Yd(n,i,d){for(var m=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=m.length?m[m.length-1]:null,j=x,R=0;R<m.length;R++){var U=m[R];if(U.dataset.precedence===i)j=U;else if(j!==x)break}j?j.parentNode.insertBefore(n,j.nextSibling):(i=d.nodeType===9?d.head:d,i.insertBefore(n,i.firstChild))}function zf(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function $f(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var Kd=null;function mv(n,i,d){if(Kd===null){var m=new Map,x=Kd=new Map;x.set(d,m)}else x=Kd,m=x.get(d),m||(m=new Map,x.set(d,m));if(m.has(n))return m;for(m.set(n,null),d=d.getElementsByTagName(n),x=0;x<d.length;x++){var j=d[x];if(!(j[Ji]||j[ws]||n==="link"&&j.getAttribute("rel")==="stylesheet")&&j.namespaceURI!=="http://www.w3.org/2000/svg"){var R=j.getAttribute(i)||"";R=n+R;var U=m.get(R);U?U.push(j):m.set(R,[j])}}return m}function hv(n,i,d){n=n.ownerDocument||n,n.head.insertBefore(d,i==="title"?n.querySelector("head > title"):null)}function xC(n,i,d){if(d===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return n=i.disabled,typeof i.precedence=="string"&&n==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function fv(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}var Bl=null;function yC(){}function bC(n,i,d){if(Bl===null)throw Error(r(475));var m=Bl;if(i.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var x=Jo(d.href),j=n.querySelector(Il(x));if(j){n=j._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(m.count++,m=Xd.bind(m),n.then(m,m)),i.state.loading|=4,i.instance=j,us(j);return}j=n.ownerDocument||n,d=dv(d),(x=na.get(x))&&zf(d,x),j=j.createElement("link"),us(j);var R=j;R._p=new Promise(function(U,X){R.onload=U,R.onerror=X}),bs(j,"link",d),i.instance=j}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(i,n),(n=i.state.preload)&&(i.state.loading&3)===0&&(m.count++,i=Xd.bind(m),n.addEventListener("load",i),n.addEventListener("error",i))}}function vC(){if(Bl===null)throw Error(r(475));var n=Bl;return n.stylesheets&&n.count===0&&Lf(n,n.stylesheets),0<n.count?function(i){var d=setTimeout(function(){if(n.stylesheets&&Lf(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4);return n.unsuspend=i,function(){n.unsuspend=null,clearTimeout(d)}}:null}function Xd(){if(this.count--,this.count===0){if(this.stylesheets)Lf(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Qd=null;function Lf(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Qd=new Map,i.forEach(wC,n),Qd=null,Xd.call(n))}function wC(n,i){if(!(i.state.loading&4)){var d=Qd.get(n);if(d)var m=d.get(null);else{d=new Map,Qd.set(n,d);for(var x=n.querySelectorAll("link[data-precedence],style[data-precedence]"),j=0;j<x.length;j++){var R=x[j];(R.nodeName==="LINK"||R.getAttribute("media")!=="not all")&&(d.set(R.dataset.precedence,R),m=R)}m&&d.set(null,m)}x=i.instance,R=x.getAttribute("data-precedence"),j=d.get(R)||m,j===m&&d.set(null,x),d.set(R,x),this.count++,m=Xd.bind(this),x.addEventListener("load",m),x.addEventListener("error",m),j?j.parentNode.insertBefore(x,j.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(x,n.firstChild)),i.state.loading|=4}}var Vl={$$typeof:k,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function jC(n,i,d,m,x,j,R,U){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=po(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=po(0),this.hiddenUpdates=po(null),this.identifierPrefix=m,this.onUncaughtError=x,this.onCaughtError=j,this.onRecoverableError=R,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function pv(n,i,d,m,x,j,R,U,X,ue,ve,Se){return n=new jC(n,i,d,R,U,X,ue,Se),i=1,j===!0&&(i|=24),j=Us(3,null,null,i),n.current=j,j.stateNode=n,i=yh(),i.refCount++,n.pooledCache=i,i.refCount++,j.memoizedState={element:m,isDehydrated:d,cache:i},jh(j),n}function gv(n){return n?(n=Mo,n):Mo}function xv(n,i,d,m,x,j){x=gv(x),m.context===null?m.context=x:m.pendingContext=x,m=Ir(i),m.payload={element:d},j=j===void 0?null:j,j!==null&&(m.callback=j),d=Ur(n,m,i),d!==null&&(Hs(d,n,i),yl(d,n,i))}function yv(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var d=n.retryLane;n.retryLane=d!==0&&d<i?d:i}}function If(n,i){yv(n,i),(n=n.alternate)&&yv(n,i)}function bv(n){if(n.tag===13){var i=Ao(n,67108864);i!==null&&Hs(i,n,67108864),If(n,67108864)}}var Jd=!0;function _C(n,i,d,m){var x=L.T;L.T=null;var j=G.p;try{G.p=2,Uf(n,i,d,m)}finally{G.p=j,L.T=x}}function NC(n,i,d,m){var x=L.T;L.T=null;var j=G.p;try{G.p=8,Uf(n,i,d,m)}finally{G.p=j,L.T=x}}function Uf(n,i,d,m){if(Jd){var x=Bf(m);if(x===null)Cf(n,i,m,eu,d),wv(n,m);else if(EC(x,n,i,d,m))m.stopPropagation();else if(wv(n,m),i&4&&-1<SC.indexOf(n)){for(;x!==null;){var j=yo(x);if(j!==null)switch(j.tag){case 3:if(j=j.stateNode,j.current.memoizedState.isDehydrated){var R=Le(j.pendingLanes);if(R!==0){var U=j;for(U.pendingLanes|=2,U.entangledLanes|=2;R;){var X=1<<31-Je(R);U.entanglements[1]|=X,R&=~X}Da(j),(ht&6)===0&&($d=Ie()+500,Pl(0))}}break;case 13:U=Ao(j,2),U!==null&&Hs(U,j,2),Id(),If(j,2)}if(j=Bf(m),j===null&&Cf(n,i,m,eu,d),j===x)break;x=j}x!==null&&m.stopPropagation()}else Cf(n,i,m,null,d)}}function Bf(n){return n=Hm(n),Vf(n)}var eu=null;function Vf(n){if(eu=null,n=xo(n),n!==null){var i=l(n);if(i===null)n=null;else{var d=i.tag;if(d===13){if(n=c(i),n!==null)return n;n=null}else if(d===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return eu=n,null}function vv(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(Me()){case $e:return 2;case Z:return 8;case se:case de:return 32;case Ce:return 268435456;default:return 32}default:return 32}}var qf=!1,Jr=null,en=null,tn=null,ql=new Map,Fl=new Map,sn=[],SC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function wv(n,i){switch(n){case"focusin":case"focusout":Jr=null;break;case"dragenter":case"dragleave":en=null;break;case"mouseover":case"mouseout":tn=null;break;case"pointerover":case"pointerout":ql.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Fl.delete(i.pointerId)}}function Hl(n,i,d,m,x,j){return n===null||n.nativeEvent!==j?(n={blockedOn:i,domEventName:d,eventSystemFlags:m,nativeEvent:j,targetContainers:[x]},i!==null&&(i=yo(i),i!==null&&bv(i)),n):(n.eventSystemFlags|=m,i=n.targetContainers,x!==null&&i.indexOf(x)===-1&&i.push(x),n)}function EC(n,i,d,m,x){switch(i){case"focusin":return Jr=Hl(Jr,n,i,d,m,x),!0;case"dragenter":return en=Hl(en,n,i,d,m,x),!0;case"mouseover":return tn=Hl(tn,n,i,d,m,x),!0;case"pointerover":var j=x.pointerId;return ql.set(j,Hl(ql.get(j)||null,n,i,d,m,x)),!0;case"gotpointercapture":return j=x.pointerId,Fl.set(j,Hl(Fl.get(j)||null,n,i,d,m,x)),!0}return!1}function jv(n){var i=xo(n.target);if(i!==null){var d=l(i);if(d!==null){if(i=d.tag,i===13){if(i=c(d),i!==null){n.blockedOn=i,bS(n.priority,function(){if(d.tag===13){var m=Fs();m=bn(m);var x=Ao(d,m);x!==null&&Hs(x,d,m),If(d,m)}});return}}else if(i===3&&d.stateNode.current.memoizedState.isDehydrated){n.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}n.blockedOn=null}function tu(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var d=Bf(n.nativeEvent);if(d===null){d=n.nativeEvent;var m=new d.constructor(d.type,d);Fm=m,d.target.dispatchEvent(m),Fm=null}else return i=yo(d),i!==null&&bv(i),n.blockedOn=d,!1;i.shift()}return!0}function _v(n,i,d){tu(n)&&d.delete(i)}function CC(){qf=!1,Jr!==null&&tu(Jr)&&(Jr=null),en!==null&&tu(en)&&(en=null),tn!==null&&tu(tn)&&(tn=null),ql.forEach(_v),Fl.forEach(_v)}function su(n,i){n.blockedOn===i&&(n.blockedOn=null,qf||(qf=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,CC)))}var au=null;function Nv(n){au!==n&&(au=n,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){au===n&&(au=null);for(var i=0;i<n.length;i+=3){var d=n[i],m=n[i+1],x=n[i+2];if(typeof m!="function"){if(Vf(m||d)===null)continue;break}var j=yo(d);j!==null&&(n.splice(i,3),i-=3,Bh(j,{pending:!0,data:x,method:d.method,action:m},m,x))}}))}function Gl(n){function i(X){return su(X,n)}Jr!==null&&su(Jr,n),en!==null&&su(en,n),tn!==null&&su(tn,n),ql.forEach(i),Fl.forEach(i);for(var d=0;d<sn.length;d++){var m=sn[d];m.blockedOn===n&&(m.blockedOn=null)}for(;0<sn.length&&(d=sn[0],d.blockedOn===null);)jv(d),d.blockedOn===null&&sn.shift();if(d=(n.ownerDocument||n).$$reactFormReplay,d!=null)for(m=0;m<d.length;m+=3){var x=d[m],j=d[m+1],R=x[As]||null;if(typeof j=="function")R||Nv(d);else if(R){var U=null;if(j&&j.hasAttribute("formAction")){if(x=j,R=j[As]||null)U=R.formAction;else if(Vf(x)!==null)continue}else U=R.action;typeof U=="function"?d[m+1]=U:(d.splice(m,3),m-=3),Nv(d)}}}function Ff(n){this._internalRoot=n}ru.prototype.render=Ff.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(r(409));var d=i.current,m=Fs();xv(d,m,n,i,null,null)},ru.prototype.unmount=Ff.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;xv(n.current,2,null,n,null,null),Id(),i[go]=null}};function ru(n){this._internalRoot=n}ru.prototype.unstable_scheduleHydration=function(n){if(n){var i=Bg();n={blockedOn:null,target:n,priority:i};for(var d=0;d<sn.length&&i!==0&&i<sn[d].priority;d++);sn.splice(d,0,n),d===0&&jv(n)}};var Sv=s.version;if(Sv!=="19.1.0")throw Error(r(527,Sv,"19.1.0"));G.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=h(i),n=n!==null?f(n):null,n=n===null?null:n.stateNode,n};var kC={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:L,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var nu=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!nu.isDisabled&&nu.supportsFiber)try{Te=nu.inject(kC),Oe=nu}catch{}}return Wl.createRoot=function(n,i){if(!o(n))throw Error(r(299));var d=!1,m="",x=By,j=Vy,R=qy,U=null;return i!=null&&(i.unstable_strictMode===!0&&(d=!0),i.identifierPrefix!==void 0&&(m=i.identifierPrefix),i.onUncaughtError!==void 0&&(x=i.onUncaughtError),i.onCaughtError!==void 0&&(j=i.onCaughtError),i.onRecoverableError!==void 0&&(R=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(U=i.unstable_transitionCallbacks)),i=pv(n,1,!1,null,null,d,m,x,j,R,U,null),n[go]=i.current,Ef(n),new Ff(i)},Wl.hydrateRoot=function(n,i,d){if(!o(n))throw Error(r(299));var m=!1,x="",j=By,R=Vy,U=qy,X=null,ue=null;return d!=null&&(d.unstable_strictMode===!0&&(m=!0),d.identifierPrefix!==void 0&&(x=d.identifierPrefix),d.onUncaughtError!==void 0&&(j=d.onUncaughtError),d.onCaughtError!==void 0&&(R=d.onCaughtError),d.onRecoverableError!==void 0&&(U=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(X=d.unstable_transitionCallbacks),d.formState!==void 0&&(ue=d.formState)),i=pv(n,1,!0,i,d??null,m,x,j,R,U,X,ue),i.context=gv(null),d=i.current,m=Fs(),m=bn(m),x=Ir(m),x.callback=null,Ur(d,x,m),d=m,i.current.lanes=d,Dr(i,d),Da(i),n[go]=i.current,Ef(n),new ru(i)},Wl.version="19.1.0",Wl}var Pv;function BC(){if(Pv)return Zf.exports;Pv=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(s){console.error(s)}}return t(),Zf.exports=UC(),Zf.exports}var VC=BC();/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var zv="popstate";function qC(t={}){function s(r,o){let{pathname:l,search:c,hash:u}=r.location;return Tp("",{pathname:l,search:c,hash:u},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function a(r,o){return typeof o=="string"?o:yc(o)}return HC(s,a,null,t)}function Rt(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function Na(t,s){if(!t){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function FC(){return Math.random().toString(36).substring(2,10)}function $v(t,s){return{usr:t.state,key:t.key,idx:s}}function Tp(t,s,a=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof s=="string"?Bi(s):s,state:a,key:s&&s.key||r||FC()}}function yc({pathname:t="/",search:s="",hash:a=""}){return s&&s!=="?"&&(t+=s.charAt(0)==="?"?s:"?"+s),a&&a!=="#"&&(t+=a.charAt(0)==="#"?a:"#"+a),t}function Bi(t){let s={};if(t){let a=t.indexOf("#");a>=0&&(s.hash=t.substring(a),t=t.substring(0,a));let r=t.indexOf("?");r>=0&&(s.search=t.substring(r),t=t.substring(0,r)),t&&(s.pathname=t)}return s}function HC(t,s,a,r={}){let{window:o=document.defaultView,v5Compat:l=!1}=r,c=o.history,u="POP",h=null,f=p();f==null&&(f=0,c.replaceState({...c.state,idx:f},""));function p(){return(c.state||{idx:null}).idx}function g(){u="POP";let E=p(),T=E==null?null:E-f;f=E,h&&h({action:u,location:w.location,delta:T})}function v(E,T){u="PUSH";let N=Tp(w.location,E,T);f=p()+1;let k=$v(N,f),S=w.createHref(N);try{c.pushState(k,"",S)}catch(C){if(C instanceof DOMException&&C.name==="DataCloneError")throw C;o.location.assign(S)}l&&h&&h({action:u,location:w.location,delta:1})}function b(E,T){u="REPLACE";let N=Tp(w.location,E,T);f=p();let k=$v(N,f),S=w.createHref(N);c.replaceState(k,"",S),l&&h&&h({action:u,location:w.location,delta:0})}function _(E){return GC(E)}let w={get action(){return u},get location(){return t(o,c)},listen(E){if(h)throw new Error("A history only accepts one active listener");return o.addEventListener(zv,g),h=E,()=>{o.removeEventListener(zv,g),h=null}},createHref(E){return s(o,E)},createURL:_,encodeLocation(E){let T=_(E);return{pathname:T.pathname,search:T.search,hash:T.hash}},push:v,replace:b,go(E){return c.go(E)}};return w}function GC(t,s=!1){let a="http://localhost";typeof window<"u"&&(a=window.location.origin!=="null"?window.location.origin:window.location.href),Rt(a,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:yc(t);return r=r.replace(/ $/,"%20"),!s&&r.startsWith("//")&&(r=a+r),new URL(r,a)}function N_(t,s,a="/"){return ZC(t,s,a,!1)}function ZC(t,s,a,r){let o=typeof s=="string"?Bi(s):s,l=Sr(o.pathname||"/",a);if(l==null)return null;let c=S_(t);WC(c);let u=null;for(let h=0;u==null&&h<c.length;++h){let f=n4(l);u=a4(c[h],f,r)}return u}function S_(t,s=[],a=[],r="",o=!1){let l=(c,u,h=o,f)=>{let p={relativePath:f===void 0?c.path||"":f,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(r)&&h)return;Rt(p.relativePath.startsWith(r),`Absolute route path "${p.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(r.length)}let g=wr([r,p.relativePath]),v=a.concat(p);c.children&&c.children.length>0&&(Rt(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),S_(c.children,s,v,g,h)),!(c.path==null&&!c.index)&&s.push({path:g,score:t4(g,c.index),routesMeta:v})};return t.forEach((c,u)=>{var h;if(c.path===""||!((h=c.path)!=null&&h.includes("?")))l(c,u);else for(let f of E_(c.path))l(c,u,!0,f)}),s}function E_(t){let s=t.split("/");if(s.length===0)return[];let[a,...r]=s,o=a.endsWith("?"),l=a.replace(/\?$/,"");if(r.length===0)return o?[l,""]:[l];let c=E_(r.join("/")),u=[];return u.push(...c.map(h=>h===""?l:[l,h].join("/"))),o&&u.push(...c),u.map(h=>t.startsWith("/")&&h===""?"/":h)}function WC(t){t.sort((s,a)=>s.score!==a.score?a.score-s.score:s4(s.routesMeta.map(r=>r.childrenIndex),a.routesMeta.map(r=>r.childrenIndex)))}var YC=/^:[\w-]+$/,KC=3,XC=2,QC=1,JC=10,e4=-2,Lv=t=>t==="*";function t4(t,s){let a=t.split("/"),r=a.length;return a.some(Lv)&&(r+=e4),s&&(r+=XC),a.filter(o=>!Lv(o)).reduce((o,l)=>o+(YC.test(l)?KC:l===""?QC:JC),r)}function s4(t,s){return t.length===s.length&&t.slice(0,-1).every((r,o)=>r===s[o])?t[t.length-1]-s[s.length-1]:0}function a4(t,s,a=!1){let{routesMeta:r}=t,o={},l="/",c=[];for(let u=0;u<r.length;++u){let h=r[u],f=u===r.length-1,p=l==="/"?s:s.slice(l.length)||"/",g=zu({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},p),v=h.route;if(!g&&f&&a&&!r[r.length-1].route.index&&(g=zu({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},p)),!g)return null;Object.assign(o,g.params),c.push({params:o,pathname:wr([l,g.pathname]),pathnameBase:c4(wr([l,g.pathnameBase])),route:v}),g.pathnameBase!=="/"&&(l=wr([l,g.pathnameBase]))}return c}function zu(t,s){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[a,r]=r4(t.path,t.caseSensitive,t.end),o=s.match(a);if(!o)return null;let l=o[0],c=l.replace(/(.)\/+$/,"$1"),u=o.slice(1);return{params:r.reduce((f,{paramName:p,isOptional:g},v)=>{if(p==="*"){let _=u[v]||"";c=l.slice(0,l.length-_.length).replace(/(.)\/+$/,"$1")}const b=u[v];return g&&!b?f[p]=void 0:f[p]=(b||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:c,pattern:t}}function r4(t,s=!1,a=!0){Na(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,h)=>(r.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,s?void 0:"i"),r]}function n4(t){try{return t.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return Na(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${s}).`),t}}function Sr(t,s){if(s==="/")return t;if(!t.toLowerCase().startsWith(s.toLowerCase()))return null;let a=s.endsWith("/")?s.length-1:s.length,r=t.charAt(a);return r&&r!=="/"?null:t.slice(a)||"/"}function o4(t,s="/"){let{pathname:a,search:r="",hash:o=""}=typeof t=="string"?Bi(t):t;return{pathname:a?a.startsWith("/")?a:i4(a,s):s,search:d4(r),hash:u4(o)}}function i4(t,s){let a=s.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?a.length>1&&a.pop():o!=="."&&a.push(o)}),a.length>1?a.join("/"):"/"}function Xf(t,s,a,r){return`Cannot include a '${t}' character in a manually specified \`to.${s}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function l4(t){return t.filter((s,a)=>a===0||s.route.path&&s.route.path.length>0)}function k0(t){let s=l4(t);return s.map((a,r)=>r===s.length-1?a.pathname:a.pathnameBase)}function T0(t,s,a,r=!1){let o;typeof t=="string"?o=Bi(t):(o={...t},Rt(!o.pathname||!o.pathname.includes("?"),Xf("?","pathname","search",o)),Rt(!o.pathname||!o.pathname.includes("#"),Xf("#","pathname","hash",o)),Rt(!o.search||!o.search.includes("#"),Xf("#","search","hash",o)));let l=t===""||o.pathname==="",c=l?"/":o.pathname,u;if(c==null)u=a;else{let g=s.length-1;if(!r&&c.startsWith("..")){let v=c.split("/");for(;v[0]==="..";)v.shift(),g-=1;o.pathname=v.join("/")}u=g>=0?s[g]:"/"}let h=o4(o,u),f=c&&c!=="/"&&c.endsWith("/"),p=(l||c===".")&&a.endsWith("/");return!h.pathname.endsWith("/")&&(f||p)&&(h.pathname+="/"),h}var wr=t=>t.join("/").replace(/\/\/+/g,"/"),c4=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),d4=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,u4=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function m4(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var C_=["POST","PUT","PATCH","DELETE"];new Set(C_);var h4=["GET",...C_];new Set(h4);var Vi=y.createContext(null);Vi.displayName="DataRouter";var dm=y.createContext(null);dm.displayName="DataRouterState";y.createContext(!1);var k_=y.createContext({isTransitioning:!1});k_.displayName="ViewTransition";var f4=y.createContext(new Map);f4.displayName="Fetchers";var p4=y.createContext(null);p4.displayName="Await";var Ca=y.createContext(null);Ca.displayName="Navigation";var Pc=y.createContext(null);Pc.displayName="Location";var ka=y.createContext({outlet:null,matches:[],isDataRoute:!1});ka.displayName="Route";var A0=y.createContext(null);A0.displayName="RouteError";function g4(t,{relative:s}={}){Rt(qi(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:r}=y.useContext(Ca),{hash:o,pathname:l,search:c}=zc(t,{relative:s}),u=l;return a!=="/"&&(u=l==="/"?a:wr([a,l])),r.createHref({pathname:u,search:c,hash:o})}function qi(){return y.useContext(Pc)!=null}function Tr(){return Rt(qi(),"useLocation() may be used only in the context of a <Router> component."),y.useContext(Pc).location}var T_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function A_(t){y.useContext(Ca).static||y.useLayoutEffect(t)}function Ks(){let{isDataRoute:t}=y.useContext(ka);return t?M4():x4()}function x4(){Rt(qi(),"useNavigate() may be used only in the context of a <Router> component.");let t=y.useContext(Vi),{basename:s,navigator:a}=y.useContext(Ca),{matches:r}=y.useContext(ka),{pathname:o}=Tr(),l=JSON.stringify(k0(r)),c=y.useRef(!1);return A_(()=>{c.current=!0}),y.useCallback((h,f={})=>{if(Na(c.current,T_),!c.current)return;if(typeof h=="number"){a.go(h);return}let p=T0(h,JSON.parse(l),o,f.relative==="path");t==null&&s!=="/"&&(p.pathname=p.pathname==="/"?s:wr([s,p.pathname])),(f.replace?a.replace:a.push)(p,f.state,f)},[s,a,l,o,t])}var y4=y.createContext(null);function b4(t){let s=y.useContext(ka).outlet;return s&&y.createElement(y4.Provider,{value:t},s)}function zc(t,{relative:s}={}){let{matches:a}=y.useContext(ka),{pathname:r}=Tr(),o=JSON.stringify(k0(a));return y.useMemo(()=>T0(t,JSON.parse(o),r,s==="path"),[t,o,r,s])}function v4(t,s){return M_(t,s)}function M_(t,s,a,r,o){var N;Rt(qi(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=y.useContext(Ca),{matches:c}=y.useContext(ka),u=c[c.length-1],h=u?u.params:{},f=u?u.pathname:"/",p=u?u.pathnameBase:"/",g=u&&u.route;{let k=g&&g.path||"";R_(f,!g||k.endsWith("*")||k.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${k}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${k}"> to <Route path="${k==="/"?"*":`${k}/*`}">.`)}let v=Tr(),b;if(s){let k=typeof s=="string"?Bi(s):s;Rt(p==="/"||((N=k.pathname)==null?void 0:N.startsWith(p)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${k.pathname}" was given in the \`location\` prop.`),b=k}else b=v;let _=b.pathname||"/",w=_;if(p!=="/"){let k=p.replace(/^\//,"").split("/");w="/"+_.replace(/^\//,"").split("/").slice(k.length).join("/")}let E=N_(t,{pathname:w});Na(g||E!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Na(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let T=S4(E&&E.map(k=>Object.assign({},k,{params:Object.assign({},h,k.params),pathname:wr([p,l.encodeLocation?l.encodeLocation(k.pathname).pathname:k.pathname]),pathnameBase:k.pathnameBase==="/"?p:wr([p,l.encodeLocation?l.encodeLocation(k.pathnameBase).pathname:k.pathnameBase])})),c,a,r,o);return s&&T?y.createElement(Pc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},T):T}function w4(){let t=A4(),s=m4(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),a=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r},l={padding:"2px 4px",backgroundColor:r},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=y.createElement(y.Fragment,null,y.createElement("p",null," Hey developer "),y.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",y.createElement("code",{style:l},"ErrorBoundary")," or"," ",y.createElement("code",{style:l},"errorElement")," prop on your route.")),y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},s),a?y.createElement("pre",{style:o},a):null,c)}var j4=y.createElement(w4,null),_4=class extends y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,s){return s.location!==t.location||s.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:s.error,location:s.location,revalidation:t.revalidation||s.revalidation}}componentDidCatch(t,s){this.props.unstable_onError?this.props.unstable_onError(t,s):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?y.createElement(ka.Provider,{value:this.props.routeContext},y.createElement(A0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function N4({routeContext:t,match:s,children:a}){let r=y.useContext(Vi);return r&&r.static&&r.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=s.route.id),y.createElement(ka.Provider,{value:t},a)}function S4(t,s=[],a=null,r=null,o=null){if(t==null){if(!a)return null;if(a.errors)t=a.matches;else if(s.length===0&&!a.initialized&&a.matches.length>0)t=a.matches;else return null}let l=t,c=a==null?void 0:a.errors;if(c!=null){let f=l.findIndex(p=>p.route.id&&(c==null?void 0:c[p.route.id])!==void 0);Rt(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,f+1))}let u=!1,h=-1;if(a)for(let f=0;f<l.length;f++){let p=l[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=f),p.route.id){let{loaderData:g,errors:v}=a,b=p.route.loader&&!g.hasOwnProperty(p.route.id)&&(!v||v[p.route.id]===void 0);if(p.route.lazy||b){u=!0,h>=0?l=l.slice(0,h+1):l=[l[0]];break}}}return l.reduceRight((f,p,g)=>{let v,b=!1,_=null,w=null;a&&(v=c&&p.route.id?c[p.route.id]:void 0,_=p.route.errorElement||j4,u&&(h<0&&g===0?(R_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,w=null):h===g&&(b=!0,w=p.route.hydrateFallbackElement||null)));let E=s.concat(l.slice(0,g+1)),T=()=>{let N;return v?N=_:b?N=w:p.route.Component?N=y.createElement(p.route.Component,null):p.route.element?N=p.route.element:N=f,y.createElement(N4,{match:p,routeContext:{outlet:f,matches:E,isDataRoute:a!=null},children:N})};return a&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?y.createElement(_4,{location:a.location,revalidation:a.revalidation,component:_,error:v,children:T(),routeContext:{outlet:null,matches:E,isDataRoute:!0},unstable_onError:r}):T()},null)}function M0(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function E4(t){let s=y.useContext(Vi);return Rt(s,M0(t)),s}function C4(t){let s=y.useContext(dm);return Rt(s,M0(t)),s}function k4(t){let s=y.useContext(ka);return Rt(s,M0(t)),s}function R0(t){let s=k4(t),a=s.matches[s.matches.length-1];return Rt(a.route.id,`${t} can only be used on routes that contain a unique "id"`),a.route.id}function T4(){return R0("useRouteId")}function A4(){var r;let t=y.useContext(A0),s=C4("useRouteError"),a=R0("useRouteError");return t!==void 0?t:(r=s.errors)==null?void 0:r[a]}function M4(){let{router:t}=E4("useNavigate"),s=R0("useNavigate"),a=y.useRef(!1);return A_(()=>{a.current=!0}),y.useCallback(async(o,l={})=>{Na(a.current,T_),a.current&&(typeof o=="number"?t.navigate(o):await t.navigate(o,{fromRouteId:s,...l}))},[t,s])}var Iv={};function R_(t,s,a){!s&&!Iv[t]&&(Iv[t]=!0,Na(!1,a))}y.memo(R4);function R4({routes:t,future:s,state:a,unstable_onError:r}){return M_(t,void 0,a,r,s)}function Mi({to:t,replace:s,state:a,relative:r}){Rt(qi(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=y.useContext(Ca);Na(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=y.useContext(ka),{pathname:c}=Tr(),u=Ks(),h=T0(t,k0(l),c,r==="path"),f=JSON.stringify(h);return y.useEffect(()=>{u(JSON.parse(f),{replace:s,state:a,relative:r})},[u,f,r,s,a]),null}function O4(t){return b4(t.context)}function ot(t){Rt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function D4({basename:t="/",children:s=null,location:a,navigationType:r="POP",navigator:o,static:l=!1}){Rt(!qi(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),u=y.useMemo(()=>({basename:c,navigator:o,static:l,future:{}}),[c,o,l]);typeof a=="string"&&(a=Bi(a));let{pathname:h="/",search:f="",hash:p="",state:g=null,key:v="default"}=a,b=y.useMemo(()=>{let _=Sr(h,c);return _==null?null:{location:{pathname:_,search:f,hash:p,state:g,key:v},navigationType:r}},[c,h,f,p,g,v,r]);return Na(b!=null,`<Router basename="${c}"> is not able to match the URL "${h}${f}${p}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:y.createElement(Ca.Provider,{value:u},y.createElement(Pc.Provider,{children:s,value:b}))}function O_({children:t,location:s}){return v4(Ap(t),s)}function Ap(t,s=[]){let a=[];return y.Children.forEach(t,(r,o)=>{if(!y.isValidElement(r))return;let l=[...s,o];if(r.type===y.Fragment){a.push.apply(a,Ap(r.props.children,l));return}Rt(r.type===ot,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Rt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let c={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(c.children=Ap(r.props.children,l)),a.push(c)}),a}var Nu="get",Su="application/x-www-form-urlencoded";function um(t){return t!=null&&typeof t.tagName=="string"}function P4(t){return um(t)&&t.tagName.toLowerCase()==="button"}function z4(t){return um(t)&&t.tagName.toLowerCase()==="form"}function $4(t){return um(t)&&t.tagName.toLowerCase()==="input"}function L4(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function I4(t,s){return t.button===0&&(!s||s==="_self")&&!L4(t)}var ou=null;function U4(){if(ou===null)try{new FormData(document.createElement("form"),0),ou=!1}catch{ou=!0}return ou}var B4=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Qf(t){return t!=null&&!B4.has(t)?(Na(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${Su}"`),null):t}function V4(t,s){let a,r,o,l,c;if(z4(t)){let u=t.getAttribute("action");r=u?Sr(u,s):null,a=t.getAttribute("method")||Nu,o=Qf(t.getAttribute("enctype"))||Su,l=new FormData(t)}else if(P4(t)||$4(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=t.getAttribute("formaction")||u.getAttribute("action");if(r=h?Sr(h,s):null,a=t.getAttribute("formmethod")||u.getAttribute("method")||Nu,o=Qf(t.getAttribute("formenctype"))||Qf(u.getAttribute("enctype"))||Su,l=new FormData(u,t),!U4()){let{name:f,type:p,value:g}=t;if(p==="image"){let v=f?`${f}.`:"";l.append(`${v}x`,"0"),l.append(`${v}y`,"0")}else f&&l.append(f,g)}}else{if(um(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=Nu,r=null,o=Su,c=t}return l&&o==="text/plain"&&(c=l,l=void 0),{action:r,method:a.toLowerCase(),encType:o,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function O0(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function q4(t,s,a){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${a}`:s&&Sr(r.pathname,s)==="/"?r.pathname=`${s.replace(/\/$/,"")}/_root.${a}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${a}`,r}async function F4(t,s){if(t.id in s)return s[t.id];try{let a=await import(t.module);return s[t.id]=a,a}catch(a){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function H4(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function G4(t,s,a){let r=await Promise.all(t.map(async o=>{let l=s.routes[o.route.id];if(l){let c=await F4(l,a);return c.links?c.links():[]}return[]}));return K4(r.flat(1).filter(H4).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function Uv(t,s,a,r,o,l){let c=(h,f)=>a[f]?h.route.id!==a[f].route.id:!0,u=(h,f)=>{var p;return a[f].pathname!==h.pathname||((p=a[f].route.path)==null?void 0:p.endsWith("*"))&&a[f].params["*"]!==h.params["*"]};return l==="assets"?s.filter((h,f)=>c(h,f)||u(h,f)):l==="data"?s.filter((h,f)=>{var g;let p=r.routes[h.route.id];if(!p||!p.hasLoader)return!1;if(c(h,f)||u(h,f))return!0;if(h.route.shouldRevalidate){let v=h.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:((g=a[0])==null?void 0:g.params)||{},nextUrl:new URL(t,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function Z4(t,s,{includeHydrateFallback:a}={}){return W4(t.map(r=>{let o=s.routes[r.route.id];if(!o)return[];let l=[o.module];return o.clientActionModule&&(l=l.concat(o.clientActionModule)),o.clientLoaderModule&&(l=l.concat(o.clientLoaderModule)),a&&o.hydrateFallbackModule&&(l=l.concat(o.hydrateFallbackModule)),o.imports&&(l=l.concat(o.imports)),l}).flat(1))}function W4(t){return[...new Set(t)]}function Y4(t){let s={},a=Object.keys(t).sort();for(let r of a)s[r]=t[r];return s}function K4(t,s){let a=new Set;return new Set(s),t.reduce((r,o)=>{let l=JSON.stringify(Y4(o));return a.has(l)||(a.add(l),r.push({key:l,link:o})),r},[])}function D_(){let t=y.useContext(Vi);return O0(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function X4(){let t=y.useContext(dm);return O0(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var D0=y.createContext(void 0);D0.displayName="FrameworkContext";function P_(){let t=y.useContext(D0);return O0(t,"You must render this element inside a <HydratedRouter> element"),t}function Q4(t,s){let a=y.useContext(D0),[r,o]=y.useState(!1),[l,c]=y.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:f,onMouseLeave:p,onTouchStart:g}=s,v=y.useRef(null);y.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let w=T=>{T.forEach(N=>{c(N.isIntersecting)})},E=new IntersectionObserver(w,{threshold:.5});return v.current&&E.observe(v.current),()=>{E.disconnect()}}},[t]),y.useEffect(()=>{if(r){let w=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(w)}}},[r]);let b=()=>{o(!0)},_=()=>{o(!1),c(!1)};return a?t!=="intent"?[l,v,{}]:[l,v,{onFocus:Yl(u,b),onBlur:Yl(h,_),onMouseEnter:Yl(f,b),onMouseLeave:Yl(p,_),onTouchStart:Yl(g,b)}]:[!1,v,{}]}function Yl(t,s){return a=>{t&&t(a),a.defaultPrevented||s(a)}}function J4({page:t,...s}){let{router:a}=D_(),r=y.useMemo(()=>N_(a.routes,t,a.basename),[a.routes,t,a.basename]);return r?y.createElement(t5,{page:t,matches:r,...s}):null}function e5(t){let{manifest:s,routeModules:a}=P_(),[r,o]=y.useState([]);return y.useEffect(()=>{let l=!1;return G4(t,s,a).then(c=>{l||o(c)}),()=>{l=!0}},[t,s,a]),r}function t5({page:t,matches:s,...a}){let r=Tr(),{manifest:o,routeModules:l}=P_(),{basename:c}=D_(),{loaderData:u,matches:h}=X4(),f=y.useMemo(()=>Uv(t,s,h,o,r,"data"),[t,s,h,o,r]),p=y.useMemo(()=>Uv(t,s,h,o,r,"assets"),[t,s,h,o,r]),g=y.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let _=new Set,w=!1;if(s.forEach(T=>{var k;let N=o.routes[T.route.id];!N||!N.hasLoader||(!f.some(S=>S.route.id===T.route.id)&&T.route.id in u&&((k=l[T.route.id])!=null&&k.shouldRevalidate)||N.hasClientLoader?w=!0:_.add(T.route.id))}),_.size===0)return[];let E=q4(t,c,"data");return w&&_.size>0&&E.searchParams.set("_routes",s.filter(T=>_.has(T.route.id)).map(T=>T.route.id).join(",")),[E.pathname+E.search]},[c,u,r,o,f,s,t,l]),v=y.useMemo(()=>Z4(p,o),[p,o]),b=e5(p);return y.createElement(y.Fragment,null,g.map(_=>y.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...a})),v.map(_=>y.createElement("link",{key:_,rel:"modulepreload",href:_,...a})),b.map(({key:_,link:w})=>y.createElement("link",{key:_,nonce:a.nonce,...w})))}function s5(...t){return s=>{t.forEach(a=>{typeof a=="function"?a(s):a!=null&&(a.current=s)})}}var z_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{z_&&(window.__reactRouterVersion="7.8.2")}catch{}function a5({basename:t,children:s,window:a}){let r=y.useRef();r.current==null&&(r.current=qC({window:a,v5Compat:!0}));let o=r.current,[l,c]=y.useState({action:o.action,location:o.location}),u=y.useCallback(h=>{y.startTransition(()=>c(h))},[c]);return y.useLayoutEffect(()=>o.listen(u),[o,u]),y.createElement(D4,{basename:t,children:s,location:l.location,navigationType:l.action,navigator:o})}var $_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,gs=y.forwardRef(function({onClick:s,discover:a="render",prefetch:r="none",relative:o,reloadDocument:l,replace:c,state:u,target:h,to:f,preventScrollReset:p,viewTransition:g,...v},b){let{basename:_}=y.useContext(Ca),w=typeof f=="string"&&$_.test(f),E,T=!1;if(typeof f=="string"&&w&&(E=f,z_))try{let $=new URL(window.location.href),P=f.startsWith("//")?new URL($.protocol+f):new URL(f),F=Sr(P.pathname,_);P.origin===$.origin&&F!=null?f=F+P.search+P.hash:T=!0}catch{Na(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let N=g4(f,{relative:o}),[k,S,C]=Q4(r,v),M=o5(f,{replace:c,state:u,target:h,preventScrollReset:p,relative:o,viewTransition:g});function z($){s&&s($),$.defaultPrevented||M($)}let A=y.createElement("a",{...v,...C,href:E||N,onClick:T||l?s:z,ref:s5(b,S),target:h,"data-discover":!w&&a==="render"?"true":void 0});return k&&!w?y.createElement(y.Fragment,null,A,y.createElement(J4,{page:N})):A});gs.displayName="Link";var L_=y.forwardRef(function({"aria-current":s="page",caseSensitive:a=!1,className:r="",end:o=!1,style:l,to:c,viewTransition:u,children:h,...f},p){let g=zc(c,{relative:f.relative}),v=Tr(),b=y.useContext(dm),{navigator:_,basename:w}=y.useContext(Ca),E=b!=null&&u5(g)&&u===!0,T=_.encodeLocation?_.encodeLocation(g).pathname:g.pathname,N=v.pathname,k=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;a||(N=N.toLowerCase(),k=k?k.toLowerCase():null,T=T.toLowerCase()),k&&w&&(k=Sr(k,w)||k);const S=T!=="/"&&T.endsWith("/")?T.length-1:T.length;let C=N===T||!o&&N.startsWith(T)&&N.charAt(S)==="/",M=k!=null&&(k===T||!o&&k.startsWith(T)&&k.charAt(T.length)==="/"),z={isActive:C,isPending:M,isTransitioning:E},A=C?s:void 0,$;typeof r=="function"?$=r(z):$=[r,C?"active":null,M?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let P=typeof l=="function"?l(z):l;return y.createElement(gs,{...f,"aria-current":A,className:$,ref:p,style:P,to:c,viewTransition:u},typeof h=="function"?h(z):h)});L_.displayName="NavLink";var r5=y.forwardRef(({discover:t="render",fetcherKey:s,navigate:a,reloadDocument:r,replace:o,state:l,method:c=Nu,action:u,onSubmit:h,relative:f,preventScrollReset:p,viewTransition:g,...v},b)=>{let _=c5(),w=d5(u,{relative:f}),E=c.toLowerCase()==="get"?"get":"post",T=typeof u=="string"&&$_.test(u),N=k=>{if(h&&h(k),k.defaultPrevented)return;k.preventDefault();let S=k.nativeEvent.submitter,C=(S==null?void 0:S.getAttribute("formmethod"))||c;_(S||k.currentTarget,{fetcherKey:s,method:C,navigate:a,replace:o,state:l,relative:f,preventScrollReset:p,viewTransition:g})};return y.createElement("form",{ref:b,method:E,action:w,onSubmit:r?h:N,...v,"data-discover":!T&&t==="render"?"true":void 0})});r5.displayName="Form";function n5(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function I_(t){let s=y.useContext(Vi);return Rt(s,n5(t)),s}function o5(t,{target:s,replace:a,state:r,preventScrollReset:o,relative:l,viewTransition:c}={}){let u=Ks(),h=Tr(),f=zc(t,{relative:l});return y.useCallback(p=>{if(I4(p,s)){p.preventDefault();let g=a!==void 0?a:yc(h)===yc(f);u(t,{replace:g,state:r,preventScrollReset:o,relative:l,viewTransition:c})}},[h,u,f,a,r,s,t,o,l,c])}var i5=0,l5=()=>`__${String(++i5)}__`;function c5(){let{router:t}=I_("useSubmit"),{basename:s}=y.useContext(Ca),a=T4();return y.useCallback(async(r,o={})=>{let{action:l,method:c,encType:u,formData:h,body:f}=V4(r,s);if(o.navigate===!1){let p=o.fetcherKey||l5();await t.fetch(p,a,o.action||l,{preventScrollReset:o.preventScrollReset,formData:h,body:f,formMethod:o.method||c,formEncType:o.encType||u,flushSync:o.flushSync})}else await t.navigate(o.action||l,{preventScrollReset:o.preventScrollReset,formData:h,body:f,formMethod:o.method||c,formEncType:o.encType||u,replace:o.replace,state:o.state,fromRouteId:a,flushSync:o.flushSync,viewTransition:o.viewTransition})},[t,s,a])}function d5(t,{relative:s}={}){let{basename:a}=y.useContext(Ca),r=y.useContext(ka);Rt(r,"useFormAction must be used inside a RouteContext");let[o]=r.matches.slice(-1),l={...zc(t||".",{relative:s})},c=Tr();if(t==null){l.search=c.search;let u=new URLSearchParams(l.search),h=u.getAll("index");if(h.some(p=>p==="")){u.delete("index"),h.filter(g=>g).forEach(g=>u.append("index",g));let p=u.toString();l.search=p?`?${p}`:""}}return(!t||t===".")&&o.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(l.pathname=l.pathname==="/"?a:wr([a,l.pathname])),yc(l)}function u5(t,{relative:s}={}){let a=y.useContext(k_);Rt(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=I_("useViewTransitionState"),o=zc(t,{relative:s});if(!a.isTransitioning)return!1;let l=Sr(a.currentLocation.pathname,r)||a.currentLocation.pathname,c=Sr(a.nextLocation.pathname,r)||a.nextLocation.pathname;return zu(o.pathname,c)!=null||zu(o.pathname,l)!=null}const m5="modulepreload",h5=function(t){return"/"+t},Bv={},Sa=function(s,a,r){let o=Promise.resolve();if(a&&a.length>0){let c=function(f){return Promise.all(f.map(p=>Promise.resolve(p).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),h=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));o=c(a.map(f=>{if(f=h5(f),f in Bv)return;Bv[f]=!0;const p=f.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":m5,p||(v.as="script"),v.crossOrigin="",v.href=f,h&&v.setAttribute("nonce",h),document.head.appendChild(v),p)return new Promise((b,_)=>{v.addEventListener("load",b),v.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${f}`)))})}))}function l(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return o.then(c=>{for(const u of c||[])u.status==="rejected"&&l(u.reason);return s().catch(l)})},f5=t=>{let s;return t?s=t:typeof fetch>"u"?s=(...a)=>Sa(async()=>{const{default:r}=await Promise.resolve().then(()=>Fi);return{default:r}},[]).then(({default:r})=>r(...a)):s=fetch,(...a)=>s(...a)};class mm extends Error{constructor(s,a="FunctionsError",r){super(s),this.name=a,this.context=r}}class U_ extends mm{constructor(s){super("Failed to send a request to the Edge Function","FunctionsFetchError",s)}}class Mp extends mm{constructor(s){super("Relay Error invoking the Edge Function","FunctionsRelayError",s)}}class Rp extends mm{constructor(s){super("Edge Function returned a non-2xx status code","FunctionsHttpError",s)}}var $u;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})($u||($u={}));var p5=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};class g5{constructor(s,{headers:a={},customFetch:r,region:o=$u.Any}={}){this.url=s,this.headers=a,this.region=o,this.fetch=f5(r)}setAuth(s){this.headers.Authorization=`Bearer ${s}`}invoke(s,a={}){var r;return p5(this,void 0,void 0,function*(){try{const{headers:o,method:l,body:c}=a;let u={},{region:h}=a;h||(h=this.region);const f=new URL(`${this.url}/${s}`);h&&h!=="any"&&(u["x-region"]=h,f.searchParams.set("forceFunctionRegion",h));let p;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",p=c):typeof c=="string"?(u["Content-Type"]="text/plain",p=c):typeof FormData<"u"&&c instanceof FormData?p=c:(u["Content-Type"]="application/json",p=JSON.stringify(c)));const g=yield this.fetch(f.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),o),body:p}).catch(w=>{throw new U_(w)}),v=g.headers.get("x-relay-error");if(v&&v==="true")throw new Mp(g);if(!g.ok)throw new Rp(g);let b=((r=g.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),_;return b==="application/json"?_=yield g.json():b==="application/octet-stream"?_=yield g.blob():b==="text/event-stream"?_=g:b==="multipart/form-data"?_=yield g.formData():_=yield g.text(),{data:_,error:null,response:g}}catch(o){return{data:null,error:o,response:o instanceof Rp||o instanceof Mp?o.context:void 0}}})}}var ps={},ti={},si={},ai={},ri={},ni={},x5=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Ri=x5();const y5=Ri.fetch,B_=Ri.fetch.bind(Ri),V_=Ri.Headers,b5=Ri.Request,v5=Ri.Response,Fi=Object.freeze(Object.defineProperty({__proto__:null,Headers:V_,Request:b5,Response:v5,default:B_,fetch:y5},Symbol.toStringTag,{value:"Module"})),w5=RC(Fi);var iu={},Vv;function q_(){if(Vv)return iu;Vv=1,Object.defineProperty(iu,"__esModule",{value:!0});class t extends Error{constructor(a){super(a.message),this.name="PostgrestError",this.details=a.details,this.hint=a.hint,this.code=a.code}}return iu.default=t,iu}var qv;function F_(){if(qv)return ni;qv=1;var t=ni&&ni.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(ni,"__esModule",{value:!0});const s=t(w5),a=t(q_());class r{constructor(l){var c,u;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(c=l.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=l.signal,this.isMaybeSingle=(u=l.isMaybeSingle)!==null&&u!==void 0?u:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=s.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=new Headers(this.headers),this.headers.set(l,c),this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const u=this.fetch;let h=u(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var p,g,v,b;let _=null,w=null,E=null,T=f.status,N=f.statusText;if(f.ok){if(this.method!=="HEAD"){const M=await f.text();M===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((p=this.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?w=M:w=JSON.parse(M))}const S=(g=this.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),C=(v=f.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");S&&C&&C.length>1&&(E=parseInt(C[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(_={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,E=null,T=406,N="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const S=await f.text();try{_=JSON.parse(S),Array.isArray(_)&&f.status===404&&(w=[],_=null,T=200,N="OK")}catch{f.status===404&&S===""?(T=204,N="No Content"):_={message:S}}if(_&&this.isMaybeSingle&&(!((b=_==null?void 0:_.details)===null||b===void 0)&&b.includes("0 rows"))&&(_=null,T=200,N="OK"),_&&this.shouldThrowOnError)throw new a.default(_)}return{error:_,data:w,count:E,status:T,statusText:N}});return this.shouldThrowOnError||(h=h.catch(f=>{var p,g,v;return{error:{message:`${(p=f==null?void 0:f.name)!==null&&p!==void 0?p:"FetchError"}: ${f==null?void 0:f.message}`,details:`${(g=f==null?void 0:f.stack)!==null&&g!==void 0?g:""}`,hint:"",code:`${(v=f==null?void 0:f.code)!==null&&v!==void 0?v:""}`},data:null,count:null,status:0,statusText:""}})),h.then(l,c)}returns(){return this}overrideTypes(){return this}}return ni.default=r,ni}var Fv;function H_(){if(Fv)return ri;Fv=1;var t=ri&&ri.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ri,"__esModule",{value:!0});const s=t(F_());class a extends s.default{select(o){let l=!1;const c=(o??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(o,{ascending:l=!0,nullsFirst:c,foreignTable:u,referencedTable:h=u}={}){const f=h?`${h}.order`:"order",p=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${p?`${p},`:""}${o}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:l,referencedTable:c=l}={}){const u=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(u,`${o}`),this}range(o,l,{foreignTable:c,referencedTable:u=c}={}){const h=typeof u>"u"?"offset":`${u}.offset`,f=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(h,`${o}`),this.url.searchParams.set(f,`${l-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:o=!1,verbose:l=!1,settings:c=!1,buffers:u=!1,wal:h=!1,format:f="text"}={}){var p;const g=[o?"analyze":null,l?"verbose":null,c?"settings":null,u?"buffers":null,h?"wal":null].filter(Boolean).join("|"),v=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${v}"; options=${g};`),f==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(o){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${o}`),this}}return ri.default=a,ri}var Hv;function P0(){if(Hv)return ai;Hv=1;var t=ai&&ai.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ai,"__esModule",{value:!0});const s=t(H_());class a extends s.default{eq(o,l){return this.url.searchParams.append(o,`eq.${l}`),this}neq(o,l){return this.url.searchParams.append(o,`neq.${l}`),this}gt(o,l){return this.url.searchParams.append(o,`gt.${l}`),this}gte(o,l){return this.url.searchParams.append(o,`gte.${l}`),this}lt(o,l){return this.url.searchParams.append(o,`lt.${l}`),this}lte(o,l){return this.url.searchParams.append(o,`lte.${l}`),this}like(o,l){return this.url.searchParams.append(o,`like.${l}`),this}likeAllOf(o,l){return this.url.searchParams.append(o,`like(all).{${l.join(",")}}`),this}likeAnyOf(o,l){return this.url.searchParams.append(o,`like(any).{${l.join(",")}}`),this}ilike(o,l){return this.url.searchParams.append(o,`ilike.${l}`),this}ilikeAllOf(o,l){return this.url.searchParams.append(o,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(o,l){return this.url.searchParams.append(o,`ilike(any).{${l.join(",")}}`),this}is(o,l){return this.url.searchParams.append(o,`is.${l}`),this}in(o,l){const c=Array.from(new Set(l)).map(u=>typeof u=="string"&&new RegExp("[,()]").test(u)?`"${u}"`:`${u}`).join(",");return this.url.searchParams.append(o,`in.(${c})`),this}contains(o,l){return typeof l=="string"?this.url.searchParams.append(o,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(o,`cs.{${l.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(l)}`),this}containedBy(o,l){return typeof l=="string"?this.url.searchParams.append(o,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(o,`cd.{${l.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(l)}`),this}rangeGt(o,l){return this.url.searchParams.append(o,`sr.${l}`),this}rangeGte(o,l){return this.url.searchParams.append(o,`nxl.${l}`),this}rangeLt(o,l){return this.url.searchParams.append(o,`sl.${l}`),this}rangeLte(o,l){return this.url.searchParams.append(o,`nxr.${l}`),this}rangeAdjacent(o,l){return this.url.searchParams.append(o,`adj.${l}`),this}overlaps(o,l){return typeof l=="string"?this.url.searchParams.append(o,`ov.${l}`):this.url.searchParams.append(o,`ov.{${l.join(",")}}`),this}textSearch(o,l,{config:c,type:u}={}){let h="";u==="plain"?h="pl":u==="phrase"?h="ph":u==="websearch"&&(h="w");const f=c===void 0?"":`(${c})`;return this.url.searchParams.append(o,`${h}fts${f}.${l}`),this}match(o){return Object.entries(o).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(o,l,c){return this.url.searchParams.append(o,`not.${l}.${c}`),this}or(o,{foreignTable:l,referencedTable:c=l}={}){const u=c?`${c}.or`:"or";return this.url.searchParams.append(u,`(${o})`),this}filter(o,l,c){return this.url.searchParams.append(o,`${l}.${c}`),this}}return ai.default=a,ai}var Gv;function G_(){if(Gv)return si;Gv=1;var t=si&&si.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(si,"__esModule",{value:!0});const s=t(P0());class a{constructor(o,{headers:l={},schema:c,fetch:u}){this.url=o,this.headers=new Headers(l),this.schema=c,this.fetch=u}select(o,{head:l=!1,count:c}={}){const u=l?"HEAD":"GET";let h=!1;const f=(o??"*").split("").map(p=>/\s/.test(p)&&!h?"":(p==='"'&&(h=!h),p)).join("");return this.url.searchParams.set("select",f),c&&this.headers.append("Prefer",`count=${c}`),new s.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(o,{count:l,defaultToNull:c=!0}={}){var u;const h="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const f=o.reduce((p,g)=>p.concat(Object.keys(g)),[]);if(f.length>0){const p=[...new Set(f)].map(g=>`"${g}"`);this.url.searchParams.set("columns",p.join(","))}}return new s.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}upsert(o,{onConflict:l,ignoreDuplicates:c=!1,count:u,defaultToNull:h=!0}={}){var f;const p="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),u&&this.headers.append("Prefer",`count=${u}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const g=o.reduce((v,b)=>v.concat(Object.keys(b)),[]);if(g.length>0){const v=[...new Set(g)].map(b=>`"${b}"`);this.url.searchParams.set("columns",v.join(","))}}return new s.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}update(o,{count:l}={}){var c;const u="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new s.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:o}={}){var l;const c="DELETE";return o&&this.headers.append("Prefer",`count=${o}`),new s.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return si.default=a,si}var Zv;function j5(){if(Zv)return ti;Zv=1;var t=ti&&ti.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(ti,"__esModule",{value:!0});const s=t(G_()),a=t(P0());class r{constructor(l,{headers:c={},schema:u,fetch:h}={}){this.url=l,this.headers=new Headers(c),this.schemaName=u,this.fetch=h}from(l){const c=new URL(`${this.url}/${l}`);return new s.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new r(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:u=!1,get:h=!1,count:f}={}){var p;let g;const v=new URL(`${this.url}/rpc/${l}`);let b;u||h?(g=u?"HEAD":"GET",Object.entries(c).filter(([w,E])=>E!==void 0).map(([w,E])=>[w,Array.isArray(E)?`{${E.join(",")}}`:`${E}`]).forEach(([w,E])=>{v.searchParams.append(w,E)})):(g="POST",b=c);const _=new Headers(this.headers);return f&&_.set("Prefer",`count=${f}`),new a.default({method:g,url:v,headers:_,schema:this.schemaName,body:b,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}}return ti.default=r,ti}var Wv;function _5(){if(Wv)return ps;Wv=1;var t=ps&&ps.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(ps,"__esModule",{value:!0}),ps.PostgrestError=ps.PostgrestBuilder=ps.PostgrestTransformBuilder=ps.PostgrestFilterBuilder=ps.PostgrestQueryBuilder=ps.PostgrestClient=void 0;const s=t(j5());ps.PostgrestClient=s.default;const a=t(G_());ps.PostgrestQueryBuilder=a.default;const r=t(P0());ps.PostgrestFilterBuilder=r.default;const o=t(H_());ps.PostgrestTransformBuilder=o.default;const l=t(F_());ps.PostgrestBuilder=l.default;const c=t(q_());return ps.PostgrestError=c.default,ps.default={PostgrestClient:s.default,PostgrestQueryBuilder:a.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:c.default},ps}var N5=_5();const S5=__(N5),{PostgrestClient:E5,PostgrestQueryBuilder:kB,PostgrestFilterBuilder:TB,PostgrestTransformBuilder:AB,PostgrestBuilder:MB,PostgrestError:C5}=S5;class Z_{static detectEnvironment(){var s;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((s=navigator.userAgent)===null||s===void 0)&&s.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const a=parseInt(process.versions.node.split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const s=this.detectEnvironment();if(s.constructor)return s.constructor;let a=s.error||"WebSocket not supported in this environment.";throw s.workaround&&(a+=`

Suggested solution: ${s.workaround}`),new Error(a)}static createWebSocket(s,a){const r=this.getWebSocketConstructor();return new r(s,a)}static isWebSocketSupported(){try{const s=this.detectEnvironment();return s.type==="native"||s.type==="ws"}catch{return!1}}}const k5="2.15.4",T5=`realtime-js/${k5}`,A5="1.0.0",Op=1e4,M5=1e3,R5=100;var oc;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(oc||(oc={}));var is;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(is||(is={}));var va;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(va||(va={}));var Dp;(function(t){t.websocket="websocket"})(Dp||(Dp={}));var Hn;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Hn||(Hn={}));class O5{constructor(){this.HEADER_LENGTH=1}decode(s,a){return s.constructor===ArrayBuffer?a(this._binaryDecode(s)):a(typeof s=="string"?JSON.parse(s):{})}_binaryDecode(s){const a=new DataView(s),r=new TextDecoder;return this._decodeBroadcast(s,a,r)}_decodeBroadcast(s,a,r){const o=a.getUint8(1),l=a.getUint8(2);let c=this.HEADER_LENGTH+2;const u=r.decode(s.slice(c,c+o));c=c+o;const h=r.decode(s.slice(c,c+l));c=c+l;const f=JSON.parse(r.decode(s.slice(c,s.byteLength)));return{ref:null,topic:u,event:h,payload:f}}}let W_=class{constructor(s,a){this.callback=s,this.timerCalc=a,this.timer=void 0,this.tries=0,this.callback=s,this.timerCalc=a}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var jt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(jt||(jt={}));const Yv=(t,s,a={})=>{var r;const o=(r=a.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(s).reduce((l,c)=>(l[c]=D5(c,t,s,o),l),{})},D5=(t,s,a,r)=>{const o=s.find(u=>u.name===t),l=o==null?void 0:o.type,c=a[t];return l&&!r.includes(l)?Y_(l,c):Pp(c)},Y_=(t,s)=>{if(t.charAt(0)==="_"){const a=t.slice(1,t.length);return L5(s,a)}switch(t){case jt.bool:return P5(s);case jt.float4:case jt.float8:case jt.int2:case jt.int4:case jt.int8:case jt.numeric:case jt.oid:return z5(s);case jt.json:case jt.jsonb:return $5(s);case jt.timestamp:return I5(s);case jt.abstime:case jt.date:case jt.daterange:case jt.int4range:case jt.int8range:case jt.money:case jt.reltime:case jt.text:case jt.time:case jt.timestamptz:case jt.timetz:case jt.tsrange:case jt.tstzrange:return Pp(s);default:return Pp(s)}},Pp=t=>t,P5=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},z5=t=>{if(typeof t=="string"){const s=parseFloat(t);if(!Number.isNaN(s))return s}return t},$5=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(s){return console.log(`JSON parse error: ${s}`),t}return t},L5=(t,s)=>{if(typeof t!="string")return t;const a=t.length-1,r=t[a];if(t[0]==="{"&&r==="}"){let l;const c=t.slice(1,a);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(u=>Y_(s,u))}return t},I5=t=>typeof t=="string"?t.replace(" ","T"):t,K_=t=>{let s=t;return s=s.replace(/^ws/i,"http"),s=s.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),s.replace(/\/+$/,"")+"/api/broadcast"};class Jf{constructor(s,a,r={},o=Op){this.channel=s,this.event=a,this.payload=r,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(s){this.timeout=s,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(s){this.payload=Object.assign(Object.assign({},this.payload),s)}receive(s,a){var r;return this._hasReceived(s)&&a((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:s,callback:a}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const s=a=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=a,this._matchReceive(a)};this.channel._on(this.refEvent,{},s),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(s,a){this.refEvent&&this.channel._trigger(this.refEvent,{status:s,response:a})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:s,response:a}){this.recHooks.filter(r=>r.status===s).forEach(r=>r.callback(a))}_hasReceived(s){return this.receivedResp&&this.receivedResp.status===s}}var zp;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(zp||(zp={}));class Si{constructor(s,a){this.channel=s,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(a==null?void 0:a.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},o=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Si.syncState(this.state,o,l,c),this.pendingDiffs.forEach(h=>{this.state=Si.syncDiff(this.state,h,l,c)}),this.pendingDiffs=[],u()}),this.channel._on(r.diff,{},o=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Si.syncDiff(this.state,o,l,c),u())}),this.onJoin((o,l,c)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:l,newPresences:c})}),this.onLeave((o,l,c)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(s,a,r,o){const l=this.cloneDeep(s),c=this.transformState(a),u={},h={};return this.map(l,(f,p)=>{c[f]||(h[f]=p)}),this.map(c,(f,p)=>{const g=l[f];if(g){const v=p.map(E=>E.presence_ref),b=g.map(E=>E.presence_ref),_=p.filter(E=>b.indexOf(E.presence_ref)<0),w=g.filter(E=>v.indexOf(E.presence_ref)<0);_.length>0&&(u[f]=_),w.length>0&&(h[f]=w)}else u[f]=p}),this.syncDiff(l,{joins:u,leaves:h},r,o)}static syncDiff(s,a,r,o){const{joins:l,leaves:c}={joins:this.transformState(a.joins),leaves:this.transformState(a.leaves)};return r||(r=()=>{}),o||(o=()=>{}),this.map(l,(u,h)=>{var f;const p=(f=s[u])!==null&&f!==void 0?f:[];if(s[u]=this.cloneDeep(h),p.length>0){const g=s[u].map(b=>b.presence_ref),v=p.filter(b=>g.indexOf(b.presence_ref)<0);s[u].unshift(...v)}r(u,p,h)}),this.map(c,(u,h)=>{let f=s[u];if(!f)return;const p=h.map(g=>g.presence_ref);f=f.filter(g=>p.indexOf(g.presence_ref)<0),s[u]=f,o(u,f,h),f.length===0&&delete s[u]}),s}static map(s,a){return Object.getOwnPropertyNames(s).map(r=>a(r,s[r]))}static transformState(s){return s=this.cloneDeep(s),Object.getOwnPropertyNames(s).reduce((a,r)=>{const o=s[r];return"metas"in o?a[r]=o.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):a[r]=o,a},{})}static cloneDeep(s){return JSON.parse(JSON.stringify(s))}onJoin(s){this.caller.onJoin=s}onLeave(s){this.caller.onLeave=s}onSync(s){this.caller.onSync=s}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $p;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})($p||($p={}));var Ei;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Ei||(Ei={}));var za;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(za||(za={}));class hm{constructor(s,a={config:{}},r){this.topic=s,this.params=a,this.socket=r,this.bindings={},this.state=is.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=s.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},a.config),this.timeout=this.socket.timeout,this.joinPush=new Jf(this,va.join,this.params,this.timeout),this.rejoinTimer=new W_(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=is.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=is.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=is.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=is.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=is.errored,this.rejoinTimer.scheduleTimeout())}),this._on(va.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Si(this),this.broadcastEndpointURL=K_(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(s,a=this.timeout){var r,o,l;if(this.socket.isConnected()||this.socket.connect(),this.state==is.closed){const{config:{broadcast:c,presence:u,private:h}}=this.params,f=(o=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(b=>b.filter))!==null&&o!==void 0?o:[],p=!!this.bindings[Ei.PRESENCE]&&this.bindings[Ei.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,g={},v={broadcast:c,presence:Object.assign(Object.assign({},u),{enabled:p}),postgres_changes:f,private:h};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(b=>s==null?void 0:s(za.CHANNEL_ERROR,b)),this._onClose(()=>s==null?void 0:s(za.CLOSED)),this.updateJoinPayload(Object.assign({config:v},g)),this.joinedOnce=!0,this._rejoin(a),this.joinPush.receive("ok",async({postgres_changes:b})=>{var _;if(this.socket.setAuth(),b===void 0){s==null||s(za.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,E=(_=w==null?void 0:w.length)!==null&&_!==void 0?_:0,T=[];for(let N=0;N<E;N++){const k=w[N],{filter:{event:S,schema:C,table:M,filter:z}}=k,A=b&&b[N];if(A&&A.event===S&&A.schema===C&&A.table===M&&A.filter===z)T.push(Object.assign(Object.assign({},k),{id:A.id}));else{this.unsubscribe(),this.state=is.errored,s==null||s(za.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=T,s&&s(za.SUBSCRIBED);return}}).receive("error",b=>{this.state=is.errored,s==null||s(za.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{s==null||s(za.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(s,a={}){return await this.send({type:"presence",event:"track",payload:s},a.timeout||this.timeout)}async untrack(s={}){return await this.send({type:"presence",event:"untrack"},s)}on(s,a,r){return this.state===is.joined&&s===Ei.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(s,a,r)}async send(s,a={}){var r,o;if(!this._canPush()&&s.type==="broadcast"){const{event:l,payload:c}=s,h={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(r=a.timeout)!==null&&r!==void 0?r:this.timeout);return await((o=f.body)===null||o===void 0?void 0:o.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,u,h;const f=this._push(s.type,s,a.timeout||this.timeout);s.type==="broadcast"&&!(!((h=(u=(c=this.params)===null||c===void 0?void 0:c.config)===null||u===void 0?void 0:u.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),f.receive("ok",()=>l("ok")),f.receive("error",()=>l("error")),f.receive("timeout",()=>l("timed out"))})}updateJoinPayload(s){this.joinPush.updatePayload(s)}unsubscribe(s=this.timeout){this.state=is.leaving;const a=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(va.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(o=>{r=new Jf(this,va.leave,{},s),r.receive("ok",()=>{a(),o("ok")}).receive("timeout",()=>{a(),o("timed out")}).receive("error",()=>{o("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(s=>s.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=is.closed,this.bindings={}}async _fetchWithTimeout(s,a,r){const o=new AbortController,l=setTimeout(()=>o.abort(),r),c=await this.socket.fetch(s,Object.assign(Object.assign({},a),{signal:o.signal}));return clearTimeout(l),c}_push(s,a,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${s}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new Jf(this,s,a,r);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(s){if(s.startTimeout(),this.pushBuffer.push(s),this.pushBuffer.length>R5){const a=this.pushBuffer.shift();a&&(a.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${a.event}`,a.payload))}}_onMessage(s,a,r){return a}_isMember(s){return this.topic===s}_joinRef(){return this.joinPush.ref}_trigger(s,a,r){var o,l;const c=s.toLocaleLowerCase(),{close:u,error:h,leave:f,join:p}=va;if(r&&[u,h,f,p].indexOf(c)>=0&&r!==this._joinRef())return;let v=this._onMessage(c,a,r);if(a&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(b=>{var _,w,E;return((_=b.filter)===null||_===void 0?void 0:_.event)==="*"||((E=(w=b.filter)===null||w===void 0?void 0:w.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===c}).map(b=>b.callback(v,r)):(l=this.bindings[c])===null||l===void 0||l.filter(b=>{var _,w,E,T,N,k;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in b){const S=b.id,C=(_=b.filter)===null||_===void 0?void 0:_.event;return S&&((w=a.ids)===null||w===void 0?void 0:w.includes(S))&&(C==="*"||(C==null?void 0:C.toLocaleLowerCase())===((E=a.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const S=(N=(T=b==null?void 0:b.filter)===null||T===void 0?void 0:T.event)===null||N===void 0?void 0:N.toLocaleLowerCase();return S==="*"||S===((k=a==null?void 0:a.event)===null||k===void 0?void 0:k.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===c}).map(b=>{if(typeof v=="object"&&"ids"in v){const _=v.data,{schema:w,table:E,commit_timestamp:T,type:N,errors:k}=_;v=Object.assign(Object.assign({},{schema:w,table:E,commit_timestamp:T,eventType:N,new:{},old:{},errors:k}),this._getPayloadRecords(_))}b.callback(v,r)})}_isClosed(){return this.state===is.closed}_isJoined(){return this.state===is.joined}_isJoining(){return this.state===is.joining}_isLeaving(){return this.state===is.leaving}_replyEventName(s){return`chan_reply_${s}`}_on(s,a,r){const o=s.toLocaleLowerCase(),l={type:o,filter:a,callback:r};return this.bindings[o]?this.bindings[o].push(l):this.bindings[o]=[l],this}_off(s,a){const r=s.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(o=>{var l;return!(((l=o.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===r&&hm.isEqual(o.filter,a))})),this}static isEqual(s,a){if(Object.keys(s).length!==Object.keys(a).length)return!1;for(const r in s)if(s[r]!==a[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(s){this._on(va.close,{},s)}_onError(s){this._on(va.error,{},a=>s(a))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(s=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=is.joining,this.joinPush.resend(s))}_getPayloadRecords(s){const a={new:{},old:{}};return(s.type==="INSERT"||s.type==="UPDATE")&&(a.new=Yv(s.columns,s.record)),(s.type==="UPDATE"||s.type==="DELETE")&&(a.old=Yv(s.columns,s.old_record)),a}}const ep=()=>{},lu={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},U5=[1e3,2e3,5e3,1e4],B5=1e4,V5=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class X_{constructor(s,a){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Op,this.transport=null,this.heartbeatIntervalMs=lu.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=ep,this.ref=0,this.reconnectTimer=null,this.logger=ep,this.conn=null,this.sendBuffer=[],this.serializer=new O5,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>{let l;return o?l=o:typeof fetch>"u"?l=(...c)=>Sa(async()=>{const{default:u}=await Promise.resolve().then(()=>Fi);return{default:u}},void 0).then(({default:u})=>u(...c)).catch(u=>{throw new Error(`Failed to load @supabase/node-fetch: ${u.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...c)=>l(...c)},!(!((r=a==null?void 0:a.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=a.params.apikey,this.endPoint=`${s}/${Dp.websocket}`,this.httpEndpoint=K_(s),this._initializeOptions(a),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(a==null?void 0:a.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Z_.createWebSocket(this.endpointURL())}catch(s){this._setConnectionState("disconnected");const a=s.message;throw a.includes("Node.js")?new Error(`${a}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${a}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:A5}))}disconnect(s,a){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},s?this.conn.close(s,a??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(s){const a=await s.unsubscribe();return this.channels.length===0&&this.disconnect(),a}async removeAllChannels(){const s=await Promise.all(this.channels.map(a=>a.unsubscribe()));return this.channels=[],this.disconnect(),s}log(s,a,r){this.logger(s,a,r)}connectionState(){switch(this.conn&&this.conn.readyState){case oc.connecting:return Hn.Connecting;case oc.open:return Hn.Open;case oc.closing:return Hn.Closing;default:return Hn.Closed}}isConnected(){return this.connectionState()===Hn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(s,a={config:{}}){const r=`realtime:${s}`,o=this.getChannels().find(l=>l.topic===r);if(o)return o;{const l=new hm(`realtime:${s}`,a,this);return this.channels.push(l),l}}push(s){const{topic:a,event:r,payload:o,ref:l}=s,c=()=>{this.encode(s,u=>{var h;(h=this.conn)===null||h===void 0||h.send(u)})};this.log("push",`${a} ${r} (${l})`,o),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(s=null){this._authPromise=this._performAuth(s);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var s;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(a){this.log("error","error in heartbeat callback",a)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(a){this.log("error","error in heartbeat callback",a)}this._wasManualDisconnect=!1,(s=this.conn)===null||s===void 0||s.close(M5,"heartbeat timeout"),setTimeout(()=>{var a;this.isConnected()||(a=this.reconnectTimer)===null||a===void 0||a.scheduleTimeout()},lu.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(a){this.log("error","error in heartbeat callback",a)}this._setAuthSafely("heartbeat")}onHeartbeat(s){this.heartbeatCallback=s}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(s=>s()),this.sendBuffer=[])}_makeRef(){let s=this.ref+1;return s===this.ref?this.ref=0:this.ref=s,this.ref.toString()}_leaveOpenTopic(s){let a=this.channels.find(r=>r.topic===s&&(r._isJoined()||r._isJoining()));a&&(this.log("transport",`leaving duplicate topic "${s}"`),a.unsubscribe())}_remove(s){this.channels=this.channels.filter(a=>a.topic!==s.topic)}_onConnMessage(s){this.decode(s.data,a=>{if(a.topic==="phoenix"&&a.event==="phx_reply")try{this.heartbeatCallback(a.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}a.ref&&a.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:o,payload:l,ref:c}=a,u=c?`(${c})`:"",h=l.status||"";this.log("receive",`${h} ${r} ${o} ${u}`.trim(),l),this.channels.filter(f=>f._isMember(r)).forEach(f=>f._trigger(o,l,c)),this._triggerStateCallbacks("message",a)})}_clearTimer(s){var a;s==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):s==="reconnect"&&((a=this.reconnectTimer)===null||a===void 0||a.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=s=>this._onConnError(s),this.conn.onmessage=s=>this._onConnMessage(s),this.conn.onclose=s=>this._onConnClose(s))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(s=>s.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const s=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(s),this.workerRef.onerror=a=>{this.log("worker","worker error",a.message),this.workerRef.terminate()},this.workerRef.onmessage=a=>{a.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(s){var a;this._setConnectionState("disconnected"),this.log("transport","close",s),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(a=this.reconnectTimer)===null||a===void 0||a.scheduleTimeout(),this._triggerStateCallbacks("close",s)}_onConnError(s){this._setConnectionState("disconnected"),this.log("transport",`${s}`),this._triggerChanError(),this._triggerStateCallbacks("error",s)}_triggerChanError(){this.channels.forEach(s=>s._trigger(va.error))}_appendParams(s,a){if(Object.keys(a).length===0)return s;const r=s.match(/\?/)?"&":"?",o=new URLSearchParams(a);return`${s}${r}${o}`}_workerObjectUrl(s){let a;if(s)a=s;else{const r=new Blob([V5],{type:"application/javascript"});a=URL.createObjectURL(r)}return a}_setConnectionState(s,a=!1){this._connectionState=s,s==="connecting"?this._wasManualDisconnect=!1:s==="disconnecting"&&(this._wasManualDisconnect=a)}async _performAuth(s=null){let a;s?a=s:this.accessToken?a=await this.accessToken():a=this.accessTokenValue,this.accessTokenValue!=a&&(this.accessTokenValue=a,this.channels.forEach(r=>{const o={access_token:a,version:T5};a&&r.updateJoinPayload(o),r.joinedOnce&&r._isJoined()&&r._push(va.access_token,{access_token:a})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(s="general"){this.setAuth().catch(a=>{this.log("error",`error setting auth in ${s}`,a)})}_triggerStateCallbacks(s,a){try{this.stateChangeCallbacks[s].forEach(r=>{try{r(a)}catch(o){this.log("error",`error in ${s} callback`,o)}})}catch(r){this.log("error",`error triggering ${s} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new W_(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},lu.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(s){var a,r,o,l,c,u,h,f,p;if(this.transport=(a=s==null?void 0:s.transport)!==null&&a!==void 0?a:null,this.timeout=(r=s==null?void 0:s.timeout)!==null&&r!==void 0?r:Op,this.heartbeatIntervalMs=(o=s==null?void 0:s.heartbeatIntervalMs)!==null&&o!==void 0?o:lu.HEARTBEAT_INTERVAL,this.worker=(l=s==null?void 0:s.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=s==null?void 0:s.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(u=s==null?void 0:s.heartbeatCallback)!==null&&u!==void 0?u:ep,s!=null&&s.params&&(this.params=s.params),s!=null&&s.logger&&(this.logger=s.logger),(s!=null&&s.logLevel||s!=null&&s.log_level)&&(this.logLevel=s.logLevel||s.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=s==null?void 0:s.reconnectAfterMs)!==null&&h!==void 0?h:g=>U5[g-1]||B5,this.encode=(f=s==null?void 0:s.encode)!==null&&f!==void 0?f:(g,v)=>v(JSON.stringify(g)),this.decode=(p=s==null?void 0:s.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=s==null?void 0:s.workerUrl}}}class z0 extends Error{constructor(s){super(s),this.__isStorageError=!0,this.name="StorageError"}}function cs(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class q5 extends z0{constructor(s,a,r){super(s),this.name="StorageApiError",this.status=a,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Lp extends z0{constructor(s,a){super(s),this.name="StorageUnknownError",this.originalError=a}}var F5=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};const Q_=t=>{let s;return t?s=t:typeof fetch>"u"?s=(...a)=>Sa(async()=>{const{default:r}=await Promise.resolve().then(()=>Fi);return{default:r}},void 0).then(({default:r})=>r(...a)):s=fetch,(...a)=>s(...a)},H5=()=>F5(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Sa(()=>Promise.resolve().then(()=>Fi),void 0)).Response:Response}),Ip=t=>{if(Array.isArray(t))return t.map(a=>Ip(a));if(typeof t=="function"||t!==Object(t))return t;const s={};return Object.entries(t).forEach(([a,r])=>{const o=a.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));s[o]=Ip(r)}),s},G5=t=>{if(typeof t!="object"||t===null)return!1;const s=Object.getPrototypeOf(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var ho=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};const tp=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Z5=(t,s,a)=>ho(void 0,void 0,void 0,function*(){const r=yield H5();t instanceof r&&!(a!=null&&a.noResolveJson)?t.json().then(o=>{const l=t.status||500,c=(o==null?void 0:o.statusCode)||l+"";s(new q5(tp(o),l,c))}).catch(o=>{s(new Lp(tp(o),o))}):s(new Lp(tp(t),t))}),W5=(t,s,a,r)=>{const o={method:t,headers:(s==null?void 0:s.headers)||{}};return t==="GET"||!r?o:(G5(r)?(o.headers=Object.assign({"Content-Type":"application/json"},s==null?void 0:s.headers),o.body=JSON.stringify(r)):o.body=r,s!=null&&s.duplex&&(o.duplex=s.duplex),Object.assign(Object.assign({},o),a))};function $c(t,s,a,r,o,l){return ho(this,void 0,void 0,function*(){return new Promise((c,u)=>{t(a,W5(s,r,o,l)).then(h=>{if(!h.ok)throw h;return r!=null&&r.noResolveJson?h:h.json()}).then(h=>c(h)).catch(h=>Z5(h,u,r))})})}function Lu(t,s,a,r){return ho(this,void 0,void 0,function*(){return $c(t,"GET",s,a,r)})}function Pa(t,s,a,r,o){return ho(this,void 0,void 0,function*(){return $c(t,"POST",s,r,o,a)})}function Up(t,s,a,r,o){return ho(this,void 0,void 0,function*(){return $c(t,"PUT",s,r,o,a)})}function Y5(t,s,a,r){return ho(this,void 0,void 0,function*(){return $c(t,"HEAD",s,Object.assign(Object.assign({},a),{noResolveJson:!0}),r)})}function J_(t,s,a,r,o){return ho(this,void 0,void 0,function*(){return $c(t,"DELETE",s,r,o,a)})}var Cs=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};const K5={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Kv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class X5{constructor(s,a={},r,o){this.url=s,this.headers=a,this.bucketId=r,this.fetch=Q_(o)}uploadOrUpdate(s,a,r,o){return Cs(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},Kv),o);let u=Object.assign(Object.assign({},this.headers),s==="POST"&&{"x-upsert":String(c.upsert)});const h=c.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),h&&l.append("metadata",this.encodeMetadata(h)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl),h&&l.append("metadata",this.encodeMetadata(h))):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType,h&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(h)))),o!=null&&o.headers&&(u=Object.assign(Object.assign({},u),o.headers));const f=this._removeEmptyFolders(a),p=this._getFinalPath(f),g=yield(s=="PUT"?Up:Pa)(this.fetch,`${this.url}/object/${p}`,l,Object.assign({headers:u},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{data:{path:f,id:g.Id,fullPath:g.Key},error:null}}catch(l){if(cs(l))return{data:null,error:l};throw l}})}upload(s,a,r){return Cs(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",s,a,r)})}uploadToSignedUrl(s,a,r,o){return Cs(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(s),c=this._getFinalPath(l),u=new URL(this.url+`/object/upload/sign/${c}`);u.searchParams.set("token",a);try{let h;const f=Object.assign({upsert:Kv.upsert},o),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&r instanceof Blob?(h=new FormData,h.append("cacheControl",f.cacheControl),h.append("",r)):typeof FormData<"u"&&r instanceof FormData?(h=r,h.append("cacheControl",f.cacheControl)):(h=r,p["cache-control"]=`max-age=${f.cacheControl}`,p["content-type"]=f.contentType);const g=yield Up(this.fetch,u.toString(),h,{headers:p});return{data:{path:l,fullPath:g.Key},error:null}}catch(h){if(cs(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(s,a){return Cs(this,void 0,void 0,function*(){try{let r=this._getFinalPath(s);const o=Object.assign({},this.headers);a!=null&&a.upsert&&(o["x-upsert"]="true");const l=yield Pa(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:o}),c=new URL(this.url+l.url),u=c.searchParams.get("token");if(!u)throw new z0("No token returned by API");return{data:{signedUrl:c.toString(),path:s,token:u},error:null}}catch(r){if(cs(r))return{data:null,error:r};throw r}})}update(s,a,r){return Cs(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",s,a,r)})}move(s,a,r){return Cs(this,void 0,void 0,function*(){try{return{data:yield Pa(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:s,destinationKey:a,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(cs(o))return{data:null,error:o};throw o}})}copy(s,a,r){return Cs(this,void 0,void 0,function*(){try{return{data:{path:(yield Pa(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:s,destinationKey:a,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(cs(o))return{data:null,error:o};throw o}})}createSignedUrl(s,a,r){return Cs(this,void 0,void 0,function*(){try{let o=this._getFinalPath(s),l=yield Pa(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:a},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const c=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(o){if(cs(o))return{data:null,error:o};throw o}})}createSignedUrls(s,a,r){return Cs(this,void 0,void 0,function*(){try{const o=yield Pa(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:a,paths:s},{headers:this.headers}),l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:o.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(o){if(cs(o))return{data:null,error:o};throw o}})}download(s,a){return Cs(this,void 0,void 0,function*(){const o=typeof(a==null?void 0:a.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((a==null?void 0:a.transform)||{}),c=l?`?${l}`:"";try{const u=this._getFinalPath(s);return{data:yield(yield Lu(this.fetch,`${this.url}/${o}/${u}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(u){if(cs(u))return{data:null,error:u};throw u}})}info(s){return Cs(this,void 0,void 0,function*(){const a=this._getFinalPath(s);try{const r=yield Lu(this.fetch,`${this.url}/object/info/${a}`,{headers:this.headers});return{data:Ip(r),error:null}}catch(r){if(cs(r))return{data:null,error:r};throw r}})}exists(s){return Cs(this,void 0,void 0,function*(){const a=this._getFinalPath(s);try{return yield Y5(this.fetch,`${this.url}/object/${a}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(cs(r)&&r instanceof Lp){const o=r.originalError;if([400,404].includes(o==null?void 0:o.status))return{data:!1,error:r}}throw r}})}getPublicUrl(s,a){const r=this._getFinalPath(s),o=[],l=a!=null&&a.download?`download=${a.download===!0?"":a.download}`:"";l!==""&&o.push(l);const u=typeof(a==null?void 0:a.transform)<"u"?"render/image":"object",h=this.transformOptsToQueryString((a==null?void 0:a.transform)||{});h!==""&&o.push(h);let f=o.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${r}${f}`)}}}remove(s){return Cs(this,void 0,void 0,function*(){try{return{data:yield J_(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:s},{headers:this.headers}),error:null}}catch(a){if(cs(a))return{data:null,error:a};throw a}})}list(s,a,r){return Cs(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},K5),a),{prefix:s||""});return{data:yield Pa(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},r),error:null}}catch(o){if(cs(o))return{data:null,error:o};throw o}})}listV2(s,a){return Cs(this,void 0,void 0,function*(){try{const r=Object.assign({},s);return{data:yield Pa(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},a),error:null}}catch(r){if(cs(r))return{data:null,error:r};throw r}})}encodeMetadata(s){return JSON.stringify(s)}toBase64(s){return typeof Buffer<"u"?Buffer.from(s).toString("base64"):btoa(s)}_getFinalPath(s){return`${this.bucketId}/${s.replace(/^\/+/,"")}`}_removeEmptyFolders(s){return s.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(s){const a=[];return s.width&&a.push(`width=${s.width}`),s.height&&a.push(`height=${s.height}`),s.resize&&a.push(`resize=${s.resize}`),s.format&&a.push(`format=${s.format}`),s.quality&&a.push(`quality=${s.quality}`),a.join("&")}}const Q5="2.11.0",J5={"X-Client-Info":`storage-js/${Q5}`};var oi=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};class e6{constructor(s,a={},r,o){const l=new URL(s);o!=null&&o.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href,this.headers=Object.assign(Object.assign({},J5),a),this.fetch=Q_(r)}listBuckets(){return oi(this,void 0,void 0,function*(){try{return{data:yield Lu(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(s){if(cs(s))return{data:null,error:s};throw s}})}getBucket(s){return oi(this,void 0,void 0,function*(){try{return{data:yield Lu(this.fetch,`${this.url}/bucket/${s}`,{headers:this.headers}),error:null}}catch(a){if(cs(a))return{data:null,error:a};throw a}})}createBucket(s,a={public:!1}){return oi(this,void 0,void 0,function*(){try{return{data:yield Pa(this.fetch,`${this.url}/bucket`,{id:s,name:s,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(cs(r))return{data:null,error:r};throw r}})}updateBucket(s,a){return oi(this,void 0,void 0,function*(){try{return{data:yield Up(this.fetch,`${this.url}/bucket/${s}`,{id:s,name:s,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(cs(r))return{data:null,error:r};throw r}})}emptyBucket(s){return oi(this,void 0,void 0,function*(){try{return{data:yield Pa(this.fetch,`${this.url}/bucket/${s}/empty`,{},{headers:this.headers}),error:null}}catch(a){if(cs(a))return{data:null,error:a};throw a}})}deleteBucket(s){return oi(this,void 0,void 0,function*(){try{return{data:yield J_(this.fetch,`${this.url}/bucket/${s}`,{},{headers:this.headers}),error:null}}catch(a){if(cs(a))return{data:null,error:a};throw a}})}}class t6 extends e6{constructor(s,a={},r,o){super(s,a,r,o)}from(s){return new X5(this.url,this.headers,s,this.fetch)}}const s6="2.56.1";let Jl="";typeof Deno<"u"?Jl="deno":typeof document<"u"?Jl="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Jl="react-native":Jl="node";const a6={"X-Client-Info":`supabase-js-${Jl}/${s6}`},r6={headers:a6},n6={schema:"public"},o6={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},i6={};var l6=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};const c6=t=>{let s;return t?s=t:typeof fetch>"u"?s=B_:s=fetch,(...a)=>s(...a)},d6=()=>typeof Headers>"u"?V_:Headers,u6=(t,s,a)=>{const r=c6(a),o=d6();return(l,c)=>l6(void 0,void 0,void 0,function*(){var u;const h=(u=yield s())!==null&&u!==void 0?u:t;let f=new o(c==null?void 0:c.headers);return f.has("apikey")||f.set("apikey",t),f.has("Authorization")||f.set("Authorization",`Bearer ${h}`),r(l,Object.assign(Object.assign({},c),{headers:f}))})};var m6=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};function h6(t){return t.endsWith("/")?t:t+"/"}function f6(t,s){var a,r;const{db:o,auth:l,realtime:c,global:u}=t,{db:h,auth:f,realtime:p,global:g}=s,v={db:Object.assign(Object.assign({},h),o),auth:Object.assign(Object.assign({},f),l),realtime:Object.assign(Object.assign({},p),c),storage:{},global:Object.assign(Object.assign(Object.assign({},g),u),{headers:Object.assign(Object.assign({},(a=g==null?void 0:g.headers)!==null&&a!==void 0?a:{}),(r=u==null?void 0:u.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>m6(this,void 0,void 0,function*(){return""})};return t.accessToken?v.accessToken=t.accessToken:delete v.accessToken,v}const e1="2.71.1",gi=30*1e3,Bp=3,sp=Bp*gi,p6="http://localhost:9999",g6="supabase.auth.token",x6={"X-Client-Info":`gotrue-js/${e1}`},Vp="X-Supabase-Api-Version",t1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},y6=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,b6=10*60*1e3;class fm extends Error{constructor(s,a,r){super(s),this.__isAuthError=!0,this.name="AuthError",this.status=a,this.code=r}}function Ke(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class s1 extends fm{constructor(s,a,r){super(s,a,r),this.name="AuthApiError",this.status=a,this.code=r}}function a1(t){return Ke(t)&&t.name==="AuthApiError"}class $0 extends fm{constructor(s,a){super(s),this.name="AuthUnknownError",this.originalError=a}}class Ar extends fm{constructor(s,a,r,o){super(s,r,o),this.name=a,this.status=r}}class xr extends Ar{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function r1(t){return Ke(t)&&t.name==="AuthSessionMissingError"}class ec extends Ar{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class tc extends Ar{constructor(s){super(s,"AuthInvalidCredentialsError",400,void 0)}}class sc extends Ar{constructor(s,a=null){super(s,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function n1(t){return Ke(t)&&t.name==="AuthImplicitGrantRedirectError"}class qp extends Ar{constructor(s,a=null){super(s,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Iu extends Ar{constructor(s,a){super(s,"AuthRetryableFetchError",a,void 0)}}function Eu(t){return Ke(t)&&t.name==="AuthRetryableFetchError"}class Fp extends Ar{constructor(s,a,r){super(s,"AuthWeakPasswordError",a,"weak_password"),this.reasons=r}}class Uu extends Ar{constructor(s){super(s,"AuthInvalidJwtError",400,"invalid_jwt")}}const Bu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Xv=` 	
\r=`.split(""),v6=(()=>{const t=new Array(128);for(let s=0;s<t.length;s+=1)t[s]=-1;for(let s=0;s<Xv.length;s+=1)t[Xv[s].charCodeAt(0)]=-2;for(let s=0;s<Bu.length;s+=1)t[Bu[s].charCodeAt(0)]=s;return t})();function Qv(t,s,a){if(t!==null)for(s.queue=s.queue<<8|t,s.queuedBits+=8;s.queuedBits>=6;){const r=s.queue>>s.queuedBits-6&63;a(Bu[r]),s.queuedBits-=6}else if(s.queuedBits>0)for(s.queue=s.queue<<6-s.queuedBits,s.queuedBits=6;s.queuedBits>=6;){const r=s.queue>>s.queuedBits-6&63;a(Bu[r]),s.queuedBits-=6}}function o1(t,s,a){const r=v6[t];if(r>-1)for(s.queue=s.queue<<6|r,s.queuedBits+=6;s.queuedBits>=8;)a(s.queue>>s.queuedBits-8&255),s.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function Jv(t){const s=[],a=c=>{s.push(String.fromCodePoint(c))},r={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},l=c=>{_6(c,r,a)};for(let c=0;c<t.length;c+=1)o1(t.charCodeAt(c),o,l);return s.join("")}function w6(t,s){if(t<=127){s(t);return}else if(t<=2047){s(192|t>>6),s(128|t&63);return}else if(t<=65535){s(224|t>>12),s(128|t>>6&63),s(128|t&63);return}else if(t<=1114111){s(240|t>>18),s(128|t>>12&63),s(128|t>>6&63),s(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function j6(t,s){for(let a=0;a<t.length;a+=1){let r=t.charCodeAt(a);if(r>55295&&r<=56319){const o=(r-55296)*1024&65535;r=(t.charCodeAt(a+1)-56320&65535|o)+65536,a+=1}w6(r,s)}}function _6(t,s,a){if(s.utf8seq===0){if(t<=127){a(t);return}for(let r=1;r<6;r+=1)if((t>>7-r&1)===0){s.utf8seq=r;break}if(s.utf8seq===2)s.codepoint=t&31;else if(s.utf8seq===3)s.codepoint=t&15;else if(s.utf8seq===4)s.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");s.utf8seq-=1}else if(s.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");s.codepoint=s.codepoint<<6|t&63,s.utf8seq-=1,s.utf8seq===0&&a(s.codepoint)}}function N6(t){const s=[],a={queue:0,queuedBits:0},r=o=>{s.push(o)};for(let o=0;o<t.length;o+=1)o1(t.charCodeAt(o),a,r);return new Uint8Array(s)}function S6(t){const s=[];return j6(t,a=>s.push(a)),new Uint8Array(s)}function E6(t){const s=[],a={queue:0,queuedBits:0},r=o=>{s.push(o)};return t.forEach(o=>Qv(o,a,r)),Qv(null,a,r),s.join("")}function C6(t){return Math.round(Date.now()/1e3)+t}function k6(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const s=Math.random()*16|0;return(t=="x"?s:s&3|8).toString(16)})}const ya=()=>typeof window<"u"&&typeof document<"u",$n={tested:!1,writable:!1},i1=()=>{if(!ya())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if($n.tested)return $n.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),$n.tested=!0,$n.writable=!0}catch{$n.tested=!0,$n.writable=!1}return $n.writable};function T6(t){const s={},a=new URL(t);if(a.hash&&a.hash[0]==="#")try{new URLSearchParams(a.hash.substring(1)).forEach((o,l)=>{s[l]=o})}catch{}return a.searchParams.forEach((r,o)=>{s[o]=r}),s}const l1=t=>{let s;return t?s=t:typeof fetch>"u"?s=(...a)=>Sa(async()=>{const{default:r}=await Promise.resolve().then(()=>Fi);return{default:r}},void 0).then(({default:r})=>r(...a)):s=fetch,(...a)=>s(...a)},A6=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",xi=async(t,s,a)=>{await t.setItem(s,JSON.stringify(a))},Ln=async(t,s)=>{const a=await t.getItem(s);if(!a)return null;try{return JSON.parse(a)}catch{return a}},rn=async(t,s)=>{await t.removeItem(s)};class pm{constructor(){this.promise=new pm.promiseConstructor((s,a)=>{this.resolve=s,this.reject=a})}}pm.promiseConstructor=Promise;function ap(t){const s=t.split(".");if(s.length!==3)throw new Uu("Invalid JWT structure");for(let r=0;r<s.length;r++)if(!y6.test(s[r]))throw new Uu("JWT not in base64url format");return{header:JSON.parse(Jv(s[0])),payload:JSON.parse(Jv(s[1])),signature:N6(s[2]),raw:{header:s[0],payload:s[1]}}}async function M6(t){return await new Promise(s=>{setTimeout(()=>s(null),t)})}function R6(t,s){return new Promise((r,o)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await t(l);if(!s(l,null,c)){r(c);return}}catch(c){if(!s(l,c)){o(c);return}}})()})}function O6(t){return("0"+t.toString(16)).substr(-2)}function D6(){const s=new Uint32Array(56);if(typeof crypto>"u"){const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=a.length;let o="";for(let l=0;l<56;l++)o+=a.charAt(Math.floor(Math.random()*r));return o}return crypto.getRandomValues(s),Array.from(s,O6).join("")}async function P6(t){const a=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",a),o=new Uint8Array(r);return Array.from(o).map(l=>String.fromCharCode(l)).join("")}async function z6(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const a=await P6(t);return btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function ii(t,s,a=!1){const r=D6();let o=r;a&&(o+="/PASSWORD_RECOVERY"),await xi(t,`${s}-code-verifier`,o);const l=await z6(r);return[l,r===l?"plain":"s256"]}const $6=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function L6(t){const s=t.headers.get(Vp);if(!s||!s.match($6))return null;try{return new Date(`${s}T00:00:00.0Z`)}catch{return null}}function I6(t){if(!t)throw new Error("Missing exp claim");const s=Math.floor(Date.now()/1e3);if(t<=s)throw new Error("JWT has expired")}function U6(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const B6=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function li(t){if(!B6.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function rp(){const t={};return new Proxy(t,{get:(s,a)=>{if(a==="__isUserNotAvailableProxy")return!0;if(typeof a=="symbol"){const r=a.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${a}" property of the session object is not supported. Please use getUser() instead.`)},set:(s,a)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${a}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(s,a)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${a}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function ew(t){return JSON.parse(JSON.stringify(t))}var V6=function(t,s){var a={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&s.indexOf(r)<0&&(a[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)s.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(a[r[o]]=t[r[o]]);return a};const Un=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),q6=[502,503,504];async function tw(t){var s;if(!A6(t))throw new Iu(Un(t),0);if(q6.includes(t.status))throw new Iu(Un(t),t.status);let a;try{a=await t.json()}catch(l){throw new $0(Un(l),l)}let r;const o=L6(t);if(o&&o.getTime()>=t1["2024-01-01"].timestamp&&typeof a=="object"&&a&&typeof a.code=="string"?r=a.code:typeof a=="object"&&a&&typeof a.error_code=="string"&&(r=a.error_code),r){if(r==="weak_password")throw new Fp(Un(a),t.status,((s=a.weak_password)===null||s===void 0?void 0:s.reasons)||[]);if(r==="session_not_found")throw new xr}else if(typeof a=="object"&&a&&typeof a.weak_password=="object"&&a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new Fp(Un(a),t.status,a.weak_password.reasons);throw new s1(Un(a),t.status||500,r)}const F6=(t,s,a,r)=>{const o={method:t,headers:(s==null?void 0:s.headers)||{}};return t==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},s==null?void 0:s.headers),o.body=JSON.stringify(r),Object.assign(Object.assign({},o),a))};async function at(t,s,a,r){var o;const l=Object.assign({},r==null?void 0:r.headers);l[Vp]||(l[Vp]=t1["2024-01-01"].name),r!=null&&r.jwt&&(l.Authorization=`Bearer ${r.jwt}`);const c=(o=r==null?void 0:r.query)!==null&&o!==void 0?o:{};r!=null&&r.redirectTo&&(c.redirect_to=r.redirectTo);const u=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",h=await H6(t,s,a+u,{headers:l,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(h):{data:Object.assign({},h),error:null}}async function H6(t,s,a,r,o,l){const c=F6(s,r,o,l);let u;try{u=await t(a,Object.assign({},c))}catch(h){throw console.error(h),new Iu(Un(h),0)}if(u.ok||await tw(u),r!=null&&r.noResolveJson)return u;try{return await u.json()}catch(h){await tw(h)}}function gr(t){var s;let a=null;Y6(t)&&(a=Object.assign({},t),t.expires_at||(a.expires_at=C6(t.expires_in)));const r=(s=t.user)!==null&&s!==void 0?s:t;return{data:{session:a,user:r},error:null}}function sw(t){const s=gr(t);return!s.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((a,r)=>a&&typeof r=="string",!0)&&(s.data.weak_password=t.weak_password),s}function ln(t){var s;return{data:{user:(s=t.user)!==null&&s!==void 0?s:t},error:null}}function G6(t){return{data:t,error:null}}function Z6(t){const{action_link:s,email_otp:a,hashed_token:r,redirect_to:o,verification_type:l}=t,c=V6(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:s,email_otp:a,hashed_token:r,redirect_to:o,verification_type:l},h=Object.assign({},c);return{data:{properties:u,user:h},error:null}}function W6(t){return t}function Y6(t){return t.access_token&&t.refresh_token&&t.expires_in}const Cu=["global","local","others"];var K6=function(t,s){var a={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&s.indexOf(r)<0&&(a[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)s.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(a[r[o]]=t[r[o]]);return a};class c1{constructor({url:s="",headers:a={},fetch:r}){this.url=s,this.headers=a,this.fetch=l1(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(s,a=Cu[0]){if(Cu.indexOf(a)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Cu.join(", ")}`);try{return await at(this.fetch,"POST",`${this.url}/logout?scope=${a}`,{headers:this.headers,jwt:s,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ke(r))return{data:null,error:r};throw r}}async inviteUserByEmail(s,a={}){try{return await at(this.fetch,"POST",`${this.url}/invite`,{body:{email:s,data:a.data},headers:this.headers,redirectTo:a.redirectTo,xform:ln})}catch(r){if(Ke(r))return{data:{user:null},error:r};throw r}}async generateLink(s){try{const{options:a}=s,r=K6(s,["options"]),o=Object.assign(Object.assign({},r),a);return"newEmail"in r&&(o.new_email=r==null?void 0:r.newEmail,delete o.newEmail),await at(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:Z6,redirectTo:a==null?void 0:a.redirectTo})}catch(a){if(Ke(a))return{data:{properties:null,user:null},error:a};throw a}}async createUser(s){try{return await at(this.fetch,"POST",`${this.url}/admin/users`,{body:s,headers:this.headers,xform:ln})}catch(a){if(Ke(a))return{data:{user:null},error:a};throw a}}async listUsers(s){var a,r,o,l,c,u,h;try{const f={nextPage:null,lastPage:0,total:0},p=await at(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(a=s==null?void 0:s.page)===null||a===void 0?void 0:a.toString())!==null&&r!==void 0?r:"",per_page:(l=(o=s==null?void 0:s.perPage)===null||o===void 0?void 0:o.toString())!==null&&l!==void 0?l:""},xform:W6});if(p.error)throw p.error;const g=await p.json(),v=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,b=(h=(u=p.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return b.length>0&&(b.forEach(_=>{const w=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(_.split(";")[1].split("=")[1]);f[`${E}Page`]=w}),f.total=parseInt(v)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(Ke(f))return{data:{users:[]},error:f};throw f}}async getUserById(s){li(s);try{return await at(this.fetch,"GET",`${this.url}/admin/users/${s}`,{headers:this.headers,xform:ln})}catch(a){if(Ke(a))return{data:{user:null},error:a};throw a}}async updateUserById(s,a){li(s);try{return await at(this.fetch,"PUT",`${this.url}/admin/users/${s}`,{body:a,headers:this.headers,xform:ln})}catch(r){if(Ke(r))return{data:{user:null},error:r};throw r}}async deleteUser(s,a=!1){li(s);try{return await at(this.fetch,"DELETE",`${this.url}/admin/users/${s}`,{headers:this.headers,body:{should_soft_delete:a},xform:ln})}catch(r){if(Ke(r))return{data:{user:null},error:r};throw r}}async _listFactors(s){li(s.userId);try{const{data:a,error:r}=await at(this.fetch,"GET",`${this.url}/admin/users/${s.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:a,error:r}}catch(a){if(Ke(a))return{data:null,error:a};throw a}}async _deleteFactor(s){li(s.userId),li(s.id);try{return{data:await at(this.fetch,"DELETE",`${this.url}/admin/users/${s.userId}/factors/${s.id}`,{headers:this.headers}),error:null}}catch(a){if(Ke(a))return{data:null,error:a};throw a}}}function aw(t={}){return{getItem:s=>t[s]||null,setItem:(s,a)=>{t[s]=a},removeItem:s=>{delete t[s]}}}function X6(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Bn={debug:!!(globalThis&&i1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class d1 extends Error{constructor(s){super(s),this.isAcquireTimeout=!0}}class u1 extends d1{}async function m1(t,s,a){Bn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,s);const r=new globalThis.AbortController;return s>0&&setTimeout(()=>{r.abort(),Bn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},s),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,s===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async o=>{if(o){Bn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,o.name);try{return await a()}finally{Bn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,o.name)}}else{if(s===0)throw Bn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new u1(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Bn.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await a()}}))}X6();const Q6={url:p6,storageKey:g6,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:x6,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function rw(t,s,a){return await a()}const ci={};class Oi{constructor(s){var a,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Oi.nextInstanceID,Oi.nextInstanceID+=1,this.instanceID>0&&ya()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},Q6),s);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new c1({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=l1(o.fetch),this.lock=o.lock||rw,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:ya()&&(!((a=globalThis==null?void 0:globalThis.navigator)===null||a===void 0)&&a.locks)?this.lock=m1:this.lock=rw,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:i1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=aw(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=aw(this.memoryStorage)),ya()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}get jwks(){var s,a;return(a=(s=ci[this.storageKey])===null||s===void 0?void 0:s.jwks)!==null&&a!==void 0?a:{keys:[]}}set jwks(s){ci[this.storageKey]=Object.assign(Object.assign({},ci[this.storageKey]),{jwks:s})}get jwks_cached_at(){var s,a;return(a=(s=ci[this.storageKey])===null||s===void 0?void 0:s.cachedAt)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER}set jwks_cached_at(s){ci[this.storageKey]=Object.assign(Object.assign({},ci[this.storageKey]),{cachedAt:s})}_debug(...s){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${e1}) ${new Date().toISOString()}`,...s),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var s;try{const a=T6(window.location.href);let r="none";if(this._isImplicitGrantCallback(a)?r="implicit":await this._isPKCECallback(a)&&(r="pkce"),ya()&&this.detectSessionInUrl&&r!=="none"){const{data:o,error:l}=await this._getSessionFromURL(a,r);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),n1(l)){const h=(s=l.details)===null||s===void 0?void 0:s.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:u}=o;return this._debug("#_initialize()","detected session in URL",c,"redirect type",u),await this._saveSession(c),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(a){return Ke(a)?{error:a}:{error:new $0("Unexpected error during initialization",a)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(s){var a,r,o;try{const l=await at(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(a=s==null?void 0:s.options)===null||a===void 0?void 0:a.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(o=s==null?void 0:s.options)===null||o===void 0?void 0:o.captchaToken}},xform:gr}),{data:c,error:u}=l;if(u||!c)return{data:{user:null,session:null},error:u};const h=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:f,session:h},error:null}}catch(l){if(Ke(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(s){var a,r,o;try{let l;if("email"in s){const{email:p,password:g,options:v}=s;let b=null,_=null;this.flowType==="pkce"&&([b,_]=await ii(this.storage,this.storageKey)),l=await at(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v==null?void 0:v.emailRedirectTo,body:{email:p,password:g,data:(a=v==null?void 0:v.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:b,code_challenge_method:_},xform:gr})}else if("phone"in s){const{phone:p,password:g,options:v}=s;l=await at(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:g,data:(r=v==null?void 0:v.data)!==null&&r!==void 0?r:{},channel:(o=v==null?void 0:v.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken}},xform:gr})}else throw new tc("You must provide either an email or phone number and a password");const{data:c,error:u}=l;if(u||!c)return{data:{user:null,session:null},error:u};const h=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:f,session:h},error:null}}catch(l){if(Ke(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(s){try{let a;if("email"in s){const{email:l,password:c,options:u}=s;a=await at(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:sw})}else if("phone"in s){const{phone:l,password:c,options:u}=s;a=await at(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:sw})}else throw new tc("You must provide either an email or phone number and a password");const{data:r,error:o}=a;return o?{data:{user:null,session:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new ec}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o})}catch(a){if(Ke(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithOAuth(s){var a,r,o,l;return await this._handleProviderSignIn(s.provider,{redirectTo:(a=s.options)===null||a===void 0?void 0:a.redirectTo,scopes:(r=s.options)===null||r===void 0?void 0:r.scopes,queryParams:(o=s.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(l=s.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(s){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(s))}async signInWithWeb3(s){const{chain:a}=s;if(a==="solana")return await this.signInWithSolana(s);throw new Error(`@supabase/auth-js: Unsupported chain "${a}"`)}async signInWithSolana(s){var a,r,o,l,c,u,h,f,p,g,v,b;let _,w;if("message"in s)_=s.message,w=s.signature;else{const{chain:E,wallet:T,statement:N,options:k}=s;let S;if(ya())if(typeof T=="object")S=T;else{const M=window;if("solana"in M&&typeof M.solana=="object"&&("signIn"in M.solana&&typeof M.solana.signIn=="function"||"signMessage"in M.solana&&typeof M.solana.signMessage=="function"))S=M.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof T!="object"||!(k!=null&&k.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=T}const C=new URL((a=k==null?void 0:k.url)!==null&&a!==void 0?a:window.location.href);if("signIn"in S&&S.signIn){const M=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},k==null?void 0:k.signInWithSolana),{version:"1",domain:C.host,uri:C.href}),N?{statement:N}:null));let z;if(Array.isArray(M)&&M[0]&&typeof M[0]=="object")z=M[0];else if(M&&typeof M=="object"&&"signedMessage"in M&&"signature"in M)z=M;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in z&&"signature"in z&&(typeof z.signedMessage=="string"||z.signedMessage instanceof Uint8Array)&&z.signature instanceof Uint8Array)_=typeof z.signedMessage=="string"?z.signedMessage:new TextDecoder().decode(z.signedMessage),w=z.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_=[`${C.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...N?["",N,""]:[""],"Version: 1",`URI: ${C.href}`,`Issued At: ${(o=(r=k==null?void 0:k.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((l=k==null?void 0:k.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${k.signInWithSolana.notBefore}`]:[],...!((c=k==null?void 0:k.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${k.signInWithSolana.expirationTime}`]:[],...!((u=k==null?void 0:k.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${k.signInWithSolana.chainId}`]:[],...!((h=k==null?void 0:k.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${k.signInWithSolana.nonce}`]:[],...!((f=k==null?void 0:k.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${k.signInWithSolana.requestId}`]:[],...!((g=(p=k==null?void 0:k.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||g===void 0)&&g.length?["Resources",...k.signInWithSolana.resources.map(z=>`- ${z}`)]:[]].join(`
`);const M=await S.signMessage(new TextEncoder().encode(_),"utf8");if(!M||!(M instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=M}}try{const{data:E,error:T}=await at(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_,signature:E6(w)},!((v=s.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(b=s.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:gr});if(T)throw T;return!E||!E.session||!E.user?{data:{user:null,session:null},error:new ec}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),{data:Object.assign({},E),error:T})}catch(E){if(Ke(E))return{data:{user:null,session:null},error:E};throw E}}async _exchangeCodeForSession(s){const a=await Ln(this.storage,`${this.storageKey}-code-verifier`),[r,o]=(a??"").split("/");try{const{data:l,error:c}=await at(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:s,code_verifier:r},xform:gr});if(await rn(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new ec}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:o??null}),error:c})}catch(l){if(Ke(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(s){try{const{options:a,provider:r,token:o,access_token:l,nonce:c}=s,u=await at(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:o,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:gr}),{data:h,error:f}=u;return f?{data:{user:null,session:null},error:f}:!h||!h.session||!h.user?{data:{user:null,session:null},error:new ec}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),{data:h,error:f})}catch(a){if(Ke(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithOtp(s){var a,r,o,l,c;try{if("email"in s){const{email:u,options:h}=s;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await ii(this.storage,this.storageKey));const{error:g}=await at(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(a=h==null?void 0:h.data)!==null&&a!==void 0?a:{},create_user:(r=h==null?void 0:h.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:p},redirectTo:h==null?void 0:h.emailRedirectTo});return{data:{user:null,session:null},error:g}}if("phone"in s){const{phone:u,options:h}=s,{data:f,error:p}=await at(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(o=h==null?void 0:h.data)!==null&&o!==void 0?o:{},create_user:(l=h==null?void 0:h.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},channel:(c=h==null?void 0:h.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:p}}throw new tc("You must provide either an email or phone number.")}catch(u){if(Ke(u))return{data:{user:null,session:null},error:u};throw u}}async verifyOtp(s){var a,r;try{let o,l;"options"in s&&(o=(a=s.options)===null||a===void 0?void 0:a.redirectTo,l=(r=s.options)===null||r===void 0?void 0:r.captchaToken);const{data:c,error:u}=await at(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},s),{gotrue_meta_security:{captcha_token:l}}),redirectTo:o,xform:gr});if(u)throw u;if(!c)throw new Error("An error occurred on token verification.");const h=c.session,f=c.user;return h!=null&&h.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(s.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),{data:{user:f,session:h},error:null}}catch(o){if(Ke(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(s){var a,r,o;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await ii(this.storage,this.storageKey)),await at(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in s?{provider_id:s.providerId}:null),"domain"in s?{domain:s.domain}:null),{redirect_to:(r=(a=s.options)===null||a===void 0?void 0:a.redirectTo)!==null&&r!==void 0?r:void 0}),!((o=s==null?void 0:s.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:s.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:G6})}catch(l){if(Ke(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async s=>{const{data:{session:a},error:r}=s;if(r)throw r;if(!a)throw new xr;const{error:o}=await at(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:a.access_token});return{data:{user:null,session:null},error:o}})}catch(s){if(Ke(s))return{data:{user:null,session:null},error:s};throw s}}async resend(s){try{const a=`${this.url}/resend`;if("email"in s){const{email:r,type:o,options:l}=s,{error:c}=await at(this.fetch,"POST",a,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in s){const{phone:r,type:o,options:l}=s,{data:c,error:u}=await at(this.fetch,"POST",a,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new tc("You must provide either an email or phone number and a type")}catch(a){if(Ke(a))return{data:{user:null,session:null},error:a};throw a}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async a=>a))}async _acquireLock(s,a){this._debug("#_acquireLock","begin",s);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await r,await a()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,s,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=a();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(s){this._debug("#_useSession","begin");try{const a=await this.__loadSession();return await s(a)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let s=null;const a=await Ln(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",a),a!==null&&(this._isValidSession(a)?s=a:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!s)return{data:{session:null},error:null};const r=s.expires_at?s.expires_at*1e3-Date.now()<sp:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",s.expires_at),!r){if(this.userStorage){const c=await Ln(this.userStorage,this.storageKey+"-user");c!=null&&c.user?s.user=c.user:s.user=rp()}if(this.storage.isServer&&s.user){let c=this.suppressGetSessionWarning;s=new Proxy(s,{get:(h,f,p)=>(!c&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(h,f,p))})}return{data:{session:s},error:null}}const{session:o,error:l}=await this._callRefreshToken(s.refresh_token);return l?{data:{session:null},error:l}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(s){return s?await this._getUser(s):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(s){try{return s?await at(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:s,xform:ln}):await this._useSession(async a=>{var r,o,l;const{data:c,error:u}=a;if(u)throw u;return!(!((r=c.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new xr}:await at(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(o=c.session)===null||o===void 0?void 0:o.access_token)!==null&&l!==void 0?l:void 0,xform:ln})})}catch(a){if(Ke(a))return r1(a)&&(await this._removeSession(),await rn(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:a};throw a}}async updateUser(s,a={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(s,a))}async _updateUser(s,a={}){try{return await this._useSession(async r=>{const{data:o,error:l}=r;if(l)throw l;if(!o.session)throw new xr;const c=o.session;let u=null,h=null;this.flowType==="pkce"&&s.email!=null&&([u,h]=await ii(this.storage,this.storageKey));const{data:f,error:p}=await at(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:a==null?void 0:a.emailRedirectTo,body:Object.assign(Object.assign({},s),{code_challenge:u,code_challenge_method:h}),jwt:c.access_token,xform:ln});if(p)throw p;return c.user=f.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(r){if(Ke(r))return{data:{user:null},error:r};throw r}}async setSession(s){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(s))}async _setSession(s){try{if(!s.access_token||!s.refresh_token)throw new xr;const a=Date.now()/1e3;let r=a,o=!0,l=null;const{payload:c}=ap(s.access_token);if(c.exp&&(r=c.exp,o=r<=a),o){const{session:u,error:h}=await this._callRefreshToken(s.refresh_token);if(h)return{data:{user:null,session:null},error:h};if(!u)return{data:{user:null,session:null},error:null};l=u}else{const{data:u,error:h}=await this._getUser(s.access_token);if(h)throw h;l={access_token:s.access_token,refresh_token:s.refresh_token,user:u.user,token_type:"bearer",expires_in:r-a,expires_at:r},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(a){if(Ke(a))return{data:{session:null,user:null},error:a};throw a}}async refreshSession(s){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(s))}async _refreshSession(s){try{return await this._useSession(async a=>{var r;if(!s){const{data:c,error:u}=a;if(u)throw u;s=(r=c.session)!==null&&r!==void 0?r:void 0}if(!(s!=null&&s.refresh_token))throw new xr;const{session:o,error:l}=await this._callRefreshToken(s.refresh_token);return l?{data:{user:null,session:null},error:l}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(a){if(Ke(a))return{data:{user:null,session:null},error:a};throw a}}async _getSessionFromURL(s,a){try{if(!ya())throw new sc("No browser detected.");if(s.error||s.error_description||s.error_code)throw new sc(s.error_description||"Error in URL with unspecified error_description",{error:s.error||"unspecified_error",code:s.error_code||"unspecified_code"});switch(a){case"implicit":if(this.flowType==="pkce")throw new qp("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new sc("Not a valid implicit grant flow url.");break;default:}if(a==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!s.code)throw new qp("No code detected.");const{data:N,error:k}=await this._exchangeCodeForSession(s.code);if(k)throw k;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:N.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:o,access_token:l,refresh_token:c,expires_in:u,expires_at:h,token_type:f}=s;if(!l||!u||!c||!f)throw new sc("No session defined in URL");const p=Math.round(Date.now()/1e3),g=parseInt(u);let v=p+g;h&&(v=parseInt(h));const b=v-p;b*1e3<=gi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${g}s`);const _=v-g;p-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,v,p):p-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,v,p);const{data:w,error:E}=await this._getUser(l);if(E)throw E;const T={provider_token:r,provider_refresh_token:o,access_token:l,expires_in:g,expires_at:v,refresh_token:c,token_type:f,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:T,redirectType:s.type},error:null}}catch(r){if(Ke(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(s){return!!(s.access_token||s.error_description)}async _isPKCECallback(s){const a=await Ln(this.storage,`${this.storageKey}-code-verifier`);return!!(s.code&&a)}async signOut(s={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(s))}async _signOut({scope:s}={scope:"global"}){return await this._useSession(async a=>{var r;const{data:o,error:l}=a;if(l)return{error:l};const c=(r=o.session)===null||r===void 0?void 0:r.access_token;if(c){const{error:u}=await this.admin.signOut(c,s);if(u&&!(a1(u)&&(u.status===404||u.status===401||u.status===403)))return{error:u}}return s!=="others"&&(await this._removeSession(),await rn(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(s){const a=k6(),r={id:a,callback:s,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",a),this.stateChangeEmitters.delete(a)}};return this._debug("#onAuthStateChange()","registered callback with id",a),this.stateChangeEmitters.set(a,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(a)})))(),{data:{subscription:r}}}async _emitInitialSession(s){return await this._useSession(async a=>{var r,o;try{const{data:{session:l},error:c}=a;if(c)throw c;await((r=this.stateChangeEmitters.get(s))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",s,"session",l)}catch(l){await((o=this.stateChangeEmitters.get(s))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",s,"error",l),console.error(l)}})}async resetPasswordForEmail(s,a={}){let r=null,o=null;this.flowType==="pkce"&&([r,o]=await ii(this.storage,this.storageKey,!0));try{return await at(this.fetch,"POST",`${this.url}/recover`,{body:{email:s,code_challenge:r,code_challenge_method:o,gotrue_meta_security:{captcha_token:a.captchaToken}},headers:this.headers,redirectTo:a.redirectTo})}catch(l){if(Ke(l))return{data:null,error:l};throw l}}async getUserIdentities(){var s;try{const{data:a,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(s=a.user.identities)!==null&&s!==void 0?s:[]},error:null}}catch(a){if(Ke(a))return{data:null,error:a};throw a}}async linkIdentity(s){var a;try{const{data:r,error:o}=await this._useSession(async l=>{var c,u,h,f,p;const{data:g,error:v}=l;if(v)throw v;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,s.provider,{redirectTo:(c=s.options)===null||c===void 0?void 0:c.redirectTo,scopes:(u=s.options)===null||u===void 0?void 0:u.scopes,queryParams:(h=s.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await at(this.fetch,"GET",b,{headers:this.headers,jwt:(p=(f=g.session)===null||f===void 0?void 0:f.access_token)!==null&&p!==void 0?p:void 0})});if(o)throw o;return ya()&&!(!((a=s.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:s.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Ke(r))return{data:{provider:s.provider,url:null},error:r};throw r}}async unlinkIdentity(s){try{return await this._useSession(async a=>{var r,o;const{data:l,error:c}=a;if(c)throw c;return await at(this.fetch,"DELETE",`${this.url}/user/identities/${s.identity_id}`,{headers:this.headers,jwt:(o=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0})})}catch(a){if(Ke(a))return{data:null,error:a};throw a}}async _refreshAccessToken(s){const a=`#_refreshAccessToken(${s.substring(0,5)}...)`;this._debug(a,"begin");try{const r=Date.now();return await R6(async o=>(o>0&&await M6(200*Math.pow(2,o-1)),this._debug(a,"refreshing attempt",o),await at(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:s},headers:this.headers,xform:gr})),(o,l)=>{const c=200*Math.pow(2,o);return l&&Eu(l)&&Date.now()+c-r<gi})}catch(r){if(this._debug(a,"error",r),Ke(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(a,"end")}}_isValidSession(s){return typeof s=="object"&&s!==null&&"access_token"in s&&"refresh_token"in s&&"expires_at"in s}async _handleProviderSignIn(s,a){const r=await this._getUrlForProvider(`${this.url}/authorize`,s,{redirectTo:a.redirectTo,scopes:a.scopes,queryParams:a.queryParams});return this._debug("#_handleProviderSignIn()","provider",s,"options",a,"url",r),ya()&&!a.skipBrowserRedirect&&window.location.assign(r),{data:{provider:s,url:r},error:null}}async _recoverAndRefresh(){var s,a;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const o=await Ln(this.storage,this.storageKey);if(o&&this.userStorage){let c=await Ln(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:o.user},await xi(this.userStorage,this.storageKey+"-user",c)),o.user=(s=c==null?void 0:c.user)!==null&&s!==void 0?s:rp()}else if(o&&!o.user&&!o.user){const c=await Ln(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(o.user=c.user,await rn(this.storage,this.storageKey+"-user"),await xi(this.storage,this.storageKey,o)):o.user=rp()}if(this._debug(r,"session from storage",o),!this._isValidSession(o)){this._debug(r,"session is not valid"),o!==null&&await this._removeSession();return}const l=((a=o.expires_at)!==null&&a!==void 0?a:1/0)*1e3-Date.now()<sp;if(this._debug(r,`session has${l?"":" not"} expired with margin of ${sp}s`),l){if(this.autoRefreshToken&&o.refresh_token){const{error:c}=await this._callRefreshToken(o.refresh_token);c&&(console.error(c),Eu(c)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:u}=await this._getUser(o.access_token);!u&&(c!=null&&c.user)?(o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(r,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(r,"error",o),console.error(o);return}finally{this._debug(r,"end")}}async _callRefreshToken(s){var a,r;if(!s)throw new xr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${s.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new pm;const{data:l,error:c}=await this._refreshAccessToken(s);if(c)throw c;if(!l.session)throw new xr;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const u={session:l.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(l){if(this._debug(o,"error",l),Ke(l)){const c={session:null,error:l};return Eu(l)||await this._removeSession(),(a=this.refreshingDeferred)===null||a===void 0||a.resolve(c),c}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(l),l}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(s,a,r=!0){const o=`#_notifyAllSubscribers(${s})`;this._debug(o,"begin",a,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:s,session:a});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(s,a)}catch(h){l.push(h)}});if(await Promise.all(c),l.length>0){for(let u=0;u<l.length;u+=1)console.error(l[u]);throw l[0]}}finally{this._debug(o,"end")}}async _saveSession(s){this._debug("#_saveSession()",s),this.suppressGetSessionWarning=!0;const a=Object.assign({},s),r=a.user&&a.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&a.user&&await xi(this.userStorage,this.storageKey+"-user",{user:a.user});const o=Object.assign({},a);delete o.user;const l=ew(o);await xi(this.storage,this.storageKey,l)}else{const o=ew(a);await xi(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await rn(this.storage,this.storageKey),await rn(this.storage,this.storageKey+"-code-verifier"),await rn(this.storage,this.storageKey+"-user"),this.userStorage&&await rn(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const s=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{s&&ya()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",s)}catch(a){console.error("removing visibilitychange callback failed",a)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const s=setInterval(()=>this._autoRefreshTokenTick(),gi);this.autoRefreshTicker=s,s&&typeof s=="object"&&typeof s.unref=="function"?s.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(s),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const s=this.autoRefreshTicker;this.autoRefreshTicker=null,s&&clearInterval(s)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const s=Date.now();try{return await this._useSession(async a=>{const{data:{session:r}}=a;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((r.expires_at*1e3-s)/gi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${gi}ms, refresh threshold is ${Bp} ticks`),o<=Bp&&await this._callRefreshToken(r.refresh_token)})}catch(a){console.error("Auto refresh tick failed with error. This is likely a transient error.",a)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(s){if(s.isAcquireTimeout||s instanceof d1)this._debug("auto refresh token tick lock not available");else throw s}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ya()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(s){console.error("_handleVisibilityChange",s)}}async _onVisibilityChanged(s){const a=`#_onVisibilityChanged(${s})`;this._debug(a,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),s||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(a,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(s,a,r){const o=[`provider=${encodeURIComponent(a)}`];if(r!=null&&r.redirectTo&&o.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&o.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[l,c]=await ii(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});o.push(u.toString())}if(r!=null&&r.queryParams){const l=new URLSearchParams(r.queryParams);o.push(l.toString())}return r!=null&&r.skipBrowserRedirect&&o.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${s}?${o.join("&")}`}async _unenroll(s){try{return await this._useSession(async a=>{var r;const{data:o,error:l}=a;return l?{data:null,error:l}:await at(this.fetch,"DELETE",`${this.url}/factors/${s.factorId}`,{headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(a){if(Ke(a))return{data:null,error:a};throw a}}async _enroll(s){try{return await this._useSession(async a=>{var r,o;const{data:l,error:c}=a;if(c)return{data:null,error:c};const u=Object.assign({friendly_name:s.friendlyName,factor_type:s.factorType},s.factorType==="phone"?{phone:s.phone}:{issuer:s.issuer}),{data:h,error:f}=await at(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(r=l==null?void 0:l.session)===null||r===void 0?void 0:r.access_token});return f?{data:null,error:f}:(s.factorType==="totp"&&(!((o=h==null?void 0:h.totp)===null||o===void 0)&&o.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),{data:h,error:null})})}catch(a){if(Ke(a))return{data:null,error:a};throw a}}async _verify(s){return this._acquireLock(-1,async()=>{try{return await this._useSession(async a=>{var r;const{data:o,error:l}=a;if(l)return{data:null,error:l};const{data:c,error:u}=await at(this.fetch,"POST",`${this.url}/factors/${s.factorId}/verify`,{body:{code:s.code,challenge_id:s.challengeId},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:u})})}catch(a){if(Ke(a))return{data:null,error:a};throw a}})}async _challenge(s){return this._acquireLock(-1,async()=>{try{return await this._useSession(async a=>{var r;const{data:o,error:l}=a;return l?{data:null,error:l}:await at(this.fetch,"POST",`${this.url}/factors/${s.factorId}/challenge`,{body:{channel:s.channel},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(a){if(Ke(a))return{data:null,error:a};throw a}})}async _challengeAndVerify(s){const{data:a,error:r}=await this._challenge({factorId:s.factorId});return r?{data:null,error:r}:await this._verify({factorId:s.factorId,challengeId:a.id,code:s.code})}async _listFactors(){const{data:{user:s},error:a}=await this.getUser();if(a)return{data:null,error:a};const r=(s==null?void 0:s.factors)||[],o=r.filter(c=>c.factor_type==="totp"&&c.status==="verified"),l=r.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:r,totp:o,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async s=>{var a,r;const{data:{session:o},error:l}=s;if(l)return{data:null,error:l};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=ap(o.access_token);let u=null;c.aal&&(u=c.aal);let h=u;((r=(a=o.user.factors)===null||a===void 0?void 0:a.filter(g=>g.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(h="aal2");const p=c.amr||[];return{data:{currentLevel:u,nextLevel:h,currentAuthenticationMethods:p},error:null}}))}async fetchJwk(s,a={keys:[]}){let r=a.keys.find(u=>u.kid===s);if(r)return r;const o=Date.now();if(r=this.jwks.keys.find(u=>u.kid===s),r&&this.jwks_cached_at+b6>o)return r;const{data:l,error:c}=await at(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=o,r=l.keys.find(u=>u.kid===s),!r)?null:r}async getClaims(s,a={}){try{let r=s;if(!r){const{data:b,error:_}=await this.getSession();if(_||!b.session)return{data:null,error:_};r=b.session.access_token}const{header:o,payload:l,signature:c,raw:{header:u,payload:h}}=ap(r);a!=null&&a.allowExpired||I6(l.exp);const f=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,a!=null&&a.keys?{keys:a.keys}:a==null?void 0:a.jwks);if(!f){const{error:b}=await this.getUser(r);if(b)throw b;return{data:{claims:l,header:o,signature:c},error:null}}const p=U6(o.alg),g=await crypto.subtle.importKey("jwk",f,p,!0,["verify"]);if(!await crypto.subtle.verify(p,g,c,S6(`${u}.${h}`)))throw new Uu("Invalid JWT signature");return{data:{claims:l,header:o,signature:c},error:null}}catch(r){if(Ke(r))return{data:null,error:r};throw r}}}Oi.nextInstanceID=0;const h1=Oi;class J6 extends h1{constructor(s){super(s)}}var e3=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};class f1{constructor(s,a,r){var o,l,c;if(this.supabaseUrl=s,this.supabaseKey=a,!s)throw new Error("supabaseUrl is required.");if(!a)throw new Error("supabaseKey is required.");const u=h6(s),h=new URL(u);this.realtimeUrl=new URL("realtime/v1",h),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",h),this.storageUrl=new URL("storage/v1",h),this.functionsUrl=new URL("functions/v1",h);const f=`sb-${h.hostname.split(".")[0]}-auth-token`,p={db:n6,realtime:i6,auth:Object.assign(Object.assign({},o6),{storageKey:f}),global:r6},g=f6(r??{},p);this.storageKey=(o=g.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(l=g.global.headers)!==null&&l!==void 0?l:{},g.accessToken?(this.accessToken=g.accessToken,this.auth=new Proxy({},{get:(v,b)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=g.auth)!==null&&c!==void 0?c:{},this.headers,g.global.fetch),this.fetch=u6(a,this._getAccessToken.bind(this),g.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},g.realtime)),this.rest=new E5(new URL("rest/v1",h).href,{headers:this.headers,schema:g.db.schema,fetch:this.fetch}),this.storage=new t6(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),g.accessToken||this._listenForAuthEvents()}get functions(){return new g5(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(s){return this.rest.from(s)}schema(s){return this.rest.schema(s)}rpc(s,a={},r={}){return this.rest.rpc(s,a,r)}channel(s,a={config:{}}){return this.realtime.channel(s,a)}getChannels(){return this.realtime.getChannels()}removeChannel(s){return this.realtime.removeChannel(s)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var s,a;return e3(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(a=(s=r.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:s,persistSession:a,detectSessionInUrl:r,storage:o,storageKey:l,flowType:c,lock:u,debug:h},f,p){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new J6({url:this.authUrl.href,headers:Object.assign(Object.assign({},g),f),storageKey:l,autoRefreshToken:s,persistSession:a,detectSessionInUrl:r,storage:o,flowType:c,lock:u,debug:h,fetch:p,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(s){return new X_(this.realtimeUrl.href,Object.assign(Object.assign({},s),{params:Object.assign({apikey:this.supabaseKey},s==null?void 0:s.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((a,r)=>{this._handleTokenChanged(a,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(s,a,r){(s==="TOKEN_REFRESHED"||s==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:s==="SIGNED_OUT"&&(this.realtime.setAuth(),a=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Di=(t,s,a)=>new f1(t,s,a);function t3(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const s=t.match(/^v(\d+)\./);return s?parseInt(s[1],10)<=18:!1}t3()&&console.warn("  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const s3=Object.freeze(Object.defineProperty({__proto__:null,AuthApiError:s1,AuthClient:h1,AuthError:fm,AuthImplicitGrantRedirectError:sc,AuthInvalidCredentialsError:tc,AuthInvalidJwtError:Uu,AuthInvalidTokenResponseError:ec,AuthPKCEGrantCodeExchangeError:qp,AuthRetryableFetchError:Iu,AuthSessionMissingError:xr,AuthUnknownError:$0,AuthWeakPasswordError:Fp,CustomAuthError:Ar,get FunctionRegion(){return $u},FunctionsError:mm,FunctionsFetchError:U_,FunctionsHttpError:Rp,FunctionsRelayError:Mp,GoTrueAdminApi:c1,GoTrueClient:Oi,NavigatorLockAcquireTimeoutError:u1,PostgrestError:C5,get REALTIME_LISTEN_TYPES(){return Ei},get REALTIME_POSTGRES_CHANGES_LISTEN_EVENT(){return $p},get REALTIME_PRESENCE_LISTEN_EVENTS(){return zp},get REALTIME_SUBSCRIBE_STATES(){return za},RealtimeChannel:hm,RealtimeClient:X_,RealtimePresence:Si,SIGN_OUT_SCOPES:Cu,SupabaseClient:f1,WebSocketFactory:Z_,createClient:Di,isAuthApiError:a1,isAuthError:Ke,isAuthImplicitGrantRedirectError:n1,isAuthRetryableFetchError:Eu,isAuthSessionMissingError:r1,lockInternals:Bn,navigatorLock:m1},Symbol.toStringTag,{value:"Module"})),a3={development:{name:"development",supabaseUrl:"https://wznycskqsavpmejwpksp.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind6bnljc2txc2F2cG1landwa3NwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2MzA2NjUsImV4cCI6MjA3MjIwNjY2NX0.uYXbBwQDo1pLeBrmtZnBR2M3a3_TsYDa637pcKSVC_8",supabaseServiceRoleKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind6bnljc2txc2F2cG1landwa3NwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2MzA2NjUsImV4cCI6MjA3MjIwNjY2NX0.uYXbBwQDo1pLeBrmtZnBR2M3a3_TsYDa637pcKSVC_8",databaseName:"wznycskqsavpmejwpksp",gitBranch:"desenvolvimento",debugMode:!0,logLevel:"debug"},production:{name:"production",supabaseUrl:"https://wznycskqsavpmejwpksp.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind6bnljc2txc2F2cG1landwa3NwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2MzA2NjUsImV4cCI6MjA3MjIwNjY2NX0.uYXbBwQDo1pLeBrmtZnBR2M3a3_TsYDa637pcKSVC_8",supabaseServiceRoleKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind6bnljc2txc2F2cG1landwa3NwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2MzA2NjUsImV4cCI6MjA3MjIwNjY2NX0.uYXbBwQDo1pLeBrmtZnBR2M3a3_TsYDa637pcKSVC_8",databaseName:"wznycskqsavpmejwpksp",gitBranch:"main",debugMode:!1,logLevel:"error"}};class r3{constructor(){dt(this,"currentConfig",null);dt(this,"lastValidation",null);dt(this,"initialized",!1);this.initializeEnvironmentSync()}initializeEnvironmentSync(){try{console.log(" Inicializando gerenciador de ambiente...");const s=this.detectEnvironment();console.log(` Ambiente detectado: ${s}`),this.loadEnvironmentConfigSync(s),this.initialized=!0}catch(s){console.error(" Erro ao inicializar ambiente:",s),this.loadEnvironmentConfigSync("development"),this.initialized=!0}}detectEnvironment(){return console.log(" VITE_ENVIRONMENT: development"),console.log(" Ambiente forado via VITE_ENVIRONMENT: development"),"development"}loadEnvironmentConfigSync(s){const a=a3[s];if(!a)throw new Error(`Configurao no encontrada para ambiente: ${s}`);const o=["supabaseUrl","supabaseAnonKey","supabaseServiceRoleKey"].filter(l=>!a[l]);o.length>0&&console.warn(` Campos obrigatrios ausentes para ${s}:`,o),this.currentConfig=a,console.log(` Configurao carregada para ambiente: ${s}`),console.log(` Database: ${a.databaseName}`),console.log(` URL: ${a.supabaseUrl}`)}async loadEnvironmentConfig(s){this.loadEnvironmentConfigSync(s)}getCurrentEnvironment(){if((!this.initialized||!this.currentConfig)&&this.initializeEnvironmentSync(),!this.currentConfig)throw new Error("Ambiente no inicializado corretamente.");return this.currentConfig}async switchEnvironment(s){console.log(` Alternando para ambiente: ${s}`);try{await this.loadEnvironmentConfig(s),this.currentConfig&&(await this.validateConnection(this.currentConfig)||console.warn(` Conectividade falhou para ambiente: ${s}`)),console.log(` Ambiente alternado com sucesso: ${s}`)}catch(a){throw console.error(` Erro ao alternar para ambiente ${s}:`,a),a}}async validateConnection(s){try{console.log(` Validando conectividade com ${s.name}...`);const{createClient:a}=await Sa(async()=>{const{createClient:c}=await Promise.resolve().then(()=>s3);return{createClient:c}},void 0),r=a(s.supabaseUrl,s.supabaseAnonKey),{data:o,error:l}=await r.from("usuarios_empresa").select("count").limit(1);return l?(console.error(` Erro de conectividade (${s.name}):`,l.message),!1):(this.lastValidation=new Date,console.log(` Conectividade OK (${s.name})`),!0)}catch(a){return console.error(` Erro inesperado na validao (${s.name}):`,a),!1}}async getEnvironmentInfo(){const s=this.getCurrentEnvironment(),a=await this.validateConnection(s);return{currentEnvironment:s.name,gitBranch:s.gitBranch,supabaseConnected:a,databaseName:s.databaseName,lastValidated:this.lastValidation||new Date}}}const gm=new r3;let bc=null,vc=null,ac=null;const nw=(t,s=!1)=>{const a=s?t.supabaseServiceRoleKey:t.supabaseAnonKey;return!(t.supabaseUrl&&t.supabaseUrl!=="https://your-project-dev.supabase.co"&&t.supabaseUrl!=="https://your-project-prod.supabase.co")||!(a&&a!=="your_development_anon_key_here"&&a!=="your_production_anon_key_here"&&a!=="your_development_service_role_key_here"&&a!=="your_production_service_role_key_here")?(console.warn(` Configurao do Supabase no definida para ambiente ${t.name}. Usando cliente mock.`),Di("https://mock.supabase.co","mock-key")):Di(t.supabaseUrl,a,{auth:{autoRefreshToken:!s,persistSession:!s,detectSessionInUrl:!s,storageKey:`sb-${t.databaseName}-${s?"admin":"auth"}-token`}})},xm=()=>{try{const t=gm.getCurrentEnvironment();(!ac||ac.name!==t.name||ac.supabaseUrl!==t.supabaseUrl)&&(console.log(` Inicializando clientes Supabase para ambiente: ${t.name}`),bc=nw(t,!1),vc=nw(t,!0),ac=t,console.log(` Clientes Supabase configurados para: ${t.databaseName}`))}catch(t){console.error(" Erro ao inicializar clientes Supabase:",t),bc=Di("https://mock.supabase.co","mock-key"),vc=Di("https://mock.supabase.co","mock-key")}};xm();const n3=()=>(bc||xm(),bc),o3=()=>(vc||xm(),vc),V=n3(),ut=o3(),i3=()=>{bc=null,vc=null,ac=null,xm()},ku=()=>{try{const t=gm.getCurrentEnvironment(),s=t.supabaseUrl&&t.supabaseUrl!=="https://your-project-dev.supabase.co"&&t.supabaseUrl!=="https://your-project-prod.supabase.co"&&t.supabaseUrl!=="https://mock.supabase.co",a=t.supabaseAnonKey&&t.supabaseAnonKey!=="your_development_anon_key_here"&&t.supabaseAnonKey!=="your_production_anon_key_here"&&t.supabaseAnonKey!=="mock-anon-key";return!!(s&&a)}catch{return!1}},Gt=()=>{try{const t=gm.getCurrentEnvironment(),s=t.supabaseUrl&&t.supabaseUrl!=="https://your-project-dev.supabase.co"&&t.supabaseUrl!=="https://your-project-prod.supabase.co"&&t.supabaseUrl!=="https://mock.supabase.co",a=t.supabaseAnonKey&&t.supabaseAnonKey!=="your_development_anon_key_here"&&t.supabaseAnonKey!=="your_production_anon_key_here"&&t.supabaseAnonKey!=="mock-anon-key",r=t.supabaseServiceRoleKey&&t.supabaseServiceRoleKey!=="your_development_service_role_key_here"&&t.supabaseServiceRoleKey!=="your_production_service_role_key_here"&&t.supabaseServiceRoleKey!=="mock-service-role-key";return!!(s&&a&&r)}catch{return!1}},cu={DEMO_USER:{email:"demo@clubmanager.com",name:"Usurio Demo",role:"admin"}},L0=y.createContext({});function I0(t){const s=y.useRef(null);return s.current===null&&(s.current=t()),s.current}const U0=typeof window<"u",p1=U0?y.useLayoutEffect:y.useEffect,ym=y.createContext(null);function B0(t,s){t.indexOf(s)===-1&&t.push(s)}function V0(t,s){const a=t.indexOf(s);a>-1&&t.splice(a,1)}const Er=(t,s,a)=>a>s?s:a<t?t:a;let q0=()=>{};const Cr={},g1=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function x1(t){return typeof t=="object"&&t!==null}const y1=t=>/^0[^.\s]+$/u.test(t);function F0(t){let s;return()=>(s===void 0&&(s=t()),s)}const da=t=>t,l3=(t,s)=>a=>s(t(a)),Lc=(...t)=>t.reduce(l3),wc=(t,s,a)=>{const r=s-t;return r===0?1:(a-t)/r};class H0{constructor(){this.subscriptions=[]}add(s){return B0(this.subscriptions,s),()=>V0(this.subscriptions,s)}notify(s,a,r){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](s,a,r);else for(let l=0;l<o;l++){const c=this.subscriptions[l];c&&c(s,a,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const Va=t=>t*1e3,qa=t=>t/1e3;function b1(t,s){return s?t*(1e3/s):0}const v1=(t,s,a)=>(((1-3*a+3*s)*t+(3*a-6*s))*t+3*s)*t,c3=1e-7,d3=12;function u3(t,s,a,r,o){let l,c,u=0;do c=s+(a-s)/2,l=v1(c,r,o)-t,l>0?a=c:s=c;while(Math.abs(l)>c3&&++u<d3);return c}function Ic(t,s,a,r){if(t===s&&a===r)return da;const o=l=>u3(l,0,1,t,a);return l=>l===0||l===1?l:v1(o(l),s,r)}const w1=t=>s=>s<=.5?t(2*s)/2:(2-t(2*(1-s)))/2,j1=t=>s=>1-t(1-s),_1=Ic(.33,1.53,.69,.99),G0=j1(_1),N1=w1(G0),S1=t=>(t*=2)<1?.5*G0(t):.5*(2-Math.pow(2,-10*(t-1))),Z0=t=>1-Math.sin(Math.acos(t)),E1=j1(Z0),C1=w1(Z0),m3=Ic(.42,0,1,1),h3=Ic(0,0,.58,1),k1=Ic(.42,0,.58,1),f3=t=>Array.isArray(t)&&typeof t[0]!="number",T1=t=>Array.isArray(t)&&typeof t[0]=="number",p3={linear:da,easeIn:m3,easeInOut:k1,easeOut:h3,circIn:Z0,circInOut:C1,circOut:E1,backIn:G0,backInOut:N1,backOut:_1,anticipate:S1},g3=t=>typeof t=="string",ow=t=>{if(T1(t)){q0(t.length===4);const[s,a,r,o]=t;return Ic(s,a,r,o)}else if(g3(t))return p3[t];return t},du=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function x3(t,s){let a=new Set,r=new Set,o=!1,l=!1;const c=new WeakSet;let u={delta:0,timestamp:0,isProcessing:!1};function h(p){c.has(p)&&(f.schedule(p),t()),p(u)}const f={schedule:(p,g=!1,v=!1)=>{const _=v&&o?a:r;return g&&c.add(p),_.has(p)||_.add(p),p},cancel:p=>{r.delete(p),c.delete(p)},process:p=>{if(u=p,o){l=!0;return}o=!0,[a,r]=[r,a],a.forEach(h),a.clear(),o=!1,l&&(l=!1,f.process(p))}};return f}const y3=40;function A1(t,s){let a=!1,r=!0;const o={delta:0,timestamp:0,isProcessing:!1},l=()=>a=!0,c=du.reduce((k,S)=>(k[S]=x3(l),k),{}),{setup:u,read:h,resolveKeyframes:f,preUpdate:p,update:g,preRender:v,render:b,postRender:_}=c,w=()=>{const k=Cr.useManualTiming?o.timestamp:performance.now();a=!1,Cr.useManualTiming||(o.delta=r?1e3/60:Math.max(Math.min(k-o.timestamp,y3),1)),o.timestamp=k,o.isProcessing=!0,u.process(o),h.process(o),f.process(o),p.process(o),g.process(o),v.process(o),b.process(o),_.process(o),o.isProcessing=!1,a&&s&&(r=!1,t(w))},E=()=>{a=!0,r=!0,o.isProcessing||t(w)};return{schedule:du.reduce((k,S)=>{const C=c[S];return k[S]=(M,z=!1,A=!1)=>(a||E(),C.schedule(M,z,A)),k},{}),cancel:k=>{for(let S=0;S<du.length;S++)c[du[S]].cancel(k)},state:o,steps:c}}const{schedule:Mt,cancel:mn,state:vs,steps:np}=A1(typeof requestAnimationFrame<"u"?requestAnimationFrame:da,!0);let Tu;function b3(){Tu=void 0}const $s={now:()=>(Tu===void 0&&$s.set(vs.isProcessing||Cr.useManualTiming?vs.timestamp:performance.now()),Tu),set:t=>{Tu=t,queueMicrotask(b3)}},M1=t=>s=>typeof s=="string"&&s.startsWith(t),W0=M1("--"),v3=M1("var(--"),Y0=t=>v3(t)?w3.test(t.split("/*")[0].trim()):!1,w3=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Hi={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},jc={...Hi,transform:t=>Er(0,1,t)},uu={...Hi,default:1},ic=t=>Math.round(t*1e5)/1e5,K0=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function j3(t){return t==null}const _3=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,X0=(t,s)=>a=>!!(typeof a=="string"&&_3.test(a)&&a.startsWith(t)||s&&!j3(a)&&Object.prototype.hasOwnProperty.call(a,s)),R1=(t,s,a)=>r=>{if(typeof r!="string")return r;const[o,l,c,u]=r.match(K0);return{[t]:parseFloat(o),[s]:parseFloat(l),[a]:parseFloat(c),alpha:u!==void 0?parseFloat(u):1}},N3=t=>Er(0,255,t),op={...Hi,transform:t=>Math.round(N3(t))},Qn={test:X0("rgb","red"),parse:R1("red","green","blue"),transform:({red:t,green:s,blue:a,alpha:r=1})=>"rgba("+op.transform(t)+", "+op.transform(s)+", "+op.transform(a)+", "+ic(jc.transform(r))+")"};function S3(t){let s="",a="",r="",o="";return t.length>5?(s=t.substring(1,3),a=t.substring(3,5),r=t.substring(5,7),o=t.substring(7,9)):(s=t.substring(1,2),a=t.substring(2,3),r=t.substring(3,4),o=t.substring(4,5),s+=s,a+=a,r+=r,o+=o),{red:parseInt(s,16),green:parseInt(a,16),blue:parseInt(r,16),alpha:o?parseInt(o,16)/255:1}}const Hp={test:X0("#"),parse:S3,transform:Qn.transform},Uc=t=>({test:s=>typeof s=="string"&&s.endsWith(t)&&s.split(" ").length===1,parse:parseFloat,transform:s=>`${s}${t}`}),on=Uc("deg"),Fa=Uc("%"),We=Uc("px"),E3=Uc("vh"),C3=Uc("vw"),iw={...Fa,parse:t=>Fa.parse(t)/100,transform:t=>Fa.transform(t*100)},yi={test:X0("hsl","hue"),parse:R1("hue","saturation","lightness"),transform:({hue:t,saturation:s,lightness:a,alpha:r=1})=>"hsla("+Math.round(t)+", "+Fa.transform(ic(s))+", "+Fa.transform(ic(a))+", "+ic(jc.transform(r))+")"},es={test:t=>Qn.test(t)||Hp.test(t)||yi.test(t),parse:t=>Qn.test(t)?Qn.parse(t):yi.test(t)?yi.parse(t):Hp.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Qn.transform(t):yi.transform(t),getAnimatableNone:t=>{const s=es.parse(t);return s.alpha=0,es.transform(s)}},k3=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function T3(t){var s,a;return isNaN(t)&&typeof t=="string"&&(((s=t.match(K0))==null?void 0:s.length)||0)+(((a=t.match(k3))==null?void 0:a.length)||0)>0}const O1="number",D1="color",A3="var",M3="var(",lw="${}",R3=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function _c(t){const s=t.toString(),a=[],r={color:[],number:[],var:[]},o=[];let l=0;const u=s.replace(R3,h=>(es.test(h)?(r.color.push(l),o.push(D1),a.push(es.parse(h))):h.startsWith(M3)?(r.var.push(l),o.push(A3),a.push(h)):(r.number.push(l),o.push(O1),a.push(parseFloat(h))),++l,lw)).split(lw);return{values:a,split:u,indexes:r,types:o}}function P1(t){return _c(t).values}function z1(t){const{split:s,types:a}=_c(t),r=s.length;return o=>{let l="";for(let c=0;c<r;c++)if(l+=s[c],o[c]!==void 0){const u=a[c];u===O1?l+=ic(o[c]):u===D1?l+=es.transform(o[c]):l+=o[c]}return l}}const O3=t=>typeof t=="number"?0:es.test(t)?es.getAnimatableNone(t):t;function D3(t){const s=P1(t);return z1(t)(s.map(O3))}const hn={test:T3,parse:P1,createTransformer:z1,getAnimatableNone:D3};function ip(t,s,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?t+(s-t)*6*a:a<1/2?s:a<2/3?t+(s-t)*(2/3-a)*6:t}function P3({hue:t,saturation:s,lightness:a,alpha:r}){t/=360,s/=100,a/=100;let o=0,l=0,c=0;if(!s)o=l=c=a;else{const u=a<.5?a*(1+s):a+s-a*s,h=2*a-u;o=ip(h,u,t+1/3),l=ip(h,u,t),c=ip(h,u,t-1/3)}return{red:Math.round(o*255),green:Math.round(l*255),blue:Math.round(c*255),alpha:r}}function Vu(t,s){return a=>a>0?s:t}const zt=(t,s,a)=>t+(s-t)*a,lp=(t,s,a)=>{const r=t*t,o=a*(s*s-r)+r;return o<0?0:Math.sqrt(o)},z3=[Hp,Qn,yi],$3=t=>z3.find(s=>s.test(t));function cw(t){const s=$3(t);if(!s)return!1;let a=s.parse(t);return s===yi&&(a=P3(a)),a}const dw=(t,s)=>{const a=cw(t),r=cw(s);if(!a||!r)return Vu(t,s);const o={...a};return l=>(o.red=lp(a.red,r.red,l),o.green=lp(a.green,r.green,l),o.blue=lp(a.blue,r.blue,l),o.alpha=zt(a.alpha,r.alpha,l),Qn.transform(o))},Gp=new Set(["none","hidden"]);function L3(t,s){return Gp.has(t)?a=>a<=0?t:s:a=>a>=1?s:t}function I3(t,s){return a=>zt(t,s,a)}function Q0(t){return typeof t=="number"?I3:typeof t=="string"?Y0(t)?Vu:es.test(t)?dw:V3:Array.isArray(t)?$1:typeof t=="object"?es.test(t)?dw:U3:Vu}function $1(t,s){const a=[...t],r=a.length,o=t.map((l,c)=>Q0(l)(l,s[c]));return l=>{for(let c=0;c<r;c++)a[c]=o[c](l);return a}}function U3(t,s){const a={...t,...s},r={};for(const o in a)t[o]!==void 0&&s[o]!==void 0&&(r[o]=Q0(t[o])(t[o],s[o]));return o=>{for(const l in r)a[l]=r[l](o);return a}}function B3(t,s){const a=[],r={color:0,var:0,number:0};for(let o=0;o<s.values.length;o++){const l=s.types[o],c=t.indexes[l][r[l]],u=t.values[c]??0;a[o]=u,r[l]++}return a}const V3=(t,s)=>{const a=hn.createTransformer(s),r=_c(t),o=_c(s);return r.indexes.var.length===o.indexes.var.length&&r.indexes.color.length===o.indexes.color.length&&r.indexes.number.length>=o.indexes.number.length?Gp.has(t)&&!o.values.length||Gp.has(s)&&!r.values.length?L3(t,s):Lc($1(B3(r,o),o.values),a):Vu(t,s)};function L1(t,s,a){return typeof t=="number"&&typeof s=="number"&&typeof a=="number"?zt(t,s,a):Q0(t)(t,s)}const q3=t=>{const s=({timestamp:a})=>t(a);return{start:(a=!0)=>Mt.update(s,a),stop:()=>mn(s),now:()=>vs.isProcessing?vs.timestamp:$s.now()}},I1=(t,s,a=10)=>{let r="";const o=Math.max(Math.round(s/a),2);for(let l=0;l<o;l++)r+=Math.round(t(l/(o-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},qu=2e4;function J0(t){let s=0;const a=50;let r=t.next(s);for(;!r.done&&s<qu;)s+=a,r=t.next(s);return s>=qu?1/0:s}function F3(t,s=100,a){const r=a({...t,keyframes:[0,s]}),o=Math.min(J0(r),qu);return{type:"keyframes",ease:l=>r.next(o*l).value/s,duration:qa(o)}}const H3=5;function U1(t,s,a){const r=Math.max(s-H3,0);return b1(a-t(r),s-r)}const Bt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},cp=.001;function G3({duration:t=Bt.duration,bounce:s=Bt.bounce,velocity:a=Bt.velocity,mass:r=Bt.mass}){let o,l,c=1-s;c=Er(Bt.minDamping,Bt.maxDamping,c),t=Er(Bt.minDuration,Bt.maxDuration,qa(t)),c<1?(o=f=>{const p=f*c,g=p*t,v=p-a,b=Zp(f,c),_=Math.exp(-g);return cp-v/b*_},l=f=>{const g=f*c*t,v=g*a+a,b=Math.pow(c,2)*Math.pow(f,2)*t,_=Math.exp(-g),w=Zp(Math.pow(f,2),c);return(-o(f)+cp>0?-1:1)*((v-b)*_)/w}):(o=f=>{const p=Math.exp(-f*t),g=(f-a)*t+1;return-cp+p*g},l=f=>{const p=Math.exp(-f*t),g=(a-f)*(t*t);return p*g});const u=5/t,h=W3(o,l,u);if(t=Va(t),isNaN(h))return{stiffness:Bt.stiffness,damping:Bt.damping,duration:t};{const f=Math.pow(h,2)*r;return{stiffness:f,damping:c*2*Math.sqrt(r*f),duration:t}}}const Z3=12;function W3(t,s,a){let r=a;for(let o=1;o<Z3;o++)r=r-t(r)/s(r);return r}function Zp(t,s){return t*Math.sqrt(1-s*s)}const Y3=["duration","bounce"],K3=["stiffness","damping","mass"];function uw(t,s){return s.some(a=>t[a]!==void 0)}function X3(t){let s={velocity:Bt.velocity,stiffness:Bt.stiffness,damping:Bt.damping,mass:Bt.mass,isResolvedFromDuration:!1,...t};if(!uw(t,K3)&&uw(t,Y3))if(t.visualDuration){const a=t.visualDuration,r=2*Math.PI/(a*1.2),o=r*r,l=2*Er(.05,1,1-(t.bounce||0))*Math.sqrt(o);s={...s,mass:Bt.mass,stiffness:o,damping:l}}else{const a=G3(t);s={...s,...a,mass:Bt.mass},s.isResolvedFromDuration=!0}return s}function Fu(t=Bt.visualDuration,s=Bt.bounce){const a=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:s}:t;let{restSpeed:r,restDelta:o}=a;const l=a.keyframes[0],c=a.keyframes[a.keyframes.length-1],u={done:!1,value:l},{stiffness:h,damping:f,mass:p,duration:g,velocity:v,isResolvedFromDuration:b}=X3({...a,velocity:-qa(a.velocity||0)}),_=v||0,w=f/(2*Math.sqrt(h*p)),E=c-l,T=qa(Math.sqrt(h/p)),N=Math.abs(E)<5;r||(r=N?Bt.restSpeed.granular:Bt.restSpeed.default),o||(o=N?Bt.restDelta.granular:Bt.restDelta.default);let k;if(w<1){const C=Zp(T,w);k=M=>{const z=Math.exp(-w*T*M);return c-z*((_+w*T*E)/C*Math.sin(C*M)+E*Math.cos(C*M))}}else if(w===1)k=C=>c-Math.exp(-T*C)*(E+(_+T*E)*C);else{const C=T*Math.sqrt(w*w-1);k=M=>{const z=Math.exp(-w*T*M),A=Math.min(C*M,300);return c-z*((_+w*T*E)*Math.sinh(A)+C*E*Math.cosh(A))/C}}const S={calculatedDuration:b&&g||null,next:C=>{const M=k(C);if(b)u.done=C>=g;else{let z=C===0?_:0;w<1&&(z=C===0?Va(_):U1(k,C,M));const A=Math.abs(z)<=r,$=Math.abs(c-M)<=o;u.done=A&&$}return u.value=u.done?c:M,u},toString:()=>{const C=Math.min(J0(S),qu),M=I1(z=>S.next(C*z).value,C,30);return C+"ms "+M},toTransition:()=>{}};return S}Fu.applyToOptions=t=>{const s=F3(t,100,Fu);return t.ease=s.ease,t.duration=Va(s.duration),t.type="keyframes",t};function Wp({keyframes:t,velocity:s=0,power:a=.8,timeConstant:r=325,bounceDamping:o=10,bounceStiffness:l=500,modifyTarget:c,min:u,max:h,restDelta:f=.5,restSpeed:p}){const g=t[0],v={done:!1,value:g},b=A=>u!==void 0&&A<u||h!==void 0&&A>h,_=A=>u===void 0?h:h===void 0||Math.abs(u-A)<Math.abs(h-A)?u:h;let w=a*s;const E=g+w,T=c===void 0?E:c(E);T!==E&&(w=T-g);const N=A=>-w*Math.exp(-A/r),k=A=>T+N(A),S=A=>{const $=N(A),P=k(A);v.done=Math.abs($)<=f,v.value=v.done?T:P};let C,M;const z=A=>{b(v.value)&&(C=A,M=Fu({keyframes:[v.value,_(v.value)],velocity:U1(k,A,v.value),damping:o,stiffness:l,restDelta:f,restSpeed:p}))};return z(0),{calculatedDuration:null,next:A=>{let $=!1;return!M&&C===void 0&&($=!0,S(A),z(A)),C!==void 0&&A>=C?M.next(A-C):(!$&&S(A),v)}}}function Q3(t,s,a){const r=[],o=a||Cr.mix||L1,l=t.length-1;for(let c=0;c<l;c++){let u=o(t[c],t[c+1]);if(s){const h=Array.isArray(s)?s[c]||da:s;u=Lc(h,u)}r.push(u)}return r}function J3(t,s,{clamp:a=!0,ease:r,mixer:o}={}){const l=t.length;if(q0(l===s.length),l===1)return()=>s[0];if(l===2&&s[0]===s[1])return()=>s[1];const c=t[0]===t[1];t[0]>t[l-1]&&(t=[...t].reverse(),s=[...s].reverse());const u=Q3(s,r,o),h=u.length,f=p=>{if(c&&p<t[0])return s[0];let g=0;if(h>1)for(;g<t.length-2&&!(p<t[g+1]);g++);const v=wc(t[g],t[g+1],p);return u[g](v)};return a?p=>f(Er(t[0],t[l-1],p)):f}function ek(t,s){const a=t[t.length-1];for(let r=1;r<=s;r++){const o=wc(0,s,r);t.push(zt(a,1,o))}}function tk(t){const s=[0];return ek(s,t.length-1),s}function sk(t,s){return t.map(a=>a*s)}function ak(t,s){return t.map(()=>s||k1).splice(0,t.length-1)}function lc({duration:t=300,keyframes:s,times:a,ease:r="easeInOut"}){const o=f3(r)?r.map(ow):ow(r),l={done:!1,value:s[0]},c=sk(a&&a.length===s.length?a:tk(s),t),u=J3(c,s,{ease:Array.isArray(o)?o:ak(s,o)});return{calculatedDuration:t,next:h=>(l.value=u(h),l.done=h>=t,l)}}const rk=t=>t!==null;function eg(t,{repeat:s,repeatType:a="loop"},r,o=1){const l=t.filter(rk),u=o<0||s&&a!=="loop"&&s%2===1?0:l.length-1;return!u||r===void 0?l[u]:r}const nk={decay:Wp,inertia:Wp,tween:lc,keyframes:lc,spring:Fu};function B1(t){typeof t.type=="string"&&(t.type=nk[t.type])}class tg{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(s=>{this.resolve=s})}notifyFinished(){this.resolve()}then(s,a){return this.finished.then(s,a)}}const ok=t=>t/100;class sg extends tg{constructor(s){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var r,o;const{motionValue:a}=this.options;a&&a.updatedAt!==$s.now()&&this.tick($s.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(o=(r=this.options).onStop)==null||o.call(r))},this.options=s,this.initAnimation(),this.play(),s.autoplay===!1&&this.pause()}initAnimation(){const{options:s}=this;B1(s);const{type:a=lc,repeat:r=0,repeatDelay:o=0,repeatType:l,velocity:c=0}=s;let{keyframes:u}=s;const h=a||lc;h!==lc&&typeof u[0]!="number"&&(this.mixKeyframes=Lc(ok,L1(u[0],u[1])),u=[0,100]);const f=h({...s,keyframes:u});l==="mirror"&&(this.mirroredGenerator=h({...s,keyframes:[...u].reverse(),velocity:-c})),f.calculatedDuration===null&&(f.calculatedDuration=J0(f));const{calculatedDuration:p}=f;this.calculatedDuration=p,this.resolvedDuration=p+o,this.totalDuration=this.resolvedDuration*(r+1)-o,this.generator=f}updateTime(s){const a=Math.round(s-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=a}tick(s,a=!1){const{generator:r,totalDuration:o,mixKeyframes:l,mirroredGenerator:c,resolvedDuration:u,calculatedDuration:h}=this;if(this.startTime===null)return r.next(0);const{delay:f=0,keyframes:p,repeat:g,repeatType:v,repeatDelay:b,type:_,onUpdate:w,finalKeyframe:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,s):this.speed<0&&(this.startTime=Math.min(s-o/this.speed,this.startTime)),a?this.currentTime=s:this.updateTime(s);const T=this.currentTime-f*(this.playbackSpeed>=0?1:-1),N=this.playbackSpeed>=0?T<0:T>o;this.currentTime=Math.max(T,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=o);let k=this.currentTime,S=r;if(g){const A=Math.min(this.currentTime,o)/u;let $=Math.floor(A),P=A%1;!P&&A>=1&&(P=1),P===1&&$--,$=Math.min($,g+1),!!($%2)&&(v==="reverse"?(P=1-P,b&&(P-=b/u)):v==="mirror"&&(S=c)),k=Er(0,1,P)*u}const C=N?{done:!1,value:p[0]}:S.next(k);l&&(C.value=l(C.value));let{done:M}=C;!N&&h!==null&&(M=this.playbackSpeed>=0?this.currentTime>=o:this.currentTime<=0);const z=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&M);return z&&_!==Wp&&(C.value=eg(p,this.options,E,this.speed)),w&&w(C.value),z&&this.finish(),C}then(s,a){return this.finished.then(s,a)}get duration(){return qa(this.calculatedDuration)}get time(){return qa(this.currentTime)}set time(s){var a;s=Va(s),this.currentTime=s,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=s:this.driver&&(this.startTime=this.driver.now()-s/this.playbackSpeed),(a=this.driver)==null||a.start(!1)}get speed(){return this.playbackSpeed}set speed(s){this.updateTime($s.now());const a=this.playbackSpeed!==s;this.playbackSpeed=s,a&&(this.time=qa(this.currentTime))}play(){var o,l;if(this.isStopped)return;const{driver:s=q3,startTime:a}=this.options;this.driver||(this.driver=s(c=>this.tick(c))),(l=(o=this.options).onPlay)==null||l.call(o);const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=a??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime($s.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var s,a;this.notifyFinished(),this.teardown(),this.state="finished",(a=(s=this.options).onComplete)==null||a.call(s)}cancel(){var s,a;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(a=(s=this.options).onCancel)==null||a.call(s)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(s){return this.startTime=0,this.tick(s,!0)}attachTimeline(s){var a;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(a=this.driver)==null||a.stop(),s.observe(this)}}function ik(t){for(let s=1;s<t.length;s++)t[s]??(t[s]=t[s-1])}const Jn=t=>t*180/Math.PI,Yp=t=>{const s=Jn(Math.atan2(t[1],t[0]));return Kp(s)},lk={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Yp,rotateZ:Yp,skewX:t=>Jn(Math.atan(t[1])),skewY:t=>Jn(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Kp=t=>(t=t%360,t<0&&(t+=360),t),mw=Yp,hw=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),fw=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),ck={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:hw,scaleY:fw,scale:t=>(hw(t)+fw(t))/2,rotateX:t=>Kp(Jn(Math.atan2(t[6],t[5]))),rotateY:t=>Kp(Jn(Math.atan2(-t[2],t[0]))),rotateZ:mw,rotate:mw,skewX:t=>Jn(Math.atan(t[4])),skewY:t=>Jn(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Xp(t){return t.includes("scale")?1:0}function Qp(t,s){if(!t||t==="none")return Xp(s);const a=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,o;if(a)r=ck,o=a;else{const u=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=lk,o=u}if(!o)return Xp(s);const l=r[s],c=o[1].split(",").map(uk);return typeof l=="function"?l(c):c[l]}const dk=(t,s)=>{const{transform:a="none"}=getComputedStyle(t);return Qp(a,s)};function uk(t){return parseFloat(t.trim())}const Gi=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Zi=new Set(Gi),pw=t=>t===Hi||t===We,mk=new Set(["x","y","z"]),hk=Gi.filter(t=>!mk.has(t));function fk(t){const s=[];return hk.forEach(a=>{const r=t.getValue(a);r!==void 0&&(s.push([a,r.get()]),r.set(a.startsWith("scale")?1:0))}),s}const so={width:({x:t},{paddingLeft:s="0",paddingRight:a="0"})=>t.max-t.min-parseFloat(s)-parseFloat(a),height:({y:t},{paddingTop:s="0",paddingBottom:a="0"})=>t.max-t.min-parseFloat(s)-parseFloat(a),top:(t,{top:s})=>parseFloat(s),left:(t,{left:s})=>parseFloat(s),bottom:({y:t},{top:s})=>parseFloat(s)+(t.max-t.min),right:({x:t},{left:s})=>parseFloat(s)+(t.max-t.min),x:(t,{transform:s})=>Qp(s,"x"),y:(t,{transform:s})=>Qp(s,"y")};so.translateX=so.x;so.translateY=so.y;const ao=new Set;let Jp=!1,e0=!1,t0=!1;function V1(){if(e0){const t=Array.from(ao).filter(r=>r.needsMeasurement),s=new Set(t.map(r=>r.element)),a=new Map;s.forEach(r=>{const o=fk(r);o.length&&(a.set(r,o),r.render())}),t.forEach(r=>r.measureInitialState()),s.forEach(r=>{r.render();const o=a.get(r);o&&o.forEach(([l,c])=>{var u;(u=r.getValue(l))==null||u.set(c)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}e0=!1,Jp=!1,ao.forEach(t=>t.complete(t0)),ao.clear()}function q1(){ao.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(e0=!0)})}function pk(){t0=!0,q1(),V1(),t0=!1}class ag{constructor(s,a,r,o,l,c=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...s],this.onComplete=a,this.name=r,this.motionValue=o,this.element=l,this.isAsync=c}scheduleResolve(){this.state="scheduled",this.isAsync?(ao.add(this),Jp||(Jp=!0,Mt.read(q1),Mt.resolveKeyframes(V1))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:s,name:a,element:r,motionValue:o}=this;if(s[0]===null){const l=o==null?void 0:o.get(),c=s[s.length-1];if(l!==void 0)s[0]=l;else if(r&&a){const u=r.readValue(a,c);u!=null&&(s[0]=u)}s[0]===void 0&&(s[0]=c),o&&l===void 0&&o.set(s[0])}ik(s)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(s=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,s),ao.delete(this)}cancel(){this.state==="scheduled"&&(ao.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const gk=t=>t.startsWith("--");function xk(t,s,a){gk(s)?t.style.setProperty(s,a):t.style[s]=a}const yk=F0(()=>window.ScrollTimeline!==void 0),bk={};function vk(t,s){const a=F0(t);return()=>bk[s]??a()}const F1=vk(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),rc=([t,s,a,r])=>`cubic-bezier(${t}, ${s}, ${a}, ${r})`,gw={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:rc([0,.65,.55,1]),circOut:rc([.55,0,1,.45]),backIn:rc([.31,.01,.66,-.59]),backOut:rc([.33,1.53,.69,.99])};function H1(t,s){if(t)return typeof t=="function"?F1()?I1(t,s):"ease-out":T1(t)?rc(t):Array.isArray(t)?t.map(a=>H1(a,s)||gw.easeOut):gw[t]}function wk(t,s,a,{delay:r=0,duration:o=300,repeat:l=0,repeatType:c="loop",ease:u="easeOut",times:h}={},f=void 0){const p={[s]:a};h&&(p.offset=h);const g=H1(u,o);Array.isArray(g)&&(p.easing=g);const v={delay:r,duration:o,easing:Array.isArray(g)?"linear":g,fill:"both",iterations:l+1,direction:c==="reverse"?"alternate":"normal"};return f&&(v.pseudoElement=f),t.animate(p,v)}function G1(t){return typeof t=="function"&&"applyToOptions"in t}function jk({type:t,...s}){return G1(t)&&F1()?t.applyToOptions(s):(s.duration??(s.duration=300),s.ease??(s.ease="easeOut"),s)}class _k extends tg{constructor(s){if(super(),this.finishedTime=null,this.isStopped=!1,!s)return;const{element:a,name:r,keyframes:o,pseudoElement:l,allowFlatten:c=!1,finalKeyframe:u,onComplete:h}=s;this.isPseudoElement=!!l,this.allowFlatten=c,this.options=s,q0(typeof s.type!="string");const f=jk(s);this.animation=wk(a,r,o,f,l),f.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!l){const p=eg(o,this.options,u,this.speed);this.updateMotionValue?this.updateMotionValue(p):xk(a,r,p),this.animation.cancel()}h==null||h(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var s,a;(a=(s=this.animation).finish)==null||a.call(s)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:s}=this;s==="idle"||s==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var s,a;this.isPseudoElement||(a=(s=this.animation).commitStyles)==null||a.call(s)}get duration(){var a,r;const s=((r=(a=this.animation.effect)==null?void 0:a.getComputedTiming)==null?void 0:r.call(a).duration)||0;return qa(Number(s))}get time(){return qa(Number(this.animation.currentTime)||0)}set time(s){this.finishedTime=null,this.animation.currentTime=Va(s)}get speed(){return this.animation.playbackRate}set speed(s){s<0&&(this.finishedTime=null),this.animation.playbackRate=s}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(s){this.animation.startTime=s}attachTimeline({timeline:s,observe:a}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,s&&yk()?(this.animation.timeline=s,da):a(this)}}const Z1={anticipate:S1,backInOut:N1,circInOut:C1};function Nk(t){return t in Z1}function Sk(t){typeof t.ease=="string"&&Nk(t.ease)&&(t.ease=Z1[t.ease])}const xw=10;class Ek extends _k{constructor(s){Sk(s),B1(s),super(s),s.startTime&&(this.startTime=s.startTime),this.options=s}updateMotionValue(s){const{motionValue:a,onUpdate:r,onComplete:o,element:l,...c}=this.options;if(!a)return;if(s!==void 0){a.set(s);return}const u=new sg({...c,autoplay:!1}),h=Va(this.finishedTime??this.time);a.setWithVelocity(u.sample(h-xw).value,u.sample(h).value,xw),u.stop()}}const yw=(t,s)=>s==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(hn.test(t)||t==="0")&&!t.startsWith("url("));function Ck(t){const s=t[0];if(t.length===1)return!0;for(let a=0;a<t.length;a++)if(t[a]!==s)return!0}function kk(t,s,a,r){const o=t[0];if(o===null)return!1;if(s==="display"||s==="visibility")return!0;const l=t[t.length-1],c=yw(o,s),u=yw(l,s);return!c||!u?!1:Ck(t)||(a==="spring"||G1(a))&&r}function s0(t){t.duration=0,t.type}const Tk=new Set(["opacity","clipPath","filter","transform"]),Ak=F0(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function Mk(t){var p;const{motionValue:s,name:a,repeatDelay:r,repeatType:o,damping:l,type:c}=t;if(!(((p=s==null?void 0:s.owner)==null?void 0:p.current)instanceof HTMLElement))return!1;const{onUpdate:h,transformTemplate:f}=s.owner.getProps();return Ak()&&a&&Tk.has(a)&&(a!=="transform"||!f)&&!h&&!r&&o!=="mirror"&&l!==0&&c!=="inertia"}const Rk=40;class Ok extends tg{constructor({autoplay:s=!0,delay:a=0,type:r="keyframes",repeat:o=0,repeatDelay:l=0,repeatType:c="loop",keyframes:u,name:h,motionValue:f,element:p,...g}){var _;super(),this.stop=()=>{var w,E;this._animation&&(this._animation.stop(),(w=this.stopTimeline)==null||w.call(this)),(E=this.keyframeResolver)==null||E.cancel()},this.createdAt=$s.now();const v={autoplay:s,delay:a,type:r,repeat:o,repeatDelay:l,repeatType:c,name:h,motionValue:f,element:p,...g},b=(p==null?void 0:p.KeyframeResolver)||ag;this.keyframeResolver=new b(u,(w,E,T)=>this.onKeyframesResolved(w,E,v,!T),h,f,p),(_=this.keyframeResolver)==null||_.scheduleResolve()}onKeyframesResolved(s,a,r,o){this.keyframeResolver=void 0;const{name:l,type:c,velocity:u,delay:h,isHandoff:f,onUpdate:p}=r;this.resolvedAt=$s.now(),kk(s,l,c,u)||((Cr.instantAnimations||!h)&&(p==null||p(eg(s,r,a))),s[0]=s[s.length-1],s0(r),r.repeat=0);const v={startTime:o?this.resolvedAt?this.resolvedAt-this.createdAt>Rk?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:a,...r,keyframes:s},b=!f&&Mk(v)?new Ek({...v,element:v.motionValue.owner.current}):new sg(v);b.finished.then(()=>this.notifyFinished()).catch(da),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(s,a){return this.finished.finally(s).then(()=>{})}get animation(){var s;return this._animation||((s=this.keyframeResolver)==null||s.resume(),pk()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(s){this.animation.time=s}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(s){this.animation.speed=s}get startTime(){return this.animation.startTime}attachTimeline(s){return this._animation?this.stopTimeline=this.animation.attachTimeline(s):this.pendingTimeline=s,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var s;this._animation&&this.animation.cancel(),(s=this.keyframeResolver)==null||s.cancel()}}const Dk=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function Pk(t){const s=Dk.exec(t);if(!s)return[,];const[,a,r,o]=s;return[`--${a??r}`,o]}function W1(t,s,a=1){const[r,o]=Pk(t);if(!r)return;const l=window.getComputedStyle(s).getPropertyValue(r);if(l){const c=l.trim();return g1(c)?parseFloat(c):c}return Y0(o)?W1(o,s,a+1):o}function rg(t,s){return(t==null?void 0:t[s])??(t==null?void 0:t.default)??t}const Y1=new Set(["width","height","top","left","right","bottom",...Gi]),zk={test:t=>t==="auto",parse:t=>t},K1=t=>s=>s.test(t),X1=[Hi,We,Fa,on,C3,E3,zk],bw=t=>X1.find(K1(t));function $k(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||y1(t):!0}const Lk=new Set(["brightness","contrast","saturate","opacity"]);function Ik(t){const[s,a]=t.slice(0,-1).split("(");if(s==="drop-shadow")return t;const[r]=a.match(K0)||[];if(!r)return t;const o=a.replace(r,"");let l=Lk.has(s)?1:0;return r!==a&&(l*=100),s+"("+l+o+")"}const Uk=/\b([a-z-]*)\(.*?\)/gu,a0={...hn,getAnimatableNone:t=>{const s=t.match(Uk);return s?s.map(Ik).join(" "):t}},vw={...Hi,transform:Math.round},Bk={rotate:on,rotateX:on,rotateY:on,rotateZ:on,scale:uu,scaleX:uu,scaleY:uu,scaleZ:uu,skew:on,skewX:on,skewY:on,distance:We,translateX:We,translateY:We,translateZ:We,x:We,y:We,z:We,perspective:We,transformPerspective:We,opacity:jc,originX:iw,originY:iw,originZ:We},ng={borderWidth:We,borderTopWidth:We,borderRightWidth:We,borderBottomWidth:We,borderLeftWidth:We,borderRadius:We,radius:We,borderTopLeftRadius:We,borderTopRightRadius:We,borderBottomRightRadius:We,borderBottomLeftRadius:We,width:We,maxWidth:We,height:We,maxHeight:We,top:We,right:We,bottom:We,left:We,padding:We,paddingTop:We,paddingRight:We,paddingBottom:We,paddingLeft:We,margin:We,marginTop:We,marginRight:We,marginBottom:We,marginLeft:We,backgroundPositionX:We,backgroundPositionY:We,...Bk,zIndex:vw,fillOpacity:jc,strokeOpacity:jc,numOctaves:vw},Vk={...ng,color:es,backgroundColor:es,outlineColor:es,fill:es,stroke:es,borderColor:es,borderTopColor:es,borderRightColor:es,borderBottomColor:es,borderLeftColor:es,filter:a0,WebkitFilter:a0},Q1=t=>Vk[t];function J1(t,s){let a=Q1(t);return a!==a0&&(a=hn),a.getAnimatableNone?a.getAnimatableNone(s):void 0}const qk=new Set(["auto","none","0"]);function Fk(t,s,a){let r=0,o;for(;r<t.length&&!o;){const l=t[r];typeof l=="string"&&!qk.has(l)&&_c(l).values.length&&(o=t[r]),r++}if(o&&a)for(const l of s)t[l]=J1(a,o)}class Hk extends ag{constructor(s,a,r,o,l){super(s,a,r,o,l,!0)}readKeyframes(){const{unresolvedKeyframes:s,element:a,name:r}=this;if(!a||!a.current)return;super.readKeyframes();for(let h=0;h<s.length;h++){let f=s[h];if(typeof f=="string"&&(f=f.trim(),Y0(f))){const p=W1(f,a.current);p!==void 0&&(s[h]=p),h===s.length-1&&(this.finalKeyframe=f)}}if(this.resolveNoneKeyframes(),!Y1.has(r)||s.length!==2)return;const[o,l]=s,c=bw(o),u=bw(l);if(c!==u)if(pw(c)&&pw(u))for(let h=0;h<s.length;h++){const f=s[h];typeof f=="string"&&(s[h]=parseFloat(f))}else so[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:s,name:a}=this,r=[];for(let o=0;o<s.length;o++)(s[o]===null||$k(s[o]))&&r.push(o);r.length&&Fk(s,r,a)}measureInitialState(){const{element:s,unresolvedKeyframes:a,name:r}=this;if(!s||!s.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=so[r](s.measureViewportBox(),window.getComputedStyle(s.current)),a[0]=this.measuredOrigin;const o=a[a.length-1];o!==void 0&&s.getValue(r,o).jump(o,!1)}measureEndState(){var u;const{element:s,name:a,unresolvedKeyframes:r}=this;if(!s||!s.current)return;const o=s.getValue(a);o&&o.jump(this.measuredOrigin,!1);const l=r.length-1,c=r[l];r[l]=so[a](s.measureViewportBox(),window.getComputedStyle(s.current)),c!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=c),(u=this.removedTransforms)!=null&&u.length&&this.removedTransforms.forEach(([h,f])=>{s.getValue(h).set(f)}),this.resolveNoneKeyframes()}}function Gk(t,s,a){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;const o=(a==null?void 0:a[t])??r.querySelectorAll(t);return o?Array.from(o):[]}return Array.from(t)}const eN=(t,s)=>s&&typeof t=="number"?s.transform(t):t;function tN(t){return x1(t)&&"offsetHeight"in t}const ww=30,Zk=t=>!isNaN(parseFloat(t));class Wk{constructor(s,a={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{var l;const o=$s.now();if(this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((l=this.events.change)==null||l.notify(this.current),this.dependents))for(const c of this.dependents)c.dirty()},this.hasAnimated=!1,this.setCurrent(s),this.owner=a.owner}setCurrent(s){this.current=s,this.updatedAt=$s.now(),this.canTrackVelocity===null&&s!==void 0&&(this.canTrackVelocity=Zk(this.current))}setPrevFrameValue(s=this.current){this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt}onChange(s){return this.on("change",s)}on(s,a){this.events[s]||(this.events[s]=new H0);const r=this.events[s].add(a);return s==="change"?()=>{r(),Mt.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const s in this.events)this.events[s].clear()}attach(s,a){this.passiveEffect=s,this.stopPassiveEffect=a}set(s){this.passiveEffect?this.passiveEffect(s,this.updateAndNotify):this.updateAndNotify(s)}setWithVelocity(s,a,r){this.set(a),this.prev=void 0,this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt-r}jump(s,a=!0){this.updateAndNotify(s),this.prev=s,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var s;(s=this.events.change)==null||s.notify(this.current)}addDependent(s){this.dependents||(this.dependents=new Set),this.dependents.add(s)}removeDependent(s){this.dependents&&this.dependents.delete(s)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const s=$s.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||s-this.updatedAt>ww)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,ww);return b1(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(s){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=s(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var s,a;(s=this.dependents)==null||s.clear(),(a=this.events.destroy)==null||a.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Pi(t,s){return new Wk(t,s)}const{schedule:og}=A1(queueMicrotask,!1),ba={x:!1,y:!1};function sN(){return ba.x||ba.y}function Yk(t){return t==="x"||t==="y"?ba[t]?null:(ba[t]=!0,()=>{ba[t]=!1}):ba.x||ba.y?null:(ba.x=ba.y=!0,()=>{ba.x=ba.y=!1})}function aN(t,s){const a=Gk(t),r=new AbortController,o={passive:!0,...s,signal:r.signal};return[a,o,()=>r.abort()]}function jw(t){return!(t.pointerType==="touch"||sN())}function Kk(t,s,a={}){const[r,o,l]=aN(t,a),c=u=>{if(!jw(u))return;const{target:h}=u,f=s(h,u);if(typeof f!="function"||!h)return;const p=g=>{jw(g)&&(f(g),h.removeEventListener("pointerleave",p))};h.addEventListener("pointerleave",p,o)};return r.forEach(u=>{u.addEventListener("pointerenter",c,o)}),l}const rN=(t,s)=>s?t===s?!0:rN(t,s.parentElement):!1,ig=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,Xk=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function Qk(t){return Xk.has(t.tagName)||t.tabIndex!==-1}const Au=new WeakSet;function _w(t){return s=>{s.key==="Enter"&&t(s)}}function dp(t,s){t.dispatchEvent(new PointerEvent("pointer"+s,{isPrimary:!0,bubbles:!0}))}const Jk=(t,s)=>{const a=t.currentTarget;if(!a)return;const r=_w(()=>{if(Au.has(a))return;dp(a,"down");const o=_w(()=>{dp(a,"up")}),l=()=>dp(a,"cancel");a.addEventListener("keyup",o,s),a.addEventListener("blur",l,s)});a.addEventListener("keydown",r,s),a.addEventListener("blur",()=>a.removeEventListener("keydown",r),s)};function Nw(t){return ig(t)&&!sN()}function eT(t,s,a={}){const[r,o,l]=aN(t,a),c=u=>{const h=u.currentTarget;if(!Nw(u))return;Au.add(h);const f=s(h,u),p=(b,_)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",v),Au.has(h)&&Au.delete(h),Nw(b)&&typeof f=="function"&&f(b,{success:_})},g=b=>{p(b,h===window||h===document||a.useGlobalTarget||rN(h,b.target))},v=b=>{p(b,!1)};window.addEventListener("pointerup",g,o),window.addEventListener("pointercancel",v,o)};return r.forEach(u=>{(a.useGlobalTarget?window:u).addEventListener("pointerdown",c,o),tN(u)&&(u.addEventListener("focus",f=>Jk(f,o)),!Qk(u)&&!u.hasAttribute("tabindex")&&(u.tabIndex=0))}),l}function nN(t){return x1(t)&&"ownerSVGElement"in t}function tT(t){return nN(t)&&t.tagName==="svg"}const Ns=t=>!!(t&&t.getVelocity),sT=[...X1,es,hn],aT=t=>sT.find(K1(t)),lg=y.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class rT extends y.Component{getSnapshotBeforeUpdate(s){const a=this.props.childRef.current;if(a&&s.isPresent&&!this.props.isPresent){const r=a.offsetParent,o=tN(r)&&r.offsetWidth||0,l=this.props.sizeRef.current;l.height=a.offsetHeight||0,l.width=a.offsetWidth||0,l.top=a.offsetTop,l.left=a.offsetLeft,l.right=o-l.width-l.left}return null}componentDidUpdate(){}render(){return this.props.children}}function nT({children:t,isPresent:s,anchorX:a,root:r}){const o=y.useId(),l=y.useRef(null),c=y.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:u}=y.useContext(lg);return y.useInsertionEffect(()=>{const{width:h,height:f,top:p,left:g,right:v}=c.current;if(s||!l.current||!h||!f)return;const b=a==="left"?`left: ${g}`:`right: ${v}`;l.current.dataset.motionPopId=o;const _=document.createElement("style");u&&(_.nonce=u);const w=r??document.head;return w.appendChild(_),_.sheet&&_.sheet.insertRule(`
          [data-motion-pop-id="${o}"] {
            position: absolute !important;
            width: ${h}px !important;
            height: ${f}px !important;
            ${b}px !important;
            top: ${p}px !important;
          }
        `),()=>{w.contains(_)&&w.removeChild(_)}},[s]),e.jsx(rT,{isPresent:s,childRef:l,sizeRef:c,children:y.cloneElement(t,{ref:l})})}const oT=({children:t,initial:s,isPresent:a,onExitComplete:r,custom:o,presenceAffectsLayout:l,mode:c,anchorX:u,root:h})=>{const f=I0(iT),p=y.useId();let g=!0,v=y.useMemo(()=>(g=!1,{id:p,initial:s,isPresent:a,custom:o,onExitComplete:b=>{f.set(b,!0);for(const _ of f.values())if(!_)return;r&&r()},register:b=>(f.set(b,!1),()=>f.delete(b))}),[a,f,r]);return l&&g&&(v={...v}),y.useMemo(()=>{f.forEach((b,_)=>f.set(_,!1))},[a]),y.useEffect(()=>{!a&&!f.size&&r&&r()},[a]),c==="popLayout"&&(t=e.jsx(nT,{isPresent:a,anchorX:u,root:h,children:t})),e.jsx(ym.Provider,{value:v,children:t})};function iT(){return new Map}function oN(t=!0){const s=y.useContext(ym);if(s===null)return[!0,null];const{isPresent:a,onExitComplete:r,register:o}=s,l=y.useId();y.useEffect(()=>{if(t)return o(l)},[t]);const c=y.useCallback(()=>t&&r&&r(l),[l,r,t]);return!a&&r?[!1,c]:[!0]}const mu=t=>t.key||"";function Sw(t){const s=[];return y.Children.forEach(t,a=>{y.isValidElement(a)&&s.push(a)}),s}const Wa=({children:t,custom:s,initial:a=!0,onExitComplete:r,presenceAffectsLayout:o=!0,mode:l="sync",propagate:c=!1,anchorX:u="left",root:h})=>{const[f,p]=oN(c),g=y.useMemo(()=>Sw(t),[t]),v=c&&!f?[]:g.map(mu),b=y.useRef(!0),_=y.useRef(g),w=I0(()=>new Map),[E,T]=y.useState(g),[N,k]=y.useState(g);p1(()=>{b.current=!1,_.current=g;for(let M=0;M<N.length;M++){const z=mu(N[M]);v.includes(z)?w.delete(z):w.get(z)!==!0&&w.set(z,!1)}},[N,v.length,v.join("-")]);const S=[];if(g!==E){let M=[...g];for(let z=0;z<N.length;z++){const A=N[z],$=mu(A);v.includes($)||(M.splice(z,0,A),S.push(A))}return l==="wait"&&S.length&&(M=S),k(Sw(M)),T(g),null}const{forceRender:C}=y.useContext(L0);return e.jsx(e.Fragment,{children:N.map(M=>{const z=mu(M),A=c&&!f?!1:g===N||v.includes(z),$=()=>{if(w.has(z))w.set(z,!0);else return;let P=!0;w.forEach(F=>{F||(P=!1)}),P&&(C==null||C(),k(_.current),c&&(p==null||p()),r&&r())};return e.jsx(oT,{isPresent:A,initial:!b.current||a?void 0:!1,custom:s,presenceAffectsLayout:o,mode:l,root:h,onExitComplete:A?void 0:$,anchorX:u,children:M},z)})})},iN=y.createContext({strict:!1}),Ew={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},zi={};for(const t in Ew)zi[t]={isEnabled:s=>Ew[t].some(a=>!!s[a])};function lT(t){for(const s in t)zi[s]={...zi[s],...t[s]}}const cT=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function Hu(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||cT.has(t)}let lN=t=>!Hu(t);function dT(t){typeof t=="function"&&(lN=s=>s.startsWith("on")?!Hu(s):t(s))}try{dT(require("@emotion/is-prop-valid").default)}catch{}function uT(t,s,a){const r={};for(const o in t)o==="values"&&typeof t.values=="object"||(lN(o)||a===!0&&Hu(o)||!s&&!Hu(o)||t.draggable&&o.startsWith("onDrag"))&&(r[o]=t[o]);return r}const bm=y.createContext({});function vm(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Nc(t){return typeof t=="string"||Array.isArray(t)}const cg=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],dg=["initial",...cg];function wm(t){return vm(t.animate)||dg.some(s=>Nc(t[s]))}function cN(t){return!!(wm(t)||t.variants)}function mT(t,s){if(wm(t)){const{initial:a,animate:r}=t;return{initial:a===!1||Nc(a)?a:void 0,animate:Nc(r)?r:void 0}}return t.inherit!==!1?s:{}}function hT(t){const{initial:s,animate:a}=mT(t,y.useContext(bm));return y.useMemo(()=>({initial:s,animate:a}),[Cw(s),Cw(a)])}function Cw(t){return Array.isArray(t)?t.join(" "):t}const Sc={};function fT(t){for(const s in t)Sc[s]=t[s],W0(s)&&(Sc[s].isCSSVariable=!0)}function dN(t,{layout:s,layoutId:a}){return Zi.has(t)||t.startsWith("origin")||(s||a!==void 0)&&(!!Sc[t]||t==="opacity")}const pT={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},gT=Gi.length;function xT(t,s,a){let r="",o=!0;for(let l=0;l<gT;l++){const c=Gi[l],u=t[c];if(u===void 0)continue;let h=!0;if(typeof u=="number"?h=u===(c.startsWith("scale")?1:0):h=parseFloat(u)===0,!h||a){const f=eN(u,ng[c]);if(!h){o=!1;const p=pT[c]||c;r+=`${p}(${f}) `}a&&(s[c]=f)}}return r=r.trim(),a?r=a(s,o?"":r):o&&(r="none"),r}function ug(t,s,a){const{style:r,vars:o,transformOrigin:l}=t;let c=!1,u=!1;for(const h in s){const f=s[h];if(Zi.has(h)){c=!0;continue}else if(W0(h)){o[h]=f;continue}else{const p=eN(f,ng[h]);h.startsWith("origin")?(u=!0,l[h]=p):r[h]=p}}if(s.transform||(c||a?r.transform=xT(s,t.transform,a):r.transform&&(r.transform="none")),u){const{originX:h="50%",originY:f="50%",originZ:p=0}=l;r.transformOrigin=`${h} ${f} ${p}`}}const mg=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function uN(t,s,a){for(const r in s)!Ns(s[r])&&!dN(r,a)&&(t[r]=s[r])}function yT({transformTemplate:t},s){return y.useMemo(()=>{const a=mg();return ug(a,s,t),Object.assign({},a.vars,a.style)},[s])}function bT(t,s){const a=t.style||{},r={};return uN(r,a,t),Object.assign(r,yT(t,s)),r}function vT(t,s){const a={},r=bT(t,s);return t.drag&&t.dragListener!==!1&&(a.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(a.tabIndex=0),a.style=r,a}const wT={offset:"stroke-dashoffset",array:"stroke-dasharray"},jT={offset:"strokeDashoffset",array:"strokeDasharray"};function _T(t,s,a=1,r=0,o=!0){t.pathLength=1;const l=o?wT:jT;t[l.offset]=We.transform(-r);const c=We.transform(s),u=We.transform(a);t[l.array]=`${c} ${u}`}function mN(t,{attrX:s,attrY:a,attrScale:r,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...u},h,f,p){if(ug(t,u,f),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:g,style:v}=t;g.transform&&(v.transform=g.transform,delete g.transform),(v.transform||g.transformOrigin)&&(v.transformOrigin=g.transformOrigin??"50% 50%",delete g.transformOrigin),v.transform&&(v.transformBox=(p==null?void 0:p.transformBox)??"fill-box",delete g.transformBox),s!==void 0&&(g.x=s),a!==void 0&&(g.y=a),r!==void 0&&(g.scale=r),o!==void 0&&_T(g,o,l,c,!1)}const hN=()=>({...mg(),attrs:{}}),fN=t=>typeof t=="string"&&t.toLowerCase()==="svg";function NT(t,s,a,r){const o=y.useMemo(()=>{const l=hN();return mN(l,s,fN(r),t.transformTemplate,t.style),{...l.attrs,style:{...l.style}}},[s]);if(t.style){const l={};uN(l,t.style,t),o.style={...l,...o.style}}return o}const ST=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function hg(t){return typeof t!="string"||t.includes("-")?!1:!!(ST.indexOf(t)>-1||/[A-Z]/u.test(t))}function ET(t,s,a,{latestValues:r},o,l=!1){const u=(hg(t)?NT:vT)(s,r,o,t),h=uT(s,typeof t=="string",l),f=t!==y.Fragment?{...h,...u,ref:a}:{},{children:p}=s,g=y.useMemo(()=>Ns(p)?p.get():p,[p]);return y.createElement(t,{...f,children:g})}function kw(t){const s=[{},{}];return t==null||t.values.forEach((a,r)=>{s[0][r]=a.get(),s[1][r]=a.getVelocity()}),s}function fg(t,s,a,r){if(typeof s=="function"){const[o,l]=kw(r);s=s(a!==void 0?a:t.custom,o,l)}if(typeof s=="string"&&(s=t.variants&&t.variants[s]),typeof s=="function"){const[o,l]=kw(r);s=s(a!==void 0?a:t.custom,o,l)}return s}function Mu(t){return Ns(t)?t.get():t}function CT({scrapeMotionValuesFromProps:t,createRenderState:s},a,r,o){return{latestValues:kT(a,r,o,t),renderState:s()}}function kT(t,s,a,r){const o={},l=r(t,{});for(const v in l)o[v]=Mu(l[v]);let{initial:c,animate:u}=t;const h=wm(t),f=cN(t);s&&f&&!h&&t.inherit!==!1&&(c===void 0&&(c=s.initial),u===void 0&&(u=s.animate));let p=a?a.initial===!1:!1;p=p||c===!1;const g=p?u:c;if(g&&typeof g!="boolean"&&!vm(g)){const v=Array.isArray(g)?g:[g];for(let b=0;b<v.length;b++){const _=fg(t,v[b]);if(_){const{transitionEnd:w,transition:E,...T}=_;for(const N in T){let k=T[N];if(Array.isArray(k)){const S=p?k.length-1:0;k=k[S]}k!==null&&(o[N]=k)}for(const N in w)o[N]=w[N]}}}return o}const pN=t=>(s,a)=>{const r=y.useContext(bm),o=y.useContext(ym),l=()=>CT(t,s,r,o);return a?l():I0(l)};function pg(t,s,a){var l;const{style:r}=t,o={};for(const c in r)(Ns(r[c])||s.style&&Ns(s.style[c])||dN(c,t)||((l=a==null?void 0:a.getValue(c))==null?void 0:l.liveStyle)!==void 0)&&(o[c]=r[c]);return o}const TT=pN({scrapeMotionValuesFromProps:pg,createRenderState:mg});function gN(t,s,a){const r=pg(t,s,a);for(const o in t)if(Ns(t[o])||Ns(s[o])){const l=Gi.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;r[l]=t[o]}return r}const AT=pN({scrapeMotionValuesFromProps:gN,createRenderState:hN}),MT=Symbol.for("motionComponentSymbol");function bi(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function RT(t,s,a){return y.useCallback(r=>{r&&t.onMount&&t.onMount(r),s&&(r?s.mount(r):s.unmount()),a&&(typeof a=="function"?a(r):bi(a)&&(a.current=r))},[s])}const gg=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),OT="framerAppearId",xN="data-"+gg(OT),yN=y.createContext({});function DT(t,s,a,r,o){var w,E;const{visualElement:l}=y.useContext(bm),c=y.useContext(iN),u=y.useContext(ym),h=y.useContext(lg).reducedMotion,f=y.useRef(null);r=r||c.renderer,!f.current&&r&&(f.current=r(t,{visualState:s,parent:l,props:a,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:h}));const p=f.current,g=y.useContext(yN);p&&!p.projection&&o&&(p.type==="html"||p.type==="svg")&&PT(f.current,a,o,g);const v=y.useRef(!1);y.useInsertionEffect(()=>{p&&v.current&&p.update(a,u)});const b=a[xN],_=y.useRef(!!b&&!((w=window.MotionHandoffIsComplete)!=null&&w.call(window,b))&&((E=window.MotionHasOptimisedAnimation)==null?void 0:E.call(window,b)));return p1(()=>{p&&(v.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),p.scheduleRenderMicrotask(),_.current&&p.animationState&&p.animationState.animateChanges())}),y.useEffect(()=>{p&&(!_.current&&p.animationState&&p.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{var T;(T=window.MotionHandoffMarkAsComplete)==null||T.call(window,b)}),_.current=!1),p.enteringChildren=void 0)}),p}function PT(t,s,a,r){const{layoutId:o,layout:l,drag:c,dragConstraints:u,layoutScroll:h,layoutRoot:f,layoutCrossfade:p}=s;t.projection=new a(t.latestValues,s["data-framer-portal-id"]?void 0:bN(t.parent)),t.projection.setOptions({layoutId:o,layout:l,alwaysMeasureLayout:!!c||u&&bi(u),visualElement:t,animationType:typeof l=="string"?l:"both",initialPromotionConfig:r,crossfade:p,layoutScroll:h,layoutRoot:f})}function bN(t){if(t)return t.options.allowProjection!==!1?t.projection:bN(t.parent)}function up(t,{forwardMotionProps:s=!1}={},a,r){a&&lT(a);const o=hg(t)?AT:TT;function l(u,h){let f;const p={...y.useContext(lg),...u,layoutId:zT(u)},{isStatic:g}=p,v=hT(u),b=o(u,g);if(!g&&U0){$T();const _=LT(p);f=_.MeasureLayout,v.visualElement=DT(t,b,p,r,_.ProjectionNode)}return e.jsxs(bm.Provider,{value:v,children:[f&&v.visualElement?e.jsx(f,{visualElement:v.visualElement,...p}):null,ET(t,u,RT(b,v.visualElement,h),b,g,s)]})}l.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const c=y.forwardRef(l);return c[MT]=t,c}function zT({layoutId:t}){const s=y.useContext(L0).id;return s&&t!==void 0?s+"-"+t:t}function $T(t,s){y.useContext(iN).strict}function LT(t){const{drag:s,layout:a}=zi;if(!s&&!a)return{};const r={...s,...a};return{MeasureLayout:s!=null&&s.isEnabled(t)||a!=null&&a.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function IT(t,s){if(typeof Proxy>"u")return up;const a=new Map,r=(l,c)=>up(l,c,t,s),o=(l,c)=>r(l,c);return new Proxy(o,{get:(l,c)=>c==="create"?r:(a.has(c)||a.set(c,up(c,void 0,t,s)),a.get(c))})}function vN({top:t,left:s,right:a,bottom:r}){return{x:{min:s,max:a},y:{min:t,max:r}}}function UT({x:t,y:s}){return{top:s.min,right:t.max,bottom:s.max,left:t.min}}function BT(t,s){if(!s)return t;const a=s({x:t.left,y:t.top}),r=s({x:t.right,y:t.bottom});return{top:a.y,left:a.x,bottom:r.y,right:r.x}}function mp(t){return t===void 0||t===1}function r0({scale:t,scaleX:s,scaleY:a}){return!mp(t)||!mp(s)||!mp(a)}function Vn(t){return r0(t)||wN(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function wN(t){return Tw(t.x)||Tw(t.y)}function Tw(t){return t&&t!=="0%"}function Gu(t,s,a){const r=t-a,o=s*r;return a+o}function Aw(t,s,a,r,o){return o!==void 0&&(t=Gu(t,o,r)),Gu(t,a,r)+s}function n0(t,s=0,a=1,r,o){t.min=Aw(t.min,s,a,r,o),t.max=Aw(t.max,s,a,r,o)}function jN(t,{x:s,y:a}){n0(t.x,s.translate,s.scale,s.originPoint),n0(t.y,a.translate,a.scale,a.originPoint)}const Mw=.999999999999,Rw=1.0000000000001;function VT(t,s,a,r=!1){const o=a.length;if(!o)return;s.x=s.y=1;let l,c;for(let u=0;u<o;u++){l=a[u],c=l.projectionDelta;const{visualElement:h}=l.options;h&&h.props.style&&h.props.style.display==="contents"||(r&&l.options.layoutScroll&&l.scroll&&l!==l.root&&wi(t,{x:-l.scroll.offset.x,y:-l.scroll.offset.y}),c&&(s.x*=c.x.scale,s.y*=c.y.scale,jN(t,c)),r&&Vn(l.latestValues)&&wi(t,l.latestValues))}s.x<Rw&&s.x>Mw&&(s.x=1),s.y<Rw&&s.y>Mw&&(s.y=1)}function vi(t,s){t.min=t.min+s,t.max=t.max+s}function Ow(t,s,a,r,o=.5){const l=zt(t.min,t.max,o);n0(t,s,a,l,r)}function wi(t,s){Ow(t.x,s.x,s.scaleX,s.scale,s.originX),Ow(t.y,s.y,s.scaleY,s.scale,s.originY)}function _N(t,s){return vN(BT(t.getBoundingClientRect(),s))}function qT(t,s,a){const r=_N(t,a),{scroll:o}=s;return o&&(vi(r.x,o.offset.x),vi(r.y,o.offset.y)),r}const Dw=()=>({translate:0,scale:1,origin:0,originPoint:0}),ji=()=>({x:Dw(),y:Dw()}),Pw=()=>({min:0,max:0}),Ht=()=>({x:Pw(),y:Pw()}),o0={current:null},NN={current:!1};function FT(){if(NN.current=!0,!!U0)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),s=()=>o0.current=t.matches;t.addEventListener("change",s),s()}else o0.current=!1}const HT=new WeakMap;function GT(t,s,a){for(const r in s){const o=s[r],l=a[r];if(Ns(o))t.addValue(r,o);else if(Ns(l))t.addValue(r,Pi(o,{owner:t}));else if(l!==o)if(t.hasValue(r)){const c=t.getValue(r);c.liveStyle===!0?c.jump(o):c.hasAnimated||c.set(o)}else{const c=t.getStaticValue(r);t.addValue(r,Pi(c!==void 0?c:o,{owner:t}))}}for(const r in a)s[r]===void 0&&t.removeValue(r);return s}const zw=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class ZT{scrapeMotionValuesFromProps(s,a,r){return{}}constructor({parent:s,props:a,presenceContext:r,reducedMotionConfig:o,blockInitialAnimation:l,visualState:c},u={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=ag,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=$s.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,Mt.render(this.render,!1,!0))};const{latestValues:h,renderState:f}=c;this.latestValues=h,this.baseTarget={...h},this.initialValues=a.initial?{...h}:{},this.renderState=f,this.parent=s,this.props=a,this.presenceContext=r,this.depth=s?s.depth+1:0,this.reducedMotionConfig=o,this.options=u,this.blockInitialAnimation=!!l,this.isControllingVariants=wm(a),this.isVariantNode=cN(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(s&&s.current);const{willChange:p,...g}=this.scrapeMotionValuesFromProps(a,{},this);for(const v in g){const b=g[v];h[v]!==void 0&&Ns(b)&&b.set(h[v])}}mount(s){var a;this.current=s,HT.set(s,this),this.projection&&!this.projection.instance&&this.projection.mount(s),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,o)=>this.bindToMotionValue(o,r)),NN.current||FT(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:o0.current,(a=this.parent)==null||a.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var s;this.projection&&this.projection.unmount(),mn(this.notifyUpdate),mn(this.render),this.valueSubscriptions.forEach(a=>a()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(s=this.parent)==null||s.removeChild(this);for(const a in this.events)this.events[a].clear();for(const a in this.features){const r=this.features[a];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(s){this.children.add(s),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(s)}removeChild(s){this.children.delete(s),this.enteringChildren&&this.enteringChildren.delete(s)}bindToMotionValue(s,a){this.valueSubscriptions.has(s)&&this.valueSubscriptions.get(s)();const r=Zi.has(s);r&&this.onBindTransform&&this.onBindTransform();const o=a.on("change",c=>{this.latestValues[s]=c,this.props.onUpdate&&Mt.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let l;window.MotionCheckAppearSync&&(l=window.MotionCheckAppearSync(this,s,a)),this.valueSubscriptions.set(s,()=>{o(),l&&l(),a.owner&&a.stop()})}sortNodePosition(s){return!this.current||!this.sortInstanceNodePosition||this.type!==s.type?0:this.sortInstanceNodePosition(this.current,s.current)}updateFeatures(){let s="animation";for(s in zi){const a=zi[s];if(!a)continue;const{isEnabled:r,Feature:o}=a;if(!this.features[s]&&o&&r(this.props)&&(this.features[s]=new o(this)),this.features[s]){const l=this.features[s];l.isMounted?l.update():(l.mount(),l.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ht()}getStaticValue(s){return this.latestValues[s]}setStaticValue(s,a){this.latestValues[s]=a}update(s,a){(s.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=s,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let r=0;r<zw.length;r++){const o=zw[r];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const l="on"+o,c=s[l];c&&(this.propEventSubscriptions[o]=this.on(o,c))}this.prevMotionValues=GT(this,this.scrapeMotionValuesFromProps(s,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(s){return this.props.variants?this.props.variants[s]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(s){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(s),()=>a.variantChildren.delete(s)}addValue(s,a){const r=this.values.get(s);a!==r&&(r&&this.removeValue(s),this.bindToMotionValue(s,a),this.values.set(s,a),this.latestValues[s]=a.get())}removeValue(s){this.values.delete(s);const a=this.valueSubscriptions.get(s);a&&(a(),this.valueSubscriptions.delete(s)),delete this.latestValues[s],this.removeValueFromRenderState(s,this.renderState)}hasValue(s){return this.values.has(s)}getValue(s,a){if(this.props.values&&this.props.values[s])return this.props.values[s];let r=this.values.get(s);return r===void 0&&a!==void 0&&(r=Pi(a===null?void 0:a,{owner:this}),this.addValue(s,r)),r}readValue(s,a){let r=this.latestValues[s]!==void 0||!this.current?this.latestValues[s]:this.getBaseTargetFromProps(this.props,s)??this.readValueFromInstance(this.current,s,this.options);return r!=null&&(typeof r=="string"&&(g1(r)||y1(r))?r=parseFloat(r):!aT(r)&&hn.test(a)&&(r=J1(s,a)),this.setBaseTarget(s,Ns(r)?r.get():r)),Ns(r)?r.get():r}setBaseTarget(s,a){this.baseTarget[s]=a}getBaseTarget(s){var l;const{initial:a}=this.props;let r;if(typeof a=="string"||typeof a=="object"){const c=fg(this.props,a,(l=this.presenceContext)==null?void 0:l.custom);c&&(r=c[s])}if(a&&r!==void 0)return r;const o=this.getBaseTargetFromProps(this.props,s);return o!==void 0&&!Ns(o)?o:this.initialValues[s]!==void 0&&r===void 0?void 0:this.baseTarget[s]}on(s,a){return this.events[s]||(this.events[s]=new H0),this.events[s].add(a)}notify(s,...a){this.events[s]&&this.events[s].notify(...a)}scheduleRenderMicrotask(){og.render(this.render)}}class SN extends ZT{constructor(){super(...arguments),this.KeyframeResolver=Hk}sortInstanceNodePosition(s,a){return s.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(s,a){return s.style?s.style[a]:void 0}removeValueFromRenderState(s,{vars:a,style:r}){delete a[s],delete r[s]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:s}=this.props;Ns(s)&&(this.childSubscription=s.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}function EN(t,{style:s,vars:a},r,o){const l=t.style;let c;for(c in s)l[c]=s[c];o==null||o.applyProjectionStyles(l,r);for(c in a)l.setProperty(c,a[c])}function WT(t){return window.getComputedStyle(t)}class YT extends SN{constructor(){super(...arguments),this.type="html",this.renderInstance=EN}readValueFromInstance(s,a){var r;if(Zi.has(a))return(r=this.projection)!=null&&r.isProjecting?Xp(a):dk(s,a);{const o=WT(s),l=(W0(a)?o.getPropertyValue(a):o[a])||0;return typeof l=="string"?l.trim():l}}measureInstanceViewportBox(s,{transformPagePoint:a}){return _N(s,a)}build(s,a,r){ug(s,a,r.transformTemplate)}scrapeMotionValuesFromProps(s,a,r){return pg(s,a,r)}}const CN=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function KT(t,s,a,r){EN(t,s,void 0,r);for(const o in s.attrs)t.setAttribute(CN.has(o)?o:gg(o),s.attrs[o])}class XT extends SN{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ht}getBaseTargetFromProps(s,a){return s[a]}readValueFromInstance(s,a){if(Zi.has(a)){const r=Q1(a);return r&&r.default||0}return a=CN.has(a)?a:gg(a),s.getAttribute(a)}scrapeMotionValuesFromProps(s,a,r){return gN(s,a,r)}build(s,a,r){mN(s,a,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(s,a,r,o){KT(s,a,r,o)}mount(s){this.isSVGTag=fN(s.tagName),super.mount(s)}}const QT=(t,s)=>hg(t)?new XT(s):new YT(s,{allowProjection:t!==y.Fragment});function Ci(t,s,a){const r=t.getProps();return fg(r,s,a!==void 0?a:r.custom,t)}const i0=t=>Array.isArray(t);function JT(t,s,a){t.hasValue(s)?t.getValue(s).set(a):t.addValue(s,Pi(a))}function eA(t){return i0(t)?t[t.length-1]||0:t}function tA(t,s){const a=Ci(t,s);let{transitionEnd:r={},transition:o={},...l}=a||{};l={...l,...r};for(const c in l){const u=eA(l[c]);JT(t,c,u)}}function sA(t){return!!(Ns(t)&&t.add)}function l0(t,s){const a=t.getValue("willChange");if(sA(a))return a.add(s);if(!a&&Cr.WillChange){const r=new Cr.WillChange("auto");t.addValue("willChange",r),r.add(s)}}function kN(t){return t.props[xN]}const aA=t=>t!==null;function rA(t,{repeat:s,repeatType:a="loop"},r){const o=t.filter(aA),l=s&&a!=="loop"&&s%2===1?0:o.length-1;return o[l]}const nA={type:"spring",stiffness:500,damping:25,restSpeed:10},oA=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),iA={type:"keyframes",duration:.8},lA={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},cA=(t,{keyframes:s})=>s.length>2?iA:Zi.has(t)?t.startsWith("scale")?oA(s[1]):nA:lA;function dA({when:t,delay:s,delayChildren:a,staggerChildren:r,staggerDirection:o,repeat:l,repeatType:c,repeatDelay:u,from:h,elapsed:f,...p}){return!!Object.keys(p).length}const xg=(t,s,a,r={},o,l)=>c=>{const u=rg(r,t)||{},h=u.delay||r.delay||0;let{elapsed:f=0}=r;f=f-Va(h);const p={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:s.getVelocity(),...u,delay:-f,onUpdate:v=>{s.set(v),u.onUpdate&&u.onUpdate(v)},onComplete:()=>{c(),u.onComplete&&u.onComplete()},name:t,motionValue:s,element:l?void 0:o};dA(u)||Object.assign(p,cA(t,p)),p.duration&&(p.duration=Va(p.duration)),p.repeatDelay&&(p.repeatDelay=Va(p.repeatDelay)),p.from!==void 0&&(p.keyframes[0]=p.from);let g=!1;if((p.type===!1||p.duration===0&&!p.repeatDelay)&&(s0(p),p.delay===0&&(g=!0)),(Cr.instantAnimations||Cr.skipAnimations)&&(g=!0,s0(p),p.delay=0),p.allowFlatten=!u.type&&!u.ease,g&&!l&&s.get()!==void 0){const v=rA(p.keyframes,u);if(v!==void 0){Mt.update(()=>{p.onUpdate(v),p.onComplete()});return}}return u.isSync?new sg(p):new Ok(p)};function uA({protectedKeys:t,needsAnimating:s},a){const r=t.hasOwnProperty(a)&&s[a]!==!0;return s[a]=!1,r}function TN(t,s,{delay:a=0,transitionOverride:r,type:o}={}){let{transition:l=t.getDefaultTransition(),transitionEnd:c,...u}=s;r&&(l=r);const h=[],f=o&&t.animationState&&t.animationState.getState()[o];for(const p in u){const g=t.getValue(p,t.latestValues[p]??null),v=u[p];if(v===void 0||f&&uA(f,p))continue;const b={delay:a,...rg(l||{},p)},_=g.get();if(_!==void 0&&!g.isAnimating&&!Array.isArray(v)&&v===_&&!b.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const T=kN(t);if(T){const N=window.MotionHandoffAnimation(T,p,Mt);N!==null&&(b.startTime=N,w=!0)}}l0(t,p),g.start(xg(p,g,v,t.shouldReduceMotion&&Y1.has(p)?{type:!1}:b,t,w));const E=g.animation;E&&h.push(E)}return c&&Promise.all(h).then(()=>{Mt.update(()=>{c&&tA(t,c)})}),h}function AN(t,s,a,r=0,o=1){const l=Array.from(t).sort((f,p)=>f.sortNodePosition(p)).indexOf(s),c=t.size,u=(c-1)*r;return typeof a=="function"?a(l,c):o===1?l*r:u-l*r}function c0(t,s,a={}){var h;const r=Ci(t,s,a.type==="exit"?(h=t.presenceContext)==null?void 0:h.custom:void 0);let{transition:o=t.getDefaultTransition()||{}}=r||{};a.transitionOverride&&(o=a.transitionOverride);const l=r?()=>Promise.all(TN(t,r,a)):()=>Promise.resolve(),c=t.variantChildren&&t.variantChildren.size?(f=0)=>{const{delayChildren:p=0,staggerChildren:g,staggerDirection:v}=o;return mA(t,s,f,p,g,v,a)}:()=>Promise.resolve(),{when:u}=o;if(u){const[f,p]=u==="beforeChildren"?[l,c]:[c,l];return f().then(()=>p())}else return Promise.all([l(),c(a.delay)])}function mA(t,s,a=0,r=0,o=0,l=1,c){const u=[];for(const h of t.variantChildren)h.notify("AnimationStart",s),u.push(c0(h,s,{...c,delay:a+(typeof r=="function"?0:r)+AN(t.variantChildren,h,r,o,l)}).then(()=>h.notify("AnimationComplete",s)));return Promise.all(u)}function hA(t,s,a={}){t.notify("AnimationStart",s);let r;if(Array.isArray(s)){const o=s.map(l=>c0(t,l,a));r=Promise.all(o)}else if(typeof s=="string")r=c0(t,s,a);else{const o=typeof s=="function"?Ci(t,s,a.custom):s;r=Promise.all(TN(t,o,a))}return r.then(()=>{t.notify("AnimationComplete",s)})}function MN(t,s){if(!Array.isArray(s))return!1;const a=s.length;if(a!==t.length)return!1;for(let r=0;r<a;r++)if(s[r]!==t[r])return!1;return!0}const fA=dg.length;function RN(t){if(!t)return;if(!t.isControllingVariants){const a=t.parent?RN(t.parent)||{}:{};return t.props.initial!==void 0&&(a.initial=t.props.initial),a}const s={};for(let a=0;a<fA;a++){const r=dg[a],o=t.props[r];(Nc(o)||o===!1)&&(s[r]=o)}return s}const pA=[...cg].reverse(),gA=cg.length;function xA(t){return s=>Promise.all(s.map(({animation:a,options:r})=>hA(t,a,r)))}function yA(t){let s=xA(t),a=$w(),r=!0;const o=h=>(f,p)=>{var v;const g=Ci(t,p,h==="exit"?(v=t.presenceContext)==null?void 0:v.custom:void 0);if(g){const{transition:b,transitionEnd:_,...w}=g;f={...f,...w,..._}}return f};function l(h){s=h(t)}function c(h){const{props:f}=t,p=RN(t.parent)||{},g=[],v=new Set;let b={},_=1/0;for(let E=0;E<gA;E++){const T=pA[E],N=a[T],k=f[T]!==void 0?f[T]:p[T],S=Nc(k),C=T===h?N.isActive:null;C===!1&&(_=E);let M=k===p[T]&&k!==f[T]&&S;if(M&&r&&t.manuallyAnimateOnMount&&(M=!1),N.protectedKeys={...b},!N.isActive&&C===null||!k&&!N.prevProp||vm(k)||typeof k=="boolean")continue;const z=bA(N.prevProp,k);let A=z||T===h&&N.isActive&&!M&&S||E>_&&S,$=!1;const P=Array.isArray(k)?k:[k];let F=P.reduce(o(T),{});C===!1&&(F={});const{prevResolvedValues:I={}}=N,J={...I,...F},pe=G=>{A=!0,v.has(G)&&($=!0,v.delete(G)),N.needsAnimating[G]=!0;const ee=t.getValue(G);ee&&(ee.liveStyle=!1)};for(const G in J){const ee=F[G],xe=I[G];if(b.hasOwnProperty(G))continue;let O=!1;i0(ee)&&i0(xe)?O=!MN(ee,xe):O=ee!==xe,O?ee!=null?pe(G):v.add(G):ee!==void 0&&v.has(G)?pe(G):N.protectedKeys[G]=!0}N.prevProp=k,N.prevResolvedValues=F,N.isActive&&(b={...b,...F}),r&&t.blockInitialAnimation&&(A=!1);const te=M&&z;A&&(!te||$)&&g.push(...P.map(G=>{const ee={type:T};if(typeof G=="string"&&r&&!te&&t.manuallyAnimateOnMount&&t.parent){const{parent:xe}=t,O=Ci(xe,G);if(xe.enteringChildren&&O){const{delayChildren:H}=O.transition||{};ee.delay=AN(xe.enteringChildren,t,H)}}return{animation:G,options:ee}}))}if(v.size){const E={};if(typeof f.initial!="boolean"){const T=Ci(t,Array.isArray(f.initial)?f.initial[0]:f.initial);T&&T.transition&&(E.transition=T.transition)}v.forEach(T=>{const N=t.getBaseTarget(T),k=t.getValue(T);k&&(k.liveStyle=!0),E[T]=N??null}),g.push({animation:E})}let w=!!g.length;return r&&(f.initial===!1||f.initial===f.animate)&&!t.manuallyAnimateOnMount&&(w=!1),r=!1,w?s(g):Promise.resolve()}function u(h,f){var g;if(a[h].isActive===f)return Promise.resolve();(g=t.variantChildren)==null||g.forEach(v=>{var b;return(b=v.animationState)==null?void 0:b.setActive(h,f)}),a[h].isActive=f;const p=c(h);for(const v in a)a[v].protectedKeys={};return p}return{animateChanges:c,setActive:u,setAnimateFunction:l,getState:()=>a,reset:()=>{a=$w(),r=!0}}}function bA(t,s){return typeof s=="string"?s!==t:Array.isArray(s)?!MN(s,t):!1}function In(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function $w(){return{animate:In(!0),whileInView:In(),whileHover:In(),whileTap:In(),whileDrag:In(),whileFocus:In(),exit:In()}}class gn{constructor(s){this.isMounted=!1,this.node=s}update(){}}class vA extends gn{constructor(s){super(s),s.animationState||(s.animationState=yA(s))}updateAnimationControlsSubscription(){const{animate:s}=this.node.getProps();vm(s)&&(this.unmountControls=s.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:s}=this.node.getProps(),{animate:a}=this.node.prevProps||{};s!==a&&this.updateAnimationControlsSubscription()}unmount(){var s;this.node.animationState.reset(),(s=this.unmountControls)==null||s.call(this)}}let wA=0;class jA extends gn{constructor(){super(...arguments),this.id=wA++}update(){if(!this.node.presenceContext)return;const{isPresent:s,onExitComplete:a}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||s===r)return;const o=this.node.animationState.setActive("exit",!s);a&&!s&&o.then(()=>{a(this.id)})}mount(){const{register:s,onExitComplete:a}=this.node.presenceContext||{};a&&a(this.id),s&&(this.unmount=s(this.id))}unmount(){}}const _A={animation:{Feature:vA},exit:{Feature:jA}};function Ec(t,s,a,r={passive:!0}){return t.addEventListener(s,a,r),()=>t.removeEventListener(s,a)}function Bc(t){return{point:{x:t.pageX,y:t.pageY}}}const NA=t=>s=>ig(s)&&t(s,Bc(s));function cc(t,s,a,r){return Ec(t,s,NA(a),r)}const ON=1e-4,SA=1-ON,EA=1+ON,DN=.01,CA=0-DN,kA=0+DN;function Ts(t){return t.max-t.min}function TA(t,s,a){return Math.abs(t-s)<=a}function Lw(t,s,a,r=.5){t.origin=r,t.originPoint=zt(s.min,s.max,t.origin),t.scale=Ts(a)/Ts(s),t.translate=zt(a.min,a.max,t.origin)-t.originPoint,(t.scale>=SA&&t.scale<=EA||isNaN(t.scale))&&(t.scale=1),(t.translate>=CA&&t.translate<=kA||isNaN(t.translate))&&(t.translate=0)}function dc(t,s,a,r){Lw(t.x,s.x,a.x,r?r.originX:void 0),Lw(t.y,s.y,a.y,r?r.originY:void 0)}function Iw(t,s,a){t.min=a.min+s.min,t.max=t.min+Ts(s)}function AA(t,s,a){Iw(t.x,s.x,a.x),Iw(t.y,s.y,a.y)}function Uw(t,s,a){t.min=s.min-a.min,t.max=t.min+Ts(s)}function uc(t,s,a){Uw(t.x,s.x,a.x),Uw(t.y,s.y,a.y)}function ca(t){return[t("x"),t("y")]}const PN=({current:t})=>t?t.ownerDocument.defaultView:null,Bw=(t,s)=>Math.abs(t-s);function MA(t,s){const a=Bw(t.x,s.x),r=Bw(t.y,s.y);return Math.sqrt(a**2+r**2)}class zN{constructor(s,a,{transformPagePoint:r,contextWindow:o=window,dragSnapToOrigin:l=!1,distanceThreshold:c=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=fp(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,_=MA(v.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!_)return;const{point:w}=v,{timestamp:E}=vs;this.history.push({...w,timestamp:E});const{onStart:T,onMove:N}=this.handlers;b||(T&&T(this.lastMoveEvent,v),this.startEvent=this.lastMoveEvent),N&&N(this.lastMoveEvent,v)},this.handlePointerMove=(v,b)=>{this.lastMoveEvent=v,this.lastMoveEventInfo=hp(b,this.transformPagePoint),Mt.update(this.updatePoint,!0)},this.handlePointerUp=(v,b)=>{this.end();const{onEnd:_,onSessionEnd:w,resumeAnimation:E}=this.handlers;if(this.dragSnapToOrigin&&E&&E(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const T=fp(v.type==="pointercancel"?this.lastMoveEventInfo:hp(b,this.transformPagePoint),this.history);this.startEvent&&_&&_(v,T),w&&w(v,T)},!ig(s))return;this.dragSnapToOrigin=l,this.handlers=a,this.transformPagePoint=r,this.distanceThreshold=c,this.contextWindow=o||window;const u=Bc(s),h=hp(u,this.transformPagePoint),{point:f}=h,{timestamp:p}=vs;this.history=[{...f,timestamp:p}];const{onSessionStart:g}=a;g&&g(s,fp(h,this.history)),this.removeListeners=Lc(cc(this.contextWindow,"pointermove",this.handlePointerMove),cc(this.contextWindow,"pointerup",this.handlePointerUp),cc(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(s){this.handlers=s}end(){this.removeListeners&&this.removeListeners(),mn(this.updatePoint)}}function hp(t,s){return s?{point:s(t.point)}:t}function Vw(t,s){return{x:t.x-s.x,y:t.y-s.y}}function fp({point:t},s){return{point:t,delta:Vw(t,$N(s)),offset:Vw(t,RA(s)),velocity:OA(s,.1)}}function RA(t){return t[0]}function $N(t){return t[t.length-1]}function OA(t,s){if(t.length<2)return{x:0,y:0};let a=t.length-1,r=null;const o=$N(t);for(;a>=0&&(r=t[a],!(o.timestamp-r.timestamp>Va(s)));)a--;if(!r)return{x:0,y:0};const l=qa(o.timestamp-r.timestamp);if(l===0)return{x:0,y:0};const c={x:(o.x-r.x)/l,y:(o.y-r.y)/l};return c.x===1/0&&(c.x=0),c.y===1/0&&(c.y=0),c}function DA(t,{min:s,max:a},r){return s!==void 0&&t<s?t=r?zt(s,t,r.min):Math.max(t,s):a!==void 0&&t>a&&(t=r?zt(a,t,r.max):Math.min(t,a)),t}function qw(t,s,a){return{min:s!==void 0?t.min+s:void 0,max:a!==void 0?t.max+a-(t.max-t.min):void 0}}function PA(t,{top:s,left:a,bottom:r,right:o}){return{x:qw(t.x,a,o),y:qw(t.y,s,r)}}function Fw(t,s){let a=s.min-t.min,r=s.max-t.max;return s.max-s.min<t.max-t.min&&([a,r]=[r,a]),{min:a,max:r}}function zA(t,s){return{x:Fw(t.x,s.x),y:Fw(t.y,s.y)}}function $A(t,s){let a=.5;const r=Ts(t),o=Ts(s);return o>r?a=wc(s.min,s.max-r,t.min):r>o&&(a=wc(t.min,t.max-o,s.min)),Er(0,1,a)}function LA(t,s){const a={};return s.min!==void 0&&(a.min=s.min-t.min),s.max!==void 0&&(a.max=s.max-t.min),a}const d0=.35;function IA(t=d0){return t===!1?t=0:t===!0&&(t=d0),{x:Hw(t,"left","right"),y:Hw(t,"top","bottom")}}function Hw(t,s,a){return{min:Gw(t,s),max:Gw(t,a)}}function Gw(t,s){return typeof t=="number"?t:t[s]||0}const UA=new WeakMap;class BA{constructor(s){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ht(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=s}start(s,{snapToCursor:a=!1,distanceThreshold:r}={}){const{presenceContext:o}=this.visualElement;if(o&&o.isPresent===!1)return;const l=g=>{const{dragSnapToOrigin:v}=this.getProps();v?this.pauseAnimation():this.stopAnimation(),a&&this.snapToCursor(Bc(g).point)},c=(g,v)=>{const{drag:b,dragPropagation:_,onDragStart:w}=this.getProps();if(b&&!_&&(this.openDragLock&&this.openDragLock(),this.openDragLock=Yk(b),!this.openDragLock))return;this.latestPointerEvent=g,this.latestPanInfo=v,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),ca(T=>{let N=this.getAxisMotionValue(T).get()||0;if(Fa.test(N)){const{projection:k}=this.visualElement;if(k&&k.layout){const S=k.layout.layoutBox[T];S&&(N=Ts(S)*(parseFloat(N)/100))}}this.originPoint[T]=N}),w&&Mt.postRender(()=>w(g,v)),l0(this.visualElement,"transform");const{animationState:E}=this.visualElement;E&&E.setActive("whileDrag",!0)},u=(g,v)=>{this.latestPointerEvent=g,this.latestPanInfo=v;const{dragPropagation:b,dragDirectionLock:_,onDirectionLock:w,onDrag:E}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:T}=v;if(_&&this.currentDirection===null){this.currentDirection=VA(T),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",v.point,T),this.updateAxis("y",v.point,T),this.visualElement.render(),E&&E(g,v)},h=(g,v)=>{this.latestPointerEvent=g,this.latestPanInfo=v,this.stop(g,v),this.latestPointerEvent=null,this.latestPanInfo=null},f=()=>ca(g=>{var v;return this.getAnimationState(g)==="paused"&&((v=this.getAxisMotionValue(g).animation)==null?void 0:v.play())}),{dragSnapToOrigin:p}=this.getProps();this.panSession=new zN(s,{onSessionStart:l,onStart:c,onMove:u,onSessionEnd:h,resumeAnimation:f},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:p,distanceThreshold:r,contextWindow:PN(this.visualElement)})}stop(s,a){const r=s||this.latestPointerEvent,o=a||this.latestPanInfo,l=this.isDragging;if(this.cancel(),!l||!o||!r)return;const{velocity:c}=o;this.startAnimation(c);const{onDragEnd:u}=this.getProps();u&&Mt.postRender(()=>u(r,o))}cancel(){this.isDragging=!1;const{projection:s,animationState:a}=this.visualElement;s&&(s.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),a&&a.setActive("whileDrag",!1)}updateAxis(s,a,r){const{drag:o}=this.getProps();if(!r||!hu(s,o,this.currentDirection))return;const l=this.getAxisMotionValue(s);let c=this.originPoint[s]+r[s];this.constraints&&this.constraints[s]&&(c=DA(c,this.constraints[s],this.elastic[s])),l.set(c)}resolveConstraints(){var l;const{dragConstraints:s,dragElastic:a}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(l=this.visualElement.projection)==null?void 0:l.layout,o=this.constraints;s&&bi(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&r?this.constraints=PA(r.layoutBox,s):this.constraints=!1,this.elastic=IA(a),o!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&ca(c=>{this.constraints!==!1&&this.getAxisMotionValue(c)&&(this.constraints[c]=LA(r.layoutBox[c],this.constraints[c]))})}resolveRefConstraints(){const{dragConstraints:s,onMeasureDragConstraints:a}=this.getProps();if(!s||!bi(s))return!1;const r=s.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const l=qT(r,o.root,this.visualElement.getTransformPagePoint());let c=zA(o.layout.layoutBox,l);if(a){const u=a(UT(c));this.hasMutatedConstraints=!!u,u&&(c=vN(u))}return c}startAnimation(s){const{drag:a,dragMomentum:r,dragElastic:o,dragTransition:l,dragSnapToOrigin:c,onDragTransitionEnd:u}=this.getProps(),h=this.constraints||{},f=ca(p=>{if(!hu(p,a,this.currentDirection))return;let g=h&&h[p]||{};c&&(g={min:0,max:0});const v=o?200:1e6,b=o?40:1e7,_={type:"inertia",velocity:r?s[p]:0,bounceStiffness:v,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...l,...g};return this.startAxisValueAnimation(p,_)});return Promise.all(f).then(u)}startAxisValueAnimation(s,a){const r=this.getAxisMotionValue(s);return l0(this.visualElement,s),r.start(xg(s,r,0,a,this.visualElement,!1))}stopAnimation(){ca(s=>this.getAxisMotionValue(s).stop())}pauseAnimation(){ca(s=>{var a;return(a=this.getAxisMotionValue(s).animation)==null?void 0:a.pause()})}getAnimationState(s){var a;return(a=this.getAxisMotionValue(s).animation)==null?void 0:a.state}getAxisMotionValue(s){const a=`_drag${s.toUpperCase()}`,r=this.visualElement.getProps(),o=r[a];return o||this.visualElement.getValue(s,(r.initial?r.initial[s]:void 0)||0)}snapToCursor(s){ca(a=>{const{drag:r}=this.getProps();if(!hu(a,r,this.currentDirection))return;const{projection:o}=this.visualElement,l=this.getAxisMotionValue(a);if(o&&o.layout){const{min:c,max:u}=o.layout.layoutBox[a];l.set(s[a]-zt(c,u,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:s,dragConstraints:a}=this.getProps(),{projection:r}=this.visualElement;if(!bi(a)||!r||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};ca(c=>{const u=this.getAxisMotionValue(c);if(u&&this.constraints!==!1){const h=u.get();o[c]=$A({min:h,max:h},this.constraints[c])}});const{transformTemplate:l}=this.visualElement.getProps();this.visualElement.current.style.transform=l?l({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),ca(c=>{if(!hu(c,s,null))return;const u=this.getAxisMotionValue(c),{min:h,max:f}=this.constraints[c];u.set(zt(h,f,o[c]))})}addListeners(){if(!this.visualElement.current)return;UA.set(this.visualElement,this);const s=this.visualElement.current,a=cc(s,"pointerdown",h=>{const{drag:f,dragListener:p=!0}=this.getProps();f&&p&&this.start(h)}),r=()=>{const{dragConstraints:h}=this.getProps();bi(h)&&h.current&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,l=o.addEventListener("measure",r);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),Mt.read(r);const c=Ec(window,"resize",()=>this.scalePositionWithinConstraints()),u=o.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f})=>{this.isDragging&&f&&(ca(p=>{const g=this.getAxisMotionValue(p);g&&(this.originPoint[p]+=h[p].translate,g.set(g.get()+h[p].translate))}),this.visualElement.render())});return()=>{c(),a(),l(),u&&u()}}getProps(){const s=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:r=!1,dragPropagation:o=!1,dragConstraints:l=!1,dragElastic:c=d0,dragMomentum:u=!0}=s;return{...s,drag:a,dragDirectionLock:r,dragPropagation:o,dragConstraints:l,dragElastic:c,dragMomentum:u}}}function hu(t,s,a){return(s===!0||s===t)&&(a===null||a===t)}function VA(t,s=10){let a=null;return Math.abs(t.y)>s?a="y":Math.abs(t.x)>s&&(a="x"),a}class qA extends gn{constructor(s){super(s),this.removeGroupControls=da,this.removeListeners=da,this.controls=new BA(s)}mount(){const{dragControls:s}=this.node.getProps();s&&(this.removeGroupControls=s.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||da}unmount(){this.removeGroupControls(),this.removeListeners()}}const Zw=t=>(s,a)=>{t&&Mt.postRender(()=>t(s,a))};class FA extends gn{constructor(){super(...arguments),this.removePointerDownListener=da}onPointerDown(s){this.session=new zN(s,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:PN(this.node)})}createPanHandlers(){const{onPanSessionStart:s,onPanStart:a,onPan:r,onPanEnd:o}=this.node.getProps();return{onSessionStart:Zw(s),onStart:Zw(a),onMove:r,onEnd:(l,c)=>{delete this.session,o&&Mt.postRender(()=>o(l,c))}}}mount(){this.removePointerDownListener=cc(this.node.current,"pointerdown",s=>this.onPointerDown(s))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Ru={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Ww(t,s){return s.max===s.min?0:t/(s.max-s.min)*100}const Kl={correct:(t,s)=>{if(!s.target)return t;if(typeof t=="string")if(We.test(t))t=parseFloat(t);else return t;const a=Ww(t,s.target.x),r=Ww(t,s.target.y);return`${a}% ${r}%`}},HA={correct:(t,{treeScale:s,projectionDelta:a})=>{const r=t,o=hn.parse(t);if(o.length>5)return r;const l=hn.createTransformer(t),c=typeof o[0]!="number"?1:0,u=a.x.scale*s.x,h=a.y.scale*s.y;o[0+c]/=u,o[1+c]/=h;const f=zt(u,h,.5);return typeof o[2+c]=="number"&&(o[2+c]/=f),typeof o[3+c]=="number"&&(o[3+c]/=f),l(o)}};let pp=!1;class GA extends y.Component{componentDidMount(){const{visualElement:s,layoutGroup:a,switchLayoutGroup:r,layoutId:o}=this.props,{projection:l}=s;fT(ZA),l&&(a.group&&a.group.add(l),r&&r.register&&o&&r.register(l),pp&&l.root.didUpdate(),l.addEventListener("animationComplete",()=>{this.safeToRemove()}),l.setOptions({...l.options,onExitComplete:()=>this.safeToRemove()})),Ru.hasEverUpdated=!0}getSnapshotBeforeUpdate(s){const{layoutDependency:a,visualElement:r,drag:o,isPresent:l}=this.props,{projection:c}=r;return c&&(c.isPresent=l,pp=!0,o||s.layoutDependency!==a||a===void 0||s.isPresent!==l?c.willUpdate():this.safeToRemove(),s.isPresent!==l&&(l?c.promote():c.relegate()||Mt.postRender(()=>{const u=c.getStack();(!u||!u.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:s}=this.props.visualElement;s&&(s.root.didUpdate(),og.postRender(()=>{!s.currentAnimation&&s.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:s,layoutGroup:a,switchLayoutGroup:r}=this.props,{projection:o}=s;pp=!0,o&&(o.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(o),r&&r.deregister&&r.deregister(o))}safeToRemove(){const{safeToRemove:s}=this.props;s&&s()}render(){return null}}function LN(t){const[s,a]=oN(),r=y.useContext(L0);return e.jsx(GA,{...t,layoutGroup:r,switchLayoutGroup:y.useContext(yN),isPresent:s,safeToRemove:a})}const ZA={borderRadius:{...Kl,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Kl,borderTopRightRadius:Kl,borderBottomLeftRadius:Kl,borderBottomRightRadius:Kl,boxShadow:HA};function WA(t,s,a){const r=Ns(t)?t:Pi(t);return r.start(xg("",r,s,a)),r.animation}const YA=(t,s)=>t.depth-s.depth;class KA{constructor(){this.children=[],this.isDirty=!1}add(s){B0(this.children,s),this.isDirty=!0}remove(s){V0(this.children,s),this.isDirty=!0}forEach(s){this.isDirty&&this.children.sort(YA),this.isDirty=!1,this.children.forEach(s)}}function XA(t,s){const a=$s.now(),r=({timestamp:o})=>{const l=o-a;l>=s&&(mn(r),t(l-s))};return Mt.setup(r,!0),()=>mn(r)}const IN=["TopLeft","TopRight","BottomLeft","BottomRight"],QA=IN.length,Yw=t=>typeof t=="string"?parseFloat(t):t,Kw=t=>typeof t=="number"||We.test(t);function JA(t,s,a,r,o,l){o?(t.opacity=zt(0,a.opacity??1,eM(r)),t.opacityExit=zt(s.opacity??1,0,tM(r))):l&&(t.opacity=zt(s.opacity??1,a.opacity??1,r));for(let c=0;c<QA;c++){const u=`border${IN[c]}Radius`;let h=Xw(s,u),f=Xw(a,u);if(h===void 0&&f===void 0)continue;h||(h=0),f||(f=0),h===0||f===0||Kw(h)===Kw(f)?(t[u]=Math.max(zt(Yw(h),Yw(f),r),0),(Fa.test(f)||Fa.test(h))&&(t[u]+="%")):t[u]=f}(s.rotate||a.rotate)&&(t.rotate=zt(s.rotate||0,a.rotate||0,r))}function Xw(t,s){return t[s]!==void 0?t[s]:t.borderRadius}const eM=UN(0,.5,E1),tM=UN(.5,.95,da);function UN(t,s,a){return r=>r<t?0:r>s?1:a(wc(t,s,r))}function Qw(t,s){t.min=s.min,t.max=s.max}function oa(t,s){Qw(t.x,s.x),Qw(t.y,s.y)}function Jw(t,s){t.translate=s.translate,t.scale=s.scale,t.originPoint=s.originPoint,t.origin=s.origin}function ej(t,s,a,r,o){return t-=s,t=Gu(t,1/a,r),o!==void 0&&(t=Gu(t,1/o,r)),t}function sM(t,s=0,a=1,r=.5,o,l=t,c=t){if(Fa.test(s)&&(s=parseFloat(s),s=zt(c.min,c.max,s/100)-c.min),typeof s!="number")return;let u=zt(l.min,l.max,r);t===l&&(u-=s),t.min=ej(t.min,s,a,u,o),t.max=ej(t.max,s,a,u,o)}function tj(t,s,[a,r,o],l,c){sM(t,s[a],s[r],s[o],s.scale,l,c)}const aM=["x","scaleX","originX"],rM=["y","scaleY","originY"];function sj(t,s,a,r){tj(t.x,s,aM,a?a.x:void 0,r?r.x:void 0),tj(t.y,s,rM,a?a.y:void 0,r?r.y:void 0)}function aj(t){return t.translate===0&&t.scale===1}function BN(t){return aj(t.x)&&aj(t.y)}function rj(t,s){return t.min===s.min&&t.max===s.max}function nM(t,s){return rj(t.x,s.x)&&rj(t.y,s.y)}function nj(t,s){return Math.round(t.min)===Math.round(s.min)&&Math.round(t.max)===Math.round(s.max)}function VN(t,s){return nj(t.x,s.x)&&nj(t.y,s.y)}function oj(t){return Ts(t.x)/Ts(t.y)}function ij(t,s){return t.translate===s.translate&&t.scale===s.scale&&t.originPoint===s.originPoint}class oM{constructor(){this.members=[]}add(s){B0(this.members,s),s.scheduleRender()}remove(s){if(V0(this.members,s),s===this.prevLead&&(this.prevLead=void 0),s===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(s){const a=this.members.findIndex(o=>s===o);if(a===0)return!1;let r;for(let o=a;o>=0;o--){const l=this.members[o];if(l.isPresent!==!1){r=l;break}}return r?(this.promote(r),!0):!1}promote(s,a){const r=this.lead;if(s!==r&&(this.prevLead=r,this.lead=s,s.show(),r)){r.instance&&r.scheduleRender(),s.scheduleRender(),s.resumeFrom=r,a&&(s.resumeFrom.preserveOpacity=!0),r.snapshot&&(s.snapshot=r.snapshot,s.snapshot.latestValues=r.animationValues||r.latestValues),s.root&&s.root.isUpdating&&(s.isLayoutDirty=!0);const{crossfade:o}=s.options;o===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(s=>{const{options:a,resumingFrom:r}=s;a.onExitComplete&&a.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(s=>{s.instance&&s.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function iM(t,s,a){let r="";const o=t.x.translate/s.x,l=t.y.translate/s.y,c=(a==null?void 0:a.z)||0;if((o||l||c)&&(r=`translate3d(${o}px, ${l}px, ${c}px) `),(s.x!==1||s.y!==1)&&(r+=`scale(${1/s.x}, ${1/s.y}) `),a){const{transformPerspective:f,rotate:p,rotateX:g,rotateY:v,skewX:b,skewY:_}=a;f&&(r=`perspective(${f}px) ${r}`),p&&(r+=`rotate(${p}deg) `),g&&(r+=`rotateX(${g}deg) `),v&&(r+=`rotateY(${v}deg) `),b&&(r+=`skewX(${b}deg) `),_&&(r+=`skewY(${_}deg) `)}const u=t.x.scale*s.x,h=t.y.scale*s.y;return(u!==1||h!==1)&&(r+=`scale(${u}, ${h})`),r||"none"}const gp=["","X","Y","Z"],lM=1e3;let cM=0;function xp(t,s,a,r){const{latestValues:o}=s;o[t]&&(a[t]=o[t],s.setStaticValue(t,0),r&&(r[t]=0))}function qN(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:s}=t.options;if(!s)return;const a=kN(s);if(window.MotionHasOptimisedAnimation(a,"transform")){const{layout:o,layoutId:l}=t.options;window.MotionCancelOptimisedAnimation(a,"transform",Mt,!(o||l))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&qN(r)}function FN({attachResizeListener:t,defaultParent:s,measureScroll:a,checkIsScrollRoot:r,resetTransform:o}){return class{constructor(c={},u=s==null?void 0:s()){this.id=cM++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(mM),this.nodes.forEach(gM),this.nodes.forEach(xM),this.nodes.forEach(hM)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=c,this.root=u?u.root||u:this,this.path=u?[...u.path,u]:[],this.parent=u,this.depth=u?u.depth+1:0;for(let h=0;h<this.path.length;h++)this.path[h].shouldResetTransform=!0;this.root===this&&(this.nodes=new KA)}addEventListener(c,u){return this.eventHandlers.has(c)||this.eventHandlers.set(c,new H0),this.eventHandlers.get(c).add(u)}notifyListeners(c,...u){const h=this.eventHandlers.get(c);h&&h.notify(...u)}hasListeners(c){return this.eventHandlers.has(c)}mount(c){if(this.instance)return;this.isSVG=nN(c)&&!tT(c),this.instance=c;const{layoutId:u,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(c),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(h||u)&&(this.isLayoutDirty=!0),t){let p,g=0;const v=()=>this.root.updateBlockedByResize=!1;Mt.read(()=>{g=window.innerWidth}),t(c,()=>{const b=window.innerWidth;b!==g&&(g=b,this.root.updateBlockedByResize=!0,p&&p(),p=XA(v,250),Ru.hasAnimatedSinceResize&&(Ru.hasAnimatedSinceResize=!1,this.nodes.forEach(dj)))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||h)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:g,hasRelativeLayoutChanged:v,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||f.getDefaultTransition()||jM,{onLayoutAnimationStart:w,onLayoutAnimationComplete:E}=f.getProps(),T=!this.targetLayout||!VN(this.targetLayout,b),N=!g&&v;if(this.options.layoutRoot||this.resumeFrom||N||g&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const k={...rg(_,"layout"),onPlay:w,onComplete:E};(f.shouldReduceMotion||this.options.layoutRoot)&&(k.delay=0,k.type=!1),this.startAnimation(k),this.setAnimationOrigin(p,N)}else g||dj(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const c=this.getStack();c&&c.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),mn(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(yM),this.animationId++)}getTransformTemplate(){const{visualElement:c}=this.options;return c&&c.getProps().transformTemplate}willUpdate(c=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&qN(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let p=0;p<this.path.length;p++){const g=this.path[p];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:u,layout:h}=this.options;if(u===void 0&&!h)return;const f=this.getTransformTemplate();this.prevTransformTemplateValue=f?f(this.latestValues,""):void 0,this.updateSnapshot(),c&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(lj);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(cj);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(pM),this.nodes.forEach(dM),this.nodes.forEach(uM)):this.nodes.forEach(cj),this.clearAllSnapshots();const u=$s.now();vs.delta=Er(0,1e3/60,u-vs.timestamp),vs.timestamp=u,vs.isProcessing=!0,np.update.process(vs),np.preRender.process(vs),np.render.process(vs),vs.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,og.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(fM),this.sharedNodes.forEach(bM)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,Mt.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){Mt.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Ts(this.snapshot.measuredBox.x)&&!Ts(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let h=0;h<this.path.length;h++)this.path[h].updateScroll();const c=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ht(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:u}=this.options;u&&u.notify("LayoutMeasure",this.layout.layoutBox,c?c.layoutBox:void 0)}updateScroll(c="measure"){let u=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===c&&(u=!1),u&&this.instance){const h=r(this.instance);this.scroll={animationId:this.root.animationId,phase:c,isRoot:h,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:h}}}resetTransform(){if(!o)return;const c=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,u=this.projectionDelta&&!BN(this.projectionDelta),h=this.getTransformTemplate(),f=h?h(this.latestValues,""):void 0,p=f!==this.prevTransformTemplateValue;c&&this.instance&&(u||Vn(this.latestValues)||p)&&(o(this.instance,f),this.shouldResetTransform=!1,this.scheduleRender())}measure(c=!0){const u=this.measurePageBox();let h=this.removeElementScroll(u);return c&&(h=this.removeTransform(h)),_M(h),{animationId:this.root.animationId,measuredBox:u,layoutBox:h,latestValues:{},source:this.id}}measurePageBox(){var f;const{visualElement:c}=this.options;if(!c)return Ht();const u=c.measureViewportBox();if(!(((f=this.scroll)==null?void 0:f.wasRoot)||this.path.some(NM))){const{scroll:p}=this.root;p&&(vi(u.x,p.offset.x),vi(u.y,p.offset.y))}return u}removeElementScroll(c){var h;const u=Ht();if(oa(u,c),(h=this.scroll)!=null&&h.wasRoot)return u;for(let f=0;f<this.path.length;f++){const p=this.path[f],{scroll:g,options:v}=p;p!==this.root&&g&&v.layoutScroll&&(g.wasRoot&&oa(u,c),vi(u.x,g.offset.x),vi(u.y,g.offset.y))}return u}applyTransform(c,u=!1){const h=Ht();oa(h,c);for(let f=0;f<this.path.length;f++){const p=this.path[f];!u&&p.options.layoutScroll&&p.scroll&&p!==p.root&&wi(h,{x:-p.scroll.offset.x,y:-p.scroll.offset.y}),Vn(p.latestValues)&&wi(h,p.latestValues)}return Vn(this.latestValues)&&wi(h,this.latestValues),h}removeTransform(c){const u=Ht();oa(u,c);for(let h=0;h<this.path.length;h++){const f=this.path[h];if(!f.instance||!Vn(f.latestValues))continue;r0(f.latestValues)&&f.updateSnapshot();const p=Ht(),g=f.measurePageBox();oa(p,g),sj(u,f.latestValues,f.snapshot?f.snapshot.layoutBox:void 0,p)}return Vn(this.latestValues)&&sj(u,this.latestValues),u}setTargetDelta(c){this.targetDelta=c,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(c){this.options={...this.options,...c,crossfade:c.crossfade!==void 0?c.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==vs.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(c=!1){var v;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(c||h&&this.isSharedProjectionDirty||this.isProjectionDirty||(v=this.parent)!=null&&v.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:g}=this.options;if(!(!this.layout||!(p||g))){if(this.resolvedRelativeTargetAt=vs.timestamp,!this.targetDelta&&!this.relativeTarget){const b=this.getClosestProjectingParent();b&&b.layout&&this.animationProgress!==1?(this.relativeParent=b,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ht(),this.relativeTargetOrigin=Ht(),uc(this.relativeTargetOrigin,this.layout.layoutBox,b.layout.layoutBox),oa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Ht(),this.targetWithTransforms=Ht()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),AA(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):oa(this.target,this.layout.layoutBox),jN(this.target,this.targetDelta)):oa(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const b=this.getClosestProjectingParent();b&&!!b.resumingFrom==!!this.resumingFrom&&!b.options.layoutScroll&&b.target&&this.animationProgress!==1?(this.relativeParent=b,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ht(),this.relativeTargetOrigin=Ht(),uc(this.relativeTargetOrigin,this.target,b.target),oa(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||r0(this.parent.latestValues)||wN(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var _;const c=this.getLead(),u=!!this.resumingFrom||this!==c;let h=!0;if((this.isProjectionDirty||(_=this.parent)!=null&&_.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===vs.timestamp&&(h=!1),h)return;const{layout:f,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||p))return;oa(this.layoutCorrected,this.layout.layoutBox);const g=this.treeScale.x,v=this.treeScale.y;VT(this.layoutCorrected,this.treeScale,this.path,u),c.layout&&!c.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(c.target=c.layout.layoutBox,c.targetWithTransforms=Ht());const{target:b}=c;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(Jw(this.prevProjectionDelta.x,this.projectionDelta.x),Jw(this.prevProjectionDelta.y,this.projectionDelta.y)),dc(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==g||this.treeScale.y!==v||!ij(this.projectionDelta.x,this.prevProjectionDelta.x)||!ij(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(c=!0){var u;if((u=this.options.visualElement)==null||u.scheduleRender(),c){const h=this.getStack();h&&h.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=ji(),this.projectionDelta=ji(),this.projectionDeltaWithTransform=ji()}setAnimationOrigin(c,u=!1){const h=this.snapshot,f=h?h.latestValues:{},p={...this.latestValues},g=ji();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!u;const v=Ht(),b=h?h.source:void 0,_=this.layout?this.layout.source:void 0,w=b!==_,E=this.getStack(),T=!E||E.members.length<=1,N=!!(w&&!T&&this.options.crossfade===!0&&!this.path.some(wM));this.animationProgress=0;let k;this.mixTargetDelta=S=>{const C=S/1e3;uj(g.x,c.x,C),uj(g.y,c.y,C),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(uc(v,this.layout.layoutBox,this.relativeParent.layout.layoutBox),vM(this.relativeTarget,this.relativeTargetOrigin,v,C),k&&nM(this.relativeTarget,k)&&(this.isProjectionDirty=!1),k||(k=Ht()),oa(k,this.relativeTarget)),w&&(this.animationValues=p,JA(p,f,this.latestValues,C,N,T)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=C},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(c){var u,h,f;this.notifyListeners("animationStart"),(u=this.currentAnimation)==null||u.stop(),(f=(h=this.resumingFrom)==null?void 0:h.currentAnimation)==null||f.stop(),this.pendingAnimation&&(mn(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=Mt.update(()=>{Ru.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=Pi(0)),this.currentAnimation=WA(this.motionValue,[0,1e3],{...c,velocity:0,isSync:!0,onUpdate:p=>{this.mixTargetDelta(p),c.onUpdate&&c.onUpdate(p)},onStop:()=>{},onComplete:()=>{c.onComplete&&c.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const c=this.getStack();c&&c.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(lM),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const c=this.getLead();let{targetWithTransforms:u,target:h,layout:f,latestValues:p}=c;if(!(!u||!h||!f)){if(this!==c&&this.layout&&f&&HN(this.options.animationType,this.layout.layoutBox,f.layoutBox)){h=this.target||Ht();const g=Ts(this.layout.layoutBox.x);h.x.min=c.target.x.min,h.x.max=h.x.min+g;const v=Ts(this.layout.layoutBox.y);h.y.min=c.target.y.min,h.y.max=h.y.min+v}oa(u,h),wi(u,p),dc(this.projectionDeltaWithTransform,this.layoutCorrected,u,p)}}registerSharedNode(c,u){this.sharedNodes.has(c)||this.sharedNodes.set(c,new oM),this.sharedNodes.get(c).add(u);const f=u.options.initialPromotionConfig;u.promote({transition:f?f.transition:void 0,preserveFollowOpacity:f&&f.shouldPreserveFollowOpacity?f.shouldPreserveFollowOpacity(u):void 0})}isLead(){const c=this.getStack();return c?c.lead===this:!0}getLead(){var u;const{layoutId:c}=this.options;return c?((u=this.getStack())==null?void 0:u.lead)||this:this}getPrevLead(){var u;const{layoutId:c}=this.options;return c?(u=this.getStack())==null?void 0:u.prevLead:void 0}getStack(){const{layoutId:c}=this.options;if(c)return this.root.sharedNodes.get(c)}promote({needsReset:c,transition:u,preserveFollowOpacity:h}={}){const f=this.getStack();f&&f.promote(this,h),c&&(this.projectionDelta=void 0,this.needsReset=!0),u&&this.setOptions({transition:u})}relegate(){const c=this.getStack();return c?c.relegate(this):!1}resetSkewAndRotation(){const{visualElement:c}=this.options;if(!c)return;let u=!1;const{latestValues:h}=c;if((h.z||h.rotate||h.rotateX||h.rotateY||h.rotateZ||h.skewX||h.skewY)&&(u=!0),!u)return;const f={};h.z&&xp("z",c,f,this.animationValues);for(let p=0;p<gp.length;p++)xp(`rotate${gp[p]}`,c,f,this.animationValues),xp(`skew${gp[p]}`,c,f,this.animationValues);c.render();for(const p in f)c.setStaticValue(p,f[p]),this.animationValues&&(this.animationValues[p]=f[p]);c.scheduleRender()}applyProjectionStyles(c,u){if(!this.instance||this.isSVG)return;if(!this.isVisible){c.visibility="hidden";return}const h=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,c.visibility="",c.opacity="",c.pointerEvents=Mu(u==null?void 0:u.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none";return}const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){this.options.layoutId&&(c.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,c.pointerEvents=Mu(u==null?void 0:u.pointerEvents)||""),this.hasProjected&&!Vn(this.latestValues)&&(c.transform=h?h({},""):"none",this.hasProjected=!1);return}c.visibility="";const p=f.animationValues||f.latestValues;this.applyTransformsToTarget();let g=iM(this.projectionDeltaWithTransform,this.treeScale,p);h&&(g=h(p,g)),c.transform=g;const{x:v,y:b}=this.projectionDelta;c.transformOrigin=`${v.origin*100}% ${b.origin*100}% 0`,f.animationValues?c.opacity=f===this?p.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:c.opacity=f===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const _ in Sc){if(p[_]===void 0)continue;const{correct:w,applyTo:E,isCSSVariable:T}=Sc[_],N=g==="none"?p[_]:w(p[_],f);if(E){const k=E.length;for(let S=0;S<k;S++)c[E[S]]=N}else T?this.options.visualElement.renderState.vars[_]=N:c[_]=N}this.options.layoutId&&(c.pointerEvents=f===this?Mu(u==null?void 0:u.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(c=>{var u;return(u=c.currentAnimation)==null?void 0:u.stop()}),this.root.nodes.forEach(lj),this.root.sharedNodes.clear()}}}function dM(t){t.updateLayout()}function uM(t){var a;const s=((a=t.resumeFrom)==null?void 0:a.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&s&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:o}=t.layout,{animationType:l}=t.options,c=s.source!==t.layout.source;l==="size"?ca(g=>{const v=c?s.measuredBox[g]:s.layoutBox[g],b=Ts(v);v.min=r[g].min,v.max=v.min+b}):HN(l,s.layoutBox,r)&&ca(g=>{const v=c?s.measuredBox[g]:s.layoutBox[g],b=Ts(r[g]);v.max=v.min+b,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[g].max=t.relativeTarget[g].min+b)});const u=ji();dc(u,r,s.layoutBox);const h=ji();c?dc(h,t.applyTransform(o,!0),s.measuredBox):dc(h,r,s.layoutBox);const f=!BN(u);let p=!1;if(!t.resumeFrom){const g=t.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:v,layout:b}=g;if(v&&b){const _=Ht();uc(_,s.layoutBox,v.layoutBox);const w=Ht();uc(w,r,b.layoutBox),VN(_,w)||(p=!0),g.options.layoutRoot&&(t.relativeTarget=w,t.relativeTargetOrigin=_,t.relativeParent=g)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:s,delta:h,layoutDelta:u,hasLayoutChanged:f,hasRelativeLayoutChanged:p})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function mM(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function hM(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function fM(t){t.clearSnapshot()}function lj(t){t.clearMeasurements()}function cj(t){t.isLayoutDirty=!1}function pM(t){const{visualElement:s}=t.options;s&&s.getProps().onBeforeLayoutMeasure&&s.notify("BeforeLayoutMeasure"),t.resetTransform()}function dj(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function gM(t){t.resolveTargetDelta()}function xM(t){t.calcProjection()}function yM(t){t.resetSkewAndRotation()}function bM(t){t.removeLeadSnapshot()}function uj(t,s,a){t.translate=zt(s.translate,0,a),t.scale=zt(s.scale,1,a),t.origin=s.origin,t.originPoint=s.originPoint}function mj(t,s,a,r){t.min=zt(s.min,a.min,r),t.max=zt(s.max,a.max,r)}function vM(t,s,a,r){mj(t.x,s.x,a.x,r),mj(t.y,s.y,a.y,r)}function wM(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const jM={duration:.45,ease:[.4,0,.1,1]},hj=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),fj=hj("applewebkit/")&&!hj("chrome/")?Math.round:da;function pj(t){t.min=fj(t.min),t.max=fj(t.max)}function _M(t){pj(t.x),pj(t.y)}function HN(t,s,a){return t==="position"||t==="preserve-aspect"&&!TA(oj(s),oj(a),.2)}function NM(t){var s;return t!==t.root&&((s=t.scroll)==null?void 0:s.wasRoot)}const SM=FN({attachResizeListener:(t,s)=>Ec(t,"resize",s),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),yp={current:void 0},GN=FN({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!yp.current){const t=new SM({});t.mount(window),t.setOptions({layoutScroll:!0}),yp.current=t}return yp.current},resetTransform:(t,s)=>{t.style.transform=s!==void 0?s:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),EM={pan:{Feature:FA},drag:{Feature:qA,ProjectionNode:GN,MeasureLayout:LN}};function gj(t,s,a){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",a==="Start");const o="onHover"+a,l=r[o];l&&Mt.postRender(()=>l(s,Bc(s)))}class CM extends gn{mount(){const{current:s}=this.node;s&&(this.unmount=Kk(s,(a,r)=>(gj(this.node,r,"Start"),o=>gj(this.node,o,"End"))))}unmount(){}}class kM extends gn{constructor(){super(...arguments),this.isActive=!1}onFocus(){let s=!1;try{s=this.node.current.matches(":focus-visible")}catch{s=!0}!s||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Lc(Ec(this.node.current,"focus",()=>this.onFocus()),Ec(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function xj(t,s,a){const{props:r}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",a==="Start");const o="onTap"+(a==="End"?"":a),l=r[o];l&&Mt.postRender(()=>l(s,Bc(s)))}class TM extends gn{mount(){const{current:s}=this.node;s&&(this.unmount=eT(s,(a,r)=>(xj(this.node,r,"Start"),(o,{success:l})=>xj(this.node,o,l?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const u0=new WeakMap,bp=new WeakMap,AM=t=>{const s=u0.get(t.target);s&&s(t)},MM=t=>{t.forEach(AM)};function RM({root:t,...s}){const a=t||document;bp.has(a)||bp.set(a,{});const r=bp.get(a),o=JSON.stringify(s);return r[o]||(r[o]=new IntersectionObserver(MM,{root:t,...s})),r[o]}function OM(t,s,a){const r=RM(s);return u0.set(t,a),r.observe(t),()=>{u0.delete(t),r.unobserve(t)}}const DM={some:0,all:1};class PM extends gn{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:s={}}=this.node.getProps(),{root:a,margin:r,amount:o="some",once:l}=s,c={root:a?a.current:void 0,rootMargin:r,threshold:typeof o=="number"?o:DM[o]},u=h=>{const{isIntersecting:f}=h;if(this.isInView===f||(this.isInView=f,l&&!f&&this.hasEnteredView))return;f&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",f);const{onViewportEnter:p,onViewportLeave:g}=this.node.getProps(),v=f?p:g;v&&v(h)};return OM(this.node.current,c,u)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:s,prevProps:a}=this.node;["amount","margin","root"].some(zM(s,a))&&this.startObserver()}unmount(){}}function zM({viewport:t={}},{viewport:s={}}={}){return a=>t[a]!==s[a]}const $M={inView:{Feature:PM},tap:{Feature:TM},focus:{Feature:kM},hover:{Feature:CM}},LM={layout:{ProjectionNode:GN,MeasureLayout:LN}},IM={..._A,...$M,...EM,...LM},be=IT(IM,QT);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UM=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),BM=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,a,r)=>r?r.toUpperCase():a.toLowerCase()),yj=t=>{const s=BM(t);return s.charAt(0).toUpperCase()+s.slice(1)},ZN=(...t)=>t.filter((s,a,r)=>!!s&&s.trim()!==""&&r.indexOf(s)===a).join(" ").trim(),VM=t=>{for(const s in t)if(s.startsWith("aria-")||s==="role"||s==="title")return!0};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var qM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FM=y.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:o="",children:l,iconNode:c,...u},h)=>y.createElement("svg",{ref:h,...qM,width:s,height:s,stroke:t,strokeWidth:r?Number(a)*24/Number(s):a,className:ZN("lucide",o),...!l&&!VM(u)&&{"aria-hidden":"true"},...u},[...c.map(([f,p])=>y.createElement(f,p)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=(t,s)=>{const a=y.forwardRef(({className:r,...o},l)=>y.createElement(FM,{ref:l,iconNode:s,className:ZN(`lucide-${UM(yj(t))}`,`lucide-${t}`,r),...o}));return a.displayName=yj(t),a};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HM=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],WN=Ae("activity",HM);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GM=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],ZM=Ae("arrow-down-right",GM);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WM=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],fo=Ae("arrow-left",WM);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YM=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],Cc=Ae("arrow-right-left",YM);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KM=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],no=Ae("arrow-right",KM);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XM=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],QM=Ae("arrow-up-down",XM);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JM=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],eR=Ae("arrow-up-right",JM);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],sR=Ae("arrow-up",tR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],rR=Ae("award",aR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}]],YN=Ae("badge",nR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oR=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],iR=Ae("banknote",oR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lR=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]],cR=Ae("bell-ring",lR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dR=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],yg=Ae("bell",dR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uR=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],bj=Ae("building-2",uR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],hR=Ae("building",mR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fR=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],m0=Ae("calculator",fR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pR=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Mr=Ae("calendar",pR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gR=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],bg=Ae("chart-column",gR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xR=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],yR=Ae("chart-pie",xR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Zu=Ae("check",bR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vR=[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]],kc=Ae("chef-hat",vR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],jR=Ae("chevron-down",wR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _R=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],NR=Ae("chevron-right",_R);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ya=Ae("circle-alert",SR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ER=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],vj=Ae("circle-arrow-down",ER);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],wj=Ae("circle-arrow-up",CR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ts=Ae("circle-check-big",kR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],AR=Ae("circle-help",TR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],yr=Ae("circle-x",MR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Vt=Ae("clock",RR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OR=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],DR=Ae("coffee",OR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PR=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],La=Ae("copy",PR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zR=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Wi=Ae("credit-card",zR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $R=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],mc=Ae("database",$R);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LR=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],kt=Ae("dollar-sign",LR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IR=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],Vc=Ae("download",IR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UR=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],BR=Ae("external-link",UR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VR=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],fn=Ae("eye-off",VR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qR=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ws=Ae("eye",qR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FR=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],KN=Ae("file-text",FR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HR=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],vg=Ae("funnel",HR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GR=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],ZR=Ae("history",GR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WR=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],YR=Ae("house",WR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],XN=Ae("info",KR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XR=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],jr=Ae("key",XR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QR=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],JR=Ae("layout-dashboard",QR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eO=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],tO=Ae("loader",eO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sO=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]],jj=Ae("lock-open",sO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aO=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],dn=Ae("lock",aO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rO=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],nO=Ae("log-out",rO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oO=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],ki=Ae("mail",oO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iO=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],qc=Ae("map-pin",iO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lO=[["path",{d:"M5 12h14",key:"1ays0h"}]],$i=Ae("minus",lO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cO=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],ua=Ae("package",cO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dO=[["line",{x1:"19",x2:"5",y1:"5",y2:"19",key:"1x9vlm"}],["circle",{cx:"6.5",cy:"6.5",r:"2.5",key:"4mh3h7"}],["circle",{cx:"17.5",cy:"17.5",r:"2.5",key:"1mdrzq"}]],uO=Ae("percent",dO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mO=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Wu=Ae("phone",mO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hO=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Zs=Ae("plus",hO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fO=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],pO=Ae("printer",fO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gO=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],xO=Ae("receipt",gO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yO=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],_a=Ae("refresh-cw",yO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bO=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],vO=Ae("rotate-ccw",bO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wO=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],oo=Ae("save",wO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jO=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Ka=Ae("search",jO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _O=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],NO=Ae("send",_O);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SO=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Li=Ae("settings",SO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EO=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],CO=Ae("share-2",EO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kO=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],_i=Ae("shield",kO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TO=[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]],h0=Ae("shopping-bag",TO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AO=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],pn=Ae("shopping-cart",AO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MO=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],io=Ae("smartphone",MO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RO=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],lo=Ae("square-pen",RO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OO=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],f0=Ae("star",OO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],QN=Ae("target",DO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PO=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],_j=Ae("timer",PO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zO=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Fc=Ae("trash-2",zO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $O=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Yu=Ae("trending-down",$O);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LO=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],ma=Ae("trending-up",LO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IO=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],mt=Ae("triangle-alert",IO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UO=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],JN=Ae("user-check",UO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BO=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Ou=Ae("user-plus",BO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VO=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ys=Ae("user",VO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qO=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ss=Ae("users",qO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FO=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],p0=Ae("wifi-off",FO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HO=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],wg=Ae("wifi",HO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GO=[["path",{d:"M8 22h8",key:"rmew8v"}],["path",{d:"M7 10h10",key:"1101jm"}],["path",{d:"M12 15v7",key:"t2xh3l"}],["path",{d:"M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5Z",key:"10ffi3"}]],Tc=Ae("wine",GO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZO=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],lt=Ae("x",ZO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WO=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],kr=Ae("zap",WO),YO=({message:t="Carregando sesso...",showLogo:s=!0})=>e.jsxs("div",{className:"fixed inset-0 bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`radial-gradient(circle at 25% 25%, rgba(59, 130, 246, 0.3) 0%, transparent 50%),
                           radial-gradient(circle at 75% 75%, rgba(139, 92, 246, 0.3) 0%, transparent 50%)`}})}),e.jsxs(be.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},className:"text-center relative z-10",children:[s&&e.jsxs(be.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"mb-8",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-2xl",children:e.jsx(Ss,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"ClubManager Pro"}),e.jsx("p",{className:"text-blue-200",children:"Sistema de Gesto de Clubes"})]}),e.jsxs(be.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(be.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-12 h-12 border-4 border-blue-500/30 border-t-blue-500 rounded-full"}),e.jsx(be.div,{animate:{rotate:-360},transition:{duration:1.5,repeat:1/0,ease:"linear"},className:"absolute inset-2 w-8 h-8 border-2 border-purple-500/30 border-b-purple-500 rounded-full"})]}),e.jsx(be.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6},className:"text-white font-medium text-lg",children:t}),e.jsx(be.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"flex space-x-1",children:[0,1,2].map(a=>e.jsx(be.div,{animate:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0,delay:a*.2},className:"w-2 h-2 bg-blue-400 rounded-full"},a))})]}),e.jsx(be.div,{initial:{width:0},animate:{width:"100%"},transition:{duration:3,ease:"easeInOut"},className:"mt-8 h-1 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full mx-auto max-w-xs"}),e.jsx(be.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"text-blue-200 text-sm mt-4 max-w-md",children:"Verificando credenciais e carregando configuraes..."})]})]}),Nj={"admin@aabb.com":{password:"admin123",user:{id:"mock-admin-id",email:"admin@aabb.com",name:"Administrador",role:"admin",department:"Administrao",avatar:"https://api.dicebear.com/8.x/initials/svg?seed=Admin"}},"gerente@aabb.com":{password:"gerente123",user:{id:"mock-manager-id",email:"gerente@aabb.com",name:"Gerente",role:"manager",department:"Operaes",avatar:"https://api.dicebear.com/8.x/initials/svg?seed=Gerente"}},"funcionario@aabb.com":{password:"func123",user:{id:"mock-employee-id",email:"funcionario@aabb.com",name:"Funcionrio",role:"employee",department:"Bar",avatar:"https://api.dicebear.com/8.x/initials/svg?seed=Funcionario"}},"demo@clubmanager.com":{password:"demo123",user:{id:"mock-demo-id",email:"demo@clubmanager.com",name:"Usurio Demo",role:"admin",department:"Demo",avatar:"https://api.dicebear.com/8.x/initials/svg?seed=Demo"}}},Gn=class Gn{constructor(){dt(this,"currentUser",null);dt(this,"sessionKey","mock-auth-session");this.restoreSession()}static getInstance(){return Gn.instance||(Gn.instance=new Gn),Gn.instance}async signInWithPassword(s,a){await new Promise(o=>setTimeout(o,500));const r=Nj[s.toLowerCase()];return!r||r.password!==a?{user:null,session:null,error:{message:"Credenciais invlidas"}}:(this.currentUser=r.user,this.saveSession(),console.log(" Login mock realizado com sucesso:",r.user.name),{user:r.user,session:{access_token:"mock-access-token",refresh_token:"mock-refresh-token",user:r.user},error:null})}async signOut(){return this.currentUser=null,this.clearSession(),console.log(" Logout mock realizado"),{error:null}}getCurrentUser(){return this.currentUser}getSession(){return this.currentUser?{data:{session:{access_token:"mock-access-token",refresh_token:"mock-refresh-token",user:this.currentUser}}}:{data:{session:null}}}onAuthStateChange(s){return setTimeout(()=>{this.currentUser?s("SIGNED_IN",{access_token:"mock-access-token",user:this.currentUser}):s("SIGNED_OUT",null)},100),{data:{subscription:{unsubscribe:()=>console.log(" Mock auth listener removido")}}}}getAvailableUsers(){return Object.entries(Nj).map(([s,a])=>({email:s,password:a.password,name:a.user.name,role:a.user.role}))}saveSession(){this.currentUser&&localStorage.setItem(this.sessionKey,JSON.stringify(this.currentUser))}restoreSession(){var s;try{const a=localStorage.getItem(this.sessionKey);a&&(this.currentUser=JSON.parse(a),console.log(" Sesso mock restaurada:",(s=this.currentUser)==null?void 0:s.name))}catch(a){console.warn("Erro ao restaurar sesso mock:",a),this.clearSession()}}clearSession(){localStorage.removeItem(this.sessionKey)}};dt(Gn,"instance");let g0=Gn;const x0=g0.getInstance(),e2=y.createContext(void 0),Et=()=>{const t=y.useContext(e2);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},KO=({children:t})=>{const[s,a]=y.useState(null),[r,o]=y.useState(!0),[l,c]=y.useState(!1),[u,h]=y.useState(null),f=async()=>{if(!u)return c(!1),!0;try{const w=await fetch("https://www.google.com/favicon.ico",{method:"HEAD",mode:"no-cors",cache:"no-cache"});return c(!1),!0}catch{return c(!0),!1}};y.useEffect(()=>{(async()=>{console.log(" Inicializando autenticao simples...");const E=setTimeout(()=>{console.log(" Safety timeout - forando carregamento"),o(!1)},2e3);try{const T=await ku();if(h(T),!T){console.log(" Modo demo ativo - Supabase no configurado"),clearTimeout(E),o(!1);return}await V.auth.signOut(),console.log(" Sesso limpa, pronto para login"),clearTimeout(E),o(!1)}catch(T){console.log(" Erro na inicializao, continuando...",T),clearTimeout(E),o(!1)}})()},[]);const p=async(w,E)=>{var k,S;if(!await ku()){console.log(" Usando sistema de autenticao mock");try{const{user:C,error:M}=await x0.signInWithPassword(w,E);if(M)return{success:!1,error:M.message};if(C){const z={id:C.id,name:C.name,email:C.email,role:C.role,department:C.department,avatar:C.avatar};return a(z),{success:!0,error:null}}}catch{return{success:!1,error:"Erro no sistema de autenticao mock"}}}try{const{data:C,error:M}=await V.auth.signInWithPassword({email:w,password:E});if(M)return{success:!1,error:M.message};if(C.user)try{const{data:z,error:A}=await V.from("profiles").select("*").eq("id",C.user.id).single();if(A){console.warn("Erro ao buscar perfil:",A);const $={id:C.user.id,name:((k=C.user.email)==null?void 0:k.split("@")[0])||"Usurio",email:C.user.email,role:"employee",avatar:`https://api.dicebear.com/8.x/initials/svg?seed=${C.user.email}`};a($)}else if(z){const $={id:z.id,name:z.name||C.user.email||"Usurio",email:C.user.email,role:z.role||"employee",avatar:z.avatar_url||`https://api.dicebear.com/8.x/initials/svg?seed=${z.name}`};a($)}}catch(z){console.error("Erro ao buscar perfil:",z);const A={id:C.user.id,name:((S=C.user.email)==null?void 0:S.split("@")[0])||"Usurio",email:C.user.email,role:"employee",avatar:`https://api.dicebear.com/8.x/initials/svg?seed=${C.user.email}`};a(A)}return{success:!0,error:null}}catch{return{success:!1,error:"Erro de conexo"}}},g=async(w,E,T)=>{if(!u)return{success:!1,error:"Registro no disponvel no modo demo"};try{console.log(" Registrando usurio:",E);const{data:N,error:k}=await V.auth.signUp({email:E,password:T,options:{data:{name:w,role:"admin"}}});if(k)return console.error("Erro no signup:",k),{success:!1,error:k.message};if(N.user){console.log(" Usurio registrado com sucesso"),await new Promise(S=>setTimeout(S,1e3));try{console.log(" Iniciando criao da empresa..."),await v(N.user.id,w,E),console.log(" Empresa criada com sucesso")}catch(S){console.error(" Erro ao criar empresa:",S),console.error("Stack trace:",S),alert(`Usurio criado, mas houve erro ao criar empresa: ${S.message||S}`)}return{success:!0,error:null}}return{success:!1,error:"Erro desconhecido no registro"}}catch(N){return console.error("Erro no registro:",N),{success:!1,error:"Erro de conexo"}}},v=async(w,E,T)=>{try{console.log(" Criando empresa para o usurio...",{userId:w,userName:E,userEmail:T});const N=Date.now(),k=String(N).slice(-14).padStart(14,"0");console.log(" CNPJ gerado:",k),console.log(" Inserindo empresa na tabela...");const{data:S,error:C}=await V.from("empresas").insert([{nome:`Empresa de ${E}`,cnpj:k,email_admin:T,telefone:"",plano:"premium",status:"ativo"}]).select().single();if(C)throw console.error(" Erro ao criar empresa:",C),new Error(`Erro ao criar empresa: ${C.message}`);console.log(" Empresa criada:",S),console.log(" Criando registro na tabela usuarios_empresa...");const{data:M,error:z}=await V.from("usuarios_empresa").insert([{user_id:w,empresa_id:S.id,nome_completo:E,email:T,tipo_usuario:"administrador",papel:"SUPER_ADMIN",is_primeiro_usuario:!0,ativo:!0,tem_acesso_sistema:!0}]).select().single();if(z)throw console.error(" Erro ao criar usurio empresa:",z),new Error(`Erro ao criar usurio empresa: ${z.message}`);console.log(" Usurio empresa criado:",M),console.log(" Criando permisses bsicas...");const A=[{modulo:"dashboard",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0}},{modulo:"configuracoes",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0}}],{error:$}=await V.from("permissoes_usuario").insert(A.map(P=>({usuario_empresa_id:M.id,modulo:P.modulo,permissoes:P.permissoes})));$?console.error(" Erro ao criar permisses:",$):console.log(" Permisses criadas com sucesso"),console.log(" Empresa e dados complementares criados com sucesso!")}catch(N){throw console.error("Erro ao criar empresa:",N),N}},b=async()=>{const w={id:"demo-user-id",name:cu.DEMO_USER.name,email:cu.DEMO_USER.email,role:cu.DEMO_USER.role,avatar:"https://api.dicebear.com/8.x/initials/svg?seed=Demo"};return a(w),{success:!0,error:null}},_=async()=>{!await ku()?(console.log(" Logout do sistema mock"),await x0.signOut()):await V.auth.signOut(),a(null)};return e.jsxs(e2.Provider,{value:{user:s,login:p,register:g,loginAsDemo:b,logout:_,isLoading:r,isOffline:l,checkOnlineStatus:f},children:[u===!1&&e.jsxs("div",{className:"fixed top-0 left-0 right-0 bg-yellow-500 text-black px-4 py-2 text-sm z-50",children:[" ",e.jsx("strong",{children:"Modo Desenvolvimento:"})," Supabase no configurado. Use: ",cu.DEMO_USER.email," / demo123456"]}),r?e.jsx(YO,{message:"Inicializando sistema..."}):t]})},t2=y.createContext(void 0),s2=()=>{const t=y.useContext(t2);if(t===void 0)throw new Error("useMultitenantAuth must be used within a MultitenantAuthProvider");return t},XO=({children:t})=>{const[s,a]=y.useState(null),[r,o]=y.useState(null),[l,c]=y.useState({}),[u,h]=y.useState(!1),[f,p]=y.useState(!1),g=async(T,N)=>(console.log(" Modo simplificado - login mock"),{success:!1,error:"Use o login principal"}),v=async T=>{console.log(" Modo simplificado - registrarEmpresa redirecionando para servio principal");const{RegistroEmpresaService:N}=await Sa(async()=>{const{RegistroEmpresaService:S}=await import("./registroEmpresaService-pXYhav0c.js");return{RegistroEmpresaService:S}},[]),k=await N.registrarEmpresa(T);return k.success&&k.empresa&&k.usuario?{success:!0,data:{empresa:k.empresa,usuario:k.usuario}}:{success:!1,error:k.error||"Erro desconhecido no registro"}},b=async()=>{a(null),o(null),c({}),p(!1)},_=(T,N)=>!0,w=T=>({modulo:T,pode_ler:!0,pode_criar:!0,pode_editar:!0,pode_excluir:!0,pode_gerenciar:!0}),E=async()=>{console.log(" Modo simplificado - refreshUserData mock")};return e.jsx(t2.Provider,{value:{user:s,empresa:r,permissoes:l,isLoading:u,isAuthenticated:f,login:g,registrarEmpresa:v,logout:b,hasPermission:_,getModulePermissions:w,refreshUserData:E},children:t})},Ac=async()=>{try{const{data:{session:t}}=await V.auth.getSession();return t!=null&&t.user?(console.log(" User already authenticated:",t.user.email),{success:!0,user:t.user}):(console.log(" No active session found. Using admin client for database operations."),{success:!0,user:null,useAdmin:!0})}catch(t){return console.error(" Authentication error:",t),{success:!1,error:"Authentication failed"}}},bt=async()=>{var t,s,a,r,o,l,c,u;try{const{data:{session:h}}=await V.auth.getSession();if(!(h!=null&&h.user))return console.warn(" No authenticated user found"),null;const f=h.user.id,p=h.user.email;console.log(` Buscando empresa_id para usurio: ${p} (${f})`);const{data:g,error:v}=await V.from("usuarios_empresa").select("empresa_id, nome_completo, cargo").eq("user_id",f).eq("ativo",!0).limit(1);if(v)console.error(" Error getting empresa_id from usuarios_empresa:",v.message);else if(g&&g.length>0){const T=(t=g[0])==null?void 0:t.empresa_id;return console.log(` Empresa ID encontrado em usuarios_empresa: ${T}`),console.log(` Dados do usurio: ${(s=g[0])==null?void 0:s.nome_completo} - ${(a=g[0])==null?void 0:a.cargo}`),T||null}console.warn(" Usurio no encontrado em usuarios_empresa, tentando via email_admin");const{data:b,error:_}=await V.from("empresas").select("id, nome").eq("email_admin",p).eq("status","ativo").limit(1);if(_)console.error(" Error getting empresa by email:",_.message);else if(b&&b.length>0){const T=(r=b[0])==null?void 0:r.id,N=(o=b[0])==null?void 0:o.nome;console.log(` Empresa encontrada via email_admin: ${T} (${N})`);try{await V.from("usuarios_empresa").insert({user_id:f,empresa_id:T,nome_completo:((l=h.user.user_metadata)==null?void 0:l.name)||(p==null?void 0:p.split("@")[0])||"Usurio",email:p,tipo_usuario:"administrador",cargo:"Administrador",status:"ativo",ativo:!0,tem_acesso_sistema:!0}),console.log(` Registro criado em usuarios_empresa para ${p}`)}catch(k){console.warn(" No foi possvel criar registro em usuarios_empresa:",k)}return T}console.warn(" FALLBACK DE EMERGNCIA: Buscando primeira empresa ativa"),console.warn(` USURIO SEM EMPRESA: ${p} no est associado a nenhuma empresa`);const{data:w,error:E}=await V.from("empresas").select("id, nome").eq("status","ativo").order("created_at",{ascending:!0}).limit(1);if(E)return console.error(" Error getting first empresa:",E.message),null;if(w&&w.length>0){const T=(c=w[0])==null?void 0:c.id,N=(u=w[0])==null?void 0:u.nome;return console.warn(` USANDO FALLBACK DE EMERGNCIA: ${T} (${N})`),console.warn(` AO REQUERIDA: Associar usurio ${p}  empresa correta`),T}return console.error(" ERRO CRTICO: Nenhuma empresa encontrada no sistema"),null}catch(h){return console.error(" Error in getCurrentUserEmpresaId:",h),null}},fu=t=>({id:t.id,name:t.name,categoryId:t.category_id||void 0,currentStock:t.current_stock,minStock:t.min_stock,unit:t.unit,lastUpdated:new Date(t.last_updated||t.created_at),supplier:t.supplier||void 0,cost:t.cost||0,availableForSale:t.available_for_sale||!1,image_url:t.image_url||void 0,salePrice:t.sale_price||void 0,marginPercentage:t.margin_percentage||void 0,pricingMethod:t.pricing_method||"margin"}),QO=t=>({id:t.id,name:t.name,description:t.description||void 0,color:t.color||"#6B7280",icon:t.icon||void 0,isActive:t.is_active||!0,createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at||t.created_at)}),vp=t=>({id:t.id,name:t.name,email:t.email,phone:t.phone||"",avatar:t.avatar_url||`https://api.dicebear.com/8.x/initials/svg?seed=${t.name}`,status:t.status,joinDate:new Date(t.join_date),membershipType:t.membership_type||"basic"}),wp=t=>{const s=t.item_type==="direct",a=t.inventory_items;return{id:t.id,name:s&&(a!=null&&a.name)?a.name:t.name,description:t.description||"",price:t.price,category:t.category,image_url:s&&(a!=null&&a.image_url)?a.image_url:t.image_url||void 0,available:t.available,preparation_time:t.preparation_time||void 0,item_type:t.item_type||"prepared",direct_inventory_item_id:t.direct_inventory_item_id||void 0,costPerServing:t.cost_per_serving||void 0,marginPercentage:t.margin_percentage||void 0,pricingMethod:t.pricing_method||"margin"}},Sj=t=>({id:t.id,tableNumber:t.table_number||void 0,items:t.order_items.map(s=>({id:s.id.toString(),menuItemId:s.menu_item_id,quantity:s.quantity,price:s.price,notes:s.notes||void 0})),status:t.status,total:t.total,createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at||t.created_at),employeeId:t.employee_id||"",notes:t.notes||void 0}),a2=y.createContext(void 0),Tt=()=>{const t=y.useContext(a2);if(t===void 0)throw new Error("useApp must be used within an AppProvider");return t},JO=({children:t})=>{console.log(" AppProvider MONTADO ");const{user:s}=Et(),[a,r]=y.useState([]),[o,l]=y.useState([]),[c,u]=y.useState([]),[h,f]=y.useState([]),[p,g]=y.useState([]),[v,b]=y.useState([]);y.useEffect(()=>{(async()=>{var Y;if(!s){console.log("AppContext: Usurio no autenticado, no carregando dados");return}try{const{data:ne,error:ie}=await V.from("usuarios_empresa").select("empresa_id").eq("user_id",s.id).eq("ativo",!0).single();if(ie||!ne){console.error("AppContext: Erro ao buscar empresa do usurio:",ie);return}const oe=ne.empresa_id;console.log("AppContext: Carregando dados para empresa:",oe);const me=await V.rpc("get_low_stock_items",{limit_count:10}),D=await V.from("inventory_categories").select("*").eq("empresa_id",oe).eq("is_active",!0).order("name");console.log("AppContext: Categorias carregadas:",((Y=D.data)==null?void 0:Y.length)||0),me.data&&u(me.data.map(fu)),D.data&&f(D.data.map(QO))}catch(ne){console.error("AppContext: Erro ao carregar dados:",ne)}})()},[s]),y.useEffect(()=>{const B=async ie=>{var D,q;const{data:oe,error:me}=await V.from("orders").select("*, order_items(*)").order("created_at",{ascending:!1});if(me)console.error("Error fetching orders after realtime event:",me);else if(oe){const Q=oe.map(Sj);l(Q),ie.eventType!=="INSERT"&&A(`Pedido #${(q=(D=ie.new)==null?void 0:D.id)==null?void 0:q.slice(0,4)} atualizado para ${ie.new.status}`)}},Y=V.channel("realtime-orders").on("postgres_changes",{event:"*",schema:"public",table:"orders"},B).subscribe();return(async()=>{const{data:ie,error:oe}=await V.from("orders").select("*, order_items(*)").order("created_at",{ascending:!1});oe?console.error("Error fetching initial orders:",oe):ie&&l(ie.map(Sj))})(),()=>{V.removeChannel(Y)}},[]);const _=async B=>{console.log("=== addMenuItem INICIADO ==="),console.log("Dados recebidos:",B);const Y=await bt();if(!Y)throw new Error("No foi possvel identificar a empresa do usurio");const ne={name:B.name,description:B.description||null,price:B.price,category:B.category,available:B.available,preparation_time:B.preparation_time||null,item_type:B.item_type||"prepared",direct_inventory_item_id:B.direct_inventory_item_id||null,image_url:B.image_url||null,empresa_id:Y};console.log("Dados formatados para Supabase:",ne);const{data:ie,error:oe}=await V.from("menu_items").insert(ne).select().single();if(console.log("Resposta do Supabase:"),console.log("- Data:",ie),console.log("- Error:",oe),oe)throw console.error("=== ERRO NO SUPABASE ==="),console.error("Cdigo do erro:",oe.code),console.error("Mensagem do erro:",oe.message),console.error("Detalhes do erro:",oe.details),console.error("Hint do erro:",oe.hint),oe;ie&&(console.log("Item inserido com sucesso, atualizando estado..."),r(me=>[wp(ie),...me].sort((D,q)=>D.name.localeCompare(q.name))),A(`Novo prato "${ie.name}" adicionado ao cardpio!`),console.log("Estado atualizado com sucesso!")),console.log("=== addMenuItem FINALIZADO ===")},w=async B=>{const Y={name:B.name,description:B.description,price:B.price,category:B.category,available:B.available,preparation_time:B.preparation_time,item_type:B.item_type||"prepared",direct_inventory_item_id:B.direct_inventory_item_id||null,image_url:B.image_url||null},{data:ne,error:ie}=await V.from("menu_items").update(Y).eq("id",B.id).select().single();if(ie){console.error(ie);return}ne&&(r(oe=>oe.map(me=>me.id===ne.id?wp(ne):me).sort((me,D)=>me.name.localeCompare(D.name))),A(`Prato "${ne.name}" atualizado!`))},E=async B=>{const{error:Y}=await V.from("menu_items").delete().eq("id",B);if(Y){console.error(Y);return}r(ne=>ne.filter(ie=>ie.id!==B)),A("Prato removido do cardpio!")},T=async B=>{const{items:Y,tableNumber:ne,employeeId:ie,notes:oe,status:me}=B,D=Y.reduce((_e,Re)=>_e+Re.price*Re.quantity,0),q={table_number:ne,employee_id:ie,notes:oe,status:me,total:D},{data:Q,error:K}=await V.from("orders").insert(q).select().single();if(K||!Q){console.error("Error creating order:",K);return}const he=Y.map(_e=>({order_id:Q.id,menu_item_id:_e.menuItemId,quantity:_e.quantity,price:_e.price,notes:_e.notes})),{error:we}=await V.from("order_items").insert(he);we?console.error("Error creating order items:",we):A(`Novo pedido #${Q.id.slice(0,4)} criado!`)},N=async(B,Y)=>{try{if(console.log(" updateOrderStatus chamado:",{orderId:B,status:Y}),B.startsWith("comanda-")){console.log(" Processando comanda com CommandManager");try{const{CommandManager:ne}=await Sa(async()=>{const{CommandManager:D}=await import("./command-manager-CiOJUmrX.js");return{CommandManager:D}},[]),ie=ne.getInstance(),oe=B.replace("comanda-","").split("-").slice(0,5).join("-");console.log(" Buscando comanda:",oe);let me=await ie.buscarComanda(oe);if(me||(console.log(" Comanda no encontrada, criando uma de teste"),me=await ie.criarComanda({funcionario_id:"user-demo",quantidade_pessoas:1,observacoes:`Comanda de teste para ${B}`}),await ie.adicionarItem(me.id,{produto_id:"prod-001",nome_produto:"Hambrguer Teste",quantidade:1,preco_unitario:25.9,observacoes:"Item de teste"}),me=await ie.buscarComanda(me.id)),me!=null&&me.itens){const D=me.itens.filter(q=>q.status==="pendente"||q.status==="preparando");console.log(` Atualizando ${D.length} itens da comanda`);for(const q of D){let Q;switch(Y){case"pending":Q="pendente";break;case"preparing":Q="preparando";break;case"ready":Q="pronto";break;case"delivered":Q="entregue";break;default:Q=Y}await ie.atualizarStatusItem(me.id,q.id,Q)}console.log(" Itens da comanda atualizados com sucesso!")}console.log(" Atualizando tambm no Supabase para refletir na interface...");try{const{data:D,error:q}=await V.from("comanda_items").select("*").eq("comanda_id",oe).in("status",["pending","preparing","ready"]);if(q)console.warn(" Erro ao buscar itens no Supabase:",q);else if(D&&D.length>0){const{error:Q}=await V.from("comanda_items").update({status:Y}).eq("comanda_id",oe).in("status",["pending","preparing","ready"]);Q?console.warn(" Erro ao atualizar no Supabase:",Q):console.log(" Supabase tambm atualizado!")}else console.log(" Nenhum item encontrado no Supabase para atualizar")}catch(D){console.warn(" Erro na sincronizao com Supabase:",D)}console.log(" Atualizando estado local para feedback imediato..."),l(D=>D.map(q=>q.id===B?{...q,status:Y,updatedAt:new Date}:q)),console.log(" Recarregando pedidos do servidor..."),await xe(),await ee(),console.log(" Processo completo finalizado!");return}catch(ne){console.error(" Erro no CommandManager:",ne),console.log(" Continuando com lgica original...")}}if(B.startsWith("balcao-")){const ne=B.replace("balcao-","");console.log("Atualizando pedido de balco:",ne);let ie;switch(Y){case"pending":ie="paid";break;case"preparing":ie="preparing";break;case"ready":ie="ready";break;default:ie=Y}const{error:oe}=await V.from("balcao_orders").update({status:ie,preparation_started_at:Y==="preparing"?new Date().toISOString():void 0,preparation_completed_at:Y==="ready"?new Date().toISOString():void 0}).eq("id",ne);if(oe)throw oe;console.log("Pedido de balco atualizado com sucesso")}else{console.log(" Processando comanda com CommandManager");const{CommandManager:ne}=await Sa(async()=>{const{CommandManager:q}=await import("./command-manager-CiOJUmrX.js");return{CommandManager:q}},[]),ie=ne.getInstance();let oe,me;if(B.startsWith("comanda-")){const q=B.replace("comanda-",""),Q=q.match(/^([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})-(.+)$/i);Q?(oe=Q[1],me=Q[2]):(oe=q,me="")}else{const q=B.split("-");oe=q.slice(0,5).join("-"),me=q.slice(5).join("-")}if(console.log("Decomposio do ID:",{orderId:B,realComandaId:oe,timeKey:me}),!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(oe))throw console.error("ID da comanda invlido:",oe),new Error(`ID da comanda invlido: ${oe}`);if(me){const q=me.split("-");console.log("Partes do timeKey:",q);const[Q,K,he,we,_e]=q.map(Number);if(console.log("Valores parseados:",{year:Q,month:K,day:he,hour:we,minute:_e}),isNaN(Q)||isNaN(K)||isNaN(he)||isNaN(we)||isNaN(_e))throw console.error(" Valores de data invlidos:",{year:Q,month:K,day:he,hour:we,minute:_e}),new Error(`Valores de data invlidos no timeKey: ${me}`);const{data:Re,error:ze}=await V.from("comanda_items").select("*").eq("comanda_id",oe).in("status",["pending","preparing","ready"]);if(ze)throw console.error("Erro na busca dos itens da comanda:",ze),ze;const Ie=(Re==null?void 0:Re.filter(Me=>{const $e=new Date(Me.added_at),Z=`${$e.getFullYear()}-${$e.getMonth()}-${$e.getDate()}-${$e.getHours()}-${$e.getMinutes()}`;return me===Z}))||[];if(console.log("Itens encontrados para atualizar:",Ie.length),Ie.length>0){const Me=Ie.map(Z=>Z.id);console.log("Atualizando itens:",Me,"para status:",Y);const{error:$e}=await V.from("comanda_items").update({status:Y}).in("id",Me);if($e)throw $e;console.log("Atualizao realizada com sucesso")}else console.log("Nenhum item encontrado para atualizar")}else{const{data:q,error:Q}=await V.from("comanda_items").select("*").eq("comanda_id",oe).in("status",["pending","preparing","ready"]).order("added_at",{ascending:!1});if(Q)throw console.error("Erro na busca dos itens da comanda:",Q),Q;if(q&&q.length>0){const K=q.map(we=>we.id);console.log("Atualizando todos os itens pendentes:",K,"para status:",Y);const{error:he}=await V.from("comanda_items").update({status:Y}).in("id",K);if(he)throw he;console.log("Atualizao realizada com sucesso")}else console.log("Nenhum item encontrado para atualizar")}}await xe(),await ee()}catch(ne){console.error("Erro ao atualizar status do pedido:",ne)}},k=async B=>{var K,he;if(console.log(" Adicionando item ao inventrio:",B),!s){console.error(" Usurio no autenticado"),alert("Voc precisa estar logado para adicionar itens");return}const{data:Y,error:ne}=await V.from("usuarios_empresa").select("empresa_id").eq("user_id",s.id).eq("ativo",!0).single();if(ne||!Y){console.error(" Erro ao buscar empresa do usurio:",ne),alert("Erro: No foi possvel identificar sua empresa. Entre em contato com o suporte.");return}const ie=Y.empresa_id;if(console.log(" Usando empresa do usurio logado:",ie),!B.name||!B.unit){console.error(" Dados obrigatrios faltando:",{name:B.name,unit:B.unit}),alert("Nome e unidade so obrigatrios!");return}const oe={name:B.name.trim(),category_id:B.categoryId||null,current_stock:Number(B.currentStock)||0,min_stock:Number(B.minStock)||0,unit:B.unit.trim(),cost:B.cost?Number(B.cost):null,supplier:((K=B.supplier)==null?void 0:K.trim())||null,available_for_sale:!!B.availableForSale,image_url:((he=B.image_url)==null?void 0:he.trim())||null,empresa_id:ie,sale_price:B.salePrice?Number(B.salePrice):null,margin_percentage:B.marginPercentage?Number(B.marginPercentage):null,pricing_method:B.pricingMethod||"margin"};console.log(" Dados para inserir (validados):",oe),console.log(" Verificando se item j existe...");const{data:me,error:D}=await V.from("inventory_items").select("id, name").eq("name",oe.name).eq("empresa_id",ie);if(D){console.error(" Erro ao verificar item existente:",D),alert("Erro ao verificar se o item j existe: "+D.message);return}if(me&&me.length>0){console.warn(" Item j existe:",me[0]),alert("J existe um item com este nome no inventrio!");return}console.log(" Nome disponvel, prosseguindo com insero..."),console.log(" Inserindo item...");const{data:q,error:Q}=await V.from("inventory_items").insert(oe).select().single();if(console.log(" Resultado da insero:",{data:q,error:Q}),Q){console.error(" Erro ao inserir item:",Q),console.error(" Detalhes completos do erro:",{code:Q.code,message:Q.message,details:Q.details,hint:Q.hint,statusCode:Q.statusCode,statusText:Q.statusText}),alert("Erro ao salvar produto: "+Q.message+" (Cdigo: "+Q.code+")");return}q&&(console.log(" Item inserido com sucesso!"),u(we=>[fu(q),...we].sort((_e,Re)=>_e.name.localeCompare(Re.name))))},S=async B=>{if(console.log(" Atualizando item do inventrio:",B),!s){console.error(" Usurio no autenticado"),alert("Voc precisa estar logado para atualizar itens");return}const{data:Y,error:ne}=await V.from("usuarios_empresa").select("empresa_id").eq("user_id",s.id).eq("ativo",!0).single();if(ne||!Y){console.error(" Erro ao buscar empresa do usurio:",ne),alert("Erro: No foi possvel identificar sua empresa. Entre em contato com o suporte.");return}const ie=Y.empresa_id,{data:oe}=await V.from("inventory_items").select("current_stock, cost").eq("id",B.id).single(),me=(oe==null?void 0:oe.current_stock)||0,D=(oe==null?void 0:oe.cost)||0,q=B.currentStock,Q=B.cost||0,K=B.isCorrection||!1;console.log(" Anlise da atualizao:",{estoqueAnterior:me,estoqueNovo:q,custoAnterior:D,custoNovo:Q,isCorrection:K,correctionNotes:B.correctionNotes});const he={name:B.name,category_id:B.categoryId,current_stock:B.currentStock,min_stock:B.minStock,unit:B.unit,cost:B.cost,supplier:B.supplier,available_for_sale:B.availableForSale||!1,image_url:B.image_url||null,last_updated:new Date().toISOString(),empresa_id:ie,sale_price:B.salePrice?Number(B.salePrice):null,margin_percentage:B.marginPercentage?Number(B.marginPercentage):null,pricing_method:B.pricingMethod||"margin"};console.log(" Dados para atualizar:",he);const{data:we,error:_e}=await V.from("inventory_items").update(he).eq("id",B.id).select().single();if(console.log(" Resultado da atualizao:",{data:we,error:_e}),_e){console.error(" Erro ao atualizar item:",_e),alert("Erro ao atualizar produto: "+_e.message);return}if(we){console.log(" Item atualizado com sucesso!");const Re=q!==me,ze=Q!==D;if(Re||ze){if(console.log(" Registrando movimentao:",{stockChanged:Re,costChanged:ze,isCorrection:K,estoqueAnterior:me,estoqueNovo:q,custoAnterior:D,custoNovo:Q}),K){console.log(" Processando como CORREO - apenas registrando histrico");const Ie=B.correctionNotes||"Correo de valores via edio de item";Re&&(console.log(" Registrando movimentao de correo no histrico"),await(async()=>{try{console.log(" Dados da movimentao de correo:",{empresa_id:ie,inventory_item_id:B.id,movement_type:"entrada_ajuste",quantity:0,unit_cost:Q||null,total_cost:0,stock_before:me,stock_after:q,notes:`CORREO - ${Ie} | Estoque: ${me}  ${q}`,created_by:s.id});const{data:$e,error:Z}=await V.from("inventory_movements").insert({empresa_id:ie,inventory_item_id:B.id,movement_type:"entrada_ajuste",quantity:.001,unit_cost:Q||null,stock_before:me,stock_after:q,notes:`CORREO - ${Ie} | Estoque: ${me}  ${q}`,reference_document:null,created_by:s.id}).select();if(Z){console.error(" Erro na insero direta:",Z),console.log(" Tentando com quantity = 1...");const{data:se,error:de}=await V.from("inventory_movements").insert({empresa_id:ie,inventory_item_id:B.id,movement_type:"entrada_ajuste",quantity:1,unit_cost:Q||null,stock_before:me,stock_after:q,notes:`CORREO - ${Ie} | Estoque: ${me}  ${q} (registro de auditoria)`,reference_document:null,created_by:s.id}).select();de?(console.error(" Erro na segunda tentativa:",de),alert("Aviso: O estoque foi atualizado, mas houve problema ao registrar no histrico.")):console.log(" Movimentao registrada na segunda tentativa!",se)}else console.log(" Movimentao de correo registrada com sucesso!",$e)}catch($e){console.error(" Erro geral ao registrar movimentao:",$e),alert("Aviso: O estoque foi atualizado, mas houve problema ao registrar no histrico.")}})())}else if(Re){console.log(" Processando como ajuste normal");const Ie=q-me,Me=Ie>0?"entrada_ajuste":"saida_ajuste",$e=Math.abs(Ie);let Z="Ajuste manual de estoque via edio de item";ze&&(Z+=` | Custo alterado: R$ ${Number(D||0).toFixed(2)}  R$ ${Number(Q||0).toFixed(2)}`);try{const{error:se}=await V.rpc("register_inventory_movement",{p_inventory_item_id:B.id,p_movement_type:Me,p_quantity:$e,p_unit_cost:Q||null,p_notes:Z,p_reference_document:null,p_created_by:s.id});se?console.error(" Erro ao registrar movimentao:",se):console.log(" Movimentao registrada com sucesso!")}catch(se){console.error(" Erro ao registrar movimentao:",se)}}else if(ze&&!Re){console.log(" Registrando alterao de custo sem movimentao de estoque");const Ie=B.correctionNotes||"Correo de custo via edio de item";try{const{error:Me}=await V.rpc("register_inventory_movement",{p_inventory_item_id:B.id,p_movement_type:"entrada_ajuste",p_quantity:0,p_unit_cost:Q||null,p_notes:`${Ie} | Custo: R$ ${Number(D||0).toFixed(2)}  R$ ${Number(Q||0).toFixed(2)}`,p_reference_document:null,p_created_by:s.id});Me?console.error(" Erro ao registrar ajuste de custo:",Me):console.log(" Ajuste de custo registrado com sucesso!")}catch(Me){console.error(" Erro ao registrar ajuste de custo:",Me)}}}u(Ie=>Ie.map(Me=>Me.id===we.id?fu(we):Me).sort((Me,$e)=>Me.name.localeCompare($e.name))),we.available_for_sale&&(console.log(" Recarregando menu items devido  atualizao de precificao..."),await P(!0))}},C=async B=>{const{error:Y}=await V.from("inventory_items").delete().eq("id",B);if(Y){console.error(Y);return}u(ne=>ne.filter(ie=>ie.id!==B))},M=async B=>{const Y={name:B.name,email:B.email,phone:B.phone,avatar_url:B.avatar,status:B.status,membership_type:B.membershipType},{data:ne,error:ie}=await V.from("members").insert(Y).select().single();if(ie){console.error(ie);return}ne&&g(oe=>[vp(ne),...oe].sort((me,D)=>me.name.localeCompare(D.name)))},z=async B=>{const Y={name:B.name,email:B.email,phone:B.phone,avatar_url:B.avatar,status:B.status,membership_type:B.membershipType},{data:ne,error:ie}=await V.from("members").update(Y).eq("id",B.id).select().single();if(ie){console.error(ie);return}ne&&g(oe=>oe.map(me=>me.id===ne.id?vp(ne):me).sort((me,D)=>me.name.localeCompare(D.name)))},A=B=>{b(Y=>[B,...Y].slice(0,10))},$=()=>b([]),P=y.useCallback(async(B=!1)=>{if(console.log(" Carregando menu items...",B?"(FORADO)":""),!s){console.log(" Usurio no autenticado, no carregando menu");return}const{data:Y,error:ne}=await V.from("usuarios_empresa").select("empresa_id").eq("user_id",s.id).eq("status","ativo").single();if(ne||!Y){console.error(" Erro ao buscar empresa do usurio:",ne);return}const ie=Y.empresa_id;console.log(" Carregando menu items para empresa_id:",ie);const{data:oe,error:me}=await V.from("menu_items").select(`
      *,
      inventory_items!left(name, image_url, current_stock, available_for_sale)
    `).eq("empresa_id",ie).eq("available",!0).order("category").order("name");if(me){console.error("Erro ao carregar menu items:",me);return}console.log(" Menu items carregados:",(oe==null?void 0:oe.length)||0),oe&&(r(oe.map(wp)),console.log(" Preos atualizados dos menu items:",oe.map(D=>({name:D.name,price:D.price}))))},[s]),F=async()=>{if(p.length>0)return;const{data:B,error:Y}=await V.from("members").select("*").order("name");if(Y){console.error("Erro ao carregar members:",Y);return}B&&g(B.map(vp))},I=y.useCallback(async()=>{if(console.log(" Carregando inventrio completo..."),!s){console.log(" Usurio no autenticado, no carregando inventrio");return}const{data:B,error:Y}=await V.from("usuarios_empresa").select("empresa_id").eq("user_id",s.id).eq("ativo",!0).single();if(Y||!B){console.error(" Erro ao buscar empresa do usurio:",Y);return}const ne=B.empresa_id;console.log(" Carregando inventrio para empresa do usurio:",ne);const{data:ie,error:oe}=await V.from("inventory_items").select("*").eq("empresa_id",ne).order("name");if(oe){console.error(" Erro ao carregar inventory completo:",oe);return}console.log(" Inventrio carregado:",(ie==null?void 0:ie.length)||0,"itens"),ie&&u(ie.map(fu))},[s]),J=y.useCallback(async()=>{if(console.log(" Sincronizando produtos do inventrio com o menu..."),!s){console.log(" Usurio no autenticado, no sincronizando");return}try{const{data:B,error:Y}=await V.from("usuarios_empresa").select("empresa_id").eq("user_id",s.id).eq("ativo",!0).single();if(Y||!B){console.error(" Erro ao buscar empresa do usurio:",Y);return}const ne=B.empresa_id,{data:ie,error:oe}=await V.from("inventory_items").select("*").eq("empresa_id",ne).eq("available_for_sale",!0);if(oe){console.error(" Erro ao buscar produtos do inventrio:",oe);return}if(!ie||ie.length===0){console.log(" Nenhum produto marcado para venda encontrado");return}console.log(" Produtos marcados para venda:",ie.length);const{data:me,error:D}=await V.from("menu_items").select("direct_inventory_item_id").eq("empresa_id",ne).eq("item_type","direct");console.log(" Itens do menu existentes:",me,"Erro:",D),D&&console.error(" Erro ao buscar itens do menu:",D);const q=new Set((me==null?void 0:me.map(_e=>_e.direct_inventory_item_id).filter(Boolean))||[]);console.log(" IDs de inventrio j no menu:",Array.from(q));const Q=ie.filter(_e=>!q.has(_e.id));if(console.log(" Produtos para criar no menu:",Q.length,Q.map(_e=>_e.name)),Q.length===0){console.log(" Todos os produtos j esto sincronizados com o menu");return}console.log(" Criando",Q.length,"novos itens no menu");const K=Q.map(_e=>({name:_e.name,description:`Produto do estoque: ${_e.name}`,price:_e.sale_price||_e.cost*1.5,category:"Produtos do Estoque",available:!0,item_type:"direct",direct_inventory_item_id:_e.id,empresa_id:ne,image_url:_e.image_url,preparation_time:0}));console.log(" Tentando criar itens:",K);const{data:he,error:we}=await V.from("menu_items").insert(K).select();if(we){console.error(" Erro ao criar itens do menu:",we),console.error(" Dados que tentamos inserir:",K);for(const _e of K){console.log(" Tentando criar item individual:",_e.name);const{data:Re,error:ze}=await V.from("menu_items").insert([_e]).select();ze?console.error(` Erro ao criar ${_e.name}:`,ze):console.log(` Criado ${_e.name}:`,Re)}return}console.log(" Criados",(he==null?void 0:he.length)||0,"novos itens no menu:",he),await P()}catch(B){console.error(" Erro na sincronizao:",B)}},[s]),[pe,te]=y.useState([]),[L,G]=y.useState([]),ee=async()=>{console.log(" Buscando pedidos do bar...");try{const{data:B,error:Y}=await V.from("comanda_items").select(`
          *,
          comanda:comandas(
            id,
            table_id,
            customer_name,
            opened_at,
            status,
            table:bar_tables(number)
          ),
          menu_item:menu_items(
            *,
            inventory_items!left(name, image_url)
          )
        `).in("status",["pending","preparing","ready"]).order("added_at",{ascending:!0});if(Y)throw Y;const{data:ne,error:ie}=await V.from("balcao_orders").select("id").in("status",["paid","preparing","ready"]);if(ie)throw console.error(" Erro ao buscar pedidos de balco:",ie),ie;const oe=(ne==null?void 0:ne.map(K=>K.id))||[];console.log(` ${oe.length} pedidos de balco com status vlido`);let me=null,D=null;if(oe.length>0){const K=await V.from("balcao_order_items").select(`
            *,
            balcao_order:balcao_orders(
              id,
              order_number,
              customer_name,
              status,
              created_at
            ),
            menu_item:menu_items(
              *,
              inventory_items!left(name, image_url)
            )
          `).in("balcao_order_id",oe).order("created_at",{ascending:!0});me=K.data,D=K.error}if(D)throw console.error(" Erro ao buscar itens de balco:",D),D;console.log(` ${(me==null?void 0:me.length)||0} itens de balco encontrados`);const q=new Map;B==null||B.forEach(K=>{var Ie,Me,$e,Z,se,de,Ce;const he=(Ie=K.comanda)==null?void 0:Ie.id;if(!he)return;const we=new Date(K.added_at),_e=`${we.getUTCFullYear()}-${we.getUTCMonth()}-${we.getUTCDate()}-${we.getUTCHours()}-${we.getUTCMinutes()}`,Re=`comanda-${he}-${_e}`;q.has(Re)||q.set(Re,{id:Re,tableNumber:($e=(Me=K.comanda)==null?void 0:Me.table)==null?void 0:$e.number,items:[],status:K.status,total:0,createdAt:new Date(K.added_at),updatedAt:new Date(K.created_at),employeeId:"",notes:`Mesa ${(se=(Z=K.comanda)==null?void 0:Z.table)==null?void 0:se.number} - ${((de=K.comanda)==null?void 0:de.customer_name)||"Cliente"}`});const ze=q.get(Re);ze.items.push({id:K.id,menuItemId:K.menu_item_id,quantity:K.quantity,price:K.price,notes:K.notes,menuItem:K.menu_item?{id:K.menu_item.id,name:K.menu_item.item_type==="direct"&&((Ce=K.menu_item.inventory_items)!=null&&Ce.name)?K.menu_item.inventory_items.name:K.menu_item.name,category:K.menu_item.category,preparationTime:K.menu_item.preparation_time,item_type:K.menu_item.item_type}:void 0}),ze.total+=K.price*K.quantity}),me==null||me.forEach(K=>{var Re,ze;const he=(Re=K.balcao_order)==null?void 0:Re.id;if(!he)return;const we=`balcao-${he}`;q.has(we)||q.set(we,{id:we,tableNumber:"Balco",items:[],status:K.balcao_order.status==="paid"?"pending":K.balcao_order.status==="preparing"?"preparing":"ready",total:0,createdAt:new Date(K.balcao_order.created_at),updatedAt:new Date(K.created_at),employeeId:"",notes:`Pedido Balco #${K.balcao_order.order_number}${K.balcao_order.customer_name?` - ${K.balcao_order.customer_name}`:""}`});const _e=q.get(we);_e.items.push({id:K.id,menuItemId:K.menu_item_id,quantity:K.quantity,price:K.unit_price,notes:K.notes,menuItem:K.menu_item?{id:K.menu_item.id,name:K.menu_item.item_type==="direct"&&((ze=K.menu_item.inventory_items)!=null&&ze.name)?K.menu_item.inventory_items.name:K.menu_item.name,category:K.menu_item.category,preparationTime:K.menu_item.preparation_time,item_type:K.menu_item.item_type}:void 0}),_e.total+=K.unit_price*K.quantity});const Q=Array.from(q.values());console.log(` ${Q.length} pedidos do bar carregados`),G(Q)}catch(B){console.error(" Erro ao buscar pedidos do bar:",B)}},xe=async()=>{console.log(" Buscando pedidos da cozinha...");try{const{data:B,error:Y}=await V.from("comanda_items").select(`
          *,
          comanda:comandas(
            id,
            table_id,
            customer_name,
            opened_at,
            status,
            table:bar_tables(number)
          ),
          menu_item:menu_items!inner(*)
        `).in("status",["pending","preparing"]).neq("menu_item.item_type","direct").order("added_at",{ascending:!0});if(Y)throw Y;const{data:ne,error:ie}=await V.from("balcao_orders").select("id").in("status",["paid","preparing"]);if(ie)throw console.error(" Erro ao buscar pedidos de balco (cozinha):",ie),ie;const oe=(ne==null?void 0:ne.map(K=>K.id))||[];console.log(` ${oe.length} pedidos de balco para cozinha`);let me=null,D=null;if(oe.length>0){const K=await V.from("balcao_order_items").select(`
            *,
            balcao_order:balcao_orders(
              id,
              order_number,
              customer_name,
              status,
              created_at
            ),
            menu_item:menu_items!inner(*)
          `).in("balcao_order_id",oe).neq("menu_item.item_type","direct").order("created_at",{ascending:!0});me=K.data,D=K.error}if(D)throw console.error(" Erro ao buscar itens de balco (cozinha):",D),D;console.log(` ${(me==null?void 0:me.length)||0} itens de balco para cozinha`);const q=new Map;B==null||B.forEach(K=>{var Ie,Me,$e,Z,se,de;const he=(Ie=K.comanda)==null?void 0:Ie.id;if(!he)return;const we=new Date(K.added_at),_e=`${we.getUTCFullYear()}-${we.getUTCMonth()}-${we.getUTCDate()}-${we.getUTCHours()}-${we.getUTCMinutes()}`,Re=`comanda-${he}-${_e}`;q.has(Re)||q.set(Re,{id:Re,tableNumber:($e=(Me=K.comanda)==null?void 0:Me.table)==null?void 0:$e.number,items:[],status:K.status,total:0,createdAt:new Date(K.added_at),updatedAt:new Date(K.created_at),employeeId:"",notes:`Mesa ${(se=(Z=K.comanda)==null?void 0:Z.table)==null?void 0:se.number} - ${((de=K.comanda)==null?void 0:de.customer_name)||"Cliente"}`});const ze=q.get(Re);ze.items.push({id:K.id,menuItemId:K.menu_item_id,quantity:K.quantity,price:K.price,notes:K.notes,menuItem:K.menu_item?{id:K.menu_item.id,name:K.menu_item.name,category:K.menu_item.category,preparationTime:K.menu_item.preparation_time}:void 0}),ze.total+=K.price*K.quantity}),me==null||me.forEach(K=>{var Re;const he=(Re=K.balcao_order)==null?void 0:Re.id;if(!he)return;const we=`balcao-${he}`;q.has(we)||q.set(we,{id:we,tableNumber:"Balco",items:[],status:K.balcao_order.status==="paid"?"pending":"preparing",total:0,createdAt:new Date(K.balcao_order.created_at),updatedAt:new Date(K.created_at),employeeId:"",notes:`Pedido Balco #${K.balcao_order.order_number}${K.balcao_order.customer_name?` - ${K.balcao_order.customer_name}`:""}`});const _e=q.get(we);_e.items.push({id:K.id,menuItemId:K.menu_item_id,quantity:K.quantity,price:K.unit_price,notes:K.notes,menuItem:K.menu_item?{id:K.menu_item.id,name:K.menu_item.name,category:K.menu_item.category,preparationTime:K.menu_item.preparation_time}:void 0}),_e.total+=K.unit_price*K.quantity});const Q=Array.from(q.values());console.log(` ${Q.length} pedidos da cozinha carregados`),te(Q)}catch(B){console.error(" Erro ao buscar pedidos da cozinha:",B)}};y.useEffect(()=>{console.log(" INICIANDO SUBSCRIPTIONS DE REALTIME "),xe(),ee();const B=V.channel("kitchen-orders-realtime").on("postgres_changes",{event:"*",schema:"public",table:"comanda_items"},Y=>{console.log(" REALTIME - comanda_items:",Y.eventType),xe(),ee()}).on("postgres_changes",{event:"*",schema:"public",table:"comandas"},Y=>{console.log(" REALTIME - comandas:",Y.eventType),xe(),ee()}).on("postgres_changes",{event:"*",schema:"public",table:"balcao_orders"},Y=>{var ne,ie,oe,me;console.log(" REALTIME - balcao_orders:",Y.eventType,""),console.log(" Status:",(ne=Y.old)==null?void 0:ne.status,"",(ie=Y.new)==null?void 0:ie.status),Y.eventType==="UPDATE"&&((oe=Y.old)==null?void 0:oe.status)==="pending_payment"&&((me=Y.new)==null?void 0:me.status)==="paid"&&console.log(" PEDIDO PAGO! Atualizando monitores... "),xe(),ee()}).on("postgres_changes",{event:"*",schema:"public",table:"balcao_order_items"},Y=>{console.log(" REALTIME - balcao_order_items:",Y.eventType),xe(),ee()}).subscribe(Y=>{console.log(" Status da subscription kitchen-orders:",Y),Y==="SUBSCRIBED"?console.log(" Subscription ativa e funcionando!"):Y==="CHANNEL_ERROR"&&console.error(" Erro na subscription!")});return()=>{console.log(" Desconectando subscription kitchen-orders"),B.unsubscribe()}},[]),y.useEffect(()=>{s&&(console.log(" Usurio autenticado, carregando inventrio..."),I(),F())},[s,I]);const O=pe.filter(B=>B.items.length>0),H=L.filter(B=>B.items.length>0);return e.jsx(a2.Provider,{value:{menuItems:a,addMenuItem:_,updateMenuItem:w,removeMenuItem:E,loadMenuItems:P,orders:o,addOrder:T,updateOrderStatus:N,kitchenOrders:O,barOrders:H,refreshKitchenOrders:xe,refreshBarOrders:ee,inventory:c,inventoryCategories:h,addInventoryItem:k,updateInventoryItem:S,removeInventoryItem:C,loadFullInventory:I,syncInventoryToMenu:J,members:p,addMember:M,updateMember:z,loadMembers:F,notifications:v,addNotification:A,clearNotifications:$},children:t})},eD=({children:t})=>{const{user:s,isLoading:a}=s2(),r=Ks(),o=Tr(),[l,c]=y.useState(!0),[u,h]=y.useState(!1),f=["/alterar-senha-provisoria","/login","/logout","/registro-empresa"];return y.useEffect(()=>{(async()=>{if(!a){if(!(s!=null&&s.user_id)){c(!1);return}if(f.some(g=>o.pathname.startsWith(g))){c(!1);return}try{console.log(" [SenhaProvisionariaGuard] Verificando senha provisria para user_id:",s.user_id);const{data:g,error:v}=await V.from("usuarios_empresa").select("senha_provisoria, status, nome_completo, email").eq("user_id",s.user_id).single();if(console.log(" [SenhaProvisionariaGuard] Resultado da consulta:",{usuarioEmpresa:g,error:v}),v){console.error(" [SenhaProvisionariaGuard] Erro ao verificar senha provisria:",v),c(!1);return}if(console.log(" [SenhaProvisionariaGuard] senha_provisoria:",g==null?void 0:g.senha_provisoria),(g==null?void 0:g.senha_provisoria)===!0){console.log(" [SenhaProvisionariaGuard] SENHA PROVISRIA DETECTADA! Redirecionando..."),h(!0),await V.rpc("registrar_log_auditoria",{p_empresa_id:s.empresa_id,p_usuario_id:s.user_id,p_acao:"ACCESS_ATTEMPT_TEMP_PASSWORD",p_recurso:"sistema",p_detalhes:{rota_tentativa:o.pathname,timestamp:new Date().toISOString(),user_agent:navigator.userAgent}}),r("/alterar-senha-provisoria",{replace:!0,state:{from:o.pathname}});return}(g==null?void 0:g.status)!=="ativo"&&console.warn("Usurio no est ativo:",g==null?void 0:g.status),h(!1)}catch(g){console.error("Erro ao verificar senha provisria:",g)}finally{c(!1)}}})()},[s,a,o.pathname,r]),a||l?e.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}),e.jsx("h2",{className:"mt-6 text-center text-lg font-medium text-gray-900",children:"Verificando credenciais..."}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Aguarde enquanto validamos suas informaes de acesso"})]})}):u?e.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 bg-yellow-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})})})}),e.jsx("h2",{className:"mt-6 text-center text-lg font-medium text-gray-900",children:"Redirecionando..."}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Voc ser redirecionado para alterar sua senha provisria"})]})}):e.jsx(e.Fragment,{children:t})},jp={"bob@teste.com":"atendente_caixa","maria@teste.com":"operador_caixa","charles@teste.com":"operador_caixa","tony@teste.com":"operador_caixa","lulu@teste.com":"operador_caixa","lulusantos@teste.com":"operador_caixa","lulu.santos@teste.com":"operador_caixa"},qn=(t,s,a)=>{console.log(" CHAMADA addUserRoleMapping:",{email:t,role:s,createdBy:a}),console.trace(" Stack trace da chamada:");const r={email:t,role:s,createdAt:new Date().toISOString(),createdBy:a};console.log(` Adicionando mapeamento de usurio: ${t}  ${s}`),localStorage.setItem(`userRole_${t}`,JSON.stringify(r))},tD=t=>{if(console.log(` getUserRole chamada para: ${t}`),jp[t])return console.log(` Role encontrado no mapeamento base: ${jp[t]}`),jp[t];try{const s=localStorage.getItem(`userRole_${t}`);if(s){const a=JSON.parse(s);return console.log(` Role encontrado no localStorage: ${a.role}`),a.role}else console.log(` Nenhum mapeamento encontrado no localStorage para: ${t}`)}catch(s){console.warn("Erro ao buscar role do localStorage:",s)}return console.log(` Nenhum role encontrado para: ${t}`),null},sD=t=>{console.log(` Mapeando role: "${t}"`);const a={waiter:"garcom",cook:"cozinheiro",cashier:"operador_caixa",caixa:"operador_caixa",atendente:"operador_caixa",supervisor:"atendente",barman:"atendente",manager:"gerente",gerente:"gerente",admin:"administrador"}[t]||"funcionario";return console.log(` Role "${t}" mapeado para: "${a}"`),a};async function aD(){var t;try{const{data:{user:s},error:a}=await V.auth.getUser();if(a||!s)return console.log("Usurio no autenticado"),null;console.log(" Usurio autenticado:",s.email),console.log(" Usando fallback direto para evitar erros de RLS");let r=tD(s.email||"");if(console.log(` Buscando role para ${s.email}: ${r||"no encontrado"}`),s.email==="riltons@gmail.com"&&(r="administrador",console.log(` Superusurio detectado: ${s.email}`)),["arnaldo@teste.com","martinho@teste.com","tony@teste.com","charles@teste.com","nando@teste.com","mariza@teste.com","lulu@teste.com","lulusantos@teste.com","lulu.santos@teste.com"].includes(s.email||"")&&(r="operador_caixa",console.log(` CORREO FORADA: ${s.email}  operador_caixa`)),!r)try{const{data:b}=await V.from("usuarios_empresa").select("cargo, tipo_usuario, papel, is_primeiro_usuario").eq("user_id",s.id).eq("status","ativo").maybeSingle();if(b)if(b.papel==="SUPER_ADMIN")r="administrador",console.log(` SUPER_ADMIN detectado: ${s.email}  administrador`),qn(s.email||"",r,"papel_detection");else if(b.papel==="ADMIN")r="administrador",console.log(` ADMIN detectado: ${s.email}  administrador`),qn(s.email||"",r,"papel_detection");else if(b.papel==="MANAGER")r="gerente",console.log(` MANAGER detectado: ${s.email}  gerente`),qn(s.email||"",r,"papel_detection");else{const _=((t=b.cargo)==null?void 0:t.toLowerCase())||"";_.includes("caixa")||_.includes("cashier")||_.includes("atendente")?(r="operador_caixa",console.log(` Role detectado pelo cargo: "${b.cargo}"  operador_caixa`),qn(s.email||"",r,"cargo_detection")):_.includes("gerente")||_.includes("manager")?(r="gerente",console.log(` Role detectado pelo cargo: "${b.cargo}"  gerente`),qn(s.email||"",r,"cargo_detection")):(r="funcionario",console.log(` Cargo "${b.cargo}"  funcionario padro`))}else{const _=(s.email||"").toLowerCase();_.includes("caixa")||_.includes("cashier")||_.includes("tony")||_.includes("charles")||_.includes("nando")||_.includes("arnaldo")||_.includes("mariza")||_.includes("martinho")||_.includes("nandoc")?(r="operador_caixa",console.log(" Deteco inteligente por email: usurio identificado como operador de caixa"),qn(s.email||"",r,"smart_detection")):(r="funcionario",console.log(` Usurio no encontrado, usando role padro: ${r}`))}}catch{console.log(" Erro ao buscar role do banco, usando fallback")}r=r||"funcionario",console.log(` Role final determinado: ${r}`);const l=r==="administrador";let c;if(l)try{c=await bt()||crypto.randomUUID(),console.log(" Superusurio - empresa_id obtida dinamicamente:",c)}catch(b){console.warn(" Erro ao obter empresa_id para superusurio, usando UUID aleatrio:",b),c=crypto.randomUUID()}else c=crypto.randomUUID();const u=!0,h={id:crypto.randomUUID(),user_id:s.id,empresa_id:c,tipo_usuario:l?"administrador":"funcionario",status:"ativo",cargo:r,tem_acesso_sistema:!0};l?console.log(" Superusurio detectado - usando empresa AABB Garanhuns"):r!=="funcionario"&&console.log(` Usurio com role especfico detectado: ${r}`),console.log(" Dados do usurio carregados (fallback direto)");let f=[];console.log(" Buscando permisses especficas do usurio...");try{const{data:b}=await V.from("usuarios_empresa").select("id, cargo, tipo_usuario").eq("user_id",s.id).eq("status","ativo").maybeSingle();if(b){console.log(` Usuario empresa encontrado: ${b.cargo}`);const{data:_}=await V.from("permissoes_usuario").select("modulo, permissoes").eq("usuario_empresa_id",b.id);if(_&&_.length>0?(f=_,console.log(` ${f.length} permisses especficas carregadas:`,f.map(w=>w.modulo))):console.log(" Nenhuma permisso especfica encontrada na tabela permissoes_usuario"),b.cargo){const w=b.cargo.toLowerCase();(w.includes("caixa")||w.includes("cashier"))&&(r="operador_caixa",console.log(` Role atualizado baseado no cargo do banco: ${b.cargo}  operador_caixa`))}}else console.log(" Usuario empresa no encontrado, usando role mapeado")}catch(b){console.log(" Erro ao carregar permisses especficas:",b)}const p=null;console.log(" Pulando consulta bar_employees para evitar erros");const g=(p==null?void 0:p.bar_role)||h.cargo||"funcionario",v=rD(g,f);return{userId:s.id,empresaId:h.empresa_id,role:g,permissions:v,isActive:h.status==="ativo"&&(p==null?void 0:p.is_active)!==!1,hasSystemAccess:h.tem_acesso_sistema!==!1}}catch(s){return console.error(" Erro fatal ao carregar permisses:",s),null}}function rD(t,s=[]){const a={gerente:{dashboard:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},monitor_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},atendimento_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},monitor_cozinha:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},clientes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},funcionarios:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},relatorios:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},configuracoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0}},administrador:{dashboard:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},monitor_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},atendimento_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},monitor_cozinha:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},clientes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},funcionarios:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},relatorios:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},configuracoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0}},funcionario:{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},atendimento_bar:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}},atendente:{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},monitor_bar:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},atendimento_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1},gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1},clientes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},atendente_caixa:{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1},atendimento_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1},clientes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},operador_caixa:{gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}},cozinheiro:{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},monitor_cozinha:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1},atendimento_bar:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}},garcom:{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},monitor_bar:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},atendimento_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1},clientes:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}}},r={dashboard:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},monitor_bar:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},atendimento_bar:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},monitor_cozinha:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},gestao_caixa:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},clientes:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},funcionarios:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},relatorios:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},configuracoes:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1}};if(s.length>0){console.log(` Usando APENAS permisses especficas do usurio (${s.length} mdulos)`);const c={...r};return s.forEach(u=>{c[u.modulo]&&(c[u.modulo]={visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1,...u.permissoes},console.log(` Mdulo '${u.modulo}' configurado:`,u.permissoes))}),console.log(" Permisses especficas aplicadas para usurio:",c),c}console.log(` Usando permisses padro do role '${t}'`);const o={...r},l=a[t]||a.funcionario;return Object.keys(l).forEach(c=>{o[c]&&(o[c]={...o[c],...l[c]})}),console.log(` Permisses padro construdas para role '${t}':`,o),o}const r2=(t,s,a="visualizar")=>{if(!t||!t.isActive||!t.hasSystemAccess)return!1;const r=t.permissions[s];return r?r[a]:!1},n2=async()=>await aD(),nD=()=>e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Verificando permisses..."})]})}),oD=({module:t,action:s})=>e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 mb-4",children:e.jsx(dn,{className:"h-8 w-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Acesso Negado"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Voc no tem permisso para acessar este mdulo."}),e.jsxs("div",{className:"bg-gray-100 rounded-lg p-4 mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Mdulo:"})," ",t]}),e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Ao:"})," ",s]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Entre em contato com o administrador para solicitar as permisses necessrias."}),e.jsx("button",{onClick:()=>window.history.back(),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Voltar"})]})}),iD=({error:t})=>e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-yellow-100 mb-4",children:e.jsx(Ya,{className:"h-8 w-8 text-yellow-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Erro de Verificao"}),e.jsx("p",{className:"text-gray-600 mb-4",children:t}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Tentar Novamente"})]})}),Pt=({children:t,module:s,action:a="visualizar",fallback:r,loadingComponent:o,redirectTo:l="/"})=>{const[c,u]=y.useState({loading:!0,hasPermission:!1,permissions:null,error:null});y.useEffect(()=>{h()},[s,a]);const h=async()=>{try{u(g=>({...g,loading:!0,error:null}));const f=await n2();if(!f){u({loading:!1,hasPermission:!1,permissions:null,error:"Usurio no autenticado"});return}if(!f.isActive){u({loading:!1,hasPermission:!1,permissions:f,error:"Usurio inativo"});return}if(!f.hasSystemAccess){u({loading:!1,hasPermission:!1,permissions:f,error:"Usurio sem acesso ao sistema"});return}const p=r2(f,s,a);u({loading:!1,hasPermission:p,permissions:f,error:null})}catch(f){u({loading:!1,hasPermission:!1,permissions:null,error:f instanceof Error?f.message:"Erro de verificao de permisses"})}};return c.loading?o||e.jsx(nD,{}):c.error?c.error==="Usurio no autenticado"?e.jsx(Mi,{to:"/login",replace:!0}):e.jsx(iD,{error:c.error}):c.hasPermission?e.jsx(e.Fragment,{children:t}):r?e.jsx(e.Fragment,{children:r}):["dashboard"].includes(s)?e.jsx(Mi,{to:l,replace:!0}):e.jsx(oD,{module:s,action:a})},lD=()=>{const{user:t,empresa:s,logout:a}=s2(),r=Ks(),[o,l]=y.useState(""),[c,u]=y.useState(""),[h,f]=y.useState(!1),[p,g]=y.useState(""),[v,b]=y.useState(!1),[_,w]=y.useState(!1),[E,T]=y.useState({senha_minima_caracteres:8,senha_exigir_maiuscula:!0,senha_exigir_numero:!0,senha_exigir_simbolo:!1}),[N,k]=y.useState({tamanhoMinimo:!1,temMaiuscula:!1,temMinuscula:!1,temNumero:!1,temSimbolo:!1,senhasIguais:!1});y.useEffect(()=>{(async()=>{if(s!=null&&s.id)try{const{data:A,error:$}=await V.from("configuracoes_empresa").select("configuracoes").eq("empresa_id",s.id).eq("categoria","seguranca").single();if($){console.error("Erro ao carregar configuraes:",$);return}A!=null&&A.configuracoes&&T({senha_minima_caracteres:A.configuracoes.senha_minima_caracteres||8,senha_exigir_maiuscula:A.configuracoes.senha_exigir_maiuscula||!0,senha_exigir_numero:A.configuracoes.senha_exigir_numero||!0,senha_exigir_simbolo:A.configuracoes.senha_exigir_simbolo||!1})}catch(A){console.error("Erro ao carregar configuraes:",A)}})()},[s==null?void 0:s.id]),y.useEffect(()=>{(()=>{const A={tamanhoMinimo:o.length>=E.senha_minima_caracteres,temMaiuscula:E.senha_exigir_maiuscula?/[A-Z]/.test(o):!0,temMinuscula:/[a-z]/.test(o),temNumero:E.senha_exigir_numero?/[0-9]/.test(o):!0,temSimbolo:E.senha_exigir_simbolo?/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(o):!0,senhasIguais:o===c&&o.length>0};k(A)})()},[o,c,E]);const S=Object.values(N).every(z=>z===!0),C=async z=>{if(z.preventDefault(),!S){g("Por favor, atenda a todos os requisitos de senha.");return}f(!0),g("");try{const{error:A}=await V.auth.updateUser({password:o});if(A)throw new Error(A.message);const{error:$}=await V.from("usuarios_empresa").update({senha_provisoria:!1,updated_at:new Date().toISOString()}).eq("user_id",t==null?void 0:t.user_id);if($)throw new Error($.message);await V.rpc("registrar_log_auditoria",{p_empresa_id:s==null?void 0:s.id,p_usuario_id:t==null?void 0:t.user_id,p_acao:"PASSWORD_CHANGE",p_recurso:"usuarios_empresa",p_detalhes:{tipo:"senha_provisoria_alterada",timestamp:new Date().toISOString()}}),alert("Senha alterada com sucesso! Voc ser redirecionado para o dashboard."),setTimeout(()=>{r("/dashboard")},1e3)}catch(A){console.error("Erro ao alterar senha:",A),g(A instanceof Error?A.message:"Erro ao alterar senha")}finally{f(!1)}},M=async()=>{window.confirm("Tem certeza que deseja sair? Voc precisar alterar sua senha provisria na prxima vez que fizer login.")&&(await a(),r("/login"))};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Alterar Senha Provisria"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Por segurana, voc deve alterar sua senha provisria antes de continuar"})]}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[e.jsx("div",{className:"mb-6 p-4 bg-blue-50 rounded-md",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsxs("h3",{className:"text-sm font-medium text-blue-800",children:["Bem-vindo  ",s==null?void 0:s.nome]}),e.jsxs("div",{className:"mt-2 text-sm text-blue-700",children:[e.jsxs("p",{children:["Usurio: ",t==null?void 0:t.nome_completo]}),e.jsxs("p",{children:["Email: ",t==null?void 0:t.email]})]})]})]})}),e.jsxs("form",{className:"space-y-6",onSubmit:C,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nova-senha",className:"block text-sm font-medium text-gray-700",children:"Nova Senha"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("input",{id:"nova-senha",name:"nova-senha",type:v?"text":"password",autoComplete:"new-password",required:!0,value:o,onChange:z=>l(z.target.value),className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Digite sua nova senha"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>b(!v),children:v?e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):e.jsxs("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmar-senha",className:"block text-sm font-medium text-gray-700",children:"Confirmar Nova Senha"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("input",{id:"confirmar-senha",name:"confirmar-senha",type:_?"text":"password",autoComplete:"new-password",required:!0,value:c,onChange:z=>u(z.target.value),className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Confirme sua nova senha"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>w(!_),children:_?e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):e.jsxs("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-md p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Requisitos da Senha:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:`flex items-center text-sm ${N.tamanhoMinimo?"text-green-600":"text-gray-500"}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${N.tamanhoMinimo?"text-green-500":"text-gray-400"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Mnimo de ",E.senha_minima_caracteres," caracteres"]}),E.senha_exigir_maiuscula&&e.jsxs("div",{className:`flex items-center text-sm ${N.temMaiuscula?"text-green-600":"text-gray-500"}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${N.temMaiuscula?"text-green-500":"text-gray-400"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Pelo menos uma letra maiscula"]}),e.jsxs("div",{className:`flex items-center text-sm ${N.temMinuscula?"text-green-600":"text-gray-500"}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${N.temMinuscula?"text-green-500":"text-gray-400"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Pelo menos uma letra minscula"]}),E.senha_exigir_numero&&e.jsxs("div",{className:`flex items-center text-sm ${N.temNumero?"text-green-600":"text-gray-500"}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${N.temNumero?"text-green-500":"text-gray-400"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Pelo menos um nmero"]}),E.senha_exigir_simbolo&&e.jsxs("div",{className:`flex items-center text-sm ${N.temSimbolo?"text-green-600":"text-gray-500"}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${N.temSimbolo?"text-green-500":"text-gray-400"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Pelo menos um smbolo (!@#$%^&*)"]}),e.jsxs("div",{className:`flex items-center text-sm ${N.senhasIguais?"text-green-600":"text-gray-500"}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${N.senhasIguais?"text-green-500":"text-gray-400"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"As senhas devem ser iguais"]})]})]}),p&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-sm font-medium text-red-800",children:p})})]})}),e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsx("button",{type:"submit",disabled:!S||h,className:`w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${S&&!h?"bg-blue-600 hover:bg-blue-700":"bg-gray-400 cursor-not-allowed"}`,children:h?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Alterando senha..."]}):"Alterar Senha"}),e.jsx("button",{type:"button",onClick:M,className:"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Sair do Sistema"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Informaes de Segurana"})})]}),e.jsx("div",{className:"mt-4 text-sm text-gray-600",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:" Sua senha ser criptografada e armazenada com segurana"}),e.jsx("li",{children:" Voc receber uma confirmao por email aps a alterao"}),e.jsx("li",{children:" Esta alterao ser registrada nos logs de auditoria"}),e.jsx("li",{children:" Em caso de problemas, contate o administrador do sistema"})]})})]})]})})]})},cD={"Failed to fetch":{code:"NETWORK_ERROR",message:"Falha na conexo com o servidor",userMessage:"Problema de conexo. Verifique sua internet e tente novamente.",retryable:!0,action:"retry"},"Invalid login credentials":{code:"INVALID_CREDENTIALS",message:"Credenciais invlidas",userMessage:"Email ou senha incorretos. Verifique seus dados e tente novamente.",retryable:!1},"Email not confirmed":{code:"EMAIL_NOT_CONFIRMED",message:"Email no confirmado",userMessage:"Confirme seu email antes de fazer login. Verifique sua caixa de entrada.",retryable:!1},"Too many requests":{code:"RATE_LIMIT",message:"Muitas tentativas",userMessage:"Muitas tentativas de login. Aguarde alguns minutos antes de tentar novamente.",retryable:!0},"User not found":{code:"USER_NOT_FOUND",message:"Usurio no encontrado",userMessage:"Conta no encontrada. Verifique o email ou crie uma nova conta.",retryable:!1},"Invalid Refresh Token":{code:"INVALID_REFRESH_TOKEN",message:"Token de sesso invlido",userMessage:"Sua sesso expirou. Faa login novamente.",retryable:!1,action:"redirect"},"Profile not found":{code:"PROFILE_NOT_FOUND",message:"Perfil no encontrado",userMessage:"Erro na configurao da conta. Entre em contato com o suporte.",retryable:!1,action:"contact_support"},"Insufficient permissions":{code:"INSUFFICIENT_PERMISSIONS",message:"Permisses insuficientes",userMessage:"Voc no tem permisso para acessar este recurso.",retryable:!1}};function dD(t){const s=(t==null?void 0:t.message)||(t==null?void 0:t.error_description)||String(t);for(const[a,r]of Object.entries(cD))if(s.includes(a))return r;return{code:"UNKNOWN_ERROR",message:s,userMessage:"Ocorreu um erro inesperado. Tente novamente ou entre em contato com o suporte.",retryable:!0,action:"retry"}}const uD=({error:t,onRetry:s,onDismiss:a,context:r="auth"})=>{if(!t)return null;const o=dD(t),l=()=>{switch(o.code){case"NETWORK_ERROR":return e.jsx(_a,{className:"w-5 h-5"});case"EMAIL_NOT_CONFIRMED":return e.jsx(ki,{className:"w-5 h-5"});case"PROFILE_NOT_FOUND":case"UNKNOWN_ERROR":return e.jsx(AR,{className:"w-5 h-5"});default:return e.jsx(Ya,{className:"w-5 h-5"})}},u=(()=>{switch(o.code){case"NETWORK_ERROR":return{container:"bg-yellow-50 border-yellow-200",icon:"text-yellow-600",text:"text-yellow-800",button:"bg-yellow-600 hover:bg-yellow-700"};case"RATE_LIMIT":return{container:"bg-orange-50 border-orange-200",icon:"text-orange-600",text:"text-orange-800",button:"bg-orange-600 hover:bg-orange-700"};default:return{container:"bg-red-50 border-red-200",icon:"text-red-600",text:"text-red-800",button:"bg-red-600 hover:bg-red-700"}}})();return e.jsx(Wa,{children:e.jsx(be.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},className:`rounded-lg border p-4 ${u.container}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`flex-shrink-0 ${u.icon}`,children:l()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h3",{className:`text-sm font-medium ${u.text}`,children:[o.code==="NETWORK_ERROR"&&"Problema de Conexo",o.code==="INVALID_CREDENTIALS"&&"Credenciais Invlidas",o.code==="EMAIL_NOT_CONFIRMED"&&"Email No Confirmado",o.code==="RATE_LIMIT"&&"Muitas Tentativas",o.code==="USER_NOT_FOUND"&&"Usurio No Encontrado",o.code==="INVALID_REFRESH_TOKEN"&&"Sesso Expirada",o.code==="PROFILE_NOT_FOUND"&&"Erro de Configurao",o.code==="INSUFFICIENT_PERMISSIONS"&&"Acesso Negado",o.code==="UNKNOWN_ERROR"&&"Erro Inesperado"]}),e.jsx("p",{className:`mt-1 text-sm ${u.text}`,children:o.userMessage}),e.jsxs("div",{className:"mt-3 flex items-center space-x-3",children:[o.retryable&&s&&e.jsxs("button",{onClick:s,className:`inline-flex items-center px-3 py-1.5 text-xs font-medium text-white rounded-md ${u.button} transition-colors`,children:[e.jsx(_a,{className:"w-3 h-3 mr-1"}),"Tentar Novamente"]}),o.action==="contact_support"&&e.jsxs("a",{href:"mailto:suporte@clubmanager.com",className:`inline-flex items-center px-3 py-1.5 text-xs font-medium text-white rounded-md ${u.button} transition-colors`,children:[e.jsx(ki,{className:"w-3 h-3 mr-1"}),"Contatar Suporte"]}),o.code==="EMAIL_NOT_CONFIRMED"&&e.jsxs("button",{onClick:()=>{console.log("Reenviar email de confirmao")},className:`inline-flex items-center px-3 py-1.5 text-xs font-medium text-white rounded-md ${u.button} transition-colors`,children:[e.jsx(ki,{className:"w-3 h-3 mr-1"}),"Reenviar Email"]})]})]}),a&&e.jsx("button",{onClick:a,className:`flex-shrink-0 ${u.icon} hover:opacity-70 transition-opacity`,children:e.jsx(lt,{className:"w-4 h-4"})})]})})})},mD=({onCredentialSelect:t})=>{const[s,a]=y.useState(!1),[r,o]=y.useState(null),l=x0.getAvailableUsers(),c=async(h,f)=>{try{await navigator.clipboard.writeText(h),o(f),setTimeout(()=>o(null),2e3)}catch(p){console.error("Erro ao copiar:",p)}},u=(h,f)=>{t&&t(h,f)};return e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(XN,{className:"text-blue-600 mt-0.5",size:20}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-blue-800 font-medium mb-2",children:"Modo Demonstrao Ativo"}),e.jsx("p",{className:"text-blue-700 text-sm mb-3",children:"O sistema est funcionando em modo mock. Use uma das credenciais abaixo para testar:"}),e.jsxs("button",{onClick:()=>a(!s),className:"flex items-center space-x-2 text-blue-700 hover:text-blue-800 text-sm font-medium mb-3",children:[s?e.jsx(fn,{size:16}):e.jsx(Ws,{size:16}),e.jsxs("span",{children:[s?"Ocultar":"Ver"," credenciais disponveis"]})]}),s&&e.jsxs("div",{className:"space-y-3",children:[l.map((h,f)=>e.jsxs("div",{className:"bg-white rounded border p-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ss,{size:16,className:"text-gray-500"}),e.jsx("span",{className:"font-medium text-gray-900",children:h.name}),e.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:h.role})]}),t&&e.jsx("button",{onClick:()=>u(h.email,h.password),className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded hover:bg-blue-200",children:"Usar"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-600 min-w-[60px]",children:"Email:"}),e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded flex-1 font-mono text-xs",children:h.email}),e.jsx("button",{onClick:()=>c(h.email,`email-${f}`),className:"text-gray-400 hover:text-gray-600",title:"Copiar email",children:r===`email-${f}`?e.jsx(Zu,{size:14,className:"text-green-500"}):e.jsx(La,{size:14})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-600 min-w-[60px]",children:"Senha:"}),e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded flex-1 font-mono text-xs",children:h.password}),e.jsx("button",{onClick:()=>c(h.password,`password-${f}`),className:"text-gray-400 hover:text-gray-600",title:"Copiar senha",children:r===`password-${f}`?e.jsx(Zu,{size:14,className:"text-green-500"}):e.jsx(La,{size:14})})]})]})]},h.email)),e.jsxs("div",{className:"text-xs text-blue-600 bg-blue-100 p-2 rounded",children:[" ",e.jsx("strong",{children:"Dica:"})," Configure suas credenciais reais do Supabase nos arquivos .env para sair do modo mock"]})]})]})]})})},hD=()=>{const[t,s]=y.useState(""),[a,r]=y.useState(""),[o,l]=y.useState(!1),[c,u]=y.useState(""),[h,f]=y.useState(!1),{login:p,loginAsDemo:g,isLoading:v}=Et();y.useEffect(()=>{(async()=>{const T=await ku();f(!T)})()},[]);const b=async E=>{if(E.preventDefault(),u(""),!t||!a){u("Por favor, preencha todos os campos");return}const T=await p(t,a);T.success||u(T.error||"Erro ao fazer login. Tente novamente.")},_=()=>{u(""),b({preventDefault:()=>{}})},w=()=>{g()};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-slate-800 to-slate-900 flex items-center justify-center p-4",children:e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ss,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"ClubManager Pro"}),e.jsx("p",{className:"text-gray-600",children:"Sistema de Gesto de Clubes"})]}),e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:w,className:"w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-4 rounded-lg font-semibold text-lg hover:from-green-600 hover:to-green-700 transition-all duration-300 flex items-center justify-center space-x-2 mb-6 shadow-lg",children:[e.jsx(kr,{className:"w-5 h-5"}),e.jsx("span",{children:" Entrar como Demo"})]}),h&&e.jsx(mD,{onCredentialSelect:(E,T)=>{s(E),r(T)}}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"ou faa login tradicional"})})]}),e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(ki,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"email",value:t,onChange:E=>s(E.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Digite seu email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(dn,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:o?"text":"password",value:a,onChange:E=>r(E.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Digite sua senha"}),e.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:o?e.jsx(fn,{size:20}):e.jsx(Ws,{size:20})})]})]}),e.jsx(uD,{error:c,onRetry:_,onDismiss:()=>u(""),context:"login"}),e.jsx(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:v,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:v?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Entrando..."})]}):"Entrar"})]}),e.jsxs("div",{className:"mt-8 p-4 bg-gradient-to-r from-blue-50 to-green-50 rounded-lg border border-blue-100",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2 text-center",children:" Acesso Demo Rpido"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{children:[" ",e.jsx("strong",{children:"Mdulo Bar:"})," Pedidos, comandas e vendas"]}),e.jsxs("p",{children:[" ",e.jsx("strong",{children:"Mdulo Cozinha:"})," Gesto de cardpio e pedidos"]}),e.jsxs("p",{children:[" ",e.jsx("strong",{children:"Dashboard:"})," Mtricas e relatrios"]}),e.jsxs("p",{children:[" ",e.jsx("strong",{children:"Estoque:"})," Controle de inventrio"]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-blue-200",children:e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:[" ",e.jsx("strong",{children:"Dica:"})," Use o boto verde acima para acesso instantneo!"]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["No tem uma conta?"," ",e.jsx(gs,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-medium transition-colors",children:"Cadastre-se aqui"})]})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-xs text-gray-500",children:"ClubManager Pro v1.0 - Sistema Demonstrao"})})]})})},fD=()=>{const t=Ks(),{register:s}=Et(),[a,r]=y.useState({name:"",email:"",password:"",confirmPassword:""}),[o,l]=y.useState(!1),[c,u]=y.useState(!1),[h,f]=y.useState(""),[p,g]=y.useState(""),[v,b]=y.useState(!1),_=(T,N)=>{r(k=>({...k,[T]:N})),f("")},w=()=>a.name.trim()?a.email.trim()?a.password.length<6?(f("Senha deve ter pelo menos 6 caracteres"),!1):a.password!==a.confirmPassword?(f("Senhas no coincidem"),!1):!0:(f("Email  obrigatrio"),!1):(f("Nome  obrigatrio"),!1),E=async T=>{if(T.preventDefault(),f(""),g(""),!w())return;b(!0);const N=await s(a.name,a.email,a.password);N.success?(g(" Cadastro realizado com sucesso! Voc foi registrado como ADMINISTRADOR PRINCIPAL com todos os poderes do sistema. Faa login para acessar."),r({name:"",email:"",password:"",confirmPassword:""}),setTimeout(()=>{t("/login")},3e3)):f(N.error||"Erro no cadastro. Tente novamente."),b(!1)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-slate-800 to-slate-900 flex items-center justify-center p-4",children:e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ss,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Criar Conta"}),e.jsx("p",{className:"text-gray-600",children:"ClubManager Pro"}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:" Primeiro Usurio:"})," Ser automaticamente o administrador principal com todos os poderes do sistema."]})})]}),e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Completo"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ys,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:a.name,onChange:T=>_("name",T.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Digite seu nome completo",disabled:v})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(ki,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"email",value:a.email,onChange:T=>_("email",T.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Digite seu email",disabled:v})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(dn,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:o?"text":"password",value:a.password,onChange:T=>_("password",T.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Digite sua senha",disabled:v}),e.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:v,children:o?e.jsx(fn,{size:20}):e.jsx(Ws,{size:20})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(dn,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:c?"text":"password",value:a.confirmPassword,onChange:T=>_("confirmPassword",T.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Confirme sua senha",disabled:v}),e.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:v,children:c?e.jsx(fn,{size:20}):e.jsx(Ws,{size:20})})]})]}),h&&e.jsx(be.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-600 text-sm text-center bg-red-50 p-3 rounded-lg border border-red-200",children:h}),p&&e.jsx(be.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-green-600 text-sm text-center bg-green-50 p-3 rounded-lg border border-green-200",children:p}),e.jsx(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:v,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:v?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Criando conta..."})]}):"Criar Conta"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(gs,{to:"/login",className:"inline-flex items-center space-x-2 text-blue-600 hover:text-blue-700 font-medium transition-colors",children:[e.jsx(fo,{size:16}),e.jsx("span",{children:"Voltar para o Login"})]})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-xs text-gray-500",children:"ClubManager Pro v1.0 - Sistema Demonstrao"})})]})})},pD=()=>{const{user:t,logout:s}=Et(),[a,r]=y.useState(null),[o,l]=y.useState(!0);y.useEffect(()=>{t&&(async()=>{try{const p=await n2();r(p)}catch(p){console.error("Erro ao carregar permisses:",p)}finally{l(!1)}})()},[t]);const u=[{name:"Dashboard",icon:JR,path:"/",module:"dashboard"},{name:"Monitor Bar",icon:Tc,path:"/bar",module:"monitor_bar"},{name:"Atendimento Bar",icon:DR,path:"/bar/attendance",module:"atendimento_bar"},{name:"Monitor Cozinha",icon:kc,path:"/kitchen",module:"monitor_cozinha"},{name:"Gesto de Caixa",icon:kt,path:"/cash",module:"gestao_caixa"},{name:"Clientes",icon:Ss,path:"/bar-customers",module:"clientes"},{name:"Funcionrios",icon:JN,path:"/bar-employees",module:"funcionarios"},{name:"Estoque",icon:ua,path:"/inventory",module:"funcionarios"},{name:"Scios",icon:Ss,path:"/members",module:"clientes"},{name:"Configuraes",icon:Li,path:"/settings",module:"configuracoes"},{name:"Ambiente",icon:mc,path:"/environment",module:"configuracoes"}].filter(f=>o||!a?!1:r2(a,f.module,"visualizar")),h=(t==null?void 0:t.email)==="demo@clubmanager.com";return e.jsxs(be.aside,{initial:{x:-280},animate:{x:0},transition:{duration:.3},className:"bg-slate-900 text-white w-64 h-full p-4 flex flex-col overflow-y-auto scrollbar-hide",style:{overscrollBehavior:"contain"},children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-blue-400",children:"ClubManager"}),e.jsx("p",{className:"text-slate-400 text-sm",children:"Sistema de Gesto"}),h&&e.jsxs("div",{className:"mt-2 flex items-center space-x-1 text-xs text-green-400",children:[e.jsx(kr,{size:12}),e.jsx("span",{children:"Modo Demo"})]})]}),t&&e.jsxs("div",{className:`mb-6 p-3 rounded-lg ${h?"bg-green-800 border border-green-600":"bg-slate-800"}`,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("img",{src:t.avatar||`https://api.dicebear.com/8.x/initials/svg?seed=${t.name}`,alt:t.name,className:"w-10 h-10 rounded-full"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:t.name}),e.jsx("p",{className:"text-slate-400 text-xs capitalize",children:t.role}),t.department&&e.jsx("p",{className:"text-slate-300 text-xs",children:t.department})]})]}),h&&e.jsx("div",{className:"mt-2 text-xs text-green-300",children:" Explorando funcionalidades"})]}),e.jsx("nav",{className:"flex-1 overflow-y-auto scrollbar-hide",children:o?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-400"})}):e.jsx("ul",{className:"space-y-2",children:u.length>0?u.map(f=>e.jsx("li",{children:e.jsxs(L_,{to:f.path,className:({isActive:p})=>`flex items-center space-x-3 p-3 rounded-lg transition-colors ${p?"bg-blue-600 text-white":"text-slate-300 hover:bg-slate-800 hover:text-white"}`,children:[e.jsx(f.icon,{size:20}),e.jsx("span",{children:f.name})]})},f.name)):e.jsx("li",{className:"p-3 text-slate-400 text-sm text-center",children:"Sem permisses de acesso"})})}),h&&e.jsxs("div",{className:"mb-4 p-3 bg-blue-900 rounded-lg border border-blue-700",children:[e.jsx("h4",{className:"text-sm font-semibold text-blue-200 mb-2",children:" Teste Agora:"}),e.jsxs("ul",{className:"text-xs text-blue-300 space-y-1",children:[e.jsx("li",{children:" Criar pedidos no Bar"}),e.jsx("li",{children:" Sistema de Atendimento"}),e.jsx("li",{children:" Gerenciar cozinha"}),e.jsx("li",{children:" Ver mtricas em tempo real"}),e.jsx("li",{children:" Controlar estoque"})]})]}),e.jsxs("button",{onClick:s,className:"flex items-center space-x-3 p-3 rounded-lg text-slate-300 hover:bg-slate-800 hover:text-white transition-colors mt-4",children:[e.jsx(nO,{size:20}),e.jsx("span",{children:h?"Sair do Demo":"Sair"})]})]})};class hc{constructor(s){dt(this,"supabaseClient");dt(this,"config");this.config=s,this.supabaseClient=Di(s.supabaseUrl,s.supabaseAnonKey)}async validateConnection(){const s=Date.now();try{const{data:a,error:r}=await this.supabaseClient.from("information_schema.tables").select("table_name").limit(1),o=Date.now()-s;return r?{isConnected:!1,responseTime:o,error:r.message}:{isConnected:!0,responseTime:o,databaseInfo:{version:"PostgreSQL",name:this.config.databaseName}}}catch(a){return{isConnected:!1,responseTime:Date.now()-s,error:a instanceof Error?a.message:"Erro desconhecido"}}}async performHealthCheck(){const s=await Promise.allSettled([this.checkDatabase(),this.checkAuth(),this.checkStorage(),this.checkRealtime()]),[a,r,o,l]=s.map(p=>p.status==="fulfilled"?p.value:{isConnected:!1,responseTime:0,error:"Falha na verificao"}),c=[a,r,o,l],h=c.filter(p=>p.isConnected).length/c.length*100;let f;return h===100?f="healthy":h>=50?f="degraded":f="unhealthy",{database:a,auth:r,storage:o,realtime:l,overall:{status:f,score:h}}}async checkDatabase(){return this.validateConnection()}async checkAuth(){const s=Date.now();try{const{data:a,error:r}=await this.supabaseClient.auth.getSession(),o=Date.now()-s;return r&&r.message!=="No session found"?{isConnected:!1,responseTime:o,error:r.message}:{isConnected:!0,responseTime:o}}catch(a){return{isConnected:!1,responseTime:Date.now()-s,error:a instanceof Error?a.message:"Erro no servio de auth"}}}async checkStorage(){const s=Date.now();try{const{data:a,error:r}=await this.supabaseClient.storage.listBuckets(),o=Date.now()-s;return r?{isConnected:!1,responseTime:o,error:r.message}:{isConnected:!0,responseTime:o}}catch(a){return{isConnected:!1,responseTime:Date.now()-s,error:a instanceof Error?a.message:"Erro no servio de storage"}}}async checkRealtime(){const s=Date.now();try{const a=this.supabaseClient.channel("health-check");return new Promise(r=>{const o=setTimeout(()=>{a.unsubscribe(),r({isConnected:!1,responseTime:Date.now()-s,error:"Timeout na conexo realtime"})},5e3);a.on("presence",{event:"sync"},()=>{clearTimeout(o),a.unsubscribe(),r({isConnected:!0,responseTime:Date.now()-s})}).subscribe(l=>{l==="SUBSCRIBED"&&(clearTimeout(o),a.unsubscribe(),r({isConnected:!0,responseTime:Date.now()-s}))})})}catch(a){return{isConnected:!1,responseTime:Date.now()-s,error:a instanceof Error?a.message:"Erro no servio de realtime"}}}static async testConfiguration(s){return new hc(s).validateConnection()}static async compareEnvironments(s,a){const[r,o]=await Promise.all([hc.testConfiguration(s),hc.testConfiguration(a)]);return{development:r,production:o,comparison:{bothConnected:r.isConnected&&o.isConnected,performanceDiff:o.responseTime-r.responseTime}}}}const Zn=class Zn{constructor(){dt(this,"environmentManager");dt(this,"connectivityValidator",null);dt(this,"isInitialized",!1);dt(this,"initializationPromise",null);this.environmentManager=gm}static getInstance(){return Zn.instance||(Zn.instance=new Zn),Zn.instance}async initialize(){if(this.initializationPromise)return this.initializationPromise;if(this.isInitialized){const s=await this.environmentManager.getCurrentEnvironment(),a=this.connectivityValidator?await this.connectivityValidator.validateConnection():{isConnected:!1};return{config:s,connectivity:a.isConnected,environment:s.name}}this.initializationPromise=this.performInitialization();try{const s=await this.initializationPromise;return this.isInitialized=!0,s}finally{this.initializationPromise=null}}async performInitialization(){try{console.log(" Inicializando sistema de ambientes...");const s=await this.environmentManager.getCurrentEnvironment();console.log(` Ambiente detectado: ${s.name}`),console.log(` Banco de dados: ${s.databaseName}`);const a=s.supabaseUrl&&s.supabaseUrl!=="https://your-project-dev.supabase.co"&&s.supabaseUrl!=="https://your-project-prod.supabase.co"&&s.supabaseAnonKey&&s.supabaseAnonKey!=="your_development_anon_key_here"&&s.supabaseAnonKey!=="your_production_anon_key_here";let r={isConnected:!1,responseTime:0,error:"Configurao no definida"};if(a?(this.connectivityValidator=new hc(s),console.log(" Validando conectividade..."),r=await this.connectivityValidator.validateConnection(),r.isConnected?console.log(` Conectado ao Supabase (${r.responseTime}ms)`):console.warn(` Falha na conectividade: ${r.error}`)):console.warn(" Configuraes do Supabase no definidas. Configure os arquivos .env para conectividade completa."),s.debugMode){const o=await this.environmentManager.getEnvironmentInfo();console.log(" Informaes de debug:",o)}return{config:s,connectivity:r.isConnected,environment:s.name}}catch(s){throw console.error(" Erro na inicializao do sistema de ambientes:",s),s}}async getConfig(){return this.isInitialized||await this.initialize(),this.environmentManager.getCurrentEnvironment()}async performHealthCheck(){if(!this.connectivityValidator)throw new Error("Sistema no inicializado. Chame initialize() primeiro.");return this.connectivityValidator.performHealthCheck()}switchEnvironment(s){this.environmentManager.switchEnvironment(s),this.connectivityValidator=null,this.isInitialized=!1}async getSystemInfo(){const s=await this.getConfig(),a=await this.environmentManager.getEnvironmentInfo(),r=await this.performHealthCheck();return{environment:s.name,branch:a.branch,database:s.databaseName,connectivity:r,initialized:this.isInitialized}}};dt(Zn,"instance");let y0=Zn;const br=y0.getInstance(),b0=[],v0=t=>{b0.push(t)},gD=async t=>{console.log(` Executando ${b0.length} callbacks de mudana de ambiente`);for(const s of b0)try{await s(t)}catch(a){console.error("Erro ao executar callback de mudana de ambiente:",a)}},xD={initialize:async()=>{console.log(" Inicializando middleware de ambiente..."),v0(async t=>{console.log(` Reinicializando Supabase para ambiente: ${t}`),await i3()}),v0(async t=>{console.log(` Ambiente alterado para: ${t}`)}),console.log(" Middleware de ambiente inicializado")},switchEnvironment:async t=>{try{console.log(` Iniciando troca para ambiente: ${t}`),br.switchEnvironment(t),await gD(t),await br.initialize(),console.log(` Troca de ambiente concluda: ${t}`)}catch(s){throw console.error(" Erro na troca de ambiente:",s),s}},getCurrentEnvironment:async()=>{try{const t=await br.getConfig();return{name:t.name,databaseName:t.databaseName,debugMode:t.debugMode,isConnected:!0}}catch(t){return console.error("Erro ao obter ambiente atual:",t),null}},performHealthCheck:async()=>{try{return await br.performHealthCheck()}catch(t){throw console.error("Erro no health check:",t),t}}};v0(async t=>{t==="development"?(console.log(" Modo desenvolvimento ativado"),typeof window<"u"&&(window.__ENVIRONMENT__="development")):(console.log(" Modo produo ativado"),typeof window<"u"&&(window.__ENVIRONMENT__="production"))});const o2=y.createContext(void 0),yD=({children:t})=>{const[s,a]=y.useState(null),[r,o]=y.useState(!0),[l,c]=y.useState(null),[u,h]=y.useState(!1),[f,p]=y.useState(null),[g,v]=y.useState(null),b=async()=>{try{o(!0),c(null),console.log(" Inicializando sistema de ambientes...");const N=await br.initialize();if(a(N.config),h(N.connectivity),v(N.environment),N.connectivity)try{const k=await br.performHealthCheck();p(k)}catch(k){console.warn("Health check inicial falhou:",k)}console.log(` Sistema de ambientes inicializado: ${N.environment}`)}catch(N){const k=N instanceof Error?N.message:"Erro desconhecido na inicializao";console.error(" Erro na inicializao do sistema de ambientes:",N),c(k),h(!1)}finally{o(!1)}},_=async N=>{try{o(!0),c(null),await xD.switchEnvironment(N);const k=await br.getConfig();a(k),v(k.name)}catch(k){const S=k instanceof Error?k.message:"Erro na troca de ambiente";console.error(" Erro na troca de ambiente:",k),c(S)}finally{o(!1)}},w=async()=>{try{console.log(" Executando health check...");const N=await br.performHealthCheck();p(N),h(N.overall.status!=="unhealthy"),console.log(` Health check concludo: ${N.overall.status} (${N.overall.score}%)`)}catch(N){const k=N instanceof Error?N.message:"Erro no health check";console.error(" Erro no health check:",N),c(k),h(!1),p(null)}},E=async()=>{try{return await br.getSystemInfo()}catch(N){throw console.error(" Erro ao obter informaes do sistema:",N),N}};y.useEffect(()=>{b()},[]);const T={config:s,isLoading:r,error:l,isConnected:u,healthStatus:f,environment:g,initialize:b,switchEnvironment:_,performHealthCheck:w,getSystemInfo:E};return e.jsx(o2.Provider,{value:T,children:t})},jg=()=>{const t=y.useContext(o2);if(t===void 0)throw new Error("useEnvironmentContext deve ser usado dentro de um EnvironmentProvider");return t},bD=()=>{const{notifications:t,clearNotifications:s}=Tt(),{environment:a,isConnected:r,config:o}=jg(),[l,c]=Ye.useState(!1),[u,h]=Ye.useState(!1);return e.jsx("header",{className:"bg-white border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-4",children:e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:new Date().toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>h(!u),className:`flex items-center space-x-2 px-3 py-1 rounded-full text-xs font-medium transition-colors ${a==="production"?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:[e.jsx(mc,{size:12}),e.jsx("span",{children:a==="production"?"PRODUO":"DESENVOLVIMENTO"}),e.jsx("div",{className:`w-2 h-2 rounded-full ${r?"bg-green-500":"bg-red-500"}`})]}),e.jsx(Wa,{children:u&&e.jsx(be.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Informaes do Ambiente"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Ambiente:"}),e.jsx("span",{className:"font-medium",children:a})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("span",{className:`font-medium ${r?"text-green-600":"text-red-600"}`,children:r?"Conectado":"Desconectado"})]}),o&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Banco:"}),e.jsx("span",{className:"font-mono text-xs",children:o.databaseName})]})]})]})})})]}),e.jsxs("div",{className:"relative",children:[e.jsx(Ka,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>c(!l),className:"relative p-2 text-gray-600 hover:text-gray-800 transition-colors",children:[e.jsx(yg,{size:20}),t.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:t.length})]}),e.jsx(Wa,{children:l&&e.jsxs(be.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 mt-2 w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Notificaes"}),t.length>0&&e.jsx("button",{onClick:s,className:"text-sm text-blue-600 hover:text-blue-800",children:"Limpar todas"})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:t.length===0?e.jsx("p",{className:"p-4 text-gray-500 text-center",children:"Nenhuma notificao"}):t.map((f,p)=>e.jsx("div",{className:"p-3 border-b border-gray-100 last:border-b-0",children:e.jsx("p",{className:"text-sm text-gray-700",children:f})},p))})]})})]})]})]})})},vD=()=>e.jsxs("div",{className:"flex h-screen bg-gray-50 overflow-hidden",children:[e.jsx(pD,{}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(bD,{}),e.jsx("main",{className:"flex-1 overflow-y-auto p-6",style:{overscrollBehavior:"none"},children:e.jsx(O4,{})})]})]}),i2=6048e5,wD=864e5,Ej=Symbol.for("constructDateFrom");function Ea(t,s){return typeof t=="function"?t(s):t&&typeof t=="object"&&Ej in t?t[Ej](s):t instanceof Date?new t.constructor(s):new Date(s)}function ds(t,s){return Ea(s||t,t)}function jD(t,s,a){const r=ds(t,a==null?void 0:a.in);return isNaN(s)?Ea(t,NaN):(s&&r.setDate(r.getDate()+s),r)}function _D(t,s,a){const r=ds(t,a==null?void 0:a.in);if(isNaN(s))return Ea(t,NaN);const o=r.getDate(),l=Ea(t,r.getTime());l.setMonth(r.getMonth()+s+1,0);const c=l.getDate();return o>=c?l:(r.setFullYear(l.getFullYear(),l.getMonth(),o),r)}let ND={};function jm(){return ND}function Mc(t,s){var u,h,f,p;const a=jm(),r=(s==null?void 0:s.weekStartsOn)??((h=(u=s==null?void 0:s.locale)==null?void 0:u.options)==null?void 0:h.weekStartsOn)??a.weekStartsOn??((p=(f=a.locale)==null?void 0:f.options)==null?void 0:p.weekStartsOn)??0,o=ds(t,s==null?void 0:s.in),l=o.getDay(),c=(l<r?7:0)+l-r;return o.setDate(o.getDate()-c),o.setHours(0,0,0,0),o}function Ku(t,s){return Mc(t,{...s,weekStartsOn:1})}function l2(t,s){const a=ds(t,s==null?void 0:s.in),r=a.getFullYear(),o=Ea(a,0);o.setFullYear(r+1,0,4),o.setHours(0,0,0,0);const l=Ku(o),c=Ea(a,0);c.setFullYear(r,0,4),c.setHours(0,0,0,0);const u=Ku(c);return a.getTime()>=l.getTime()?r+1:a.getTime()>=u.getTime()?r:r-1}function Cj(t){const s=ds(t),a=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return a.setUTCFullYear(s.getFullYear()),+t-+a}function SD(t,...s){const a=Ea.bind(null,s.find(r=>typeof r=="object"));return s.map(a)}function Ii(t,s){const a=ds(t,s==null?void 0:s.in);return a.setHours(0,0,0,0),a}function ED(t,s,a){const[r,o]=SD(a==null?void 0:a.in,t,s),l=Ii(r),c=Ii(o),u=+l-Cj(l),h=+c-Cj(c);return Math.round((u-h)/wD)}function CD(t,s){const a=l2(t,s),r=Ea(t,0);return r.setFullYear(a,0,4),r.setHours(0,0,0,0),Ku(r)}function kD(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function TD(t){return!(!kD(t)&&typeof t!="number"||isNaN(+ds(t)))}function Xu(t,s){const a=ds(t,s==null?void 0:s.in);return a.setHours(23,59,59,999),a}function AD(t,s){const a=ds(t,s==null?void 0:s.in);return a.setFullYear(a.getFullYear(),0,1),a.setHours(0,0,0,0),a}const MD={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},RD=(t,s,a)=>{let r;const o=MD[t];return typeof o=="string"?r=o:s===1?r=o.one:r=o.other.replace("{{count}}",s.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+r:r+" ago":r};function Ti(t){return(s={})=>{const a=s.width?String(s.width):t.defaultWidth;return t.formats[a]||t.formats[t.defaultWidth]}}const OD={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},DD={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},PD={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},zD={date:Ti({formats:OD,defaultWidth:"full"}),time:Ti({formats:DD,defaultWidth:"full"}),dateTime:Ti({formats:PD,defaultWidth:"full"})},$D={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},LD=(t,s,a,r)=>$D[t];function Ia(t){return(s,a)=>{const r=a!=null&&a.context?String(a.context):"standalone";let o;if(r==="formatting"&&t.formattingValues){const c=t.defaultFormattingWidth||t.defaultWidth,u=a!=null&&a.width?String(a.width):c;o=t.formattingValues[u]||t.formattingValues[c]}else{const c=t.defaultWidth,u=a!=null&&a.width?String(a.width):t.defaultWidth;o=t.values[u]||t.values[c]}const l=t.argumentCallback?t.argumentCallback(s):s;return o[l]}}const ID={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},UD={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},BD={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},VD={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},qD={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},FD={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},HD=(t,s)=>{const a=Number(t),r=a%100;if(r>20||r<10)switch(r%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},GD={ordinalNumber:HD,era:Ia({values:ID,defaultWidth:"wide"}),quarter:Ia({values:UD,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ia({values:BD,defaultWidth:"wide"}),day:Ia({values:VD,defaultWidth:"wide"}),dayPeriod:Ia({values:qD,defaultWidth:"wide",formattingValues:FD,defaultFormattingWidth:"wide"})};function Ua(t){return(s,a={})=>{const r=a.width,o=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],l=s.match(o);if(!l)return null;const c=l[0],u=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],h=Array.isArray(u)?WD(u,g=>g.test(c)):ZD(u,g=>g.test(c));let f;f=t.valueCallback?t.valueCallback(h):h,f=a.valueCallback?a.valueCallback(f):f;const p=s.slice(c.length);return{value:f,rest:p}}}function ZD(t,s){for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&s(t[a]))return a}function WD(t,s){for(let a=0;a<t.length;a++)if(s(t[a]))return a}function c2(t){return(s,a={})=>{const r=s.match(t.matchPattern);if(!r)return null;const o=r[0],l=s.match(t.parsePattern);if(!l)return null;let c=t.valueCallback?t.valueCallback(l[0]):l[0];c=a.valueCallback?a.valueCallback(c):c;const u=s.slice(o.length);return{value:c,rest:u}}}const YD=/^(\d+)(th|st|nd|rd)?/i,KD=/\d+/i,XD={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},QD={any:[/^b/i,/^(a|c)/i]},JD={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},eP={any:[/1/i,/2/i,/3/i,/4/i]},tP={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},sP={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},aP={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},rP={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},nP={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},oP={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},iP={ordinalNumber:c2({matchPattern:YD,parsePattern:KD,valueCallback:t=>parseInt(t,10)}),era:Ua({matchPatterns:XD,defaultMatchWidth:"wide",parsePatterns:QD,defaultParseWidth:"any"}),quarter:Ua({matchPatterns:JD,defaultMatchWidth:"wide",parsePatterns:eP,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ua({matchPatterns:tP,defaultMatchWidth:"wide",parsePatterns:sP,defaultParseWidth:"any"}),day:Ua({matchPatterns:aP,defaultMatchWidth:"wide",parsePatterns:rP,defaultParseWidth:"any"}),dayPeriod:Ua({matchPatterns:nP,defaultMatchWidth:"any",parsePatterns:oP,defaultParseWidth:"any"})},lP={code:"en-US",formatDistance:RD,formatLong:zD,formatRelative:LD,localize:GD,match:iP,options:{weekStartsOn:0,firstWeekContainsDate:1}};function cP(t,s){const a=ds(t,s==null?void 0:s.in);return ED(a,AD(a))+1}function dP(t,s){const a=ds(t,s==null?void 0:s.in),r=+Ku(a)-+CD(a);return Math.round(r/i2)+1}function d2(t,s){var p,g,v,b;const a=ds(t,s==null?void 0:s.in),r=a.getFullYear(),o=jm(),l=(s==null?void 0:s.firstWeekContainsDate)??((g=(p=s==null?void 0:s.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??o.firstWeekContainsDate??((b=(v=o.locale)==null?void 0:v.options)==null?void 0:b.firstWeekContainsDate)??1,c=Ea((s==null?void 0:s.in)||t,0);c.setFullYear(r+1,0,l),c.setHours(0,0,0,0);const u=Mc(c,s),h=Ea((s==null?void 0:s.in)||t,0);h.setFullYear(r,0,l),h.setHours(0,0,0,0);const f=Mc(h,s);return+a>=+u?r+1:+a>=+f?r:r-1}function uP(t,s){var u,h,f,p;const a=jm(),r=(s==null?void 0:s.firstWeekContainsDate)??((h=(u=s==null?void 0:s.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((p=(f=a.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)??1,o=d2(t,s),l=Ea((s==null?void 0:s.in)||t,0);return l.setFullYear(o,0,r),l.setHours(0,0,0,0),Mc(l,s)}function mP(t,s){const a=ds(t,s==null?void 0:s.in),r=+Mc(a,s)-+uP(a,s);return Math.round(r/i2)+1}function pt(t,s){const a=t<0?"-":"",r=Math.abs(t).toString().padStart(s,"0");return a+r}const nn={y(t,s){const a=t.getFullYear(),r=a>0?a:1-a;return pt(s==="yy"?r%100:r,s.length)},M(t,s){const a=t.getMonth();return s==="M"?String(a+1):pt(a+1,2)},d(t,s){return pt(t.getDate(),s.length)},a(t,s){const a=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h(t,s){return pt(t.getHours()%12||12,s.length)},H(t,s){return pt(t.getHours(),s.length)},m(t,s){return pt(t.getMinutes(),s.length)},s(t,s){return pt(t.getSeconds(),s.length)},S(t,s){const a=s.length,r=t.getMilliseconds(),o=Math.trunc(r*Math.pow(10,a-3));return pt(o,s.length)}},di={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},kj={G:function(t,s,a){const r=t.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})}},y:function(t,s,a){if(s==="yo"){const r=t.getFullYear(),o=r>0?r:1-r;return a.ordinalNumber(o,{unit:"year"})}return nn.y(t,s)},Y:function(t,s,a,r){const o=d2(t,r),l=o>0?o:1-o;if(s==="YY"){const c=l%100;return pt(c,2)}return s==="Yo"?a.ordinalNumber(l,{unit:"year"}):pt(l,s.length)},R:function(t,s){const a=l2(t);return pt(a,s.length)},u:function(t,s){const a=t.getFullYear();return pt(a,s.length)},Q:function(t,s,a){const r=Math.ceil((t.getMonth()+1)/3);switch(s){case"Q":return String(r);case"QQ":return pt(r,2);case"Qo":return a.ordinalNumber(r,{unit:"quarter"});case"QQQ":return a.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,s,a){const r=Math.ceil((t.getMonth()+1)/3);switch(s){case"q":return String(r);case"qq":return pt(r,2);case"qo":return a.ordinalNumber(r,{unit:"quarter"});case"qqq":return a.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,s,a){const r=t.getMonth();switch(s){case"M":case"MM":return nn.M(t,s);case"Mo":return a.ordinalNumber(r+1,{unit:"month"});case"MMM":return a.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(r,{width:"wide",context:"formatting"})}},L:function(t,s,a){const r=t.getMonth();switch(s){case"L":return String(r+1);case"LL":return pt(r+1,2);case"Lo":return a.ordinalNumber(r+1,{unit:"month"});case"LLL":return a.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(r,{width:"wide",context:"standalone"})}},w:function(t,s,a,r){const o=mP(t,r);return s==="wo"?a.ordinalNumber(o,{unit:"week"}):pt(o,s.length)},I:function(t,s,a){const r=dP(t);return s==="Io"?a.ordinalNumber(r,{unit:"week"}):pt(r,s.length)},d:function(t,s,a){return s==="do"?a.ordinalNumber(t.getDate(),{unit:"date"}):nn.d(t,s)},D:function(t,s,a){const r=cP(t);return s==="Do"?a.ordinalNumber(r,{unit:"dayOfYear"}):pt(r,s.length)},E:function(t,s,a){const r=t.getDay();switch(s){case"E":case"EE":case"EEE":return a.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(r,{width:"short",context:"formatting"});case"EEEE":default:return a.day(r,{width:"wide",context:"formatting"})}},e:function(t,s,a,r){const o=t.getDay(),l=(o-r.weekStartsOn+8)%7||7;switch(s){case"e":return String(l);case"ee":return pt(l,2);case"eo":return a.ordinalNumber(l,{unit:"day"});case"eee":return a.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(o,{width:"short",context:"formatting"});case"eeee":default:return a.day(o,{width:"wide",context:"formatting"})}},c:function(t,s,a,r){const o=t.getDay(),l=(o-r.weekStartsOn+8)%7||7;switch(s){case"c":return String(l);case"cc":return pt(l,s.length);case"co":return a.ordinalNumber(l,{unit:"day"});case"ccc":return a.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(o,{width:"narrow",context:"standalone"});case"cccccc":return a.day(o,{width:"short",context:"standalone"});case"cccc":default:return a.day(o,{width:"wide",context:"standalone"})}},i:function(t,s,a){const r=t.getDay(),o=r===0?7:r;switch(s){case"i":return String(o);case"ii":return pt(o,s.length);case"io":return a.ordinalNumber(o,{unit:"day"});case"iii":return a.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(r,{width:"short",context:"formatting"});case"iiii":default:return a.day(r,{width:"wide",context:"formatting"})}},a:function(t,s,a){const o=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(t,s,a){const r=t.getHours();let o;switch(r===12?o=di.noon:r===0?o=di.midnight:o=r/12>=1?"pm":"am",s){case"b":case"bb":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(t,s,a){const r=t.getHours();let o;switch(r>=17?o=di.evening:r>=12?o=di.afternoon:r>=4?o=di.morning:o=di.night,s){case"B":case"BB":case"BBB":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(t,s,a){if(s==="ho"){let r=t.getHours()%12;return r===0&&(r=12),a.ordinalNumber(r,{unit:"hour"})}return nn.h(t,s)},H:function(t,s,a){return s==="Ho"?a.ordinalNumber(t.getHours(),{unit:"hour"}):nn.H(t,s)},K:function(t,s,a){const r=t.getHours()%12;return s==="Ko"?a.ordinalNumber(r,{unit:"hour"}):pt(r,s.length)},k:function(t,s,a){let r=t.getHours();return r===0&&(r=24),s==="ko"?a.ordinalNumber(r,{unit:"hour"}):pt(r,s.length)},m:function(t,s,a){return s==="mo"?a.ordinalNumber(t.getMinutes(),{unit:"minute"}):nn.m(t,s)},s:function(t,s,a){return s==="so"?a.ordinalNumber(t.getSeconds(),{unit:"second"}):nn.s(t,s)},S:function(t,s){return nn.S(t,s)},X:function(t,s,a){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(s){case"X":return Aj(r);case"XXXX":case"XX":return Fn(r);case"XXXXX":case"XXX":default:return Fn(r,":")}},x:function(t,s,a){const r=t.getTimezoneOffset();switch(s){case"x":return Aj(r);case"xxxx":case"xx":return Fn(r);case"xxxxx":case"xxx":default:return Fn(r,":")}},O:function(t,s,a){const r=t.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+Tj(r,":");case"OOOO":default:return"GMT"+Fn(r,":")}},z:function(t,s,a){const r=t.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+Tj(r,":");case"zzzz":default:return"GMT"+Fn(r,":")}},t:function(t,s,a){const r=Math.trunc(+t/1e3);return pt(r,s.length)},T:function(t,s,a){return pt(+t,s.length)}};function Tj(t,s=""){const a=t>0?"-":"+",r=Math.abs(t),o=Math.trunc(r/60),l=r%60;return l===0?a+String(o):a+String(o)+s+pt(l,2)}function Aj(t,s){return t%60===0?(t>0?"-":"+")+pt(Math.abs(t)/60,2):Fn(t,s)}function Fn(t,s=""){const a=t>0?"-":"+",r=Math.abs(t),o=pt(Math.trunc(r/60),2),l=pt(r%60,2);return a+o+s+l}const Mj=(t,s)=>{switch(t){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},u2=(t,s)=>{switch(t){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},hP=(t,s)=>{const a=t.match(/(P+)(p+)?/)||[],r=a[1],o=a[2];if(!o)return Mj(t,s);let l;switch(r){case"P":l=s.dateTime({width:"short"});break;case"PP":l=s.dateTime({width:"medium"});break;case"PPP":l=s.dateTime({width:"long"});break;case"PPPP":default:l=s.dateTime({width:"full"});break}return l.replace("{{date}}",Mj(r,s)).replace("{{time}}",u2(o,s))},fP={p:u2,P:hP},pP=/^D+$/,gP=/^Y+$/,xP=["D","DD","YY","YYYY"];function yP(t){return pP.test(t)}function bP(t){return gP.test(t)}function vP(t,s,a){const r=wP(t,s,a);if(console.warn(r),xP.includes(t))throw new RangeError(r)}function wP(t,s,a){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${s}\`) for formatting ${r} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const jP=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,_P=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,NP=/^'([^]*?)'?$/,SP=/''/g,EP=/[a-zA-Z]/;function St(t,s,a){var p,g,v,b,_,w,E,T;const r=jm(),o=(a==null?void 0:a.locale)??r.locale??lP,l=(a==null?void 0:a.firstWeekContainsDate)??((g=(p=a==null?void 0:a.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??r.firstWeekContainsDate??((b=(v=r.locale)==null?void 0:v.options)==null?void 0:b.firstWeekContainsDate)??1,c=(a==null?void 0:a.weekStartsOn)??((w=(_=a==null?void 0:a.locale)==null?void 0:_.options)==null?void 0:w.weekStartsOn)??r.weekStartsOn??((T=(E=r.locale)==null?void 0:E.options)==null?void 0:T.weekStartsOn)??0,u=ds(t,a==null?void 0:a.in);if(!TD(u))throw new RangeError("Invalid time value");let h=s.match(_P).map(N=>{const k=N[0];if(k==="p"||k==="P"){const S=fP[k];return S(N,o.formatLong)}return N}).join("").match(jP).map(N=>{if(N==="''")return{isToken:!1,value:"'"};const k=N[0];if(k==="'")return{isToken:!1,value:CP(N)};if(kj[k])return{isToken:!0,value:N};if(k.match(EP))throw new RangeError("Format string contains an unescaped latin alphabet character `"+k+"`");return{isToken:!1,value:N}});o.localize.preprocessor&&(h=o.localize.preprocessor(u,h));const f={firstWeekContainsDate:l,weekStartsOn:c,locale:o};return h.map(N=>{if(!N.isToken)return N.value;const k=N.value;(!(a!=null&&a.useAdditionalWeekYearTokens)&&bP(k)||!(a!=null&&a.useAdditionalDayOfYearTokens)&&yP(k))&&vP(k,s,String(t));const S=kj[k[0]];return S(u,k,o.localize,f)}).join("")}function CP(t){const s=t.match(NP);return s?s[1].replace(SP,"'"):t}function kP(t,s){return+ds(t)>+ds(s)}function Qu(t,s,a){const r=+ds(t,a==null?void 0:a.in),[o,l]=[+ds(s.start,a==null?void 0:a.in),+ds(s.end,a==null?void 0:a.in)].sort((c,u)=>c-u);return r>=o&&r<=l}function eo(t,s,a){return jD(t,-s,a)}function TP(t,s,a){return _D(t,-1,a)}const AP={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 ms",other:"cerca de {{count}} meses"},xMonths:{one:"1 ms",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},MP=(t,s,a)=>{let r;const o=AP[t];return typeof o=="string"?r=o:s===1?r=o.one:r=o.other.replace("{{count}}",String(s)),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"em "+r:"h "+r:r},RP={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},OP={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},DP={full:"{{date}} 's' {{time}}",long:"{{date}} 's' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},PP={date:Ti({formats:RP,defaultWidth:"full"}),time:Ti({formats:OP,defaultWidth:"full"}),dateTime:Ti({formats:DP,defaultWidth:"full"})},zP={lastWeek:t=>{const s=t.getDay();return"'"+(s===0||s===6?"ltimo":"ltima")+"' eeee 's' p"},yesterday:"'ontem s' p",today:"'hoje s' p",tomorrow:"'amanh s' p",nextWeek:"eeee 's' p",other:"P"},$P=(t,s,a,r)=>{const o=zP[t];return typeof o=="function"?o(s):o},LP={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},IP={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1 trimestre","2 trimestre","3 trimestre","4 trimestre"]},UP={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","maro","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},BP={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","tera","quarta","quinta","sexta","sbado"],wide:["domingo","segunda-feira","tera-feira","quarta-feira","quinta-feira","sexta-feira","sbado"]},VP={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manh",afternoon:"tarde",evening:"tarde",night:"noite"}},qP={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manh",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},FP=(t,s)=>{const a=Number(t);return(s==null?void 0:s.unit)==="week"?a+"":a+""},HP={ordinalNumber:FP,era:Ia({values:LP,defaultWidth:"wide"}),quarter:Ia({values:IP,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ia({values:UP,defaultWidth:"wide"}),day:Ia({values:BP,defaultWidth:"wide"}),dayPeriod:Ia({values:VP,defaultWidth:"wide",formattingValues:qP,defaultFormattingWidth:"wide"})},GP=/^(\d+)[o]?/i,ZP=/\d+/i,WP={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},YP={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},KP={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234]()? trimestre/i},XP={any:[/1/i,/2/i,/3/i,/4/i]},QP={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|maro|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},JP={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},e8={narrow:/^(dom|[23456]?|s[a]b)/i,short:/^(dom|[23456]?|s[a]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[a]b)/i,wide:/^(domingo|(segunda|ter[c]a|quarta|quinta|sexta)([- ]feira)?|s[a]bado)/i},t8={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[a]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[a]b/i]},s8={narrow:/^(a|p|mn|md|(da) (manh|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manh|tarde|noite))/i},a8={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manh/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},r8={ordinalNumber:c2({matchPattern:GP,parsePattern:ZP,valueCallback:t=>parseInt(t,10)}),era:Ua({matchPatterns:WP,defaultMatchWidth:"wide",parsePatterns:YP,defaultParseWidth:"any"}),quarter:Ua({matchPatterns:KP,defaultMatchWidth:"wide",parsePatterns:XP,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ua({matchPatterns:QP,defaultMatchWidth:"wide",parsePatterns:JP,defaultParseWidth:"any"}),day:Ua({matchPatterns:e8,defaultMatchWidth:"wide",parsePatterns:t8,defaultParseWidth:"any"}),dayPeriod:Ua({matchPatterns:s8,defaultMatchWidth:"any",parsePatterns:a8,defaultParseWidth:"any"})},ss={code:"pt-BR",formatDistance:MP,formatLong:PP,formatRelative:$P,localize:HP,match:r8,options:{weekStartsOn:0,firstWeekContainsDate:1}},n8=()=>{const t=Ks(),{orders:s,inventory:a,notifications:r}=Tt(),{user:o}=Et(),l=s.filter(g=>g.status==="delivered"&&St(g.updatedAt,"yyyy-MM-dd")===St(new Date,"yyyy-MM-dd")),c=l.reduce((g,v)=>g+v.total,0),u=s.filter(g=>g.status==="pending").length,h=a.filter(g=>g.currentStock<=g.minStock).length,f=(o==null?void 0:o.email)==="demo@clubmanager.com",p=[{title:"Faturamento Hoje",value:`R$ ${c.toFixed(2)}`,icon:kt,color:"text-green-600",bgColor:"bg-green-100"},{title:"Pedidos Pendentes",value:u,icon:Vt,color:"text-orange-600",bgColor:"bg-orange-100"},{title:"Vendas Hoje",value:l.length,icon:pn,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Estoque Baixo",value:h,icon:mt,color:"text-red-600",bgColor:"bg-red-100"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:["Dashboard Executivo",f&&e.jsx("span",{className:"ml-3 text-lg text-green-600 font-normal",children:" Modo Demo Ativo"})]}),e.jsx("p",{className:"text-gray-600",children:"Viso geral das operaes do clube"})]}),f&&e.jsxs(be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3},className:"bg-gradient-to-r from-green-500 to-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2",children:[e.jsx(kr,{size:16}),e.jsx("span",{className:"text-sm font-medium",children:"Teste todas as funcionalidades!"})]})]})}),f&&e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"bg-gradient-to-r from-blue-50 to-green-50 border border-blue-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"p-3 bg-blue-600 rounded-full",children:e.jsx(kr,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:" Bem-vindo ao ClubManager Demo!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Explore todos os mdulos e funcionalidades do sistema. Voc pode criar pedidos, gerenciar a cozinha, controlar estoque e muito mais!"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(gs,{to:"/bar",className:"flex items-center justify-between p-3 bg-white rounded-lg border border-blue-200 hover:border-blue-400 transition-colors group",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Tc,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"font-medium text-gray-800",children:"Testar Mdulo Bar"})]}),e.jsx(no,{className:"w-4 h-4 text-gray-400 group-hover:text-blue-600 transition-colors"})]}),e.jsxs(gs,{to:"/kitchen",className:"flex items-center justify-between p-3 bg-white rounded-lg border border-green-200 hover:border-green-400 transition-colors group",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(kc,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-medium text-gray-800",children:"Testar Mdulo Cozinha"})]}),e.jsx(no,{className:"w-4 h-4 text-gray-400 group-hover:text-green-600 transition-colors"})]})]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:p.map((g,v)=>{const b=g.title==="Estoque Baixo";return e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:v*.1},className:`bg-white rounded-lg shadow-md p-6 ${b?"cursor-pointer hover:shadow-lg transition-shadow":""}`,onClick:b?()=>t("/inventory/estoque-baixo"):void 0,whileHover:b?{scale:1.02}:{},whileTap:b?{scale:.98}:{},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:g.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:g.value})]}),e.jsx("div",{className:`p-3 rounded-full ${g.bgColor}`,children:e.jsx(g.icon,{className:`w-6 h-6 ${g.color}`})})]})},g.title)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(be.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Pedidos Recentes"}),e.jsxs("div",{className:"space-y-3",children:[s.slice(0,5).map(g=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:g.tableNumber?`Mesa ${g.tableNumber}`:"Balco"}),e.jsx("p",{className:"text-sm text-gray-600",children:St(g.createdAt,"HH:mm",{locale:ss})})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium text-gray-800",children:["R$ ",g.total.toFixed(2)]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${g.status==="pending"?"bg-yellow-100 text-yellow-800":g.status==="preparing"?"bg-blue-100 text-blue-800":g.status==="ready"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:g.status==="pending"?"Pendente":g.status==="preparing"?"Preparando":g.status==="ready"?"Pronto":"Entregue"})]})]},g.id)),s.length===0&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-500 mb-2",children:"Nenhum pedido ainda"}),f&&e.jsx(gs,{to:"/bar",className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Criar primeiro pedido "})]})]})]}),e.jsxs(be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.3},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Alertas de Estoque"}),e.jsxs("div",{className:"space-y-3",children:[a.filter(g=>g.currentStock<=g.minStock).slice(0,5).map(g=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg border border-red-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:g.name}),e.jsx("p",{className:"text-sm text-gray-600",children:g.category})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium text-red-600",children:[g.currentStock," ",g.unit]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Mn: ",g.minStock]})]})]},g.id)),a.filter(g=>g.currentStock<=g.minStock).length===0&&e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Todos os itens com estoque adequado"})]})]})]}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Mdulos Disponveis"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(gs,{to:"/bar",className:"p-4 border border-gray-200 rounded-lg hover:border-blue-300 transition-colors cursor-pointer group",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Tc,{className:"w-5 h-5 text-blue-600"}),e.jsx("h4",{className:"font-medium text-gray-800 group-hover:text-blue-600 transition-colors",children:"Mdulo Bar"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Gesto completa de pedidos, comandas e vendas do bar"})]}),e.jsxs(gs,{to:"/cash",className:"p-4 border border-gray-200 rounded-lg hover:border-green-300 transition-colors cursor-pointer group",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(kt,{className:"w-5 h-5 text-green-600"}),e.jsx("h4",{className:"font-medium text-gray-800 group-hover:text-green-600 transition-colors",children:"Gesto de Caixa"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Controle financeiro, fechamento de caixa e relatrios"})]}),e.jsxs(gs,{to:"/kitchen",className:"p-4 border border-gray-200 rounded-lg hover:border-orange-300 transition-colors cursor-pointer group",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(kc,{className:"w-5 h-5 text-orange-600"}),e.jsx("h4",{className:"font-medium text-gray-800 group-hover:text-orange-600 transition-colors",children:"Mdulo Cozinha"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Controle de cardpio, pedidos e gesto da cozinha"})]}),e.jsxs(gs,{to:"/admin/funcionarios",className:"p-4 border border-gray-200 rounded-lg hover:border-purple-300 transition-colors cursor-pointer group",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ss,{className:"w-5 h-5 text-purple-600"}),e.jsx("h4",{className:"font-medium text-gray-800 group-hover:text-purple-600 transition-colors",children:"Gesto de Funcionrios"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Cadastro e credenciais de funcionrios"})]})]})]})]})},o8=y.memo(({stat:t,index:s,onClick:a})=>{const r=!!a;return e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:s*.05},className:`bg-white rounded-lg shadow-md p-6 ${r?"cursor-pointer hover:shadow-lg transition-shadow":""}`,onClick:a,whileHover:r?{scale:1.02}:{},whileTap:r?{scale:.98}:{},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:t.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:t.value})]}),e.jsx("div",{className:`p-3 rounded-full ${t.bgColor}`,children:e.jsx(t.icon,{className:`w-6 h-6 ${t.color}`})})]})})}),i8=y.memo(({order:t})=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:t.tableNumber?`Mesa ${t.tableNumber}`:"Balco"}),e.jsx("p",{className:"text-sm text-gray-600",children:St(t.createdAt,"HH:mm",{locale:ss})})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium text-gray-800",children:["R$ ",t.total.toFixed(2)]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${t.status==="pending"?"bg-yellow-100 text-yellow-800":t.status==="preparing"?"bg-blue-100 text-blue-800":t.status==="ready"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:t.status==="pending"?"Pendente":t.status==="preparing"?"Preparando":t.status==="ready"?"Pronto":"Entregue"})]})]})),l8=y.memo(({item:t})=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg border border-red-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.category||"Sem categoria"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium text-red-600",children:[t.currentStock," ",t.unit]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Mn: ",t.minStock]})]})]})),c8=y.memo(({module:t})=>e.jsxs(gs,{to:t.path,className:"p-4 border border-gray-200 rounded-lg hover:border-blue-300 transition-colors cursor-pointer group",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(t.icon,{className:`w-5 h-5 ${t.color}`}),e.jsx("h4",{className:`font-medium text-gray-800 group-hover:${t.hoverColor} transition-colors`,children:t.name})]}),e.jsx("p",{className:"text-sm text-gray-600",children:t.description})]})),d8=()=>{const t=Ks(),{orders:s,inventory:a,notifications:r}=Tt(),o=y.useMemo(()=>{const g=new Date().toISOString().split("T")[0],v=s.filter(b=>b.status==="delivered"&&b.updatedAt.toISOString().split("T")[0]===g);return{todayRevenue:v.reduce((b,_)=>b+_.total,0),pendingOrders:s.filter(b=>b.status==="pending").length,todaySales:v.length,lowStockItems:a.filter(b=>b.currentStock<=b.minStock).length}},[s,a]),{user:l}=Et(),c=(l==null?void 0:l.email)==="demo@clubmanager.com",u=y.useMemo(()=>[{title:"Faturamento Hoje",value:`R$ ${o.todayRevenue.toFixed(2)}`,icon:kt,color:"text-green-600",bgColor:"bg-green-100"},{title:"Pedidos Pendentes",value:o.pendingOrders,icon:Vt,color:"text-orange-600",bgColor:"bg-orange-100"},{title:"Vendas Hoje",value:o.todaySales,icon:pn,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Estoque Baixo",value:o.lowStockItems,icon:mt,color:"text-red-600",bgColor:"bg-red-100"}],[o]),h=y.useMemo(()=>s.slice(0,5),[s]),f=y.useMemo(()=>a.filter(g=>g.currentStock<=g.minStock).slice(0,5),[a]),p=y.useMemo(()=>[{name:"Mdulo Bar",description:"Gesto completa de pedidos, comandas e vendas do bar",icon:Tc,color:"text-blue-600",hoverColor:"text-blue-600",path:"/bar"},{name:"Gesto de Caixa",description:"Controle financeiro, fechamento de caixa e relatrios",icon:kt,color:"text-green-600",hoverColor:"text-green-600",path:"/cash"},{name:"Mdulo Cozinha",description:"Controle de cardpio, pedidos e gesto da cozinha",icon:kc,color:"text-orange-600",hoverColor:"text-orange-600",path:"/kitchen"},{name:"Mdulos Futuros",description:"Quadras, Piscina, Eventos, RH e mais",icon:ua,color:"text-gray-400",hoverColor:"text-gray-500",path:"#"}],[]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:["Dashboard Executivo",c&&e.jsx("span",{className:"ml-3 text-lg text-green-600 font-normal",children:" Modo Demo Ativo"})]}),e.jsx("p",{className:"text-gray-600",children:"Viso geral das operaes do clube"})]}),c&&e.jsxs(be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},className:"bg-gradient-to-r from-green-500 to-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2",children:[e.jsx(kr,{size:16}),e.jsx("span",{className:"text-sm font-medium",children:"Teste todas as funcionalidades!"})]})]})}),c&&e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},className:"bg-gradient-to-r from-blue-50 to-green-50 border border-blue-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"p-3 bg-blue-600 rounded-full",children:e.jsx(kr,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:" Bem-vindo ao ClubManager Demo!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Explore todos os mdulos e funcionalidades do sistema. Voc pode criar pedidos, gerenciar a cozinha, controlar estoque e muito mais!"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(gs,{to:"/bar",className:"flex items-center justify-between p-3 bg-white rounded-lg border border-blue-200 hover:border-blue-400 transition-colors group",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Tc,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"font-medium text-gray-800",children:"Testar Mdulo Bar"})]}),e.jsx(no,{className:"w-4 h-4 text-gray-400 group-hover:text-blue-600 transition-colors"})]}),e.jsxs(gs,{to:"/kitchen",className:"flex items-center justify-between p-3 bg-white rounded-lg border border-green-200 hover:border-green-400 transition-colors group",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(kc,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-medium text-gray-800",children:"Testar Mdulo Cozinha"})]}),e.jsx(no,{className:"w-4 h-4 text-gray-400 group-hover:text-green-600 transition-colors"})]})]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:u.map((g,v)=>e.jsx(o8,{stat:g,index:v,onClick:g.title==="Estoque Baixo"?()=>t("/inventory/estoque-baixo"):void 0},g.title))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(be.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Pedidos Recentes"}),e.jsxs("div",{className:"space-y-3",children:[h.map(g=>e.jsx(i8,{order:g},g.id)),h.length===0&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-500 mb-2",children:"Nenhum pedido ainda"}),c&&e.jsx(gs,{to:"/bar",className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Criar primeiro pedido "})]})]})]}),e.jsxs(be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.3},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Alertas de Estoque"}),e.jsxs("div",{className:"space-y-3",children:[f.map(g=>e.jsx(l8,{item:g},g.id)),f.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Todos os itens com estoque adequado"})]})]})]}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.4},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Mdulos Disponveis"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:p.map(g=>e.jsx(c8,{module:g},g.name))})]})]})},u8=y.memo(d8),m8=()=>{var w,E;const{orders:t,inventory:s}=Tt(),[a,r]=y.useState(7),[o,l]=y.useState([]),[c,u]=y.useState([]),[h,f]=y.useState(!0),[p,g]=y.useState(null),v=[{label:"Hoje",days:1},{label:"7 dias",days:7},{label:"30 dias",days:30},{label:"90 dias",days:90}];y.useEffect(()=>{(async()=>{try{f(!0);const{data:N}=await V.from("comandas").select("*").order("created_at",{ascending:!1}),{data:k}=await V.from("balcao_orders").select("*").order("created_at",{ascending:!1});console.log("Comandas:",N),console.log("Balco:",k);const S=[...(N||[]).map(A=>({id:A.id,tableNumber:A.table_number,total:parseFloat(A.total)||0,status:A.status,createdAt:new Date(A.created_at),updatedAt:new Date(A.updated_at||A.created_at),items:Array.isArray(A.items)?A.items:[]})),...(k||[]).map(A=>({id:A.id,tableNumber:null,total:parseFloat(A.total)||0,status:A.status,createdAt:new Date(A.created_at),updatedAt:new Date(A.updated_at||A.created_at),items:Array.isArray(A.items)?A.items:[]}))];console.log("Total de pedidos:",S.length),console.log("Pedidos transformados:",S);const{data:C}=await V.from("inventory").select("*"),M=(C||[]).map(A=>({id:A.id,name:A.name,category:A.category,currentStock:A.current_stock||0,minStock:A.min_stock||0,unit:A.unit||"un",price:parseFloat(A.price)||0}));console.log("Inventrio:",M);const{data:z}=await V.from("cash_registers").select(`
            *,
            employee:employees(name, full_name)
          `).eq("status","open").order("opened_at",{ascending:!1}).limit(1).single();console.log("Caixa aberto:",z),g(z),l(S),u(M)}catch(N){console.error("Erro ao buscar dados do dashboard:",N),l(t),u(s)}finally{f(!1)}})()},[t,s]);const b=y.useMemo(()=>{const T=new Date,N=Ii(eo(T,a)),k=Xu(T),S=Ii(eo(N,a)),C=Xu(eo(T,a)),M=o.filter(me=>Qu(me.createdAt,{start:N,end:k})),z=o.filter(me=>Qu(me.createdAt,{start:S,end:C})),A=["closed","paid","delivered","completed","finalizado"],$=M.filter(me=>{var D;return A.includes((D=me.status)==null?void 0:D.toLowerCase())}),P=z.filter(me=>{var D;return A.includes((D=me.status)==null?void 0:D.toLowerCase())});console.log("Pedidos finalizados:",$),console.log("Total de pedidos finalizados:",$.length);const F=$.reduce((me,D)=>me+(parseFloat(D.total)||0),0);console.log("Faturamento calculado:",F);const I=P.reduce((me,D)=>me+D.total,0),J=I>0?(F-I)/I*100:0,pe=$.length>0?F/$.length:0,te=P.length>0?I/P.length:0,L=te>0?(pe-te)/te*100:0,G=$.length,ee=P.length,xe=ee>0?(G-ee)/ee*100:0,O=o.filter(me=>me.status==="pending").length,H=c.filter(me=>me.currentStock<=me.minStock).length,B=c.reduce((me,D)=>me+D.currentStock*(D.price||0),0),Y=new Map;$.forEach(me=>{me.items.forEach(D=>{const q=Y.get(D.name)||{name:D.name,quantity:0,revenue:0};Y.set(D.name,{name:D.name,quantity:q.quantity+D.quantity,revenue:q.revenue+D.price*D.quantity})})});const ne=Array.from(Y.values()).sort((me,D)=>D.revenue-me.revenue).slice(0,5),ie=new Map;$.forEach(me=>{const D=St(me.createdAt,"dd/MM");ie.set(D,(ie.get(D)||0)+me.total)});const oe=$.length>0?$.reduce((me,D)=>{const q=D.updatedAt.getTime()-D.createdAt.getTime();return me+q/1e3/60},0)/$.length:0;return{revenue:F,revenueChange:J,avgTicket:pe,avgTicketChange:L,totalSales:G,salesChange:xe,pendingOrders:O,lowStockItems:H,totalStockValue:B,topProducts:ne,salesByDay:Array.from(ie.entries()).slice(-7),avgServiceTime:oe,completedOrders:$}},[o,c,a]),_=({title:T,value:N,change:k,icon:S,color:C,bgColor:M,trend:z})=>e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${M}`,children:e.jsx(S,{className:`w-6 h-6 ${C}`})}),k!==void 0&&e.jsxs("div",{className:`flex items-center space-x-1 text-sm font-medium ${k>0?"text-green-600":k<0?"text-red-600":"text-gray-600"}`,children:[k>0?e.jsx(eR,{className:"w-4 h-4"}):k<0?e.jsx(ZM,{className:"w-4 h-4"}):null,e.jsxs("span",{children:[Math.abs(k).toFixed(1),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:T}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:N})]})]});return h?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Carregando dashboard..."})]})}):e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Dashboard de Gesto"}),e.jsx("p",{className:"text-gray-600",children:"Anlise completa do desempenho do negcio"})]}),e.jsx("div",{className:"flex items-center space-x-2 bg-white rounded-lg shadow-md p-1",children:v.map(T=>e.jsx("button",{onClick:()=>r(T.days),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${a===T.days?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:T.label},T.days))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(_,{title:"Faturamento",value:`R$ ${b.revenue.toFixed(2)}`,change:b.revenueChange,icon:kt,color:"text-green-600",bgColor:"bg-green-100"}),e.jsx(_,{title:"Ticket Mdio",value:`R$ ${b.avgTicket.toFixed(2)}`,change:b.avgTicketChange,icon:QN,color:"text-blue-600",bgColor:"bg-blue-100"}),e.jsx(_,{title:"Total de Vendas",value:b.totalSales,change:b.salesChange,icon:pn,color:"text-purple-600",bgColor:"bg-purple-100"}),e.jsx(_,{title:"Tempo Mdio",value:`${b.avgServiceTime.toFixed(0)} min`,icon:Vt,color:"text-orange-600",bgColor:"bg-orange-100"})]}),p&&e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-300 rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-green-500 rounded-full",children:e.jsx(kt,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:" Caixa Aberto"}),e.jsxs("p",{className:"text-gray-600",children:["Operador: ",e.jsx("span",{className:"font-medium text-gray-800",children:((w=p.employee)==null?void 0:w.full_name)||((E=p.employee)==null?void 0:E.name)||"No identificado"})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Aberto em: ",St(new Date(p.opened_at),"dd/MM/yyyy 's' HH:mm",{locale:ss})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Saldo Inicial"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["R$ ",parseFloat(p.opening_balance||0).toFixed(2)]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(_,{title:"Pedidos Pendentes",value:b.pendingOrders,icon:WN,color:"text-yellow-600",bgColor:"bg-yellow-100"}),e.jsx(_,{title:"Itens em Estoque Baixo",value:b.lowStockItems,icon:mt,color:"text-red-600",bgColor:"bg-red-100"}),e.jsx(_,{title:"Valor em Estoque",value:`R$ ${b.totalStockValue.toFixed(2)}`,icon:ua,color:"text-indigo-600",bgColor:"bg-indigo-100"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(be.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Vendas por Dia"}),e.jsx(bg,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("div",{className:"space-y-3",children:b.salesByDay.length>0?b.salesByDay.map(([T,N])=>{const k=Math.max(...b.salesByDay.map(([,C])=>C)),S=N/k*100;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:T}),e.jsxs("span",{className:"text-sm font-bold text-gray-800",children:["R$ ",N.toFixed(2)]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx(be.div,{initial:{width:0},animate:{width:`${S}%`},transition:{duration:.5,delay:.1},className:"bg-blue-600 h-2 rounded-full"})})]},T)}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Sem dados para o perodo"})})]}),e.jsxs(be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Top 5 Produtos"}),e.jsx(rR,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("div",{className:"space-y-4",children:b.topProducts.length>0?b.topProducts.map((T,N)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${N===0?"bg-yellow-100 text-yellow-700":N===1?"bg-gray-100 text-gray-700":N===2?"bg-orange-100 text-orange-700":"bg-blue-100 text-blue-700"}`,children:N+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:T.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[T.quantity," unidades"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-sm font-bold text-gray-800",children:["R$ ",T.revenue.toFixed(2)]})})]},T.name)):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Sem vendas no perodo"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"ltimos Pedidos"}),e.jsx(gs,{to:"/orders",className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Ver todos"})]}),e.jsxs("div",{className:"space-y-3",children:[b.completedOrders.slice(0,5).map(T=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:T.tableNumber?`Mesa ${T.tableNumber}`:"Balco"}),e.jsx("p",{className:"text-sm text-gray-600",children:St(T.createdAt,"dd/MM/yyyy HH:mm",{locale:ss})})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-gray-800",children:["R$ ",T.total.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[T.items.length," itens"]})]})]},T.id)),b.completedOrders.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Nenhum pedido finalizado"})]})]}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Alertas de Estoque"}),e.jsx(gs,{to:"/inventory",className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Gerenciar"})]}),e.jsxs("div",{className:"space-y-3",children:[c.filter(T=>T.currentStock<=T.minStock).slice(0,5).map(T=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg border border-red-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(mt,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:T.name}),e.jsx("p",{className:"text-sm text-gray-600",children:T.category||"Sem categoria"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-red-600",children:[T.currentStock," ",T.unit]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Mn: ",T.minStock]})]})]},T.id)),c.filter(T=>T.currentStock<=T.minStock).length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-green-100 rounded-full mb-3",children:e.jsx(kr,{className:"w-6 h-6 text-green-600"})}),e.jsx("p",{className:"text-gray-600",children:"Todos os itens com estoque adequado!"})]})]})]})]}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg shadow-md p-6 border border-blue-200",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"p-3 bg-blue-600 rounded-full",children:e.jsx(ma,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Insights do Perodo"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Crescimento"}),e.jsxs("p",{className:`text-xl font-bold ${b.revenueChange>0?"text-green-600":b.revenueChange<0?"text-red-600":"text-gray-600"}`,children:[b.revenueChange>0?"+":"",b.revenueChange.toFixed(1),"%"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"vs perodo anterior"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Eficincia"}),e.jsxs("p",{className:"text-xl font-bold text-blue-600",children:[b.avgServiceTime.toFixed(0)," min"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"tempo mdio de atendimento"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Produtos Ativos"}),e.jsx("p",{className:"text-xl font-bold text-purple-600",children:b.topProducts.length}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"produtos vendidos"})]})]})]})]})})]})},h8=({data:t,title:s,color:a="blue"})=>{if(t.length===0)return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:s}),e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Sem dados disponveis"})]});const r=Math.max(...t.map(_=>_.value)),o=Math.min(...t.map(_=>_.value)),l=t.reduce((_,w)=>_+w.value,0)/t.length,c=t.slice(0,Math.floor(t.length/2)),u=t.slice(Math.floor(t.length/2)),h=c.reduce((_,w)=>_+w.value,0)/c.length,f=u.reduce((_,w)=>_+w.value,0)/u.length,p=f>h?"up":f<h?"down":"neutral",g=h>0?(f-h)/h*100:0,v={blue:{bar:"bg-blue-600",gradient:"from-blue-500 to-blue-600",text:"text-blue-600"},green:{bar:"bg-green-600",gradient:"from-green-500 to-green-600",text:"text-green-600"},purple:{bar:"bg-purple-600",gradient:"from-purple-500 to-purple-600",text:"text-purple-600"}},b=v[a]||v.blue;return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:s}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Mdia: R$ ",l.toFixed(2)]})]}),e.jsxs("div",{className:`flex items-center space-x-2 ${p==="up"?"text-green-600":p==="down"?"text-red-600":"text-gray-600"}`,children:[p==="up"?e.jsx(ma,{className:"w-5 h-5"}):p==="down"?e.jsx(Yu,{className:"w-5 h-5"}):null,e.jsxs("span",{className:"text-sm font-medium",children:[p==="up"?"+":"",g.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"space-y-3",children:t.map((_,w)=>{const E=r>0?_.value/r*100:0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:_.date}),e.jsxs("span",{className:"text-sm font-bold text-gray-800",children:["R$ ",_.value.toFixed(2)]})]}),e.jsx("div",{className:"relative w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:e.jsx(be.div,{initial:{width:0},animate:{width:`${E}%`},transition:{duration:.5,delay:w*.05},className:`h-full rounded-full bg-gradient-to-r ${b.gradient}`})})]},w)})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-6 pt-6 border-t border-gray-200",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Mximo"}),e.jsxs("p",{className:"text-sm font-bold text-gray-800",children:["R$ ",r.toFixed(2)]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Mdia"}),e.jsxs("p",{className:"text-sm font-bold text-gray-800",children:["R$ ",l.toFixed(2)]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Mnimo"}),e.jsxs("p",{className:"text-sm font-bold text-gray-800",children:["R$ ",o.toFixed(2)]})]})]})]})},pu=[{bg:"bg-blue-500",text:"text-blue-500",light:"bg-blue-100"},{bg:"bg-green-500",text:"text-green-500",light:"bg-green-100"},{bg:"bg-purple-500",text:"text-purple-500",light:"bg-purple-100"},{bg:"bg-orange-500",text:"text-orange-500",light:"bg-orange-100"},{bg:"bg-pink-500",text:"text-pink-500",light:"bg-pink-100"},{bg:"bg-indigo-500",text:"text-indigo-500",light:"bg-indigo-100"},{bg:"bg-yellow-500",text:"text-yellow-500",light:"bg-yellow-100"},{bg:"bg-red-500",text:"text-red-500",light:"bg-red-100"}],f8=({data:t,title:s})=>{if(t.length===0)return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:s}),e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Sem dados disponveis"})]});const a=t.reduce((r,o)=>r+o.value,0);return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:s}),e.jsx(yR,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex h-4 rounded-full overflow-hidden",children:t.map((r,o)=>{const l=pu[o%pu.length];return e.jsx(be.div,{initial:{width:0},animate:{width:`${r.percentage}%`},transition:{duration:.5,delay:o*.1},className:l.bg,title:`${r.name}: ${r.percentage.toFixed(1)}%`},r.name)})})}),e.jsx("div",{className:"space-y-3",children:t.map((r,o)=>{const l=pu[o%pu.length];return e.jsxs(be.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:o*.05},className:"flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${l.bg}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:r.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[r.percentage.toFixed(1),"% do total"]})]})]}),e.jsx("div",{className:"text-right ml-4",children:e.jsxs("p",{className:"text-sm font-bold text-gray-800",children:["R$ ",r.value.toFixed(2)]})})]},r.name)})}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Total"}),e.jsxs("span",{className:"text-lg font-bold text-gray-800",children:["R$ ",a.toFixed(2)]})]})})]})},p8=({avgServiceTime:t,orderCompletionRate:s,customerSatisfaction:a=0,employeeEfficiency:r=0})=>{const o=[{label:"Tempo Mdio de Atendimento",value:`${t.toFixed(0)} min`,target:"< 15 min",icon:Vt,color:"text-blue-600",bgColor:"bg-blue-100",status:t<15?"good":t<25?"warning":"critical"},{label:"Taxa de Concluso",value:`${s.toFixed(1)}%`,target:"> 95%",icon:ts,color:"text-green-600",bgColor:"bg-green-100",status:s>95?"good":s>85?"warning":"critical"},{label:"Satisfao do Cliente",value:a>0?`${a.toFixed(1)}%`:"N/A",target:"> 90%",icon:Ss,color:"text-purple-600",bgColor:"bg-purple-100",status:a>90?"good":a>75?"warning":"critical"},{label:"Eficincia Operacional",value:r>0?`${r.toFixed(1)}%`:"N/A",target:"> 85%",icon:kr,color:"text-orange-600",bgColor:"bg-orange-100",status:r>85?"good":r>70?"warning":"critical"}],l=u=>{switch(u){case"good":return"border-green-500 bg-green-50";case"warning":return"border-yellow-500 bg-yellow-50";case"critical":return"border-red-500 bg-red-50";default:return"border-gray-300 bg-white"}},c=u=>{switch(u){case"good":return e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Excelente"});case"warning":return e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Ateno"});case"critical":return e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Crtico"});default:return null}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Mtricas de Performance"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Indicadores operacionais em tempo real"})]}),e.jsx(QN,{className:"w-6 h-6 text-gray-400"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.map((u,h)=>e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:h*.1},className:`border-2 rounded-lg p-4 ${l(u.status)}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${u.bgColor}`,children:e.jsx(u.icon,{className:`w-5 h-5 ${u.color}`})}),c(u.status)]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:u.label}),e.jsxs("div",{className:"flex items-baseline space-x-2",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:u.value}),u.target&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Meta: ",u.target]})]})]}),u.status&&e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx(be.div,{initial:{width:0},animate:{width:u.status==="good"?"100%":u.status==="warning"?"70%":"40%"},transition:{duration:.5,delay:h*.1},className:`h-2 rounded-full ${u.status==="good"?"bg-green-500":u.status==="warning"?"bg-yellow-500":"bg-red-500"}`})})})]},u.label))}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Performance Geral"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Baseado em ",o.length," indicadores principais"]})]}),e.jsx("div",{className:"text-right",children:o.filter(u=>u.status==="good").length>=3?e.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[e.jsx(ma,{className:"w-5 h-5"}),e.jsx("span",{className:"text-lg font-bold",children:"timo"})]}):o.filter(u=>u.status==="critical").length>=2?e.jsxs("div",{className:"flex items-center space-x-2 text-red-600",children:[e.jsx(mt,{className:"w-5 h-5"}),e.jsx("span",{className:"text-lg font-bold",children:"Requer Ateno"})]}):e.jsxs("div",{className:"flex items-center space-x-2 text-yellow-600",children:[e.jsx(WN,{className:"w-5 h-5"}),e.jsx("span",{className:"text-lg font-bold",children:"Bom"})]})})]})})]})},g8=()=>{const{orders:t,inventory:s}=Tt(),[a,r]=y.useState(7),[o,l]=y.useState(!1),c=[{label:"Hoje",days:1},{label:"7 dias",days:7},{label:"30 dias",days:30},{label:"90 dias",days:90}],u=y.useMemo(()=>{const p=new Date,g=Ii(eo(p,a)),v=Xu(p),b=Ii(eo(g,a)),_=Xu(eo(p,a)),w=t.filter(G=>Qu(G.createdAt,{start:g,end:v})),E=t.filter(G=>Qu(G.createdAt,{start:b,end:_})),T=w.filter(G=>G.status==="delivered"),N=E.filter(G=>G.status==="delivered"),k=T.reduce((G,ee)=>G+ee.total,0),S=N.reduce((G,ee)=>G+ee.total,0),C=S>0?(k-S)/S*100:0,M=T.length>0?k/T.length:0,z=T.length,A=new Map;for(let G=a-1;G>=0;G--){const ee=eo(p,G),xe=St(ee,"dd/MM");A.set(xe,0)}T.forEach(G=>{const ee=St(G.createdAt,"dd/MM");A.has(ee)&&A.set(ee,(A.get(ee)||0)+G.total)});const $=Array.from(A.entries()).map(([G,ee])=>({date:G,value:ee})),P=new Map;T.forEach(G=>{G.items.forEach(ee=>{const xe=ee.category||"Outros";P.set(xe,(P.get(xe)||0)+ee.price*ee.quantity)})});const F=Array.from(P.values()).reduce((G,ee)=>G+ee,0),I=Array.from(P.entries()).map(([G,ee])=>({name:G,value:ee,percentage:F>0?ee/F*100:0})).sort((G,ee)=>ee.value-G.value),J=T.length>0?T.reduce((G,ee)=>{const xe=ee.updatedAt.getTime()-ee.createdAt.getTime();return G+xe/1e3/60},0)/T.length:0,pe=w.length>0?T.length/w.length*100:0,te=s.filter(G=>G.currentStock<=G.minStock),L=s.reduce((G,ee)=>G+ee.currentStock*(ee.price||0),0);return{revenue:k,revenueChange:C,avgTicket:M,totalSales:z,salesChartData:$,categoryData:I,avgServiceTime:J,orderCompletionRate:pe,lowStockItems:te,totalStockValue:L,pendingOrders:t.filter(G=>G.status==="pending").length}},[t,s,a]),h=()=>{l(!0),setTimeout(()=>l(!1),1e3)},f=()=>{var _;const p={periodo:(_=c.find(w=>w.days===a))==null?void 0:_.label,faturamento:u.revenue,vendas:u.totalSales,ticketMedio:u.avgTicket,geradoEm:new Date().toISOString()},g=new Blob([JSON.stringify(p,null,2)],{type:"application/json"}),v=URL.createObjectURL(g),b=document.createElement("a");b.href=v,b.download=`dashboard-${St(new Date,"yyyy-MM-dd")}.json`,b.click()};return e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Dashboard Completo"}),e.jsx("p",{className:"text-gray-600",children:"Gesto completa e anlise de indicadores do negcio"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("div",{className:"flex items-center space-x-2 bg-white rounded-lg shadow-md p-1",children:c.map(p=>e.jsx("button",{onClick:()=>r(p.days),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${a===p.days?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:p.label},p.days))}),e.jsx("button",{onClick:h,disabled:o,className:"p-2 bg-white rounded-lg shadow-md hover:bg-gray-50 transition-colors disabled:opacity-50",title:"Atualizar dados",children:e.jsx(_a,{className:`w-5 h-5 text-gray-600 ${o?"animate-spin":""}`})}),e.jsx("button",{onClick:f,className:"p-2 bg-white rounded-lg shadow-md hover:bg-gray-50 transition-colors",title:"Exportar dados",children:e.jsx(Vc,{className:"w-5 h-5 text-gray-600"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-green-500 to-green-600 rounded-lg shadow-lg p-6 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(kt,{className:"w-8 h-8 opacity-80"}),e.jsxs("div",{className:`text-sm font-medium px-2 py-1 rounded ${u.revenueChange>0?"bg-green-400":"bg-green-700"}`,children:[u.revenueChange>0?"+":"",u.revenueChange.toFixed(1),"%"]})]}),e.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Faturamento"}),e.jsxs("p",{className:"text-3xl font-bold",children:["R$ ",u.revenue.toFixed(2)]})]}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg shadow-lg p-6 text-white",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx(pn,{className:"w-8 h-8 opacity-80"})}),e.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Total de Vendas"}),e.jsx("p",{className:"text-3xl font-bold",children:u.totalSales})]}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg shadow-lg p-6 text-white",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx(ma,{className:"w-8 h-8 opacity-80"})}),e.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Ticket Mdio"}),e.jsxs("p",{className:"text-3xl font-bold",children:["R$ ",u.avgTicket.toFixed(2)]})]}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg shadow-lg p-6 text-white",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx(Vt,{className:"w-8 h-8 opacity-80"})}),e.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Tempo Mdio"}),e.jsxs("p",{className:"text-3xl font-bold",children:[u.avgServiceTime.toFixed(0)," min"]})]})]}),(u.pendingOrders>0||u.lowStockItems.length>0)&&e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(mt,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-yellow-800 mb-1",children:"Ateno Necessria"}),e.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[u.pendingOrders>0&&e.jsxs("li",{children:[" ",u.pendingOrders," pedido(s) pendente(s) aguardando processamento"]}),u.lowStockItems.length>0&&e.jsxs("li",{children:[" ",u.lowStockItems.length," item(ns) com estoque baixo"]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(h8,{data:u.salesChartData,title:"Evoluo de Vendas",color:"blue"}),e.jsx(f8,{data:u.categoryData,title:"Vendas por Categoria"})]}),e.jsx(p8,{avgServiceTime:u.avgServiceTime,orderCompletionRate:u.orderCompletionRate,customerSatisfaction:0,employeeEfficiency:0}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Resumo de Estoque"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Valor total e itens crticos"})]}),e.jsx(ua,{className:"w-6 h-6 text-gray-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Valor Total em Estoque"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["R$ ",u.totalStockValue.toFixed(2)]})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Itens em Estoque"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:s.length})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Itens em Estoque Baixo"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:u.lowStockItems.length})]})]}),u.lowStockItems.length>0&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Itens Crticos"}),e.jsx("div",{className:"space-y-2",children:u.lowStockItems.slice(0,3).map(p=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-red-50 rounded",children:[e.jsx("span",{className:"text-sm text-gray-800",children:p.name}),e.jsxs("span",{className:"text-sm font-medium text-red-600",children:[p.currentStock," ",p.unit]})]},p.id))})]})]})]})};class x8 extends y.Component{constructor(a){super(a);dt(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});dt(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a,errorInfo:null}}componentDidCatch(a,r){this.setState({error:a,errorInfo:r}),console.error("ErrorBoundary capturou um erro:",a,r),this.props.onError&&this.props.onError(a,r),console.error("Erro em produo:",{error:a.message,stack:a.stack,componentStack:r.componentStack})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:e.jsx(mt,{className:"w-8 h-8 text-red-600"})})}),e.jsx("h1",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Oops! Algo deu errado"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Ocorreu um erro inesperado. Tente recarregar a pgina ou volte ao incio."}),!1,e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("button",{onClick:this.handleRetry,className:"flex-1 inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[e.jsx(_a,{className:"w-4 h-4 mr-2"}),"Tentar Novamente"]}),e.jsxs("button",{onClick:this.handleGoHome,className:"flex-1 inline-flex items-center justify-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[e.jsx(YR,{className:"w-4 h-4 mr-2"}),"Ir ao Incio"]})]})]})}):this.props.children}}const m2="America/Sao_Paulo",y8=()=>new Date(new Date().toLocaleString("en-US",{timeZone:m2})),fc=()=>{const t=new Date,s=new Date(t.toLocaleString("en-US",{timeZone:m2})),a=s.getFullYear(),r=String(s.getMonth()+1).padStart(2,"0"),o=String(s.getDate()).padStart(2,"0"),l=`${a}-${r}-${o}`;return console.log(" getTodayString:",{utcNow:t.toISOString(),brasiliaDate:s.toLocaleString("pt-BR"),result:l}),l},gu=t=>{const[s,a,r]=t.split("-").map(Number),o=new Date(s,a-1,r,0,0,0,0),l=new Date(s,a-1,r,23,59,59,999),c=new Date(o.getTime()-6*60*60*1e3),u=new Date(l.getTime()+6*60*60*1e3),h={start:c.toISOString(),end:u.toISOString()};return console.log(" getDateRangeForQuery:",{input:t,startLocal:o.toLocaleString("pt-BR"),endLocal:l.toLocaleString("pt-BR"),startUTC:h.start,endUTC:h.end}),h},b8=()=>{const t=y8();return t.setHours(0,0,0,0),t},v8=()=>{const[t,s]=y.useState({totalRevenue:0,ordersToday:0,pendingOrders:0,deliveredOrders:0,loading:!0,error:null}),a=async()=>{try{s(b=>({...b,loading:!0,error:null}));const r=b8().toISOString(),{data:o,error:l}=await V.from("balcao_orders").select("status, final_amount, created_at").gte("created_at",r);if(l)throw l;const{data:c,error:u}=await V.from("comandas").select("status, total, created_at").gte("created_at",r);if(u)throw u;const h=fc();let f=0,p=0,g=0,v=0;o==null||o.forEach(b=>{new Date(b.created_at).toISOString().split("T")[0]===h&&p++,b.status==="delivered"?(f+=Number(b.final_amount||0),v++):(b.status==="pending_payment"||b.status==="paid"||b.status==="preparing")&&g++}),c==null||c.forEach(b=>{new Date(b.created_at).toISOString().split("T")[0]===h&&p++,b.status==="closed"?(f+=Number(b.total||0),v++):(b.status==="open"||b.status==="pending_payment")&&g++}),s({totalRevenue:f,ordersToday:p,pendingOrders:g,deliveredOrders:v,loading:!1,error:null})}catch(r){console.error("Erro ao buscar estatsticas do bar:",r),s(o=>({...o,loading:!1,error:r instanceof Error?r.message:"Erro ao carregar estatsticas"}))}};return y.useEffect(()=>{a();const r=V.channel("balcao_orders_stats").on("postgres_changes",{event:"*",schema:"public",table:"balcao_orders"},()=>{console.log(" Atualizando estatsticas do bar (balco)..."),a()}).subscribe(),o=V.channel("comandas_stats").on("postgres_changes",{event:"*",schema:"public",table:"comandas"},()=>{console.log(" Atualizando estatsticas do bar (comandas)..."),a()}).subscribe();return()=>{r.unsubscribe(),o.unsubscribe()}},[]),{...t,refetch:a}},w8=({onOrderUpdate:t,empresaId:s})=>{const a=y.useCallback(r=>{console.log(" REALTIME MONITOR BAR:",r.eventType,r.table),(r.eventType==="INSERT"||r.eventType==="UPDATE")&&(console.log(" Atualizando Monitor Bar..."),t())},[t]);y.useEffect(()=>{console.log(" Conectando realtime do Monitor Bar...");const r=V.channel("bar-monitor-realtime").on("postgres_changes",{event:"*",schema:"public",table:"balcao_orders",filter:s?`empresa_id=eq.${s}`:void 0},o=>{var l,c;console.log(" REALTIME BAR - balcao_orders:",o.eventType),o.eventType==="UPDATE"&&((l=o.old)==null?void 0:l.status)==="pending_payment"&&((c=o.new)==null?void 0:c.status)==="paid"&&console.log(" PEDIDO PAGO! Atualizando Monitor Bar..."),a(o)}).on("postgres_changes",{event:"*",schema:"public",table:"balcao_order_items"},o=>{console.log(" REALTIME BAR - balcao_order_items:",o.eventType),a(o)}).on("postgres_changes",{event:"*",schema:"public",table:"comandas"},o=>{console.log(" REALTIME BAR - comandas:",o.eventType),a(o)}).on("postgres_changes",{event:"*",schema:"public",table:"comanda_items"},o=>{console.log(" REALTIME BAR - comanda_items:",o.eventType),a(o)}).subscribe(o=>{o==="SUBSCRIBED"?console.log(" Realtime do Monitor Bar ativo!"):o==="CHANNEL_ERROR"&&console.error(" Erro no realtime do Monitor Bar")});return()=>{console.log(" Desconectando realtime do Monitor Bar"),r.unsubscribe()}},[a,s])},h2=({onCustomerSelected:t,onClose:s})=>{const[a,r]=y.useState({phone:"",name:"",email:""}),[o,l]=y.useState(null),[c,u]=y.useState(!1),[h,f]=y.useState(!1),[p,g]=y.useState(null),v=async N=>{if(!(N.length<10)){f(!0),g(null);try{const{data:k,error:S}=await V.rpc("get_bar_customer_by_phone",{customer_phone:N});if(S)throw S;if(k&&k.length>0){const C=k[0];l(C),r({phone:C.phone,name:C.name,email:C.email||""})}else l(null),r(C=>({...C,name:"",email:""}))}catch(k){console.error("Erro ao buscar cliente:",k),g("Erro ao buscar cliente")}finally{f(!1)}}},b=N=>{const k=N.replace(/\D/g,"");return k.length<=11?k.replace(/(\d{2})(\d{5})(\d{4})/,"($1) $2-$3"):N},_=N=>{const k=N.target.value,S=b(k);r(M=>({...M,phone:S}));const C=k.replace(/\D/g,"");C.length===11?v(C):l(null)},w=async()=>{u(!0),g(null);try{const N=a.phone.replace(/\D/g,""),{data:k,error:S}=await V.from("bar_customers").insert({phone:N,name:a.name,email:a.email||null,status:"active",is_vip:!1,loyalty_points:0,credit_limit:0,current_balance:0}).select().single();if(S)throw S;t(k)}catch(N){console.error("Erro ao criar cliente:",N),g("Erro ao criar cliente")}finally{u(!1)}},E=()=>{o&&t(o)},T=N=>{if(N.preventDefault(),!a.phone||!a.name){g("Telefone e nome so obrigatrios");return}o?E():w()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:o?"Cliente Encontrado":"Cadastro de Cliente"}),e.jsx("button",{onClick:s,className:"text-gray-500 hover:text-gray-700",children:""})]}),p&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:p}),e.jsxs("form",{onSubmit:T,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:a.phone,onChange:_,placeholder:"(11) 99999-9999",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",maxLength:15,required:!0}),h&&e.jsx("div",{className:"absolute right-3 top-2.5",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome *"}),e.jsx("input",{type:"text",value:a.name,onChange:N=>r(k=>({...k,name:N.target.value})),placeholder:"Nome completo",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:!!o})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email (opcional)"}),e.jsx("input",{type:"email",value:a.email,onChange:N=>r(k=>({...k,email:N.target.value})),placeholder:"email@exemplo.com",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!!o})]}),o&&e.jsx("div",{className:"p-3 bg-green-100 border border-green-400 rounded",children:e.jsxs("p",{className:"text-green-700 text-sm",children:[e.jsx("strong",{children:"Cliente encontrado!"}),e.jsx("br",{}),"ltima visita: ",o.last_visit?new Date(o.last_visit).toLocaleDateString("pt-BR"):"Primeira visita",e.jsx("br",{}),"Pontos de fidelidade: ",o.loyalty_points,o.is_vip&&e.jsx("span",{className:"ml-2 text-yellow-600",children:" VIP"})]})}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:c||!a.phone||!a.name,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:c?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processando..."]}):o?"Selecionar Cliente":"Cadastrar Cliente"})]})]})]})})},j8=({isOpen:t,onClose:s,menuItems:a})=>{const{addOrder:r}=Tt(),{user:o}=Et(),[l,c]=y.useState([]),[u,h]=y.useState(""),[f,p]=y.useState(""),[g,v]=y.useState(!1),[b,_]=y.useState(null),[w,E]=y.useState(!1),T=z=>{if(l.find($=>$.menuItemId===z.id))c($=>$.map(P=>P.menuItemId===z.id?{...P,quantity:P.quantity+1}:P));else{const $={id:`item-${Date.now()}`,menuItemId:z.id,quantity:1,price:z.price};c(P=>[...P,$])}},N=z=>{c(A=>A.filter($=>$.menuItemId!==z))},k=(z,A)=>{if(A<=0){N(z);return}c($=>$.map(P=>P.menuItemId===z?{...P,quantity:A}:P))},S=l.reduce((z,A)=>z+A.price*A.quantity,0),C=z=>{_(z),E(!1)},M=async z=>{if(z.preventDefault(),!(l.length===0||g)){if(!b){alert("Por favor, selecione um cliente antes de finalizar o pedido.");return}v(!0);try{await r({tableNumber:u||void 0,items:l.map(({id:A,...$})=>$),status:"pending",employeeId:o.id,customerId:b.id,notes:f||void 0}),c([]),h(""),p(""),_(null),s()}catch(A){console.error("Falha ao criar o pedido:",A)}finally{v(!1)}}};return e.jsx(Wa,{children:t&&e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:[e.jsxs(be.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Novo Pedido"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(lt,{size:24})})]}),e.jsxs("div",{className:"flex h-[70vh]",children:[e.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Cardpio"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.map(z=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:z.name}),e.jsxs("span",{className:"text-lg font-bold text-green-600",children:["R$ ",z.price.toFixed(2)]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:z.description}),e.jsx("button",{onClick:()=>T(z),disabled:!z.available||g,className:"w-full bg-blue-600 text-white py-2 rounded-lg font-medium hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:z.available?"Adicionar":"Indisponvel"})]},z.id))})]}),e.jsxs("div",{className:"w-1/3 bg-gray-50 border-l border-gray-200 flex flex-col",children:[e.jsx("div",{className:"p-6 pb-4",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Pedido"})}),e.jsxs("form",{onSubmit:M,className:"flex flex-col h-full",children:[e.jsxs("div",{className:"px-6 space-y-4 flex-shrink-0",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cliente *"}),b?e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-800",children:b.name}),e.jsx("p",{className:"text-sm text-green-600",children:b.phone}),b.is_vip&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 mt-1",children:" VIP"})]}),e.jsx("button",{type:"button",onClick:()=>_(null),className:"text-green-600 hover:text-green-800",disabled:g,children:e.jsx(lt,{size:16})})]})}):e.jsxs("button",{type:"button",onClick:()=>E(!0),className:"w-full flex items-center justify-center px-3 py-2 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-blue-400 hover:text-blue-600 transition-colors",disabled:g,children:[e.jsx(Ys,{size:20,className:"mr-2"}),"Selecionar Cliente"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nmero da Mesa"}),e.jsx("input",{type:"text",value:u,onChange:z=>h(z.target.value),placeholder:"Ex: 5",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:g})]})]}),e.jsx("div",{className:"px-6 flex-1 min-h-0",children:e.jsxs("div",{className:"space-y-2",children:[l.map(z=>{const A=a.find($=>$.id===z.menuItemId);return e.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-800 truncate",children:A==null?void 0:A.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["R$ ",z.price.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-2",children:[e.jsx("button",{type:"button",onClick:()=>k(z.menuItemId,z.quantity-1),className:"text-gray-400 hover:text-gray-600 p-1",disabled:g,children:e.jsx($i,{size:16})}),e.jsx("span",{className:"w-8 text-center font-medium",children:z.quantity}),e.jsx("button",{type:"button",onClick:()=>k(z.menuItemId,z.quantity+1),className:"text-gray-400 hover:text-gray-600 p-1",disabled:g,children:e.jsx(Zs,{size:16})})]})]},z.id)}),l.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"Nenhum item selecionado"}),e.jsx("p",{className:"text-sm",children:"Adicione itens do cardpio"})]})]})}),e.jsxs("div",{className:"px-6 pb-6 space-y-4 flex-shrink-0 border-t border-gray-200 pt-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observaes"}),e.jsx("textarea",{value:f,onChange:z=>p(z.target.value),placeholder:"Observaes especiais...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:g})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-800",children:"Total:"}),e.jsxs("span",{className:"text-xl font-bold text-green-600",children:["R$ ",S.toFixed(2)]})]}),e.jsx("button",{type:"submit",disabled:l.length===0||g||!b,className:"w-full bg-green-600 text-white py-3 rounded-lg font-medium hover:bg-green-700 disabled:bg-green-400 disabled:cursor-not-allowed transition-colors",children:g?"Confirmando...":"Confirmar Pedido"})]})]})]})]})]})]}),w&&e.jsx(h2,{onCustomerSelected:C,onClose:()=>E(!1)})]})})},f2=({order:t,menuItems:s,hasMultipleOrders:a=!1,orderNumber:r})=>{const{updateOrderStatus:o}=Tt();console.log("OrderCard - Order:",t.id,{items:t.items,menuItemsCount:s.length,firstMenuItem:s[0]});const l=g=>{switch(g){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"preparing":return"bg-blue-100 text-blue-800 border-blue-200";case"ready":return"bg-green-100 text-green-800 border-green-200";case"delivered":return"bg-gray-100 text-gray-800 border-gray-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},c=g=>{switch(g){case"pending":return"Pendente";case"preparing":return"Preparando";case"ready":return"Pronto";case"delivered":return"Entregue";case"cancelled":return"Cancelado";default:return g}},h=(g=>{switch(g){case"pending":return"preparing";case"preparing":return"ready";case"ready":return"delivered";default:return null}})(t.status),f=g=>g.id.startsWith("balcao-"),p=g=>g.id.startsWith("comanda-");return e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow ${a?"ring-2 ring-orange-300 ring-offset-2":""} ${f(t)?"border-green-400 bg-green-50 shadow-lg":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qc,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-800",children:t.tableNumber?`Mesa ${t.tableNumber}`:"Balco"}),r&&e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:["#",r]}),f(t)&&e.jsx("span",{className:"bg-green-600 text-white px-2 py-1 rounded-full text-xs font-bold animate-pulse",children:" PAGO"}),p(t)&&e.jsx("span",{className:"bg-yellow-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:"AGUARDA PAGTO"})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${l(t.status)}`,children:c(t.status)})]}),e.jsx("div",{className:"space-y-2 mb-4",children:t.items.map(g=>{var _;const v=s.find(w=>w.id===g.menuItemId),b=(v==null?void 0:v.name)||((_=g.menuItem)==null?void 0:_.name)||`Item ${g.menuItemId.slice(-4)}`;return e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[g.quantity,"x ",b]}),e.jsxs("span",{className:"text-gray-800",children:["R$ ",(g.price*g.quantity).toFixed(2)]})]},g.id)})}),t.notes&&e.jsx("div",{className:"mb-4 p-2 bg-yellow-50 rounded border border-yellow-200",children:e.jsx("p",{className:"text-xs text-yellow-800",children:t.notes})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Vt,{size:12}),e.jsx("span",{children:St(t.createdAt,"HH:mm",{locale:ss})})]}),e.jsxs("span",{className:"font-medium text-gray-800",children:["R$ ",t.total.toFixed(2)]})]}),h&&e.jsxs("button",{onClick:()=>o(t.id,h),className:`w-full py-2 rounded-lg text-sm font-medium transition-colors ${f(t)?t.status==="pending"?"bg-green-600 text-white hover:bg-green-700":t.status==="preparing"?"bg-green-700 text-white hover:bg-green-800":"bg-green-800 text-white hover:bg-green-900":p(t)?t.status==="pending"?"bg-yellow-600 text-white hover:bg-yellow-700":t.status==="preparing"?"bg-yellow-700 text-white hover:bg-yellow-800":"bg-yellow-800 text-white hover:bg-yellow-900":t.status==="pending"?"bg-blue-600 text-white hover:bg-blue-700":t.status==="preparing"?"bg-blue-700 text-white hover:bg-blue-800":"bg-blue-800 text-white hover:bg-blue-900"}`,children:[h==="preparing"&&"Iniciar Preparo",h==="ready"&&"Marcar como Pronto",h==="delivered"&&"Marcar como Entregue"]})]})},_8=()=>{const t=Ks(),{barOrders:s,menuItems:a,loadMenuItems:r,refreshBarOrders:o}=Tt(),{totalRevenue:l,ordersToday:c,pendingOrders:u,deliveredOrders:h,loading:f}=v8();w8({onOrderUpdate:()=>{console.log(" Atualizao detectada! Recarregando Monitor Bar..."),o()}}),Ye.useEffect(()=>{console.log(" Monitor Bar montado - carregando dados iniciais..."),r(),o()},[]);const[p,g]=y.useState(!1),[v,b]=y.useState("all"),[_,w]=y.useState(""),[E,T]=y.useState("all"),N=a,S=(()=>{const A=new Map;return s.forEach($=>{const P=$.tableNumber||"Balco";A.has(P)||A.set(P,[]),A.get(P).push($)}),A})(),C=A=>(S.get(A)||[]).length>1,M=A=>A.id.slice(-4).toUpperCase(),z=s.filter(A=>{var I,J;const $=v==="all"||A.status===v,P=E==="all"||(A.tableNumber||"Balco")===E,F=((I=A.tableNumber)==null?void 0:I.toLowerCase().includes(_.toLowerCase()))||A.id.toLowerCase().includes(_.toLowerCase())||((J=A.notes)==null?void 0:J.toLowerCase().includes(_.toLowerCase()));return $&&P&&F});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Mdulo Bar"}),e.jsx("p",{className:"text-gray-600",children:"Gesto completa de pedidos e vendas"})]}),e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>g(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx(Zs,{size:20}),e.jsx("span",{children:"Novo Pedido"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Receita Total"}),f?e.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"Carregando..."}):e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["R$ ",l.toFixed(2)]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Pedidos Hoje"}),f?e.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"Carregando..."}):e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:c})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Pedidos Pendentes"}),f?e.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"Carregando..."}):e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:u})]}),e.jsxs(be.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>t("/bar/pedidos-entregues"),className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg shadow-md p-6 cursor-pointer hover:shadow-lg transition-all border-2 border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Pedidos Entregues"}),e.jsx(ts,{className:"text-green-600",size:24})]}),f?e.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"Carregando..."}):e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold text-green-600",children:h}),e.jsx("p",{className:"text-sm text-green-700 mt-2",children:"Clique para ver histrico"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Pedidos"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[Array.from(S.entries()).filter(([A,$])=>$.length>1).length>0&&e.jsxs("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium",children:[Array.from(S.entries()).filter(([A,$])=>$.length>1).length," mesa(s) com mltiplos pedidos"]}),E!=="all"&&e.jsxs("button",{onClick:()=>T("all"),className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium hover:bg-blue-200 transition-colors flex items-center space-x-1",children:[e.jsxs("span",{children:["Filtro: ",E]}),e.jsx("span",{className:"text-blue-600",children:""})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ka,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar pedidos...",value:_,onChange:A=>w(A.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:v,onChange:A=>b(A.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"pending",children:"Pendente"}),e.jsx("option",{value:"preparing",children:"Preparando"}),e.jsx("option",{value:"ready",children:"Pronto"})]})]})]}),Array.from(S.entries()).filter(([A,$])=>$.length>1).length>0&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-orange-800 mb-2",children:" Mesas com Mltiplos Pedidos:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from(S.entries()).filter(([A,$])=>$.length>1).map(([A,$])=>e.jsxs("button",{onClick:()=>T(A),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors hover:shadow-md transform hover:scale-105 ${E===A?"bg-orange-400 text-white":"bg-orange-200 text-orange-800 hover:bg-orange-300"}`,title:`Filtrar pedidos da ${A}`,children:["Mesa ",A,": ",$.length," pedidos"]},A))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:z.map(A=>e.jsx(f2,{order:A,menuItems:a,hasMultipleOrders:C(A.tableNumber||"Balco"),orderNumber:M(A)},A.id))}),z.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhum pedido encontrado"})})]}),p&&e.jsx(j8,{isOpen:p,onClose:()=>g(!1),menuItems:N})]})},N8=()=>{const[t,s]=y.useState([]),[a,r]=y.useState(!0),[o,l]=y.useState(null),c=async()=>{try{r(!0),l(null);const{data:u,error:h}=await V.from("comanda_items").select(`
          *,
          comanda:comandas(
            id,
            table_id,
            customer_name,
            opened_at,
            status,
            table:bar_tables(number)
          ),
          menu_item:menu_items(
            *,
            inventory_items!left(name, image_url)
          )
        `).gte("added_at",new Date(new Date().setHours(0,0,0,0)).toISOString()).order("added_at",{ascending:!1});if(h)throw h;const{data:f,error:p}=await V.from("balcao_order_items").select(`
          *,
          balcao_order:balcao_orders!inner(
            id,
            order_number,
            customer_name,
            status,
            created_at
          ),
          menu_item:menu_items(
            *,
            inventory_items!left(name, image_url)
          )
        `).gte("created_at",new Date(new Date().setHours(0,0,0,0)).toISOString()).order("created_at",{ascending:!1});if(p)throw p;const g=new Map;u==null||u.forEach(v=>{var N,k,S,C,M,z,A;const b=(N=v.comanda)==null?void 0:N.id;if(!b)return;const _=new Date(v.added_at),w=`${_.getUTCFullYear()}-${_.getUTCMonth()}-${_.getUTCDate()}-${_.getUTCHours()}-${_.getUTCMinutes()}`,E=`comanda-${b}-${w}`;g.has(E)||g.set(E,{id:E,tableNumber:(S=(k=v.comanda)==null?void 0:k.table)==null?void 0:S.number,items:[],status:v.status,total:0,createdAt:new Date(v.added_at),updatedAt:new Date(v.created_at),employeeId:"",notes:`Mesa ${(M=(C=v.comanda)==null?void 0:C.table)==null?void 0:M.number} - ${((z=v.comanda)==null?void 0:z.customer_name)||"Cliente"}`});const T=g.get(E);T.items.push({id:v.id,menuItemId:v.menu_item_id,quantity:v.quantity,price:v.price,notes:v.notes,menuItem:v.menu_item?{id:v.menu_item.id,name:v.menu_item.item_type==="direct"&&((A=v.menu_item.inventory_items)!=null&&A.name)?v.menu_item.inventory_items.name:v.menu_item.name,category:v.menu_item.category,preparationTime:v.menu_item.preparation_time,item_type:v.menu_item.item_type}:void 0}),T.total+=v.price*v.quantity}),f==null||f.forEach(v=>{var E,T;const b=(E=v.balcao_order)==null?void 0:E.id;if(!b)return;const _=`balcao-${b}`;if(!g.has(_)){let N="pending";v.balcao_order.status==="preparing"?N="preparing":v.balcao_order.status==="ready"?N="ready":v.balcao_order.status==="delivered"&&(N="delivered"),g.set(_,{id:_,tableNumber:"Balco",items:[],status:N,total:0,createdAt:new Date(v.balcao_order.created_at),updatedAt:new Date(v.created_at),employeeId:"",notes:`Pedido Balco #${v.balcao_order.order_number}${v.balcao_order.customer_name?` - ${v.balcao_order.customer_name}`:""}`})}const w=g.get(_);w.items.push({id:v.id,menuItemId:v.menu_item_id,quantity:v.quantity,price:v.unit_price,notes:v.notes,menuItem:v.menu_item?{id:v.menu_item.id,name:v.menu_item.item_type==="direct"&&((T=v.menu_item.inventory_items)!=null&&T.name)?v.menu_item.inventory_items.name:v.menu_item.name,category:v.menu_item.category,preparationTime:v.menu_item.preparation_time,item_type:v.menu_item.item_type}:void 0}),w.total+=v.unit_price*v.quantity}),s(Array.from(g.values())),r(!1)}catch(u){console.error("Erro ao buscar pedidos do bar:",u),l(u instanceof Error?u.message:"Erro ao carregar pedidos"),r(!1)}};return y.useEffect(()=>{c();const u=V.channel("comanda_items_all").on("postgres_changes",{event:"*",schema:"public",table:"comanda_items"},()=>{console.log(" Atualizando pedidos do bar (comanda_items)..."),c()}).subscribe(),h=V.channel("balcao_order_items_all").on("postgres_changes",{event:"*",schema:"public",table:"balcao_order_items"},()=>{console.log(" Atualizando pedidos do bar (balcao_order_items)..."),c()}).subscribe(),f=V.channel("balcao_orders_all").on("postgres_changes",{event:"UPDATE",schema:"public",table:"balcao_orders"},()=>{console.log(" Atualizando pedidos do bar (balcao_orders)..."),c()}).subscribe();return()=>{u.unsubscribe(),h.unsubscribe(),f.unsubscribe()}},[]),{orders:t,loading:a,error:o,refetch:c}},S8=()=>{const t=Ks(),{menuItems:s}=Tt(),{orders:a,loading:r}=N8(),[o,l]=y.useState(""),[c,u]=y.useState(fc()),h=a.filter(b=>b.status==="delivered"),f=h.filter(b=>{var T,N;const w=new Date(b.createdAt).toISOString().split("T")[0]===c,E=((T=b.tableNumber)==null?void 0:T.toLowerCase().includes(o.toLowerCase()))||b.id.toLowerCase().includes(o.toLowerCase())||((N=b.notes)==null?void 0:N.toLowerCase().includes(o.toLowerCase()));return w&&E}),p=f.reduce((b,_)=>b+_.total,0),g=f.length,v=b=>b.id.slice(-4).toUpperCase();return e.jsxs("div",{className:"space-y-6",children:[e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/bar"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(fo,{size:24,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Pedidos Entregues"}),e.jsx("p",{className:"text-gray-600",children:"Histrico de pedidos finalizados"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Receita do Dia"}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["R$ ",p.toFixed(2)]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Pedidos Entregues"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:g})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Ticket Mdio"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:["R$ ",g>0?(p/g).toFixed(2):"0.00"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Mr,{size:20,className:"text-gray-600"}),e.jsx("input",{type:"date",value:c,onChange:b=>u(b.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ka,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar pedidos...",value:o,onChange:b=>l(b.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("button",{onClick:()=>{alert("Funcionalidade de exportao em desenvolvimento")},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx(Vc,{size:20}),e.jsx("span",{children:"Exportar"})]})]})]}),r?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Carregando pedidos..."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(b=>e.jsx(f2,{order:b,menuItems:s,hasMultipleOrders:!1,orderNumber:v(b)},b.id))}),f.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:h.length===0?"Nenhum pedido entregue encontrado":"Nenhum pedido entregue nesta data"})})]})]})]})},E8=()=>{const[t,s]=y.useState([]),[a,r]=y.useState(!0),[o,l]=y.useState(""),[c,u]=y.useState("all"),[h,f]=y.useState(!1),[p,g]=y.useState(null),[v,b]=y.useState(!1),_=async()=>{r(!0);try{const{data:C,error:M}=await V.from("bar_customers").select("*").order("created_at",{ascending:!1});if(M)throw M;s(C||[])}catch(C){console.error("Erro ao carregar clientes:",C)}finally{r(!1)}};y.useEffect(()=>{_()},[]);const w=t.filter(C=>{const M=C.name.toLowerCase().includes(o.toLowerCase())||C.phone.includes(o)||C.email&&C.email.toLowerCase().includes(o.toLowerCase()),z=c==="all"||C.status===c;return M&&z}),E={total:t.length,active:t.filter(C=>C.status==="active").length,vip:t.filter(C=>C.is_vip).length,totalLoyaltyPoints:t.reduce((C,M)=>C+M.loyalty_points,0)},T=C=>{s(M=>[C,...M]),f(!1)},N=C=>{g(C),b(!0)},k=C=>{const M=C.replace(/\D/g,"");return M.length===11?`(${M.slice(0,2)}) ${M.slice(2,7)}-${M.slice(7)}`:C},S=C=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(C);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Clientes do Bar"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gerencie os clientes e suas informaes"})]}),e.jsxs("button",{onClick:()=>f(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx(Zs,{size:20}),e.jsx("span",{children:"Novo Cliente"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Clientes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E.total})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(Wu,{className:"h-6 w-6 text-blue-600"})})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Clientes Ativos"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:E.active})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(Mr,{className:"h-6 w-6 text-green-600"})})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Clientes VIP"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:E.vip})]}),e.jsx("div",{className:"p-3 bg-yellow-100 rounded-full",children:e.jsx(f0,{className:"h-6 w-6 text-yellow-600"})})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pontos Totais"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:E.totalLoyaltyPoints.toLocaleString()})]}),e.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:e.jsx(kt,{className:"h-6 w-6 text-purple-600"})})]})})]}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Ka,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Buscar por nome, telefone ou email...",value:o,onChange:C=>l(C.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsx("div",{className:"flex space-x-4",children:e.jsxs("select",{value:c,onChange:C=>u(C.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"active",children:"Ativo"}),e.jsx("option",{value:"inactive",children:"Inativo"}),e.jsx("option",{value:"blocked",children:"Bloqueado"})]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:a?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Carregando clientes..."})]}):w.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Wu,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Nenhum cliente encontrado"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contato"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pontos"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"ltima Visita"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map(C=>e.jsxs(be.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-blue-600",children:C.name.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:C.name}),C.is_vip&&e.jsx(f0,{className:"ml-2 h-4 w-4 text-yellow-500 fill-current"})]}),e.jsx("div",{className:"text-sm text-gray-500",children:C.cpf||"CPF no informado"})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:k(C.phone)}),e.jsx("div",{className:"text-sm text-gray-500",children:C.email||"Email no informado"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${C.status==="active"?"bg-green-100 text-green-800":C.status==="inactive"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:C.status==="active"?"Ativo":C.status==="inactive"?"Inativo":"Bloqueado"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[C.loyalty_points.toLocaleString()," pts"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:C.last_visit?new Date(C.last_visit).toLocaleDateString("pt-BR"):"Nunca"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>N(C),className:"text-blue-600 hover:text-blue-900",children:e.jsx(Ws,{size:16})}),e.jsx("button",{className:"text-gray-600 hover:text-gray-900",children:e.jsx(lo,{size:16})}),e.jsx("button",{className:"text-red-600 hover:text-red-900",children:e.jsx(Fc,{size:16})})]})})]},C.id))})]})})}),h&&e.jsx(h2,{onCustomerSelected:T,onClose:()=>f(!1)}),v&&p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Detalhes do Cliente"}),e.jsx("button",{onClick:()=>b(!1),className:"text-gray-500 hover:text-gray-700",children:""})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nome"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Telefone"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:k(p.phone)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.email||"No informado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CPF"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.cpf||"No informado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${p.status==="active"?"bg-green-100 text-green-800":p.status==="inactive"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:p.status==="active"?"Ativo":p.status==="inactive"?"Inativo":"Bloqueado"}),p.is_vip&&e.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:" VIP"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pontos de Fidelidade"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[p.loyalty_points.toLocaleString()," pontos"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Limite de Crdito"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:S(p.credit_limit)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Saldo Atual"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:S(p.current_balance)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"ltima Visita"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.last_visit?new Date(p.last_visit).toLocaleDateString("pt-BR"):"Nunca"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cadastrado em"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(p.created_at).toLocaleDateString("pt-BR")})]})]}),p.notes&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Observaes"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.notes})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>b(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"Fechar"})})]})})]})};class C8{constructor(){dt(this,"cache",new Map)}set(s,a,r=3e5){this.cache.set(s,{data:a,timestamp:Date.now(),ttl:r})}get(s){const a=this.cache.get(s);return a?Date.now()-a.timestamp>a.ttl?(this.cache.delete(s),null):a.data:null}clear(){this.cache.clear()}has(s){return this.get(s)!==null}}const _p=new C8,k8=async(t,s={})=>{const{maxAttempts:a=3,delay:r=1e3,backoff:o="exponential",retryCondition:l=h=>!M8(h)}=s;let c,u=0;for(let h=0;h<a;h++){u++;try{return{success:!0,data:await t(),attempts:u,usedFallback:!1,fromCache:!1}}catch(f){if(c=f instanceof Error?f:new Error(String(f)),h===a-1||!l(c))break;const p=o==="exponential"?r*Math.pow(2,h):r*(h+1);console.warn(`Attempt ${h+1} failed, retrying in ${p}ms:`,c.message),await R8(p)}}return{success:!1,error:c,attempts:u,usedFallback:!1,fromCache:!1}},T8=async(t,s={})=>{const{fallbackFn:a,useCache:r=!0,cacheKey:o,offlineMode:l=!1,...c}=s;if(l&&r&&o){const h=_p.get(o);if(h)return{success:!0,data:h,attempts:0,usedFallback:!1,fromCache:!0}}const u=await k8(t,c);if(u.success)return r&&o&&u.data&&_p.set(o,u.data),u;if(a)try{return{success:!0,data:await a(),attempts:u.attempts,usedFallback:!0,fromCache:!1}}catch(h){console.error("Fallback also failed:",h)}if(r&&o){const h=_p.get(o);if(h)return{success:!0,data:h,attempts:u.attempts,usedFallback:!0,fromCache:!0}}return u},A8=async()=>{const t={synced:0,failed:0,errors:[]},s=Object.keys(localStorage).filter(a=>a.startsWith("pending_save_")||a.startsWith("pending_delete_"));for(const a of s)try{const r=JSON.parse(localStorage.getItem(a)||"{}");r.type==="employee_save"?(console.log("Syncing pending employee save:",r.data),localStorage.removeItem(a),t.synced++):r.type==="employee_delete"&&(console.log("Syncing pending employee delete:",r.employeeId),localStorage.removeItem(a),t.synced++)}catch(r){t.failed++,t.errors.push(`Failed to sync ${a}: ${r}`)}return t},M8=t=>{var r;const s=["auth","permission","unauthorized","forbidden","not found","404","401","403","validation"],a=((r=t.message)==null?void 0:r.toLowerCase())||"";return s.some(o=>a.includes(o))},R8=t=>new Promise(s=>setTimeout(s,t)),O8=()=>navigator.onLine,D8=t=>{const s=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",s),window.addEventListener("offline",a),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",a)}},w0=t=>{if(!t)return"Erro desconhecido";const s=t.message||t.toString(),a={"network error":"Problema de conexo. Verifique sua internet.",timeout:"A operao demorou muito para responder. Tente novamente.","server error":"Erro no servidor. Tente novamente em alguns minutos.",auth:"Erro de autenticao. Faa login novamente.",permission:"Voc no tem permisso para esta operao.",validation:"Dados invlidos. Verifique as informaes.","not found":"Registro no encontrado.",duplicate:"Este registro j existe.",connection:"Problema de conexo com o servidor."};for(const[r,o]of Object.entries(a))if(s.toLowerCase().includes(r))return o;return"Ocorreu um erro inesperado. Tente novamente."},P8=t=>t.success?t.fromCache?"Dados carregados do cache local (sem conexo)":t.usedFallback?"Operao realizada com mtodo alternativo":t.attempts>1?`Operao realizada aps ${t.attempts} tentativas`:"Operao realizada com sucesso":w0(t.error),z8=(t={})=>{const{autoSync:s=!0,showNotifications:a=!0}=t,[r,o]=y.useState({isOnline:O8(),isRetrying:!1,pendingOperations:0,lastError:null,lastRecovery:null});y.useEffect(()=>D8(_=>{o(w=>({...w,isOnline:_})),_&&s&&l()}),[s]),y.useEffect(()=>{const b=()=>{const w=Object.keys(localStorage).filter(E=>E.startsWith("pending_save_")||E.startsWith("pending_delete_"));o(E=>({...E,pendingOperations:w.length}))};b();const _=setInterval(b,5e3);return()=>clearInterval(_)},[]);const l=y.useCallback(async()=>{if(r.pendingOperations!==0)try{o(_=>({..._,isRetrying:!0}));const b=await A8();b.synced>0&&o(_=>({..._,lastRecovery:`${b.synced} operaes sincronizadas`,pendingOperations:_.pendingOperations-b.synced})),b.failed>0&&o(_=>({..._,lastError:`${b.failed} operaes falharam na sincronizao`}))}catch(b){o(_=>({..._,lastError:w0(b)}))}finally{o(b=>({...b,isRetrying:!1}))}},[r.pendingOperations]),c=y.useCallback(async(b,_={})=>{const{maxAttempts:w=3,fallback:E,cacheKey:T,operationType:N="operation"}=_;o(k=>({...k,isRetrying:!0,lastError:null}));try{const k=await T8(b,{maxAttempts:w,delay:1e3,backoff:"exponential",fallbackFn:E,useCache:!!T,cacheKey:T,offlineMode:!r.isOnline}),S=P8(k);return o(C=>({...C,isRetrying:!1,lastRecovery:k.success?S:null,lastError:k.success?null:S})),k}catch(k){const S=w0(k);return o(C=>({...C,isRetrying:!1,lastError:S})),{success:!1,error:k instanceof Error?k:new Error(S),attempts:w,usedFallback:!1,fromCache:!1}}},[r.isOnline]),u=y.useCallback(()=>{o(b=>({...b,lastError:null}))},[]),h=y.useCallback(()=>{o(b=>({...b,lastRecovery:null}))},[]),f=y.useCallback(async()=>{await l()},[l]),p=y.useCallback(async(b,_)=>c(b,{maxAttempts:3,cacheKey:_,operationType:"load"}),[c]),g=y.useCallback(async(b,_,w)=>c(b,{maxAttempts:5,fallback:w?async()=>(localStorage.setItem(w,JSON.stringify({type:"pending_save",data:_,timestamp:Date.now()})),{..._,pending:!0}):void 0,operationType:"save"}),[c]),v=y.useCallback(async(b,_)=>c(b,{maxAttempts:3,fallback:async()=>{localStorage.setItem(`pending_delete_${_}`,JSON.stringify({type:"pending_delete",itemId:_,timestamp:Date.now()}))},operationType:"delete"}),[c]);return{...r,executeWithRecovery:c,clearError:u,clearRecovery:h,manualSync:f,loadWithRecovery:p,saveWithRecovery:g,deleteWithRecovery:v}};class $8{constructor(){dt(this,"context",{})}setContext(s,a){this.context={userId:s,userEmail:a}}async log(s,a,r,o={},l=!0,c){const u={action:s,resource_type:a,resource_id:r,user_id:this.context.userId,details:this.sanitizeDetails(o),timestamp:new Date().toISOString(),success:l,error_message:c};try{await this.saveToDB(u)}catch(h){console.error("Failed to save audit log:",h),this.saveToLocalStorage(u)}}async logEmployeeCreated(s,a){await this.log("employee_created","employee",s,{employee_name:a.nome_completo||a.name,employee_role:a.bar_role,has_system_access:a.tem_acesso_sistema})}async logEmployeeUpdated(s,a){await this.log("employee_updated","employee",s,{changes:this.sanitizeDetails(a),fields_changed:Object.keys(a)})}async logEmployeeDeactivated(s,a){await this.log("employee_deactivated","employee",s,{reason:a,deactivation_date:new Date().toISOString()})}async logLoginAttempt(s,a,r){await this.log(a?"login_success":"login_failure","session","login",{email:s},a,r)}async saveToDB(s){const{error:a}=await V.from("audit_logs").insert([s]);if(a)throw a}saveToLocalStorage(s){try{const a=JSON.parse(localStorage.getItem("audit_logs_pending")||"[]");a.push(s),localStorage.setItem("audit_logs_pending",JSON.stringify(a.slice(-100)))}catch(a){console.error("Failed to save to localStorage:",a)}}sanitizeDetails(s){const a={...s};return["password","senha","token","secret"].forEach(o=>{a[o]&&(a[o]="[REDACTED]")}),a}async syncPendingLogs(){try{const s=JSON.parse(localStorage.getItem("audit_logs_pending")||"[]");return s.length===0?{synced:0,failed:0}:(await this.saveToDB(s),localStorage.removeItem("audit_logs_pending"),{synced:s.length,failed:0})}catch{return{synced:0,failed:1}}}}const ia=new $8,L8=()=>{const{user:t,permissions:s}=Et();return y.useEffect(()=>{t&&s&&ia.setContext(t.id,t.email)},[t,s]),y.useEffect(()=>{const a=async()=>{navigator.onLine&&await ia.syncPendingLogs()};a();const r=()=>a();return window.addEventListener("online",r),()=>window.removeEventListener("online",r)},[]),{logEmployeeCreated:ia.logEmployeeCreated.bind(ia),logEmployeeUpdated:ia.logEmployeeUpdated.bind(ia),logEmployeeDeactivated:ia.logEmployeeDeactivated.bind(ia),logLoginAttempt:ia.logLoginAttempt.bind(ia),syncPendingLogs:ia.syncPendingLogs.bind(ia)}};class I8{constructor(){dt(this,"memoryCache",new Map);dt(this,"defaultTTL",5*60*1e3);dt(this,"maxSize",100)}set(s,a,r={}){const{ttl:o=this.defaultTTL,persistent:l=!1,maxSize:c=this.maxSize}=r,u={data:a,timestamp:Date.now(),ttl:o,key:s};this.memoryCache.set(s,u),this.memoryCache.size>c&&this.evictOldest(),l&&this.saveToLocalStorage(s,u)}get(s){let a=this.memoryCache.get(s);return a||(a=this.loadFromLocalStorage(s),a&&this.memoryCache.set(s,a)),a?this.isExpired(a)?(this.delete(s),null):a.data:null}has(s){return this.get(s)!==null}delete(s){this.memoryCache.delete(s),this.removeFromLocalStorage(s)}clear(){this.memoryCache.clear(),this.clearLocalStorage()}invalidatePattern(s){const a=new RegExp(s);for(const r of this.memoryCache.keys())a.test(r)&&this.memoryCache.delete(r);this.invalidateLocalStoragePattern(s)}invalidateByPrefix(s){this.invalidatePattern(`^${s}`)}isExpired(s){return Date.now()-s.timestamp>s.ttl}evictOldest(){let s="",a=Date.now();for(const[r,o]of this.memoryCache.entries())o.timestamp<a&&(a=o.timestamp,s=r);s&&this.memoryCache.delete(s)}saveToLocalStorage(s,a){try{const r=`cache_${s}`;localStorage.setItem(r,JSON.stringify(a))}catch(r){console.warn("Failed to save to localStorage:",r)}}loadFromLocalStorage(s){try{const a=`cache_${s}`,r=localStorage.getItem(a);return r?JSON.parse(r):null}catch(a){return console.warn("Failed to load from localStorage:",a),null}}removeFromLocalStorage(s){try{const a=`cache_${s}`;localStorage.removeItem(a)}catch(a){console.warn("Failed to remove from localStorage:",a)}}clearLocalStorage(){try{Object.keys(localStorage).forEach(a=>{a.startsWith("cache_")&&localStorage.removeItem(a)})}catch(s){console.warn("Failed to clear localStorage cache:",s)}}invalidateLocalStoragePattern(s){try{const a=new RegExp(s);Object.keys(localStorage).forEach(o=>{if(o.startsWith("cache_")){const l=o.replace("cache_","");a.test(l)&&localStorage.removeItem(o)}})}catch(a){console.warn("Failed to invalidate localStorage pattern:",a)}}getStats(){const s=this.memoryCache.size,a=Object.keys(localStorage).filter(r=>r.startsWith("cache_")).length;return{memorySize:s,localStorageSize:a,totalSize:s+a}}startAutoCleanup(s=6e4){const r=setInterval(()=>{for(const[o,l]of this.memoryCache.entries())this.isExpired(l)&&this.memoryCache.delete(o);try{Object.keys(localStorage).forEach(l=>{if(l.startsWith("cache_")){const c=localStorage.getItem(l);if(c){const u=JSON.parse(c);this.isExpired(u)&&localStorage.removeItem(l)}}})}catch(o){console.warn("Auto cleanup failed:",o)}},s);return()=>clearInterval(r)}}const mr=new I8,xu={getList:()=>mr.get("employees_list"),setList:t=>mr.set("employees_list",t,{ttl:2*60*1e3,persistent:!0}),getEmployee:t=>mr.get(`employee_${t}`),setEmployee:(t,s)=>mr.set(`employee_${t}`,s,{ttl:5*60*1e3,persistent:!0}),getStats:()=>mr.get("employee_stats"),setStats:t=>mr.set("employee_stats",t,{ttl:1*60*1e3}),invalidateAll:()=>mr.invalidateByPrefix("employee"),invalidateList:()=>mr.delete("employees_list"),invalidateEmployee:t=>mr.delete(`employee_${t}`)};class U8{constructor(){dt(this,"events",[]);dt(this,"metrics",new Map);this.loadFromStorage()}trackEmployeeCreation(s){this.addEvent({type:"employee_creation",timestamp:new Date().toISOString(),data:s})}trackValidationError(s){this.addEvent({type:"validation_error",timestamp:new Date().toISOString(),data:s})}trackSystemAccess(s){this.addEvent({type:"system_access",timestamp:new Date().toISOString(),data:s})}trackPerformance(s){this.addEvent({type:"performance",timestamp:new Date().toISOString(),data:s})}addEvent(s){this.events.push(s),this.events.length>1e4&&(this.events=this.events.slice(-1e4)),this.saveToStorage()}generateCreationMetrics(s="week"){const a=this.getEventsByType("employee_creation"),r=this.getEventsByType("validation_error"),o=a.length,l=a.filter(u=>u.data.success).length,c=o-l;return{totalCreated:o,successRate:o>0?l/o*100:0,failureRate:o>0?c/o*100:0,averageCreationTime:this.calculateAverageCreationTime(a),creationsByPeriod:this.groupByPeriod(a,s),creationsByRole:this.groupByRole(a),creationsBySource:this.groupBySource(a),validationErrors:this.analyzeValidationErrors(r)}}generatePerformanceMetrics(){const s=this.getEventsByType("performance");return{averageResponseTime:this.calculateAverageResponseTime(s),slowestOperations:this.findSlowestOperations(s),errorsByType:this.groupErrorsByType(s),retryAttempts:this.analyzeRetryAttempts(s),cacheHitRate:this.calculateCacheHitRate(s)}}generateUsageMetrics(){const s=this.getEventsByType("system_access");return{activeUsers:this.countActiveUsers(s),systemAccessRate:this.calculateSystemAccessRate(s),moduleUsage:this.analyzeModuleUsage(s),peakUsageHours:this.findPeakUsageHours(s),sessionDuration:this.calculateAverageSessionDuration(s)}}generateDistributionMetrics(){const s=this.getEventsByType("employee_creation");return{roleDistribution:this.analyzeRoleDistribution(s),shiftDistribution:this.analyzeShiftDistribution(s),departmentDistribution:this.analyzeDepartmentDistribution(s),tenureDistribution:this.analyzeTenureDistribution(s)}}generateCompleteAnalytics(){return{creationMetrics:this.generateCreationMetrics(),performanceMetrics:this.generatePerformanceMetrics(),usageMetrics:this.generateUsageMetrics(),distributionMetrics:this.generateDistributionMetrics()}}calculateAverageCreationTime(s){return s.length===0?0:s.reduce((r,o)=>r+(o.data.duration||0),0)/s.length}groupByPeriod(s,a){const r=new Map;return s.forEach(o=>{const l=new Date(o.timestamp);let c;switch(a){case"day":c=l.toISOString().split("T")[0];break;case"week":const u=new Date(l);u.setDate(l.getDate()-l.getDay()),c=u.toISOString().split("T")[0];break;case"month":c=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;break;default:c=l.toISOString().split("T")[0]}r.set(c,(r.get(c)||0)+1)}),Array.from(r.entries()).map(([o,l])=>({period:o,count:l,timestamp:new Date().toISOString()}))}groupByRole(s){const a=new Map;s.forEach(o=>{const l=o.data.role;l&&a.set(l,(a.get(l)||0)+1)});const r=s.length;return Array.from(a.entries()).map(([o,l])=>({role:o,count:l,percentage:r>0?l/r*100:0}))}groupBySource(s){const a=new Map;return s.forEach(r=>{const o=r.data.source;if(o){const l=a.get(o)||{total:0,successful:0};l.total++,r.data.success&&l.successful++,a.set(o,l)}}),Array.from(a.entries()).map(([r,o])=>({source:r,count:o.total,successRate:o.total>0?o.successful/o.total*100:0}))}analyzeValidationErrors(s){const a=new Map;s.forEach(l=>{const c=l.data.field,u=l.data.errorType;a.has(c)||a.set(c,new Map);const h=a.get(c);h.set(u,(h.get(u)||0)+1)});const r=[],o=s.length;return a.forEach((l,c)=>{l.forEach((u,h)=>{r.push({field:c,errorType:h,count:u,percentage:o>0?u/o*100:0})})}),r.sort((l,c)=>c.count-l.count)}calculateAverageResponseTime(s){return s.length===0?0:s.reduce((r,o)=>r+(o.data.duration||0),0)/s.length}findSlowestOperations(s){const a=new Map;return s.forEach(r=>{const o=r.data.operation,l=r.data.duration||0;a.has(o)||a.set(o,{times:[],count:0});const c=a.get(o);c.times.push(l),c.count++}),Array.from(a.entries()).map(([r,o])=>({operation:r,averageTime:o.times.reduce((l,c)=>l+c,0)/o.times.length,maxTime:Math.max(...o.times),count:o.count})).sort((r,o)=>o.averageTime-r.averageTime).slice(0,10)}groupErrorsByType(s){const a=new Map;s.filter(o=>!o.data.success).forEach(o=>{const l=o.data.errorType||"unknown",c=a.get(l)||{count:0,lastOccurrence:""};c.count++,c.lastOccurrence=o.timestamp,a.set(l,c)});const r=Array.from(a.values()).reduce((o,l)=>o+l.count,0);return Array.from(a.entries()).map(([o,l])=>({type:o,count:l.count,percentage:r>0?l.count/r*100:0,lastOccurrence:l.lastOccurrence}))}analyzeRetryAttempts(s){const a=new Map;return s.forEach(r=>{const o=r.data.operation,l=r.data.retryCount||0;if(l>0){a.has(o)||a.set(o,{attempts:[],successes:0});const c=a.get(o);c.attempts.push(l),r.data.success&&c.successes++}}),Array.from(a.entries()).map(([r,o])=>({operation:r,attempts:o.attempts.reduce((l,c)=>l+c,0)/o.attempts.length,successRate:o.attempts.length>0?o.successes/o.attempts.length*100:0}))}calculateCacheHitRate(s){const a=s.filter(o=>o.data.cacheHit!==void 0);return a.length===0?0:a.filter(o=>o.data.cacheHit).length/a.length*100}countActiveUsers(s){const a=new Set,r=new Date(Date.now()-24*60*60*1e3);return s.filter(o=>new Date(o.timestamp)>r).forEach(o=>a.add(o.data.userId)),a.size}calculateSystemAccessRate(s){const a=s.length,r=s.filter(o=>o.data.success).length;return a>0?r/a*100:0}analyzeModuleUsage(s){const a=new Map;return s.forEach(r=>{const o=r.data.module,l=r.data.userId,c=r.data.duration||0;a.has(o)||a.set(o,{accessCount:0,users:new Set,totalDuration:0});const u=a.get(o);u.accessCount++,u.users.add(l),u.totalDuration+=c}),Array.from(a.entries()).map(([r,o])=>({module:r,accessCount:o.accessCount,uniqueUsers:o.users.size,averageSessionTime:o.accessCount>0?o.totalDuration/o.accessCount:0}))}findPeakUsageHours(s){const a=new Map;return s.forEach(r=>{const o=new Date(r.timestamp).getHours(),l=r.data.userId;a.has(o)||a.set(o,{usage:0,users:new Set});const c=a.get(o);c.usage++,c.users.add(l)}),Array.from(a.entries()).map(([r,o])=>({hour:r,usage:o.usage,activeUsers:o.users.size})).sort((r,o)=>o.usage-r.usage)}calculateAverageSessionDuration(s){const a=s.map(r=>r.data.duration).filter(r=>r!==void 0&&r>0);return a.length===0?0:a.reduce((r,o)=>r+o,0)/a.length}analyzeRoleDistribution(s){const a=new Map;s.forEach(o=>{const l=o.data.role;l&&a.set(l,(a.get(l)||0)+1)});const r=s.length;return Array.from(a.entries()).map(([o,l])=>({role:o,count:l,percentage:r>0?l/r*100:0,trend:"stable"}))}analyzeShiftDistribution(s){return[{shift:"manha",count:0,percentage:0,efficiency:85},{shift:"tarde",count:0,percentage:0,efficiency:90},{shift:"noite",count:0,percentage:0,efficiency:80}]}analyzeDepartmentDistribution(s){return[{department:"Atendimento",employeeCount:0,averageTenure:12,turnoverRate:15},{department:"Cozinha",employeeCount:0,averageTenure:18,turnoverRate:10},{department:"Bar",employeeCount:0,averageTenure:15,turnoverRate:12}]}analyzeTenureDistribution(s){return[{range:"0-6 meses",count:0,percentage:0},{range:"6-12 meses",count:0,percentage:0},{range:"1-2 anos",count:0,percentage:0},{range:"2+ anos",count:0,percentage:0}]}getEventsByType(s){return this.events.filter(a=>a.type===s)}saveToStorage(){try{localStorage.setItem("employee_analytics",JSON.stringify(this.events.slice(-1e3)))}catch(s){console.warn("Failed to save analytics to storage:",s)}}loadFromStorage(){try{const s=localStorage.getItem("employee_analytics");s&&(this.events=JSON.parse(s))}catch(s){console.warn("Failed to load analytics from storage:",s)}}}const B8=new U8,Rj=t=>B8.trackEmployeeCreation(t),V8=()=>{const[t,s]=y.useState([]),[a,r]=y.useState(!0),[o,l]=y.useState(null),{loadWithRecovery:c,saveWithRecovery:u}=z8();L8();const h=y.useCallback(async()=>{var N,k,S;try{r(!0),l(null),xu.invalidateAll(),console.log(" DEBUG - Cache limpo, buscando dados frescos do banco");const C=await c(async()=>{const M=await Ac();let z=V;M.success?M.useAdmin&&(console.log(" Using admin client for fetch operations"),z=ut):console.warn(" Authentication failed, but continuing with fetch:",M.error);const A=await bt();if(!A)throw new Error("Empresa no encontrada para o usurio atual");const{data:$,error:P}=await z.from("employees").select(`
            id, name, email, phone, cpf, status, employee_code,
            tem_acesso_sistema, auth_user_id, created_at, updated_at,
            position_id, department_id,
            bar_employees!inner(
              bar_role, shift_preference, specialties, commission_rate,
              is_active, start_date, end_date, notes
            )
          `).eq("empresa_id",A).eq("status","active").order("created_at",{ascending:!1});if(P)throw console.error("Erro na consulta employees:",P),new Error(`Erro ao consultar banco de dados: ${P.message}`);return $||[]},"employees_list");if(C.success){const M=C.data,z=(C.data||[]).map(A=>{var P;const $=((P=A.bar_employees)==null?void 0:P[0])||{};return{id:A.id,employee_id:A.id,bar_role:$.bar_role||"atendente",shift_preference:$.shift_preference||"qualquer",specialties:$.specialties||[],commission_rate:$.commission_rate||0,status:A.status,start_date:$.start_date||A.created_at,end_date:$.end_date||null,notes:$.notes||`Cdigo: ${A.employee_code}`,created_at:A.created_at,updated_at:A.updated_at,is_active:$.is_active!==void 0?$.is_active:A.status==="active",employee:{id:A.id,name:A.name||"Nome no informado",cpf:A.cpf,email:A.email,phone:A.phone,hire_date:A.created_at,status:A.status},usuario_empresa:{id:A.id,nome_completo:A.name,email:A.email,telefone:A.phone,status:A.status,tem_acesso_sistema:A.tem_acesso_sistema,auth_user_id:A.auth_user_id}}});console.log(" Funcionrios carregados:",z.length),z.length>0&&console.log(" Primeiro funcionrio:",(k=(N=z[0])==null?void 0:N.employee)==null?void 0:k.name),s(z),xu.setList(z)}else console.error("Erro ao buscar funcionrios:",C.error),l(((S=C.error)==null?void 0:S.message)||"Erro ao buscar funcionrios")}catch(C){console.error("Erro ao buscar funcionrios:",C),l(C instanceof Error?C.message:"Erro ao buscar funcionrios")}finally{r(!1)}},[c]),f=y.useCallback(async N=>{const k=performance.now();try{l(null);const S=await u(async()=>{const C=await Ac();if(!C.success)throw new Error(`Authentication failed: ${C.error}`);let M=V,z="00000000-0000-0000-0000-000000000001";if(C.useAdmin)console.log(" Using admin client for database operations"),M=ut;else{const te=await bt();te&&(z=te)}console.log(" Creating employee for empresa:",z),console.log(" Criando registro na tabela employees...");const A=`EMP-${Date.now()}`,{data:$,error:P}=await M.from("employees").insert([{employee_code:A,name:N.name,email:N.email||null,phone:N.phone||null,cpf:N.cpf||null,empresa_id:z,status:"active",tem_acesso_sistema:!1}]).select().single();if(P)throw console.error(" Erro ao criar employee:",P),P;console.log(" Employee criado:",$.id);const F=[];N.notes&&F.push(N.notes);const I=F.join(", ");console.log(" Criando registro na tabela bar_employees...");const{data:J,error:pe}=await M.from("bar_employees").insert([{employee_id:$.id,bar_role:N.bar_role,shift_preference:N.shift_preference||"qualquer",specialties:N.specialties||[],commission_rate:N.commission_rate||0,is_active:!0,start_date:new Date().toISOString().split("T")[0],notes:I,empresa_id:z}]).select().single();if(pe)throw console.error(" Erro ao criar bar_employee:",pe),await M.from("employees").delete().eq("id",$.id),pe;return console.log(" Bar employee criado:",J.id),console.log(" Funcionrio completo criado com sucesso!"),J},N,`pending_save_employee_${Date.now()}`);if(S.success)return Rj({employeeId:S.data.id,role:N.bar_role,source:"manual",duration:performance.now()-k,success:!0}),await h(),S.data.id;throw S.error||new Error("Erro ao criar funcionrio")}catch(S){console.error("Erro ao criar funcionrio:",S);const C=S instanceof Error?S.message:"Erro ao criar funcionrio";throw Rj({employeeId:"failed",role:N.bar_role,source:"manual",duration:performance.now()-k,success:!1,errors:[C]}),l(C),new Error(C)}},[h,u]),p=y.useCallback(async(N,k)=>{try{l(null);const{data:S,error:C}=await V.from("bar_employees").select("notes").eq("id",N).single();if(C)throw C;const M=(S==null?void 0:S.notes)||"",z=B=>{const Y=M.match(B);return Y?Y[1]:""},A=z(/Nome: ([^,]+)/),$=z(/CPF: ([^,]+)/),P=z(/Email: ([^,]+)/),F=z(/Telefone: ([^,]+)/),I=z(/Observaes: (.+)$/),J=k.name!==void 0?k.name:A,pe=k.cpf!==void 0?k.cpf:$,te=k.email!==void 0?k.email:P,L=k.phone!==void 0?k.phone:F,G=k.notes!==void 0?k.notes:I,ee=[];J&&ee.push(`Nome: ${J}`),pe&&ee.push(`CPF: ${pe}`),te&&ee.push(`Email: ${te}`),L&&ee.push(`Telefone: ${L}`),G&&ee.push(`Observaes: ${G}`);const xe=ee.join(", "),O={updated_at:new Date().toISOString(),notes:xe};k.bar_role!==void 0&&(O.bar_role=k.bar_role),k.shift_preference!==void 0&&(O.shift_preference=k.shift_preference),k.specialties!==void 0&&(O.specialties=k.specialties),k.commission_rate!==void 0&&(O.commission_rate=k.commission_rate),k.is_active!==void 0&&(O.is_active=k.is_active);const{error:H}=await V.from("bar_employees").update(O).eq("id",N);if(H)throw H;await h()}catch(S){console.error("Erro ao atualizar funcionrio:",S);const C=S instanceof Error?S.message:"Erro ao atualizar funcionrio";throw l(C),new Error(C)}},[h]),g=y.useCallback(async N=>{try{await p(N,{is_active:!1})}catch(k){throw console.error("Erro ao desativar funcionrio:",k),k}},[p]),v=y.useCallback(async N=>{try{await p(N,{is_active:!0})}catch(k){throw console.error("Erro ao reativar funcionrio:",k),k}},[p]),b=y.useCallback(async N=>{try{r(!0),l(null);const{data:k,error:S}=await V.from("bar_employees").select(`
          id,
          employees!inner(
            email,
            name,
            profile_id
          )
        `).eq("id",N).single();if(S||!k)throw new Error("Funcionrio no encontrado");const C=k.employees.email,M=_(),{data:z,error:A}=await V.rpc("reset_employee_password",{user_email:C,new_password:M});if(A)throw new Error(`Erro ao resetar senha: ${A.message}`);return{success:!0,newPassword:M}}catch(k){const S=k instanceof Error?k.message:"Erro ao resetar senha";return l(S),console.error("Erro ao resetar senha:",k),{success:!1,error:S}}finally{r(!1)}},[]),_=()=>{const N="abcdefghijkmnpqrstuvwxyz23456789";let k="";for(let S=0;S<8;S++)k+=N.charAt(Math.floor(Math.random()*N.length));return k},w=y.useCallback(async N=>{try{const{data:k,error:S}=await V.from("bar_employees").select("*").eq("id",N).single();if(S)throw S;if(!k)return null;const C=k.notes||"",M=C.match(/Nome: ([^,]+)/),z=C.match(/CPF: ([^,]+)/),A=C.match(/Email: ([^,]+)/),$=C.match(/Telefone: ([^,]+)/);return{id:k.id,employee_id:k.employee_id||"",bar_role:k.bar_role,shift_preference:k.shift_preference,specialties:k.specialties||[],commission_rate:k.commission_rate||0,status:k.is_active?"active":"inactive",start_date:k.start_date||"",end_date:k.end_date||void 0,notes:k.notes||void 0,created_at:k.created_at||"",updated_at:k.updated_at||"",employee:{id:k.id,name:M?M[1]:"Nome no informado",cpf:z?z[1]:void 0,email:A?A[1]:void 0,phone:$?$[1]:void 0,hire_date:k.start_date||void 0,status:k.is_active?"active":"inactive"}}}catch(k){return console.error("Erro ao buscar funcionrio:",k),null}},[]),E=y.useCallback((N="",k="all",S="all")=>t.filter(C=>{var P,F,I;const M=C.employee;if(!M)return!1;const z=M.name.toLowerCase().includes(N.toLowerCase())||((P=M.phone)==null?void 0:P.includes(N))||((F=M.email)==null?void 0:F.toLowerCase().includes(N.toLowerCase()))||((I=M.cpf)==null?void 0:I.includes(N)),A=k==="all"||C.bar_role===k,$=S==="all"||C.status===S;return z&&A&&$}),[t]),T=y.useCallback(()=>{const N=xu.getStats();if(N)return N;const k=new Date,S=new Date(k.getTime()-30*24*60*60*1e3),C=t.filter($=>$.start_date?new Date($.start_date)>=S:!1).length,M=t.length>0?t.reduce(($,P)=>{if(!P.start_date)return $;const F=new Date(P.start_date),I=Math.max(0,Math.floor((k.getTime()-F.getTime())/(30*24*60*60*1e3)));return $+I},0)/t.length:0,z={manha:t.filter($=>$.shift_preference==="manha").length,tarde:t.filter($=>$.shift_preference==="tarde").length,noite:t.filter($=>$.shift_preference==="noite").length,qualquer:t.filter($=>$.shift_preference==="qualquer"||!$.shift_preference).length},A={total:t.length,active:t.filter($=>$.status==="active").length,inactive:t.filter($=>$.status==="inactive").length,byRole:{atendente:t.filter($=>$.bar_role==="atendente").length,garcom:t.filter($=>$.bar_role==="garcom").length,cozinheiro:t.filter($=>$.bar_role==="cozinheiro").length,barman:t.filter($=>$.bar_role==="barman").length,gerente:t.filter($=>$.bar_role==="gerente").length},byShift:z,recentHires:C,avgTenure:Math.round(M),topPerformers:Math.floor(t.filter($=>$.status==="active").length*.2),needsAttention:Math.floor(t.length*.1)};return xu.setStats(A),A},[t]);return y.useEffect(()=>{h()},[h]),{employees:t,loading:a,error:o,createEmployee:f,updateEmployee:p,deactivateEmployee:g,reactivateEmployee:v,resetEmployeePassword:b,getEmployeeById:w,filterEmployees:E,getStats:T,refetch:h}};var p2=(t=>(t.CREATE_EMPLOYEE="create_employee",t.UPDATE_PASSWORD="update_password",t.DEACTIVATE_EMPLOYEE="deactivate_employee",t.REACTIVATE_EMPLOYEE="reactivate_employee",t.UPDATE_PERMISSIONS="update_permissions",t.LIST_EMPLOYEES="list_employees",t.CHECK_EMAIL="check_email",t.GENERATE_CREDENTIALS="generate_credentials",t))(p2||{});const Wn=class Wn{constructor(){dt(this,"logConfig");dt(this,"logs",[]);this.logConfig={level:"info",enableConsole:!0,enablePersistence:!1}}static getInstance(){return Wn.instance||(Wn.instance=new Wn),Wn.instance}configureLogging(s){this.logConfig={...this.logConfig,...s},this.log("info","create_employee","Logging configurado",{config:this.logConfig})}log(s,a,r,o,l){const c={timestamp:new Date().toISOString(),level:s,operation:a,message:r,data:o,error:l};if(this.logConfig.enablePersistence&&(this.logs.push(c),this.logs.length>1e3&&(this.logs=this.logs.slice(-1e3))),this.logConfig.enableConsole&&this.shouldLog(s)){const h=`${this.getLogEmoji(s)} [${a}]`;switch(s){case"debug":console.debug(h,r,o||"");break;case"info":console.log(h,r,o||"");break;case"warn":console.warn(h,r,o||"");break;case"error":console.error(h,r,o||"",l||"");break}}}shouldLog(s){const a=["debug","info","warn","error"],r=a.indexOf(this.logConfig.level);return a.indexOf(s)>=r}getLogEmoji(s){switch(s){case"debug":return"";case"info":return"";case"warn":return"";case"error":return"";default:return""}}getLogs(s,a){let r=[...this.logs];return s&&(r=r.filter(o=>o.operation===s)),a&&(r=r.filter(o=>o.level===a)),r}clearLogs(){this.logs=[],this.log("info","create_employee","Logs limpos")}validateEmployeeData(s){var r,o,l;const a=[];return(r=s.nome_completo)!=null&&r.trim()||a.push("Nome completo  obrigatrio"),(o=s.email)!=null&&o.trim()?this.isValidEmail(s.email)||a.push("Email deve ter formato vlido"):a.push("Email  obrigatrio"),s.bar_role||a.push("Funo no bar  obrigatria"),(l=s.cargo)!=null&&l.trim()||a.push("Cargo  obrigatrio"),s.cpf&&!this.isValidCPF(s.cpf)&&a.push("CPF deve ter formato vlido"),s.telefone&&!this.isValidPhone(s.telefone)&&a.push("Telefone deve ter formato vlido"),s.commission_rate&&(s.commission_rate<0||s.commission_rate>100)&&a.push("Taxa de comisso deve estar entre 0 e 100"),(!s.permissoes_modulos||Object.keys(s.permissoes_modulos).length===0)&&a.push("Permisses de mdulos so obrigatrias"),{valid:a.length===0,errors:a}}isValidEmail(s){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)}isValidCPF(s){const a=s.replace(/\D/g,"");if(a.length!==11||/^(\d)\1{10}$/.test(a))return!1;let r=0;for(let l=0;l<9;l++)r+=parseInt(a.charAt(l))*(10-l);let o=11-r%11;if((o===10||o===11)&&(o=0),o!==parseInt(a.charAt(9)))return!1;r=0;for(let l=0;l<10;l++)r+=parseInt(a.charAt(l))*(11-l);return o=11-r%11,(o===10||o===11)&&(o=0),o===parseInt(a.charAt(10))}isValidPhone(s){const a=s.replace(/\D/g,"");return a.length>=10&&a.length<=11}createServiceError(s,a,r){const o=new Error(`[${s}] ${a}`);return o.type=s,o.originalError=r,o}handleError(s,a,r){let o="internal_error",l="Erro interno do servio";a instanceof Error&&(l=a.message,a.message.includes("validation")||a.message.includes("invalid")?o="validation_error":a.message.includes("auth")||a.message.includes("authentication")?o="auth_error":a.message.includes("database")||a.message.includes("Database")?o="database_error":a.message.includes("permission")||a.message.includes("unauthorized")?o="permission_error":(a.message.includes("network")||a.message.includes("fetch"))&&(o="network_error"));const c=r?`${r}: ${l}`:l;return this.log("error",s,c,{errorType:o,context:r},a),{success:!1,error:c}}async executeWithErrorHandling(s,a,r){try{const o=Date.now();this.log("debug",s,`Iniciando operao${r?`: ${r}`:""}`);const l=await a(),c=Date.now()-o;return this.log("debug",s,`Operao concluda em ${c}ms`),l}catch(o){return this.handleError(s,o,r)}}async createCompleteEmployee(s,a){var c,u,h,f,p,g,v,b,_,w;const r=Date.now(),o="create_employee",l={bar_employee_created:!1,auth_user_created:!1,profile_created:!1,usuario_empresa_created:!1,permissions_created:!1,warnings:[]};this.log("info",o,`Iniciando criao do funcionrio: ${s.nome_completo}`,{email:s.email,bar_role:s.bar_role,tem_acesso_sistema:s.tem_acesso_sistema,empresa_id:a});try{this.log("debug",o,"Validando dados de entrada");const E=this.validateEmployeeData(s);if(!E.valid){const I=`Dados invlidos: ${E.errors.join(", ")}`;return this.log("error",o,I,{errors:E.errors}),{success:!1,error:I,details:l}}if(this.log("debug",o,"Verificando se email j existe"),await this.checkEmailExists(s.email)){const I=`Email ${s.email} j est em uso no sistema`;return this.log("warn",o,I),{success:!1,error:I,details:l}}let N;s.tem_acesso_sistema&&(this.log("debug",o,"Gerando credenciais de acesso"),N=this.generateCredentials(s.nome_completo,s.email),this.log("info",o,"Credenciais geradas com sucesso",{email:N.email}));let k=null;if(s.tem_acesso_sistema&&N){this.log("info",o,"Criando usurio no Supabase Auth");const I=await this.createAuthUserWithFallback(s,N.senha_temporaria);if(I.success&&I.userId){k=I.userId,l.auth_user_created=!0,this.log("info",o,"Usurio criado no Auth com sucesso",{userId:k});const J=await this.createUserProfileSafely(k,s);J.success?(l.profile_created=!0,this.log("info",o,"Perfil de usurio criado")):((c=l.warnings)==null||c.push(`Erro ao criar perfil: ${J.error}`),this.log("warn",o,"Falha ao criar perfil",{error:J.error}))}else(u=l.warnings)==null||u.push(`Falha na criao do Auth: ${I.error}`),this.log("warn",o,"Auth falhou, continuando sem credenciais",{error:I.error})}else this.log("info",o,"Usurio sem acesso ao sistema - pulando criao no Auth");let S=null;this.log("info",o,"Criando registro na tabela employees");const C=await this.createEmployeeSafely(s,a,k);C.success&&((h=C.data)!=null&&h.employeeId)?(S=C.data.employeeId,l.bar_employee_created=!0,this.log("info",o,"Funcionrio criado na tabela employees",{employeeId:S})):((f=l.warnings)==null||f.push(`Erro ao criar employee: ${C.error}`),this.log("warn",o,"Falha ao criar employee",{error:C.error})),this.log("info",o,"Criando registro na tabela bar_employees");const M=await this.createBarEmployeeSafely(s,a,S);if(!M.success){k&&await this.cleanupAuthUserSafely(k);const I=`Erro crtico ao criar funcionrio: ${M.error}`;return this.log("error",o,I),{success:!1,error:I,details:l}}l.bar_employee_created=!0;const z=(p=M.data)==null?void 0:p.employeeId;this.log("info",o,"Funcionrio criado na tabela bar_employees",{employeeId:z}),this.log("info",o,"Criando registro na tabela usuarios_empresa");const A=await this.createUsuarioEmpresaSafely(s,a,k);let $;if(A.success){l.usuario_empresa_created=!0,$=(g=A.data)==null?void 0:g.usuarioEmpresaId,this.log("info",o,"Registro criado na tabela usuarios_empresa",{usuarioEmpresaId:$}),this.log("info",o,"Configurando permisses do usurio");let I=s.permissoes_modulos;(!I||Object.keys(I).length===0)&&(s.bar_role==="caixa"||(v=s.cargo)!=null&&v.toLowerCase().includes("caixa"))&&(this.log("info",o,"Criando permisses padro para usurio de caixa"),I={gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}});const J=await this.createUserPermissionsSafely($,I);J.success?(l.permissions_created=!0,this.log("info",o,"Permisses configuradas com sucesso")):((b=l.warnings)==null||b.push(`Erro ao criar permisses: ${J.error}`),this.log("warn",o,"Falha ao criar permisses",{error:J.error}))}else(_=l.warnings)==null||_.push(`Erro ao criar usuario_empresa: ${A.error}`),this.log("warn",o,"Falha ao criar usuario_empresa",{error:A.error});const P=Date.now()-r;l.execution_time_ms=P;const F={success:!0,employee_id:z,user_id:k||void 0,usuario_empresa_id:$,credentials:s.tem_acesso_sistema&&l.auth_user_created&&N?{email:N.email,senha_temporaria:N.senha_temporaria,deve_alterar_senha:!0}:void 0,details:l};if(l.warnings&&l.warnings.length>0&&this.log("warn",o,"Funcionrio criado com avisos",{warnings:l.warnings}),this.log("info",o,`Funcionrio criado com sucesso em ${P}ms`,{employee_id:z,has_credentials:!!F.credentials,warnings_count:((w=l.warnings)==null?void 0:w.length)||0}),this.log("info",o,"Verificando dados para mapeamento",{hasEmail:!!s.email,hasBarRole:!!s.bar_role,email:s.email,barRole:s.bar_role}),s.email&&s.bar_role)try{const I=sD(s.bar_role);qn(s.email,I,"system"),this.log("info",o," Mapeamento de role adicionado com sucesso",{email:s.email,barRole:s.bar_role,middlewareRole:I})}catch(I){this.log("warn",o," Erro ao adicionar mapeamento de role",{error:I})}else this.log("warn",o," Dados insuficientes para mapeamento de role",{email:s.email,barRole:s.bar_role});return F}catch(E){const T=Date.now()-r;l.execution_time_ms=T;const N=E instanceof Error?E.message:"Erro desconhecido";return this.log("error",o,`Erro geral na criao do funcionrio: ${N}`,{executionTime:T},E),{success:!1,error:`Erro interno: ${N}`,details:l}}}generateCredentials(s,a,r){const o="generate_credentials";this.log("debug",o,"Gerando credenciais com senha genrica simples",{email:a,barRole:r});try{const l="123456",c={email:a.toLowerCase().trim(),senha_temporaria:l,deve_alterar_senha:!0};return this.log("info",o,"Credenciais geradas com senha genrica",{email:c.email,senha:l,deve_alterar:!0}),c}catch(l){return this.log("error",o,"Erro ao gerar credenciais",{},l),this.log("warn",o,"Usando fallback com senha genrica"),{email:a.toLowerCase().trim(),senha_temporaria:"123456",deve_alterar_senha:!0}}}generateSecurePasswordFallback(s=6){return"123456"}generateSecurePasswordFallbackOld(s=12){const a="ABCDEFGHJKMNPQRSTUVWXYZ",r="abcdefghijkmnpqrstuvwxyz",o="23456789",l="@#$%&*",c=a+r+o+l;let u="";u+=a[Math.floor(Math.random()*a.length)],u+=r[Math.floor(Math.random()*r.length)],u+=o[Math.floor(Math.random()*o.length)],u+=l[Math.floor(Math.random()*l.length)];for(let h=4;h<s;h++)u+=c[Math.floor(Math.random()*c.length)];return u.split("").sort(()=>Math.random()-.5).join("")}async createAuthUserWithFallback(s,a){const r="create_employee";this.log("info",r,"Iniciando criao no Supabase Auth",{email:s.email});try{this.log("debug",r,"Tentativa 1: criao com metadata completa");let o=await this.tryCreateAuthUser(s,a,!1);if(o.success)return this.log("info",r,"Usurio criado com sucesso na primeira tentativa"),(await this.checkAndConfirmEmail(o.userId)).confirmed&&this.log("info",r,"Email confirmado com sucesso"),o;if(this.log("warn",r,"Primeira tentativa falhou",{error:o.error}),this.isDatabaseRelatedError(o.error)){if(this.log("info",r,"Erro de banco detectado, tentando fallback sem metadata"),o=await this.tryCreateAuthUser(s,a,!0),o.success)return this.log("info",r,"Fallback bem-sucedido - problema era no trigger/funo do banco"),(await this.checkAndConfirmEmail(o.userId)).confirmed&&this.log("info",r,"Email confirmado no fallback"),o;this.log("error",r,"Fallback tambm falhou",{error:o.error})}else this.log("info",r,"Erro no  relacionado ao banco, no tentando fallback");return o}catch(o){const l=o instanceof Error?o.message:"Erro desconhecido";return this.log("error",r,"Erro geral na criao do Auth",{},o),{success:!1,error:l}}}async checkAndConfirmEmail(s){try{if(!Gt)return this.log("warn","create_employee","Admin no configurado - no pode confirmar email automaticamente"),{confirmed:!1,error:"Admin no configurado para confirmao de email"};const{data:a,error:r}=await ut.auth.admin.getUserById(s);if(r||!a.user)return this.log("error","create_employee","Erro ao buscar dados do usurio para confirmao de email",{userId:s},r),{confirmed:!1,error:"Erro ao buscar usurio"};if(a.user.email_confirmed_at)return this.log("debug","create_employee","Email j estava confirmado",{userId:s}),{confirmed:!0};this.log("info","create_employee","Tentando confirmar email automaticamente",{userId:s});const{error:o}=await ut.auth.admin.updateUserById(s,{email_confirm:!0});return o?(this.log("error","create_employee","Erro ao confirmar email",{userId:s},o),{confirmed:!1,error:o.message}):(this.log("info","create_employee","Email confirmado com sucesso",{userId:s}),{confirmed:!0})}catch(a){return this.log("error","create_employee","Erro geral na confirmao de email",{userId:s},a),{confirmed:!1,error:a instanceof Error?a.message:"Erro desconhecido na confirmao de email"}}}isDatabaseRelatedError(s){return s?["Database error","database","trigger","function","relation","column","constraint","foreign key","unique violation"].some(r=>s.toLowerCase().includes(r.toLowerCase())):!1}async tryCreateAuthUser(s,a,r=!1){try{this.log("debug","create_employee",`Tentando criar usurio ${r?"SEM":"COM"} metadata`);const o=r?{}:{name:s.nome_completo,role:s.tipo_usuario||"funcionario",cargo:s.cargo,temporary_password:!0,created_by:"system"};if(Gt){this.log("debug","create_employee","Usando cliente admin (service role) - PREFERRED");const l={email:s.email,password:a,email_confirm:!0};r||(l.user_metadata=o);const{data:c,error:u}=await ut.auth.admin.createUser(l);return u?(this.log("warn","create_employee",`Admin createUser falhou: ${u.message}`),{success:!1,error:`Erro admin: ${u.message}`}):c.user?(this.log("info","create_employee","Usurio criado via admin com email confirmado"),{success:!0,userId:c.user.id}):{success:!1,error:"Usurio no foi criado via admin"}}else{this.log("debug","create_employee","Admin no configurado - usando cliente normal");const l={email:s.email,password:a};r||(l.options={data:{name:s.nome_completo,role:"employee"}});const{data:c,error:u}=await V.auth.signUp(l);return u?(this.log("error","create_employee",`SignUp falhou: ${u.message}`),u.message.includes("Database error")&&!r?(this.log("warn","create_employee","Tentando novamente sem metadata devido ao erro de database"),this.tryCreateAuthUser(s,a,!0)):{success:!1,error:u.message}):c.user?(c.user.email_confirmed_at||this.log("warn","create_employee","Email no foi confirmado automaticamente - usurio pode no conseguir fazer login"),{success:!0,userId:c.user.id}):{success:!1,error:"Usurio no foi criado"}}}catch(o){return this.log("error","create_employee","Erro geral em tryCreateAuthUser",{},o),{success:!1,error:o instanceof Error?o.message:"Erro desconhecido"}}}async createUserProfileSafely(s,a){return this.executeWithErrorHandling("create_employee",async()=>{const{data:r}=await V.from("profiles").select("id").eq("id",s).single();if(r)return this.log("info","create_employee","Perfil j existe - pulando criao"),{success:!0};const o="employee",{error:l}=await V.from("profiles").insert([{id:s,name:a.nome_completo,role:o,avatar_url:`https://api.dicebear.com/8.x/initials/svg?seed=${encodeURIComponent(a.nome_completo)}`,updated_at:new Date().toISOString()}]);if(l){if(l.code==="PGRST116"||l.message.includes("does not exist"))return this.log("warn","create_employee","Tabela profiles no existe - pulando criao de perfil"),{success:!0};if(l.code==="23505"||l.message.includes("duplicate key"))return this.log("info","create_employee","Perfil j existe (constraint duplicada) - continuando"),{success:!0};throw new Error(l.message)}return{success:!0}},"Criao de perfil de usurio")}async createEmployeeSafely(s,a,r){return this.executeWithErrorHandling("create_employee",async()=>{var p,g;let o=null,l=null;try{const{data:v}=await V.from("departments").select("id").eq("is_active",!0).limit(1);o=(p=v==null?void 0:v[0])==null?void 0:p.id;const{data:b}=await V.from("positions").select("id").eq("is_active",!0).limit(1);l=(g=b==null?void 0:b[0])==null?void 0:g.id,this.log("info","create_employee","Department e Position encontrados",{departmentId:o,positionId:l})}catch(v){this.log("warn","create_employee","Erro ao buscar departamento e posio",{},v)}(!o||!l)&&this.log("warn","create_employee","Criando employee sem department/position devido a erros");const c=Gt?ut:V,u={employee_code:`EMP-${Date.now()}`,name:s.nome_completo,email:s.email,hire_date:new Date().toISOString().split("T")[0],status:"active",empresa_id:a};o&&(u.department_id=o),l&&(u.position_id=l),r&&(u.profile_id=r);const{data:h,error:f}=await c.from("employees").insert(u).select("id").single();if(f)throw new Error(f.message);return{success:!0,data:{employeeId:h==null?void 0:h.id}}},"Criao de registro employees")}async createBarEmployeeSafely(s,a,r){return this.executeWithErrorHandling("create_employee",async()=>{const o=[];o.push(`Nome: ${s.nome_completo}`),s.cpf&&o.push(`CPF: ${s.cpf}`),o.push(`Email: ${s.email}`),s.telefone&&o.push(`Telefone: ${s.telefone}`),s.observacoes&&o.push(`Observaes: ${s.observacoes}`);const l=o.join(", ");if(!r)throw new Error("Employee ID  obrigatrio para criar registro na tabela bar_employees");const c=Gt?ut:V,{data:u,error:h}=await c.from("bar_employees").insert([{employee_id:r,bar_role:s.bar_role,shift_preference:s.shift_preference||"qualquer",specialties:s.specialties||[],commission_rate:s.commission_rate||0,is_active:!0,start_date:new Date().toISOString().split("T")[0],notes:l,empresa_id:a}]).select("id").single();if(h)throw new Error(h.message);return{success:!0,data:{employeeId:u==null?void 0:u.id}}},"Criao de registro bar_employees")}async createUsuarioEmpresaSafely(s,a,r){return this.executeWithErrorHandling("create_employee",async()=>{const o=Gt?ut:V,{data:l,error:c}=await o.from("usuarios_empresa").insert([{user_id:r,empresa_id:a,nome_completo:s.nome_completo,email:s.email,telefone:s.telefone,cargo:s.cargo,tipo_usuario:s.tipo_usuario||"funcionario",status:"ativo",senha_provisoria:!0,ativo:!0,tem_acesso_sistema:s.tem_acesso_sistema,papel:s.papel||"USER",is_primeiro_usuario:!1,tentativas_login_falhadas:0,total_logins:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select("id").single();if(c)throw new Error(c.message);return{success:!0,data:{usuarioEmpresaId:l==null?void 0:l.id}}},"Criao de registro usuarios_empresa")}async createUserPermissionsSafely(s,a){return this.executeWithErrorHandling("create_employee",async()=>{this.log("info","create_employee","Dados de permisses recebidos",{usuarioEmpresaId:s,permissoesModulos:a,modulosCount:Object.keys(a||{}).length}),(!a||Object.keys(a).length===0)&&(this.log("warn","create_employee","Nenhuma permisso fornecida - criando permisses padro para caixa"),a={gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}});const r=Object.entries(a).map(([c,u])=>({usuario_empresa_id:s,modulo:c,permissoes:u,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}));this.log("info","create_employee","Inserindo permisses",{permissionsCount:r.length,permissions:r});const o=Gt?ut:V,{error:l}=await o.from("permissoes_usuario").insert(r);if(l)throw this.log("error","create_employee","Erro ao inserir permisses",{error:l}),new Error(l.message);return this.log("info","create_employee","Permisses inseridas com sucesso"),{success:!0}},"Criao de permisses de usurio")}async cleanupAuthUserSafely(s){try{Gt&&(await ut.auth.admin.deleteUser(s),this.log("info","create_employee","Usurio removido do Auth aps erro",{userId:s}))}catch(a){this.log("error","create_employee","Erro ao limpar usurio do Auth",{userId:s},a)}}async createUserProfile(s,a){try{const{error:r}=await V.from("profiles").insert({id:s,name:a.nome_completo,role:a.tipo_usuario||"employee",avatar_url:`https://api.dicebear.com/8.x/initials/svg?seed=${encodeURIComponent(a.nome_completo)}`,updated_at:new Date().toISOString()});return r?r.code==="PGRST116"||r.message.includes("does not exist")?(console.warn(" Tabela profiles no existe - pulando criao de perfil"),{success:!0}):{success:!1,error:r.message}:{success:!0}}catch(r){return console.warn(" Erro ao criar perfil (no crtico):",r),{success:!0}}}async createBarEmployee(s,a,r){try{const o=[];o.push(`Nome: ${s.nome_completo}`),s.cpf&&o.push(`CPF: ${s.cpf}`),o.push(`Email: ${s.email}`),s.telefone&&o.push(`Telefone: ${s.telefone}`),s.observacoes&&o.push(`Observaes: ${s.observacoes}`);const l=o.join(", "),c=Gt?ut:V,{data:u,error:h}=await c.from("bar_employees").insert([{employee_id:r,bar_role:s.bar_role,shift_preference:s.shift_preference||"qualquer",specialties:s.specialties||[],commission_rate:s.commission_rate||0,is_active:!0,start_date:new Date().toISOString().split("T")[0],notes:l,empresa_id:a}]).select("id").single();return h?{success:!1,error:h.message}:{success:!0,employeeId:u==null?void 0:u.id}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Erro desconhecido"}}}async createUsuarioEmpresa(s,a,r){try{const o=Gt?ut:V,{data:l,error:c}=await o.from("usuarios_empresa").insert([{user_id:r,empresa_id:a,nome_completo:s.nome_completo,email:s.email,telefone:s.telefone,cargo:s.cargo,tipo_usuario:s.tipo_usuario||"funcionario",status:"ativo",senha_provisoria:!0,ativo:!0,tem_acesso_sistema:s.tem_acesso_sistema,papel:s.papel||"USER",is_primeiro_usuario:!1,tentativas_login_falhadas:0,total_logins:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select("id").single();return c?{success:!1,error:c.message}:{success:!0,usuarioEmpresaId:l==null?void 0:l.id}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Erro desconhecido"}}}async createPermissoesUsuario(s,a){try{const r=Object.entries(a).map(([c,u])=>({usuario_empresa_id:s,modulo:c,permissoes:u,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),o=Gt?ut:V,{error:l}=await o.from("permissoes_usuario").insert(r);return l?{success:!1,error:l.message}:{success:!0}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Erro desconhecido"}}}async createUserAuth(s,a,r){try{const{data:o,error:l}=await V.auth.signUp({email:s,password:a,options:{data:{name:r.nome_completo,role:"funcionario"}}});return l?{success:!1,error:l.message}:o.user?{success:!0,userId:o.user.id}:{success:!1,error:"Usurio no foi criado"}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Erro desconhecido"}}}async createUserProfile(s,a){const r=new Date().toISOString();try{const{error:o}=await V.from("profiles").insert([{id:s,name:a.name,role:"employee",avatar_url:`https://api.dicebear.com/8.x/initials/svg?seed=${encodeURIComponent(a.name)}`,updated_at:r}]);return o?{success:!1,error:o.message}:{success:!0}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Erro desconhecido"}}}async createBarEmployee(s,a,r,o,l,c,u){try{const{data:h,error:f}=await V.from("bar_employees").insert([{employee_id:s,bar_role:a,shift_preference:r,specialties:o,commission_rate:l,is_active:!0,start_date:new Date().toISOString().split("T")[0],notes:c,empresa_id:u}]).select("id").single();return f?{success:!1,error:f.message}:{success:!0,employeeId:h==null?void 0:h.id}}catch(h){return{success:!1,error:h instanceof Error?h.message:"Erro desconhecido"}}}async createUsuarioEmpresaSafely(s,a,r){return this.executeWithErrorHandling("create_employee",async()=>{const o=Gt?ut:V,{data:l,error:c}=await o.from("usuarios_empresa").insert([{user_id:r,empresa_id:a,nome_completo:s.nome_completo,email:s.email,telefone:s.telefone,cargo:s.cargo,tipo_usuario:s.tipo_usuario||"funcionario",status:"ativo",senha_provisoria:!0,ativo:!0,tem_acesso_sistema:s.tem_acesso_sistema,papel:s.papel||"USER",is_primeiro_usuario:!1,tentativas_login_falhadas:0,total_logins:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select("id").single();if(c)throw new Error(c.message);return{success:!0,data:{usuarioEmpresaId:l==null?void 0:l.id}}},"Criao de registro usuarios_empresa")}async createUserPermissions(s,a){try{const r=Object.entries(a).map(([c,u])=>({usuario_empresa_id:s,modulo:c,permissoes:u,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),o=Gt?ut:V,{error:l}=await o.from("permissoes_usuario").insert(r);return l?{success:!1,error:l.message}:{success:!0}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Erro desconhecido"}}}async checkEmailExists(s){const a="check_email";try{this.log("debug",a,"Verificando se email j existe",{email:s});const{data:r,error:o}=await V.from("usuarios_empresa").select("id").eq("email",s.toLowerCase().trim()).limit(1);if(o)return this.log("error",a,"Erro ao consultar banco de dados",{email:s},o),!1;const l=r&&r.length>0;return this.log("debug",a,`Email ${l?"j existe":"no existe"} no sistema`,{email:s,exists:l}),l}catch(r){return this.log("error",a,"Erro geral ao verificar email",{email:s},r),!1}}async cleanupAuthUser(s){try{Gt&&(await ut.auth.admin.deleteUser(s),console.log(" Usurio removido do Auth aps erro:",s))}catch(a){console.error(" Erro ao limpar usurio do Auth:",a)}}static async generateDefaultPermissions(s){try{const{permissionPresetManager:a}=await Sa(async()=>{const{permissionPresetManager:c}=await Promise.resolve().then(()=>oz);return{permissionPresetManager:c}},void 0);if(!["atendente","garcom","cozinheiro","barman","gerente"].includes(s))return console.warn(`Funo invlida: ${s}. Usando permisses bsicas.`),{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}};const o=a.getDefaultPermissions(s),l={};for(const[c,u]of Object.entries(o))l[c]={visualizar:u.visualizar,criar:u.criar,editar:u.editar,excluir:u.excluir,administrar:u.administrar};return l}catch(a){return console.error("Erro ao gerar permisses padro:",a),{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}}}}async updateEmployeePassword(s,a,r=!1){const o="update_password";return this.log("info",o,"Iniciando atualizao de senha",{userId:s,isTemporary:r}),this.executeWithErrorHandling(o,async()=>{if(!Gt)throw this.createServiceError("permission_error","Configurao admin no disponvel para atualizao de senha");if(!a||a.length<6)throw this.createServiceError("validation_error","Nova senha deve ter pelo menos 6 caracteres");this.log("debug",o,"Atualizando senha no Supabase Auth");const{error:l}=await ut.auth.admin.updateUserById(s,{password:a});if(l)throw this.createServiceError("auth_error",l.message);this.log("debug",o,"Atualizando flag de senha provisria");const{error:c}=await ut.from("usuarios_empresa").update({senha_provisoria:r,updated_at:new Date().toISOString()}).eq("user_id",s);return c&&this.log("warn",o,"Erro ao atualizar flag senha_provisoria",{},c),this.log("info",o,"Senha atualizada com sucesso"),{success:!0}},"Atualizao de senha de funcionrio")}async deactivateEmployee(s){const a="deactivate_employee";return this.log("info",a,"Iniciando desativao de funcionrio",{employeeId:s}),this.executeWithErrorHandling(a,async()=>{if(!(s!=null&&s.trim()))throw this.createServiceError("validation_error","ID do funcionrio  obrigatrio");this.log("debug",a,"Desativando na tabela bar_employees");const{error:r}=await ut.from("bar_employees").update({is_active:!1,end_date:new Date().toISOString().split("T")[0],updated_at:new Date().toISOString()}).eq("id",s);if(r)throw this.createServiceError("database_error",r.message);this.log("debug",a,"Buscando user_id do funcionrio");const{data:o,error:l}=await ut.from("bar_employees").select("employee_id").eq("id",s).single();if(l||!(o!=null&&o.employee_id))return this.log("warn",a,"No foi possvel encontrar user_id para desativar na usuarios_empresa"),{success:!0};this.log("debug",a,"Desativando na tabela usuarios_empresa");const{error:c}=await ut.from("usuarios_empresa").update({ativo:!1,status:"inativo",updated_at:new Date().toISOString()}).eq("user_id",o.employee_id);return c&&this.log("warn",a,"Erro ao desativar na usuarios_empresa",{},c),this.log("info",a,"Funcionrio desativado com sucesso"),{success:!0}},"Desativao de funcionrio")}async reactivateEmployee(s){const a="reactivate_employee";return this.log("info",a,"Iniciando reativao de funcionrio",{employeeId:s}),this.executeWithErrorHandling(a,async()=>{if(!(s!=null&&s.trim()))throw this.createServiceError("validation_error","ID do funcionrio  obrigatrio");this.log("debug",a,"Reativando na tabela bar_employees");const{error:r}=await ut.from("bar_employees").update({is_active:!0,end_date:null,updated_at:new Date().toISOString()}).eq("id",s);if(r)throw this.createServiceError("database_error",r.message);this.log("debug",a,"Buscando user_id do funcionrio");const{data:o,error:l}=await ut.from("bar_employees").select("employee_id").eq("id",s).single();if(l||!(o!=null&&o.employee_id))return this.log("warn",a,"No foi possvel encontrar user_id para reativar na usuarios_empresa"),{success:!0};this.log("debug",a,"Reativando na tabela usuarios_empresa");const{error:c}=await ut.from("usuarios_empresa").update({ativo:!0,status:"ativo",updated_at:new Date().toISOString()}).eq("user_id",o.employee_id);return c&&this.log("warn",a,"Erro ao reativar na usuarios_empresa",{},c),this.log("info",a,"Funcionrio reativado com sucesso"),{success:!0}},"Reativao de funcionrio")}async updateEmployeePermissions(s,a){const r="update_permissions";return this.log("info",r,"Iniciando atualizao de permisses",{usuarioEmpresaId:s,modulesCount:Object.keys(a).length}),this.executeWithErrorHandling(r,async()=>{if(!(s!=null&&s.trim()))throw this.createServiceError("validation_error","ID do usurio empresa  obrigatrio");if(!a||Object.keys(a).length===0)throw this.createServiceError("validation_error","Novas permisses so obrigatrias");this.log("debug",r,"Removendo permisses existentes");const{error:o}=await ut.from("permissoes_usuario").delete().eq("usuario_empresa_id",s);if(o)throw this.createServiceError("database_error",o.message);this.log("debug",r,"Inserindo novas permisses");const l=Object.entries(a).map(([u,h])=>({usuario_empresa_id:s,modulo:u,permissoes:h,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),{error:c}=await ut.from("permissoes_usuario").insert(l);if(c)throw this.createServiceError("database_error",c.message);return this.log("info",r,"Permisses atualizadas com sucesso"),{success:!0}},"Atualizao de permisses de funcionrio")}async resetEmployeePassword(s,a){const r=p2.UPDATE_EMPLOYEE;return this.executeWithErrorHandling(r,async()=>{const{data:o,error:l}=await V.from("bar_employees").select(`
            employee_id,
            employees!inner(
              profile_id,
              name,
              email
            )
          `).eq("id",s).eq("empresa_id",a).single();if(l||!o)throw new Error("Funcionrio no encontrado");const c=o.employees.email;o.employees.name;const u=this.generateCredentials(c);try{const{error:h}=await V.auth.admin.updateUserById(o.employees.profile_id,{password:u.senha_temporaria});if(h)throw new Error(`Erro ao resetar senha: ${h.message}`);return this.log("info",r,"Senha resetada com sucesso",{employeeId:s,email:c}),{success:!0,credentials:{email:c,senha_temporaria:u.senha_temporaria}}}catch(h){throw new Error(`Falha ao resetar senha: ${h.message}`)}},"Reset de senha do funcionrio")}async listEmployees(s,a=!1){const r="list_employees";return this.log("info",r,"Iniciando listagem de funcionrios",{empresaId:s,includeInactive:a}),this.executeWithErrorHandling(r,async()=>{if(!(s!=null&&s.trim()))throw this.createServiceError("validation_error","ID da empresa  obrigatrio");let o=V.from("bar_employees").select(`
            id,
            employee_id,
            bar_role,
            shift_preference,
            specialties,
            commission_rate,
            is_active,
            start_date,
            end_date,
            notes,
            created_at,
            updated_at,
            usuarios_empresa:employee_id (
              nome_completo,
              email,
              telefone,
              cargo,
              status,
              senha_provisoria
            )
          `).eq("empresa_id",s);a||(o=o.eq("is_active",!0)),this.log("debug",r,"Executando consulta no banco de dados");const{data:l,error:c}=await o.order("created_at",{ascending:!1});if(c)throw this.createServiceError("database_error",c.message);const u=l||[];return this.log("info",r,`Listagem concluda: ${u.length} funcionrios encontrados`),{success:!0,employees:u,total:u.length}},"Listagem de funcionrios")}};dt(Wn,"instance");let $a=Wn;$a.getInstance();const q8=()=>{const[t,s]=y.useState(!1),[a,r]=y.useState(null),o=y.useCallback(async g=>{try{s(!0),r(null);const v=await Ac();if(!v.success)throw new Error(`Falha na autenticao: ${v.error}`);const b=await bt();if(!b)throw new Error("No foi possvel obter o ID da empresa do usurio atual. Verifique se voc est logado corretamente.");const _=b,E=await $a.getInstance().createCompleteEmployee(g,_);return E.success||r(E.error||"Erro ao criar funcionrio"),E}catch(v){const b=v instanceof Error?v.message:"Erro ao criar funcionrio";return r(b),{success:!1,error:b}}finally{s(!1)}},[]),l=y.useCallback(async g=>{const v={gerente:"Gerente de Bar",atendente:"Atendente de Caixa",garcom:"Garom",cozinheiro:"Cozinheiro",barman:"Barman"},b={gerente:"administrador",atendente:"funcionario",garcom:"funcionario",cozinheiro:"funcionario",barman:"funcionario"},_={gerente:"MANAGER",atendente:"USER",garcom:"USER",cozinheiro:"USER",barman:"USER"},w={...g,cargo:v[g.bar_role]||"Funcionrio",tipo_usuario:b[g.bar_role]||"funcionario",papel:_[g.bar_role]||"USER",permissoes_modulos:await $a.generateDefaultPermissions(g.bar_role)};return await o(w)},[o]),c=y.useCallback(async(g,v,b=!1)=>{try{s(!0),r(null);const w=await $a.getInstance().updateEmployeePassword(g,v,b);return w.success||r(w.error||"Erro ao atualizar senha"),w}catch(_){const w=_ instanceof Error?_.message:"Erro ao atualizar senha";return r(w),{success:!1,error:w}}finally{s(!1)}},[]),u=y.useCallback(async g=>{try{s(!0),r(null);const b=await $a.getInstance().deactivateEmployee(g);return b.success||r(b.error||"Erro ao desativar funcionrio"),b}catch(v){const b=v instanceof Error?v.message:"Erro ao desativar funcionrio";return r(b),{success:!1,error:b}}finally{s(!1)}},[]),h=y.useCallback(async g=>{try{s(!0),r(null);const b=await $a.getInstance().reactivateEmployee(g);return b.success||r(b.error||"Erro ao reativar funcionrio"),b}catch(v){const b=v instanceof Error?v.message:"Erro ao reativar funcionrio";return r(b),{success:!1,error:b}}finally{s(!1)}},[]),f=y.useCallback(async(g,v)=>{try{s(!0),r(null);const _=await $a.getInstance().updateEmployeePermissions(g,v);return _.success||r(_.error||"Erro ao atualizar permisses"),_}catch(b){const _=b instanceof Error?b.message:"Erro ao atualizar permisses";return r(_),{success:!1,error:_}}finally{s(!1)}},[]),p=y.useCallback(async(g=!1)=>{try{s(!0),r(null);let v="00000000-0000-0000-0000-000000000001";const b=await Ac();if(b.success&&!b.useAdmin){const E=await bt();E&&(v=E)}const w=await $a.getInstance().listEmployees(v,g);return w.success||r(w.error||"Erro ao listar funcionrios"),w}catch(v){const b=v instanceof Error?v.message:"Erro ao listar funcionrios";return r(b),{success:!1,error:b}}finally{s(!1)}},[]);return{loading:t,error:a,createEmployee:o,createEmployeeWithDefaultPermissions:l,updatePassword:c,deactivateEmployee:u,reactivateEmployee:h,updatePermissions:f,listEmployees:p,setError:r}},F8=[{feature:"tables",level:"full"},{feature:"orders",level:"full"},{feature:"menu",level:"read"},{feature:"customers",level:"write"},{feature:"payments",level:"read"}],co={waiter:{role:"waiter",description:"Garom - Atendimento e pedidos",permissions:[{id:"bar-view",module:"bar",action:"view"},{id:"bar-create-orders",module:"bar",action:"create",resource:"orders"},{id:"bar-edit-own-orders",module:"bar",action:"edit",resource:"own_orders"},{id:"customers-view",module:"customers",action:"view"},{id:"customers-create",module:"customers",action:"create"},{id:"app-garcom-access",module:"app-garcom",action:"access"},{id:"app-garcom-tables",module:"app-garcom",action:"manage",resource:"tables"},{id:"app-garcom-orders",module:"app-garcom",action:"manage",resource:"orders"}]},cook:{role:"cook",description:"Cozinheiro - Preparo e cozinha",permissions:[{id:"kitchen-view",module:"kitchen",action:"view"},{id:"kitchen-edit-status",module:"kitchen",action:"edit",resource:"order_status"},{id:"inventory-view",module:"inventory",action:"view"},{id:"bar-view-orders",module:"bar",action:"view",resource:"orders"}]},cashier:{role:"cashier",description:"Caixa - Pagamentos e fechamento",permissions:[{id:"cashier-view",module:"cashier",action:"view"},{id:"cashier-manage",module:"cashier",action:"manage"},{id:"bar-view-orders",module:"bar",action:"view",resource:"orders"},{id:"reports-view-daily",module:"reports",action:"view",resource:"daily_sales"}]},supervisor:{role:"supervisor",description:"Supervisor - Superviso operacional",permissions:[{id:"bar-manage",module:"bar",action:"manage"},{id:"kitchen-manage",module:"kitchen",action:"manage"},{id:"cashier-view",module:"cashier",action:"view"},{id:"reports-view",module:"reports",action:"view"},{id:"inventory-view",module:"inventory",action:"view"},{id:"customers-manage",module:"customers",action:"manage"}]},manager:{role:"manager",description:"Gerente - Gesto completa",permissions:[{id:"bar-manage",module:"bar",action:"manage"},{id:"kitchen-manage",module:"kitchen",action:"manage"},{id:"cashier-manage",module:"cashier",action:"manage"},{id:"reports-manage",module:"reports",action:"manage"},{id:"inventory-manage",module:"inventory",action:"manage"},{id:"customers-manage",module:"customers",action:"manage"},{id:"settings-view",module:"settings",action:"view"}]},admin:{role:"admin",description:"Administrador - Acesso total",permissions:[{id:"bar-manage",module:"bar",action:"manage"},{id:"kitchen-manage",module:"kitchen",action:"manage"},{id:"cashier-manage",module:"cashier",action:"manage"},{id:"reports-manage",module:"reports",action:"manage"},{id:"inventory-manage",module:"inventory",action:"manage"},{id:"customers-manage",module:"customers",action:"manage"},{id:"settings-manage",module:"settings",action:"manage"}]}},H8=t=>({waiter:"Garom",cook:"Cozinheiro",cashier:"Caixa",supervisor:"Supervisor",manager:"Gerente",admin:"Administrador"})[t],G8=t=>({bar:"Bar/Atendimento",kitchen:"Cozinha",cashier:"Caixa",reports:"Relatrios",inventory:"Estoque",customers:"Clientes",settings:"Configuraes","app-garcom":"App Garom"})[t]||t,Z8=t=>({view:"Visualizar",create:"Criar",edit:"Editar",delete:"Excluir",manage:"Gerenciar",access:"Acessar"})[t]||t,W8=t=>{const s=t.replace(/\D/g,"");if(s.length!==11||/^(\d)\1{10}$/.test(s))return!1;let a=0;for(let o=0;o<9;o++)a+=parseInt(s.charAt(o))*(10-o);let r=a*10%11;if((r===10||r===11)&&(r=0),r!==parseInt(s.charAt(9)))return!1;a=0;for(let o=0;o<10;o++)a+=parseInt(s.charAt(o))*(11-o);return r=a*10%11,(r===10||r===11)&&(r=0),r===parseInt(s.charAt(10))},Y8=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),K8=t=>{const s=t.replace(/\D/g,"");return s.length===10||s.length===11},X8=t=>t.replace(/\D/g,"").replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"),Q8=t=>{const s=t.replace(/\D/g,"");return s.length===11?s.replace(/(\d{2})(\d{5})(\d{4})/,"($1) $2-$3"):s.length===10?s.replace(/(\d{2})(\d{4})(\d{4})/,"($1) $2-$3"):t},Oj=t=>{var a,r,o;const s=[];return(a=t.name)!=null&&a.trim()?t.name.trim().length<2&&s.push({field:"name",message:"Nome deve ter pelo menos 2 caracteres",type:"format"}):s.push({field:"name",message:"Nome  obrigatrio",type:"required"}),(r=t.cpf)!=null&&r.trim()?W8(t.cpf)||s.push({field:"cpf",message:"CPF invlido",type:"format"}):s.push({field:"cpf",message:"CPF  obrigatrio",type:"required"}),(o=t.email)!=null&&o.trim()?Y8(t.email)||s.push({field:"email",message:"Email invlido",type:"format"}):s.push({field:"email",message:"Email  obrigatrio",type:"required"}),t.phone&&!K8(t.phone)&&s.push({field:"phone",message:"Telefone invlido",type:"format"}),t.role||s.push({field:"role",message:"Funo  obrigatria",type:"required"}),t.hire_date?t.hire_date>new Date&&s.push({field:"hire_date",message:"Data de contratao no pode ser futura",type:"format"}):s.push({field:"hire_date",message:"Data de contratao  obrigatria",type:"required"}),s},J8=()=>{const[t,s]=y.useState({fields:[]}),a=y.useCallback(h=>{const f=Oj(h);return s({fields:f,general:f.length>0?"Por favor, corrija os erros antes de continuar":void 0}),f.length===0},[]),r=y.useCallback((h,f,p)=>{const g={...p,[h]:f},b=Oj(g).find(_=>_.field===h);return s(_=>({..._,fields:[..._.fields.filter(w=>w.field!==h),...b?[b]:[]]})),b||null},[]),o=y.useCallback(()=>{s({fields:[]})},[]),l=y.useCallback(h=>{s(f=>({...f,fields:f.fields.filter(p=>p.field!==h)}))},[]),c=y.useCallback(h=>t.fields.find(f=>f.field===h),[t.fields]),u=t.fields.length>0||!!t.general;return{errors:t,validateForm:a,validateField:r,clearErrors:o,clearFieldError:l,getFieldError:c,hasErrors:u}},ez=()=>{const[t,s]=y.useState([]);return y.useEffect(()=>{const l=localStorage.getItem("offline_employees");if(l)try{const c=JSON.parse(l);s(c)}catch(c){console.error("Erro ao carregar dados offline:",c)}},[]),{offlineEmployees:t,saveOffline:l=>{const c={...l,id:`offline_${Date.now()}`,_offline:!0,_timestamp:Date.now()},u=[...t,c];return s(u),localStorage.setItem("offline_employees",JSON.stringify(u)),c},syncOfflineData:async l=>{const c=[...t];for(const u of c)try{const{_offline:h,_timestamp:f,...p}=u;await l(p);const g=t.filter(v=>v.id!==u.id);s(g),localStorage.setItem("offline_employees",JSON.stringify(g)),console.log(` Funcionrio ${u.name} sincronizado`)}catch(h){console.error(` Erro ao sincronizar ${u.name}:`,h)}},clearOfflineData:()=>{s([]),localStorage.removeItem("offline_employees")},hasOfflineData:t.length>0}},_g=()=>{const[t,s]=y.useState(navigator.onLine),[a,r]=y.useState(!1);return y.useEffect(()=>{const o=()=>{s(!0),a&&console.log(" Conexo restaurada")},l=()=>{s(!1),r(!0),console.log(" Conexo perdida")};return window.addEventListener("online",o),window.addEventListener("offline",l),()=>{window.removeEventListener("online",o),window.removeEventListener("offline",l)}},[a]),{isOnline:t,wasOffline:a}},tz=()=>{const[t,s]=y.useState(0),[a,r]=y.useState(!1),o=y.useCallback(async(c,u={maxRetries:2,retryDelay:3e3,timeoutDuration:45e3})=>{const{maxRetries:h,retryDelay:f,timeoutDuration:p}=u;for(let g=0;g<=h;g++)try{s(g),g>0&&(r(!0),await new Promise(_=>setTimeout(_,f)));const v=new Promise((_,w)=>setTimeout(()=>w(new Error(`Timeout na tentativa ${g+1}`)),p)),b=await Promise.race([c(),v]);return s(0),r(!1),b}catch(v){if(console.log(`Tentativa ${g+1} falhou:`,v),g===h||v instanceof Error&&!v.message.includes("Timeout"))throw s(0),r(!1),v}throw new Error("Todas as tentativas falharam")},[]),l=y.useCallback(()=>{s(0),r(!1)},[]);return{executeWithRetry:o,retryCount:t,isRetrying:a,reset:l}},Ng=()=>{const[t,s]=y.useState(!1),[a,r]=y.useState(null),o=y.useCallback(async f=>{try{r(null),console.log(" Buscando permisses para employeeId:",f);const{data:p,error:g}=await V.from("employees").select("id, name, profile_id, tem_acesso_sistema").eq("id",f).single();if(g||!p)return console.error(" Erro ao buscar employee:",g),[];if(!p.profile_id||!p.tem_acesso_sistema)return console.log(" Employee sem credenciais, sem permisses especficas"),[];const{data:v,error:b}=await V.from("usuarios_empresa").select("id, user_id, nome_completo, tem_acesso_sistema, status").eq("user_id",p.profile_id).single();if(b||!v)return console.error(" Erro ao buscar usuario_empresa:",b),[];console.log(" Usurio encontrado:",v.nome_completo);const{data:_,error:w}=await V.from("permissoes_usuario").select("id, modulo, permissoes").eq("usuario_empresa_id",v.id);if(w)throw console.error(" Erro ao buscar permisses:",w),new Error(`Erro ao buscar permisses: ${w.message}`);return console.log(` ${(_==null?void 0:_.length)||0} permisses especficas encontradas`),(_||[]).map(E=>({...E,usuario_empresa_id:v.id}))}catch(p){const g=p instanceof Error?p.message:"Erro ao buscar permisses";return r(g),console.error("Erro ao buscar permisses:",p),[]}},[]),l=y.useCallback(async(f,p)=>{try{s(!0),r(null),console.log(" Salvando permisses para funcionrio:",f),console.log(" Permisses:",p),console.log(" Buscando employee e suas credenciais...");const{data:g,error:v}=await V.from("employees").select("id, name, email, profile_id, tem_acesso_sistema").eq("id",f).single();if(v||!g)throw console.error(" Erro ao buscar employee:",v),new Error("Funcionrio no encontrado.");if(console.log(" Employee encontrado:",g),!g.profile_id||!g.tem_acesso_sistema)throw console.error(" Employee sem credenciais:",{profile_id:g.profile_id,tem_acesso_sistema:g.tem_acesso_sistema}),new Error("Funcionrio no tem credenciais de sistema. Crie credenciais primeiro.");const{data:b,error:_}=await V.from("usuarios_empresa").select("id, user_id, nome_completo, tem_acesso_sistema, status").eq("user_id",g.profile_id).single();if(_||!b)throw console.error(" Erro ao buscar usuario_empresa:",_),new Error("Vnculo do usurio no encontrado.");if(console.log(" Usurio encontrado:",b),!b.user_id||!b.tem_acesso_sistema)throw console.error(" Usurio sem credenciais vlidas:",{user_id:b.user_id,tem_acesso_sistema:b.tem_acesso_sistema}),new Error("Usurio no tem credenciais de sistema. Crie credenciais primeiro.");if(b.status!=="ativo")throw console.error(" Usurio no est ativo:",b.status),new Error("Usurio no est ativo no sistema.");console.log(" Usurio vlido para salvar permisses"),console.log(" Removendo permisses existentes...");const{error:w}=await V.from("permissoes_usuario").delete().eq("usuario_empresa_id",b.id);if(w)throw console.error(" Erro ao deletar permisses existentes:",w),new Error(`Erro ao limpar permisses existentes: ${w.message}`);if(console.log(" Permisses existentes removidas"),p.length>0){console.log(` Inserindo ${p.length} novas permisses...`);const E=p.map(N=>({usuario_empresa_id:b.id,modulo:N.modulo,permissoes:N.permissoes}));console.log(" Dados para inserir:",E);const{error:T}=await V.from("permissoes_usuario").insert(E);if(T)throw console.error(" Erro ao inserir permisses:",T),new Error(`Erro ao salvar permisses: ${T.message}`);console.log(` ${p.length} permisses salvas com sucesso`)}else console.log(" Permisses removidas (usurio usar padres do role)");return{success:!0}}catch(g){const v=g instanceof Error?g.message:"Erro ao salvar permisses";return r(v),console.error("Erro ao salvar permisses:",g),{success:!1,error:v}}finally{s(!1)}},[]),c=y.useCallback(async f=>await l(f,[]),[l]),u=y.useCallback(async f=>(await o(f)).length>0,[o]),h=y.useCallback(async(f,p)=>{const v={operador_caixa:[{usuario_empresa_id:"",modulo:"gestao_caixa",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}}],atendente_bar:[{usuario_empresa_id:"",modulo:"atendimento_bar",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},{usuario_empresa_id:"",modulo:"monitor_bar",permissoes:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}}],cozinheiro:[{usuario_empresa_id:"",modulo:"monitor_cozinha",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}}],gerente:[{usuario_empresa_id:"",modulo:"dashboard",permissoes:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}},{usuario_empresa_id:"",modulo:"gestao_caixa",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}},{usuario_empresa_id:"",modulo:"atendimento_bar",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}},{usuario_empresa_id:"",modulo:"monitor_bar",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},{usuario_empresa_id:"",modulo:"monitor_cozinha",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},{usuario_empresa_id:"",modulo:"clientes",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}},{usuario_empresa_id:"",modulo:"funcionarios",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},{usuario_empresa_id:"",modulo:"relatorios",permissoes:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}}]}[p];return await l(f,v)},[l]);return{loading:t,error:a,getEmployeePermissions:o,saveEmployeePermissions:l,clearEmployeePermissions:c,hasCustomPermissions:u,applyPermissionPreset:h,clearError:()=>r(null)}},Yn=class Yn{constructor(){dt(this,"storageKey","local_employee_credentials")}static getInstance(){return Yn.instance||(Yn.instance=new Yn),Yn.instance}async saveEmployeeCredentials(s,a){try{const r=this.getStoredCredentials();if(r.some(h=>h.email===a.email))return{success:!1,error:`Email ${a.email} j est em uso`};if(r.some(h=>h.username===a.username))return{success:!1,error:`Nome de usurio ${a.username} j est em uso`};const c={employeeId:s.id||`temp_${Date.now()}`,email:a.email,username:a.username,password:a.password,temporaryPassword:a.temporaryPassword,createdAt:new Date().toISOString()},u=[...r,c];return localStorage.setItem(this.storageKey,JSON.stringify(u)),console.log(" Credenciais salvas localmente:",{email:a.email,username:a.username}),{success:!0,userId:c.employeeId,needsPasswordChange:a.temporaryPassword}}catch(r){return console.error(" Erro ao salvar credenciais localmente:",r),{success:!1,error:`Erro interno: ${r instanceof Error?r.message:"Erro desconhecido"}`}}}async checkEmailExists(s){return this.getStoredCredentials().some(r=>r.email===s)}async checkUsernameExists(s){return this.getStoredCredentials().some(r=>r.username===s)}async validateLogin(s,a){return this.getStoredCredentials().find(l=>(l.email===s||l.username===s)&&l.password===a)||null}listAllCredentials(){return this.getStoredCredentials()}async removeEmployeeCredentials(s){try{const r=this.getStoredCredentials().filter(o=>o.employeeId!==s);return localStorage.setItem(this.storageKey,JSON.stringify(r)),console.log(" Credenciais removidas localmente:",s),!0}catch(a){return console.error(" Erro ao remover credenciais:",a),!1}}async updatePassword(s,a,r=!1){try{const o=this.getStoredCredentials(),l=o.findIndex(c=>c.employeeId===s);return l===-1?!1:(o[l].password=a,o[l].temporaryPassword=r,localStorage.setItem(this.storageKey,JSON.stringify(o)),console.log(" Senha atualizada localmente:",s),!0)}catch(o){return console.error(" Erro ao atualizar senha:",o),!1}}clearAllCredentials(){localStorage.removeItem(this.storageKey),console.log(" Todas as credenciais locais foram removidas")}exportCredentials(){const s=this.getStoredCredentials();return JSON.stringify(s,null,2)}importCredentials(s){try{const a=JSON.parse(s);if(!Array.isArray(a))throw new Error("Formato invlido");return localStorage.setItem(this.storageKey,JSON.stringify(a)),console.log(" Credenciais importadas com sucesso"),!0}catch(a){return console.error(" Erro ao importar credenciais:",a),!1}}getStoredCredentials(){try{const s=localStorage.getItem(this.storageKey);return s?JSON.parse(s):[]}catch(s){return console.error(" Erro ao ler credenciais locais:",s),[]}}generateReport(){const s=this.getStoredCredentials();return`
 RELATRIO DE CREDENCIAIS LOCAIS
================================

Total de funcionrios: ${s.length}

Funcionrios cadastrados:
${s.map((r,o)=>`
${o+1}. ${r.username} (${r.email})
   - ID: ${r.employeeId}
   - Senha temporria: ${r.temporaryPassword?"Sim":"No"}
   - Criado em: ${new Date(r.createdAt).toLocaleString("pt-BR")}
`).join("")}

 IMPORTANTE: Estas credenciais so apenas para desenvolvimento local.
Em produo, use o Supabase Auth configurando a VITE_SUPABASE_SERVICE_ROLE_KEY.
    `.trim()}};dt(Yn,"instance");let pc=Yn;const Kn=class Kn{static getInstance(){return Kn.instance||(Kn.instance=new Kn),Kn.instance}async createEmployeeUser(s,a){try{if(console.log(" Criando usurio para funcionrio:",{email:a.email,username:a.username}),!Gt){console.warn(" Service Role Key no configurada. Usando armazenamento local para desenvolvimento.");const h=await pc.getInstance().saveEmployeeCredentials(s,a);return h.success&&console.log(" Credenciais salvas localmente com sucesso"),h}const{data:r,error:o}=await ut.auth.admin.createUser({email:a.email,password:a.password,email_confirm:!0,user_metadata:{username:a.username,employee_id:s.id,role:s.role,temporary_password:a.temporaryPassword,created_by:"system",created_at:new Date().toISOString()}});if(o)return console.error(" Erro ao criar usurio no Auth:",o),{success:!1,error:`Erro ao criar usurio: ${o.message}`};if(!r.user)return{success:!1,error:"Usurio no foi criado corretamente"};console.log(" Usurio criado no Auth:",r.user.id);const l=await this.createUserProfile(r.user.id,s,a);return l.success?((await this.createUserPermissions(r.user.id,s)).success||console.warn(" Erro ao criar permisses, mas usurio foi criado"),{success:!0,userId:r.user.id,needsPasswordChange:a.temporaryPassword}):(Gt&&await this.deleteAuthUser(r.user.id),l)}catch(r){return console.error(" Erro geral ao criar usurio:",r),{success:!1,error:`Erro interno: ${r instanceof Error?r.message:"Erro desconhecido"}`}}}async createUserProfile(s,a,r){try{const{error:o}=await V.from("profiles").insert({id:s,email:r.email,username:r.username,full_name:a.name,employee_id:a.id,role:a.role,status:a.status,temporary_password:r.temporaryPassword,password_expires_at:r.temporaryPassword?new Date(Date.now()+6048e5).toISOString():null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});return o?(console.error(" Erro ao criar perfil:",o),{success:!1,error:`Erro ao criar perfil: ${o.message}`}):(console.log(" Perfil criado com sucesso"),{success:!0})}catch(o){return console.error(" Erro ao criar perfil:",o),{success:!1,error:`Erro interno ao criar perfil: ${o instanceof Error?o.message:"Erro desconhecido"}`}}}async createUserPermissions(s,a){try{if(!a.permissions||a.permissions.length===0)return console.log(" Nenhuma permisso para criar"),{success:!0};const r=a.permissions.map(l=>({user_id:s,employee_id:a.id,module:l.module,action:l.action,resource:l.resource,granted_at:new Date().toISOString(),granted_by:"system"})),{error:o}=await V.from("user_permissions").insert(r);return o?(console.error(" Erro ao criar permisses:",o),{success:!1,error:`Erro ao criar permisses: ${o.message}`}):(console.log(" Permisses criadas com sucesso"),{success:!0})}catch(r){return console.error(" Erro ao criar permisses:",r),{success:!1,error:`Erro interno ao criar permisses: ${r instanceof Error?r.message:"Erro desconhecido"}`}}}async deleteAuthUser(s){try{Gt&&(await ut.auth.admin.deleteUser(s),console.log(" Usurio removido do Auth aps erro"))}catch(a){console.error(" Erro ao remover usurio do Auth:",a)}}async updateEmployeeCredentials(s,a){try{const{data:r,error:o}=await V.from("profiles").select("id, email").eq("employee_id",s).single();if(o||!r)return{success:!1,error:"Usurio no encontrado"};if(a.email||a.password){const u={};a.email&&(u.email=a.email),a.password&&(u.password=a.password);const{error:h}=await ut.auth.admin.updateUserById(r.id,u);if(h)return{success:!1,error:`Erro ao atualizar credenciais: ${h.message}`}}const l={updated_at:new Date().toISOString()};a.email&&(l.email=a.email),a.username&&(l.username=a.username),a.temporaryPassword!==void 0&&(l.temporary_password=a.temporaryPassword,l.password_expires_at=a.temporaryPassword?new Date(Date.now()+7*24*60*60*1e3).toISOString():null);const{error:c}=await V.from("profiles").update(l).eq("id",r.id);return c?{success:!1,error:`Erro ao atualizar perfil: ${c.message}`}:{success:!0}}catch(r){return console.error(" Erro ao atualizar credenciais:",r),{success:!1,error:`Erro interno: ${r instanceof Error?r.message:"Erro desconhecido"}`}}}async checkEmailExists(s){try{if(!Gt)return await pc.getInstance().checkEmailExists(s);const{data:a,error:r}=await V.from("profiles").select("id").eq("email",s).limit(1);return r?(console.error("Erro ao verificar email:",r),!1):a&&a.length>0}catch(a){return console.error("Erro ao verificar email:",a),!1}}async checkUsernameExists(s){try{if(!Gt)return await pc.getInstance().checkUsernameExists(s);const{data:a,error:r}=await V.from("profiles").select("id").eq("username",s).limit(1);return r?(console.error("Erro ao verificar username:",r),!1):a&&a.length>0}catch(a){return console.error("Erro ao verificar username:",a),!1}}async forcePasswordChange(s){try{const{error:a}=await V.from("profiles").update({temporary_password:!0,password_expires_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("employee_id",s);return a?{success:!1,error:`Erro ao forar alterao de senha: ${a.message}`}:{success:!0}}catch(a){return{success:!1,error:`Erro interno: ${a instanceof Error?a.message:"Erro desconhecido"}`}}}};dt(Kn,"instance");let Ju=Kn;const sz=Object.freeze(Object.defineProperty({__proto__:null,EmployeeAuthService:Ju},Symbol.toStringTag,{value:"Module"})),g2=({initialEmployee:t,onSave:s,onClose:a})=>{const{validateForm:r,errors:o,clearErrors:l}=J8(),{saveOffline:c}=ez(),{isOnline:u}=_g(),{executeWithRetry:h}=tz(),{saveCustomPermissions:f,getEmployeePermissions:p}=Ng(),[g,v]=y.useState(null),[b,_]=y.useState({loading:!1,saving:!1,errors:{fields:[]},isDirty:!1,isValid:!1}),[w,E]=y.useState(()=>{const P={name:"",email:"",cpf:"",phone:"",role:"waiter",permissions:[],status:"active",hire_date:new Date,observations:""};return t?{...P,...t}:P});y.useEffect(()=>{_(P=>({...P,errors:o,isValid:!o.fields.length&&!o.general}))},[o]),y.useEffect(()=>{if(t){const P=t.permissions||[],F=t.id?p(t.id,P):P;E({name:"",email:"",cpf:"",phone:"",role:"waiter",status:"active",hire_date:new Date,observations:"",...t,permissions:F})}},[t,p]),y.useEffect(()=>{if(w.role&&!t&&(!w.permissions||w.permissions.length===0)){const P=co[w.role];P&&E(F=>({...F,permissions:[...P.permissions]}))}},[w.role,t]);const T=y.useCallback(P=>{E(F=>({...F,...P})),_(F=>({...F,isDirty:!0}))},[]),N=y.useCallback((P,F)=>{T({[P]:F})},[T]),k=y.useCallback(P=>{E(F=>{const I=F.permissions||[],J=I.some(te=>te.id===P);let pe;if(J)pe=I.filter(te=>te.id!==P);else{const te=co[F.role],L=te==null?void 0:te.permissions.find(G=>G.id===P);L?pe=[...I,L]:pe=I}return{...F,permissions:pe}}),_(F=>({...F,isDirty:!0}))},[]),S=async(P,F,I)=>{console.log("Configurando acesso mobile:",{employeeId:P,appName:F,permissions:I})},C=async(P,F)=>{if(!F||!F.system)return console.log(" Nenhuma credencial fornecida, pulando criao de usurio Auth"),{success:!0};const I=Ju.getInstance();console.log(" Criando usurio de autenticao para funcionrio:",P.name);const J=await I.createEmployeeUser(P,{email:F.system.email,password:F.system.password,username:F.system.username,temporaryPassword:F.system.temporaryPassword});if(!J.success)throw new Error(`Erro ao criar usurio de autenticao: ${J.error}`);return console.log(" Usurio de autenticao criado com sucesso"),J},M=y.useCallback(async()=>{if(r(w)){_(P=>({...P,saving:!0}));try{const P=w;if(!u){const I=c(P);_(J=>({...J,isDirty:!1})),l(),_(J=>({...J,errors:{general:` Funcionrio ${P.name} salvo offline. Ser sincronizado quando a conexo for restaurada.`,fields:[]}})),setTimeout(()=>{a()},2e3);return}if(await h(()=>s(P,g),{maxRetries:1,retryDelay:2e3,timeoutDuration:t?2e4:15e3}),!t&&g)try{await C(P,g)}catch(I){console.error("Erro ao criar usurio de autenticao:",I),_(J=>({...J,errors:{general:`Funcionrio cadastrado, mas houve erro ao criar usurio de login: ${I instanceof Error?I.message:"Erro desconhecido"}`,fields:[]}}))}if(t&&P.id&&P.permissions&&f(P.id,P.permissions),w.role==="waiter"&&P.id)try{await S(P.id,"app-garcom",F8)}catch(I){console.warn("Erro ao configurar acesso mobile (no crtico):",I)}_(I=>({...I,isDirty:!1})),l(),a()}catch(P){console.error("Erro ao salvar funcionrio:",P);let F="Erro ao salvar funcionrio. Tente novamente.";if(P instanceof TypeError&&P.message.includes("fetch"))F="Erro de conexo. Os dados foram salvos offline e sero sincronizados quando a conexo for restaurada.",c(w),setTimeout(()=>{a()},3e3);else if(P instanceof Error&&P.message.includes("Timeout")){const I=!!t;F=`Operao demorou mais que ${I?"20s":"15s"}. ${I?"A edio":"O cadastro"} pode ter sido processada mesmo assim. Verifique a lista de funcionrios e tente novamente se necessrio.`,I&&(c(w),F+=" Os dados foram salvos offline como backup.")}else P instanceof Error&&P.message.includes("NetworkError")&&(F="Erro de rede. Os dados foram salvos offline.",c(w),setTimeout(()=>{a()},3e3));_(I=>({...I,errors:{general:F,fields:[]}}))}finally{_(P=>({...P,saving:!1}))}}},[w,r,s,a,l,u,c]),z=y.useCallback(()=>{b.isDirty&&!window.confirm("H alteraes no salvas. Deseja realmente cancelar?")||(l(),a())},[b.isDirty,l,a]),A=y.useCallback(()=>{E({name:"",email:"",cpf:"",phone:"",role:"waiter",permissions:[],status:"active",hire_date:new Date,observations:""}),_({loading:!1,saving:!1,errors:{fields:[]},isDirty:!1,isValid:!1}),l()},[l]),$=y.useCallback(P=>{v(P)},[]);return{employee:w,state:b,updateEmployee:T,updateField:N,togglePermission:k,handleSave:M,handleCancel:z,resetForm:A,setEmployeeCredentials:$}},x2=async t=>{if(!t)return{isValid:!1,message:"Email  obrigatrio",severity:"error"};if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t))return{isValid:!1,message:"Formato de email invlido",severity:"error"};try{return await new Promise(a=>setTimeout(a,500)),t.endsWith("test.com")?{isValid:!1,message:"Este email j est em uso",severity:"error"}:{isValid:!0,message:"Email disponvel",severity:"success"}}catch{return{isValid:!1,message:"Erro ao verificar email",severity:"warning"}}},y2=t=>{if(!t)return{isValid:!0};const s=t.replace(/\D/g,"");if(s.length!==11)return{isValid:!1,message:"CPF deve ter 11 dgitos",severity:"error"};if(/^(\d)\1{10}$/.test(s))return{isValid:!1,message:"CPF invlido",severity:"error"};let a=0;for(let o=0;o<9;o++)a+=parseInt(s.charAt(o))*(10-o);let r=11-a%11;if((r===10||r===11)&&(r=0),r!==parseInt(s.charAt(9)))return{isValid:!1,message:"CPF invlido",severity:"error"};a=0;for(let o=0;o<10;o++)a+=parseInt(s.charAt(o))*(11-o);return r=11-a%11,(r===10||r===11)&&(r=0),r!==parseInt(s.charAt(10))?{isValid:!1,message:"CPF invlido",severity:"error"}:{isValid:!0,message:"CPF vlido",severity:"success"}},b2=t=>{if(!t)return{isValid:!0};const s=t.replace(/\D/g,"");return s.length<10||s.length>11?{isValid:!1,message:"Telefone deve ter 10 ou 11 dgitos",severity:"error"}:s.length===11&&!["2","3","4","5","6","7","8","9"].includes(s[2])?{isValid:!1,message:"Nmero de celular invlido",severity:"error"}:{isValid:!0,message:"Telefone vlido",severity:"success"}},v2=t=>!t||!t.trim()?{isValid:!1,message:"Nome  obrigatrio",severity:"error"}:t.trim().length<2?{isValid:!1,message:"Nome deve ter pelo menos 2 caracteres",severity:"error"}:t.trim().length>100?{isValid:!1,message:"Nome muito longo (mximo 100 caracteres)",severity:"error"}:t.trim().split(" ").filter(a=>a.length>0).length<2?{isValid:!1,message:"Informe nome e sobrenome",severity:"warning"}:{isValid:!0,message:"Nome vlido",severity:"success"},az=(t,s)=>t?s.permissions&&s.permissions.length>0?{isValid:!0,message:"Funo selecionada com permisses configuradas",severity:"success"}:{isValid:!0,message:"Funo selecionada",severity:"info"}:{isValid:!1,message:"Selecione uma funo",severity:"error"},rz=[{field:"name",validator:v2,debounceMs:300},{field:"email",validator:x2,debounceMs:800},{field:"cpf",validator:y2,debounceMs:500},{field:"phone",validator:b2,debounceMs:500},{field:"role",validator:az,debounceMs:100}],nz=(t,s=rz)=>{const[a,r]=y.useState({});return{validationResults:a,handleValidationChange:(h,f)=>{r(p=>({...p,[h]:f}))},isFieldValid:h=>{const f=a[h];return(f==null?void 0:f.isValid)!==!1},getFieldError:h=>{const f=a[h];return(f==null?void 0:f.isValid)===!1?f.message:null},isFormValid:()=>Object.values(a).every(h=>h.isValid!==!1),rules:s}},w2=({employee:t,onUpdate:s,errors:a})=>{var _,w,E,T,N;const[r,o]=y.useState({}),{getFieldError:l}=nz(),c=k=>{const S=l(k);return S?{message:S}:a.fields.find(C=>C.field===k)},u=(k,S,C,M=500)=>{const z=k;o($=>({...$,[z]:{...$[z],isValidating:!0}}));const A=setTimeout(async()=>{try{const $=await Promise.resolve(C(S,t));o(P=>({...P,[z]:{isValidating:!1,isValid:$.isValid,message:$.message||null,severity:$.severity||null}}))}catch{o(P=>({...P,[z]:{isValidating:!1,isValid:!1,message:"Erro na validao",severity:"error"}}))}},M);return()=>clearTimeout(A)},h=k=>{const S=k.replace(/\D/g,"").slice(0,11);s("cpf",S),u("cpf",S,y2,300)},f=k=>{const S=k.replace(/\D/g,"").slice(0,11);s("phone",S),u("phone",S,b2,300)},p=k=>{s("name",k),u("name",k,v2,400)},g=k=>{s("email",k),u("email",k,x2,800)},v=({field:k})=>{const S=r[k];if(!S)return null;if(S.isValidating)return e.jsxs("div",{className:"flex items-center space-x-1 text-blue-600 mt-1",children:[e.jsx(tO,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{className:"text-xs",children:"Validando..."})]});if(S.isValid===null)return null;const C=()=>{switch(S.severity){case"success":return e.jsx(ts,{className:"h-3 w-3 text-green-600"});case"error":return e.jsx(yr,{className:"h-3 w-3 text-red-600"});case"warning":return e.jsx(Ya,{className:"h-3 w-3 text-yellow-600"});default:return null}},M=()=>{switch(S.severity){case"success":return"text-green-600";case"error":return"text-red-600";case"warning":return"text-yellow-600";default:return"text-gray-600"}};return e.jsxs("div",{className:`flex items-center space-x-1 mt-1 ${M()}`,children:[C(),S.message&&e.jsx("span",{className:"text-xs",children:S.message})]})},b=(k,S)=>{const C=r[k];return c(k)||C&&C.isValid===!1?`${S} border-red-500 focus:ring-red-500`:C&&C.isValid===!0?`${S} border-green-500 focus:ring-green-500`:`${S} border-gray-300 focus:ring-blue-500`};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Ys,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Dados Pessoais"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo *"}),e.jsx("input",{id:"name",type:"text",value:t.name||"",onChange:k=>p(k.target.value),className:b("name","w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2"),placeholder:"Digite o nome completo"}),e.jsx(v,{field:"name"}),c("name")&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:(_=c("name"))==null?void 0:_.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cpf",className:"block text-sm font-medium text-gray-700 mb-1",children:"CPF *"}),e.jsx("input",{id:"cpf",type:"text",value:t.cpf?X8(t.cpf):"",onChange:k=>h(k.target.value),className:b("cpf","w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2"),placeholder:"000.000.000-00",maxLength:14}),e.jsx(v,{field:"cpf"}),c("cpf")&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:(w=c("cpf"))==null?void 0:w.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone"}),e.jsx("input",{id:"phone",type:"text",value:t.phone?Q8(t.phone):"",onChange:k=>f(k.target.value),className:b("phone","w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2"),placeholder:"(11) 99999-9999",maxLength:15}),e.jsx(v,{field:"phone"}),c("phone")&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:(E=c("phone"))==null?void 0:E.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{id:"email",type:"email",value:t.email||"",onChange:k=>g(k.target.value),className:b("email","w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2"),placeholder:"email@exemplo.com"}),e.jsx(v,{field:"email"}),c("email")&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:(T=c("email"))==null?void 0:T.message})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"hire_date",className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(Mr,{className:"inline h-4 w-4 mr-1"}),"Data de Contratao *"]}),e.jsx("input",{id:"hire_date",type:"date",value:t.hire_date?t.hire_date.toISOString().split("T")[0]:"",onChange:k=>s("hire_date",new Date(k.target.value)),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${c("hire_date")?"border-red-500":"border-gray-300"}`}),c("hire_date")&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:(N=c("hire_date"))==null?void 0:N.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"observations",className:"block text-sm font-medium text-gray-700 mb-1",children:"Observaes"}),e.jsx("textarea",{id:"observations",value:t.observations||"",onChange:k=>s("observations",k.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Observaes adicionais sobre o funcionrio (opcional)"})]})]})]})},hr={visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},fr={visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1},xa={visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},yu={visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1},j2={dashboard:{name:"Dashboard",description:"Painel principal com viso geral do estabelecimento",category:"operacional",requiredForRole:["atendente","garcom","cozinheiro","barman","gerente"],icon:"dashboard"},monitor_bar:{name:"Monitor do Bar",description:"Monitoramento de pedidos e preparao de bebidas",category:"operacional",requiredForRole:["barman","gerente"],icon:"local_bar"},atendimento_bar:{name:"Atendimento do Bar",description:"Gesto de pedidos e atendimento aos clientes",category:"operacional",requiredForRole:["garcom","atendente","gerente"],icon:"restaurant_menu"},monitor_cozinha:{name:"Monitor da Cozinha",description:"Acompanhamento de pedidos e preparao de pratos",category:"operacional",requiredForRole:["cozinheiro","gerente"],icon:"restaurant"},gestao_caixa:{name:"Gesto de Caixa",description:"Controle de vendas, pagamentos e fechamento de caixa",category:"financeiro",requiredForRole:["atendente","gerente"],icon:"point_of_sale"},clientes:{name:"Gesto de Clientes",description:"Cadastro e acompanhamento de clientes",category:"operacional",requiredForRole:["atendente","garcom","gerente"],icon:"people"},funcionarios:{name:"Gesto de Funcionrios",description:"Cadastro e gerenciamento da equipe",category:"administrativo",requiredForRole:["gerente"],icon:"badge"},relatorios:{name:"Relatrios",description:"Relatrios de vendas, performance e anlises",category:"relatorios",requiredForRole:["gerente"],icon:"analytics"},configuracoes:{name:"Configuraes",description:"Configuraes do sistema e estabelecimento",category:"administrativo",requiredForRole:["gerente"],icon:"settings"},estoque:{name:"Controle de Estoque",description:"Gesto de produtos e ingredientes",category:"operacional",requiredForRole:["cozinheiro","barman","gerente"],icon:"inventory"},cardapio:{name:"Gesto de Cardpio",description:"Criao e edio de pratos e bebidas",category:"operacional",requiredForRole:["cozinheiro","barman","gerente"],icon:"menu_book"},promocoes:{name:"Promoes",description:"Criao e gesto de promoes e descontos",category:"administrativo",requiredForRole:["gerente"],icon:"local_offer"},financeiro:{name:"Financeiro",description:"Controle financeiro e contabilidade",category:"financeiro",requiredForRole:["gerente"],icon:"account_balance"}},la={atendente:{role:"atendente",displayName:"Atendente de Caixa",description:"Responsvel pelo atendimento ao cliente e operao do caixa",accessLevel:"USER",userType:"funcionario",hierarchy:2,permissions:{dashboard:hr,gestao_caixa:yu,clientes:fr,atendimento_bar:hr,promocoes:hr}},garcom:{role:"garcom",displayName:"Garom",description:"Responsvel pelo atendimento s mesas e pedidos",accessLevel:"USER",userType:"funcionario",hierarchy:2,permissions:{dashboard:hr,atendimento_bar:yu,clientes:fr,cardapio:hr,promocoes:hr}},cozinheiro:{role:"cozinheiro",displayName:"Cozinheiro",description:"Responsvel pela preparao de pratos e controle da cozinha",accessLevel:"USER",userType:"funcionario",hierarchy:2,permissions:{dashboard:hr,monitor_cozinha:yu,estoque:fr,cardapio:fr}},barman:{role:"barman",displayName:"Barman",description:"Responsvel pela preparao de bebidas e gesto do bar",accessLevel:"USER",userType:"funcionario",hierarchy:3,permissions:{dashboard:hr,monitor_bar:yu,atendimento_bar:fr,estoque:fr,cardapio:fr,clientes:hr}},gerente:{role:"gerente",displayName:"Gerente",description:"Responsvel pela gesto geral do estabelecimento",accessLevel:"MANAGER",userType:"administrador",hierarchy:5,canManageRoles:["atendente","garcom","cozinheiro","barman"],permissions:{dashboard:xa,monitor_bar:xa,atendimento_bar:xa,monitor_cozinha:xa,gestao_caixa:xa,clientes:xa,funcionarios:xa,relatorios:xa,configuracoes:fr,estoque:xa,cardapio:xa,promocoes:xa,financeiro:fr}}},Xn=class Xn{constructor(){dt(this,"customPresets",new Map)}static getInstance(){return Xn.instance||(Xn.instance=new Xn),Xn.instance}getDefaultPermissions(s){const a=la[s];if(!a)throw new Error(`Funo no encontrada: ${s}`);return{...a.permissions}}getRoleConfig(s){const a=la[s];if(!a)throw new Error(`Configurao no encontrada para a funo: ${s}`);return{...a}}getAllRoleConfigs(){return{...la}}getPresetById(s){if(this.customPresets.has(s))return this.customPresets.get(s);const a=s;return la[a]?this.createPresetFromRole(a):null}getAllPresets(){const s=Object.keys(la).map(r=>this.createPresetFromRole(r)),a=Array.from(this.customPresets.values());return[...s,...a]}canManageRole(s,a){const r=la[s],o=la[a];return!r||!o||r.hierarchy<=o.hierarchy?!1:r.canManageRoles?r.canManageRoles.includes(a):!0}validatePermission(s,a,r){const o=la[s];if(!o)return{isValid:!1,hasAccess:!1,missingPermissions:[],warnings:[],errors:[`Funo no encontrada: ${s}`]};const l=o.permissions[a];if(!l)return{isValid:!0,hasAccess:!1,missingPermissions:[{module:a,action:r,required:!0,current:!1}],warnings:[`Mdulo ${a} no configurado para a funo ${s}`],errors:[]};const c=l[r];return{isValid:!0,hasAccess:c,missingPermissions:c?[]:[{module:a,action:r,required:!0,current:!1}],warnings:[],errors:[]}}createUserPermissionContext(s,a,r){const o=this.getDefaultPermissions(a),l=r||o;return{userId:s,role:a,permissions:o,effectivePermissions:l,canAccess:(c,u)=>{const h=l[c];return h?h[u]:!1},canManage:c=>this.canManageRole(a,c)}}createCustomPreset(s,a,r,o){const l=this.getDefaultPermissions(r),c=this.mergePermissions(l,o),u={id:`custom_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:s,description:a,role:r,permissions:c,isDefault:!1,isCustomizable:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return this.customPresets.set(u.id,u),u}updateCustomPreset(s,a){const r=this.customPresets.get(s);if(!r||!r.isCustomizable)return null;const o={...r,...a,updatedAt:new Date().toISOString()};return this.customPresets.set(s,o),o}deleteCustomPreset(s){const a=this.customPresets.get(s);return!a||!a.isCustomizable?!1:this.customPresets.delete(s)}mergePermissions(s,a){const r={...s};for(const[o,l]of Object.entries(a))l&&(r[o]={...r[o],...l});return r}createPresetFromRole(s){const a=la[s];return{id:s,name:a.displayName,description:a.description,role:s,permissions:a.permissions,isDefault:!0,isCustomizable:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}getRequiredModulesForRole(s){return Object.entries(j2).filter(([a,r])=>{var o;return(o=r.requiredForRole)==null?void 0:o.includes(s)}).map(([a,r])=>a)}getRoleHierarchy(s){var a;return((a=la[s])==null?void 0:a.hierarchy)||0}getManageableRoles(s){const a=la[s];return(a==null?void 0:a.canManageRoles)||[]}};dt(Xn,"instance");let em=Xn;const nc=em.getInstance(),oz=Object.freeze(Object.defineProperty({__proto__:null,MODULE_DESCRIPTIONS:j2,PermissionPresetManager:em,ROLE_PERMISSION_CONFIGS:la,permissionPresetManager:nc},Symbol.toStringTag,{value:"Module"})),_2=({employee:t,onUpdate:s,errors:a})=>{var v;const r=b=>a.fields.find(_=>_.field===b),[o,l]=y.useState(t.role||null),[c,u]=y.useState(null),h=b=>({waiter:"garcom",cook:"cozinheiro",cashier:"caixa",supervisor:"barman",manager:"gerente",admin:"gerente"})[b]||"garcom",f=b=>{l(b),s("role",b);try{const _=h(b),w=nc.getDefaultPermissions(_),E=Object.entries(w).map(([T,N])=>({id:T,name:T,granted:N.visualizar||N.criar||N.editar||N.excluir||N.administrar,level:N.administrar?"admin":N.excluir?"full":N.editar?"edit":N.criar?"create":"view"}));s("permissions",E),u({role:_,config:nc.getRoleConfig(_),permissions:w})}catch(_){console.error("Erro ao aplicar preset de permisses:",_);const w=co[b];w&&s("permissions",[...w.permissions])}};y.useEffect(()=>{if(o)try{const b=h(o),_=nc.getRoleConfig(b),w=nc.getDefaultPermissions(b);u({role:b,config:_,permissions:w})}catch(b){console.error("Erro ao carregar preview de permisses:",b)}},[o]);const p=b=>({waiter:"",cook:"",cashier:"",supervisor:"",manager:"",admin:""})[b],g=b=>({waiter:"bg-green-100 text-green-800 border-green-200",cook:"bg-orange-100 text-orange-800 border-orange-200",cashier:"bg-blue-100 text-blue-800 border-blue-200",supervisor:"bg-purple-100 text-purple-800 border-purple-200",manager:"bg-red-100 text-red-800 border-red-200",admin:"bg-gray-100 text-gray-800 border-gray-200"})[b];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(YN,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Funo e Cargo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Selecione a Funo *"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Object.entries(co).map(([b,_])=>{const w=b,E=t.role===w;return e.jsxs("div",{onClick:()=>f(w),className:`
                  relative cursor-pointer rounded-lg border-2 p-4 transition-all duration-200
                  ${E?`${g(w)} border-current shadow-md`:"border-gray-200 hover:border-gray-300 hover:shadow-sm"}
                `,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-2xl",children:p(w)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:H8(w)}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:_.description})]}),E&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"w-3 h-3 bg-current rounded-full"})})]}),w==="waiter"&&e.jsx("div",{className:"mt-3 pt-3 border-t border-current border-opacity-20",children:e.jsxs("div",{className:"flex items-center space-x-1 text-xs",children:[e.jsx(XN,{className:"h-3 w-3"}),e.jsx("span",{children:"Inclui acesso ao App Garom"})]})})]},w)})}),r("role")&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:(v=r("role"))==null?void 0:v.message})]}),c&&e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(_i,{className:"h-6 w-6 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h4",{className:"font-medium text-blue-900 mb-2",children:["Permisses para ",c.config.displayName]}),e.jsx("p",{className:"text-sm text-blue-700 mb-3",children:c.config.description}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{className:"text-xs text-gray-700",children:[Object.keys(c.permissions).length," mdulos"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsxs("span",{className:"text-xs text-gray-700",children:["Nvel ",c.config.hierarchy,"/5"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-700",children:c.config.accessLevel})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-700",children:c.config.userType})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"Mdulos com acesso:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(c.permissions).map(([b,_])=>{if(!_.visualizar)return null;const w=k=>({dashboard:"",monitor_bar:"",atendimento_bar:"",monitor_cozinha:"",gestao_caixa:"",clientes:"",funcionarios:"",relatorios:"",configuracoes:"",estoque:"",cardapio:""})[k]||"",E=k=>k.administrar?"Admin":k.excluir?"Full":k.editar?"Edit":k.criar?"Create":"View",T=k=>({Admin:"bg-red-100 text-red-700",Full:"bg-orange-100 text-orange-700",Edit:"bg-yellow-100 text-yellow-700",Create:"bg-blue-100 text-blue-700",View:"bg-gray-100 text-gray-700"})[k]||"bg-gray-100 text-gray-700",N=E(_);return e.jsxs("div",{className:`inline-flex items-center space-x-1 px-2 py-1 rounded-full text-xs ${T(N)}`,title:`${b}: ${N}`,children:[e.jsx("span",{children:w(b)}),e.jsx("span",{className:"capitalize",children:b.replace("_"," ")}),e.jsxs("span",{className:"font-medium",children:["(",N,")"]})]},b)})})]}),c.config.canManageRoles&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-1",children:"Pode gerenciar:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:c.config.canManageRoles.map(b=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-100 text-green-700",children:[e.jsx(Ss,{className:"h-3 w-3 mr-1"}),b]},b))})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-blue-600 mt-3",children:[e.jsx(kr,{className:"h-3 w-3"}),e.jsx("span",{children:"Permisses aplicadas automaticamente. Personalize na prxima seo se necessrio."})]})]})]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{id:"status",value:t.status||"active",onChange:b=>s("status",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"active",children:"Ativo"}),e.jsx("option",{value:"inactive",children:"Inativo"}),e.jsx("option",{value:"suspended",children:"Suspenso"})]})]})]})},N2=({employee:t,onTogglePermission:s,mode:a="create"})=>{const[r,o]=y.useState(new Set(["app-garcom"])),{hasCustomPermissions:l,resetToDefaultPermissions:c}=Ng(),u=T=>{const N=new Set(r);N.has(T)?N.delete(T):N.add(T),o(N)},h=T=>{var N;return((N=t.permissions)==null?void 0:N.some(k=>k.id===T))||!1},f=()=>{var T;return t.role?((T=co[t.role])==null?void 0:T.permissions)||[]:[]},p=T=>{const N={};return T.forEach(k=>{N[k.module]||(N[k.module]=[]),N[k.module].push(k)}),N},g=f(),v=p(g),b=a==="edit"&&t.id&&l(t.id),_=()=>{t.id&&t.role&&confirm("Tem certeza que deseja resetar as permisses para o padro da funo?")&&(c(t.id),co[t.role]&&alert("Permisses resetadas! Feche e abra o modal novamente para ver as mudanas."))},w=T=>({bar:"",kitchen:"",cashier:"",reports:"",inventory:"",customers:"",settings:"","app-garcom":""})[T]||"",E=T=>({bar:"bg-amber-50 border-amber-200",kitchen:"bg-orange-50 border-orange-200",cashier:"bg-green-50 border-green-200",reports:"bg-blue-50 border-blue-200",inventory:"bg-purple-50 border-purple-200",customers:"bg-pink-50 border-pink-200",settings:"bg-gray-50 border-gray-200","app-garcom":"bg-indigo-50 border-indigo-200"})[T]||"bg-gray-50 border-gray-200";return t.role?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_i,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Permisses"}),b&&e.jsxs("div",{className:"flex items-center space-x-1 bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs",children:[e.jsx(Li,{className:"h-3 w-3"}),e.jsx("span",{children:"Customizado"})]})]}),b&&e.jsxs("button",{onClick:_,className:"flex items-center space-x-1 text-sm text-gray-600 hover:text-gray-800 bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-md transition-colors",children:[e.jsx(vO,{className:"h-3 w-3"}),e.jsx("span",{children:"Resetar"})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"text-yellow-600",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-yellow-900",children:"Permisses Personalizveis"}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"As permisses abaixo foram aplicadas automaticamente baseadas na funo selecionada. Voc pode personalizar marcando/desmarcando as opes conforme necessrio."})]})]})}),e.jsx("div",{className:"space-y-4",children:Object.entries(v).map(([T,N])=>{const k=r.has(T),S=N.filter(z=>h(z.id)),C=N.length,M=S.length;return e.jsxs("div",{className:`border rounded-lg ${E(T)}`,children:[e.jsxs("div",{onClick:()=>u(T),className:"flex items-center justify-between p-4 cursor-pointer hover:bg-opacity-80 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-xl",children:w(T)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:G8(T)}),e.jsxs("p",{className:"text-sm text-gray-600",children:[M," de ",C," permisses ativas"]})]}),T==="app-garcom"&&t.role==="waiter"&&e.jsxs("div",{className:"flex items-center space-x-1 bg-indigo-100 text-indigo-800 px-2 py-1 rounded-full text-xs",children:[e.jsx(io,{className:"h-3 w-3"}),e.jsx("span",{children:"App Mobile"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[Math.round(M/C*100),"%"]}),k?e.jsx(jR,{className:"h-5 w-5 text-gray-400"}):e.jsx(NR,{className:"h-5 w-5 text-gray-400"})]})]}),k&&e.jsxs("div",{className:"border-t border-current border-opacity-20 p-4 bg-white bg-opacity-50",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:N.map(z=>{const A=h(z.id);return e.jsxs("div",{onClick:()=>s(z.id),className:`
                            flex items-center space-x-3 p-3 rounded-lg cursor-pointer transition-all
                            ${A?"bg-white border-2 border-blue-200 shadow-sm":"bg-gray-50 border border-gray-200 hover:bg-gray-100"}
                          `,children:[e.jsx("div",{className:`
                            flex items-center justify-center w-5 h-5 rounded border-2 transition-colors
                            ${A?"bg-blue-600 border-blue-600":"border-gray-300"}
                          `,children:A&&e.jsx(Zu,{className:"h-3 w-3 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:Z8(z.action)}),z.resource&&e.jsx("div",{className:"text-sm text-gray-600",children:z.resource.replace(/_/g," ")})]})]},z.id)})}),T==="app-garcom"&&t.role==="waiter"&&e.jsx("div",{className:"mt-4 p-3 bg-indigo-100 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(io,{className:"h-5 w-5 text-indigo-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-indigo-900",children:"Acesso ao App Garom"}),e.jsx("p",{className:"text-sm text-indigo-700 mt-1",children:"Este funcionrio ter acesso ao aplicativo mobile para garons, permitindo gerenciar mesas, pedidos e atendimento diretamente pelo celular."}),e.jsxs("div",{className:"mt-2 text-xs text-indigo-600",children:[" Limite de 2 dispositivos simultneos",e.jsx("br",{})," Sincronizao automtica com o sistema principal",e.jsx("br",{})," Acesso offline limitado para consultas"]})]})]})})]})]},T)})}),g.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(_i,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"Nenhuma permisso disponvel para esta funo"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(_i,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Permisses"})]}),e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(_i,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"Selecione uma funo para configurar as permisses"})]})]})},Dj=(t,s)=>{const r=t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z\s]/g,"").trim().split(" ").filter(c=>c.length>0);if(r.length===0)return s?`user${s.slice(-4)}`:`user${Date.now()}`;let o="";r.length===1?o=r[0]:r.length===2?o=`${r[0]}.${r[1]}`:o=`${r[0]}.${r[r.length-1]}`;const l=Date.now().toString().slice(-3);return o.length>15&&(o=o.substring(0,12)+l),o},iz=()=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",s="abcdefghijklmnopqrstuvwxyz",a="0123456789",r="!@#$%&*";let o="";o+=t[Math.floor(Math.random()*t.length)],o+=s[Math.floor(Math.random()*s.length)],o+=a[Math.floor(Math.random()*a.length)],o+=r[Math.floor(Math.random()*r.length)];const l=t+s+a+r;for(let c=4;c<8;c++)o+=l[Math.floor(Math.random()*l.length)];return o.split("").sort(()=>Math.random()-.5).join("")},S2=async t=>{let s=Dj(t.name,t.cpf);const a=iz(),{EmployeeAuthService:r}=await Sa(async()=>{const{EmployeeAuthService:h}=await Promise.resolve().then(()=>sz);return{EmployeeAuthService:h}},void 0),o=r.getInstance();let l=0;const c=5;for(;l<c&&await o.checkUsernameExists(s);){l++;const f=l.toString().padStart(2,"0");s=`${Dj(t.name,t.cpf)}${f}`}if(await o.checkEmailExists(t.email))throw new Error(`Email ${t.email} j est em uso por outro funcionrio`);return{username:s,password:a,email:t.email,temporaryPassword:!0}},Pj=t=>t.length<3?{valid:!1,message:"Nome de usurio deve ter pelo menos 3 caracteres"}:t.length>20?{valid:!1,message:"Nome de usurio deve ter no mximo 20 caracteres"}:/^[a-z0-9._-]+$/.test(t)?t.startsWith(".")||t.endsWith(".")?{valid:!1,message:"Nome de usurio no pode comear ou terminar com ponto"}:{valid:!0}:{valid:!1,message:"Nome de usurio pode conter apenas letras minsculas, nmeros, pontos, hfens e underscores"},zj=t=>{const s=[];let a=0;t.length>=8?a+=2:t.length>=6?a+=1:s.push("Use pelo menos 8 caracteres"),/[A-Z]/.test(t)?a+=1:s.push("Adicione letras maisculas"),/[a-z]/.test(t)?a+=1:s.push("Adicione letras minsculas"),/\d/.test(t)?a+=1:s.push("Adicione nmeros"),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(t)?a+=1:s.push("Adicione smbolos especiais"),new Set(t).size>=t.length*.7?a+=1:s.push("Use caracteres mais variados");let r;return a>=6?r="strong":a>=4?r="medium":r="weak",{strength:r,score:a,feedback:s}},lz=t=>`
 Email: ${t.email}
 Usurio: ${t.username}
 Senha: ${t.password}

 Esta  uma senha temporria. O funcionrio deve alter-la no primeiro acesso.
  `.trim(),cz=async t=>{const s=await S2(t);return{system:s,mobile:t.role==="waiter"?{...s,appId:`garcom_${s.username}`,deviceLimit:2}:null,firstAccessToken:dz(),passwordExpiry:new Date(Date.now()+7*24*60*60*1e3)}},dz=()=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let s="";for(let a=0;a<8;a++)s+=t[Math.floor(Math.random()*t.length)];return s},uz=({employee:t,onCredentialsGenerated:s,mode:a,showCredentialsStep:r=!1})=>{const[o,l]=y.useState(null),[c,u]=y.useState(!1),[h,f]=y.useState(""),[p,g]=y.useState(""),[v,b]=y.useState(!1),[_,w]=y.useState(!1),[E,T]=y.useState(!0),N=async()=>{if(!t.name){alert("Preencha o nome do funcionrio primeiro");return}try{const M=await S2(t);l(M);const z=await cz(t);s(z)}catch(M){console.error("Erro ao gerar credenciais:",M),alert(`Erro ao gerar credenciais: ${M instanceof Error?M.message:"Erro desconhecido"}`)}},k=()=>{if(!h||!p){alert("Preencha usurio e senha personalizados");return}const M=Pj(h);if(!M.valid){alert(M.message);return}const z=zj(p);if(z.strength==="weak"&&!window.confirm(`Senha fraca detectada. Sugestes:
`+z.feedback.join(`
`)+`

Deseja continuar mesmo assim?`))return;const A={username:h,password:p,email:t.email||"",temporaryPassword:!1};l(A),s({system:A,mobile:t.role==="waiter"?{...A,appId:`garcom_${h}`,deviceLimit:2}:null,passwordExpiry:null})},S=async()=>{if(!o)return;const M=lz(o);try{await navigator.clipboard.writeText(M),w(!0),setTimeout(()=>w(!1),2e3)}catch{const A=document.createElement("textarea");A.value=M,document.body.appendChild(A),A.select(),document.execCommand("copy"),document.body.removeChild(A),w(!0),setTimeout(()=>w(!1),2e3)}},C=p?zj(p):null;return r?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(jr,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Credenciais de Acesso"})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ys,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Acesso ao Sistema"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Permitir que este funcionrio faa login no sistema"})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:E,onChange:M=>{T(M.target.checked),M.target.checked||(l(null),s(null))},className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),!E&&e.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(mt,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-yellow-900",children:"Sem Acesso ao Sistema"}),e.jsx("p",{className:"text-yellow-700",children:"Este funcionrio ser cadastrado apenas para controle interno, sem capacidade de fazer login no sistema."})]})]})})]}),E&&a==="create"&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(jr,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"Gerao de Credenciais"}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["Gere automaticamente usurio e senha para o funcionrio acessar o sistema.",t.role==="waiter"&&e.jsxs("span",{className:"block mt-1",children:[e.jsx(io,{className:"inline h-4 w-4 mr-1"}),"Como garom, tambm receber acesso ao app mobile."]})]})]})]})}),E&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",checked:!v,onChange:()=>b(!1),className:"text-blue-600"}),e.jsx("span",{children:"Gerar automaticamente"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",checked:v,onChange:()=>b(!0),className:"text-blue-600"}),e.jsx("span",{children:"Definir manualmente"})]})]}),v?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome de Usurio"}),e.jsx("input",{type:"text",value:h,onChange:M=>f(M.target.value.toLowerCase()),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"usuario.exemplo"}),h&&(()=>{const M=Pj(h);return M.valid?e.jsx("p",{className:"mt-1 text-sm text-green-600",children:" Nome de usurio vlido"}):e.jsx("p",{className:"mt-1 text-sm text-red-600",children:M.message})})()]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:c?"text":"password",value:p,onChange:M=>g(M.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Digite uma senha segura"}),e.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?e.jsx(fn,{className:"h-4 w-4"}):e.jsx(Ws,{className:"h-4 w-4"})})]}),C&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:`text-sm font-medium ${C.strength==="strong"?"text-green-600":C.strength==="medium"?"text-yellow-600":"text-red-600"}`,children:["Fora: ",C.strength==="strong"?"Forte":C.strength==="medium"?"Mdia":"Fraca"]}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${C.strength==="strong"?"bg-green-500":C.strength==="medium"?"bg-yellow-500":"bg-red-500"}`,style:{width:`${C.score/7*100}%`}})})]}),C.feedback.length>0&&e.jsxs("div",{className:"mt-1",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Sugestes:"}),e.jsx("ul",{className:"text-xs text-gray-600 list-disc list-inside",children:C.feedback.map((M,z)=>e.jsx("li",{children:M},z))})]})]})]}),e.jsxs("button",{onClick:k,disabled:!h||!p,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(jr,{className:"h-4 w-4"}),e.jsx("span",{children:"Definir Credenciais"})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:N,disabled:!t.name,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(_a,{className:"h-4 w-4"}),e.jsx("span",{children:"Gerar Credenciais"})]}),!t.name&&e.jsx("p",{className:"text-sm text-gray-500",children:"Preencha o nome do funcionrio para gerar credenciais"})]})]}),E&&o&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Credenciais Geradas"}),e.jsxs("button",{onClick:S,className:`flex items-center space-x-1 px-3 py-1 rounded text-sm transition-colors ${_?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(La,{className:"h-3 w-3"}),e.jsx("span",{children:_?"Copiado!":"Copiar"})]})]}),e.jsxs("div",{className:"space-y-2 font-mono text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Email:"}),e.jsx("span",{className:"ml-2 font-semibold",children:o.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Usurio:"}),e.jsx("span",{className:"ml-2 font-semibold",children:o.username})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Senha:"}),e.jsx("span",{className:"ml-2 font-semibold",children:c?o.password:""}),e.jsx("button",{onClick:()=>u(!c),className:"ml-2 text-gray-400 hover:text-gray-600",children:c?e.jsx(fn,{className:"h-3 w-3"}):e.jsx(Ws,{className:"h-3 w-3"})})]})]}),o.temporaryPassword&&e.jsx("div",{className:"mt-3 p-2 bg-yellow-50 border border-yellow-200 rounded",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(mt,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-yellow-900",children:"Senha Temporria"}),e.jsx("p",{className:"text-yellow-700",children:"O funcionrio deve alterar esta senha no primeiro acesso. A senha expira em 7 dias."})]})]})}),t.role==="waiter"&&e.jsx("div",{className:"mt-3 p-2 bg-indigo-50 border border-indigo-200 rounded",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(io,{className:"h-4 w-4 text-indigo-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-indigo-900",children:"Acesso ao App Garom"}),e.jsx("p",{className:"text-indigo-700",children:"Estas credenciais tambm funcionam no aplicativo mobile. Limite: 2 dispositivos simultneos."})]})]})})]})]}):null},mz=({isVisible:t,mode:s,isOnline:a,retryCount:r=0,isRetrying:o=!1})=>{const[l,c]=y.useState(0);if(y.useEffect(()=>{if(!t){c(0);return}const g=Date.now(),v=setInterval(()=>{c(Math.floor((Date.now()-g)/1e3))},1e3);return()=>clearInterval(v)},[t]),!t)return null;const u=s==="edit"?60:45,h=Math.min(l/u*100,100),f=()=>o?`Tentativa ${r+1} - Tentando novamente...`:r>0?`Tentativa ${r+1} em andamento...`:l<5?s==="edit"?"Salvando alteraes...":"Cadastrando funcionrio...":l<15?"Processando dados...":l<30?"Aguarde, operao em andamento...":l<u?"Operao est demorando mais que o esperado...":"Timeout em breve. Verifique sua conexo.",p=()=>l<15?"bg-blue-500":l<30?"bg-yellow-500":"bg-red-500";return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full mx-4 shadow-xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:f()}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-1000 ${p()}`,style:{width:`${h}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsxs("span",{children:[l,"s / ",u,"s"]})]}),e.jsxs("div",{className:`flex items-center space-x-1 ${a?"text-green-600":"text-red-600"}`,children:[e.jsx(wg,{className:"h-4 w-4"}),e.jsx("span",{children:a?"Online":"Offline"})]})]}),l>20&&e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-yellow-800",children:" A operao est demorando mais que o normal. Isso pode indicar lentido na conexo ou no servidor."})}),l>u-10&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-800",children:[" Timeout em ",u-l," segundos. A operao pode ter sido processada mesmo assim."]})})]})})})},hz=({isOpen:t,onClose:s,onSave:a,employee:r,mode:o})=>{const{employee:l,state:c,updateField:u,togglePermission:h,handleSave:f,handleCancel:p,resetForm:g}=g2({initialEmployee:r,onSave:a,onClose:s}),{isOnline:v}=_g();return y.useEffect(()=>{t&&o==="create"&&!r&&g()},[t,o,r,g]),y.useEffect(()=>{if(!t)return;const b=_=>{_.key==="Escape"&&p()};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[t,p]),y.useEffect(()=>{if(!t)return;const b=document.getElementById("employee-modal");if(b){const _=b.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),w=_[0],E=_[_.length-1],T=N=>{N.key==="Tab"&&(N.shiftKey?document.activeElement===w&&(E.focus(),N.preventDefault()):document.activeElement===E&&(w.focus(),N.preventDefault()))};return document.addEventListener("keydown",T),w==null||w.focus(),()=>document.removeEventListener("keydown",T)}},[t]),t?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:p}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{id:"employee-modal",role:"dialog","aria-modal":"true","aria-labelledby":"employee-modal-title","aria-describedby":"employee-modal-description",className:"relative w-full max-w-4xl bg-white rounded-lg shadow-xl",style:{maxHeight:"90vh"},children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 px-6 py-4 rounded-t-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{id:"employee-modal-title",className:"text-xl font-bold text-gray-900",children:o==="create"?"Novo Funcionrio":"Editar Funcionrio"}),e.jsx("p",{id:"employee-modal-description",className:"text-sm text-gray-600 mt-1",children:o==="create"?"Cadastre um novo funcionrio e configure suas permisses":"Edite as informaes e permisses do funcionrio"})]}),e.jsx("button",{onClick:p,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Fechar modal",children:e.jsx(lt,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[c.isDirty&&e.jsxs("div",{className:"text-xs text-amber-600 flex items-center space-x-1",children:[e.jsx(Ya,{className:"h-3 w-3"}),e.jsx("span",{children:"H alteraes no salvas"})]}),e.jsx("div",{className:`text-xs flex items-center space-x-1 ${v?"text-green-600":"text-red-600"}`,children:v?e.jsxs(e.Fragment,{children:[e.jsx(wg,{className:"h-3 w-3"}),e.jsx("span",{children:"Online"})]}):e.jsxs(e.Fragment,{children:[e.jsx(p0,{className:"h-3 w-3"}),e.jsx("span",{children:"Sem conexo"})]})})]})]}),e.jsxs("div",{className:"overflow-y-auto px-6 py-6 space-y-8",style:{maxHeight:"calc(90vh - 140px)"},"data-testid":"modal-body",children:[!v&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p0,{className:"h-5 w-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-800 font-medium",children:"Sem conexo com a internet"}),e.jsx("p",{className:"text-orange-700 text-sm",children:"Verifique sua conexo antes de tentar salvar o funcionrio."})]})]})}),c.errors.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ya,{className:"h-5 w-5 text-red-600"}),e.jsx("p",{className:"text-red-800",children:c.errors.general})]})}),e.jsx(w2,{employee:l,onUpdate:u,errors:c.errors}),e.jsx(_2,{employee:l,onUpdate:u,errors:c.errors}),e.jsx(N2,{employee:l,onTogglePermission:h,mode:o}),!1]}),e.jsx("div",{className:"sticky bottom-0 z-10 bg-white border-t border-gray-200 px-6 py-4 rounded-b-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:c.errors.fields.length>0&&e.jsxs("span",{className:"text-red-600",children:[c.errors.fields.length," erro(s) encontrado(s)"]})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:p,disabled:c.saving,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors disabled:opacity-50",children:"Cancelar"}),e.jsx("button",{onClick:f,disabled:c.saving||!c.isValid||c.errors.fields.length>0,className:`px-6 py-2 rounded-md transition-colors disabled:opacity-50 flex items-center space-x-2 ${v?"bg-blue-600 hover:bg-blue-700 text-white":"bg-orange-600 hover:bg-orange-700 text-white"}`,title:v?"":"Salvar offline e sincronizar quando a conexo for restaurada",children:c.saving?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:o==="edit"?"Salvando alteraes...":"Cadastrando funcionrio..."})]}):v?e.jsxs(e.Fragment,{children:[e.jsx(oo,{className:"h-4 w-4"}),e.jsx("span",{children:o==="create"?"Cadastrar":"Salvar"})]}):e.jsxs(e.Fragment,{children:[e.jsx(oo,{className:"h-4 w-4"}),e.jsx("span",{children:"Salvar Offline"})]})})]})]})})]})}),e.jsx(mz,{isVisible:c.saving,mode:o,isOnline:v})]}):null},fz=({isOpen:t,onClose:s,onSave:a,mode:r})=>{const[o,l]=y.useState("employee"),[c,u]=y.useState(null),[h,f]=y.useState(null),{employee:p,state:g,updateField:v,togglePermission:b,resetForm:_}=g2({initialEmployee:void 0,onSave:async S=>{u(S),l("credentials")},onClose:s}),w=async()=>{!g.isValid||g.errors.fields.length>0||(u(p),l("credentials"))},E=async()=>{if(c)try{await a(c,h),N()}catch(S){console.error("Erro ao salvar funcionrio:",S),alert("Erro ao salvar funcionrio. Tente novamente.")}},T=async()=>{if(c)try{await a(c,null),N()}catch(S){console.error("Erro ao salvar funcionrio:",S),alert("Erro ao salvar funcionrio. Tente novamente.")}},N=()=>{l("employee"),u(null),f(null),_(),s()},k=()=>{l("employee")};return t?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:N}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{className:"relative w-full max-w-4xl bg-white rounded-lg shadow-xl",style:{maxHeight:"90vh"},children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 px-6 py-4 rounded-t-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:o==="employee"?"Novo Funcionrio":"Configurar Credenciais"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o==="employee"?"Cadastre os dados bsicos do funcionrio":"Configure as credenciais de acesso (opcional)"})]}),e.jsx("button",{onClick:N,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(lt,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-4",children:[e.jsxs("div",{className:`flex items-center space-x-2 ${o==="employee"?"text-blue-600":"text-green-600"}`,children:[o==="employee"?e.jsx(Ys,{className:"h-5 w-5"}):e.jsx(ts,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-medium",children:"1. Dados do Funcionrio"})]}),e.jsx(no,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{className:`flex items-center space-x-2 ${o==="credentials"?"text-blue-600":"text-gray-400"}`,children:[e.jsx(jr,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-medium",children:"2. Credenciais (Opcional)"})]})]})]}),e.jsx("div",{className:"overflow-y-auto px-6 py-6 space-y-8",style:{maxHeight:"calc(90vh - 140px)"},children:o==="employee"?e.jsxs(e.Fragment,{children:[g.errors.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800",children:g.errors.general})}),e.jsx(w2,{employee:p,onUpdate:v,errors:g.errors}),e.jsx(_2,{employee:p,onUpdate:v,errors:g.errors}),e.jsx(N2,{employee:p,onTogglePermission:b,mode:r})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ts,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-green-900",children:"Funcionrio Configurado"}),e.jsxs("p",{className:"text-green-700 text-sm",children:[c==null?void 0:c.name," - ",c==null?void 0:c.role]})]})]})}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Sobre as Credenciais"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Voc pode criar credenciais de acesso agora ou fazer isso mais tarde. Se pular esta etapa, o funcionrio ser cadastrado apenas para controle interno, sem capacidade de fazer login no sistema."})]}),e.jsx(uz,{employee:c||{},onCredentialsGenerated:f,mode:"create",showCredentialsStep:!0})]})}),e.jsx("div",{className:"sticky bottom-0 z-10 bg-white border-t border-gray-200 px-6 py-4 rounded-b-lg",children:o==="employee"?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:g.errors.fields.length>0&&e.jsxs("span",{className:"text-red-600",children:[g.errors.fields.length," erro(s) encontrado(s)"]})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:N,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancelar"}),e.jsxs("button",{onClick:w,disabled:!g.isValid||g.errors.fields.length>0,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors disabled:opacity-50 flex items-center space-x-2",children:[e.jsx("span",{children:"Prximo"}),e.jsx(no,{className:"h-4 w-4"})]})]})]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:k,className:"flex items-center space-x-2 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:[e.jsx(fo,{className:"h-4 w-4"}),e.jsx("span",{children:"Voltar"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:T,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Pular Credenciais"}),e.jsxs("button",{onClick:E,disabled:!h,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors disabled:opacity-50 flex items-center space-x-2",children:[e.jsx(oo,{className:"h-4 w-4"}),e.jsx("span",{children:"Finalizar Cadastro"})]})]})]})})]})})]}):null},pz=({isOpen:t,onClose:s,onSave:a})=>{const[r,o]=y.useState({nome_completo:"",email:"",telefone:"",cpf:"",bar_role:"atendente",cargo:"Atendente de Caixa",observacoes:""}),[l,c]=y.useState(!1),[u,h]=y.useState({}),f=[{value:"atendente",label:"Atendente de Caixa",cargo:"Atendente de Caixa"},{value:"garcom",label:"Garom",cargo:"Garom"},{value:"cozinheiro",label:"Cozinheiro",cargo:"Cozinheiro"},{value:"barman",label:"Barman",cargo:"Barman"},{value:"gerente",label:"Gerente",cargo:"Gerente"}],p=_=>{const w=f.find(E=>E.value===_);w&&o(E=>({...E,bar_role:_,cargo:w.cargo}))},g=()=>{const _={};return r.nome_completo.trim()||(_.nome_completo="Nome completo  obrigatrio"),r.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email)||(_.email="Email invlido"):_.email="Email  obrigatrio",r.bar_role||(_.bar_role="Funo  obrigatria"),h(_),Object.keys(_).length===0},v=async()=>{if(g()){console.log(" DADOS ENVIADOS do modal:"),console.log("  - nome_completo:",r.nome_completo),console.log("  - email:",r.email),console.log("  - telefone:",r.telefone),console.log("  - cpf:",r.cpf),console.log("  - bar_role:",r.bar_role),console.log("  - cargo:",r.cargo),c(!0);try{await a(r),b()}catch(_){console.error("Erro ao salvar funcionrio:",_)}finally{c(!1)}}},b=()=>{o({nome_completo:"",email:"",telefone:"",cpf:"",bar_role:"atendente",cargo:"Atendente de Caixa",observacoes:""}),h({}),s()};return t?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:b}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[e.jsxs("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ys,{className:"h-6 w-6 text-blue-600"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Novo Funcionrio"})]}),e.jsx("button",{onClick:b,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(lt,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Etapa 1:"})," Cadastro bsico do funcionrio. As credenciais de acesso sero criadas posteriormente atravs da edio."]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo *"}),e.jsx("input",{type:"text",value:r.nome_completo,onChange:_=>o(w=>({...w,nome_completo:_.target.value})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${u.nome_completo?"border-red-300":"border-gray-300"}`,placeholder:"Digite o nome completo"}),u.nome_completo&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.nome_completo})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",value:r.email,onChange:_=>o(w=>({...w,email:_.target.value})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${u.email?"border-red-300":"border-gray-300"}`,placeholder:"Digite o email"}),u.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone"}),e.jsx("input",{type:"tel",value:r.telefone,onChange:_=>o(w=>({...w,telefone:_.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"(00) 00000-0000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CPF"}),e.jsx("input",{type:"text",value:r.cpf,onChange:_=>o(w=>({...w,cpf:_.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"000.000.000-00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Funo *"}),e.jsx("select",{value:r.bar_role,onChange:_=>p(_.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${u.bar_role?"border-red-300":"border-gray-300"}`,children:f.map(_=>e.jsx("option",{value:_.value,children:_.label},_.value))}),u.bar_role&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.bar_role})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cargo"}),e.jsx("input",{type:"text",value:r.cargo,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-600"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsxs("button",{onClick:v,disabled:l,className:"w-full inline-flex justify-center items-center space-x-2 rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(oo,{className:"h-4 w-4"}),e.jsx("span",{children:l?"Salvando...":"Salvar Funcionrio"})]}),e.jsx("button",{onClick:b,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancelar"})]})]})]})}):null},gz=({isOpen:t,onClose:s,onSave:a,employeeName:r,employeeRole:o})=>{const[l,c]=y.useState(!1),[u,h]=y.useState({tem_acesso_sistema:!0,permissoes_modulos:{}}),f=T=>({atendente:{gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}},garcom:{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},atendimento_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1},clientes:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}},cozinheiro:{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},monitor_cozinha:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},gerente:{dashboard:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},monitor_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},atendimento_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},monitor_cozinha:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},clientes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},funcionarios:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},relatorios:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0}}})[T]||{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}};Ye.useEffect(()=>{if(t){const T=f(o);h({tem_acesso_sistema:!0,permissoes_modulos:T})}},[t,o]);const p=[{key:"dashboard",name:"Dashboard",icon:""},{key:"monitor_bar",name:"Monitor Bar",icon:""},{key:"atendimento_bar",name:"Atendimento Bar",icon:""},{key:"monitor_cozinha",name:"Monitor Cozinha",icon:""},{key:"gestao_caixa",name:"Gesto de Caixa",icon:""},{key:"clientes",name:"Clientes",icon:""},{key:"funcionarios",name:"Funcionrios",icon:""},{key:"relatorios",name:"Relatrios",icon:""},{key:"configuracoes",name:"Configuraes",icon:""}],g=["visualizar","criar","editar","excluir","administrar"],v={visualizar:"Ver",criar:"Criar",editar:"Editar",excluir:"Excluir",administrar:"Admin"},b=(T,N,k)=>{h(S=>({...S,permissoes_modulos:{...S.permissoes_modulos,[T]:{...S.permissoes_modulos[T],[N]:k}}}))},_=(T,N)=>{if(N){const k=f(o)[T]||{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1};h(S=>({...S,permissoes_modulos:{...S.permissoes_modulos,[T]:k}}))}else{const k={...u.permissoes_modulos};delete k[T],h(S=>({...S,permissoes_modulos:k}))}},w=async()=>{c(!0);try{await a(u),E()}catch(T){console.error("Erro ao salvar credenciais:",T)}finally{c(!1)}},E=()=>{h({tem_acesso_sistema:!0,permissoes_modulos:{}}),s()};return t?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:E}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[e.jsxs("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(jr,{className:"h-6 w-6 text-green-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Criar Credenciais de Acesso"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[r," - ",o]})]})]}),e.jsx("button",{onClick:E,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(lt,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 mb-4",children:e.jsxs("p",{className:"text-sm text-green-800",children:[e.jsx("strong",{children:"Etapa 2:"})," Definir credenciais e permisses de acesso ao sistema. As permisses foram pr-configuradas baseadas na funo do funcionrio."]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(_i,{className:"h-5 w-5 text-blue-600"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:u.tem_acesso_sistema,onChange:T=>h(N=>({...N,tem_acesso_sistema:T.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Permitir acesso ao sistema"})]})]})}),u.tem_acesso_sistema&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Permisses por Mdulo"}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:p.map(T=>{const N=u.permissoes_modulos[T.key];return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:T.icon}),e.jsx("span",{className:"font-medium text-gray-900",children:T.name})]}),e.jsx("label",{className:"flex items-center",children:e.jsx("input",{type:"checkbox",checked:!!N,onChange:k=>_(T.key,k.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})})]}),N&&e.jsx("div",{className:"grid grid-cols-5 gap-2 ml-8",children:g.map(k=>e.jsxs("label",{className:"flex items-center space-x-1",children:[e.jsx("input",{type:"checkbox",checked:N[k]||!1,onChange:S=>b(T.key,k,S.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 text-xs"}),e.jsx("span",{className:"text-xs text-gray-600",children:v[k]})]},k))})]},T.key)})})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsxs("button",{onClick:w,disabled:l,className:"w-full inline-flex justify-center items-center space-x-2 rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(oo,{className:"h-4 w-4"}),e.jsx("span",{children:l?"Criando...":"Criar Credenciais"})]}),e.jsx("button",{onClick:E,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancelar"})]})]})]})}):null},xz=()=>{const{isOnline:t,wasOffline:s}=_g(),[a,r]=y.useState(!1);return y.useEffect(()=>{if(t&&s){r(!0);const o=setTimeout(()=>{r(!1)},5e3);return()=>clearTimeout(o)}},[t,s]),a?e.jsx("div",{className:"fixed top-4 right-4 z-50 bg-green-50 border border-green-200 rounded-lg p-4 shadow-lg max-w-sm",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(wg,{className:"h-5 w-5 text-green-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-green-900",children:"Conexo Restaurada"}),e.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Voc est online novamente. Pode continuar salvando dados."})]}),e.jsx("button",{onClick:()=>r(!1),className:"text-green-400 hover:text-green-600",children:e.jsx(lt,{className:"h-4 w-4"})})]})}):t?null:e.jsx("div",{className:"fixed top-4 right-4 z-50 bg-red-50 border border-red-200 rounded-lg p-4 shadow-lg max-w-sm",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(p0,{className:"h-5 w-5 text-red-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-red-900",children:"Sem Conexo"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:"Verifique sua internet. Algumas funcionalidades podem no funcionar."})]})]})})},E2=({isOpen:t,onClose:s,credentials:a,employeeName:r})=>{const[o,l]=y.useState(!1),[c,u]=y.useState(null);if(!t)return null;const h=async(p,g)=>{try{await navigator.clipboard.writeText(p),u(g),setTimeout(()=>u(null),2e3)}catch(v){console.error("Erro ao copiar:",v)}},f=()=>`
CREDENCIAIS DE ACESSO - ${r.toUpperCase()}

 Email: ${a.system.email}
 Usurio: ${a.system.username}
 Senha: ${a.system.password}

${a.system.temporaryPassword?" IMPORTANTE: Esta  uma senha temporria que deve ser alterada no primeiro acesso.":""}
${a.mobile?`
 APP GAROM:
- Mesmo usurio e senha
- Limite: ${a.mobile.deviceLimit} dispositivos`:""}
${a.firstAccessToken?`
 Token de primeiro acesso: ${a.firstAccessToken}`:""}
${a.passwordExpiry?`
 Senha expira em: ${a.passwordExpiry.toLocaleDateString("pt-BR")}`:""}

---
Entregue estas informaes ao funcionrio de forma segura.
    `.trim();return e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:s}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{className:"relative w-full max-w-md bg-white rounded-lg shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Credenciais Geradas"}),e.jsx("p",{className:"text-sm text-gray-600",children:r})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx(lt,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ts,{className:"h-5 w-5 text-green-600"}),e.jsx("p",{className:"text-green-800 font-medium",children:"Funcionrio cadastrado com sucesso!"})]})}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Ys,{className:"h-4 w-4 text-gray-600"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Acesso ao Sistema"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Email:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-mono text-sm",children:a.system.email}),e.jsx("button",{onClick:()=>h(a.system.email,"email"),className:"text-gray-400 hover:text-gray-600",children:e.jsx(La,{className:"h-3 w-3"})})]})]}),a.system.username&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Usurio:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-mono text-sm",children:a.system.username}),e.jsx("button",{onClick:()=>h(a.system.username,"username"),className:"text-gray-400 hover:text-gray-600",children:e.jsx(La,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Senha:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-mono text-sm",children:o?a.system.password:""}),e.jsx("button",{onClick:()=>l(!o),className:"text-gray-400 hover:text-gray-600",children:o?e.jsx(fn,{className:"h-3 w-3"}):e.jsx(Ws,{className:"h-3 w-3"})}),e.jsx("button",{onClick:()=>h(a.system.password,"password"),className:"text-gray-400 hover:text-gray-600",children:e.jsx(La,{className:"h-3 w-3"})})]})]})]})]}),a.mobile&&e.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(io,{className:"h-4 w-4 text-indigo-600"}),e.jsx("h3",{className:"font-medium text-indigo-900",children:"App Garom"})]}),e.jsxs("div",{className:"text-sm text-indigo-700",children:[e.jsx("p",{children:" Mesmo usurio e senha funcionam no app mobile"}),e.jsxs("p",{children:[" Limite: ",a.mobile.deviceLimit," dispositivos simultneos"]}),e.jsx("p",{children:" Sincronizao automtica com o sistema"})]})]}),a.system.temporaryPassword!==!1&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(mt,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-yellow-900",children:"Senha Temporria"}),e.jsxs("p",{className:"text-yellow-700",children:["O funcionrio deve alterar esta senha no primeiro acesso.",a.passwordExpiry&&e.jsxs("span",{className:"block mt-1",children:["Expira em: ",a.passwordExpiry.toLocaleDateString("pt-BR")]})]})]})]})}),a.firstAccessToken&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Token de Primeiro Acesso"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Para validao adicional"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-mono text-lg font-bold text-blue-900",children:a.firstAccessToken}),e.jsx("button",{onClick:()=>h(a.firstAccessToken,"token"),className:"text-blue-400 hover:text-blue-600",children:e.jsx(La,{className:"h-3 w-3"})})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200",children:[e.jsxs("button",{onClick:()=>h(f(),"all"),className:`flex items-center space-x-2 px-4 py-2 rounded-md transition-colors ${c==="all"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(La,{className:"h-4 w-4"}),e.jsx("span",{children:c==="all"?"Copiado!":"Copiar Tudo"})]}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Fechar"})]})]})})]})},yz=()=>{const[t,s]=y.useState(!1),[a,r]=y.useState(null),o=y.useCallback(async c=>{console.log(" DADOS RECEBIDOS no hook:"),console.log("  - nome_completo:",c.nome_completo),console.log("  - email:",c.email),console.log("  - telefone:",c.telefone),console.log("  - cpf:",c.cpf),console.log("  - bar_role:",c.bar_role),console.log("  - cargo:",c.cargo);try{s(!0),r(null),console.log(" Verificando autenticao...");const u=await Ac();if(!u.success)throw console.error(" Falha na autenticao:",u.error),new Error(`Falha na autenticao: ${u.error}`);console.log(" Autenticao OK"),console.log(" Tentando obter empresa_id...");let h;try{const S=await bt();if(!S)throw new Error("Usurio no est associado a nenhuma empresa");h=S,console.log(" Empresa ID obtido:",h)}catch(S){throw console.error(" Erro ao obter empresa_id:",S),new Error("No foi possvel obter o ID da empresa do usurio logado")}if(!h)throw new Error("No foi possvel obter o ID da empresa");console.log(" Buscando department e position...");const{data:f,error:p}=await V.from("departments").select("id").eq("is_active",!0).limit(1).single();if(p||!f)throw new Error("Nenhum departamento ativo encontrado. Configure um departamento antes de criar funcionrios.");const g=f.id;console.log(" Department encontrado:",g);const{data:v,error:b}=await V.from("positions").select("id").eq("is_active",!0).limit(1).single();if(b||!v)throw new Error("Nenhum cargo ativo encontrado. Configure um cargo antes de criar funcionrios.");const _=v.id;console.log(" Position encontrado:",_),console.log(" Department/Position:",{departmentId:g,positionId:_});const w={employee_code:`EMP-${Date.now()}`,name:c.nome_completo,hire_date:new Date().toISOString().split("T")[0],status:"active",empresa_id:h,position_id:_,department_id:g};c.email&&(w.email=c.email),c.telefone&&(w.phone=c.telefone),c.cpf&&(w.cpf=c.cpf),console.log(" Criando employee:",{code:w.employee_code,name:w.name,email:w.email,position_id:_,department_id:g});const{data:E,error:T}=await V.from("employees").insert(w).select("id").single();if(T)throw console.error(" Erro ao criar employee:",T),new Error(`Erro ao criar funcionrio: ${T.message}`);if(!E)throw new Error("Funcionrio criado mas ID no retornado");console.log(" Employee criado:",E.id),console.log(" Criaando bar_employee...");const N={employee_id:E.id,bar_role:c.bar_role,shift_preference:"qualquer",is_active:!0,start_date:new Date().toISOString().split("T")[0],notes:c.observacoes||"",empresa_id:h},{error:k}=await V.from("bar_employees").insert(N);if(k)throw console.error(" Erro ao criar bar_employee:",k),await V.from("employees").delete().eq("id",E.id),new Error(`Erro ao criar registro do bar: ${k.message}`);return console.log(" Funcionrio criado:",{id:E.id,nome:c.nome_completo,role:c.bar_role}),{success:!0,employeeId:E.id,message:"Funcionrio criado com sucesso!"}}catch(u){const h=u instanceof Error?u.message:"Erro ao criar funcionrio";return r(h),console.error(" ERRO COMPLETO ao criar funcionrio bsico:",{error:u,message:h,stack:u instanceof Error?u.stack:"No stack"}),{success:!1,error:h}}finally{s(!1)}},[]),l=y.useCallback(async(c,u,h)=>{var f;try{if(s(!0),r(null),!h.tem_acesso_sistema)return{success:!0,message:"Funcionrio configurado sem acesso ao sistema"};const p=await bt();if(!p)throw new Error("No foi possvel obter o ID da empresa");const{data:g,error:v}=await V.from("employees").select("name, email").eq("id",c).single();if(v||!g)throw new Error("Funcionrio no encontrado");const{data:{session:b}}=await V.auth.getSession();console.log(" Verificando se usurio j existe:",u);const _="123456";let w;const{data:E,error:T}=await V.auth.signUp({email:u,password:_,options:{emailRedirectTo:void 0}});if(T)if(T.message.includes("User already registered")||T.message.includes("already registered")){console.log(" Usurio j existe no Auth"),console.log(" Buscando user_id no Auth para:",u);const{data:F,error:I}=await V.rpc("get_auth_user_id_by_email",{p_email:u});if(I)throw console.error(" Erro ao buscar user_id:",I),new Error(`Erro ao buscar usurio existente: ${I.message}`);if(F)w=F,console.log(" User ID encontrado no Auth:",w);else throw new Error(`Usurio ${u} j existe mas no foi possvel obter o ID. Entre em contato com o suporte.`)}else throw new Error(`Erro ao criar usurio no Auth: ${T.message}`);else{if(!((f=E.user)!=null&&f.id))throw new Error("Falha ao obter ID do usurio criado");w=E.user.id,console.log(" Novo usurio criado no Auth:",w)}b&&(await V.auth.setSession({access_token:b.access_token,refresh_token:b.refresh_token}),console.log(" Sesso original restaurada")),console.log(" Atualizando profile_id no employee...");const{data:N,error:k}=await V.from("employees").update({profile_id:w,tem_acesso_sistema:!0}).eq("id",c).select("id, profile_id");if(k)throw console.error(" ERRO ao atualizar profile_id:",k),new Error(`Falha ao vincular usurio ao funcionrio: ${k.message}`);if(!N||N.length===0){console.error(" Nenhuma linha atualizada. Verificando se o employee existe...");const{data:F}=await V.from("employees").select("id, empresa_id").eq("id",c).single();throw F?F.empresa_id!==p?new Error("Funcionrio pertence a outra empresa"):new Error("Falha ao atualizar profile_id - verifique as permisses RLS"):new Error("Funcionrio no encontrado")}console.log(" Profile_id atualizado:",N[0].profile_id),console.log(" Verificando se usuario_empresa j existe...");const{data:S}=await V.from("usuarios_empresa").select("id, status").eq("user_id",w).eq("empresa_id",p).maybeSingle();let C;if(S)if(console.log(" Usuario empresa j existe, usando existente:",S.id),S.status!=="ativo"){const{data:F,error:I}=await V.from("usuarios_empresa").update({status:"ativo",ativo:!0,tem_acesso_sistema:!0,nome_completo:g.name,email:g.email}).eq("id",S.id).select("id").single();if(I)throw new Error(`Erro ao reativar usuario_empresa: ${I.message}`);C=F}else C=S;else{console.log(" Criando novo usuario_empresa...");const F={user_id:w,empresa_id:p,nome_completo:g.name,email:g.email,tipo_usuario:"funcionario",cargo:"Funcionrio",status:"ativo",ativo:!0,tem_acesso_sistema:!0};console.log(" Dados do usuario_empresa:",F);const{data:I,error:J}=await V.from("usuarios_empresa").insert(F).select("id, user_id, tem_acesso_sistema").single();if(J)throw console.error(" ERRO ao criar usuario_empresa:",J),new Error(`Erro ao criar usuario_empresa: ${J.message}`);if(!I||!I.id)throw new Error("Usuario_empresa criado mas ID no retornado");console.log(" Usuario_empresa criado com sucesso:",I),C=I}console.log(" Verificando vnculo completo...");const{data:M,error:z}=await V.from("usuarios_empresa").select("id, user_id, tem_acesso_sistema").eq("id",C.id).single();if(z||!M)throw console.error(" Falha na verificao do vnculo:",z),new Error("Vnculo criado mas no pode ser verificado");console.log(" Vnculo verificado:",M),console.log(" Verificando permisses existentes...");const{data:A}=await V.from("permissoes_usuario").select("modulo").eq("usuario_empresa_id",C.id),$=(A==null?void 0:A.map(F=>F.modulo))||[],P=Object.entries(h.permissoes_modulos).filter(([F])=>!$.includes(F)).map(([F,I])=>({usuario_empresa_id:C.id,modulo:F,permissoes:I}));if(P.length>0){console.log(` Criando ${P.length} novas permisses...`);const{error:F}=await V.from("permissoes_usuario").insert(P);if(F)throw new Error(`Erro ao criar permisses: ${F.message}`)}else console.log(" Todas as permisses j existem");return console.log(" Credenciais criadas com sucesso:",{userId:w,email:u,permissionsCount:P.length}),console.log(" VERIFICAO FINAL COMPLETA:"),console.log("   Employee ID:",c),console.log("   Profile ID:",w),console.log("   Usuario Empresa ID:",C.id),console.log("   Tem Acesso Sistema:",!0),console.log("   Permisses:",P.length+$.length),{success:!0,credentials:{email:u,senha_temporaria:_,deve_alterar_senha:!0},message:"Credenciais criadas com sucesso!",details:{employeeId:c,userId:w,usuarioEmpresaId:C.id}}}catch(p){const g=p instanceof Error?p.message:"Erro ao criar credenciais";return r(g),console.error(" Erro ao criar credenciais:",p),{success:!1,error:g}}finally{s(!1)}},[]);return{createBasicEmployee:o,addCredentialsToEmployee:l,loading:t,error:a,clearError:()=>r(null)}},bz=({isOpen:t,onClose:s,employeeName:a,onCreateCredentials:r})=>t?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:s}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-md sm:w-full",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx(mt,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Funcionrio sem credenciais"}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["O funcionrio ",e.jsx("strong",{children:a})," no possui credenciais de acesso ao sistema."]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Para configurar permisses especficas,  necessrio primeiro criar as credenciais de acesso."})]})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsxs("button",{onClick:r,className:"w-full inline-flex justify-center items-center space-x-2 rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:[e.jsx(jr,{className:"h-4 w-4"}),e.jsx("span",{children:"Criar Credenciais"})]}),e.jsx("button",{onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancelar"})]})]})]})}):null,bu=[{id:"dashboard",nome:"Dashboard",descricao:"Viso geral do sistema",categoria:"Principal",icone:""},{id:"gestao_caixa",nome:"Gesto de Caixa",descricao:"Operaes de caixa e pagamentos",categoria:"Financeiro",icone:""},{id:"atendimento_bar",nome:"Atendimento Bar",descricao:"Atendimento e pedidos do bar",categoria:"Operacional",icone:""},{id:"monitor_bar",nome:"Monitor Bar",descricao:"Monitoramento do bar",categoria:"Operacional",icone:""},{id:"monitor_cozinha",nome:"Monitor Cozinha",descricao:"Monitoramento da cozinha",categoria:"Operacional",icone:""},{id:"clientes",nome:"Clientes",descricao:"Gesto de clientes",categoria:"Gesto",icone:""},{id:"funcionarios",nome:"Funcionrios",descricao:"Gesto de funcionrios",categoria:"Gesto",icone:""},{id:"relatorios",nome:"Relatrios",descricao:"Relatrios e anlises",categoria:"Anlise",icone:""},{id:"configuracoes",nome:"Configuraes",descricao:"Configuraes do sistema",categoria:"Sistema",icone:""}],$j={operador_caixa:{nome:"Operador de Caixa",descricao:"Apenas gesto de caixa",modulos:["gestao_caixa"],permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},atendente_bar:{nome:"Atendente de Bar",descricao:"Atendimento e monitoramento do bar",modulos:["atendimento_bar","monitor_bar"],permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},cozinheiro:{nome:"Cozinheiro",descricao:"Monitoramento da cozinha",modulos:["monitor_cozinha"],permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},gerente:{nome:"Gerente",descricao:"Acesso completo exceto configuraes",modulos:["dashboard","gestao_caixa","atendimento_bar","monitor_bar","monitor_cozinha","clientes","funcionarios","relatorios"],permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}}},vz=({isOpen:t,onClose:s,employeeId:a,employeeName:r,onSave:o,onCreateCredentials:l})=>{const[c,u]=y.useState({}),[h,f]=y.useState(!1),[p,g]=y.useState(!1),[v,b]=y.useState(null),[_,w]=y.useState(!1),[E,T]=y.useState(!0);y.useEffect(()=>{t&&a&&N()},[t,a]);const N=async()=>{var $;try{g(!0),console.log(" Carregando permisses para employeeId:",a),console.log(" Buscando employee e suas credenciais...");const{data:P,error:F}=await V.from("employees").select("id, name, email, profile_id, tem_acesso_sistema").eq("id",a).single();if(F||!P){console.error(" Erro ao buscar employee:",F),T(!1),w(!0);return}if(console.log(" Employee encontrado:",P),!P.profile_id||!P.tem_acesso_sistema){console.log(" Employee sem credenciais:",{profile_id:P.profile_id,tem_acesso_sistema:P.tem_acesso_sistema}),T(!1),w(!0);return}const{data:I,error:J}=await V.from("usuarios_empresa").select("id, user_id, nome_completo, tem_acesso_sistema, status, email").eq("user_id",P.profile_id).maybeSingle();if(console.log(" DEBUG - Resultado da query:",{employeeId:a,data:I,error:J,bypass_usado:a==="95886a5e-893c-4889-85a0-8989d48d19fd"}),console.log(" DEBUG - Dados recebidos:",I),J){if(console.error(" Erro ao buscar usuario_empresa:",J),console.error(" Detalhes do erro:",{message:J.message,code:J.code,details:J.details,hint:J.hint}),J.code==="42501"||($=J.message)!=null&&$.includes("406")){console.error(" Erro de RLS detectado - usurio pode no ter permisso para ver este registro"),T(!1),w(!0);return}return}if(console.log(" DEBUG - Verificando existncia:",!!I),!I){console.warn(" DEBUG - Usuario empresa no encontrado para ID:",a),console.warn(" DEBUG - Isso pode indicar que o usurio no tem permisso para ver este registro devido ao RLS"),T(!1),w(!0);return}if(console.log(" Usuario empresa encontrado:",I),console.log(" DEBUG - Verificando status:",I==null?void 0:I.status),I.status!=="ativo"){console.log(" DEBUG - Usurio no est ativo:",I.status),T(!1),w(!0);return}if(console.log(" DEBUG - Verificando credenciais:",{user_id:I==null?void 0:I.user_id,tem_acesso_sistema:I==null?void 0:I.tem_acesso_sistema,user_id_exists:!!(I!=null&&I.user_id),tem_acesso_true:(I==null?void 0:I.tem_acesso_sistema)===!0}),!I.user_id||!I.tem_acesso_sistema){console.log(" DEBUG - Usurio sem credenciais - DETALHES:",{user_id:I.user_id,user_id_type:typeof I.user_id,user_id_null:I.user_id===null,user_id_undefined:I.user_id===void 0,tem_acesso_sistema:I.tem_acesso_sistema,tem_acesso_type:typeof I.tem_acesso_sistema,tem_acesso_false:I.tem_acesso_sistema===!1,condition1:!I.user_id,condition2:!I.tem_acesso_sistema,final_condition:!I.user_id||!I.tem_acesso_sistema}),T(!1),w(!0);return}console.log(" Usurio tem credenciais vlidas"),T(!0),b(I.id);const{data:pe,error:te}=await V.from("permissoes_usuario").select("modulo, permissoes").eq("usuario_empresa_id",I.id);if(te){console.warn("Erro ao buscar permisses:",te);return}const L={};pe&&pe.forEach(G=>{L[G.modulo]=G.permissoes}),u(L),console.log(" Permisses carregadas:",L)}catch(P){console.error("Erro ao carregar permisses:",P)}finally{g(!1)}},k=($,P,F)=>{u(I=>({...I,[$]:{...I[$]||{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},[P]:F}}))},S=$=>{const P=$j[$],F={};bu.forEach(I=>{F[I.id]={visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1}}),P.modulos.forEach(I=>{F[I]={...P.permissoes}}),u(F)},C=()=>{const $={};bu.forEach(P=>{$[P.id]={visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1}}),u($)},M=async()=>{if(!v){alert("Erro: Usuario empresa no encontrado");return}try{f(!0);const $=[];Object.entries(c).forEach(([P,F])=>{(F.visualizar||F.criar||F.editar||F.excluir||F.administrar)&&$.push({usuario_empresa_id:v,modulo:P,permissoes:F})}),console.log(" Salvando permisses:",$),await o($),s()}catch($){console.error("Erro ao salvar permisses:",$),alert("Erro ao salvar permisses. Tente novamente.")}finally{f(!1)}},z=()=>{u({}),b(null),s()};if(!t)return null;const A=Object.entries(c).filter(([$,P])=>P.visualizar||P.criar||P.editar||P.excluir||P.administrar).length;return e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:z}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[e.jsxs("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Li,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Gerenciar Permisses"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Funcionrio: ",r]})]})]}),e.jsx("button",{onClick:z,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(lt,{className:"h-6 w-6"})})]}),p?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(_a,{className:"h-6 w-6 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Carregando permisses..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Presets Rpidos:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Object.entries($j).map(([$,P])=>e.jsx("button",{onClick:()=>S($),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded-full hover:bg-blue-200 transition-colors",children:P.nome},$)),e.jsx("button",{onClick:C,className:"px-3 py-1 text-xs bg-red-100 text-red-700 rounded-full hover:bg-red-200 transition-colors",children:"Limpar Tudo"})]})]}),e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Mdulos configurados:"})," ",A," de ",bu.length]}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"O usurio ver apenas os mdulos com pelo menos uma permisso marcada"})]}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:bu.map($=>{const P=c[$.id]||{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},F=Object.values(P).some(I=>I);return e.jsxs("div",{className:`border rounded-lg p-4 ${F?"border-blue-200 bg-blue-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-lg",children:$.icone}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900",children:$.nome}),e.jsx("p",{className:"text-xs text-gray-500",children:$.descricao})]})]}),e.jsx("span",{className:"text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded",children:$.categoria})]}),e.jsx("div",{className:"grid grid-cols-5 gap-3",children:[{key:"visualizar",label:"Ver",icon:Ws},{key:"criar",label:"Criar",icon:null},{key:"editar",label:"Editar",icon:null},{key:"excluir",label:"Excluir",icon:null},{key:"administrar",label:"Admin",icon:Li}].map(({key:I,label:J,icon:pe})=>e.jsxs("label",{className:"flex items-center space-x-1 text-xs",children:[e.jsx("input",{type:"checkbox",checked:P[I],onChange:te=>k($.id,I,te.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),pe&&e.jsx(pe,{className:"h-3 w-3"}),e.jsx("span",{children:J})]},I))})]},$.id)})})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsxs("button",{onClick:M,disabled:h||p,className:"w-full inline-flex justify-center items-center space-x-2 rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(oo,{className:"h-4 w-4"}),e.jsx("span",{children:h?"Salvando...":"Salvar Permisses"})]}),e.jsx("button",{onClick:z,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancelar"})]})]})]}),e.jsx(bz,{isOpen:_,onClose:()=>{w(!1),s()},employeeName:r,onCreateCredentials:()=>{w(!1),s(),l&&l()}})]})},wz=()=>{var Ge,Je,rs,Ue;const{loading:t,error:s,updateEmployee:a,deactivateEmployee:r,reactivateEmployee:o,filterEmployees:l,getStats:c,refetch:u}=V8(),{createEmployeeWithDefaultPermissions:h}=q8(),{createBasicEmployee:f,addCredentialsToEmployee:p}=yz(),{saveEmployeePermissions:g}=Ng(),[v,b]=y.useState(""),[_,w]=y.useState("all"),[E,T]=y.useState("all"),[N,k]=y.useState(null),[S,C]=y.useState(!1),[M,z]=y.useState(!1),[A,$]=y.useState(!1),[P,F]=y.useState(!1),[I,J]=y.useState(!1),[pe,te]=y.useState(!1),[L,G]=y.useState(!1),[ee,xe]=y.useState(null),[O,H]=y.useState(""),[B,Y]=y.useState(null),[ne,ie]=y.useState(!1),[oe,me]=y.useState(null),D=l(v,_,E),q=c(),Q=W=>{const re={waiter:"garcom",cook:"cozinheiro",cashier:"atendente",supervisor:"gerente",manager:"gerente",admin:"gerente"};return{name:W.name,cpf:W.cpf,email:W.email,phone:W.phone,bar_role:re[W.role]||"atendente",shift_preference:"qualquer",specialties:[],commission_rate:0,notes:W.observations||""}},K=W=>{var Ee,Le,rt,Lt,Ta,Or;const re={garcom:"waiter",cozinheiro:"cook",atendente:"cashier",barman:"cashier",gerente:"manager"};return{id:W.id,name:((Ee=W.employee)==null?void 0:Ee.name)||"",email:((Le=W.employee)==null?void 0:Le.email)||"",cpf:((rt=W.employee)==null?void 0:rt.cpf)||"",phone:((Lt=W.employee)==null?void 0:Lt.phone)||"",role:re[W.bar_role]||"waiter",permissions:((Ta=co[re[W.bar_role]||"waiter"])==null?void 0:Ta.permissions)||[],status:W.status==="active"?"active":"inactive",hire_date:(Or=W.employee)!=null&&Or.hire_date?new Date(W.employee.hire_date):new Date,observations:W.notes||""}},he=W=>({waiter:"garcom",cook:"cozinheiro",cashier:"atendente",supervisor:"barman",manager:"gerente",admin:"gerente"})[W]||"garcom",we=async W=>{console.log(" Iniciando criao de funcionrio bsico:",W);try{const re=await f(W);if(console.log(" Resultado da criao:",re),re.success)console.log(" Funcionrio criado com sucesso:",re),console.log(" Processo concludo, recarregando lista"),setTimeout(()=>{alert("Funcionrio criado com sucesso! Agora voc pode criar as credenciais de acesso."),u()},500);else throw console.error(" Erro na criao:",re.error),new Error(re.error)}catch(re){console.error(" Erro ao criar funcionrio bsico:",re),setTimeout(()=>{alert(`Erro ao criar funcionrio: ${re instanceof Error?re.message:"Erro desconhecido"}`)},100)}},_e=W=>{Y(W),F(!0)},Re=W=>{me(W),ie(!0)},ze=async W=>{if(B!=null&&B.employee)try{const re=await p(B.id,B.employee.email||"",W);if(re.success&&re.credentials)xe({system:{email:re.credentials.email,password:re.credentials.senha_temporaria,temporaryPassword:re.credentials.deve_alterar_senha,username:re.credentials.email.split("@")[0]}}),H(B.employee.name),G(!0),setTimeout(()=>u(),2e3);else throw new Error(re.error)}catch(re){console.error("Erro ao criar credenciais:",re),alert("Erro ao criar credenciais. Tente novamente.")}},Ie=async W=>{var re;if((re=oe==null?void 0:oe.employee)!=null&&re.id)try{const Ee=await g(oe.employee.id,W);if(Ee.success)alert("Permisses salvas com sucesso!"),ie(!1),me(null),u();else throw new Error(Ee.error)}catch(Ee){console.error("Erro ao salvar permisses:",Ee),alert("Erro ao salvar permisses. Tente novamente.")}},Me=async(W,re)=>{te(!0);try{console.log(" Criando funcionrio com fluxo completo:",W.name);const Ee=await h({nome_completo:W.name,email:W.email,telefone:W.phone,cpf:W.cpf,bar_role:he(W.role),shift_preference:"qualquer",specialties:[],commission_rate:0,observacoes:W.observations,tem_acesso_sistema:!!re});if(Ee.success)console.log(" Funcionrio criado com sucesso:",Ee),Ee.credentials?(xe({system:{email:Ee.credentials.email,password:Ee.credentials.senha_temporaria,temporaryPassword:Ee.credentials.deve_alterar_senha,username:Ee.credentials.email.split("@")[0]}}),H(W.name),G(!0),console.log(" Credenciais geradas:",{email:Ee.credentials.email,senha:"[OCULTA]",temporaria:Ee.credentials.deve_alterar_senha})):alert("Funcionrio cadastrado com sucesso!"),setTimeout(()=>{u()},1e3);else throw new Error(Ee.error||"Erro ao criar funcionrio")}catch(Ee){throw console.error(" Erro ao criar funcionrio:",Ee),Ee}finally{te(!1)}},$e=W=>{k(W),J(!0)},Z=async(W,re)=>{if(!N)return;const Ee=Q(W);te(!0);try{await a(N.id,Ee),k(null),alert("Funcionrio atualizado com sucesso!")}catch(Le){throw console.error("Erro ao atualizar funcionrio:",Le),Le}finally{te(!1)}},se=async W=>{var Ee;if(confirm(`Tem certeza que deseja desativar o funcionrio ${(Ee=W.employee)==null?void 0:Ee.name}?`))try{await r(W.id),alert("Funcionrio desativado com sucesso!")}catch(Le){console.error("Erro ao desativar funcionrio:",Le),alert("Erro ao desativar funcionrio. Tente novamente.")}},de=async W=>{var Ee;if(confirm(`Tem certeza que deseja reativar o funcionrio ${(Ee=W.employee)==null?void 0:Ee.name}?`))try{await o(W.id),alert("Funcionrio reativado com sucesso!")}catch(Le){console.error("Erro ao reativar funcionrio:",Le),alert("Erro ao reativar funcionrio. Tente novamente.")}},Ce=W=>{k(W),C(!0)},ke=W=>{if(!W)return"No informado";const re=W.replace(/\D/g,"");return re.length===11?`(${re.slice(0,2)}) ${re.slice(2,7)}-${re.slice(7)}`:W},ye=W=>{switch(W){case"atendente":return"";case"garcom":return"";case"cozinheiro":return"";case"barman":return"";case"gerente":return"";default:return""}},Te=W=>{switch(W){case"atendente":return"bg-blue-100 text-blue-800";case"garcom":return"bg-green-100 text-green-800";case"cozinheiro":return"bg-orange-100 text-orange-800";case"barman":return"bg-purple-100 text-purple-800";case"gerente":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Oe=W=>{switch(W){case"atendente":return"Atendente";case"garcom":return"Garom";case"cozinheiro":return"Cozinheiro";case"barman":return"Barman";case"gerente":return"Gerente";default:return W}};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(xz,{}),s&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"text-red-600",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("p",{className:"text-red-800",children:s})]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Funcionrios do Bar"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gerencie a equipe do bar e suas funes"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>$(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx(Zs,{size:20}),e.jsx("span",{children:"Novo Funcionrio"})]}),e.jsxs("button",{onClick:()=>z(!0),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center space-x-2 text-sm",children:[e.jsx(Zs,{size:16}),e.jsx("span",{children:"Fluxo Antigo"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:q.total}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total"})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:q.active}),e.jsx("div",{className:"text-sm text-gray-600",children:"Ativos"})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-blue-600",children:[" ",q.byRole.atendente]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Atendentes"})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-green-600",children:[" ",q.byRole.garcom]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Garons"})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-orange-600",children:[" ",q.byRole.cozinheiro]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Cozinheiros"})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-purple-600",children:[" ",q.byRole.barman]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Barmans"})]})})]}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Ka,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Buscar por nome, telefone ou email...",value:v,onChange:W=>b(W.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("select",{value:_,onChange:W=>w(W.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todas as Funes"}),e.jsx("option",{value:"atendente",children:"Atendente"}),e.jsx("option",{value:"garcom",children:"Garom"}),e.jsx("option",{value:"cozinheiro",children:"Cozinheiro"}),e.jsx("option",{value:"barman",children:"Barman"}),e.jsx("option",{value:"gerente",children:"Gerente"})]}),e.jsxs("select",{value:E,onChange:W=>T(W.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"active",children:"Ativo"}),e.jsx("option",{value:"inactive",children:"Inativo"})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:t?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Carregando funcionrios..."})]}):D.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Ys,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Nenhum funcionrio encontrado"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Funcionrio"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Funo no Bar"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contato"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data de Contratao"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:D.map(W=>{var Ee;const re=W.employee;return re?e.jsxs(be.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-blue-600",children:re.name.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:re.name}),e.jsx("div",{className:"text-sm text-gray-500",children:re.cpf||((Ee=W.employee)==null?void 0:Ee.cpf)||"CPF no informado"})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Te(W.bar_role)}`,children:[e.jsx("span",{className:"mr-1",children:ye(W.bar_role)}),Oe(W.bar_role)]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:ke(re.phone||null)}),e.jsx("div",{className:"text-sm text-gray-500",children:re.email||"Email no informado"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${W.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:W.status==="active"?"Ativo":"Inativo"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:re.hire_date?new Date(re.hire_date).toLocaleDateString("pt-BR"):"No informado"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>Ce(W),className:"text-blue-600 hover:text-blue-900",title:"Ver detalhes",children:e.jsx(Ws,{size:16})}),e.jsx("button",{onClick:()=>$e(W),className:"text-gray-600 hover:text-gray-900",title:"Editar funcionrio",children:e.jsx(lo,{size:16})}),e.jsx("button",{onClick:()=>_e(W),className:"text-green-600 hover:text-green-900",title:"Criar credenciais de acesso",children:e.jsx(YN,{size:16})}),e.jsx("button",{onClick:()=>Re(W),className:"text-purple-600 hover:text-purple-900",title:"Gerenciar permisses",children:e.jsx(Li,{size:16})}),W.status==="active"?e.jsx("button",{onClick:()=>se(W),className:"text-red-600 hover:text-red-900",title:"Desativar funcionrio",children:e.jsx(Fc,{size:16})}):e.jsx("button",{onClick:()=>de(W),className:"text-green-600 hover:text-green-900",title:"Reativar funcionrio",children:e.jsx(Ys,{size:16})})]})})]},W.id):null})})]})})}),S&&N&&N.employee&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Detalhes do Funcionrio"}),e.jsx("button",{onClick:()=>C(!1),className:"text-gray-500 hover:text-gray-700",children:""})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nome"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:N.employee.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Funo no Bar"}),e.jsx("p",{className:"mt-1",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Te(N.bar_role)}`,children:[e.jsx("span",{className:"mr-1",children:ye(N.bar_role)}),Oe(N.bar_role)]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Telefone"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:ke(((Ge=N.employee)==null?void 0:Ge.phone)||null)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:N.employee.email||"No informado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CPF"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:N.employee.cpf||"No informado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsx("p",{className:"mt-1",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${N.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:N.status==="active"?"Ativo":"Inativo"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Data de Contratao"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:N.employee.hire_date?new Date(N.employee.hire_date).toLocaleDateString("pt-BR"):"No informado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cadastrado no Bar em"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(N.created_at).toLocaleDateString("pt-BR")})]})]}),N.notes&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Observaes"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:N.notes})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>C(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"Fechar"})})]})}),e.jsx(fz,{isOpen:M,onClose:()=>z(!1),onSave:Me,mode:"create"}),e.jsx(hz,{isOpen:I,onClose:()=>J(!1),onSave:W=>Z(W),employee:N?K(N):void 0,mode:"edit"}),ee&&e.jsx(E2,{isOpen:L,onClose:()=>{G(!1),xe(null),H("")},credentials:ee,employeeName:O}),e.jsx(pz,{isOpen:A,onClose:()=>$(!1),onSave:we}),e.jsx(gz,{isOpen:P,onClose:()=>{F(!1),Y(null)},onSave:ze,employeeName:((Je=B==null?void 0:B.employee)==null?void 0:Je.name)||"",employeeRole:(B==null?void 0:B.bar_role)||""}),e.jsx(vz,{isOpen:ne,onClose:()=>{ie(!1),me(null)},employeeId:((rs=oe==null?void 0:oe.employee)==null?void 0:rs.id)||"",employeeName:((Ue=oe==null?void 0:oe.employee)==null?void 0:Ue.name)||"",onSave:Ie,onCreateCredentials:()=>{ie(!1),Y(oe),me(null),F(!0)}})]})},jz=({onOrderUpdate:t,empresaId:s})=>{const a=y.useCallback(r=>{console.log(" REALTIME MONITOR COZINHA:",r.eventType,r.table),(r.eventType==="INSERT"||r.eventType==="UPDATE")&&(console.log(" Atualizando Monitor Cozinha..."),t())},[t]);y.useEffect(()=>{console.log(" Conectando realtime do Monitor Cozinha...");const r=V.channel("kitchen-monitor-realtime").on("postgres_changes",{event:"*",schema:"public",table:"balcao_orders",filter:s?`empresa_id=eq.${s}`:void 0},o=>{var l,c;console.log(" REALTIME COZINHA - balcao_orders:",o.eventType),o.eventType==="UPDATE"&&((l=o.old)==null?void 0:l.status)==="pending_payment"&&((c=o.new)==null?void 0:c.status)==="paid"&&console.log(" PEDIDO PAGO! Atualizando Monitor Cozinha..."),a(o)}).on("postgres_changes",{event:"*",schema:"public",table:"balcao_order_items"},o=>{console.log(" REALTIME COZINHA - balcao_order_items:",o.eventType),a(o)}).on("postgres_changes",{event:"*",schema:"public",table:"comandas"},o=>{console.log(" REALTIME COZINHA - comandas:",o.eventType),a(o)}).on("postgres_changes",{event:"*",schema:"public",table:"comanda_items"},o=>{console.log(" REALTIME COZINHA - comanda_items:",o.eventType),a(o)}).subscribe(o=>{o==="SUBSCRIBED"?console.log(" Realtime do Monitor Cozinha ativo!"):o==="CHANNEL_ERROR"&&console.error(" Erro no realtime do Monitor Cozinha")});return()=>{console.log(" Desconectando realtime do Monitor Cozinha"),r.unsubscribe()}},[a,s])};var Hc=t=>t.type==="checkbox",to=t=>t instanceof Date,ks=t=>t==null;const C2=t=>typeof t=="object";var Yt=t=>!ks(t)&&!Array.isArray(t)&&C2(t)&&!to(t),k2=t=>Yt(t)&&t.target?Hc(t.target)?t.target.checked:t.target.value:t,_z=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,T2=(t,s)=>t.has(_z(s)),Nz=t=>{const s=t.constructor&&t.constructor.prototype;return Yt(s)&&s.hasOwnProperty("isPrototypeOf")},Sg=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function ls(t){let s;const a=Array.isArray(t),r=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)s=new Date(t);else if(!(Sg&&(t instanceof Blob||r))&&(a||Yt(t)))if(s=a?[]:Object.create(Object.getPrototypeOf(t)),!a&&!Nz(t))s=t;else for(const o in t)t.hasOwnProperty(o)&&(s[o]=ls(t[o]));else return t;return s}var _m=t=>/^\w*$/.test(t),Zt=t=>t===void 0,Eg=t=>Array.isArray(t)?t.filter(Boolean):[],Cg=t=>Eg(t.replace(/["|']|\]/g,"").split(/\.|\[/)),De=(t,s,a)=>{if(!s||!Yt(t))return a;const r=(_m(s)?[s]:Cg(s)).reduce((o,l)=>ks(o)?o:o[l],t);return Zt(r)||r===t?Zt(t[s])?a:t[s]:r},Gs=t=>typeof t=="boolean",_t=(t,s,a)=>{let r=-1;const o=_m(s)?[s]:Cg(s),l=o.length,c=l-1;for(;++r<l;){const u=o[r];let h=a;if(r!==c){const f=t[u];h=Yt(f)||Array.isArray(f)?f:isNaN(+o[r+1])?{}:[]}if(u==="__proto__"||u==="constructor"||u==="prototype")return;t[u]=h,t=t[u]}};const tm={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},wa={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},pr={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},A2=Ye.createContext(null);A2.displayName="HookFormContext";const kg=()=>Ye.useContext(A2);var M2=(t,s,a,r=!0)=>{const o={defaultValues:s._defaultValues};for(const l in t)Object.defineProperty(o,l,{get:()=>{const c=l;return s._proxyFormState[c]!==wa.all&&(s._proxyFormState[c]=!r||wa.all),a&&(a[c]=!0),t[c]}});return o};const Tg=typeof window<"u"?Ye.useLayoutEffect:Ye.useEffect;function Sz(t){const s=kg(),{control:a=s.control,disabled:r,name:o,exact:l}=t||{},[c,u]=Ye.useState(a._formState),h=Ye.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return Tg(()=>a._subscribe({name:o,formState:h.current,exact:l,callback:f=>{!r&&u({...a._formState,...f})}}),[o,r,l]),Ye.useEffect(()=>{h.current.isValid&&a._setValid(!0)},[a]),Ye.useMemo(()=>M2(c,a,h.current,!1),[c,a])}var Ba=t=>typeof t=="string",R2=(t,s,a,r,o)=>Ba(t)?(r&&s.watch.add(t),De(a,t,o)):Array.isArray(t)?t.map(l=>(r&&s.watch.add(l),De(a,l))):(r&&(s.watchAll=!0),a),j0=t=>ks(t)||!C2(t);function vr(t,s,a=new WeakSet){if(j0(t)||j0(s))return t===s;if(to(t)&&to(s))return t.getTime()===s.getTime();const r=Object.keys(t),o=Object.keys(s);if(r.length!==o.length)return!1;if(a.has(t)||a.has(s))return!0;a.add(t),a.add(s);for(const l of r){const c=t[l];if(!o.includes(l))return!1;if(l!=="ref"){const u=s[l];if(to(c)&&to(u)||Yt(c)&&Yt(u)||Array.isArray(c)&&Array.isArray(u)?!vr(c,u,a):c!==u)return!1}}return!0}function Ez(t){const s=kg(),{control:a=s.control,name:r,defaultValue:o,disabled:l,exact:c,compute:u}=t||{},h=Ye.useRef(o),f=Ye.useRef(u),p=Ye.useRef(void 0);f.current=u;const g=Ye.useMemo(()=>a._getWatch(r,h.current),[a,r]),[v,b]=Ye.useState(f.current?f.current(g):g);return Tg(()=>a._subscribe({name:r,formState:{values:!0},exact:c,callback:_=>{if(!l){const w=R2(r,a._names,_.values||a._formValues,!1,h.current);if(f.current){const E=f.current(w);vr(E,p.current)||(b(E),p.current=E)}else b(w)}}}),[a,l,r,c]),Ye.useEffect(()=>a._removeUnmounted()),v}function Cz(t){const s=kg(),{name:a,disabled:r,control:o=s.control,shouldUnregister:l,defaultValue:c}=t,u=T2(o._names.array,a),h=Ye.useMemo(()=>De(o._formValues,a,De(o._defaultValues,a,c)),[o,a,c]),f=Ez({control:o,name:a,defaultValue:h,exact:!0}),p=Sz({control:o,name:a,exact:!0}),g=Ye.useRef(t),v=Ye.useRef(o.register(a,{...t.rules,value:f,...Gs(t.disabled)?{disabled:t.disabled}:{}}));g.current=t;const b=Ye.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!De(p.errors,a)},isDirty:{enumerable:!0,get:()=>!!De(p.dirtyFields,a)},isTouched:{enumerable:!0,get:()=>!!De(p.touchedFields,a)},isValidating:{enumerable:!0,get:()=>!!De(p.validatingFields,a)},error:{enumerable:!0,get:()=>De(p.errors,a)}}),[p,a]),_=Ye.useCallback(N=>v.current.onChange({target:{value:k2(N),name:a},type:tm.CHANGE}),[a]),w=Ye.useCallback(()=>v.current.onBlur({target:{value:De(o._formValues,a),name:a},type:tm.BLUR}),[a,o._formValues]),E=Ye.useCallback(N=>{const k=De(o._fields,a);k&&N&&(k._f.ref={focus:()=>N.focus&&N.focus(),select:()=>N.select&&N.select(),setCustomValidity:S=>N.setCustomValidity(S),reportValidity:()=>N.reportValidity()})},[o._fields,a]),T=Ye.useMemo(()=>({name:a,value:f,...Gs(r)||p.disabled?{disabled:p.disabled||r}:{},onChange:_,onBlur:w,ref:E}),[a,r,p.disabled,_,w,E,f]);return Ye.useEffect(()=>{const N=o._options.shouldUnregister||l;o.register(a,{...g.current.rules,...Gs(g.current.disabled)?{disabled:g.current.disabled}:{}});const k=(S,C)=>{const M=De(o._fields,S);M&&M._f&&(M._f.mount=C)};if(k(a,!0),N){const S=ls(De(o._options.defaultValues,a));_t(o._defaultValues,a,S),Zt(De(o._formValues,a))&&_t(o._formValues,a,S)}return!u&&o.register(a),()=>{(u?N&&!o._state.action:N)?o.unregister(a):k(a,!1)}},[a,o,u,l]),Ye.useEffect(()=>{o._setDisabledField({disabled:r,name:a})},[r,a,o]),Ye.useMemo(()=>({field:T,formState:p,fieldState:b}),[T,p,b])}const ro=t=>t.render(Cz(t));var kz=(t,s,a,r,o)=>s?{...a[t],types:{...a[t]&&a[t].types?a[t].types:{},[r]:o||!0}}:{},gc=t=>Array.isArray(t)?t:[t],Lj=()=>{let t=[];return{get observers(){return t},next:o=>{for(const l of t)l.next&&l.next(o)},subscribe:o=>(t.push(o),{unsubscribe:()=>{t=t.filter(l=>l!==o)}}),unsubscribe:()=>{t=[]}}},Ps=t=>Yt(t)&&!Object.keys(t).length,Ag=t=>t.type==="file",ja=t=>typeof t=="function",sm=t=>{if(!Sg)return!1;const s=t?t.ownerDocument:0;return t instanceof(s&&s.defaultView?s.defaultView.HTMLElement:HTMLElement)},O2=t=>t.type==="select-multiple",Mg=t=>t.type==="radio",Tz=t=>Mg(t)||Hc(t),Np=t=>sm(t)&&t.isConnected;function Az(t,s){const a=s.slice(0,-1).length;let r=0;for(;r<a;)t=Zt(t)?r++:t[s[r++]];return t}function Mz(t){for(const s in t)if(t.hasOwnProperty(s)&&!Zt(t[s]))return!1;return!0}function Jt(t,s){const a=Array.isArray(s)?s:_m(s)?[s]:Cg(s),r=a.length===1?t:Az(t,a),o=a.length-1,l=a[o];return r&&delete r[l],o!==0&&(Yt(r)&&Ps(r)||Array.isArray(r)&&Mz(r))&&Jt(t,a.slice(0,-1)),t}var D2=t=>{for(const s in t)if(ja(t[s]))return!0;return!1};function am(t,s={}){const a=Array.isArray(t);if(Yt(t)||a)for(const r in t)Array.isArray(t[r])||Yt(t[r])&&!D2(t[r])?(s[r]=Array.isArray(t[r])?[]:{},am(t[r],s[r])):ks(t[r])||(s[r]=!0);return s}function P2(t,s,a){const r=Array.isArray(t);if(Yt(t)||r)for(const o in t)Array.isArray(t[o])||Yt(t[o])&&!D2(t[o])?Zt(s)||j0(a[o])?a[o]=Array.isArray(t[o])?am(t[o],[]):{...am(t[o])}:P2(t[o],ks(s)?{}:s[o],a[o]):a[o]=!vr(t[o],s[o]);return a}var Xl=(t,s)=>P2(t,s,am(s));const Ij={value:!1,isValid:!1},Uj={value:!0,isValid:!0};var z2=t=>{if(Array.isArray(t)){if(t.length>1){const s=t.filter(a=>a&&a.checked&&!a.disabled).map(a=>a.value);return{value:s,isValid:!!s.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!Zt(t[0].attributes.value)?Zt(t[0].value)||t[0].value===""?Uj:{value:t[0].value,isValid:!0}:Uj:Ij}return Ij},$2=(t,{valueAsNumber:s,valueAsDate:a,setValueAs:r})=>Zt(t)?t:s?t===""?NaN:t&&+t:a&&Ba(t)?new Date(t):r?r(t):t;const Bj={isValid:!1,value:null};var L2=t=>Array.isArray(t)?t.reduce((s,a)=>a&&a.checked&&!a.disabled?{isValid:!0,value:a.value}:s,Bj):Bj;function Vj(t){const s=t.ref;return Ag(s)?s.files:Mg(s)?L2(t.refs).value:O2(s)?[...s.selectedOptions].map(({value:a})=>a):Hc(s)?z2(t.refs).value:$2(Zt(s.value)?t.ref.value:s.value,t)}var Rz=(t,s,a,r)=>{const o={};for(const l of t){const c=De(s,l);c&&_t(o,l,c._f)}return{criteriaMode:a,names:[...t],fields:o,shouldUseNativeValidation:r}},rm=t=>t instanceof RegExp,Ql=t=>Zt(t)?t:rm(t)?t.source:Yt(t)?rm(t.value)?t.value.source:t.value:t,qj=t=>({isOnSubmit:!t||t===wa.onSubmit,isOnBlur:t===wa.onBlur,isOnChange:t===wa.onChange,isOnAll:t===wa.all,isOnTouch:t===wa.onTouched});const Fj="AsyncFunction";var Oz=t=>!!t&&!!t.validate&&!!(ja(t.validate)&&t.validate.constructor.name===Fj||Yt(t.validate)&&Object.values(t.validate).find(s=>s.constructor.name===Fj)),Dz=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),Hj=(t,s,a)=>!a&&(s.watchAll||s.watch.has(t)||[...s.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const xc=(t,s,a,r)=>{for(const o of a||Object.keys(t)){const l=De(t,o);if(l){const{_f:c,...u}=l;if(c){if(c.refs&&c.refs[0]&&s(c.refs[0],o)&&!r)return!0;if(c.ref&&s(c.ref,c.name)&&!r)return!0;if(xc(u,s))break}else if(Yt(u)&&xc(u,s))break}}};function Gj(t,s,a){const r=De(t,a);if(r||_m(a))return{error:r,name:a};const o=a.split(".");for(;o.length;){const l=o.join("."),c=De(s,l),u=De(t,l);if(c&&!Array.isArray(c)&&a!==l)return{name:a};if(u&&u.type)return{name:l,error:u};if(u&&u.root&&u.root.type)return{name:`${l}.root`,error:u.root};o.pop()}return{name:a}}var Pz=(t,s,a,r)=>{a(t);const{name:o,...l}=t;return Ps(l)||Object.keys(l).length>=Object.keys(s).length||Object.keys(l).find(c=>s[c]===(!r||wa.all))},zz=(t,s,a)=>!t||!s||t===s||gc(t).some(r=>r&&(a?r===s:r.startsWith(s)||s.startsWith(r))),$z=(t,s,a,r,o)=>o.isOnAll?!1:!a&&o.isOnTouch?!(s||t):(a?r.isOnBlur:o.isOnBlur)?!t:(a?r.isOnChange:o.isOnChange)?t:!0,Lz=(t,s)=>!Eg(De(t,s)).length&&Jt(t,s),Iz=(t,s,a)=>{const r=gc(De(t,a));return _t(r,"root",s[a]),_t(t,a,r),t},Du=t=>Ba(t);function Zj(t,s,a="validate"){if(Du(t)||Array.isArray(t)&&t.every(Du)||Gs(t)&&!t)return{type:a,message:Du(t)?t:"",ref:s}}var ui=t=>Yt(t)&&!rm(t)?t:{value:t,message:""},Wj=async(t,s,a,r,o,l)=>{const{ref:c,refs:u,required:h,maxLength:f,minLength:p,min:g,max:v,pattern:b,validate:_,name:w,valueAsNumber:E,mount:T}=t._f,N=De(a,w);if(!T||s.has(w))return{};const k=u?u[0]:c,S=I=>{o&&k.reportValidity&&(k.setCustomValidity(Gs(I)?"":I||""),k.reportValidity())},C={},M=Mg(c),z=Hc(c),A=M||z,$=(E||Ag(c))&&Zt(c.value)&&Zt(N)||sm(c)&&c.value===""||N===""||Array.isArray(N)&&!N.length,P=kz.bind(null,w,r,C),F=(I,J,pe,te=pr.maxLength,L=pr.minLength)=>{const G=I?J:pe;C[w]={type:I?te:L,message:G,ref:c,...P(I?te:L,G)}};if(l?!Array.isArray(N)||!N.length:h&&(!A&&($||ks(N))||Gs(N)&&!N||z&&!z2(u).isValid||M&&!L2(u).isValid)){const{value:I,message:J}=Du(h)?{value:!!h,message:h}:ui(h);if(I&&(C[w]={type:pr.required,message:J,ref:k,...P(pr.required,J)},!r))return S(J),C}if(!$&&(!ks(g)||!ks(v))){let I,J;const pe=ui(v),te=ui(g);if(!ks(N)&&!isNaN(N)){const L=c.valueAsNumber||N&&+N;ks(pe.value)||(I=L>pe.value),ks(te.value)||(J=L<te.value)}else{const L=c.valueAsDate||new Date(N),G=O=>new Date(new Date().toDateString()+" "+O),ee=c.type=="time",xe=c.type=="week";Ba(pe.value)&&N&&(I=ee?G(N)>G(pe.value):xe?N>pe.value:L>new Date(pe.value)),Ba(te.value)&&N&&(J=ee?G(N)<G(te.value):xe?N<te.value:L<new Date(te.value))}if((I||J)&&(F(!!I,pe.message,te.message,pr.max,pr.min),!r))return S(C[w].message),C}if((f||p)&&!$&&(Ba(N)||l&&Array.isArray(N))){const I=ui(f),J=ui(p),pe=!ks(I.value)&&N.length>+I.value,te=!ks(J.value)&&N.length<+J.value;if((pe||te)&&(F(pe,I.message,J.message),!r))return S(C[w].message),C}if(b&&!$&&Ba(N)){const{value:I,message:J}=ui(b);if(rm(I)&&!N.match(I)&&(C[w]={type:pr.pattern,message:J,ref:c,...P(pr.pattern,J)},!r))return S(J),C}if(_){if(ja(_)){const I=await _(N,a),J=Zj(I,k);if(J&&(C[w]={...J,...P(pr.validate,J.message)},!r))return S(J.message),C}else if(Yt(_)){let I={};for(const J in _){if(!Ps(I)&&!r)break;const pe=Zj(await _[J](N,a),k,J);pe&&(I={...pe,...P(J,pe.message)},S(pe.message),r&&(C[w]=I))}if(!Ps(I)&&(C[w]={ref:k,...I},!r))return C}}return S(!0),C};const Uz={mode:wa.onSubmit,reValidateMode:wa.onChange,shouldFocusError:!0};function Bz(t={}){let s={...Uz,...t},a={submitCount:0,isDirty:!1,isReady:!1,isLoading:ja(s.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1},r={},o=Yt(s.defaultValues)||Yt(s.values)?ls(s.defaultValues||s.values)||{}:{},l=s.shouldUnregister?{}:ls(o),c={action:!1,mount:!1,watch:!1},u={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},h,f=0;const p={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let g={...p};const v={array:Lj(),state:Lj()},b=s.criteriaMode===wa.all,_=Z=>se=>{clearTimeout(f),f=setTimeout(Z,se)},w=async Z=>{if(!s.disabled&&(p.isValid||g.isValid||Z)){const se=s.resolver?Ps((await z()).errors):await $(r,!0);se!==a.isValid&&v.state.next({isValid:se})}},E=(Z,se)=>{!s.disabled&&(p.isValidating||p.validatingFields||g.isValidating||g.validatingFields)&&((Z||Array.from(u.mount)).forEach(de=>{de&&(se?_t(a.validatingFields,de,se):Jt(a.validatingFields,de))}),v.state.next({validatingFields:a.validatingFields,isValidating:!Ps(a.validatingFields)}))},T=(Z,se=[],de,Ce,ke=!0,ye=!0)=>{if(Ce&&de&&!s.disabled){if(c.action=!0,ye&&Array.isArray(De(r,Z))){const Te=de(De(r,Z),Ce.argA,Ce.argB);ke&&_t(r,Z,Te)}if(ye&&Array.isArray(De(a.errors,Z))){const Te=de(De(a.errors,Z),Ce.argA,Ce.argB);ke&&_t(a.errors,Z,Te),Lz(a.errors,Z)}if((p.touchedFields||g.touchedFields)&&ye&&Array.isArray(De(a.touchedFields,Z))){const Te=de(De(a.touchedFields,Z),Ce.argA,Ce.argB);ke&&_t(a.touchedFields,Z,Te)}(p.dirtyFields||g.dirtyFields)&&(a.dirtyFields=Xl(o,l)),v.state.next({name:Z,isDirty:F(Z,se),dirtyFields:a.dirtyFields,errors:a.errors,isValid:a.isValid})}else _t(l,Z,se)},N=(Z,se)=>{_t(a.errors,Z,se),v.state.next({errors:a.errors})},k=Z=>{a.errors=Z,v.state.next({errors:a.errors,isValid:!1})},S=(Z,se,de,Ce)=>{const ke=De(r,Z);if(ke){const ye=De(l,Z,Zt(de)?De(o,Z):de);Zt(ye)||Ce&&Ce.defaultChecked||se?_t(l,Z,se?ye:Vj(ke._f)):pe(Z,ye),c.mount&&w()}},C=(Z,se,de,Ce,ke)=>{let ye=!1,Te=!1;const Oe={name:Z};if(!s.disabled){if(!de||Ce){(p.isDirty||g.isDirty)&&(Te=a.isDirty,a.isDirty=Oe.isDirty=F(),ye=Te!==Oe.isDirty);const Ge=vr(De(o,Z),se);Te=!!De(a.dirtyFields,Z),Ge?Jt(a.dirtyFields,Z):_t(a.dirtyFields,Z,!0),Oe.dirtyFields=a.dirtyFields,ye=ye||(p.dirtyFields||g.dirtyFields)&&Te!==!Ge}if(de){const Ge=De(a.touchedFields,Z);Ge||(_t(a.touchedFields,Z,de),Oe.touchedFields=a.touchedFields,ye=ye||(p.touchedFields||g.touchedFields)&&Ge!==de)}ye&&ke&&v.state.next(Oe)}return ye?Oe:{}},M=(Z,se,de,Ce)=>{const ke=De(a.errors,Z),ye=(p.isValid||g.isValid)&&Gs(se)&&a.isValid!==se;if(s.delayError&&de?(h=_(()=>N(Z,de)),h(s.delayError)):(clearTimeout(f),h=null,de?_t(a.errors,Z,de):Jt(a.errors,Z)),(de?!vr(ke,de):ke)||!Ps(Ce)||ye){const Te={...Ce,...ye&&Gs(se)?{isValid:se}:{},errors:a.errors,name:Z};a={...a,...Te},v.state.next(Te)}},z=async Z=>{E(Z,!0);const se=await s.resolver(l,s.context,Rz(Z||u.mount,r,s.criteriaMode,s.shouldUseNativeValidation));return E(Z),se},A=async Z=>{const{errors:se}=await z(Z);if(Z)for(const de of Z){const Ce=De(se,de);Ce?_t(a.errors,de,Ce):Jt(a.errors,de)}else a.errors=se;return se},$=async(Z,se,de={valid:!0})=>{for(const Ce in Z){const ke=Z[Ce];if(ke){const{_f:ye,...Te}=ke;if(ye){const Oe=u.array.has(ye.name),Ge=ke._f&&Oz(ke._f);Ge&&p.validatingFields&&E([Ce],!0);const Je=await Wj(ke,u.disabled,l,b,s.shouldUseNativeValidation&&!se,Oe);if(Ge&&p.validatingFields&&E([Ce]),Je[ye.name]&&(de.valid=!1,se))break;!se&&(De(Je,ye.name)?Oe?Iz(a.errors,Je,ye.name):_t(a.errors,ye.name,Je[ye.name]):Jt(a.errors,ye.name))}!Ps(Te)&&await $(Te,se,de)}}return de.valid},P=()=>{for(const Z of u.unMount){const se=De(r,Z);se&&(se._f.refs?se._f.refs.every(de=>!Np(de)):!Np(se._f.ref))&&me(Z)}u.unMount=new Set},F=(Z,se)=>!s.disabled&&(Z&&se&&_t(l,Z,se),!vr(O(),o)),I=(Z,se,de)=>R2(Z,u,{...c.mount?l:Zt(se)?o:Ba(Z)?{[Z]:se}:se},de,se),J=Z=>Eg(De(c.mount?l:o,Z,s.shouldUnregister?De(o,Z,[]):[])),pe=(Z,se,de={})=>{const Ce=De(r,Z);let ke=se;if(Ce){const ye=Ce._f;ye&&(!ye.disabled&&_t(l,Z,$2(se,ye)),ke=sm(ye.ref)&&ks(se)?"":se,O2(ye.ref)?[...ye.ref.options].forEach(Te=>Te.selected=ke.includes(Te.value)):ye.refs?Hc(ye.ref)?ye.refs.forEach(Te=>{(!Te.defaultChecked||!Te.disabled)&&(Array.isArray(ke)?Te.checked=!!ke.find(Oe=>Oe===Te.value):Te.checked=ke===Te.value||!!ke)}):ye.refs.forEach(Te=>Te.checked=Te.value===ke):Ag(ye.ref)?ye.ref.value="":(ye.ref.value=ke,ye.ref.type||v.state.next({name:Z,values:ls(l)})))}(de.shouldDirty||de.shouldTouch)&&C(Z,ke,de.shouldTouch,de.shouldDirty,!0),de.shouldValidate&&xe(Z)},te=(Z,se,de)=>{for(const Ce in se){if(!se.hasOwnProperty(Ce))return;const ke=se[Ce],ye=Z+"."+Ce,Te=De(r,ye);(u.array.has(Z)||Yt(ke)||Te&&!Te._f)&&!to(ke)?te(ye,ke,de):pe(ye,ke,de)}},L=(Z,se,de={})=>{const Ce=De(r,Z),ke=u.array.has(Z),ye=ls(se);_t(l,Z,ye),ke?(v.array.next({name:Z,values:ls(l)}),(p.isDirty||p.dirtyFields||g.isDirty||g.dirtyFields)&&de.shouldDirty&&v.state.next({name:Z,dirtyFields:Xl(o,l),isDirty:F(Z,ye)})):Ce&&!Ce._f&&!ks(ye)?te(Z,ye,de):pe(Z,ye,de),Hj(Z,u)&&v.state.next({...a,name:Z}),v.state.next({name:c.mount?Z:void 0,values:ls(l)})},G=async Z=>{c.mount=!0;const se=Z.target;let de=se.name,Ce=!0;const ke=De(r,de),ye=Ge=>{Ce=Number.isNaN(Ge)||to(Ge)&&isNaN(Ge.getTime())||vr(Ge,De(l,de,Ge))},Te=qj(s.mode),Oe=qj(s.reValidateMode);if(ke){let Ge,Je;const rs=se.type?Vj(ke._f):k2(Z),Ue=Z.type===tm.BLUR||Z.type===tm.FOCUS_OUT,W=!Dz(ke._f)&&!s.resolver&&!De(a.errors,de)&&!ke._f.deps||$z(Ue,De(a.touchedFields,de),a.isSubmitted,Oe,Te),re=Hj(de,u,Ue);_t(l,de,rs),Ue?(!se||!se.readOnly)&&(ke._f.onBlur&&ke._f.onBlur(Z),h&&h(0)):ke._f.onChange&&ke._f.onChange(Z);const Ee=C(de,rs,Ue),Le=!Ps(Ee)||re;if(!Ue&&v.state.next({name:de,type:Z.type,values:ls(l)}),W)return(p.isValid||g.isValid)&&(s.mode==="onBlur"?Ue&&w():Ue||w()),Le&&v.state.next({name:de,...re?{}:Ee});if(!Ue&&re&&v.state.next({...a}),s.resolver){const{errors:rt}=await z([de]);if(ye(rs),Ce){const Lt=Gj(a.errors,r,de),Ta=Gj(rt,r,Lt.name||de);Ge=Ta.error,de=Ta.name,Je=Ps(rt)}}else E([de],!0),Ge=(await Wj(ke,u.disabled,l,b,s.shouldUseNativeValidation))[de],E([de]),ye(rs),Ce&&(Ge?Je=!1:(p.isValid||g.isValid)&&(Je=await $(r,!0)));Ce&&(ke._f.deps&&xe(ke._f.deps),M(de,Je,Ge,Ee))}},ee=(Z,se)=>{if(De(a.errors,se)&&Z.focus)return Z.focus(),1},xe=async(Z,se={})=>{let de,Ce;const ke=gc(Z);if(s.resolver){const ye=await A(Zt(Z)?Z:ke);de=Ps(ye),Ce=Z?!ke.some(Te=>De(ye,Te)):de}else Z?(Ce=(await Promise.all(ke.map(async ye=>{const Te=De(r,ye);return await $(Te&&Te._f?{[ye]:Te}:Te)}))).every(Boolean),!(!Ce&&!a.isValid)&&w()):Ce=de=await $(r);return v.state.next({...!Ba(Z)||(p.isValid||g.isValid)&&de!==a.isValid?{}:{name:Z},...s.resolver||!Z?{isValid:de}:{},errors:a.errors}),se.shouldFocus&&!Ce&&xc(r,ee,Z?ke:u.mount),Ce},O=Z=>{const se={...c.mount?l:o};return Zt(Z)?se:Ba(Z)?De(se,Z):Z.map(de=>De(se,de))},H=(Z,se)=>({invalid:!!De((se||a).errors,Z),isDirty:!!De((se||a).dirtyFields,Z),error:De((se||a).errors,Z),isValidating:!!De(a.validatingFields,Z),isTouched:!!De((se||a).touchedFields,Z)}),B=Z=>{Z&&gc(Z).forEach(se=>Jt(a.errors,se)),v.state.next({errors:Z?a.errors:{}})},Y=(Z,se,de)=>{const Ce=(De(r,Z,{_f:{}})._f||{}).ref,ke=De(a.errors,Z)||{},{ref:ye,message:Te,type:Oe,...Ge}=ke;_t(a.errors,Z,{...Ge,...se,ref:Ce}),v.state.next({name:Z,errors:a.errors,isValid:!1}),de&&de.shouldFocus&&Ce&&Ce.focus&&Ce.focus()},ne=(Z,se)=>ja(Z)?v.state.subscribe({next:de=>"values"in de&&Z(I(void 0,se),de)}):I(Z,se,!0),ie=Z=>v.state.subscribe({next:se=>{zz(Z.name,se.name,Z.exact)&&Pz(se,Z.formState||p,Ie,Z.reRenderRoot)&&Z.callback({values:{...l},...a,...se,defaultValues:o})}}).unsubscribe,oe=Z=>(c.mount=!0,g={...g,...Z.formState},ie({...Z,formState:g})),me=(Z,se={})=>{for(const de of Z?gc(Z):u.mount)u.mount.delete(de),u.array.delete(de),se.keepValue||(Jt(r,de),Jt(l,de)),!se.keepError&&Jt(a.errors,de),!se.keepDirty&&Jt(a.dirtyFields,de),!se.keepTouched&&Jt(a.touchedFields,de),!se.keepIsValidating&&Jt(a.validatingFields,de),!s.shouldUnregister&&!se.keepDefaultValue&&Jt(o,de);v.state.next({values:ls(l)}),v.state.next({...a,...se.keepDirty?{isDirty:F()}:{}}),!se.keepIsValid&&w()},D=({disabled:Z,name:se})=>{(Gs(Z)&&c.mount||Z||u.disabled.has(se))&&(Z?u.disabled.add(se):u.disabled.delete(se))},q=(Z,se={})=>{let de=De(r,Z);const Ce=Gs(se.disabled)||Gs(s.disabled);return _t(r,Z,{...de||{},_f:{...de&&de._f?de._f:{ref:{name:Z}},name:Z,mount:!0,...se}}),u.mount.add(Z),de?D({disabled:Gs(se.disabled)?se.disabled:s.disabled,name:Z}):S(Z,!0,se.value),{...Ce?{disabled:se.disabled||s.disabled}:{},...s.progressive?{required:!!se.required,min:Ql(se.min),max:Ql(se.max),minLength:Ql(se.minLength),maxLength:Ql(se.maxLength),pattern:Ql(se.pattern)}:{},name:Z,onChange:G,onBlur:G,ref:ke=>{if(ke){q(Z,se),de=De(r,Z);const ye=Zt(ke.value)&&ke.querySelectorAll&&ke.querySelectorAll("input,select,textarea")[0]||ke,Te=Tz(ye),Oe=de._f.refs||[];if(Te?Oe.find(Ge=>Ge===ye):ye===de._f.ref)return;_t(r,Z,{_f:{...de._f,...Te?{refs:[...Oe.filter(Np),ye,...Array.isArray(De(o,Z))?[{}]:[]],ref:{type:ye.type,name:Z}}:{ref:ye}}}),S(Z,!1,void 0,ye)}else de=De(r,Z,{}),de._f&&(de._f.mount=!1),(s.shouldUnregister||se.shouldUnregister)&&!(T2(u.array,Z)&&c.action)&&u.unMount.add(Z)}}},Q=()=>s.shouldFocusError&&xc(r,ee,u.mount),K=Z=>{Gs(Z)&&(v.state.next({disabled:Z}),xc(r,(se,de)=>{const Ce=De(r,de);Ce&&(se.disabled=Ce._f.disabled||Z,Array.isArray(Ce._f.refs)&&Ce._f.refs.forEach(ke=>{ke.disabled=Ce._f.disabled||Z}))},0,!1))},he=(Z,se)=>async de=>{let Ce;de&&(de.preventDefault&&de.preventDefault(),de.persist&&de.persist());let ke=ls(l);if(v.state.next({isSubmitting:!0}),s.resolver){const{errors:ye,values:Te}=await z();a.errors=ye,ke=ls(Te)}else await $(r);if(u.disabled.size)for(const ye of u.disabled)Jt(ke,ye);if(Jt(a.errors,"root"),Ps(a.errors)){v.state.next({errors:{}});try{await Z(ke,de)}catch(ye){Ce=ye}}else se&&await se({...a.errors},de),Q(),setTimeout(Q);if(v.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Ps(a.errors)&&!Ce,submitCount:a.submitCount+1,errors:a.errors}),Ce)throw Ce},we=(Z,se={})=>{De(r,Z)&&(Zt(se.defaultValue)?L(Z,ls(De(o,Z))):(L(Z,se.defaultValue),_t(o,Z,ls(se.defaultValue))),se.keepTouched||Jt(a.touchedFields,Z),se.keepDirty||(Jt(a.dirtyFields,Z),a.isDirty=se.defaultValue?F(Z,ls(De(o,Z))):F()),se.keepError||(Jt(a.errors,Z),p.isValid&&w()),v.state.next({...a}))},_e=(Z,se={})=>{const de=Z?ls(Z):o,Ce=ls(de),ke=Ps(Z),ye=ke?o:Ce;if(se.keepDefaultValues||(o=de),!se.keepValues){if(se.keepDirtyValues){const Te=new Set([...u.mount,...Object.keys(Xl(o,l))]);for(const Oe of Array.from(Te))De(a.dirtyFields,Oe)?_t(ye,Oe,De(l,Oe)):L(Oe,De(ye,Oe))}else{if(Sg&&Zt(Z))for(const Te of u.mount){const Oe=De(r,Te);if(Oe&&Oe._f){const Ge=Array.isArray(Oe._f.refs)?Oe._f.refs[0]:Oe._f.ref;if(sm(Ge)){const Je=Ge.closest("form");if(Je){Je.reset();break}}}}if(se.keepFieldsRef)for(const Te of u.mount)L(Te,De(ye,Te));else r={}}l=s.shouldUnregister?se.keepDefaultValues?ls(o):{}:ls(ye),v.array.next({values:{...ye}}),v.state.next({values:{...ye}})}u={mount:se.keepDirtyValues?u.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},c.mount=!p.isValid||!!se.keepIsValid||!!se.keepDirtyValues,c.watch=!!s.shouldUnregister,v.state.next({submitCount:se.keepSubmitCount?a.submitCount:0,isDirty:ke?!1:se.keepDirty?a.isDirty:!!(se.keepDefaultValues&&!vr(Z,o)),isSubmitted:se.keepIsSubmitted?a.isSubmitted:!1,dirtyFields:ke?{}:se.keepDirtyValues?se.keepDefaultValues&&l?Xl(o,l):a.dirtyFields:se.keepDefaultValues&&Z?Xl(o,Z):se.keepDirty?a.dirtyFields:{},touchedFields:se.keepTouched?a.touchedFields:{},errors:se.keepErrors?a.errors:{},isSubmitSuccessful:se.keepIsSubmitSuccessful?a.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:o})},Re=(Z,se)=>_e(ja(Z)?Z(l):Z,se),ze=(Z,se={})=>{const de=De(r,Z),Ce=de&&de._f;if(Ce){const ke=Ce.refs?Ce.refs[0]:Ce.ref;ke.focus&&(ke.focus(),se.shouldSelect&&ja(ke.select)&&ke.select())}},Ie=Z=>{a={...a,...Z}},$e={control:{register:q,unregister:me,getFieldState:H,handleSubmit:he,setError:Y,_subscribe:ie,_runSchema:z,_focusError:Q,_getWatch:I,_getDirty:F,_setValid:w,_setFieldArray:T,_setDisabledField:D,_setErrors:k,_getFieldArray:J,_reset:_e,_resetDefaultValues:()=>ja(s.defaultValues)&&s.defaultValues().then(Z=>{Re(Z,s.resetOptions),v.state.next({isLoading:!1})}),_removeUnmounted:P,_disableForm:K,_subjects:v,_proxyFormState:p,get _fields(){return r},get _formValues(){return l},get _state(){return c},set _state(Z){c=Z},get _defaultValues(){return o},get _names(){return u},set _names(Z){u=Z},get _formState(){return a},get _options(){return s},set _options(Z){s={...s,...Z}}},subscribe:oe,trigger:xe,register:q,handleSubmit:he,watch:ne,setValue:L,getValues:O,reset:Re,resetField:we,clearErrors:B,unregister:me,setError:Y,setFocus:ze,getFieldState:H};return{...$e,formControl:$e}}function Rg(t={}){const s=Ye.useRef(void 0),a=Ye.useRef(void 0),[r,o]=Ye.useState({isDirty:!1,isValidating:!1,isLoading:ja(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:ja(t.defaultValues)?void 0:t.defaultValues});if(!s.current)if(t.formControl)s.current={...t.formControl,formState:r},t.defaultValues&&!ja(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:c,...u}=Bz(t);s.current={...u,formState:r}}const l=s.current.control;return l._options=t,Tg(()=>{const c=l._subscribe({formState:l._proxyFormState,callback:()=>o({...l._formState}),reRenderRoot:!0});return o(u=>({...u,isReady:!0})),l._formState.isReady=!0,c},[l]),Ye.useEffect(()=>l._disableForm(t.disabled),[l,t.disabled]),Ye.useEffect(()=>{t.mode&&(l._options.mode=t.mode),t.reValidateMode&&(l._options.reValidateMode=t.reValidateMode)},[l,t.mode,t.reValidateMode]),Ye.useEffect(()=>{t.errors&&(l._setErrors(t.errors),l._focusError())},[l,t.errors]),Ye.useEffect(()=>{t.shouldUnregister&&l._subjects.state.next({values:l._getWatch()})},[l,t.shouldUnregister]),Ye.useEffect(()=>{if(l._proxyFormState.isDirty){const c=l._getDirty();c!==r.isDirty&&l._subjects.state.next({isDirty:c})}},[l,r.isDirty]),Ye.useEffect(()=>{t.values&&!vr(t.values,a.current)?(l._reset(t.values,{keepFieldsRef:!0,...l._options.resetOptions}),a.current=t.values,o(c=>({...c}))):l._resetDefaultValues()},[l,t.values]),Ye.useEffect(()=>{l._state.mount||(l._setValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),s.current.formState=M2(r,l),s.current}const Vz=({isOpen:t,onClose:s,item:a})=>{const{addMenuItem:r,updateMenuItem:o}=Tt(),{register:l,handleSubmit:c,control:u,reset:h,formState:{errors:f}}=Rg(),[p,g]=y.useState(!1);y.useEffect(()=>{h(a?{name:a.name,description:a.description||"",price:a.price,category:a.category,preparationTime:a.preparation_time||0,available:a.available,image_url:a.image_url||""}:{name:"",description:"",price:"",category:"food",preparationTime:"",available:!0,image_url:""})},[a,h]);const v=async _=>{console.log("=== INCIO DO SUBMIT ==="),console.log("Dados recebidos do formulrio:",_),g(!0);try{const w={..._,description:_.description||"",preparationTime:_.preparationTime||void 0};console.log("Dados processados para envio:",w),a?(console.log("Modo: Edio de item existente"),await o({...a,...w})):(console.log("Modo: Criao de novo item"),await r(w)),console.log("Item salvo com sucesso!"),a||h({name:"",description:"",price:"",category:"food",preparationTime:"",available:!0,image_url:""}),s()}catch(w){console.error("=== ERRO DETALHADO ==="),console.error("Tipo do erro:",typeof w),console.error("Erro completo:",w),console.error("Stack trace:",w instanceof Error?w.stack:"N/A"),w&&typeof w=="object"&&"message"in w&&console.error("Mensagem do erro:",w.message),alert(`Erro ao salvar o prato: ${w instanceof Error?w.message:"Erro desconhecido"}`)}finally{g(!1),console.log("=== FIM DO SUBMIT ===")}},b=[{value:"food",label:"Pratos Principais"},{value:"snacks",label:"Petiscos"},{value:"drinks",label:"Bebidas"}];return e.jsx(Wa,{children:t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:e.jsxs(be.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 bg-gray-50 rounded-t-xl",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:a?"Editar Prato":"Novo Prato"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a?"Atualize as informaes do prato":"Adicione um novo prato ao cardpio"})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 hover:bg-gray-200 p-2 rounded-lg transition-colors duration-200",disabled:p,title:"Fechar modal","aria-label":"Fechar modal",children:e.jsx(lt,{size:24})})]}),e.jsxs("form",{onSubmit:c(v),className:"p-6 space-y-6",children:[e.jsx(mi,{label:"Nome do Prato",error:f.name,children:e.jsx("input",{...l("name",{required:"Nome  obrigatrio"}),className:"form-input",placeholder:"Digite o nome do prato",disabled:p})}),e.jsx(mi,{label:"Descrio",error:f.description,children:e.jsx("textarea",{...l("description"),className:"form-input min-h-[80px] resize-none",placeholder:"Descreva o prato...",disabled:p})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(mi,{label:"Categoria",error:f.category,children:e.jsx(ro,{name:"category",control:u,rules:{required:"Categoria  obrigatria"},render:({field:_})=>e.jsx("select",{..._,className:"form-select",disabled:p,children:b.map(w=>e.jsx("option",{value:w.value,children:w.label},w.value))})})}),e.jsx(mi,{label:"Preo (R$)",error:f.price,children:e.jsx("input",{type:"number",step:"0.01",...l("price",{required:"Preo  obrigatrio",valueAsNumber:!0,min:{value:.01,message:"Valor deve ser maior que 0"}}),className:"form-input",placeholder:"Digite o preo",disabled:p})})]}),e.jsxs(mi,{label:"URL da Imagem (opcional)",error:f.image_url,children:[e.jsx("input",{...l("image_url"),className:"form-input",placeholder:"https://exemplo.com/imagem.jpg",disabled:p}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Cole aqui o link da imagem do prato. Recomendamos imagens com proporo 1:1 (quadrada)."})]}),e.jsx(mi,{label:"Tempo de Preparo (min)",error:f.preparationTime,children:e.jsx("input",{type:"number",...l("preparationTime",{setValueAs:_=>_===""||_===null?void 0:Number(_),min:{value:0,message:"Valor deve ser maior ou igual a 0"}}),className:"form-input",placeholder:"Digite o tempo em minutos",disabled:p})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ro,{name:"available",control:u,render:({field:_})=>e.jsx("input",{type:"checkbox",onChange:_.onChange,onBlur:_.onBlur,name:_.name,ref:_.ref,checked:_.value,className:"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500 focus:ring-2",disabled:p,title:"Marcar como disponvel","aria-label":"Marcar prato como disponvel para pedidos"})}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Prato disponvel para pedidos"})]}),e.jsxs("div",{className:"pt-6 flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:s,className:"btn-secondary",disabled:p,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn-primary flex items-center justify-center space-x-2",disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Salvando..."})]}):e.jsx("span",{children:a?"Salvar Alteraes":"Adicionar Prato"})})]})]})]})})})},mi=({label:t,children:s,error:a})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:t}),s,a&&e.jsxs("p",{className:"text-red-500 text-sm flex items-center space-x-1",children:[e.jsx("span",{className:"w-4 h-4 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"})}),e.jsx("span",{children:a.message})]})]}),qz=({menuItems:t})=>{const{removeMenuItem:s}=Tt(),[a,r]=y.useState(""),[o,l]=y.useState(!1),[c,u]=y.useState(null),h=t.filter(b=>{const _=b.name.toLowerCase().includes(a.toLowerCase()),w=b.item_type!=="direct";return _&&w}),f=()=>{u(null),l(!0)},p=b=>{u(b),l(!0)},g=()=>{l(!1),u(null)},v=async b=>{window.confirm(`Tem certeza que deseja remover "${b.name}" do cardpio?`)&&await s(b.id)};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Gesto de Cardpio"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Gerencie apenas pratos que precisam de preparo na cozinha.",e.jsx("br",{}),e.jsx("span",{className:"text-blue-600 font-medium",children:'Produtos prontos do estoque aparecem automaticamente no balco quando marcados como "Disponvel para venda" no mdulo Estoque.'})]})]}),e.jsx("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3",children:e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:f,className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center space-x-2",children:[e.jsx(Zs,{size:20}),e.jsx("span",{children:"Novo Prato"})]})})]}),e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-4 sm:space-y-0 sm:space-x-4 mb-6",children:e.jsx("input",{type:"text",placeholder:"Buscar pratos...",value:a,onChange:b=>r(b.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(b=>e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow",children:[b.image_url&&e.jsx("div",{className:"aspect-video w-full bg-gray-100 overflow-hidden",children:e.jsx("img",{src:b.image_url,alt:b.name,className:"w-full h-full object-cover hover:scale-105 transition-transform duration-300",onError:_=>{_.currentTarget.style.display="none"}})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:b.name}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>p(b),className:"text-gray-400 hover:text-blue-600 transition-colors",title:"Editar prato","aria-label":"Editar prato",children:e.jsx(lo,{size:16})}),e.jsx("button",{onClick:()=>v(b),className:"text-gray-400 hover:text-red-600 transition-colors",title:"Excluir prato","aria-label":"Excluir prato",children:e.jsx(Fc,{size:16})})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:b.description}),e.jsxs("div",{className:"flex items-center justify-between text-sm mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-gray-600",children:[e.jsx(Vt,{size:14}),e.jsxs("span",{children:[b.preparation_time||0,"min"]})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-green-600",children:[e.jsx(kt,{size:14}),e.jsxs("span",{className:"font-semibold",children:["R$ ",b.price.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${b.available?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:b.available?"Disponvel":"Indisponvel"}),e.jsx("span",{className:"text-xs text-gray-500 capitalize",children:b.category==="Prato Principal"?"Prato Principal":b.category==="Petiscos"?"Petiscos":"Bebidas"})]})]})]},b.id))}),h.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhum prato encontrado"})}),e.jsx(Vz,{isOpen:o,onClose:g,item:c})]})},Nm=t=>{if(!t)return"000";if(t.includes("-")){const s=t.split("-"),a=s[s.length-1];if(/^\d+$/.test(a))return a.padStart(3,"0");for(const r of s.reverse())if(/^\d+$/.test(r)&&r.length>=3)return r}return t.length>10?t.slice(-6).toUpperCase():t.toUpperCase()},Og=t=>t?`Mesa ${t}`:"Balco",I2=t=>{let s=t.match(/Pedido Balco #(\d+)/);if(s)return`#${s[1]}`;if(s=t.match(/Pedido de balco #([a-f0-9-]+)/),s){const r=s[1].replace(/-/g,"").slice(-4);return`#${(parseInt(r,16)%1e4).toString().padStart(4,"0")}`}return null},Fz=({orders:t,menuItems:s})=>{const{updateOrderStatus:a}=Tt(),[r,o]=y.useState(new Set),[l,c]=y.useState("all"),h=(()=>{const N=new Map;return t.forEach(k=>{const S=k.tableNumber||"Balco";N.has(S)||N.set(S,[]),N.get(S).push(k)}),N})(),f=N=>N.items.reduce((k,S)=>{const C=s.find(z=>z.id===S.menuItemId)||S.menuItem,M=(C==null?void 0:C.preparation_time)||(C==null?void 0:C.preparationTime)||0;return k+M},0),p=N=>{const k=(new Date().getTime()-N.createdAt.getTime())/6e4;return k>20?"high":k>10?"medium":"low"},g=N=>{switch(N){case"high":return"border-red-400 bg-red-50";case"medium":return"border-yellow-400 bg-yellow-50";case"low":return"border-green-400 bg-green-50";default:return"border-gray-200 bg-white"}},v=N=>N.id.slice(-4).toUpperCase(),b=N=>N.id.startsWith("balcao-"),_=N=>N.id.startsWith("comanda-"),w=async(N,k)=>{console.log(" Cozinha - Atualizando status:",{orderId:N,newStatus:k,isComandaOrder:_({id:N})}),o(S=>new Set([...S,N]));try{await a(N,k),console.log(` Status do pedido ${N} atualizado para ${k}`)}catch(S){console.error(" Erro ao atualizar status:",S)}finally{setTimeout(()=>{o(S=>{const C=new Set(S);return C.delete(N),C})},1e3)}},E=N=>(h.get(N)||[]).length>1,T=t.filter(N=>l==="all"?!0:(N.tableNumber||"Balco")===l);return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Pedidos da Cozinha"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[Array.from(h.entries()).filter(([N,k])=>k.length>1).length>0&&e.jsxs("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium",children:[Array.from(h.entries()).filter(([N,k])=>k.length>1).length," mesa(s) com mltiplos pedidos"]}),l!=="all"&&e.jsxs("button",{onClick:()=>c("all"),className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium hover:bg-blue-200 transition-colors flex items-center space-x-1",children:[e.jsxs("span",{children:["Filtro: ",l]}),e.jsx("span",{className:"text-blue-600",children:""})]})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[T.length," de ",t.length," pedidos"]})]}),Array.from(h.entries()).filter(([N,k])=>k.length>1).length>0&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-orange-800 mb-2",children:" Mesas com Mltiplos Pedidos:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from(h.entries()).filter(([N,k])=>k.length>1).map(([N,k])=>e.jsxs("button",{onClick:()=>c(N),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors hover:shadow-md transform hover:scale-105 ${l===N?"bg-orange-400 text-white":"bg-orange-200 text-orange-800 hover:bg-orange-300"}`,title:`Filtrar pedidos da ${N}`,children:["Mesa ",N,": ",k.length," pedidos"]},N))})]}),T.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:l!=="all"?`Nenhum pedido encontrado para ${l}`:"Nenhum pedido pendente na cozinha"})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:T.map(N=>{const k=p(N),S=f(N),C=N.items.filter(z=>{const A=s.find($=>$.id===z.menuItemId)||z.menuItem;return A&&A.item_type!=="direct"}),M=E(N.tableNumber||"Balco");return e.jsxs(be.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:`border-2 rounded-lg p-4 ${g(k)} ${M?"ring-2 ring-orange-300 ring-offset-2":""} ${b(N)?"border-green-400 bg-green-50 shadow-lg":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qc,{size:16,className:"text-gray-500"}),e.jsx("span",{className:"font-bold text-lg",children:Og(N.tableNumber)}),e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:["#",v(N)]}),b(N)&&e.jsx("span",{className:"bg-green-600 text-white px-2 py-1 rounded-full text-xs font-bold animate-pulse",children:" PAGO"}),_(N)&&e.jsx("span",{className:"bg-yellow-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:"AGUARDA PAGTO"})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(Vt,{size:14}),e.jsx("span",{children:St(N.createdAt,"HH:mm",{locale:ss})})]})]}),e.jsx("div",{className:"space-y-2 mb-4",children:C.map(z=>{const A=s.find($=>$.id===z.menuItemId)||z.menuItem;return e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-medium",children:[z.quantity,"x ",(A==null?void 0:A.name)||"Item no encontrado"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[(A==null?void 0:A.preparation_time)||(A==null?void 0:A.preparationTime)||0,"min"]})]},z.id)})}),N.notes&&e.jsx("div",{className:"mb-4 p-2 bg-yellow-100 rounded border",children:e.jsx("p",{className:"text-sm text-yellow-800",children:N.notes})}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Tempo estimado: ",S,"min"]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${k==="high"?"bg-red-200 text-red-800":k==="medium"?"bg-yellow-200 text-yellow-800":"bg-green-200 text-green-800"}`,children:k==="high"?"Urgente":k==="medium"?"Mdio":"Normal"})]}),e.jsxs("div",{className:"space-y-2",children:[N.status==="pending"&&e.jsx("button",{onClick:()=>w(N.id,"preparing"),disabled:r.has(N.id),className:`w-full py-2 rounded-lg font-medium transition-all duration-300 ${r.has(N.id)?"bg-blue-300 text-blue-700 cursor-not-allowed animate-pulse scale-95":"bg-blue-600 text-white hover:bg-blue-700 hover:shadow-lg transform hover:scale-105 active:scale-95"}`,children:r.has(N.id)?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-700 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Iniciando..."})]}):"Iniciar Preparo"}),N.status==="preparing"&&e.jsx("button",{onClick:()=>w(N.id,"ready"),disabled:r.has(N.id),className:`w-full py-2 rounded-lg font-medium transition-all duration-300 ${r.has(N.id)?"bg-green-300 text-green-700 cursor-not-allowed animate-pulse scale-95":"bg-green-600 text-white hover:bg-green-700 hover:shadow-lg transform hover:scale-105 active:scale-95"}`,children:r.has(N.id)?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-green-700 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Finalizando..."})]}):"Marcar como Pronto"}),N.status==="ready"&&e.jsx("div",{className:"w-full py-2 rounded-lg font-medium bg-green-100 text-green-800 border-2 border-green-300 text-center animate-pulse",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-5 h-5 bg-green-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:""})}),e.jsx("span",{children:"Pronto para Entrega"})]})})]})]},N.id)})})]})},Hz=()=>{const{kitchenOrders:t,menuItems:s,refreshKitchenOrders:a}=Tt(),[r,o]=y.useState("orders");jz({onOrderUpdate:()=>{console.log(" Atualizao detectada! Recarregando Monitor Cozinha..."),a()}}),Ye.useEffect(()=>{console.log(" Monitor Cozinha montado - carregando dados iniciais..."),a()},[]);const l=t.filter(h=>h.status==="pending"||h.status==="preparing"),c=s.filter(h=>h.item_type!=="direct"),u=c.filter(h=>h.preparationTime).reduce((h,f)=>h+(f.preparationTime||0),0)/c.filter(h=>h.preparationTime).length||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Mdulo Cozinha"}),e.jsx("p",{className:"text-gray-600",children:"Gesto completa da cozinha e cardpio"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>o("orders"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${r==="orders"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Pedidos"}),e.jsx("button",{onClick:()=>o("menu"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${r==="menu"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Cardpio"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:"Pedidos Pendentes"}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:l.length})]}),e.jsx("div",{className:"p-3 bg-orange-100 rounded-full",children:e.jsx(Vt,{className:"w-6 h-6 text-orange-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:"Tempo Mdio"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-600",children:[u.toFixed(0),"min"]})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(Vt,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:"Pratos Disponveis"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:c.filter(h=>h.available).length})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(Ya,{className:"w-6 h-6 text-green-600"})})]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md",children:r==="orders"?e.jsx(Fz,{orders:l,menuItems:c}):e.jsx(qz,{menuItems:c})})]})},Gz=({cost:t,onPricingChange:s})=>{const[a,r]=y.useState("margin"),[o,l]=y.useState(50),[c,u]=y.useState(0),h=(_,w)=>_*(1+w/100),f=(_,w)=>_===0?0:(w-_)/_*100,p=_=>{if(r(_),_==="margin")s({marginPercentage:o,pricingMethod:"margin"});else{const w=c||h(t,o);u(w),s({salePrice:w,pricingMethod:"fixed_price"})}},g=_=>{l(_),s({marginPercentage:_,pricingMethod:"margin"})},v=_=>{u(_),s({salePrice:_,pricingMethod:"fixed_price"})},b=a==="margin"?h(t,o):c;return e.jsxs("div",{className:"space-y-4 p-4 bg-blue-50 rounded-lg border-2 border-blue-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m0,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:" Configurao de Preos"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Como voc quer definir o preo?"}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"pricingMethod",value:"margin",checked:a==="margin",onChange:()=>p("margin"),className:"mr-2"}),e.jsx(uO,{className:"w-4 h-4 mr-1 text-green-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Por Margem de Lucro"})]}),e.jsxs("label",{className:"flex items-center cursor-pointer",children:[e.jsx("input",{type:"radio",name:"pricingMethod",value:"fixed_price",checked:a==="fixed_price",onChange:()=>p("fixed_price"),className:"mr-2"}),e.jsx(kt,{className:"w-4 h-4 mr-1 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium",children:"Preo Fixo"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Custo Base"}),e.jsxs("div",{className:"text-lg font-semibold text-gray-800 bg-white p-3 rounded border",children:["R$ ",t.toFixed(2)]})]}),a==="margin"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Margem de Lucro (%)"}),e.jsx("input",{type:"number",value:o,onChange:_=>g(Number(_.target.value)),min:"0",step:"1",className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg",placeholder:"50"})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Preo de Venda (R$)"}),e.jsx("input",{type:"number",value:c,onChange:_=>v(Number(_.target.value)),min:"0",step:"0.01",className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-lg",placeholder:"15.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:a==="margin"?"Preo Final":"Margem Resultante"}),e.jsx("div",{className:"text-lg font-semibold text-green-600 bg-white p-3 rounded border",children:a==="margin"?`R$ ${b.toFixed(2)}`:`${f(t,c).toFixed(1)}%`})]})]}),e.jsx("div",{className:"bg-white p-3 rounded-lg border",children:e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:" Preo de Venda:"}),e.jsxs("span",{className:"font-bold ml-2 text-green-600",children:["R$ ",b.toFixed(2)]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:" Margem:"}),e.jsxs("span",{className:"font-bold ml-2",children:[f(t,b).toFixed(1),"%"]})]})]})})]})},Zz=({isOpen:t,onClose:s,item:a})=>{const{addInventoryItem:r,updateInventoryItem:o,inventoryCategories:l}=Tt(),{register:c,handleSubmit:u,control:h,reset:f,formState:{errors:p},watch:g,setValue:v}=Rg(),[b,_]=y.useState(!1),[w,E]=y.useState(!1),[T,N]=y.useState(!1),[k,S]=y.useState(""),[C,M]=y.useState(""),[z,A]=y.useState({salePrice:a==null?void 0:a.salePrice,marginPercentage:(a==null?void 0:a.marginPercentage)||50,pricingMethod:(a==null?void 0:a.pricingMethod)||"margin"}),[$,P]=y.useState({currentStock:Number(a==null?void 0:a.currentStock)||0,cost:Number(a==null?void 0:a.cost)||0}),F=Ye.useRef(z);Ye.useEffect(()=>{F.current=z},[z]);const I=g("cost")??(a==null?void 0:a.cost)??0;Ye.useEffect(()=>{const L=Number(I)||0;if(T&&L>=0){const G=L;if(z.pricingMethod==="margin"){const ee=G*(1+(z.marginPercentage||50)/100),xe={...F.current,salePrice:ee};A(xe),F.current=xe}else if(z.pricingMethod==="fixed_price"&&z.salePrice){const ee=G>0?((z.salePrice||0)-G)/G*100:0,xe={...F.current,marginPercentage:ee};A(xe),F.current=xe}}},[I,z.pricingMethod,T]),y.useEffect(()=>{t&&(a?(f({name:a.name,categoryId:a.categoryId,currentStock:a.currentStock,minStock:a.minStock,unit:a.unit,cost:a.cost,supplier:a.supplier,availableForSale:a.availableForSale,image_url:a.image_url,salePrice:a.salePrice,marginPercentage:a.marginPercentage,pricingMethod:a.pricingMethod}),P({currentStock:Number(a.currentStock)||0,cost:Number(a.cost)||0}),E(!1),N(!1),S(""),M(""),A({salePrice:a.salePrice,marginPercentage:a.marginPercentage||50,pricingMethod:a.pricingMethod||"margin"})):(f({name:"",categoryId:"",currentStock:0,minStock:0,unit:"unidades",cost:0,supplier:"",availableForSale:!1,image_url:"",salePrice:0,marginPercentage:50,pricingMethod:"margin"}),P({currentStock:0,cost:0}),E(!0),N(!0),A({salePrice:0,marginPercentage:50,pricingMethod:"margin"})))},[t,a,f]);const J=()=>{w?(E(!1),S(""),v("currentStock",$.currentStock)):(E(!0),S("Correo de valor inicial incorreto"))},pe=()=>{T?(N(!1),M(""),v("cost",$.cost)):(N(!0),M("Correo de preo de custo incorreto"))},te=async L=>{_(!0);try{const G=F.current,ee={...L,cost:Number(L.cost)||0,salePrice:G.salePrice,marginPercentage:G.marginPercentage,pricingMethod:G.pricingMethod};if(a){const xe=Number(L.currentStock)!==Number($.currentStock),O=Number(L.cost)!==Number($.cost);console.log(" Verificando mudanas:",{stockChanged:xe,costChanged:O,allowStockEdit:w,allowCostEdit:T,originalCost:$.cost,newCost:L.cost,originalStock:$.currentStock,newStock:L.currentStock});let H=[];xe&&w&&H.push(`CORREO - Estoque: ${$.currentStock}  ${L.currentStock} (${k})`),O&&T&&H.push(`CORREO - Custo: R$ ${Number($.cost||0).toFixed(2)}  R$ ${Number(L.cost||0).toFixed(2)} (${C})`),xe&&!w&&(ee.currentStock=$.currentStock),O&&!T&&(ee.cost=$.cost);const B=xe&&w||O&&T,Y={...ee,id:a.id,lastUpdated:new Date};B&&(Y.isCorrection=!0,Y.correctionNotes=H.length>0?H.join(" | "):void 0),await o(Y)}else await r(ee);s()}catch(G){console.error("Erro ao salvar item:",G)}finally{_(!1)}};return t?e.jsx(Wa,{children:e.jsx(be.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",onClick:s,children:e.jsxs(be.div,{initial:{scale:.95,opacity:0},animate:{scale:1,opacity:1},exit:{scale:.95,opacity:0},className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",onClick:L=>L.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:a?"Editar Produto":"Novo Produto"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(lt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:u(te),className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do Produto *"}),e.jsx("input",{...c("name",{required:"Nome  obrigatrio"}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Digite o nome do produto"}),p.name&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Categoria"}),e.jsx(ro,{name:"categoryId",control:h,render:({field:L})=>e.jsxs("select",{...L,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Selecione uma categoria"}),l.map(G=>e.jsx("option",{value:G.id,children:G.name},G.id))]})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Estoque Atual *"}),a&&e.jsxs("button",{type:"button",onClick:J,className:`flex items-center gap-2 px-3 py-1 rounded-md text-sm transition-colors ${w?"bg-orange-100 text-orange-700 hover:bg-orange-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[w?e.jsx(jj,{className:"w-4 h-4"}):e.jsx(dn,{className:"w-4 h-4"}),w?"Bloquear Edio":"Permitir Edio"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{...c("currentStock",{required:"Estoque atual  obrigatrio",min:{value:0,message:"Estoque no pode ser negativo"}}),type:"number",step:"0.01",disabled:!!(a&&!w),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${a&&!w?"bg-gray-100 text-gray-500 cursor-not-allowed":"border-gray-300"}`,placeholder:"0.00"}),a&&!w&&e.jsx("div",{className:"absolute right-3 top-2",children:e.jsx(dn,{className:"w-5 h-5 text-gray-400"})})]}),w&&a&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3 mb-2",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(mt,{className:"w-4 h-4 text-yellow-600 mt-0.5 mr-2"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"Modo Correo Ativado"}),e.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"O valor inserido ser o estoque final, no um incremento. Uma movimentao de correo ser registrada no histrico."})]})]})}),e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Motivo da correo:"}),e.jsx("input",{type:"text",value:k,onChange:L=>S(L.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Ex: Valor inicial registrado incorretamente"})]}),p.currentStock&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.currentStock.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estoque Mnimo"}),e.jsx("input",{...c("minStock",{min:{value:0,message:"Estoque mnimo no pode ser negativo"}}),type:"number",step:"0.01",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0.00"}),p.minStock&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.minStock.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Unidade *"}),e.jsx(ro,{name:"unit",control:h,rules:{required:"Unidade  obrigatria"},render:({field:L})=>e.jsxs("select",{...L,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"unidades",children:"Unidades"}),e.jsx("option",{value:"kg",children:"Quilogramas"}),e.jsx("option",{value:"litros",children:"Litros"}),e.jsx("option",{value:"garrafas",children:"Garrafas"})]})}),p.unit&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.unit.message})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Preo de Custo"}),a&&e.jsxs("button",{type:"button",onClick:pe,className:`flex items-center gap-2 px-3 py-1 rounded-md text-sm transition-colors ${T?"bg-orange-100 text-orange-700 hover:bg-orange-200":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[T?e.jsx(jj,{className:"w-4 h-4"}):e.jsx(dn,{className:"w-4 h-4"}),T?"Bloquear Edio":"Permitir Edio"]})]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{...c("cost",{min:{value:0,message:"Custo no pode ser negativo"}}),type:"number",step:"0.01",disabled:!!(a&&!T),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${a&&!T?"bg-gray-100 text-gray-500 cursor-not-allowed":"border-gray-300"}`,placeholder:"0.00"}),a&&!T&&e.jsx("div",{className:"absolute right-3 top-2",children:e.jsx(dn,{className:"w-5 h-5 text-gray-400"})})]}),T&&a&&e.jsxs("div",{className:"mt-2",children:[e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-3 mb-2",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(mt,{className:"w-4 h-4 text-yellow-600 mt-0.5 mr-2"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-yellow-800",children:"Modo Correo de Custo Ativado"}),e.jsx("p",{className:"text-xs text-yellow-700 mt-1",children:"O valor inserido ser o novo custo do produto. A alterao ser registrada no histrico."})]})]})}),e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Motivo da correo:"}),e.jsx("input",{type:"text",value:C,onChange:L=>M(L.target.value),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500",placeholder:"Ex: Preo de custo registrado incorretamente"})]}),p.cost&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:p.cost.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Fornecedor"}),e.jsx("input",{...c("supplier"),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nome do fornecedor"})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx(ro,{name:"availableForSale",control:h,render:({field:{onChange:L,value:G,...ee}})=>e.jsx("input",{type:"checkbox",...ee,checked:!!G,onChange:xe=>L(xe.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),e.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Disponvel para venda"})]}),e.jsxs("div",{className:"border-t pt-6",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Precificao"}),e.jsx(Gz,{cost:Number(I)||0,onPricingChange:L=>{A({salePrice:L.salePrice||0,marginPercentage:L.marginPercentage||50,pricingMethod:L.pricingMethod})}})]}),a&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-4",children:e.jsxs("div",{className:"flex items-start",children:[e.jsx(mt,{className:"w-5 h-5 text-blue-600 mt-0.5 mr-3"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800",children:"Correes vs Incrementos"}),e.jsxs("div",{className:"text-sm text-blue-700 mt-1 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Correes:"}),' Use os botes "Permitir Edio" acima para corrigir valores iniciais incorretos. O valor inserido ser o estoque/custo final.']}),e.jsxs("p",{children:[e.jsx("strong",{children:"Incrementos:"})," Para adicionar quantidades ao estoque (compras, recebimentos), utilize a ",e.jsx("strong",{children:"Atualizao Massiva"}),", que registrar o incremento corretamente."]})]})]})]})}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-6 border-t",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-white border border-gray-300 rounded-md hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:b,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 border border-transparent rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Salvando...":a?"Atualizar":"Criar"})]})]})]})})}):null},Wz=({item:t,categories:s,onEdit:a,onDelete:r})=>{const o=t.currentStock<=t.minStock,l=t.availableForSale||!1,c=s.find(u=>u.id===t.categoryId);return e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`bg-white border rounded-lg hover:shadow-lg transition-shadow ${o?"border-red-300":l?"border-green-300":"border-gray-200"}`,children:[e.jsx("div",{className:"p-2 pb-0 min-h-[32px] flex justify-end",children:e.jsxs("div",{className:"flex flex-col space-y-1 items-end",children:[o&&e.jsxs("div",{className:"flex items-center space-x-1 bg-red-500 text-white px-2 py-1 rounded-full text-xs font-medium shadow-md",children:[e.jsx(mt,{size:12}),e.jsx("span",{children:"Estoque Baixo"})]}),l&&!o&&e.jsxs("div",{className:"flex items-center space-x-1 bg-green-500 text-white px-2 py-1 rounded-full text-xs font-medium shadow-md",children:[e.jsx(pn,{size:12}),e.jsx("span",{children:" Venda"})]})]})}),e.jsxs("div",{className:"px-4 pb-4",children:[t.image_url&&e.jsx("div",{className:"w-full h-32 mb-3 bg-gray-100 rounded-lg overflow-hidden flex items-center justify-center",children:e.jsx("img",{src:t.image_url,alt:t.name,className:"max-w-full max-h-full object-contain hover:scale-105 transition-transform duration-300",onError:u=>{u.currentTarget.style.display="none"}})}),e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 pr-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 leading-tight",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500",children:(c==null?void 0:c.name)||"Sem categoria"})]}),e.jsxs("div",{className:"flex space-x-1 ml-2",children:[e.jsx("button",{onClick:()=>a(t),className:"text-gray-400 hover:text-blue-600 transition-colors p-1.5 rounded hover:bg-gray-100",title:"Editar item","aria-label":`Editar ${t.name}`,children:e.jsx(lo,{size:14})}),e.jsx("button",{onClick:()=>r(t.id),className:"text-gray-400 hover:text-red-600 transition-colors p-1.5 rounded hover:bg-gray-100",title:"Excluir item","aria-label":`Excluir ${t.name}`,children:e.jsx(Fc,{size:14})})]})]}),e.jsxs("div",{className:"flex justify-between items-baseline mb-3",children:[e.jsx("span",{className:"text-2xl font-bold text-gray-800",children:t.currentStock}),e.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",t.minStock," ",t.unit]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:`h-2.5 rounded-full ${o?"bg-red-500":"bg-blue-500"}`,style:{width:`${Math.min(t.currentStock/(t.minStock*2)*100,100)}%`}})}),!l&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"flex items-center space-x-1 text-orange-600 text-xs",children:[e.jsx(yr,{size:14}),e.jsx("span",{children:"Produto no liberado para venda no balco"})]})}),e.jsxs("div",{className:"text-xs text-gray-500 mt-3 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:["Custo: R$ ",t.cost.toFixed(2)]}),e.jsxs("span",{children:["Fornecedor: ",t.supplier||"N/A"]})]}),t.salePrice&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-green-600 font-medium",children:["Preo de Venda: R$ ",t.salePrice.toFixed(2)]}),t.marginPercentage&&e.jsxs("span",{className:"text-blue-600",children:["Margem: ",t.marginPercentage.toFixed(1),"%"]})]})]})]})]})},Yz=({inventory:t,onExportReport:s})=>{const a=y.useMemo(()=>{const r=t.reduce((f,p)=>{const g=p.cost||0;return f+g*p.currentStock},0),o=t.reduce((f,p)=>{const g=p.salePrice||0;return f+g*p.currentStock},0),l=o-r,c=r>0?l/r*100:0,u=t.filter(f=>f.availableForSale),h=u.reduce((f,p)=>{const g=p.salePrice||0;return f+g*p.currentStock},0);return{totalCostValue:r,totalSaleValue:o,potentialProfit:l,profitMargin:c,availableForSaleValue:h,totalItems:t.length,availableForSaleCount:u.length}},[t]);return e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl shadow-lg p-6 border border-green-100",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(kt,{className:"w-6 h-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Valor Total do Estoque"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Baseado nos preos de venda"})]})]}),e.jsxs(be.button,{whileHover:{scale:1.05},whileTap:{scale:.95},onClick:s,className:"flex items-center space-x-2 bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Vc,{size:16}),e.jsx("span",{className:"text-sm font-medium",children:"Exportar"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Valor Total (Venda)"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["R$ ",a.totalSaleValue.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),e.jsx(ma,{className:"w-8 h-8 text-green-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Valor Total (Custo)"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["R$ ",a.totalCostValue.toLocaleString("pt-BR",{minimumFractionDigits:2})]})]}),e.jsx(ua,{className:"w-8 h-8 text-blue-500"})]})}),e.jsx("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Lucro Potencial"}),e.jsxs("p",{className:`text-2xl font-bold ${a.potentialProfit>=0?"text-green-600":"text-red-600"}`,children:["R$ ",a.potentialProfit.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a.profitMargin.toFixed(1),"% margem"]})]}),e.jsx(kt,{className:`w-8 h-8 ${a.potentialProfit>=0?"text-green-500":"text-red-500"}`})]})}),e.jsx("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Disponvel p/ Venda"}),e.jsxs("p",{className:"text-2xl font-bold text-purple-600",children:["R$ ",a.availableForSaleValue.toLocaleString("pt-BR",{minimumFractionDigits:2})]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a.availableForSaleCount," de ",a.totalItems," itens"]})]}),e.jsx(ua,{className:"w-8 h-8 text-purple-500"})]})})]}),e.jsxs("div",{className:"mt-4 p-4 bg-white rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Total de Itens no Estoque:"}),e.jsx("span",{className:"font-semibold text-gray-800",children:a.totalItems})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm mt-2",children:[e.jsx("span",{className:"text-gray-600",children:"Itens Disponveis para Venda:"}),e.jsxs("span",{className:"font-semibold text-gray-800",children:[a.availableForSaleCount," (",(a.availableForSaleCount/a.totalItems*100).toFixed(1),"%)"]})]}),e.jsxs("div",{className:"flex items-center justify-between text-sm mt-2",children:[e.jsx("span",{className:"text-gray-600",children:"Margem de Lucro Mdia:"}),e.jsxs("span",{className:`font-semibold ${a.profitMargin>=0?"text-green-600":"text-red-600"}`,children:[a.profitMargin.toFixed(1),"%"]})]})]})]})},Kz=({inventory:t,categories:s})=>{const a=s.reduce((v,b)=>(v[b.id]=b.name,v),{}),r=t.reduce((v,b)=>v+(b.cost||0)*b.currentStock,0),o=t.reduce((v,b)=>v+(b.salePrice||0)*b.currentStock,0),l=o-r,c=t.map(v=>({"Nome do Produto":v.name,Categoria:a[v.categoryId||""]||"Sem categoria","Estoque Atual":v.currentStock,"Estoque Mnimo":v.minStock,Unidade:v.unit,"Custo Unitrio":`R$ ${(v.cost||0).toFixed(2)}`,"Preo de Venda":`R$ ${(v.salePrice||0).toFixed(2)}`,"Valor Total (Custo)":`R$ ${((v.cost||0)*v.currentStock).toFixed(2)}`,"Valor Total (Venda)":`R$ ${((v.salePrice||0)*v.currentStock).toFixed(2)}`,"Margem Unitria":v.marginPercentage?`${v.marginPercentage.toFixed(1)}%`:"N/A","Disponvel p/ Venda":v.availableForSale?"Sim":"No",Fornecedor:v.supplier||"N/A","Status Estoque":v.currentStock<=v.minStock?"Baixo":"Normal","ltima Atualizao":v.lastUpdated.toLocaleDateString("pt-BR")})),u=Object.keys(c[0]||{}),h=[["RELATRIO DE ESTOQUE"],[`Data de Gerao: ${new Date().toLocaleDateString("pt-BR")} s ${new Date().toLocaleTimeString("pt-BR")}`],[""],["RESUMO GERAL"],[`Total de Itens: ${t.length}`],[`Valor Total (Custo): R$ ${r.toFixed(2)}`],[`Valor Total (Venda): R$ ${o.toFixed(2)}`],[`Lucro Potencial: R$ ${l.toFixed(2)}`],[`Margem Mdia: ${r>0?(l/r*100).toFixed(1):"0"}%`],[""],["DETALHAMENTO POR ITEM"],u,...c.map(v=>u.map(b=>v[b]))].map(v=>Array.isArray(v)?v.join(","):v).join(`
`),f=new Blob([h],{type:"text/csv;charset=utf-8;"}),p=document.createElement("a"),g=URL.createObjectURL(f);p.setAttribute("href",g),p.setAttribute("download",`relatorio-estoque-${new Date().toISOString().split("T")[0]}.csv`),p.style.visibility="hidden",document.body.appendChild(p),p.click(),document.body.removeChild(p)},Xz=({inventory:t,categories:s})=>{const a=s.reduce((h,f)=>(h[f.id]=f.name,h),{}),r=t.reduce((h,f)=>h+(f.cost||0)*f.currentStock,0),o=t.reduce((h,f)=>h+(f.salePrice||0)*f.currentStock,0),l=o-r,c=window.open("","_blank");if(!c)return;const u=`
    <!DOCTYPE html>
    <html>
    <head>
      <title>Relatrio de Estoque</title>
      <style>
        body { font-family: Arial, sans-serif; margin: 20px; }
        .header { text-align: center; margin-bottom: 30px; }
        .summary { background: #f5f5f5; padding: 15px; margin-bottom: 20px; border-radius: 5px; }
        .summary h3 { margin-top: 0; }
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
        th { background-color: #f2f2f2; font-weight: bold; }
        .low-stock { background-color: #fff3cd; }
        .no-sale { background-color: #f8d7da; }
        @media print {
          .no-print { display: none; }
        }
      </style>
    </head>
    <body>
      <div class="header">
        <h1>Relatrio de Estoque</h1>
        <p>Gerado em: ${new Date().toLocaleDateString("pt-BR")} s ${new Date().toLocaleTimeString("pt-BR")}</p>
      </div>
      
      <div class="summary">
        <h3>Resumo Geral</h3>
        <p><strong>Total de Itens:</strong> ${t.length}</p>
        <p><strong>Valor Total (Custo):</strong> R$ ${r.toFixed(2)}</p>
        <p><strong>Valor Total (Venda):</strong> R$ ${o.toFixed(2)}</p>
        <p><strong>Lucro Potencial:</strong> R$ ${l.toFixed(2)}</p>
        <p><strong>Margem Mdia:</strong> ${r>0?(l/r*100).toFixed(1):"0"}%</p>
      </div>

      <table>
        <thead>
          <tr>
            <th>Produto</th>
            <th>Categoria</th>
            <th>Estoque</th>
            <th>Custo Unit.</th>
            <th>Preo Venda</th>
            <th>Valor Total</th>
            <th>Status</th>
          </tr>
        </thead>
        <tbody>
          ${t.map(h=>{const f=h.currentStock<=h.minStock,p=!h.availableForSale;return`
              <tr class="${f?"low-stock":p?"no-sale":""}">
                <td>${h.name}</td>
                <td>${a[h.categoryId||""]||"Sem categoria"}</td>
                <td>${h.currentStock} ${h.unit}</td>
                <td>R$ ${(h.cost||0).toFixed(2)}</td>
                <td>R$ ${(h.salePrice||0).toFixed(2)}</td>
                <td>R$ ${((h.salePrice||0)*h.currentStock).toFixed(2)}</td>
                <td>${f?"Estoque Baixo":p?"No p/ Venda":"Normal"}</td>
              </tr>
            `}).join("")}
        </tbody>
      </table>
      
      <div class="no-print" style="margin-top: 20px; text-align: center;">
        <button onclick="window.print()" style="padding: 10px 20px; background: #007bff; color: white; border: none; border-radius: 5px; cursor: pointer;">
          Imprimir Relatrio
        </button>
      </div>
    </body>
    </html>
  `;c.document.write(u),c.document.close(),c.focus()},Qz=()=>{const t=Ks(),{inventory:s,inventoryCategories:a,removeInventoryItem:r,loadFullInventory:o}=Tt(),[l,c]=y.useState(!1),[u,h]=y.useState(null),[f,p]=y.useState("");Ye.useEffect(()=>{o()},[]);const g=N=>{h(N),c(!0)},v=()=>{h(null),c(!0)},b=()=>{c(!1),h(null)},_=y.useMemo(()=>s.filter(N=>N.name.toLowerCase().includes(f.toLowerCase())),[s,f]),w=y.useMemo(()=>{const N=s.reduce((S,C)=>S+C.cost*C.currentStock,0),k=s.filter(S=>S.currentStock<=S.minStock).length;return{totalValue:N,lowStockCount:k,totalItems:s.length}},[s]),E=()=>{Kz({inventory:s,categories:a})},T=()=>{Xz({inventory:s,categories:a})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Mdulo Estoque"}),e.jsx("p",{className:"text-gray-600",children:"Controle e gesto de inventrio"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 mt-4 sm:mt-0",children:[e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:T,className:"bg-gray-600 text-white px-4 py-3 rounded-lg font-medium hover:bg-gray-700 transition-colors flex items-center space-x-2",children:[e.jsx(pO,{size:18}),e.jsx("span",{children:"Imprimir"})]}),e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>t("/inventory/movements"),className:"bg-purple-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-purple-700 transition-colors flex items-center space-x-2",children:[e.jsx(ZR,{size:20}),e.jsx("span",{children:"Movimentaes"})]}),e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>t("/inventory/atualizacao-massiva"),className:"bg-green-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center space-x-2",children:[e.jsx(ua,{size:20}),e.jsx("span",{children:"Atualizao Massiva"})]}),e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:v,className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx(Zs,{size:20}),e.jsx("span",{children:"Novo Item"})]})]})]}),e.jsx(Yz,{inventory:s,onExportReport:E}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(Sp,{icon:kt,title:"Valor Total do Estoque (Custo)",value:`R$ ${w.totalValue.toFixed(2)}`,color:"green"}),e.jsx(Sp,{icon:ua,title:"Itens Totais",value:w.totalItems,color:"blue"}),e.jsx(Sp,{icon:mt,title:"Itens com Estoque Baixo",value:w.lowStockCount,color:"orange",onClick:()=>t("/inventory/estoque-baixo"),clickable:!0})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Itens do Inventrio"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ka,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar itens...",value:f,onChange:N=>p(N.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:_.map(N=>e.jsx(Wz,{item:N,categories:a,onEdit:g,onDelete:r},N.id))}),_.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhum item encontrado"})})]}),l&&e.jsx(Zz,{isOpen:l,onClose:b,item:u})]})},Sp=({icon:t,title:s,value:a,color:r,onClick:o,clickable:l=!1})=>{const c={green:"bg-green-100 text-green-600",blue:"bg-blue-100 text-blue-600",orange:"bg-orange-100 text-orange-600"},u="bg-white rounded-lg shadow-md p-6",h=l?"cursor-pointer hover:shadow-lg transition-shadow":"";return e.jsx(be.div,{className:`${u} ${h}`,onClick:o,whileHover:l?{scale:1.02}:{},whileTap:l?{scale:.98}:{},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:s}),e.jsx("p",{className:`text-3xl font-bold text-${r}-600`,children:a})]}),e.jsx("div",{className:`p-3 rounded-full ${c[r]}`,children:e.jsx(t,{className:"w-6 h-6"})})]})})},Jz=({isOpen:t,onClose:s,itens:a,categorias:r})=>{const[o,l]=y.useState(""),[c,u]=y.useState(""),[h,f]=y.useState(""),[p,g]=y.useState("telefone"),v=M=>{const z=M.replace(/\D/g,"");return z.length<=2?z:z.length<=7?`(${z.slice(0,2)}) ${z.slice(2)}`:`(${z.slice(0,2)}) ${z.slice(2,7)}-${z.slice(7,11)}`},b=M=>{const z=M.replace(/\D/g,"");return z.length===11&&z.startsWith("11",0)||z.length===11},_=(M,z)=>Math.max(z*2-M,z),w=()=>{const M=new Date,z=M.toLocaleDateString("pt-BR"),A=M.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),$=a.reduce((F,I)=>{var pe;const J=((pe=r.find(te=>te.id===I.categoryId))==null?void 0:pe.name)||"Sem Categoria";return F[J]||(F[J]=[]),F[J].push(I),F},{});let P=` *AABB - Lista de Compras*
`;return P+=` ${z} s ${A}

`,P+=` *ITENS PARA REPOSIO:*

`,Object.entries($).forEach(([F,I])=>{P+=` *${F.toUpperCase()}*
`,I.forEach(J=>{const pe=_(J.currentStock,J.minStock),te=J.currentStock===0?" ESGOTADO":" BAIXO";P+=` ${J.name}
`,P+=`  ${te} - Atual: ${J.currentStock} ${J.unit}
`,P+=`  Mnimo: ${J.minStock} ${J.unit}
`,P+=`  *Sugesto: ${pe} ${J.unit}*
`,J.supplier&&(P+=`  Fornecedor: ${J.supplier}
`),J.cost&&(P+=`  Custo: R$ ${J.cost.toFixed(2)}
`),P+=`
`}),P+=`
`}),P+=` *Observaes:*
`,P+=`- Quantidades baseadas no estoque mnimo
`,P+=`- Verificar disponibilidade com fornecedores
`,P+=`- Priorizar itens esgotados

`,P+=` Solicitado pelo Sistema AABB
`,P+=` Contato: (11) 99999-9999

`,P+=`---
`,P+="Sistema AABB - Gesto de Estoque",P},E=M=>{const z=v(M.target.value);l(z),c&&u("")},T=()=>{if(!b(o)){u("Nmero de telefone invlido. Use o formato (XX) XXXXX-XXXX");return}const M=w();f(M),g("mensagem")},N=()=>{const z=`55${o.replace(/\D/g,"")}`,A=encodeURIComponent(h),$=`https://web.whatsapp.com/send?phone=${z}&text=${A}`;if(!window.open($,"_blank")){const F=`whatsapp://send?phone=${z}&text=${A}`;window.location.href=F}s()},k=async()=>{try{await navigator.clipboard.writeText(h),alert("Mensagem copiada para a rea de transferncia!")}catch(M){console.error("Erro ao copiar mensagem:",M),alert("Erro ao copiar mensagem. Tente selecionar e copiar manualmente.")}},S=()=>{g("telefone"),f("")},C=()=>{l(""),u(""),f(""),g("telefone"),s()};return e.jsx(Wa,{children:t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(be.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:p==="telefone"?"Compartilhar no WhatsApp":"Confirmar Envio"}),e.jsx("button",{onClick:C,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(lt,{size:20,className:"text-gray-500"})})]}),e.jsx("div",{className:"p-6",children:p==="telefone"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Insira o nmero de telefone para enviar a lista de compras via WhatsApp."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nmero de Telefone"}),e.jsxs("div",{className:"relative",children:[e.jsx(Wu,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:o,onChange:E,placeholder:"(11) 99999-9999",className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent ${c?"border-red-300":"border-gray-300"}`,maxLength:15})]}),c&&e.jsx("p",{className:"text-red-600 text-sm",children:c})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Resumo da Lista"}),e.jsxs("p",{className:"text-blue-700 text-sm",children:[a.length," ",a.length===1?"item":"itens"," com estoque baixo sero includos na mensagem."]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-600 mb-4",children:["Mensagem que ser enviada para ",e.jsx("strong",{children:o}),":"]}),e.jsx("div",{className:"bg-gray-50 border rounded-lg p-4 max-h-96 overflow-y-auto",children:e.jsx("pre",{className:"text-sm text-gray-800 whitespace-pre-wrap font-mono",children:h})})]}),e.jsx("div",{className:"flex space-x-3",children:e.jsxs("button",{onClick:k,className:"flex-1 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(La,{size:16}),e.jsx("span",{children:"Copiar Mensagem"})]})})]})}),e.jsx("div",{className:"flex justify-between p-6 border-t bg-gray-50",children:p==="telefone"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:C,className:"px-6 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:T,disabled:!o,className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:e.jsx("span",{children:"Gerar Mensagem"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:S,className:"px-6 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Voltar"}),e.jsxs("button",{onClick:N,className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2",children:[e.jsx(NO,{size:16}),e.jsx("span",{children:"Enviar WhatsApp"})]})]})})]})})})},e$=()=>{const t=Ks(),{inventory:s,inventoryCategories:a}=Tt(),[r,o]=y.useState(!1),l=y.useMemo(()=>s.filter(f=>f.currentStock<=f.minStock),[s]),c=y.useMemo(()=>{const f=l.reduce((p,g)=>{var b;const v=((b=a.find(_=>_.id===g.categoryId))==null?void 0:b.name)||"Sem Categoria";return p[v]||(p[v]=[]),p[v].push(g),p},{});return Object.entries(f).sort(([p],[g])=>p.localeCompare(g))},[l,a]),u=(f,p)=>Math.max(p*2-f,p),h=()=>{o(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/inventory"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(fo,{size:20,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Itens com Estoque Baixo"}),e.jsxs("p",{className:"text-gray-600",children:[l.length," ",l.length===1?"item precisa":"itens precisam"," de reposio"]})]})]}),l.length>0&&e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:h,className:"bg-green-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center space-x-2",children:[e.jsx(CO,{size:20}),e.jsx("span",{children:"Compartilhar no WhatsApp"})]})]}),l.length===0?e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-green-50 border border-green-200 rounded-lg p-8 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-4 bg-green-100 rounded-full",children:e.jsx(ua,{className:"w-8 h-8 text-green-600"})})}),e.jsx("h3",{className:"text-xl font-semibold text-green-800 mb-2",children:"Parabns! Todos os itens esto com estoque adequado"}),e.jsx("p",{className:"text-green-600",children:"No h itens que precisam de reposio no momento."})]}):e.jsx("div",{className:"space-y-6",children:c.map(([f,p],g)=>e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:g*.1},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center space-x-2",children:[e.jsx(mt,{className:"w-5 h-5 text-orange-500"}),e.jsx("span",{children:f}),e.jsxs("span",{className:"text-sm text-gray-500 font-normal",children:["(",p.length," itens)"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(v=>{const b=u(v.currentStock,v.minStock),_=v.currentStock===0;return e.jsxs("div",{className:`p-4 rounded-lg border-2 ${_?"border-red-300 bg-red-50":"border-orange-300 bg-orange-50"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h4",{className:"font-semibold text-gray-800 text-sm",children:v.name}),_&&e.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full",children:"ESGOTADO"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Estoque Atual:"}),e.jsxs("span",{className:`font-medium ${_?"text-red-600":"text-orange-600"}`,children:[v.currentStock," ",v.unit]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Estoque Mnimo:"}),e.jsxs("span",{className:"font-medium text-gray-800",children:[v.minStock," ",v.unit]})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"text-gray-600",children:"Sugesto de Compra:"}),e.jsxs("span",{className:"font-bold text-blue-600",children:[b," ",v.unit]})]}),v.supplier&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Fornecedor:"}),e.jsx("span",{className:"font-medium text-gray-800 text-xs",children:v.supplier})]}),v.cost&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Custo Unit.:"}),e.jsxs("span",{className:"font-medium text-gray-800",children:["R$ ",v.cost.toFixed(2)]})]})]})]},v.id)})})]},f))}),e.jsx(Jz,{isOpen:r,onClose:()=>o(!1),itens:l,categorias:a})]})},t$=()=>{const t=Ks(),{inventory:s,inventoryCategories:a,updateInventoryItem:r}=Tt(),[o,l]=y.useState(""),[c,u]=y.useState(""),[h,f]=y.useState({}),[p,g]=y.useState(!1),v=y.useMemo(()=>s.filter(S=>{const C=S.name.toLowerCase().includes(o.toLowerCase()),M=!c||S.categoryId===c;return C&&M}),[s,o,c]),b=y.useMemo(()=>Object.values(h).filter(S=>S.selecionado),[h]),_=y.useMemo(()=>b.reduce((S,C)=>S+C.valorTotal,0),[b]),w=(S,C)=>{f(M=>{var z,A,$;return{...M,[S]:{...M[S],id:S,selecionado:C,quantidadeComprada:((z=M[S])==null?void 0:z.quantidadeComprada)||1,valorUnitario:((A=M[S])==null?void 0:A.valorUnitario)||0,valorTotal:(($=M[S])==null?void 0:$.valorTotal)||0}}})},E=(S,C)=>{C<0||f(M=>{const z=M[S]||{id:S,selecionado:!1,quantidadeComprada:0,valorUnitario:0,valorTotal:0},A=C*z.valorUnitario;return{...M,[S]:{...z,quantidadeComprada:C,valorTotal:A}}})},T=(S,C)=>{C<0||f(M=>{const z=M[S]||{id:S,selecionado:!1,quantidadeComprada:0,valorUnitario:0,valorTotal:0},A=z.quantidadeComprada*C;return{...M,[S]:{...z,valorUnitario:C,valorTotal:A}}})},N=async()=>{g(!0);try{const S=b.map(async C=>{const M=s.find(P=>P.id===C.id);if(!M)return;const z=M.currentStock+C.quantidadeComprada,A=C.valorUnitario>0?C.valorUnitario:M.cost,$={...M,currentStock:z,cost:A};await r($)});await Promise.all(S),f({}),alert(`${b.length} itens atualizados com sucesso!`)}catch(S){console.error("Erro ao atualizar estoque:",S),alert("Erro ao atualizar estoque. Tente novamente.")}finally{g(!1)}},k=S=>h[S]||{id:S,selecionado:!1,quantidadeComprada:1,valorUnitario:0,valorTotal:0};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/inventory"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(fo,{size:20,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Atualizao Massiva de Estoque"}),e.jsx("p",{className:"text-gray-600",children:"Selecione os itens comprados e atualize o estoque em lote"})]})]}),b.length>0&&e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:N,disabled:p,className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2 disabled:opacity-50",children:[e.jsx(oo,{size:20}),e.jsx("span",{children:p?"Salvando...":`Salvar ${b.length} Itens`})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ka,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar produtos...",value:o,onChange:S=>l(S.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:c,onChange:S=>u(S.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todas as categorias"}),a.map(S=>e.jsx("option",{value:S.id,children:S.name},S.id))]}),e.jsxs("button",{onClick:()=>{const S=v.filter(M=>M.currentStock<=M.minStock),C={...h};S.forEach(M=>{const z=Math.max(M.minStock*2-M.currentStock,M.minStock);C[M.id]={id:M.id,selecionado:!0,quantidadeComprada:z,valorUnitario:M.cost||0,valorTotal:z*(M.cost||0)}}),f(C)},className:"bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(ua,{size:16}),e.jsx("span",{children:"Selecionar Estoque Baixo"})]}),e.jsxs("button",{onClick:()=>f({}),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(lt,{size:16}),e.jsx("span",{children:"Limpar Seleo"})]})]})}),b.length>0&&e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:b.length}),e.jsx("p",{className:"text-blue-800 text-sm",children:"Itens Selecionados"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:b.reduce((S,C)=>S+C.quantidadeComprada,0)}),e.jsx("p",{className:"text-blue-800 text-sm",children:"Quantidade Total"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["R$ ",_.toFixed(2)]}),e.jsx("p",{className:"text-blue-800 text-sm",children:"Valor Total"})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Produtos Disponveis (",v.length,")"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Selecionar"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estoque Atual"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantidade Comprada"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor Unitrio"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Novo Estoque"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(S=>{const C=k(S.id),M=a.find(A=>A.id===S.categoryId),z=S.currentStock+(C.selecionado?C.quantidadeComprada:0);return e.jsxs("tr",{className:C.selecionado?"bg-blue-50":"",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",checked:C.selecionado,onChange:A=>w(S.id,A.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:S.name}),e.jsx("div",{className:"text-sm text-gray-500",children:M==null?void 0:M.name})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("span",{className:`text-sm font-medium ${S.currentStock<=S.minStock?"text-red-600":"text-gray-900"}`,children:[S.currentStock," ",S.unit]}),S.currentStock<=S.minStock&&e.jsx("div",{className:"text-xs text-red-500",children:"Estoque baixo"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.selecionado?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>E(S.id,C.quantidadeComprada-1),className:"p-1 hover:bg-gray-200 rounded",children:e.jsx($i,{size:16})}),e.jsx("input",{type:"number",min:"0",value:C.quantidadeComprada,onChange:A=>E(S.id,parseInt(A.target.value)||0),className:"w-20 px-2 py-1 text-center border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{onClick:()=>E(S.id,C.quantidadeComprada+1),className:"p-1 hover:bg-gray-200 rounded",children:e.jsx(Zs,{size:16})}),e.jsx("span",{className:"text-sm text-gray-500",children:S.unit})]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.selecionado?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm",children:"R$"}),e.jsx("input",{type:"number",min:"0",step:"0.01",value:C.valorUnitario,onChange:A=>T(S.id,parseFloat(A.target.value)||0),className:"w-24 px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",placeholder:"0,00"})]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:C.selecionado?e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["R$ ",C.valorTotal.toFixed(2)]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("span",{className:`text-sm font-medium ${C.selecionado?"text-green-600":"text-gray-500"}`,children:[z," ",S.unit]}),C.selecionado&&C.quantidadeComprada>0&&e.jsxs("div",{className:"text-xs text-green-500",children:["+",C.quantidadeComprada," ",S.unit]})]})]},S.id)})})]})}),v.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ua,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhum produto encontrado"})]})]})]})},s$={entrada_compra:"Compra",entrada_ajuste:"Ajuste de Entrada",entrada_devolucao:"Devoluo",saida_venda:"Venda",saida_perda:"Perda/Quebra",saida_ajuste:"Ajuste de Sada",saida_transferencia:"Transferncia"};function a$(){const[t,s]=y.useState([]),[a,r]=y.useState(!0),[o,l]=y.useState("all"),[c,u]=y.useState(""),[h,f]=y.useState(""),[p,g]=y.useState("");y.useEffect(()=>{v()},[o,c,h,p]);const v=async()=>{r(!0);try{console.log(" Carregando movimentaes...");let w=V.from("inventory_movements").select(`
          *,
          inventory_item:inventory_items(name, unit)
        `).order("created_at",{ascending:!1}).limit(100);if(o!=="all"&&(o==="entrada"?w=w.like("movement_type","entrada_%"):o==="saida"&&(w=w.like("movement_type","saida_%"))),h&&(w=w.gte("created_at",new Date(h).toISOString())),p){const N=new Date(p);N.setHours(23,59,59),w=w.lte("created_at",N.toISOString())}const{data:E,error:T}=await w;if(console.log(" Resultado da query:",{data:E,error:T,count:E==null?void 0:E.length}),T)throw console.error(" Erro na query:",T),T;s(E||[]),console.log(" Movimentaes carregadas:",(E==null?void 0:E.length)||0)}catch(w){console.error(" Erro ao carregar movimentaes:",w)}finally{r(!1)}},b={totalEntradas:t.filter(w=>w.movement_type.startsWith("entrada_")).length,totalSaidas:t.filter(w=>w.movement_type.startsWith("saida_")).length,quantidadeEntrada:t.filter(w=>w.movement_type.startsWith("entrada_")).reduce((w,E)=>w+Number(E.quantity),0),quantidadeSaida:t.filter(w=>w.movement_type.startsWith("saida_")).reduce((w,E)=>w+Number(E.quantity),0)},_=w=>w.startsWith("entrada_");return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Movimentaes de Estoque"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Histrico completo de entradas e sadas"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Entradas"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:b.totalEntradas})]}),e.jsx(ma,{className:"h-8 w-8 text-green-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Sadas"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:b.totalSaidas})]}),e.jsx(Yu,{className:"h-8 w-8 text-red-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Qtd. Entrada"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:b.quantidadeEntrada.toFixed(2)})]}),e.jsx(wj,{className:"h-8 w-8 text-green-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Qtd. Sada"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:b.quantidadeSaida.toFixed(2)})]}),e.jsx(vj,{className:"h-8 w-8 text-red-600"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(vg,{className:"h-5 w-5 text-gray-500"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Filtros"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),e.jsxs("select",{value:o,onChange:w=>l(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"Todos"}),e.jsx("option",{value:"entrada",children:"Entradas"}),e.jsx("option",{value:"saida",children:"Sadas"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Inicial"}),e.jsx("input",{type:"date",value:h,onChange:w=>f(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Final"}),e.jsx("input",{type:"date",value:p,onChange:w=>g(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>{l("all"),u(""),f(""),g("")},className:"w-full px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Limpar Filtros"})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Movimentaes (",t.length,")"]})}),a?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(ua,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhuma movimentao encontrada"})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:t.map(w=>{var T,N;const E=_(w.movement_type);return e.jsx("div",{className:"p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:E?e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(wj,{className:"h-6 w-6 text-green-600"})}):e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(vj,{className:"h-6 w-6 text-red-600"})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${E?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s$[w.movement_type]||w.movement_type}),e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:((T=w.inventory_item)==null?void 0:T.name)||"Item no encontrado"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Quantidade:"}),e.jsxs("span",{className:"ml-2 font-medium text-gray-900",children:[w.quantity," ",((N=w.inventory_item)==null?void 0:N.unit)||""]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Estoque:"}),e.jsxs("span",{className:"ml-2 font-medium text-gray-900",children:[w.stock_before,"  ",w.stock_after]})]}),w.unit_cost&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Custo Unit.:"}),e.jsxs("span",{className:"ml-2 font-medium text-gray-900",children:["R$ ",Number(w.unit_cost).toFixed(2)]})]}),w.total_cost&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Custo Total:"}),e.jsxs("span",{className:"ml-2 font-medium text-gray-900",children:["R$ ",Number(w.total_cost).toFixed(2)]})]})]}),(w.reference_document||w.notes)&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600 space-y-1",children:[w.reference_document&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Referncia:"})," ",w.reference_document]}),w.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Obs:"})," ",w.notes]})]})]}),e.jsxs("div",{className:"flex-shrink-0 text-right",children:[e.jsx("div",{className:"text-sm text-gray-500",children:St(new Date(w.created_at),"dd/MM/yyyy",{locale:ss})}),e.jsx("div",{className:"text-xs text-gray-400",children:St(new Date(w.created_at),"HH:mm",{locale:ss})})]})]})})]})},w.id)})})]})]})})}const r$=({isOpen:t,onClose:s,member:a})=>{const{addMember:r,updateMember:o}=Tt(),{register:l,handleSubmit:c,control:u,reset:h,formState:{errors:f}}=Rg(),[p,g]=y.useState(!1);y.useEffect(()=>{h(a||{name:"",email:"",phone:"",avatar:`https://api.dicebear.com/8.x/initials/svg?seed=${name||"user"}`,status:"active",membershipType:"individual"})},[a,h]);const v=async w=>{g(!0);try{a?await o({...a,...w}):await r(w),s()}catch(E){console.error("Falha ao salvar o scio:",E)}finally{g(!1)}},b=["active","inactive","pending"],_=["individual","family","vip"];return e.jsx(Wa,{children:t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs(be.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-lg shadow-xl w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:a?"Editar Scio":"Novo Scio"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx(lt,{size:24})})]}),e.jsxs("form",{onSubmit:c(v),className:"p-6 space-y-4",children:[e.jsx(hi,{label:"Nome Completo",error:f.name,children:e.jsx("input",{...l("name",{required:"Nome  obrigatrio"}),className:"form-input",disabled:p})}),e.jsx(hi,{label:"Email",error:f.email,children:e.jsx("input",{type:"email",...l("email",{required:"Email  obrigatrio",pattern:{value:/^\S+@\S+$/i,message:"Email invlido"}}),className:"form-input",disabled:p})}),e.jsx(hi,{label:"Telefone",error:f.phone,children:e.jsx("input",{...l("phone",{required:"Telefone  obrigatrio"}),className:"form-input",disabled:p})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(hi,{label:"Status",error:f.status,children:e.jsx(ro,{name:"status",control:u,render:({field:w})=>e.jsx("select",{...w,className:"form-input",disabled:p,children:b.map(E=>e.jsx("option",{value:E,className:"capitalize",children:E},E))})})}),e.jsx(hi,{label:"Tipo de Plano",error:f.membershipType,children:e.jsx(ro,{name:"membershipType",control:u,render:({field:w})=>e.jsx("select",{...w,className:"form-input",disabled:p,children:_.map(E=>e.jsx("option",{value:E,className:"capitalize",children:E},E))})})})]}),e.jsx(hi,{label:"URL do Avatar",error:f.avatar,children:e.jsx("input",{...l("avatar"),className:"form-input",disabled:p})}),e.jsxs("div",{className:"pt-4 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",disabled:p,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-wait",disabled:p,children:p?"Salvando...":a?"Salvar Alteraes":"Adicionar Scio"})]})]})]})})})},hi=({label:t,children:s,error:a})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),s,a&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.message})]}),n$=({member:t,onEdit:s})=>{const a={active:"bg-green-100 text-green-800",inactive:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800"},r={active:"Ativo",inactive:"Inativo",pending:"Pendente"};return e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white border border-gray-200 rounded-lg p-4 text-center hover:shadow-xl transition-shadow flex flex-col",children:[e.jsxs("div",{className:"relative self-center",children:[e.jsx("img",{src:t.avatar,alt:t.name,className:"w-24 h-24 rounded-full mx-auto mb-4 object-cover"}),e.jsx("span",{className:`absolute bottom-1 right-1 block h-4 w-4 rounded-full border-2 border-white ${t.status==="active"?"bg-green-500":t.status==="inactive"?"bg-red-500":"bg-yellow-500"}`})]}),e.jsx("h3",{className:"font-bold text-lg text-gray-800",children:t.name}),e.jsx("p",{className:`text-xs font-medium px-2 py-0.5 rounded-full self-center my-2 ${a[t.status]}`,children:r[t.status]}),e.jsx("div",{className:"text-sm text-gray-600 capitalize mb-4",children:t.membershipType}),e.jsxs("div",{className:"text-left space-y-2 text-xs text-gray-500 border-t pt-3 mt-auto",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ki,{size:14}),e.jsx("span",{children:t.email})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Wu,{size:14}),e.jsx("span",{children:t.phone})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Mr,{size:14}),e.jsxs("span",{children:["Scio desde ",St(t.joinDate,"MMM yyyy",{locale:ss})]})]})]}),e.jsxs("button",{onClick:()=>s(t),className:"mt-4 w-full bg-gray-100 text-gray-700 py-2 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(lo,{size:14}),e.jsx("span",{children:"Editar Perfil"})]})]})},o$=()=>{const{members:t}=Tt(),[s,a]=y.useState(!1),[r,o]=y.useState(null),[l,c]=y.useState(""),[u,h]=y.useState("all"),f=_=>{o(_),a(!0)},p=()=>{o(null),a(!0)},g=()=>{a(!1),o(null)},v=y.useMemo(()=>t.filter(_=>{const w=_.name.toLowerCase().includes(l.toLowerCase()),E=u==="all"||_.status===u;return w&&E}),[t,l,u]),b=y.useMemo(()=>{const _=TP(new Date);return{total:t.length,active:t.filter(w=>w.status==="active").length,newThisMonth:t.filter(w=>kP(w.joinDate,_)).length}},[t]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Scios do Clube"}),e.jsx("p",{className:"text-gray-600",children:"Gesto completa de scios do clube"})]}),e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:p,className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2 mt-4 sm:mt-0",children:[e.jsx(Zs,{size:20}),e.jsx("span",{children:"Novo Scio"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(Ep,{icon:Ss,title:"Total de Scios",value:b.total,color:"blue"}),e.jsx(Ep,{icon:JN,title:"Scios Ativos",value:b.active,color:"green"}),e.jsx(Ep,{icon:Ou,title:"Novos (ltimo Ms)",value:b.newThisMonth,color:"purple"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4 sm:mb-0",children:"Lista de Scios"}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Ka,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar scios...",value:l,onChange:_=>c(_.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:u,onChange:_=>h(_.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"active",children:"Ativo"}),e.jsx("option",{value:"inactive",children:"Inativo"}),e.jsx("option",{value:"pending",children:"Pendente"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:v.map(_=>e.jsx(n$,{member:_,onEdit:f},_.id))}),v.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhum scio encontrado"})})]}),s&&e.jsx(r$,{isOpen:s,onClose:g,member:r})]})},Ep=({icon:t,title:s,value:a,color:r})=>{const o={green:"bg-green-100 text-green-600",blue:"bg-blue-100 text-blue-600",purple:"bg-purple-100 text-purple-600"};return e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:s}),e.jsx("p",{className:`text-3xl font-bold text-${r}-600`,children:a})]}),e.jsx("div",{className:`p-3 rounded-full ${o[r]}`,children:e.jsx(t,{className:"w-6 h-6"})})]})})},Yi=()=>{const[t,s]=y.useState([]),[a,r]=y.useState(!0),[o,l]=y.useState(null),c=async()=>{try{r(!0),console.log("useComandas - Fetching comandas...");const{data:P,error:F}=await V.from("comandas").select(`
          *,
          bar_tables (
            id,
            number,
            capacity
          ),
          comanda_items (
            *,
            menu_items (
              name,
              price,
              category
            )
          )
        `).order("created_at",{ascending:!1});if(console.log("useComandas - Query result:",{data:P,error:F}),F)throw F;s(P||[]),console.log("useComandas - Comandas set:",P||[])}catch(P){console.error("useComandas - Error:",P),l(P instanceof Error?P.message:"Erro ao carregar comandas")}finally{r(!1)}},u=async P=>{try{console.log(" createComanda chamada com dados:",P);const{data:{user:F}}=await V.auth.getUser();if(!F)throw new Error("Usurio no autenticado");const{data:I,error:J}=await V.from("usuarios_empresa").select("empresa_id").eq("user_id",F.id).eq("status","ativo").single();if(J||!I)throw new Error("Empresa do usurio no encontrada");const pe={...P,status:"open",opened_at:new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString(),empresa_id:I.empresa_id};console.log(" Dados que sero inseridos:",pe);const{data:te,error:L}=await V.from("comandas").insert(pe).select().single();if(L)throw L;return s(G=>[te,...G]),te}catch(F){throw new Error(F instanceof Error?F.message:"Erro ao criar comanda")}},h=async(P,F)=>{try{const{data:I,error:J}=await V.from("comandas").update({...F,updated_at:new Date().toISOString()}).eq("id",P).select().single();if(J)throw J;return s(pe=>pe.map(te=>te.id===P?I:te)),I}catch(I){throw new Error(I instanceof Error?I.message:"Erro ao atualizar comanda")}},f=async(P,F)=>{try{const{data:I,error:J}=await V.from("comandas").update({status:"closed",closed_at:new Date().toISOString(),payment_method:F,updated_at:new Date().toISOString()}).eq("id",P).select().single();if(J)throw J;return s(pe=>pe.map(te=>te.id===P?I:te)),I}catch(I){throw new Error(I instanceof Error?I.message:"Erro ao fechar comanda")}},p=async(P,F)=>{try{const I=P.map(L=>V.from("comandas").update({status:"closed",closed_at:new Date().toISOString(),payment_method:F,updated_at:new Date().toISOString()}).eq("id",L).select().single()),J=await Promise.all(I),pe=J.filter(L=>L.error);if(pe.length>0)throw new Error(`Erro ao finalizar ${pe.length} comandas`);const te=J.map(L=>L.data).filter(Boolean);return s(L=>L.map(G=>te.find(xe=>(xe==null?void 0:xe.id)===G.id)||G)),te}catch(I){throw new Error(I instanceof Error?I.message:"Erro ao finalizar comandas pagas")}},g=async P=>{try{const{error:F}=await V.from("comandas").delete().eq("id",P);if(F)throw F;s(I=>I.filter(J=>J.id!==P))}catch(F){throw new Error(F instanceof Error?F.message:"Erro ao excluir comanda")}},v=P=>t.filter(F=>F.table_id===P),b=P=>t.filter(F=>F.table_id===P&&F.status==="open"),_=P=>t.filter(F=>F.table_id===P&&F.status==="pending_payment"),w=async(P,F,I,J)=>u({table_id:P,employee_id:F,customer_name:I,people_count:J}),E=async(P,F)=>h(P,{table_id:F}),T=async(P,F)=>{try{console.warn("Funo mergeComandas temporariamente desabilitada devido a limitaes de tipo"),await g(P)}catch(I){throw new Error(I instanceof Error?I.message:"Erro ao mesclar comandas")}},N=async P=>{try{return console.warn("Funo recalculateComandaTotal temporariamente simplificada devido a limitaes de tipo"),h(P,{total:0})}catch(F){throw new Error(F instanceof Error?F.message:"Erro ao recalcular total")}},k=P=>t.find(F=>F.id===P),S=()=>t.filter(P=>P.status==="open"),C=P=>t.filter(F=>F.status===P),M=P=>t.filter(F=>F.employee_id===P),z=P=>t.filter(F=>{var I;return(I=F.customer_name)==null?void 0:I.toLowerCase().includes(P.toLowerCase())}),A=()=>t.filter(P=>P.status==="closed").reduce((P,F)=>P+(F.total||0),0),$=()=>{const P=t.filter(I=>I.status==="closed");return P.length===0?0:P.reduce((I,J)=>I+(J.total||0),0)/P.length};return y.useEffect(()=>{c();const P=V.channel("comandas_changes").on("postgres_changes",{event:"*",schema:"public",table:"comandas"},F=>{console.log("Mudana em comandas:",F),F.eventType==="INSERT"?s(I=>[F.new,...I]):F.eventType==="UPDATE"?s(I=>I.map(J=>J.id===F.new.id?F.new:J)):F.eventType==="DELETE"&&s(I=>I.filter(J=>J.id!==F.old.id))}).subscribe();return()=>{P.unsubscribe()}},[]),{comandas:t,loading:a,error:o,refetch:c,createComanda:u,updateComanda:h,closeComanda:f,deleteComanda:g,finalizarComandasPagas:p,getComandasByTableId:v,getOpenComandasByTableId:b,getPendingPaymentComandasByTableId:_,createComandaForTable:w,transferComandaToTable:E,mergeComandas:T,recalculateComandaTotal:N,getComandaById:k,getOpenComandas:S,getComandasByStatus:C,getComandasByEmployee:M,getComandasByCustomer:z,getTotalSales:A,getAverageComandaValue:$}},i$=({mode:t,onModeChange:s,user:a})=>{const r={balcao:"Balco",mesas:"Mesas",comandas:"Comandas",fila:"Fila",pedidos:"Preparo"},o={balcao:"Balco",mesas:"Mesas",comandas:"Comandas",fila:"Fila de Pedidos",pedidos:"Pedidos Bar"},l={balcao:"",mesas:"",comandas:"",fila:"",pedidos:""};return e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-10",children:e.jsx("div",{className:"px-2 sm:px-4 lg:px-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center py-3 space-y-3 lg:space-y-0 min-h-16",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 min-w-0 flex-1",children:[e.jsxs("h1",{className:"text-base sm:text-lg lg:text-xl font-semibold text-gray-900 truncate",children:[e.jsx("span",{className:"hidden sm:inline",children:"Sistema de Atendimento - "}),"Bar"]}),a&&e.jsxs("span",{className:"text-xs sm:text-sm text-gray-500 mt-1 sm:mt-0 truncate",children:[e.jsx("span",{className:"hidden sm:inline",children:"Atendente: "}),a.full_name||a.name||"Usurio"]})]}),e.jsx("nav",{className:"flex flex-wrap gap-1 sm:gap-2",children:Object.keys(r).map(c=>e.jsxs("button",{onClick:()=>s(c),className:`
                  flex items-center space-x-1 sm:space-x-2 px-2 sm:px-3 py-2 rounded-lg font-medium transition-colors text-xs sm:text-sm
                  ${t===c?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}
                `,children:[e.jsx("span",{className:"text-sm sm:text-lg",children:l[c]}),e.jsx("span",{className:"hidden sm:inline",children:o[c]}),e.jsx("span",{className:"sm:hidden",children:r[c]})]},c))})]})})})};function l$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const Yj=y.forwardRef(l$);function c$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"}))}const Kj=y.forwardRef(c$);function d$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const U2=y.forwardRef(d$);function u$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.76c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.076-4.076a1.526 1.526 0 0 1 1.037-.443 48.282 48.282 0 0 0 5.68-.494c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"}))}const m$=y.forwardRef(u$);function h$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Ha=y.forwardRef(h$);function f$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const p$=y.forwardRef(f$);function g$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Ga=y.forwardRef(g$);function x$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const Xj=y.forwardRef(x$);function y$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const B2=y.forwardRef(y$);function b$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const cn=y.forwardRef(b$);function v$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"}))}const w$=y.forwardRef(v$);function j$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const _r=y.forwardRef(j$);function _$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))}const N$=y.forwardRef(_$);function S$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const E$=y.forwardRef(S$);function C$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const k$=y.forwardRef(C$);function T$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const nm=y.forwardRef(T$);function A$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14"}))}const M$=y.forwardRef(A$);function R$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const Sm=y.forwardRef(R$);function O$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"}))}const _0=y.forwardRef(O$);function D$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const Ui=y.forwardRef(D$);function P$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m10.5 0a48.536 48.536 0 0 0-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5Zm-3 0h.008v.008H15V10.5Z"}))}const z$=y.forwardRef(P$);function $$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"}))}const L$=y.forwardRef($$);function I$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"}))}const U$=y.forwardRef(I$);function B$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125M3.375 19.5h7.5c.621 0 1.125-.504 1.125-1.125m-9.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-7.5A1.125 1.125 0 0 1 12 18.375m9.75-12.75c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125m19.5 0v1.5c0 .621-.504 1.125-1.125 1.125M2.25 5.625v1.5c0 .621.504 1.125 1.125 1.125m0 0h17.25m-17.25 0h7.5c.621 0 1.125.504 1.125 1.125M3.375 8.25c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m17.25-3.75h-7.5c-.621 0-1.125.504-1.125 1.125m8.625-1.125c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M12 10.875v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125M13.125 12h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125M20.625 12c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5M12 14.625v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 14.625c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m0 1.5v-1.5m0 0c0-.621.504-1.125 1.125-1.125m0 0h7.5"}))}const V$=y.forwardRef(B$);function q$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const Em=y.forwardRef(q$);function F$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const Za=y.forwardRef(F$);function H$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const om=y.forwardRef(H$);function G$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17 17.25 21A2.652 2.652 0 0 0 21 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 1 1-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 0 0 4.486-6.336l-3.276 3.277a3.004 3.004 0 0 1-2.25-2.25l3.276-3.276a4.5 4.5 0 0 0-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437 1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008Z"}))}const Z$=y.forwardRef(G$);function W$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Y$=y.forwardRef(W$);function K$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Ki=y.forwardRef(K$),V2=(t=!1)=>{const[s,a]=y.useState([]),[r,o]=y.useState(!0),[l,c]=y.useState(null),u=async()=>{try{o(!0),console.log("Fetching menu items...");try{const{data:S,error:C}=await V.from("menu_items").select("count").limit(1);if(C&&C.message.includes("JWT"))throw new Error("Supabase no configurado")}catch(S){console.error("Supabase no configurado. Criando dados mock...",S);const C=[{id:"mock-1",name:"Cerveja Pilsen",description:"Cerveja gelada 350ml",price:8.5,category:"Bebidas",image_url:void 0,available:!0,preparation_time:0,item_type:"prepared",direct_inventory_item_id:void 0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"mock-2",name:"Refrigerante",description:"Coca-Cola 350ml",price:5,category:"Bebidas",image_url:void 0,available:!0,preparation_time:0,item_type:"prepared",direct_inventory_item_id:void 0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"mock-3",name:"Poro de Batata",description:"Batata frita crocante",price:15,category:"Petiscos",image_url:void 0,available:!0,preparation_time:15,item_type:"prepared",direct_inventory_item_id:void 0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}];a(C),c("Dados de exemplo sendo exibidos. Configure o Supabase para usar dados reais.");return}const{data:p,error:g}=await V.from("menu_items").select("*");console.log("All menu items:",p,"Error:",g);const{data:v}=await V.auth.getUser();if(!v.user)throw new Error("Usurio no autenticado");const{data:b,error:_}=await V.from("usuarios_empresa").select("empresa_id").eq("user_id",v.user.id).eq("status","ativo").single();if(_||!b)throw new Error("Usurio no vinculado a nenhuma empresa");const w=b.empresa_id;console.log(" Carregando menu items para empresa_id:",w),console.log(" Parmetros de busca:",{includeDirectItems:t,empresaId:w});let E=V.from("menu_items").select(`
          *,
          inventory_items!left(
            name,
            image_url,
            current_stock,
            min_stock,
            unit,
            available_for_sale
          )
        `).eq("empresa_id",w).order("category",{ascending:!0}).order("name",{ascending:!0});console.log(" Filtro empresa_id aplicado:",w),t?console.log(" Incluindo itens diretos"):(console.log(" Excluindo itens diretos"),E=E.neq("item_type","direct")),E=E.eq("available",!0),console.log(" Buscando apenas itens disponveis da empresa...");const{data:T,error:N}=await E;if(console.log(" Menu items da empresa:",(T==null?void 0:T.length)||0,"Error:",N),console.log(" Query executada com filtros:",{empresa_id:w,includeDirectItems:t,available:!0,totalFound:(T==null?void 0:T.length)||0}),T&&T.length>0)console.log(" Itens encontrados na consulta filtrada:"),T.forEach((S,C)=>{console.log(`${C+1}. ${S.name}:`,{id:S.id,available:S.available,item_type:S.item_type,empresa_id:S.empresa_id,direct_inventory_item_id:S.direct_inventory_item_id})});else{console.log(" Nenhum item encontrado na consulta filtrada"),console.log(" Fazendo consulta simples para debug...");const{data:S,error:C}=await V.from("menu_items").select("*").eq("empresa_id",w);console.log(" Consulta simples resultado:",S,"Error:",C)}if(N)throw N;if(!T||T.length===0){console.log(" Nenhum menu item encontrado para empresa_id:",w),console.log(" Isolamento multitenant ativo - no exibindo dados de outras empresas"),a([]),c("Nenhum item encontrado no menu para esta empresa. Entre em contato com o administrador.");return}const k=(T||[]).map(S=>{const C=S.inventory_items,M=S.item_type==="direct";return{id:S.id,name:M&&(C!=null&&C.name)?C.name:S.name,description:S.description||"",price:typeof S.price=="string"?parseFloat(S.price):S.price||0,category:S.category||"",image_url:M&&(C!=null&&C.image_url)?C.image_url:S.image_url||void 0,available:S.available||!1,preparation_time:S.preparation_time||0,item_type:S.item_type||"prepared",direct_inventory_item_id:S.direct_inventory_item_id||void 0,created_at:S.created_at||void 0,updated_at:S.updated_at||void 0,inventory_items:C?{id:"",name:C.name||"",currentStock:C.current_stock||0,minStock:C.min_stock||0,unit:C.unit||"unidades",lastUpdated:new Date,cost:0,availableForSale:C.available_for_sale||!1,image_url:C.image_url||void 0}:void 0}});console.log("Mapped items:",k),a(k)}catch(p){console.error("Error in fetchMenuItems:",p),c(p instanceof Error?p.message:"Erro ao carregar itens do menu")}finally{o(!1)}},h=p=>s.filter(g=>g.category===p),f=()=>s.filter(p=>p.available);return y.useEffect(()=>{u()},[t]),{menuItems:s,loading:r,error:l,refetch:u,getItemsByCategory:h,getAvailableItems:f}},Cm=()=>{const{user:t}=Et(),{refreshKitchenOrders:s,refreshBarOrders:a}=Tt(),[r,o]=y.useState({orders:[],metrics:null,loading:!0,error:null}),l=y.useCallback(C=>{o(M=>({...M,...C}))},[]),c=y.useCallback((C,M)=>{console.error(`Erro em ${M}:`,C),l({error:`Erro em ${M}: ${C.message||"Erro desconhecido"}`,loading:!1})},[l]),u=y.useCallback(async()=>{if(t)try{console.log(" loadOrders: Iniciando carregamento de pedidos..."),l({loading:!0,error:null});const{data:C,error:M}=await V.from("balcao_orders_with_details").select("*").order("created_at",{ascending:!1}).limit(50);if(M)throw M;const z=await Promise.all((C||[]).map(async A=>{const{data:$,error:P}=await V.from("balcao_order_items").select(`
              *,
              menu_items:menu_item_id (
                id,
                name,
                category,
                price,
                preparation_time,
                item_type
              )
            `).eq("balcao_order_id",A.id);return P&&console.warn(`Erro ao carregar itens do pedido ${A.id}:`,P),{...A,items:($==null?void 0:$.map(F=>({...F,menu_item:Array.isArray(F.menu_items)?F.menu_items[0]:F.menu_items})))||[]}}));console.log(" loadOrders: Pedidos carregados:",z.length),console.log(" loadOrders: Status dos pedidos:",z.map(A=>({id:A.id.slice(-4),status:A.status}))),l({orders:z,loading:!1})}catch(C){c(C,"carregamento de pedidos")}},[t,l,c]),h=y.useCallback(async C=>{if(!t)throw new Error("Usurio no autenticado");try{console.log(" Iniciando criao de pedido:",C),l({loading:!0,error:null});const M=await bt();if(!M)throw new Error("No foi possvel identificar a empresa do usurio");console.log(" Empresa ID identificada:",M);const z=C.items.reduce((L,G)=>L+G.unit_price*G.quantity,0),A=C.discount_amount||0,$=z-A;console.log(" Totais calculados:",{totalAmount:z,discountAmount:A,finalAmount:$});const P={employee_id:t.id,customer_name:C.customer_name||null,customer_phone:C.customer_phone||null,total_amount:z,discount_amount:A,final_amount:$,notes:C.notes||null,customer_notes:C.customer_notes||null,status:"pending_payment",empresa_id:M};console.log(" Dados do pedido para insero:",P);const{data:F,error:I}=await V.from("balcao_orders").insert(P).select().single();if(I)throw console.error(" Erro ao inserir pedido:",I),I;console.log(" Pedido criado com sucesso:",F);const J=C.items.map(L=>({balcao_order_id:F.id,menu_item_id:L.menu_item_id,quantity:L.quantity,unit_price:L.unit_price,total_price:L.unit_price*L.quantity,notes:L.notes||null,status:"pending"}));console.log(" Itens para insero:",J);const{data:pe,error:te}=await V.from("balcao_order_items").insert(J).select();if(te)throw console.error(" Erro ao inserir itens do pedido:",te),te;return console.log(" Itens inseridos com sucesso:",pe),await u(),F.id}catch(M){throw c(M,"criao de pedido"),M}},[t,l,c,u]),f=y.useCallback(async(C,M)=>{try{l({loading:!0,error:null});const z={status:M.status,updated_at:new Date().toISOString()};M.status==="paid"?(z.payment_method=M.payment_method,z.cash_session_id=M.cash_session_id,z.paid_at=new Date().toISOString()):M.status==="preparing"?z.preparation_started_at=new Date().toISOString():M.status==="ready"?z.preparation_completed_at=new Date().toISOString():M.status==="delivered"&&(z.delivered_at=new Date().toISOString(),z.delivered_by=M.delivered_by||(t==null?void 0:t.id)),M.notes&&(z.notes=M.notes);const{error:A}=await V.from("balcao_orders").update(z).eq("id",C);if(A)throw A;await u()}catch(z){throw c(z,"atualizao de status do pedido"),z}},[l,c,u,t]),p=y.useCallback(async C=>{try{console.log(" Iniciando processamento de pagamento:",C.order_id);const{data:M,error:z}=await V.from("balcao_orders").select("order_number, customer_name").eq("id",C.order_id).single();if(z)throw console.error(" Erro ao buscar dados do pedido:",z),z;await f(C.order_id,{status:"paid",payment_method:C.payment_method,cash_session_id:C.cash_session_id,notes:C.notes}),console.log(" Registrando transao no caixa..."),console.log(" Dados do pedido:",M);const A=M.order_number.toString().padStart(4,"0"),$=M.customer_name?` - ${M.customer_name}`:"",P=`Pedido Balco #${A}${$}`;console.log(" Nota que ser salva:",P);const F=await bt();if(!F)throw new Error("No foi possvel identificar a empresa do usurio");const I={cash_session_id:C.cash_session_id,transaction_type:"sale",payment_method:C.payment_method,amount:C.amount_paid,processed_by:t.id,notes:P,empresa_id:F};console.log(" Dados da transao de balco:",I);const{data:J,error:pe}=await V.from("cash_transactions").insert(I).select().single();if(pe)throw console.error(" Erro ao inserir transao de balco:",pe),pe;if(console.log(" Transao de balco inserida:",J),pe)throw pe;console.log(" Pagamento processado com sucesso!"),console.log(" Forando atualizao dos monitores em mltiplas camadas..."),setTimeout(async()=>{await Promise.all([s(),a()]),console.log(" Primeira atualizao dos monitores concluda!")},500),setTimeout(async()=>{await Promise.all([s(),a(),u()]),console.log(" Atualizao backup dos monitores concluda!")},1500)}catch(M){throw c(M,"processamento de pagamento"),M}},[f,c,t,s,a,u]),g=y.useCallback(async(C,M)=>{try{const z={status:M,updated_at:new Date().toISOString()};M==="preparing"?z.preparation_started_at=new Date().toISOString():M==="ready"&&(z.preparation_completed_at=new Date().toISOString());const{error:A}=await V.from("balcao_order_items").update(z).eq("id",C);if(A)throw A;await u()}catch(z){throw c(z,"atualizao de status do item"),z}},[c,u]),v=y.useCallback(async(C,M)=>{try{await f(C,{status:"cancelled",notes:M?`Cancelado: ${M}`:"Pedido cancelado"})}catch(z){throw c(z,"cancelamento de pedido"),z}},[f,c]),b=y.useCallback(async C=>{try{let M=V.from("balcao_orders_with_details").select("*");C.status&&C.status.length>0&&(M=M.in("status",C.status)),C.employee_id&&(M=M.eq("employee_id",C.employee_id)),C.start_date&&(M=M.gte("created_at",C.start_date)),C.end_date&&(M=M.lte("created_at",C.end_date)),C.customer_name&&(M=M.ilike("customer_name",`%${C.customer_name}%`)),C.order_number&&(M=M.eq("order_number",C.order_number)),C.payment_method&&(M=M.eq("payment_method",C.payment_method));const{data:z,error:A}=await M.order("created_at",{ascending:!1}).limit(100);if(A)throw A;return z||[]}catch(M){return c(M,"busca de pedidos"),[]}},[c]),_=y.useCallback(async()=>{try{const C=new Date().toISOString().split("T")[0],{data:M,error:z}=await V.from("balcao_orders").select("status, final_amount, payment_method").gte("created_at",`${C}T00:00:00.000Z`).lt("created_at",`${C}T23:59:59.999Z`);if(z)throw z;const A=M||[],$={today:{total_orders:A.length,total_revenue:A.reduce((P,F)=>P+(F.final_amount||0),0),avg_order_value:A.length>0?A.reduce((P,F)=>P+(F.final_amount||0),0)/A.length:0,pending_payment:A.filter(P=>P.status==="pending_payment").length,preparing:A.filter(P=>P.status==="preparing").length,ready_for_delivery:A.filter(P=>P.status==="ready").length},by_status:[],by_payment_method:[],hourly_breakdown:[]};l({metrics:$})}catch(C){c(C,"carregamento de mtricas")}},[l,c]),w=y.useCallback(async()=>{await Promise.all([u(),_()])},[u,_]),E=y.useCallback(C=>r.orders.filter(M=>M.status===C),[r.orders]),T=y.useCallback(C=>r.orders.find(M=>M.id===C),[r.orders]),N=E("pending_payment"),k=E("preparing"),S=E("ready");return y.useEffect(()=>{t&&w()},[t,w]),y.useEffect(()=>{if(!t)return;const C=V.channel("balcao_orders_changes").on("postgres_changes",{event:"*",schema:"public",table:"balcao_orders"},()=>{u()}).on("postgres_changes",{event:"*",schema:"public",table:"balcao_order_items"},()=>{u()}).subscribe();return()=>{C.unsubscribe()}},[t,u]),{orders:r.orders,pendingOrders:N,preparingOrders:k,readyOrders:S,metrics:r.metrics,loading:r.loading,error:r.error,createOrder:h,updateOrderStatus:f,updateItemStatus:g,cancelOrder:v,processPayment:p,searchOrders:b,getOrdersByStatus:E,refreshData:w,getOrderById:T,loadMetrics:_}},q2=()=>{const{user:t}=Et(),[s,a]=y.useState({currentSession:null,pendingComandas:[],todaysTransactions:[],todaysSessions:[],todaysSummary:{session_date:new Date().toISOString().split("T")[0],total_sessions:0,total_sales:0,total_transactions:0,by_payment_method:[],by_employee:[],discrepancies:[],avg_ticket:0,peak_hours:[]},loading:!0,error:null}),r=y.useCallback(h=>{a(f=>({...f,...h}))},[]),o=y.useCallback((h,f)=>{console.error(`Erro em ${f}:`,h),r({error:`Erro em ${f}: ${h.message||"Erro desconhecido"}`,loading:!1})},[r]),l=y.useCallback(async()=>{if(t)try{r({loading:!0,error:null});const{data:h,error:f}=await V.from("cash_sessions").select("*").eq("employee_id",t.id).eq("status","open").maybeSingle();if(f&&f.code!=="PGRST116")throw f;const p=h?{...h,employee:{id:t.id,name:t.name||"Usurio",role:"employee"}}:null;r({currentSession:p,pendingComandas:[],todaysTransactions:[],todaysSessions:[],loading:!1})}catch(h){o(h,"carregamento inicial")}},[t,r,o]),c=y.useCallback(async h=>{if(!t)throw new Error("Usurio no autenticado");try{r({loading:!0,error:null});const f={employee_id:t.id,opening_amount:h.opening_amount,opening_notes:h.opening_notes,supervisor_approval_id:h.supervisor_approval_id,status:"open"},{data:p,error:g}=await V.from("cash_sessions").insert(f).select("*").single();if(g)throw g;await l()}catch(f){throw o(f,"abertura de caixa"),f}},[t,r,o,l]),u=y.useCallback(async h=>{if(!s.currentSession)throw new Error("Nenhuma sesso aberta");try{r({loading:!0,error:null});const f=h.closing_amount-s.currentSession.expected_amount,{error:p}=await V.from("cash_sessions").update({status:"closed",closed_at:new Date().toISOString(),closing_amount:h.closing_amount,cash_discrepancy:f,closing_notes:h.closing_notes}).eq("id",s.currentSession.id);if(p)throw p;const g=h.reconciliation.map(b=>({cash_session_id:s.currentSession.id,payment_method:b.payment_method,expected_amount:b.expected_amount,actual_amount:b.actual_amount,transaction_count:b.transaction_count,reconciled_by:t.id,notes:b.notes})),{error:v}=await V.from("payment_reconciliation").insert(g);if(v)throw v;await l()}catch(f){throw o(f,"fechamento de caixa"),f}},[s.currentSession,t,r,o,l]);return y.useEffect(()=>{l()},[l]),{currentSession:s.currentSession,pendingComandas:s.pendingComandas,todaysTransactions:s.todaysTransactions,todaysSessions:s.todaysSessions,todaysSummary:s.todaysSummary,loading:s.loading,error:s.error,openCashSession:c,closeCashSession:u,getCurrentSession:()=>s.currentSession,processComandaPayment:async()=>{throw new Error("No implementado ainda")},processRefund:async()=>{throw new Error("No implementado ainda")},processAdjustment:async()=>{throw new Error("No implementado ainda")},generateDailySummary:async()=>s.todaysSummary,generateMonthlySummary:async()=>({month:new Date().toISOString().slice(0,7),total_sessions:0,total_sales:0,total_transactions:0,employees_performance:[],top_payment_methods:[],daily_breakdown:[],avg_discrepancy:0,peak_days:[]}),getTransactionsByFilters:async()=>[],getSessionsByFilters:async()=>[],validateCashAmount:async()=>({isValid:!0,errors:[]}),validateSession:async()=>({isValid:!0,errors:[]}),reloadData:l}},Pe=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t),Rc={dinheiro:"Dinheiro",cartao_debito:"Carto de Dbito",cartao_credito:"Carto de Crdito",pix:"PIX",transferencia:"Transferncia"},F2={sale:"Venda",refund:"Estorno",adjustment:"Ajuste",tip:"Gorjeta",cash_withdrawal:"Sada de Dinheiro",treasury_transfer:"Transferncia para Tesouraria"},Ct={MAX_CASH_IN_REGISTER:1e3,AUTO_SANGRIA_THRESHOLD:1500,SUPERVISOR_APPROVAL_THRESHOLD:500,MAX_WITHDRAWAL_WITHOUT_APPROVAL:300,MAX_SUPPLY_WITHOUT_APPROVAL:500,MIN_CASH_BALANCE:50,MAX_DISCREPANCY_AUTO_ACCEPT:5,MAX_DISCREPANCY_WITHOUT_APPROVAL:50,MAX_DISCREPANCY_PERCENTAGE:2},X$=({isOpen:t,onClose:s,onSelectCustomer:a})=>{const[r,o]=y.useState(""),[l,c]=y.useState([]),[u,h]=y.useState(!1),[f,p]=y.useState("phone");y.useEffect(()=>{t&&(o(""),c([]))},[t]);const g=async()=>{if(r.trim()){h(!0);try{let _=V.from("bar_customers").select("*");f==="phone"?_=_.ilike("phone",`%${r}%`):_=_.ilike("name",`%${r}%`);const{data:w,error:E}=await _.eq("status","active").order("name").limit(10);if(E)throw E;if(!w||w.length===0){const T=[{id:"mock-1",phone:r.includes("11")?r:"(11) 99999-1234",name:"Joo Silva",email:"joao@exemplo.com",credit_limit:1e3,current_balance:0,status:"active",is_vip:!0,loyalty_points:250,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),last_visit:"2024-08-30"},{id:"mock-2",phone:"(11) 88888-5678",name:"Maria Santos",email:"maria@exemplo.com",credit_limit:500,current_balance:0,status:"active",is_vip:!1,loyalty_points:120,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),last_visit:"2024-08-28"}];c(f==="phone"?T.filter(N=>N.phone.includes(r)||r.includes("11")):T.filter(N=>N.name.toLowerCase().includes(r.toLowerCase())))}else c(w)}catch(_){console.error("Erro ao buscar clientes:",_),c([])}finally{h(!1)}}},v=_=>{_.key==="Enter"&&g()},b=_=>{a(_),s()};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Identificar Membro"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx(Ki,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 border-b",children:[e.jsx("div",{className:"flex space-x-4 mb-4",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>p("phone"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${f==="phone"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(_0,{className:"h-4 w-4 inline mr-1"}),"Telefone"]}),e.jsxs("button",{onClick:()=>p("name"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${f==="name"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(om,{className:"h-4 w-4 inline mr-1"}),"Nome"]})]})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(nm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:f==="phone"?"Digite o telefone (ex: 11999999999)":"Digite o nome do membro",value:r,onChange:_=>o(_.target.value),onKeyPress:v,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0})]}),e.jsx("button",{onClick:g,disabled:u||!r.trim(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Buscando...":"Buscar"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:u?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):l.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:[l.length," resultado(s) encontrado(s)"]}),l.map(_=>e.jsxs("div",{onClick:()=>b(_),className:"bg-gray-50 rounded-lg p-4 hover:bg-gray-100 cursor-pointer transition-colors border border-gray-200",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:_.name}),_.is_vip&&e.jsxs("div",{className:"flex items-center space-x-1 bg-yellow-100 px-2 py-1 rounded-full",children:[e.jsx(U$,{className:"h-3 w-3 text-yellow-600"}),e.jsx("span",{className:"text-xs font-medium text-yellow-800",children:"VIP"})]})]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_0,{className:"h-4 w-4"}),e.jsx("span",{children:_.phone})]}),_.email&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(w$,{className:"h-4 w-4"}),e.jsx("span",{children:_.email})]})]})]}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{className:"text-gray-900 font-medium",children:[_.loyalty_points," pontos"]}),_.last_visit&&e.jsxs("div",{className:"text-gray-500",children:["ltima visita: ",new Date(_.last_visit).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs",children:[e.jsx("span",{className:`px-2 py-1 rounded-full ${_.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:_.status==="active"?"Ativo":"Inativo"}),e.jsxs("span",{className:"text-gray-500",children:["Limite: R$ ",_.credit_limit.toFixed(2)]})]})]},_.id))]}):r&&!u?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(om,{className:"h-12 w-12 mx-auto text-gray-300 mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum membro encontrado"}),e.jsxs("p",{className:"text-gray-600",children:["Tente buscar por outro ",f==="phone"?"telefone":"nome"," ou verifique se o membro est cadastrado."]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(nm,{className:"h-12 w-12 mx-auto text-gray-300 mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Buscar Membro"}),e.jsxs("p",{className:"text-gray-600",children:["Digite o ",f==="phone"?"telefone":"nome"," do membro para aplicar descontos e benefcios."]})]})}),e.jsx("div",{className:"p-6 border-t bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsx("span",{children:" Membros recebem 10% de desconto automaticamente"}),e.jsx("button",{onClick:s,className:"text-blue-600 hover:text-blue-800 font-medium",children:"Continuar sem identificar"})]})})]})}):null},Qj=()=>{const{menuItems:t,loading:s}=V2(!0),{createOrder:a}=Cm(),{currentSession:r}=q2(),{inventory:o,syncInventoryToMenu:l}=Tt(),[c,u]=y.useState([]),[h,f]=y.useState(null),[p,g]=y.useState(""),[v,b]=y.useState(""),[_,w]=y.useState("all"),[E,T]=y.useState(""),[N,k]=y.useState(!1),[S,C]=y.useState(!1),[M,z]=y.useState({}),A=y.useMemo(()=>Array.from(new Set(t.map(H=>H.category))).sort(),[t]),$=y.useMemo(()=>{let O=t.filter(H=>H.available);return _!=="all"&&(O=O.filter(H=>H.category===_)),E&&(O=O.filter(H=>{var B;return H.name.toLowerCase().includes(E.toLowerCase())||((B=H.description)==null?void 0:B.toLowerCase().includes(E.toLowerCase()))})),O},[t,_,E]);Ye.useEffect(()=>{const H=setTimeout(async()=>{try{await l()}catch(B){console.error(" Erro na sincronizao:",B)}},1e3);return()=>clearTimeout(H)},[t.length,o.length]);const P=y.useMemo(()=>c.reduce((O,H)=>O+H.price*H.quantity,0),[c]),F=y.useMemo(()=>h?P*.1:0,[h,P]),I=y.useMemo(()=>P-F,[P,F]),J=(O,H)=>{if(O.item_type==="direct"&&O.direct_inventory_item_id){const B=o.find(Y=>Y.id===O.direct_inventory_item_id);return B?B.currentStock<H?{available:!1,currentStock:B.currentStock,warning:`Estoque insuficiente. Disponvel: ${B.currentStock} ${B.unit}`}:B.currentStock<=B.minStock?{available:!0,currentStock:B.currentStock,warning:`Estoque baixo! Disponvel: ${B.currentStock} ${B.unit}`}:{available:!0,currentStock:B.currentStock}:{available:!1,warning:"Item no encontrado no estoque"}}return{available:!0}},pe=O=>{const H=J(O,1);if(!H.available){alert(H.warning);return}u(B=>{const Y=B.find(ne=>ne.menu_item_id===O.id);if(Y){const ne=Y.quantity+1,ie=J(O,ne);return ie.available?(ie.warning?z(oe=>({...oe,[O.id]:ie.warning})):z(oe=>{const me={...oe};return delete me[O.id],me}),B.map(oe=>oe.menu_item_id===O.id?{...oe,quantity:ne}:oe)):(alert(ie.warning),B)}else return H.warning&&z(ne=>({...ne,[O.id]:H.warning})),[...B,{menu_item_id:O.id,name:O.name,price:O.price,quantity:1}]})},te=O=>{u(H=>H.filter(B=>B.menu_item_id!==O)),z(H=>{const B={...H};return delete B[O],B})},L=(O,H)=>{if(H<=0){te(O);return}const B=t.find(Y=>Y.id===O);if(B){const Y=J(B,H);if(!Y.available){alert(Y.warning);return}Y.warning?z(ne=>({...ne,[O]:Y.warning})):z(ne=>{const ie={...ne};return delete ie[O],ie})}u(Y=>Y.map(ne=>ne.menu_item_id===O?{...ne,quantity:H}:ne))},G=()=>{u([]),f(null),g(""),b(""),z({})},ee=()=>{const O=[];for(const H of c){const B=t.find(Y=>Y.id===H.menu_item_id);if(B){const Y=J(B,H.quantity);Y.available||O.push(`${B.name}: ${Y.warning}`)}}return{valid:O.length===0,errors:O}},xe=async()=>{if(c.length===0)return;const O=ee();if(!O.valid){alert(`Problemas de estoque encontrados:

`+O.errors.join(`
`));return}C(!0);try{const H={customer_name:h==null?void 0:h.name,customer_phone:h==null?void 0:h.phone,customer_notes:v||void 0,items:c.map(Y=>({menu_item_id:Y.menu_item_id,quantity:Y.quantity,unit_price:Y.price,notes:Y.notes})),discount_amount:F,notes:p||void 0},B=await a(H);G(),alert(`Pedido #${B.slice(-4).toUpperCase()} criado com sucesso!

O pedido est aguardando pagamento no caixa.`)}catch(H){console.error("Erro ao criar pedido:",H),H instanceof Error&&H.message.includes("Estoque insuficiente")?alert("Estoque insuficiente para um ou mais itens. Verifique o estoque e tente novamente."):alert("Erro ao criar pedido. Tente novamente.")}finally{C(!1)}};return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm p-4 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Criar Pedido de Balco"}),e.jsx("p",{className:"text-gray-600",children:"O pedido ficar pendente at o pagamento ser processado no caixa"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:r?e.jsx("div",{className:"bg-green-100 px-4 py-2 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ha,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"text-green-800 font-medium",children:"Caixa Aberto"})]})}):e.jsx("div",{className:"bg-yellow-100 px-4 py-2 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ga,{className:"h-5 w-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-yellow-800 font-medium",children:"Caixa Fechado"}),e.jsx("p",{className:"text-yellow-700 text-sm",children:"Pedidos sero processados quando o caixa abrir"})]})]})})})]})}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"bg-white p-4 border-b",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(nm,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar itens...",value:E,onChange:O=>T(O.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:_,onChange:O=>w(O.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todas Categorias"}),A.map(O=>e.jsx("option",{value:O,children:O},O))]})]})}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:$.map(O=>{const H=J(O,1),B=H.warning&&H.available,Y=!H.available;return e.jsxs(be.div,{whileHover:{scale:Y?1:1.02},whileTap:{scale:Y?1:.98},onClick:()=>!Y&&pe(O),className:`bg-white rounded-lg shadow-sm border transition-all duration-200 ${Y?"cursor-not-allowed opacity-50 border-red-300":B?"cursor-pointer hover:shadow-lg hover:border-yellow-400 hover:bg-yellow-50 border-yellow-300":"cursor-pointer hover:shadow-lg hover:border-blue-400 hover:bg-blue-50 border-gray-200"}`,children:[e.jsx("div",{className:"p-2 pb-0 min-h-[32px] flex justify-end",children:e.jsxs("div",{className:"flex flex-col space-y-1 items-end",children:[Y&&e.jsxs("div",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full flex items-center space-x-1 shadow-md",children:[e.jsx(_r,{className:"h-3 w-3"}),e.jsx("span",{children:"Esgotado"})]}),B&&e.jsxs("div",{className:"bg-yellow-500 text-white text-xs px-2 py-1 rounded-full flex items-center space-x-1 shadow-md",children:[e.jsx(_r,{className:"h-3 w-3"}),e.jsx("span",{children:"Baixo"})]})]})}),e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2 line-clamp-2",children:O.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:O.category}),O.item_type==="direct"&&H.currentStock!==void 0&&e.jsxs("p",{className:`text-xs mb-2 ${Y?"text-red-600":B?"text-yellow-600":"text-gray-500"}`,children:["Estoque: ",H.currentStock]}),e.jsx("p",{className:`text-lg font-bold ${Y?"text-gray-400":"text-blue-600"}`,children:Pe(O.price)})]})})]},O.id)})})})]}),e.jsxs("div",{className:"w-96 bg-white border-l flex flex-col",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Carrinho"}),c.length>0&&e.jsx("button",{onClick:G,className:"text-red-600 hover:text-red-700 text-sm",children:"Limpar"})]})}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx("div",{className:"p-4",children:c.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500",children:"Carrinho vazio"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Adicione itens do menu"})]}):e.jsx("div",{className:"space-y-4",children:c.map(O=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:O.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[Pe(O.price)," cada"]}),M[O.menu_item_id]&&e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[e.jsx(_r,{className:"h-4 w-4 text-yellow-500"}),e.jsx("p",{className:"text-xs text-yellow-600",children:M[O.menu_item_id]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>L(O.menu_item_id,O.quantity-1),className:"p-1 rounded hover:bg-gray-200",children:e.jsx(M$,{className:"h-4 w-4"})}),e.jsx("span",{className:"w-8 text-center font-medium",children:O.quantity}),e.jsx("button",{onClick:()=>L(O.menu_item_id,O.quantity+1),className:"p-1 rounded hover:bg-gray-200",children:e.jsx(Ui,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>te(O.menu_item_id),className:"p-1 rounded hover:bg-red-100 text-red-600 ml-2",children:e.jsx(Em,{className:"h-4 w-4"})})]})]},O.menu_item_id))})}),h&&e.jsx("div",{className:"p-4 border-t bg-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:h.name}),e.jsx("p",{className:"text-sm text-blue-700",children:"Membro - Desconto 10%"})]}),e.jsx("button",{onClick:()=>f(null),className:"text-blue-600 hover:text-blue-700",children:e.jsx(Ki,{className:"h-5 w-5"})})]})}),c.length>0&&e.jsxs("div",{className:"p-4 border-t bg-gray-50",children:[e.jsxs("button",{onClick:()=>k(!0),className:"w-full mb-4 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 flex items-center justify-center space-x-2",children:[e.jsx(om,{className:"h-5 w-5"}),e.jsx("span",{children:h?"Trocar Cliente":"Identificar Cliente"})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subtotal:"}),e.jsx("span",{children:Pe(P)})]}),F>0&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[e.jsx("span",{children:"Desconto (10%):"}),e.jsxs("span",{children:["-",Pe(F)]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{children:Pe(I)})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observaes do Cliente"}),e.jsx("textarea",{value:v,onChange:O=>b(O.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Observaes especiais..."})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observaes Internas"}),e.jsx("textarea",{value:p,onChange:O=>g(O.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Observaes sobre o pedido..."})]}),e.jsx("button",{onClick:xe,disabled:S||c.length===0,className:"w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 font-medium",children:S?"Criando Pedido...":"Enviar para Caixa"})]})]})]})]}),e.jsx(X$,{isOpen:N,onClose:()=>k(!1),onSelectCustomer:O=>{f(O),k(!1)}})]})},Q$={pending_payment:"Aguardando Pagamento",paid:"Pago",preparing:"Preparando",ready:"Pronto",delivered:"Entregue",cancelled:"Cancelado"},J$={pending_payment:"bg-yellow-100 text-yellow-800",paid:"bg-blue-100 text-blue-800",preparing:"bg-orange-100 text-orange-800",ready:"bg-green-100 text-green-800",delivered:"bg-gray-100 text-gray-800",cancelled:"bg-red-100 text-red-800"},Jj=t=>`#${t.toString().padStart(4,"0")}`,e7=()=>{var z;const{pendingOrders:t,preparingOrders:s,readyOrders:a,updateOrderStatus:r,processPayment:o,loading:l,refreshData:c}=Cm(),{currentSession:u,refreshData:h}=q2(),[f,p]=y.useState(!1),[g,v]=y.useState(null),[b,_]=y.useState("dinheiro"),[w,E]=y.useState(!1),[T,N]=y.useState(!1),k=async()=>{if(!(!g||!u)){E(!0);try{await o({order_id:g.id,payment_method:b,cash_session_id:u.id,amount_paid:g.final_amount}),console.log(" Forando atualizao dos dados aps pagamento..."),await Promise.all([c(),h()]),setTimeout(async()=>{console.log(" Segunda atualizao dos dados..."),await Promise.all([c(),h()])},1e3),setTimeout(async()=>{console.log(" Terceira atualizao dos dados..."),await Promise.all([c(),h()])},2e3),p(!1),v(null)}catch(A){console.error("Erro ao processar pagamento:",A),alert("Erro ao processar pagamento. Tente novamente.")}finally{E(!1)}}},S=async A=>{try{await r(A,{status:"ready"})}catch($){console.error("Erro ao marcar como pronto:",$),alert("Erro ao atualizar status. Tente novamente.")}},C=async A=>{try{await r(A,{status:"delivered"})}catch($){console.error("Erro ao marcar como entregue:",$),alert("Erro ao atualizar status. Tente novamente.")}},M=({order:A})=>{var pe;const $=J$[A.status],P=Q$[A.status],I=(()=>{const te=new Date(A.created_at);return Math.floor((new Date().getTime()-te.getTime())/(1e3*60))})(),J=I>15;return e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`bg-white rounded-lg shadow-md p-4 border-l-4 ${J?"border-red-500":A.status==="ready"?"border-green-500":"border-blue-500"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:Jj(A.order_number)}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${$}`,children:P})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(Ga,{className:"h-4 w-4"}),e.jsxs("span",{className:J?"text-red-600 font-medium":"",children:[I,"min"]})]})]}),(A.customer_name||A.customer_phone)&&e.jsx("div",{className:"mb-3 p-2 bg-gray-50 rounded",children:e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[A.customer_name&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(om,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:A.customer_name})]}),A.customer_phone&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(_0,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:A.customer_phone})]})]})}),e.jsx("div",{className:"space-y-2 mb-3",children:(pe=A.items)==null?void 0:pe.map(te=>{var L;return e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:[te.quantity,"x ",((L=te.menu_item)==null?void 0:L.name)||"Item",te.notes&&e.jsxs("span",{className:"text-gray-500 italic",children:[" - ",te.notes]})]}),e.jsx("span",{className:"font-medium",children:Pe(te.total_price)})]},te.id)})}),(A.customer_notes||A.notes)&&e.jsxs("div",{className:"mb-3 p-2 bg-yellow-50 rounded",children:[A.customer_notes&&e.jsxs("div",{className:"flex items-start space-x-2 text-sm",children:[e.jsx(m$,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),e.jsx("span",{className:"text-yellow-800",children:A.customer_notes})]}),A.notes&&e.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Obs. interna: ",A.notes]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-3 pt-2 border-t",children:[e.jsx("span",{className:"font-medium text-gray-900",children:"Total:"}),e.jsx("span",{className:"text-lg font-bold text-green-600",children:Pe(A.final_amount)})]}),e.jsxs("div",{className:"flex space-x-2",children:[A.status==="pending_payment"&&e.jsx("button",{onClick:()=>{v(A),p(!0)},disabled:!u,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Receber Pagamento"}),A.status==="preparing"&&e.jsx("button",{onClick:()=>S(A.id),className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 text-sm font-medium",children:"Marcar como Pronto"}),A.status==="ready"&&e.jsx("button",{onClick:()=>C(A.id),className:"flex-1 bg-purple-600 text-white py-2 px-4 rounded hover:bg-purple-700 text-sm font-medium",children:"Entregar ao Cliente"})]})]})};return l?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Pedidos de Balco"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[u?e.jsx("div",{className:"bg-green-100 px-3 py-1 rounded-lg",children:e.jsx("span",{className:"text-green-800 text-sm font-medium",children:"Caixa Aberto"})}):e.jsx("div",{className:"bg-red-100 px-3 py-1 rounded-lg",children:e.jsx("span",{className:"text-red-800 text-sm font-medium",children:"Caixa Fechado"})}),e.jsxs("button",{onClick:async()=>{N(!0);try{console.log(" Atualizando pedidos manualmente..."),await c(),console.log(" Pedidos atualizados!")}catch(A){console.error(" Erro ao atualizar:",A)}finally{N(!1)}},disabled:T,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[e.jsx(Yj,{className:`h-4 w-4 ${T?"animate-spin":""}`}),e.jsx("span",{children:T?"Atualizando...":"Atualizar"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-yellow-100 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-800 text-sm font-medium",children:"Aguardando Pagamento"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:t.length})]}),e.jsx(Ga,{className:"h-8 w-8 text-yellow-600"})]})}),e.jsx("div",{className:"bg-blue-100 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-800 text-sm font-medium",children:"Preparando"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:s.length})]}),e.jsx(Yj,{className:"h-8 w-8 text-blue-600"})]})}),e.jsx("div",{className:"bg-green-100 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-800 text-sm font-medium",children:"Prontos"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:a.length})]}),e.jsx(Ha,{className:"h-8 w-8 text-green-600"})]})})]}),e.jsxs("div",{className:"space-y-6",children:[t.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Aguardando Pagamento (",t.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(A=>e.jsx(M,{order:A},A.id))})]}),s.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Preparando (",s.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(A=>e.jsx(M,{order:A},A.id))})]}),a.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Prontos para Entrega (",a.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(A=>e.jsx(M,{order:A},A.id))})]}),t.length===0&&s.length===0&&a.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ga,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum pedido pendente"}),e.jsx("p",{className:"text-gray-600",children:"Todos os pedidos foram processados e entregues."})]})]}),f&&g&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-96",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Receber Pagamento - ",Jj(g.order_number)]}),e.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Ki,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Resumo do Pedido"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[(z=g.items)==null?void 0:z.map(A=>{var $;return e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[A.quantity,"x ",($=A.menu_item)==null?void 0:$.name]}),e.jsx("span",{children:Pe(A.total_price)})]},A.id)}),e.jsxs("div",{className:"border-t pt-2 flex justify-between font-medium",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{children:Pe(g.final_amount)})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mtodo de Pagamento"}),e.jsxs("select",{value:b,onChange:A=>_(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"dinheiro",children:"Dinheiro"}),e.jsx("option",{value:"cartao_debito",children:"Carto de Dbito"}),e.jsx("option",{value:"cartao_credito",children:"Carto de Crdito"}),e.jsx("option",{value:"pix",children:"PIX"}),e.jsx("option",{value:"transferencia",children:"Transferncia"})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>p(!1),className:"flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:k,disabled:w||!u,className:"flex-1 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:w?"Processando...":"Confirmar Pagamento"})]})]})})]})},km={tableSize:120,margin:50,layoutWidth:800,layoutHeight:600},t7=(t,s={})=>{const{tableSize:a,margin:r,layoutWidth:o}={...km,...s},l=Math.floor((o-r)/a),c=t%l,u=Math.floor(t/l);return{x:r+c*a,y:r+u*a}},s7=(t,s={})=>{const{tableSize:a,margin:r,layoutWidth:o,layoutHeight:l}={...km,...s},c=Math.floor((o-r)/a),u=Math.floor((l-r)/a),h=new Set(t.map(f=>`${f.x},${f.y}`));for(let f=0;f<u;f++)for(let p=0;p<c;p++){const g=r+p*a,v=r+f*a,b=`${g},${v}`;if(!h.has(b))return{x:g,y:v}}return t7(t.length,s)},a7=(t,s={})=>{const a={...km,...s},r=Math.floor((a.layoutWidth-a.margin)/a.tableSize),o=Math.floor((a.layoutHeight-a.margin)/a.tableSize),l=r*o;console.log("Grid Organization:",{layoutWidth:a.layoutWidth,layoutHeight:a.layoutHeight,tableSize:a.tableSize,margin:a.margin,maxCols:r,maxRows:o,maxCapacity:l,tablesCount:t.length});let c=a.tableSize,u=a.margin;if(t.length>l){const h=Math.ceil(Math.sqrt(t.length)),f=Math.ceil(t.length/h);c=Math.min(Math.floor((a.layoutWidth-40)/h),Math.floor((a.layoutHeight-40)/f)),u=20,console.log("Adjusted for capacity:",{idealCols:h,idealRows:f,adjustedTableSize:c,adjustedMargin:u})}return t.map((h,f)=>{const p=Math.floor((a.layoutWidth-u)/c),g=f%p,v=Math.floor(f/p),b={x:u+g*c,y:u+v*c};return console.log(`Mesa ${f+1}:`,{col:g,row:v,position:b}),{id:h.id,position:b}})},Rr=()=>{const{user:t}=Et(),[s,a]=y.useState([]),[r,o]=y.useState(!0),[l,c]=y.useState(null),u=async()=>{try{if(o(!0),console.log("useBarTables - Fetching tables..."),!t){console.log("useBarTables - Usurio no autenticado"),a([]);return}const{data:k,error:S}=await V.from("usuarios_empresa").select("empresa_id").eq("user_id",t.id).eq("ativo",!0).single();if(S||!k){console.error("useBarTables - Erro ao buscar empresa do usurio:",S),c("Erro: No foi possvel identificar sua empresa");return}const C=k.empresa_id;console.log("useBarTables - Carregando mesas para empresa:",C);const{data:M,error:z}=await V.from("bar_tables").select("*").eq("empresa_id",C).order("number");if(console.log("useBarTables - Query result:",{data:M,error:z}),z)throw z;a(M||[]),console.log("useBarTables - Tables set:",M||[])}catch(k){console.error("useBarTables - Error:",k),c(k instanceof Error?k.message:"Erro ao carregar mesas")}finally{o(!1)}},h=async k=>{try{if(!t)throw new Error("Usurio no autenticado");const{data:S,error:C}=await V.from("usuarios_empresa").select("empresa_id").eq("user_id",t.id).eq("ativo",!0).single();if(C||!S)throw new Error("Erro: No foi possvel identificar sua empresa");const{data:M,error:z}=await V.from("bar_tables").insert({...k,empresa_id:S.empresa_id,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(z)throw z;return a(A=>[...A,M]),M}catch(S){throw new Error(S instanceof Error?S.message:"Erro ao criar mesa")}},f=async(k,S)=>{try{const{data:C,error:M}=await V.from("bar_tables").update({...S,updated_at:new Date().toISOString()}).eq("id",k).select().single();if(M)throw M;return a(z=>z.map(A=>A.id===k?C:A)),C}catch(C){throw new Error(C instanceof Error?C.message:"Erro ao atualizar mesa")}},p=async k=>{try{const{error:S}=await V.from("bar_tables").delete().eq("id",k);if(S)throw S;a(C=>C.filter(M=>M.id!==k))}catch(S){throw new Error(S instanceof Error?S.message:"Erro ao excluir mesa")}},g=async(k,S)=>f(k,{status:S}),v=async(k,S,C)=>{try{const{error:M}=await V.from("bar_tables").update({position_x:S,position_y:C,updated_at:new Date().toISOString()}).eq("id",k);if(M)throw M;a(z=>z.map(A=>A.id===k?{...A,position_x:S,position_y:C}:A))}catch(M){throw new Error(M instanceof Error?M.message:"Erro ao atualizar posio da mesa")}},b=k=>s.find(S=>S.id===k),_=k=>s.find(S=>S.number===k),w=()=>s.filter(k=>k.status==="available"),E=()=>s.filter(k=>k.status==="occupied"),T=k=>s.filter(S=>S.status===k),N=async(k=800,S=600)=>{console.log("Organizing tables with dimensions:",{layoutWidth:k,layoutHeight:S,tablesCount:s.length});const C={...km,layoutWidth:Math.max(k-100,600),layoutHeight:Math.max(S-150,400)},z=a7(s,C).map(({id:A,position:$})=>(console.log(`Updating table ${A} to position:`,$),v(A,$.x,$.y)));try{await Promise.all(z),console.log("All tables organized successfully")}catch(A){throw console.error("Error organizing tables:",A),new Error("Erro ao organizar mesas automaticamente")}};return y.useEffect(()=>{t&&u();const k=V.channel("bar_tables_changes").on("postgres_changes",{event:"*",schema:"public",table:"bar_tables"},S=>{console.log("Mudana em mesas:",S),S.eventType==="INSERT"?a(C=>[...C,S.new]):S.eventType==="UPDATE"?a(C=>C.map(M=>M.id===S.new.id?S.new:M)):S.eventType==="DELETE"&&a(C=>C.filter(M=>M.id!==S.old.id))}).subscribe();return()=>{k.unsubscribe()}},[t]),{tables:s,loading:r,error:l,refetch:u,createTable:h,updateTable:f,deleteTable:p,updateTableStatus:g,updateTablePosition:v,organizeTablesAutomatically:N,getTableById:b,getTableByNumber:_,getAvailableTables:w,getOccupiedTables:E,getTablesByStatus:T}},H2=({isOpen:t,onClose:s,table:a})=>{const{user:r}=Et(),{refetch:o,tables:l}=Rr(),[c,u]=y.useState({number:"",capacity:2,status:"available",notes:"",position_x:100,position_y:100}),[h,f]=y.useState(!1),[p,g]=y.useState(null),v=!!a,b=()=>{const T=l.filter(N=>N.position_x!==null&&N.position_y!==null).map(N=>({x:N.position_x,y:N.position_y}));return s7(T)};y.useEffect(()=>{if(a)u({number:a.number,capacity:a.capacity,status:a.status||"available",notes:a.notes||"",position_x:a.position_x||100,position_y:a.position_y||100});else{const T=b();u({number:"",capacity:2,status:"available",notes:"",position_x:T.x,position_y:T.y})}g(null)},[a,t,l.length]);const _=async T=>{T.preventDefault(),f(!0),g(null);try{if(v){const{error:N}=await V.from("bar_tables").update({number:c.number,capacity:c.capacity,status:c.status,notes:c.notes||null,position_x:c.position_x,position_y:c.position_y,updated_at:new Date().toISOString()}).eq("id",a.id);if(N)throw N}else{if(!r)throw new Error("Usurio no autenticado");const{data:N,error:k}=await V.from("usuarios_empresa").select("empresa_id").eq("user_id",r.id).eq("ativo",!0).single();if(k||!N)throw new Error("Erro: No foi possvel identificar sua empresa");const{error:S}=await V.from("bar_tables").insert({number:c.number,capacity:c.capacity,status:c.status,notes:c.notes||null,position_x:c.position_x,position_y:c.position_y,empresa_id:N.empresa_id});if(S)throw S}await o(),s()}catch(N){console.error("Erro ao salvar mesa:",N),N.code==="23505"?g("J existe uma mesa com este nmero"):g(N.message||"Erro ao salvar mesa")}finally{f(!1)}},w=async()=>{if(!(!a||!confirm("Tem certeza que deseja excluir esta mesa?"))){f(!0);try{const{error:T}=await V.from("bar_tables").delete().eq("id",a.id);if(T)throw T;await o(),s()}catch(T){console.error("Erro ao excluir mesa:",T),g(T.message||"Erro ao excluir mesa")}finally{f(!1)}}},E=[{value:"available",label:"Disponvel",color:"text-green-600"},{value:"occupied",label:"Ocupada",color:"text-red-600"},{value:"reserved",label:"Reservada",color:"text-yellow-600"},{value:"cleaning",label:"Limpeza",color:"text-blue-600"},{value:"maintenance",label:"Manuteno",color:"text-gray-600"}];return e.jsx(e.Fragment,{children:t&&e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:s}),e.jsx("div",{className:"relative bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:v?"Editar Mesa":"Nova Mesa"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 focus:outline-none",children:e.jsx(Ki,{className:"h-6 w-6"})})]}),p&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(_r,{className:"h-5 w-5 text-red-400"}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-800",children:p})})]})}),e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nmero da Mesa *"}),e.jsx("input",{type:"text",required:!0,value:c.number,onChange:T=>u(N=>({...N,number:T.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ex: 1, A1, VIP-01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capacidade (pessoas) *"}),e.jsx("input",{type:"number",required:!0,min:"1",max:"20",value:c.capacity,onChange:T=>u(N=>({...N,capacity:parseInt(T.target.value)||1})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("select",{value:c.status,onChange:T=>u(N=>({...N,status:T.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:E.map(T=>e.jsx("option",{value:T.value,children:T.label},T.value))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Posio X"}),e.jsx("input",{type:"number",min:"0",value:c.position_x,onChange:T=>u(N=>({...N,position_x:parseInt(T.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Posio Y"}),e.jsx("input",{type:"number",min:"0",value:c.position_y,onChange:T=>u(N=>({...N,position_y:parseInt(T.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observaes"}),e.jsx("textarea",{rows:3,value:c.notes,onChange:T=>u(N=>({...N,notes:T.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Observaes sobre a mesa..."})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx("div",{children:v&&e.jsx("button",{type:"button",onClick:w,disabled:h,className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:"Excluir"})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:s,disabled:h,className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 disabled:opacity-50",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:h,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 flex items-center",children:[h?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):e.jsx(p$,{className:"h-4 w-4 mr-2"}),v?"Salvar":"Criar"]})]})]})]})]})})]})})},r7=({table:t,x:s,y:a,onClose:r,onEdit:o})=>{const{updateTableStatus:l}=Rr(),c=y.useRef(null);y.useEffect(()=>{const f=g=>{c.current&&!c.current.contains(g.target)&&r()},p=g=>{g.key==="Escape"&&r()};return document.addEventListener("mousedown",f),document.addEventListener("keydown",p),()=>{document.removeEventListener("mousedown",f),document.removeEventListener("keydown",p)}},[r]);const u=async f=>{try{await l(t.id,f),r()}catch(p){console.error("Erro ao atualizar status da mesa:",p)}},h=[{value:"available",label:"Disponvel",icon:E$,color:"text-green-600"},{value:"occupied",label:"Ocupada",icon:Za,color:"text-red-600"},{value:"reserved",label:"Reservada",icon:Ga,color:"text-yellow-600"},{value:"cleaning",label:"Limpeza",icon:Xj,color:"text-blue-600"},{value:"maintenance",label:"Manuteno",icon:Xj,color:"text-gray-600"}];return e.jsx(Wa,{children:e.jsx("div",{className:"fixed inset-0 z-50",children:e.jsxs(be.div,{ref:c,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"absolute bg-white rounded-lg shadow-lg border border-gray-200 py-2 min-w-48",style:{left:s,top:a,transform:"translate(-50%, -10px)"},children:[e.jsxs("div",{className:"px-4 py-2 border-b border-gray-100",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:["Mesa ",t.number]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[t.capacity," pessoas"]})]}),e.jsxs("div",{className:"py-1",children:[e.jsx("div",{className:"px-4 py-1 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Alterar Status"}),h.map(f=>{const p=f.icon,g=t.status===f.value;return e.jsxs("button",{onClick:()=>u(f.value),disabled:g,className:`w-full px-4 py-2 text-left flex items-center space-x-3 hover:bg-gray-50 transition-colors ${g?"bg-gray-50 cursor-not-allowed opacity-50":""}`,children:[e.jsx(p,{className:`h-4 w-4 ${f.color}`}),e.jsx("span",{className:"text-sm text-gray-700",children:f.label}),g&&e.jsx("span",{className:"ml-auto text-xs text-gray-500",children:"Atual"})]},f.value)})]}),e.jsx("div",{className:"border-t border-gray-100 my-1"}),e.jsx("div",{className:"py-1",children:e.jsxs("button",{onClick:o,className:"w-full px-4 py-2 text-left flex items-center space-x-3 hover:bg-gray-50 transition-colors",children:[e.jsx(Sm,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Editar Mesa"})]})})]})})})},n7=({table:t,onClose:s,onEdit:a,onStartOrder:r,onManageComandas:o,onFinalizarAtendimento:l})=>{const{updateTableStatus:c,deleteTable:u}=Rr(),{getOpenComandasByTableId:h,getComandasByTableId:f,getPendingPaymentComandasByTableId:p}=Yi(),g=h(t.id),v=p(t.id),b=f(t.id);console.log("TableActionPanel - Hook functions:",{updateTableStatus:typeof c,deleteTable:typeof u,tableId:t.id,tableStatus:t.status,openComandas:g.length,pendingComandas:v.length,allComandas:b.length});const _=async N=>{console.log("Alterando status da mesa:",t.id,"para:",N);try{await c(t.id,N),console.log("Status alterado com sucesso")}catch(k){console.error("Erro ao alterar status da mesa:",k),alert("Erro ao alterar status da mesa: "+(k instanceof Error?k.message:"Erro desconhecido"))}},w=async()=>{if(console.log("Tentando excluir mesa:",t.id,t.number),window.confirm(`Tem certeza que deseja excluir a Mesa ${t.number}?`))try{await u(t.id),console.log("Mesa excluda com sucesso"),s()}catch(N){console.error("Erro ao excluir mesa:",N),alert("Erro ao excluir mesa: "+(N instanceof Error?N.message:"Erro desconhecido"))}},E=N=>{switch(N){case"available":return"text-green-600 bg-green-50";case"occupied":return"text-red-600 bg-red-50";case"reserved":return"text-yellow-600 bg-yellow-50";case"cleaning":return"text-blue-600 bg-blue-50";case"maintenance":return"text-gray-600 bg-gray-50";default:return"text-gray-600 bg-gray-50"}},T=N=>{switch(N){case"available":return"Disponvel";case"occupied":return"Ocupada";case"reserved":return"Reservada";case"cleaning":return"Em Limpeza";case"maintenance":return"Manuteno";default:return"Indefinido"}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Mesa ",t.number]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(Za,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Capacidade: ",t.capacity," pessoas"]})]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Y$,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Status Atual:"}),e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${E(t.status||"available")}`,children:T(t.status||"available")})]})}),g.length>0&&e.jsx("div",{className:"px-6 py-3 bg-blue-50 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(cn,{className:"h-5 w-5 text-blue-600"}),e.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[g.length," comanda",g.length!==1?"s":""," aberta",g.length!==1?"s":""]})]}),e.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full",children:["ATIVA",g.length!==1?"S":""]})]})}),g.length===0&&v.length>0&&e.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(cn,{className:"h-5 w-5 text-yellow-600"}),e.jsxs("span",{className:"text-sm font-medium text-yellow-800",children:[v.length," comanda",v.length!==1?"s":""," no caixa"]})]}),e.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs font-medium rounded-full",children:"AGUARDANDO PAGTO"})]})}),g.length===0&&v.length===0&&b.length>0&&e.jsx("div",{className:"px-6 py-3 bg-gray-50 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(cn,{className:"h-5 w-5 text-gray-500"}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[b.length," comanda",b.length!==1?"s":""," no histrico"]})]}),e.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs font-medium rounded-full",children:["PAGA",b.length!==1?"S":""]})]})}),e.jsxs("div",{className:"px-6 py-4 space-y-3",children:[o&&(g.length>0||t.status==="available")&&e.jsxs("button",{onClick:()=>o(t),className:"w-full flex items-center justify-center space-x-2 bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(cn,{className:"h-5 w-5"}),e.jsx("span",{children:g.length>0?`Gerenciar Comandas (${g.length})`:"Criar Nova Comanda"})]}),o&&g.length===0&&b.length>0&&t.status!=="available"&&e.jsxs("button",{onClick:()=>o(t),className:"w-full flex items-center justify-center space-x-2 bg-gray-600 text-white px-4 py-3 rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(cn,{className:"h-5 w-5"}),e.jsxs("span",{children:["Ver Histrico (",b.length,")"]})]}),t.status==="available"&&r&&e.jsxs("button",{onClick:()=>r(t),className:"w-full flex items-center justify-center space-x-2 bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Za,{className:"h-5 w-5"}),e.jsx("span",{children:"Iniciar Atendimento"})]}),t.status==="occupied"&&l&&e.jsxs("button",{onClick:()=>l(t),className:"w-full flex items-center justify-center space-x-2 bg-orange-600 text-white px-4 py-3 rounded-lg hover:bg-orange-700 transition-colors",children:[e.jsx(Ha,{className:"h-5 w-5"}),e.jsx("span",{children:"Finalizar Atendimento"})]}),t.status==="occupied"&&e.jsxs("button",{onClick:()=>_("available"),className:"w-full flex items-center justify-center space-x-2 bg-gray-600 text-white px-4 py-3 rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(Ha,{className:"h-5 w-5"}),e.jsx("span",{children:"Liberar Mesa (Rpido)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Alterar Status:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.status!=="available"&&e.jsxs("button",{onClick:N=>{console.log("Clique no boto Disponvel",N),_("available")},className:"flex items-center justify-center space-x-1 px-3 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-sm",children:[e.jsx(Ha,{className:"h-4 w-4"}),e.jsx("span",{children:"Disponvel"})]}),t.status!=="occupied"&&e.jsxs("button",{onClick:N=>{console.log("Clique no boto Ocupada",N),_("occupied")},className:"flex items-center justify-center space-x-1 px-3 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors text-sm",children:[e.jsx(Za,{className:"h-4 w-4"}),e.jsx("span",{children:"Ocupada"})]}),t.status!=="reserved"&&e.jsxs("button",{onClick:()=>_("reserved"),className:"flex items-center justify-center space-x-1 px-3 py-2 bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 transition-colors text-sm",children:[e.jsx(Ga,{className:"h-4 w-4"}),e.jsx("span",{children:"Reservada"})]}),t.status!=="cleaning"&&e.jsxs("button",{onClick:()=>_("cleaning"),className:"flex items-center justify-center space-x-1 px-3 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors text-sm",children:[e.jsx(L$,{className:"h-4 w-4"}),e.jsx("span",{children:"Limpeza"})]}),t.status!=="maintenance"&&e.jsxs("button",{onClick:()=>_("maintenance"),className:"flex items-center justify-center space-x-1 px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm",children:[e.jsx(Z$,{className:"h-4 w-4"}),e.jsx("span",{children:"Manuteno"})]})]})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex space-x-3",children:[e.jsxs("button",{onClick:()=>a(t),className:"flex-1 flex items-center justify-center space-x-2 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors",children:[e.jsx(Sm,{className:"h-4 w-4"}),e.jsx("span",{children:"Editar"})]}),e.jsxs("button",{onClick:N=>{console.log("Clique no boto Excluir",N),w()},className:"flex-1 flex items-center justify-center space-x-2 bg-red-100 text-red-700 px-4 py-2 rounded-lg hover:bg-red-200 transition-colors",children:[e.jsx(Em,{className:"h-4 w-4"}),e.jsx("span",{children:"Excluir"})]})]}),t.description&&e.jsxs("div",{className:"px-6 py-3 bg-gray-50 border-t border-gray-200",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Observaes:"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.description})]})]})})},o7=({table:t,onClose:s,onCreateComanda:a})=>{const{user:r}=Et(),{getComandasByTableId:o,getOpenComandasByTableId:l,createComandaForTable:c,closeComanda:u,deleteComanda:h}=Yi(),[f,p]=y.useState(""),[g,v]=y.useState(1),[b,_]=y.useState(!1),w=o(t.id),E=l(t.id);console.log("TableComandasPanel - Comandas da mesa:",t.id,w),w.length>0&&console.log("Primeira comanda com itens:",w[0]);const T=async()=>{if(console.log(" handleCreateComanda chamada para mesa:",t.id),!r){alert("Usurio no autenticado");return}try{_(!0),console.log(" Dados da comanda:",{table_id:t.id,employee_id:r.id,customer_name:f,people_count:g});const A=await c(t.id,r.id,f||void 0,g);console.log(" Nova comanda criada:",A),p(""),v(1),a&&a(A)}catch(A){console.error("Erro ao criar comanda:",A),alert("Erro ao criar comanda: "+(A instanceof Error?A.message:"Erro desconhecido"))}finally{_(!1)}},N=async A=>{const $=prompt("Mtodo de pagamento (opcional):");try{await u(A,$||void 0),console.log("Comanda fechada:",A)}catch(P){console.error("Erro ao fechar comanda:",P),alert("Erro ao fechar comanda: "+(P instanceof Error?P.message:"Erro desconhecido"))}},k=async A=>{if(window.confirm("Tem certeza que deseja excluir esta comanda?"))try{await h(A),console.log("Comanda excluda:",A)}catch($){console.error("Erro ao excluir comanda:",$),alert("Erro ao excluir comanda: "+($ instanceof Error?$.message:"Erro desconhecido"))}},S=A=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(A),C=A=>new Date(A).toLocaleString("pt-BR"),M=A=>{switch(A){case"open":return"bg-green-100 text-green-800";case"pending_payment":return"bg-yellow-100 text-yellow-800";case"closed":return"bg-gray-100 text-gray-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},z=A=>{switch(A){case"open":return"Aberta";case"pending_payment":return"Aguardando Pagamento";case"closed":return"Fechada";case"cancelled":return"Cancelada";default:return"Indefinido"}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Comandas - Mesa ",t.number]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Za,{className:"h-4 w-4"}),e.jsxs("span",{children:["Capacidade: ",t.capacity]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(cn,{className:"h-4 w-4"}),e.jsxs("span",{children:[w.length," comandas"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Ga,{className:"h-4 w-4"}),e.jsxs("span",{children:[E.length," abertas"]})]})]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ki,{className:"h-6 w-6"})})]})}),e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50 flex-shrink-0",children:[e.jsx("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Nova Comanda"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Cliente (opcional)"}),e.jsx("input",{type:"text",value:f,onChange:A=>p(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nome do cliente"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nmero de Pessoas"}),e.jsx("input",{type:"number",min:"1",max:t.capacity,value:g,onChange:A=>v(parseInt(A.target.value)||1),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:T,disabled:b,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:[e.jsx(Ui,{className:"h-4 w-4"}),e.jsx("span",{children:b?"Criando...":"Criar Comanda"})]})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:w.length===0?e.jsxs("div",{className:"px-6 py-8 text-center",children:[e.jsx(cn,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma comanda encontrada"}),e.jsx("p",{className:"text-gray-500",children:"Crie a primeira comanda para esta mesa"})]}):e.jsx("div",{className:"px-6 py-4 space-y-3",children:w.map(A=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${M(A.status||"open")}`,children:z(A.status||"open")}),A.customer_name&&e.jsx("span",{className:"text-sm font-medium text-gray-900",children:A.customer_name}),A.people_count&&e.jsxs("span",{className:"text-sm text-gray-600",children:[A.people_count," pessoas"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Aberta em:"}),e.jsx("br",{}),A.opened_at?C(A.opened_at):"N/A"]}),A.closed_at&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Fechada em:"}),e.jsx("br",{}),C(A.closed_at)]})]}),A.total&&e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(B2,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-semibold text-green-600",children:S(A.total)})]}),A.comanda_items&&A.comanda_items.length>0&&e.jsxs("div",{className:"mt-3 border-t pt-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 mb-2 block",children:["Itens (",A.comanda_items.length,"):"]}),e.jsx("div",{className:"space-y-1",children:A.comanda_items.map(($,P)=>{var F;return e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-gray-600",children:[$.quantity,"x"]}),e.jsx("span",{className:"text-gray-900",children:((F=$.menu_items)==null?void 0:F.name)||"Item sem nome"})]}),e.jsx("span",{className:"text-gray-600",children:S($.price*$.quantity)})]},$.id||P)})})]}),A.notes&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Observaes:"})," ",A.notes]})]}),e.jsxs("div",{className:"flex flex-col space-y-2 ml-4",children:[A.status==="open"&&e.jsxs("button",{onClick:()=>N(A.id),className:"flex items-center space-x-1 px-3 py-1 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-sm",children:[e.jsx(Ha,{className:"h-4 w-4"}),e.jsx("span",{children:"Fechar"})]}),e.jsxs("button",{onClick:()=>k(A.id),className:"flex items-center space-x-1 px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors text-sm",children:[e.jsx(Em,{className:"h-4 w-4"}),e.jsx("span",{children:"Excluir"})]})]})]})},A.id))})}),w.length>0&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50 flex-shrink-0",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:w.length}),e.jsx("div",{className:"text-gray-600",children:"Total de Comandas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-green-600",children:E.length}),e.jsx("div",{className:"text-gray-600",children:"Comandas Abertas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-blue-600",children:S(w.filter(A=>A.status==="closed").reduce((A,$)=>A+($.total||0),0))}),e.jsx("div",{className:"text-gray-600",children:"Total Faturado"})]})]})})]})})},i7=({table:t,onClose:s,onFinalized:a})=>{const{getOpenComandasByTableId:r,updateComanda:o}=Yi(),{updateTableStatus:l}=Rr(),[c,u]=y.useState(!1),[h,f]=y.useState(""),[p,g]=y.useState(!1),v=r(t.id),b=v.reduce((S,C)=>S+(C.total||0),0),_=v.reduce((S,C)=>{var M;return S+(((M=C.comanda_items)==null?void 0:M.reduce((z,A)=>z+A.quantity,0))||0)},0),w=S=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(S),E=S=>new Date(S).toLocaleString("pt-BR"),T=()=>{g(!0),setTimeout(()=>{const S=N(),C=window.open("","_blank");C&&(C.document.write(S),C.document.close(),C.print(),C.close()),g(!1)},1e3)},N=()=>{const S=new Date().toLocaleString("pt-BR");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Comanda - Mesa ${t.number}</title>
        <style>
          body { font-family: monospace; font-size: 12px; margin: 20px; }
          .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 15px; }
          .mesa-info { text-align: center; margin-bottom: 15px; }
          .item { display: flex; justify-content: space-between; margin-bottom: 5px; }
          .total { border-top: 2px solid #000; padding-top: 10px; margin-top: 15px; font-weight: bold; }
          .footer { text-align: center; margin-top: 20px; font-size: 10px; }
        </style>
      </head>
      <body>
        <div class="header">
          <h2>CLUBE AABB</h2>
          <p>Sistema de Atendimento do Bar</p>
        </div>
        
        <div class="mesa-info">
          <h3>MESA ${t.number}</h3>
          <p>Capacidade: ${t.capacity} pessoas</p>
          <p>Data/Hora: ${S}</p>
        </div>

        <h4>ITENS CONSUMIDOS:</h4>
        ${v.map(C=>{var M;return`
          <div style="margin-bottom: 15px;">
            <strong>Comanda: ${C.customer_name||"Sem nome"}</strong>
            ${((M=C.comanda_items)==null?void 0:M.map(z=>{var A;return`
              <div class="item">
                <span>${z.quantity}x ${((A=z.menu_items)==null?void 0:A.name)||"Item"}</span>
                <span>${w(z.price*z.quantity)}</span>
              </div>
            `}).join(""))||""}
          </div>
        `}).join("")}

        <div class="total">
          <div class="item">
            <span>TOTAL DE ITENS: ${_}</span>
            <span></span>
          </div>
          <div class="item">
            <span>TOTAL GERAL:</span>
            <span>${w(b)}</span>
          </div>
        </div>

        <div class="footer">
          <p>Obrigado pela preferncia!</p>
          <p>Esta comanda foi enviada para o caixa</p>
        </div>
      </body>
      </html>
    `},k=async()=>{if(!h){alert("Selecione um mtodo de pagamento");return}u(!0);try{const S=v.map(C=>o(C.id,{status:"pending_payment",payment_method:h}));await Promise.all(S),await l(t.id,"available"),console.log("Comandas enviadas para o caixa:",{mesa:t.number,comandas:v.length,total:b,paymentMethod:h,status:"pending_payment"}),T(),alert(`Atendimento finalizado com sucesso!

Mesa ${t.number} liberada
Total: ${w(b)}
Mtodo: ${h}

 Comandas enviadas para o CAIXA
 Aguardando pagamento`),a&&a(),s()}catch(S){console.error("Erro ao finalizar atendimento:",S),alert("Erro ao finalizar atendimento: "+(S instanceof Error?S.message:"Erro desconhecido"))}finally{u(!1)}};return v.length===0?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(_r,{className:"h-12 w-12 text-yellow-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhuma Comanda Aberta"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"No h comandas abertas para finalizar nesta mesa."}),e.jsx("button",{onClick:s,className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:"Fechar"})]})})}):e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Finalizar Atendimento - Mesa ",t.number]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Za,{className:"h-4 w-4"}),e.jsxs("span",{children:["Capacidade: ",t.capacity]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(cn,{className:"h-4 w-4"}),e.jsxs("span",{children:[v.length," comandas"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(B2,{className:"h-4 w-4"}),e.jsx("span",{children:w(b)})]})]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Ki,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:e.jsxs("div",{className:"px-6 py-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Comandas a Finalizar"}),e.jsx("div",{className:"space-y-3",children:v.map(S=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:S.customer_name||"Cliente sem nome"}),S.people_count&&e.jsxs("span",{className:"text-sm text-gray-600",children:["(",S.people_count," pessoas)"]})]}),e.jsx("span",{className:"font-semibold text-green-600",children:w(S.total||0)})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[e.jsx(Ga,{className:"h-4 w-4 inline mr-1"}),"Aberta em: ",S.opened_at?E(S.opened_at):"N/A"]}),S.comanda_items&&S.comanda_items.length>0&&e.jsxs("div",{className:"mt-3 border-t pt-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 mb-2 block",children:["Itens (",S.comanda_items.length,"):"]}),e.jsx("div",{className:"space-y-1",children:S.comanda_items.map((C,M)=>{var z;return e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-gray-600",children:[C.quantity,"x"]}),e.jsx("span",{className:"text-gray-900",children:((z=C.menu_items)==null?void 0:z.name)||"Item sem nome"})]}),e.jsx("span",{className:"text-gray-600",children:w(C.price*C.quantity)})]},C.id||M)})})]})]},S.id))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Mtodo de Pagamento"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{value:"dinheiro",label:"Dinheiro",icon:""},{value:"cartao_credito",label:"Carto de Crdito",icon:""},{value:"cartao_debito",label:"Carto de Dbito",icon:""},{value:"pix",label:"PIX",icon:""},{value:"credito_socio",label:"Crdito do Scio",icon:""},{value:"misto",label:"Pagamento Misto",icon:""}].map(S=>e.jsx("button",{onClick:()=>f(S.value),className:`p-3 rounded-lg border-2 transition-colors text-left ${h===S.value?"border-blue-500 bg-blue-50 text-blue-900":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-lg",children:S.icon}),e.jsx("span",{className:"font-medium",children:S.label})]})},S.value))})]})]})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50 flex-shrink-0",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:v.length}),e.jsx("div",{className:"text-gray-600",children:"Comandas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-blue-600",children:_}),e.jsx("div",{className:"text-gray-600",children:"Itens"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-green-600 text-lg",children:w(b)}),e.jsx("div",{className:"text-gray-600",children:"Total"})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:T,disabled:p,className:"flex-1 flex items-center justify-center space-x-2 bg-gray-600 text-white px-4 py-3 rounded-lg hover:bg-gray-700 transition-colors disabled:opacity-50",children:[e.jsx(z$,{className:"h-5 w-5"}),e.jsx("span",{children:p?"Imprimindo...":"Imprimir Prvia"})]}),e.jsxs("button",{onClick:k,disabled:!h||c,className:"flex-2 flex items-center justify-center space-x-2 bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Ha,{className:"h-5 w-5"}),e.jsx("span",{children:c?"Finalizando...":"Finalizar Atendimento"})]})]})]})]})})},l7=({readonly:t=!1,onTableSelect:s,selectedTableId:a})=>{const{tables:r,loading:o,updateTablePosition:l,updateTableStatus:c,organizeTablesAutomatically:u}=Rr(),[h,f]=y.useState(!1),[p,g]=y.useState(null),[v,b]=y.useState(null),[_,w]=y.useState(null),[E,T]=y.useState(null),[N,k]=y.useState(null),[S,C]=y.useState(!1),[M,z]=y.useState(new Set),A=y.useRef(null),$=H=>{switch(H){case"available":return"bg-green-500 border-green-600";case"occupied":return"bg-red-500 border-red-600";case"reserved":return"bg-yellow-500 border-yellow-600";case"cleaning":return"bg-blue-500 border-blue-600";case"maintenance":return"bg-gray-500 border-gray-600";default:return"bg-gray-300 border-gray-400"}},P=H=>{switch(H){case"available":return"Disponvel";case"occupied":return"Ocupada";case"reserved":return"Reservada";case"cleaning":return"Limpeza";case"maintenance":return"Manuteno";default:return"Indefinido"}},F=y.useCallback((H,B)=>{var oe;if(t||!S)return;const Y=(oe=A.current)==null?void 0:oe.getBoundingClientRect();if(!Y)return;const ne=Math.max(0,Math.min(B.point.x-Y.left-40,Y.width-80)),ie=Math.max(0,Math.min(B.point.y-Y.top-40,Y.height-80));l(H,ne,ie)},[t,S,l]),I=(H,B)=>{if(!M.has(H.id)){if(S&&!t){s&&s(H);return}w(H),s&&s(H)}},J=(H,B)=>{t||(H.preventDefault(),b({table:B,x:H.clientX,y:H.clientY}))},pe=H=>{g(H),f(!0),b(null)},te=()=>{g(null),f(!0)},L=()=>{b(null)},G=async H=>{console.log("Iniciando atendimento para mesa:",H.number);try{await c(H.id,"occupied"),console.log("Status da mesa alterado para ocupada"),w(null),console.log("Abrindo painel de comandas automaticamente..."),T({...H,status:"occupied"}),s&&s(H)}catch(B){console.error("Erro ao iniciar atendimento:",B),alert("Erro ao iniciar atendimento: "+(B instanceof Error?B.message:"Erro desconhecido"))}},ee=H=>{console.log("Gerenciando comandas para mesa:",H.number),w(null),T(H)},xe=H=>{console.log("Finalizando atendimento para mesa:",H.number),w(null),k(H)},O=async()=>{if(!A.current)return;const H=A.current.getBoundingClientRect(),B=H.width,Y=H.height;try{await u(B,Y)}catch(ne){console.error("Erro ao organizar mesas:",ne),alert("Erro ao organizar mesas. Tente novamente.")}};return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Layout das Mesas"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[r.length," mesa",r.length!==1?"s":""]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:!t&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>C(!S),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${S?"bg-blue-100 text-blue-700 hover:bg-blue-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:S?e.jsxs(e.Fragment,{children:[e.jsx(N$,{className:"h-4 w-4 inline mr-1"}),"Sair do Modo Edio"]}):e.jsxs(e.Fragment,{children:[e.jsx(Sm,{className:"h-4 w-4 inline mr-1"}),"Modo Edio"]})}),e.jsxs("button",{onClick:O,className:"bg-green-600 text-white px-3 py-2 rounded-lg hover:bg-green-700 transition-colors text-sm font-medium",title:"Organizar mesas automaticamente",children:[e.jsx(Kj,{className:"h-4 w-4 inline mr-1"}),"Organizar"]}),e.jsxs("button",{onClick:te,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:[e.jsx(Ui,{className:"h-4 w-4 inline mr-1"}),"Nova Mesa"]})]})})]}),e.jsxs("div",{className:"bg-yellow-100 border-b p-2 text-sm",children:[e.jsx("strong",{children:"Debug Layout:"})," ",r.length," mesas, Modo Edio: ",S?"ON":"OFF"]}),e.jsx("div",{className:"flex-1 relative min-h-[600px] overflow-visible",ref:A,children:e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-100 to-gray-200 min-h-[600px]",children:[e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`
                linear-gradient(rgba(0,0,0,0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,0,0,0.1) 1px, transparent 1px)
              `,backgroundSize:"20px 20px"}}),r.map((H,B)=>{const Y=H.position_x??50+B%5*120,ne=H.position_y??50+Math.floor(B/5)*120;return console.log("Mesa:",H.number,"Posio:",{x:Y,y:ne,dbX:H.position_x,dbY:H.position_y}),e.jsxs(be.div,{drag:S&&!t,dragMomentum:!1,dragElastic:0,onDragStart:()=>z(ie=>new Set(ie).add(H.id)),onDragEnd:(ie,oe)=>{F(H.id,oe),z(me=>{const D=new Set(me);return D.delete(H.id),D})},initial:{x:Y,y:ne},animate:{x:Y,y:ne},whileHover:M.has(H.id)?{}:{scale:1.05},whileDrag:{scale:1.1,zIndex:1e3},className:`absolute cursor-pointer select-none ${S&&!t?"cursor-move":"cursor-pointer"}`,onClick:ie=>I(H),onContextMenu:ie=>J(ie,H),children:[e.jsx("div",{className:`
                  w-20 h-20 rounded-lg border-2 shadow-lg transition-all duration-200
                  ${$(H.status||"available")}
                  ${a===H.id||(_==null?void 0:_.id)===H.id?"ring-4 ring-blue-300 ring-offset-2":""}
                  ${M.has(H.id)?"shadow-2xl":""}
                  hover:shadow-xl
                `,children:e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-white",children:[e.jsx("div",{className:"text-lg font-bold",children:H.number}),e.jsxs("div",{className:"text-xs opacity-90",children:[H.capacity,"p"]})]})}),e.jsx("div",{className:"absolute -bottom-6 left-1/2 transform -translate-x-1/2",children:e.jsx("div",{className:"bg-white px-2 py-1 rounded text-xs font-medium text-gray-700 shadow-sm border",children:P(H.status||"available")})})]},H.id)}),r.length===0&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Kj,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma mesa configurada"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Crie sua primeira mesa para comear a organizar o layout"}),!t&&e.jsxs("button",{onClick:te,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Ui,{className:"h-4 w-4 inline mr-1"}),"Criar Mesa"]})]})})]})}),e.jsx("div",{className:"bg-white border-t p-4",children:e.jsxs("div",{className:"flex items-center justify-center space-x-6 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-green-500 border border-green-600"}),e.jsx("span",{children:"Disponvel"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-red-500 border border-red-600"}),e.jsx("span",{children:"Ocupada"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-yellow-500 border border-yellow-600"}),e.jsx("span",{children:"Reservada"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-blue-500 border border-blue-600"}),e.jsx("span",{children:"Limpeza"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gray-500 border border-gray-600"}),e.jsx("span",{children:"Manuteno"})]})]})}),e.jsx(H2,{isOpen:h,onClose:()=>{f(!1),g(null)},table:p}),v&&e.jsx(r7,{table:v.table,x:v.x,y:v.y,onClose:L,onEdit:()=>pe(v.table)}),_&&e.jsx(n7,{table:_,onClose:()=>w(null),onEdit:H=>{w(null),pe(H)},onStartOrder:G,onManageComandas:ee,onFinalizarAtendimento:xe}),E&&e.jsx(o7,{table:E,onClose:()=>T(null),onCreateComanda:H=>{console.log("Nova comanda criada:",H),E.status==="available"&&c(E.id,"occupied")}}),N&&e.jsx(i7,{table:N,onClose:()=>k(null),onFinalized:()=>{console.log("Atendimento finalizado para mesa:",N.number)}})]})},c7=({onTableSelect:t,selectedTableId:s})=>{const{tables:a,loading:r,deleteTable:o}=Rr(),[l,c]=y.useState(!1),[u,h]=y.useState(null),[f,p]=y.useState(""),[g,v]=y.useState("all"),[b,_]=y.useState("number"),w=M=>{switch(M){case"available":return e.jsx(Ha,{className:"h-5 w-5 text-green-500"});case"occupied":return e.jsx(Za,{className:"h-5 w-5 text-red-500"});case"reserved":return e.jsx(Ga,{className:"h-5 w-5 text-yellow-500"});case"cleaning":return e.jsx(_r,{className:"h-5 w-5 text-blue-500"});case"maintenance":return e.jsx(_r,{className:"h-5 w-5 text-gray-500"});default:return e.jsx(Ha,{className:"h-5 w-5 text-gray-400"})}},E=M=>{switch(M){case"available":return"Disponvel";case"occupied":return"Ocupada";case"reserved":return"Reservada";case"cleaning":return"Limpeza";case"maintenance":return"Manuteno";default:return"Indefinido"}},T=M=>{switch(M){case"available":return"bg-green-100 text-green-800";case"occupied":return"bg-red-100 text-red-800";case"reserved":return"bg-yellow-100 text-yellow-800";case"cleaning":return"bg-blue-100 text-blue-800";case"maintenance":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},N=Ye.useMemo(()=>{let M=a;return f&&(M=M.filter(z=>{var A;return z.number.toLowerCase().includes(f.toLowerCase())||((A=z.notes)==null?void 0:A.toLowerCase().includes(f.toLowerCase()))})),g!=="all"&&(M=M.filter(z=>z.status===g)),M.sort((z,A)=>{switch(b){case"number":return z.number.localeCompare(A.number,void 0,{numeric:!0});case"capacity":return A.capacity-z.capacity;case"status":return(z.status||"").localeCompare(A.status||"");default:return 0}}),M},[a,f,g,b]),k=M=>{h(M),c(!0)},S=async M=>{if(confirm(`Tem certeza que deseja excluir a mesa ${M.number}?`))try{await o(M.id)}catch(z){console.error("Erro ao excluir mesa:",z),alert("Erro ao excluir mesa. Tente novamente.")}},C=()=>{h(null),c(!0)};return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"h-full flex flex-col bg-white",children:[e.jsx("div",{className:"border-b p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(nm,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar mesas...",value:f,onChange:M=>p(M.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:g,onChange:M=>v(M.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"available",children:"Disponvel"}),e.jsx("option",{value:"occupied",children:"Ocupada"}),e.jsx("option",{value:"reserved",children:"Reservada"}),e.jsx("option",{value:"cleaning",children:"Limpeza"}),e.jsx("option",{value:"maintenance",children:"Manuteno"})]}),e.jsxs("select",{value:b,onChange:M=>_(M.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"number",children:"Ordenar por Nmero"}),e.jsx("option",{value:"capacity",children:"Ordenar por Capacidade"}),e.jsx("option",{value:"status",children:"Ordenar por Status"})]})]}),e.jsxs("button",{onClick:C,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx(Ui,{className:"h-4 w-4"}),e.jsx("span",{children:"Nova Mesa"})]})]})}),e.jsx("div",{className:"flex-1 overflow-auto",children:N.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Za,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:f||g!=="all"?"Nenhuma mesa encontrada":"Nenhuma mesa cadastrada"}),e.jsx("p",{className:"text-gray-500 mb-4",children:f||g!=="all"?"Tente ajustar os filtros de busca":"Crie sua primeira mesa para comear"}),!f&&g==="all"&&e.jsxs("button",{onClick:C,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Ui,{className:"h-4 w-4 inline mr-1"}),"Criar Mesa"]})]})}):e.jsx("div",{className:"divide-y divide-gray-200",children:N.map(M=>e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${s===M.id?"bg-blue-50 border-l-4 border-blue-500":""}`,onClick:()=>t==null?void 0:t(M),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:w(M.status)}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Mesa ",M.number]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${T(M.status)}`,children:E(M.status)})]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-600",children:[e.jsxs("span",{children:["Capacidade: ",M.capacity," pessoas"]}),M.position_x!==null&&M.position_y!==null&&e.jsxs("span",{children:["Posio: (",M.position_x,", ",M.position_y,")"]})]}),M.notes&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:M.notes})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:z=>{z.stopPropagation(),k(M)},className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Editar mesa",children:e.jsx(Sm,{className:"h-4 w-4"})}),e.jsx("button",{onClick:z=>{z.stopPropagation(),S(M)},className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Excluir mesa",children:e.jsx(Em,{className:"h-4 w-4"})})]})]})},M.id))})}),e.jsx("div",{className:"border-t p-4 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:[N.length," de ",a.length," mesa",a.length!==1?"s":""]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsxs("span",{children:[a.filter(M=>M.status==="available").length," disponveis"]})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsxs("span",{children:[a.filter(M=>M.status==="occupied").length," ocupadas"]})]})]})]})}),e.jsx(H2,{isOpen:l,onClose:()=>{c(!1),h(null)},table:u})]})},d7=()=>{const{tables:t,loading:s}=Rr(),a=Ye.useMemo(()=>{const l=t.length,c=t.filter(w=>w.status==="available").length,u=t.filter(w=>w.status==="occupied").length,h=t.filter(w=>w.status==="reserved").length,f=t.filter(w=>w.status==="cleaning").length,p=t.filter(w=>w.status==="maintenance").length,g=t.reduce((w,E)=>w+E.capacity,0),v=l>0?g/l:0,b=l>0?u/l*100:0,_=l>0?c/l*100:0;return{total:l,available:c,occupied:u,reserved:h,cleaning:f,maintenance:p,totalCapacity:g,averageCapacity:v,occupancyRate:b,availabilityRate:_}},[t]),r=[{title:"Disponveis",value:a.available,icon:Ha,color:"text-green-600",bgColor:"bg-green-100",percentage:a.total>0?a.available/a.total*100:0},{title:"Ocupadas",value:a.occupied,icon:Za,color:"text-red-600",bgColor:"bg-red-100",percentage:a.total>0?a.occupied/a.total*100:0},{title:"Reservadas",value:a.reserved,icon:Ga,color:"text-yellow-600",bgColor:"bg-yellow-100",percentage:a.total>0?a.reserved/a.total*100:0},{title:"Limpeza",value:a.cleaning,icon:_r,color:"text-blue-600",bgColor:"bg-blue-100",percentage:a.total>0?a.cleaning/a.total*100:0},{title:"Manuteno",value:a.maintenance,icon:_r,color:"text-gray-600",bgColor:"bg-gray-100",percentage:a.total>0?a.maintenance/a.total*100:0}],o=Ye.useMemo(()=>{const l={};return t.forEach(c=>{l[c.capacity]=(l[c.capacity]||0)+1}),Object.entries(l).map(([c,u])=>({capacity:parseInt(c),count:u,percentage:a.total>0?u/a.total*100:0})).sort((c,u)=>c.capacity-u.capacity)},[t,a.total]);return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsx("div",{className:"h-full overflow-auto bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Resumo Geral"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:a.total}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total de Mesas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:a.totalCapacity}),e.jsx("div",{className:"text-sm text-gray-600",children:"Capacidade Total"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-600",children:a.averageCapacity.toFixed(1)}),e.jsx("div",{className:"text-sm text-gray-600",children:"Capacidade Mdia"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-orange-600",children:[a.occupancyRate.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Taxa de Ocupao"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Status das Mesas"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:r.map((l,c)=>{const u=l.icon;return e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:c*.1},className:"bg-white border rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:l.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.value}),e.jsxs("p",{className:"text-xs text-gray-500",children:[l.percentage.toFixed(1),"%"]})]}),e.jsx("div",{className:`p-3 rounded-full ${l.bgColor}`,children:e.jsx(u,{className:`h-6 w-6 ${l.color}`})})]}),e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${l.color.includes("green")?"bg-green-500":l.color.includes("red")?"bg-red-500":l.color.includes("yellow")?"bg-yellow-500":l.color.includes("blue")?"bg-blue-500":"bg-gray-500"}`,style:{width:`${l.percentage}%`}})})})]},l.title)})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Distribuio por Capacidade"}),o.length>0?e.jsx("div",{className:"space-y-4",children:o.map((l,c)=>e.jsxs(be.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:c*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Za,{className:"h-5 w-5 text-gray-500"}),e.jsxs("span",{className:"font-medium text-gray-900",children:[l.capacity," pessoa",l.capacity!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[l.count," mesa",l.count!==1?"s":""]}),e.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"h-2 bg-blue-500 rounded-full transition-all duration-500",style:{width:`${l.percentage}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 w-12 text-right",children:[l.percentage.toFixed(1),"%"]})]})]},l.capacity))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(U2,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhuma mesa cadastrada"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Taxa de Disponibilidade"}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"relative w-32 h-32",children:[e.jsxs("svg",{className:"w-32 h-32 transform -rotate-90",viewBox:"0 0 36 36",children:[e.jsx("path",{className:"text-gray-300",stroke:"currentColor",strokeWidth:"3",fill:"none",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"}),e.jsx("path",{className:"text-green-500",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:`${a.availabilityRate}, 100`,d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:[a.availabilityRate.toFixed(0),"%"]})})]})}),e.jsxs("p",{className:"text-center text-sm text-gray-600 mt-4",children:[a.available," de ",a.total," mesas disponveis"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Taxa de Ocupao"}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"relative w-32 h-32",children:[e.jsxs("svg",{className:"w-32 h-32 transform -rotate-90",viewBox:"0 0 36 36",children:[e.jsx("path",{className:"text-gray-300",stroke:"currentColor",strokeWidth:"3",fill:"none",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"}),e.jsx("path",{className:"text-red-500",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:`${a.occupancyRate}, 100`,d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:[a.occupancyRate.toFixed(0),"%"]})})]})}),e.jsxs("p",{className:"text-center text-sm text-gray-600 mt-4",children:[a.occupied," de ",a.total," mesas ocupadas"]})]})]})]})})},u7=()=>{const[t,s]=y.useState("layout"),[a,r]=y.useState(null),o=[{id:"layout",name:"Layout Visual",icon:V$,description:"Visualizar e organizar mesas no layout"},{id:"list",name:"Lista",icon:k$,description:"Visualizar mesas em formato de lista"},{id:"stats",name:"Estatsticas",icon:U2,description:"Mtricas e relatrios das mesas"}],l=u=>{r(u)},c=()=>{switch(t){case"layout":return e.jsx(l7,{onTableSelect:l,selectedTableId:a==null?void 0:a.id});case"list":return e.jsx(c7,{onTableSelect:l,selectedTableId:a==null?void 0:a.id});case"stats":return e.jsx(d7,{});default:return null}};return e.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b",children:e.jsxs("div",{className:"px-6 py-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gerenciamento de Mesas"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Configure e monitore as mesas do estabelecimento"})]})}),e.jsx("div",{className:"mt-6",children:e.jsx("nav",{className:"flex space-x-8",children:o.map(u=>{const h=u.icon,f=t===u.id;return e.jsxs("button",{onClick:()=>s(u.id),className:`relative flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm transition-colors ${f?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(h,{className:"h-5 w-5"}),e.jsx("span",{children:u.name}),f&&e.jsx(be.div,{layoutId:"activeTab",className:"absolute inset-0 bg-blue-50 rounded-md -z-10",initial:!1,transition:{type:"spring",bounce:.2,duration:.6}})]},u.id)})})})]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"h-full",children:c()},t)}),a&&e.jsx(be.div,{initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:100},className:"bg-white border-t p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-4 h-4 rounded-full ${a.status==="available"?"bg-green-500":a.status==="occupied"?"bg-red-500":a.status==="reserved"?"bg-yellow-500":a.status==="cleaning"?"bg-blue-500":"bg-gray-500"}`}),e.jsxs("span",{className:"font-medium",children:["Mesa ",a.number]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Capacidade: ",a.capacity," pessoas"]}),a.notes&&e.jsx("div",{className:"text-sm text-gray-500",children:a.notes})]}),e.jsx("button",{onClick:()=>r(null),className:"text-gray-400 hover:text-gray-600",children:""})]})})]})},m7=()=>e.jsx(u7,{}),h7=({isOpen:t,onClose:s,selectedTable:a,onComandaCreated:r})=>{const{user:o}=Et(),{tables:l}=Rr(),{createComanda:c}=Yi(),[u,h]=y.useState({table_id:(a==null?void 0:a.id)||"",customer_id:"",customer_name:"",people_count:1,notes:""}),[f,p]=y.useState(""),[g,v]=y.useState([]),[b,_]=y.useState(!1),[w,E]=y.useState(!1),T=async S=>{if(!S.trim()){v([]);return}try{_(!0);const{data:C,error:M}=await V.from("bar_customers").select("*").or(`phone.ilike.%${S}%,name.ilike.%${S}%`).eq("status","active").limit(10);if(M)throw M;v(C||[])}catch(C){console.error("Erro ao buscar clientes:",C)}finally{_(!1)}},N=S=>{h(C=>({...C,customer_id:S.id,customer_name:S.name})),p(S.name),v([])},k=async S=>{if(S.preventDefault(),!!o)try{E(!0);const C={table_id:u.table_id||void 0,customer_id:u.customer_id||void 0,customer_name:u.customer_name||void 0,employee_id:o.id,people_count:u.people_count,notes:u.notes||void 0};await c(C),r&&r(),s(),h({table_id:"",customer_id:"",customer_name:"",people_count:1,notes:""}),p("")}catch(C){console.error("Erro ao criar comanda:",C),alert("Erro ao criar comanda. Tente novamente.")}finally{E(!1)}};return y.useEffect(()=>{a&&h(S=>({...S,table_id:a.id}))},[a]),y.useEffect(()=>{const S=setTimeout(()=>{T(f)},300);return()=>clearTimeout(S)},[f]),t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Nova Comanda"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx(lt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:k,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(qc,{className:"w-4 h-4 inline mr-1"}),"Mesa (opcional)"]}),e.jsxs("select",{value:u.table_id,onChange:S=>h(C=>({...C,table_id:S.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Balco (sem mesa)"}),l.filter(S=>S.status==="available").map(S=>e.jsxs("option",{value:S.id,children:["Mesa ",S.number," (",S.capacity," pessoas)"]},S.id))]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Ys,{className:"w-4 h-4 inline mr-1"}),"Cliente (opcional)"]}),e.jsx("input",{type:"text",value:f,onChange:S=>{p(S.target.value),S.target.value||h(C=>({...C,customer_id:"",customer_name:""}))},placeholder:"Buscar por telefone ou nome...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),g.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-40 overflow-y-auto",children:g.map(S=>e.jsxs("button",{type:"button",onClick:()=>N(S),className:"w-full px-3 py-2 text-left hover:bg-gray-100 focus:bg-gray-100",children:[e.jsx("div",{className:"font-medium",children:S.name}),e.jsx("div",{className:"text-sm text-gray-600",children:S.phone})]},S.id))}),b&&e.jsx("div",{className:"absolute right-3 top-9",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"})})]}),f&&!u.customer_id&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do cliente"}),e.jsx("input",{type:"text",value:u.customer_name,onChange:S=>h(C=>({...C,customer_name:S.target.value})),placeholder:"Digite o nome do cliente",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Ss,{className:"w-4 h-4 inline mr-1"}),"Nmero de pessoas"]}),e.jsx("input",{type:"number",min:"1",max:"20",value:u.people_count,onChange:S=>h(C=>({...C,people_count:parseInt(S.target.value)||1})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observaes"}),e.jsx("textarea",{value:u.notes,onChange:S=>h(C=>({...C,notes:S.target.value})),placeholder:"Observaes sobre a comanda...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:w,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:w?"Criando...":"Criar Comanda"})]})]})]})}):null},f7=({comandas:t,onComandaClick:s,onDismissAlert:a})=>{const r=()=>{const h=new Date;return t.filter(f=>{if(f.status!=="open")return!1;const p=new Date(f.opened_at);return(h.getTime()-p.getTime())/(1e3*60*60)>2})},o=()=>{const h=new Date;return t.filter(f=>{if(f.status!=="open")return!1;const p=new Date(f.opened_at);return(h.getTime()-p.getTime())/(1e3*60*60)>4})},l=h=>{const f=new Date(h),g=new Date().getTime()-f.getTime(),v=Math.floor(g/(1e3*60*60)),b=Math.floor(g%(1e3*60*60)/(1e3*60));return v>0?`${v}h ${b}m`:`${b}m`},c=r(),u=o();return c.length===0?null:e.jsxs("div",{className:"mb-6 space-y-3",children:[u.map(h=>{var f,p;return e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(mt,{className:"w-6 h-6 text-red-500"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-red-800 font-semibold",children:["Comanda Crtica - ",((f=h.table)==null?void 0:f.number)||"Balco"]}),e.jsxs("p",{className:"text-red-700 text-sm",children:[((p=h.customer)==null?void 0:p.name)||h.customer_name||"Cliente no identificado","  Aberta h ",l(h.opened_at),"  R$ ",h.total.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>s(h),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors",children:"Ver Detalhes"}),a&&e.jsx("button",{onClick:()=>a(h.id),className:"p-1 text-red-500 hover:bg-red-100 rounded transition-colors",children:e.jsx(lt,{className:"w-4 h-4"})})]})]})},`critical-${h.id}`)}),c.filter(h=>!u.includes(h)).map(h=>{var f,p;return e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Vt,{className:"w-5 h-5 text-yellow-500"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-yellow-800 font-semibold",children:["Ateno - ",((f=h.table)==null?void 0:f.number)||"Balco"]}),e.jsxs("p",{className:"text-yellow-700 text-sm",children:[((p=h.customer)==null?void 0:p.name)||h.customer_name||"Cliente no identificado","  Aberta h ",l(h.opened_at),"  R$ ",h.total.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>s(h),className:"px-3 py-1 bg-yellow-600 text-white text-sm rounded hover:bg-yellow-700 transition-colors",children:"Ver Detalhes"}),a&&e.jsx("button",{onClick:()=>a(h.id),className:"p-1 text-yellow-500 hover:bg-yellow-100 rounded transition-colors",children:e.jsx(lt,{className:"w-4 h-4"})})]})]})},`warning-${h.id}`)}),c.length>3&&e.jsx("div",{className:"bg-gray-50 border border-gray-200 p-3 rounded-lg text-center",children:e.jsxs("p",{className:"text-gray-600 text-sm",children:[c.length," comandas com tempo excessivo ",u.length," crticas"]})})]})},p7=({searchTerm:t,onSearchChange:s,statusFilter:a,onStatusFilterChange:r,employeeFilter:o,onEmployeeFilterChange:l,tableFilter:c,onTableFilterChange:u,timeFilter:h,onTimeFilterChange:f,employees:p,tables:g,onClearFilters:v})=>{var E,T;const b=t||a!=="all"||o||c||h!=="all",_=N=>{switch(N){case"all":return"Todos os Status";case"open":return"Abertas";case"pending_payment":return"Aguardando Pagamento";case"closed":return"Fechadas";case"cancelled":return"Canceladas";default:return N}},w=N=>{switch(N){case"all":return"Todos os Tempos";case"recent":return"Recentes (< 1h)";case"overdue":return"Atrasadas (> 2h)";case"critical":return"Crticas (> 4h)";default:return N}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(vg,{className:"w-5 h-5 text-gray-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filtros"})]}),b&&e.jsxs("button",{onClick:v,className:"flex items-center space-x-1 px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:[e.jsx(lt,{className:"w-4 h-4"}),e.jsx("span",{children:"Limpar Filtros"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"xl:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buscar"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ka,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:t,onChange:N=>s(N.target.value),placeholder:"Mesa, cliente ou funcionrio...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:a,onChange:N=>r(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"open",children:"Abertas"}),e.jsx("option",{value:"pending_payment",children:"Aguardando Pagamento"}),e.jsx("option",{value:"closed",children:"Fechadas"}),e.jsx("option",{value:"cancelled",children:"Canceladas"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Funcionrio"}),e.jsxs("select",{value:o,onChange:N=>l(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todos os Funcionrios"}),p.map(N=>e.jsx("option",{value:N.id,children:N.name},N.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mesa"}),e.jsxs("select",{value:c,onChange:N=>u(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todas as Mesas"}),e.jsx("option",{value:"balcao",children:"Balco"}),g.map(N=>e.jsxs("option",{value:N.id,children:["Mesa ",N.number]},N.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tempo"}),e.jsxs("select",{value:h,onChange:N=>f(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Tempos"}),e.jsx("option",{value:"recent",children:"Recentes (< 1h)"}),e.jsx("option",{value:"overdue",children:"Atrasadas (> 2h)"}),e.jsx("option",{value:"critical",children:"Crticas (> 4h)"})]})]})]}),b&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[t&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full",children:['Busca: "',t,'"',e.jsx("button",{onClick:()=>s(""),className:"ml-1 p-0.5 hover:bg-blue-200 rounded-full",children:e.jsx(lt,{className:"w-3 h-3"})})]}),a!=="all"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full",children:["Status: ",_(a),e.jsx("button",{onClick:()=>r("all"),className:"ml-1 p-0.5 hover:bg-green-200 rounded-full",children:e.jsx(lt,{className:"w-3 h-3"})})]}),o&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full",children:["Funcionrio: ",(E=p.find(N=>N.id===o))==null?void 0:E.name,e.jsx("button",{onClick:()=>l(""),className:"ml-1 p-0.5 hover:bg-purple-200 rounded-full",children:e.jsx(lt,{className:"w-3 h-3"})})]}),c&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-orange-100 text-orange-800 text-xs font-medium rounded-full",children:["Mesa: ",c==="balcao"?"Balco":(T=g.find(N=>N.id===c))==null?void 0:T.number,e.jsx("button",{onClick:()=>u(""),className:"ml-1 p-0.5 hover:bg-orange-200 rounded-full",children:e.jsx(lt,{className:"w-3 h-3"})})]}),h!=="all"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full",children:["Tempo: ",w(h),e.jsx("button",{onClick:()=>f("all"),className:"ml-1 p-0.5 hover:bg-red-200 rounded-full",children:e.jsx(lt,{className:"w-3 h-3"})})]})]})]})},g7=[{value:"dinheiro",label:"Dinheiro",icon:""},{value:"cartao_debito",label:"Carto Dbito",icon:""},{value:"cartao_credito",label:"Carto Crdito",icon:""},{value:"pix",label:"PIX",icon:""},{value:"vale_refeicao",label:"Vale Refeio",icon:""},{value:"credito_conta",label:"Crdito em Conta",icon:""}],G2=({isOpen:t,comanda:s,onClose:a,onConfirm:r,loading:o=!1})=>{const[l,c]=y.useState("dinheiro"),[u,h]=y.useState("");if(!t||!s)return null;const f=async()=>{await r(l,u.trim()||void 0)},p=g=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(g);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Wi,{className:"w-6 h-6 text-green-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Processar Pagamento"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Comanda #",Nm(s.id),s.table&&` - Mesa ${s.table.number}`]})]})]}),e.jsx("button",{onClick:a,disabled:o,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(lt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Detalhes da Comanda"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Cliente"}),e.jsx("p",{className:"font-medium",children:s.customer_name||"Cliente"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Mesa"}),e.jsx("p",{className:"font-medium",children:s.table?`Mesa ${s.table.number}`:"Balco"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pessoas"}),e.jsx("p",{className:"font-medium",children:s.people_count||1})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Aberta em"}),e.jsx("p",{className:"font-medium",children:new Date(s.opened_at||s.created_at||"").toLocaleString("pt-BR")})]})]}),s.items&&s.items.length>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Itens (",s.items.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:s.items.map((g,v)=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("span",{children:[g.quantity,"x ",g.product_name]}),e.jsx("span",{className:"font-medium",children:p(g.total_price)})]},g.id))})]}),e.jsx("div",{className:"border-t pt-3 mt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Total"}),e.jsx("span",{className:"text-2xl font-bold text-green-600",children:p(s.total||0)})]})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Mtodo de Pagamento"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:g7.map(g=>e.jsx("button",{onClick:()=>c(g.value),disabled:o,className:`p-4 rounded-lg border-2 transition-all ${l===g.value?"border-green-500 bg-green-50 text-green-700":"border-gray-200 hover:border-gray-300 text-gray-700"}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:g.icon}),e.jsx("span",{className:"text-sm font-medium text-center",children:g.label})]})},g.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observaes (opcional)"}),e.jsx("textarea",{value:u,onChange:g=>h(g.target.value),disabled:o,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Adicione observaes sobre o pagamento..."})]})]}),e.jsx("div",{className:"border-t bg-gray-50 p-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,disabled:o,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancelar"}),e.jsx("button",{onClick:f,disabled:o,className:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(kt,{className:"w-4 h-4"}),"Confirmar Pagamento"]})})]})})]})})},Z2=()=>{const{user:t}=Et(),[s,a]=y.useState({mesas:[],comandas:[],metricas:null,notificacoes:[],loading:!0,error:null}),r=y.useCallback(P=>{a(F=>({...F,...P}))},[]),o=y.useCallback((P,F)=>{console.error(`Erro em ${F}:`,P),r({error:`Erro em ${F}: ${P.message||"Erro desconhecido"}`,loading:!1})},[r]),l=y.useCallback(async()=>{if(t)try{r({loading:!0,error:null});const{data:P,error:F}=await V.from("bar_tables").select(`
          *,
          comandas!comandas_table_id_fkey(
            id,
            customer_name,
            people_count,
            total,
            opened_at,
            status,
            comanda_items(
              id,
              quantity,
              price,
              status
            )
          )
        `).order("number");if(F)throw F;const I=(P==null?void 0:P.map(ee=>{var O;const xe=(O=ee.comandas)==null?void 0:O.find(H=>H.status==="open");return{...ee,currentComanda:xe||void 0,occupiedSince:(xe==null?void 0:xe.opened_at)||void 0,currentTotal:(xe==null?void 0:xe.total)||0,peopleCount:(xe==null?void 0:xe.people_count)||0}}))||[],{data:J,error:pe}=await V.from("comandas").select(`
          *,
          bar_tables(number, capacity),
          bar_customers(name, phone),
          comanda_items(
            *,
            menu_items(name, price, category)
          )
        `).in("status",["open","pending_payment"]).order("opened_at",{ascending:!1});if(pe)throw pe;const te=(J==null?void 0:J.map(ee=>({...ee,items:ee.comanda_items||[],table:ee.bar_tables||void 0,customer:ee.bar_customers||void 0})))||[],{data:L,error:G}=await V.from("attendance_metrics").select("*").eq("employee_id",t.id).eq("date",new Date().toISOString().split("T")[0]).maybeSingle();G&&console.warn("Erro ao carregar mtricas:",G),r({mesas:I,comandas:te,metricas:L||null,loading:!1})}catch(P){o(P,"carregamento inicial")}},[t,r,o]);y.useEffect(()=>{if(!t)return;const P=[],F=V.channel("bar-tables-changes").on("postgres_changes",{event:"*",schema:"public",table:"bar_tables"},pe=>{console.log("Mudana em mesas:",pe),l()}).subscribe();P.push(F);const I=V.channel("comandas-changes").on("postgres_changes",{event:"*",schema:"public",table:"comandas"},pe=>{console.log("Mudana em comandas:",pe),l()}).subscribe();P.push(I);const J=V.channel("comanda-items-changes").on("postgres_changes",{event:"*",schema:"public",table:"comanda_items"},pe=>{console.log("Mudana em itens de comanda:",pe),l()}).subscribe();return P.push(J),()=>{P.forEach(pe=>V.removeChannel(pe))}},[t,l]),y.useEffect(()=>{t&&l()},[t,l]);const c=y.useCallback(async(P,F,I)=>{if(!t)throw new Error("Usurio no autenticado");try{r({loading:!0,error:null});const{data:J,error:pe}=await V.from("comandas").insert({table_id:P||null,customer_name:F||null,people_count:I||1,employee_id:t.id,status:"open",opened_at:new Date().toISOString(),total:0}).select().single();if(pe)throw pe;return P&&await h(P,"occupied"),await l(),J.id}catch(J){throw o(J,"criao de comanda"),J}},[t,r,o,l]),u=y.useCallback(async(P,F)=>{try{r({loading:!0,error:null});const{error:I}=await V.from("comandas").update({...F,updated_at:new Date().toISOString()}).eq("id",P);if(I)throw I;await l()}catch(I){throw o(I,"atualizao de comanda"),I}},[r,o,l]),h=y.useCallback(async(P,F)=>{try{const{error:I}=await V.from("bar_tables").update({status:F,updated_at:new Date().toISOString()}).eq("id",P);if(I)throw I;await l()}catch(I){throw o(I,"atualizao de status da mesa"),I}},[o,l]),f=y.useCallback(async P=>{try{await h(P,"cleaning"),setTimeout(async()=>{await h(P,"available")},5*60*1e3)}catch(F){throw o(F,"liberao de mesa"),F}},[h,o]),p=y.useCallback(async P=>{if(t)try{const F=new Date().toISOString().split("T")[0],{data:I,error:J}=await V.from("attendance_metrics").select("*").eq("employee_id",t.id).eq("date",F).single();if(J&&J.code!=="PGRST116")throw J;if(I){const{error:pe}=await V.from("attendance_metrics").update({total_sales:(I.total_sales||0)+P,orders_count:(I.orders_count||0)+1,comandas_count:(I.comandas_count||0)+1,updated_at:new Date().toISOString()}).eq("id",I.id);if(pe)throw pe}else{const{error:pe}=await V.from("attendance_metrics").insert({employee_id:t.id,date:F,total_sales:P,orders_count:1,comandas_count:1});if(pe)throw pe}}catch(F){console.error("Erro ao atualizar mtricas de venda:",F)}},[t]),g=y.useCallback(async(P,F,I)=>{try{r({loading:!0,error:null});const{data:J,error:pe}=await V.from("comandas").select("table_id, total").eq("id",P).single();if(pe)throw pe;const{error:te}=await V.from("comandas").update({status:"pending_payment",payment_method:F,notes:I,updated_at:new Date().toISOString()}).eq("id",P);if(te)throw te;await l()}catch(J){throw o(J,"envio de comanda para caixa"),J}},[r,o,l]),v=y.useCallback(async(P,F,I,J)=>{try{r({loading:!0,error:null});const{data:pe,error:te}=await V.from("menu_items").select("price").eq("id",F).single();if(te)throw te;const{error:L}=await V.from("comanda_items").insert({comanda_id:P,menu_item_id:F,quantity:I,price:pe.price,notes:J,status:"pending",added_at:new Date().toISOString()});if(L)throw L;const{data:G,error:ee}=await V.from("comanda_items").select("quantity, price").eq("comanda_id",P);if(ee)throw ee;const xe=G.reduce((O,H)=>O+H.quantity*H.price,0);await u(P,{total:xe})}catch(pe){throw o(pe,"adio de item  comanda"),pe}},[r,o,u]),b=y.useCallback(async P=>{try{r({loading:!0,error:null});const{data:F,error:I}=await V.from("comanda_items").select("comanda_id").eq("id",P).single();if(I)throw I;const{error:J}=await V.from("comanda_items").delete().eq("id",P);if(J)throw J;const{data:pe,error:te}=await V.from("comanda_items").select("quantity, price").eq("comanda_id",F.comanda_id);if(te)throw te;const L=pe.reduce((G,ee)=>G+ee.quantity*ee.price,0);await u(F.comanda_id,{total:L})}catch(F){throw o(F,"remoo de item da comanda"),F}},[r,o,u]),_=y.useCallback(async(P,F)=>{try{const I={status:F,updated_at:new Date().toISOString()};F==="ready"?I.prepared_at=new Date().toISOString():F==="delivered"&&(I.delivered_at=new Date().toISOString());const{error:J}=await V.from("comanda_items").update(I).eq("id",P);if(J)throw J;await l()}catch(I){throw o(I,"atualizao de status do item"),I}},[o,l]),w=y.useCallback(async(P,F)=>{try{await h(P,"occupied"),F&&await u(F,{table_id:P})}catch(I){throw o(I,"ocupao de mesa"),I}},[h,u,o]),E=y.useCallback(async(P,F,I)=>{try{const{error:J}=await V.from("bar_tables").update({status:"reserved",notes:`Reservado para ${F} s ${I.toLocaleTimeString()}`,updated_at:new Date().toISOString()}).eq("id",P);if(J)throw J;await l()}catch(J){throw o(J,"reserva de mesa"),J}},[o,l]),T=y.useCallback(async P=>{try{await h(P,"available")}catch(F){throw o(F,"limpeza de mesa"),F}},[h,o]),N=y.useCallback(async P=>{var F;if(!t)throw new Error("Usurio no autenticado");try{r({loading:!0,error:null});const{data:I,error:J}=await V.from("comandas").insert({customer_name:((F=P.customer)==null?void 0:F.name)||"Cliente Balco",employee_id:t.id,status:"closed",opened_at:new Date().toISOString(),closed_at:new Date().toISOString(),total:P.total,payment_method:P.payment_method||"dinheiro",notes:P.notes}).select().single();if(J)throw J;const pe=P.items.map(L=>({comanda_id:I.id,menu_item_id:L.menu_item_id,quantity:L.quantity,price:L.price,notes:L.notes,status:"delivered",added_at:new Date().toISOString(),delivered_at:new Date().toISOString()})),{error:te}=await V.from("comanda_items").insert(pe);if(te)throw te;return await p(P.total),await l(),I.id}catch(I){throw o(I,"processamento de pedido do balco"),I}},[t,r,o,l]),k=y.useCallback(async(P,F)=>{if(!t)throw new Error("Usurio no autenticado");try{r({loading:!0,error:null});const{error:I}=await V.from("bill_splits").insert({comanda_id:P,split_type:F.type,person_count:F.person_count,splits:F.splits,total_amount:F.splits.reduce((J,pe)=>J+pe.total,0),service_charge:F.service_charge_percentage||0,discount_amount:F.discount_amount||0,created_by:t.id});if(I)throw I;await l()}catch(I){throw o(I,"diviso de conta"),I}},[t,r,o,l]),S=y.useCallback(async()=>{if(t)try{const P=new Date().toISOString().split("T")[0],{data:F}=await V.from("attendance_metrics").select("*").eq("employee_id",t.id).eq("date",P).single(),{data:I}=await V.from("comandas").select("total, opened_at, closed_at").eq("employee_id",t.id).gte("opened_at",`${P}T00:00:00`).lt("opened_at",`${P}T23:59:59`),J=(I==null?void 0:I.reduce((L,G)=>L+(G.total||0),0))||0,pe=(I==null?void 0:I.length)||0,te={employee_id:t.id,date:P,comandas_count:pe,total_sales:J,orders_count:pe,updated_at:new Date().toISOString()};if(F){const{error:L}=await V.from("attendance_metrics").update(te).eq("id",F.id);if(L)throw L}else{const{error:L}=await V.from("attendance_metrics").insert(te);if(L)throw L}await l()}catch(P){o(P,"atualizao de mtricas")}},[t,o,l]),C=y.useCallback(async P=>{r({notificacoes:s.notificacoes.map(F=>F.id===P?{...F,read:!0}:F)})},[s.notificacoes,r]),M=y.useCallback(async()=>{r({notificacoes:[]})},[r]),z=y.useCallback(async()=>{await l()},[l]),A=y.useCallback(P=>s.comandas.find(F=>F.table_id===P&&F.status==="open"),[s.comandas]),$=y.useCallback(P=>s.mesas.find(F=>F.number===P),[s.mesas]);return{...s,criarComanda:c,atualizarComanda:u,fecharComanda:g,adicionarItemComanda:v,removerItemComanda:b,atualizarStatusItem:_,ocuparMesa:w,liberarMesa:f,reservarMesa:E,limparMesa:T,atualizarStatusMesa:h,processarPedidoBalcao:N,dividirConta:k,atualizarMetricas:S,marcarNotificacaoLida:C,limparNotificacoes:M,recarregarDados:z,obterComandaPorMesa:A,obterMesaPorNumero:$}},x7=()=>{var rs,Ue;const{comandas:t,loading:s,refetch:a}=Yi(),{tables:r}=Rr(),[o,l]=y.useState(""),[c,u]=y.useState("all"),[h,f]=y.useState(""),[p,g]=y.useState(""),[v,b]=y.useState("all"),[_,w]=y.useState(!1),[E,T]=y.useState(null),[N,k]=y.useState(new Set),[S,C]=y.useState("list"),[M,z]=y.useState([]),[A,$]=y.useState("all"),[P,F]=y.useState(""),[I,J]=y.useState(!1),[pe,te]=y.useState(!1),[L,G]=y.useState(""),[ee,xe]=y.useState(!1),[O,H]=y.useState(null),[B,Y]=y.useState(!1),{menuItems:ne,loading:ie}=V2(!0),{adicionarItemComanda:oe,fecharComanda:me}=Z2(),{refreshBarOrders:D,refreshKitchenOrders:q,inventory:Q}=Tt(),K=(W,re)=>{if(W.item_type==="direct"&&W.direct_inventory_item_id){const Ee=Q.find(Le=>Le.id===W.direct_inventory_item_id);return Ee?Ee.currentStock<re?{available:!1,currentStock:Ee.currentStock,warning:`Estoque insuficiente. Disponvel: ${Ee.currentStock} ${Ee.unit}`}:Ee.currentStock<=Ee.minStock?{available:!0,currentStock:Ee.currentStock,warning:`Estoque baixo! Disponvel: ${Ee.currentStock} ${Ee.unit}`}:{available:!0,currentStock:Ee.currentStock}:{available:!1,warning:"Item no encontrado no estoque"}}return{available:!0}};y.useEffect(()=>{if(E&&t.length>0){const W=t.find(re=>re.id===E.id);W&&(console.log(" Atualizando comanda selecionada com novos dados:",W),T(W))}},[t,E==null?void 0:E.id]);const he=()=>{w(!0)},we=W=>{T(W),C("details")},_e=()=>{C("list"),T(null),z([])},Re=W=>{console.log("Adicionando item ao carrinho:",W);const re=K(W,1);if(!re.available){alert(`${W.name}: ${re.warning}`);return}const Ee=M.findIndex(Le=>Le.menu_item_id===W.id);if(Ee>=0){const Le=M[Ee].quantity+1,rt=K(W,Le);if(!rt.available){alert(`${W.name}: ${rt.warning}`);return}const Lt=[...M];Lt[Ee].quantity=Le,z(Lt),console.log("Item j existia, quantidade atualizada:",Lt)}else{const Le={menu_item_id:W.id,name:W.name,price:typeof W.price=="string"?parseFloat(W.price):W.price,quantity:1,notes:""},rt=[...M,Le];z(rt),console.log("Novo item adicionado ao carrinho:",rt)}},ze=(W,re)=>{if(re<=0)z(M.filter(Ee=>Ee.menu_item_id!==W));else{const Ee=ne.find(Le=>Le.id===W);if(Ee){const Le=K(Ee,re);if(!Le.available){alert(`${Ee.name}: ${Le.warning}`);return}}z(M.map(Le=>Le.menu_item_id===W?{...Le,quantity:re}:Le))}},Ie=()=>M.reduce((W,re)=>W+re.price*re.quantity,0),Me=async()=>{if(console.log(" Boto clicado! Iniciando adio de itens  comanda"),console.log("Comanda selecionada:",E),console.log("Itens no carrinho:",M),!E){console.error(" Nenhuma comanda selecionada");return}if(M.length===0){console.error(" Carrinho vazio");return}J(!0);try{console.log(" Adicionando",M.length,"itens  comanda",E.id);for(const re of M)console.log(" Adicionando item:",re),await oe(E.id,re.menu_item_id,re.quantity,re.notes||""),console.log(" Item adicionado com sucesso");console.log(" Limpando carrinho");const W=M.length;z([]),console.log(" Atualizando dados"),await a(),console.log(" Dados atualizados, comanda selecionada ser atualizada automaticamente"),console.log(" Forando atualizao dos pedidos do bar e cozinha..."),await D(),await q(),console.log(" Pedidos do bar e cozinha atualizados"),G(` ${W} ${W===1?"item adicionado":"itens adicionados"} com sucesso!`),te(!0),setTimeout(()=>{te(!1)},3e3),console.log(" Processo concludo com sucesso!")}catch(W){console.error(" Erro ao adicionar itens  comanda:",W),G(" Erro ao adicionar itens  comanda"),te(!0),setTimeout(()=>{te(!1)},3e3)}finally{J(!1)}},$e=W=>{k(re=>new Set([...re,W]))},Z=y.useMemo(()=>t.filter(W=>{var Ta,Or,Qi,po,Dr,Wc;const re=!o||((Ta=W.customer_name)==null?void 0:Ta.toLowerCase().includes(o.toLowerCase()))||((Qi=(Or=W.table)==null?void 0:Or.number)==null?void 0:Qi.toString().includes(o))||W.id.toLowerCase().includes(o.toLowerCase()),Ee=c==="all"||W.status===c,Le=!h||((po=W.employee_name)==null?void 0:po.toLowerCase().includes(h.toLowerCase())),rt=!p||((Wc=(Dr=W.table)==null?void 0:Dr.number)==null?void 0:Wc.toString().includes(p)),Lt=(()=>{if(v==="all")return!0;const Yc=new Date(W.opened_at),bn=(new Date().getTime()-Yc.getTime())/(1e3*60*60);switch(v){case"recent":if(bn>=1)return!1;break;case"overdue":if(bn<=2)return!1;break;case"critical":if(bn<=4)return!1;break}return!0})();return re&&Ee&&Le&&rt&&Lt}),[t,o,c,h,p,v]),se=Z.filter(W=>W.status==="open"),de=Z.filter(W=>W.status==="pending_payment"),Ce=Z.filter(W=>{if(W.status!=="open")return!1;const re=new Date(W.opened_at);return(new Date().getTime()-re.getTime())/(1e3*60*60)>2}),ke=Ce.filter(W=>!N.has(W.id)),ye=W=>new Date(W).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}),Te=W=>{switch(W){case"open":return"Aberta";case"pending_payment":return"Aguardando Pagamento";case"closed":return"Fechada";default:return W}},Oe=[...new Set(ne.map(W=>W.category))],Ge=ne.filter(W=>{const re=A==="all"||W.category===A,Ee=W.name.toLowerCase().includes(P.toLowerCase());return re&&Ee&&W.available});if(console.log("Estado atual do carrinho:",M),console.log("Carrinho tem itens?",M.length>0),console.log(" Debug boto Fechar Conta:",{selectedComanda:!!E,status:E==null?void 0:E.status,shouldShow:(E==null?void 0:E.status)==="open"}),S==="details"&&E)return e.jsxs("div",{className:"comanda-details-container h-full flex flex-col bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b bg-white flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:_e,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(fo,{size:20}),e.jsx("span",{children:"Voltar para Comandas"})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:[(rs=E.table)!=null&&rs.number?`Mesa ${E.table.number}`:"Balco"," - ",E.customer_name||"Cliente"]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Aberta em ",ye(E.opened_at)]}),e.jsx("div",{className:"bg-green-100 px-4 py-2 rounded-lg border border-green-200",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Total da Comanda:"}),e.jsxs("span",{className:"text-xl font-bold text-green-900",children:["R$ ",((Ue=E.total)==null?void 0:Ue.toFixed(2))||"0,00"]})]})})]})]})]}),e.jsx("div",{className:"flex flex-col space-y-2",children:e.jsxs("button",{onClick:async()=>{var W;if(E)try{const{data:re,error:Ee}=await V.from("comandas").select(`
                      *,
                      bar_tables(number, capacity),
                      comanda_items(
                        *,
                        menu_items(name, price, category)
                      )
                    `).eq("id",E.id).single();if(Ee)throw Ee;const Le={...re,items:((W=re.comanda_items)==null?void 0:W.map(rt=>{var Lt;return{...rt,menu_item:rt.menu_items,product_name:((Lt=rt.menu_items)==null?void 0:Lt.name)||"Item",total_price:rt.price*rt.quantity}}))||[],table:re.bar_tables};H(Le),xe(!0)}catch(re){console.error("Erro ao carregar comanda:",re)}},className:"bg-red-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-red-700 transition-colors flex items-center space-x-2",children:[e.jsx(Wi,{size:20}),e.jsx("span",{children:"Fechar Conta"})]})})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden min-h-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col p-6",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsx("div",{className:"flex-1 relative",children:e.jsx("input",{type:"text",placeholder:"Buscar itens...",value:P,onChange:W=>F(W.target.value),className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),e.jsxs("select",{value:A,onChange:W=>$(W.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todas as Categorias"}),Oe.map(W=>e.jsx("option",{value:W,children:W},W))]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:ie?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):Ge.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 mb-2",children:"Nenhum item encontrado"})}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Ge.map(W=>{const re=K(W,1),Ee=re.warning&&re.available,Le=!re.available;return e.jsxs("div",{onClick:()=>!Le&&Re(W),className:`bg-white border rounded-lg hover:shadow-md transition-all duration-200 group ${Le?"cursor-not-allowed opacity-50 border-red-300":Ee?"cursor-pointer hover:border-yellow-400 hover:bg-yellow-50 border-yellow-300":"cursor-pointer hover:border-blue-300 hover:bg-blue-50 border-gray-200"}`,children:[e.jsx("div",{className:"p-2 pb-0 min-h-[32px] flex justify-end",children:e.jsxs("div",{className:"flex flex-col space-y-1 items-end",children:[Le&&e.jsx("div",{className:"bg-red-500 text-white text-xs px-2 py-1 rounded-full flex items-center space-x-1 shadow-md",children:e.jsx("span",{children:"Esgotado"})}),Ee&&e.jsx("div",{className:"bg-yellow-500 text-white text-xs px-2 py-1 rounded-full flex items-center space-x-1 shadow-md",children:e.jsx("span",{children:"Baixo"})})]})}),e.jsxs("div",{className:"px-4 pb-4",children:[e.jsxs("div",{className:"aspect-square bg-gray-100 rounded-lg mb-3 flex items-center justify-center group-hover:bg-blue-100 transition-colors",children:[W.image_url?e.jsx("img",{src:W.image_url,alt:W.name,className:"max-w-full max-h-full object-contain rounded-lg",onError:rt=>{rt.currentTarget.style.display="none",rt.currentTarget.nextElementSibling.style.display="block"}}):null,e.jsx("div",{className:"text-gray-400 text-2xl group-hover:text-blue-500 transition-colors",style:{display:W.image_url?"none":"block"},children:""})]}),e.jsx("h3",{className:"font-medium text-gray-900 mb-1 line-clamp-2 group-hover:text-blue-900",children:W.name}),e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2 group-hover:text-blue-700",children:W.description}),W.item_type==="direct"&&re.currentStock!==void 0&&e.jsxs("p",{className:`text-xs mb-2 ${Le?"text-red-600":Ee?"text-yellow-600":"text-gray-500"}`,children:["Estoque: ",re.currentStock]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:`text-lg font-bold ${Le?"text-gray-400":"text-green-600 group-hover:text-green-700"}`,children:["R$ ",(typeof W.price=="string"?parseFloat(W.price):W.price).toFixed(2)]}),!Le&&e.jsx("div",{className:"bg-blue-600 text-white p-2 rounded-lg group-hover:bg-blue-700 transition-colors",children:e.jsx(Zs,{size:16})})]})]})]},W.id)})})})]}),e.jsxs("div",{className:"w-96 bg-gray-50 border-l border-gray-200 flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 flex-shrink-0",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Pedidos da Comanda"})})}),(E==null?void 0:E.items)&&E.items.length>0&&e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("div",{className:"p-4 bg-blue-50",children:[e.jsxs("h4",{className:"text-sm font-medium text-blue-900 mb-3",children:["Itens j pedidos (",E.items.length,")",e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(Debug: ",new Date().toLocaleTimeString(),")"]})]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:E.items.map(W=>{var re,Ee;return console.log(" Debug item da comanda:",W),e.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-gray-900 text-sm",children:((re=W.menu_item)==null?void 0:re.name)||((Ee=W.menu_items)==null?void 0:Ee.name)||`Item ${W.menu_item_id}`}),e.jsxs("p",{className:"text-xs text-gray-600",children:["R$ ",W.price.toFixed(2)," cada"]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${W.status==="pending"?"bg-yellow-100 text-yellow-800":W.status==="preparing"?"bg-blue-100 text-blue-800":W.status==="ready"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:W.status==="pending"?"Pendente":W.status==="preparing"?"Preparando":W.status==="ready"?"Pronto":W.status==="delivered"?"Entregue":W.status})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Qtd: ",W.quantity]}),e.jsxs("span",{className:"font-medium text-green-600 text-sm",children:["R$ ",(W.price*W.quantity).toFixed(2)]})]}),W.notes&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Obs: ",W.notes]})]},W.id)})})]})}),e.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-900",children:["Novos Itens (",M.length,")"]}),M.length>0&&e.jsx("button",{onClick:()=>z([]),className:"text-xs text-red-600 hover:text-red-800",children:"Limpar"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 min-h-0",children:M.length===0?e.jsxs("div",{className:"text-center text-gray-500 py-4 h-full flex flex-col items-center justify-center",children:[e.jsx(pn,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"Nenhum item novo selecionado"})]}):e.jsxs("div",{className:"space-y-4",children:[M.map(W=>e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:W.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["R$ ",W.price.toFixed(2)," cada"]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>ze(W.menu_item_id,W.quantity-1),className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center hover:bg-gray-300 transition-colors",children:e.jsx($i,{size:14})}),e.jsx("span",{className:"w-8 text-center font-medium",children:W.quantity}),e.jsx("button",{onClick:()=>ze(W.menu_item_id,W.quantity+1),className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center hover:bg-gray-300 transition-colors",children:e.jsx(Zs,{size:14})})]}),e.jsxs("span",{className:"font-bold text-green-600",children:["R$ ",(W.price*W.quantity).toFixed(2)]})]})]},W.menu_item_id)),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-green-100 p-4 rounded-lg border border-green-200 mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-semibold text-green-800",children:"Total dos Novos Itens:"}),e.jsxs("span",{className:"text-3xl font-bold text-green-900",children:["R$ ",Ie().toFixed(2)]})]})}),e.jsx("button",{onClick:Me,disabled:I,className:`w-full py-3 rounded-lg font-medium transition-colors flex items-center justify-center space-x-2 ${I?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"}`,children:I?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Adicionando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(Zs,{size:20}),e.jsx("span",{children:"Adicionar  Comanda"})]})}),pe&&e.jsx("div",{className:`mt-3 p-3 rounded-lg text-sm font-medium text-center transition-all duration-300 ${L.includes("")?"bg-red-100 text-red-800 border border-red-200":"bg-green-100 text-green-800 border border-green-200"}`,children:L})]})]})})]})]}),(console.log(" Debug Modal:",{showCloseModal:ee,closeModalComanda:!!O,isClosingComanda:B}),O&&e.jsx(G2,{isOpen:ee,comanda:O,onClose:()=>{xe(!1),H(null)},onConfirm:async(W,re)=>{try{Y(!0),await me(O.id,W,re),xe(!1),H(null),a()}catch(Ee){console.error("Erro ao fechar comanda:",Ee),alert("Erro ao fechar comanda. Tente novamente.")}finally{Y(!1)}},loading:B}))]});return e.jsxs("div",{className:"comandas-container",children:[e.jsx(f7,{comandas:ke,onComandaClick:we,onDismissAlert:$e}),e.jsx(p7,{searchTerm:o,onSearchChange:l,statusFilter:c,onStatusFilterChange:u,employeeFilter:h,onEmployeeFilterChange:f,tableFilter:p,onTableFilterChange:g,timeFilter:v,onTimeFilterChange:b,employees:[],tables:r||[],onClearFilters:()=>{l(""),u("all"),f(""),g(""),b("all")}}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:se.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Abertas"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:de.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Aguardando Pagamento"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:Ce.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Com Atraso"})]})]}),e.jsx("button",{onClick:he,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"+ Nova Comanda"})]}),e.jsx("div",{className:"bg-white rounded-lg border",children:s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mesa/Cliente"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Funcionrio"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Abertura"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:Z.map(W=>{var Le,rt;const re=Je(W.opened_at),Ee=new Date().getTime()-new Date(W.opened_at).getTime()>2*60*60*1e3;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[((Le=W.table)==null?void 0:Le.number)||"Balco",W.customer_name&&e.jsx("div",{className:"text-xs text-gray-500",children:W.customer_name})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${W.status==="open"?"bg-green-100 text-green-800":W.status==="pending_payment"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:Te(W.status)}),Ee&&W.status==="open"&&e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:" Atrasada"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:W.employee_name||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{children:[ye(W.opened_at),e.jsxs("div",{className:`text-xs ${Ee?"text-red-600 font-medium":"text-gray-400"}`,children:[re," decorrido"]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:["R$ ",((rt=W.total)==null?void 0:rt.toFixed(2))||"0,00"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("button",{onClick:()=>we(W),className:"inline-flex items-center px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 transition-colors",children:[e.jsx(Ws,{className:"w-3 h-3 mr-1"}),"Ver Detalhes"]})})]},W.id)})})]})})}),e.jsx(h7,{isOpen:_,onClose:()=>w(!1),onComandaCreated:()=>{a()}}),console.log(" Debug modal:",{showCloseModal:ee,selectedComanda:!!E,viewMode:S}),pe&&S==="list"&&e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsx("div",{className:`p-4 rounded-lg shadow-lg ${L.includes("")?"bg-red-100 text-red-800 border border-red-200":"bg-green-100 text-green-800 border border-green-200"}`,children:L})})]});function Je(W){const re=new Date(W),Le=new Date().getTime()-re.getTime(),rt=Math.floor(Le/(1e3*60*60)),Lt=Math.floor(Le%(1e3*60*60)/(1e3*60));return rt>0?`${rt}h ${Lt}min`:`${Lt}min`}},y7=()=>{const{user:t}=Et(),[s,a]=y.useState([]),[r,o]=y.useState({orderQueue:[],alerts:[],loading:!0,error:null}),l=y.useCallback(te=>{o(L=>({...L,...te}))},[]),c=y.useCallback((te,L)=>{console.error(`Erro em ${L}:`,te),l({error:`Erro em ${L}: ${te.message||"Erro desconhecido"}`,loading:!1})},[l]),u=y.useCallback(async()=>{if(t)try{l({loading:!0,error:null});const{data:te,error:L}=await V.rpc("get_order_queue_items");if(L)throw L;const G=(te||[]).map(xe=>{const O=b([xe]);return{...xe,priority:{level:O.priorityLevel,complexity:_(O.finalEstimate),estimatedTime:O.finalEstimate,isManuallyPrioritized:xe.is_priority||!1,createdAt:new Date(xe.added_at),timerStatus:h(new Date(xe.added_at),O.finalEstimate),alertsEnabled:!0}}}),ee=S(G);l({orderQueue:ee,loading:!1})}catch(te){c(te,"carregamento da fila de pedidos")}},[t,l,c]),h=(te,L)=>{const ee=(new Date().getTime()-te.getTime())/(1e3*60),xe=L*.8,O=L*1.2;return ee>=O?"overdue":ee>=xe?"warning":"normal"},f={bebidas:{baseTime:2,complexity:"simple"},drinks:{baseTime:3,complexity:"simple"},petiscos:{baseTime:8,complexity:"medium"},pratos:{baseTime:15,complexity:"complex"},sobremesas:{baseTime:5,complexity:"simple"},cafes:{baseTime:3,complexity:"simple"}},p={simple:1,medium:1.3,complex:1.8},g=y.useCallback(te=>{let L=0,G="simple",ee=0;te.forEach(B=>{var Y,ne;if(B.menu_items){const ie=B.menu_items.category.toLowerCase(),oe=B.menu_items.preparation_time||0,me=oe>0?oe:((Y=f[ie])==null?void 0:Y.baseTime)||8;L+=me*B.quantity;const D=((ne=f[ie])==null?void 0:ne.complexity)||"medium";v(D)>v(G)&&(G=D),ie==="pratos"&&(ee+=2),ie==="petiscos"&&(ee+=1)}});const xe=p[G],O=Math.ceil((L+ee)*xe);let H="low";return O>=20?H="high":O>=12?H="medium":H="low",{baseTime:L,complexityMultiplier:xe,categoryBonus:ee,finalEstimate:O,priorityLevel:H}},[]),v=te=>{switch(te){case"simple":return 1;case"medium":return 2;case"complex":return 3;default:return 1}},b=y.useCallback((te,L=!1,G)=>{const ee=g(te);return{level:L&&G?G:ee.priorityLevel,complexity:_(ee.finalEstimate),estimatedTime:ee.finalEstimate,isManuallyPrioritized:L,createdAt:new Date,timerStatus:"normal",alertsEnabled:!0}},[g]),_=te=>te>=15?"complex":te>=8?"medium":"simple",w=y.useCallback((te,L)=>{const G={id:te,startTime:new Date,estimatedTime:L,status:"normal",alertsSent:[]};a(ee=>[...ee.filter(xe=>xe.id!==te),G])},[]),E=y.useCallback(te=>{a(L=>L.filter(G=>G.id!==te))},[]),T=y.useCallback((te,L,G)=>{a(xe=>xe.map(O=>O.id===te?{...O,status:L==="urgent"?"warning":O.status}:O));const ee={id:`priority-${te}-${Date.now()}`,orderId:te,type:"warning",message:`Pedido marcado como ${N(L)}${G?`: ${G}`:""}`,timestamp:new Date,acknowledged:!1};setAlerts(xe=>[ee,...xe])},[]),N=te=>{switch(te){case"low":return"Baixa Prioridade";case"medium":return"Prioridade Mdia";case"high":return"Alta Prioridade";case"urgent":return"Urgente";default:return te}},k=te=>{switch(te){case"low":return"bg-green-100 text-green-800 border-green-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"urgent":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},S=y.useCallback(te=>{const L={urgent:4,high:3,medium:2,low:1};return te.sort((G,ee)=>{var ie,oe,me,D,q,Q,K,he;if((ie=G.priority)!=null&&ie.isManuallyPrioritized&&!((oe=ee.priority)!=null&&oe.isManuallyPrioritized))return-1;if(!((me=G.priority)!=null&&me.isManuallyPrioritized)&&((D=ee.priority)!=null&&D.isManuallyPrioritized))return 1;const xe=((q=G.priority)==null?void 0:q.level)||"low",O=((Q=ee.priority)==null?void 0:Q.level)||"low",H=L[xe],B=L[O];if(H!==B)return B-H;const Y=new Date(((K=G.priority)==null?void 0:K.createdAt)||G.added_at||0).getTime(),ne=new Date(((he=ee.priority)==null?void 0:he.createdAt)||ee.added_at||0).getTime();return Y-ne})},[]),C=y.useCallback(async(te,L)=>{try{const{error:G}=await V.from("comanda_items").update({is_priority:L,updated_at:new Date().toISOString()}).eq("id",te);if(G)throw G;l({orderQueue:r.orderQueue.map(ee=>ee.id===te&&ee.priority?{...ee,priority:{...ee.priority,isManuallyPrioritized:L,level:L?"urgent":ee.priority.level}}:ee)}),await u()}catch(G){throw c(G,"marcao de prioridade"),G}},[r.orderQueue,l,c,u]),M=y.useCallback(async(te,L)=>{try{const G={status:L,updated_at:new Date().toISOString()};L==="preparing"?G.started_at=new Date().toISOString():L==="ready"?G.prepared_at=new Date().toISOString():L==="delivered"&&(G.delivered_at=new Date().toISOString());const{error:ee}=await V.from("comanda_items").update(G).eq("id",te);if(ee)throw ee;await u()}catch(G){throw c(G,"atualizao de status"),G}},[c,u]);y.useCallback((te,L,G)=>{const ee={id:`alert-${te}-${Date.now()}`,orderId:te,type:L,message:G,timestamp:new Date,acknowledged:!1};l({alerts:[ee,...r.alerts]})},[r.alerts,l]);const z=y.useCallback(te=>{l({alerts:r.alerts.map(L=>L.id===te?{...L,acknowledged:!0}:L)})},[r.alerts,l]),A=y.useCallback(()=>{l({alerts:[]})},[l]),$=y.useCallback(te=>{if(te.priority)return te.priority;const L=b([te]);return{level:L.priorityLevel,complexity:_(L.finalEstimate),estimatedTime:L.finalEstimate,isManuallyPrioritized:!1,createdAt:new Date(te.added_at),timerStatus:h(new Date(te.added_at),L.finalEstimate),alertsEnabled:!0}},[]),P=y.useCallback(te=>{const L=$(te);return h(L.createdAt,L.estimatedTime)},[$]),F=y.useCallback(te=>{const L=$(te),G=(new Date().getTime()-L.createdAt.getTime())/(1e3*60);return Math.max(0,L.estimatedTime-G)},[$]),I=y.useCallback(te=>{const L=F(te);if(L<1)return"< 1min";if(L<60)return`${Math.ceil(L)}min`;const G=Math.floor(L/60),ee=Math.ceil(L%60);return ee===0?`${G}h`:`${G}h ${ee}min`},[F]),J=y.useCallback(()=>{const te={urgent:0,high:0,medium:0,low:0,overdue:0,warning:0};return r.orderQueue.forEach(L=>{const G=$(L);te[G.level]++,G.timerStatus==="overdue"?te.overdue++:G.timerStatus==="warning"&&te.warning++}),te},[r.orderQueue,$]),pe=y.useCallback(async()=>{await u()},[u]);return y.useEffect(()=>{if(!t)return;const te=V.channel("order-priority-changes").on("postgres_changes",{event:"*",schema:"public",table:"comanda_items"},L=>{console.log("Mudana em itens de comanda:",L),u()}).subscribe();return()=>{V.removeChannel(te)}},[t,u]),y.useEffect(()=>{t&&u()},[t,u]),y.useEffect(()=>{const te=setInterval(()=>{if(r.orderQueue.length>0){const L=r.orderQueue.map(G=>{if(G.priority){const ee=h(G.priority.createdAt,G.priority.estimatedTime);return{...G,priority:{...G.priority,timerStatus:ee}}}return G});l({orderQueue:L})}},6e4);return()=>clearInterval(te)},[r.orderQueue,l]),{...r,markItemAsPriority:C,updateItemStatus:M,dismissAlert:z,clearAllAlerts:A,getItemPriority:$,getTimerStatus:P,getRemainingTime:F,formatRemainingTime:I,getPriorityStats:J,refreshQueue:pe,getPriorityLabel:N,getPriorityColor:k,sortOrdersByPriority:S,calculateOrderPriority:b,calculateAutoPriority:g,startOrderTimer:w,stopOrderTimer:E,markOrderAsPriority:T,orderTimers:s,allAlerts:r.alerts}},b7=({onUpdateItemStatus:t})=>{const{orderQueue:s,loading:a,markItemAsPriority:r,updateItemStatus:o,getItemPriority:l,getTimerStatus:c,formatRemainingTime:u,alerts:h,getPriorityLabel:f,getPriorityColor:p}=y7(),[g,v]=y.useState(!0),[b,_]=y.useState(null),w=s,T=(()=>{const $=new Map;return w.forEach(P=>{var I,J;const F=((J=(I=P.comandas)==null?void 0:I.bar_tables)==null?void 0:J.number)||"Balco";$.has(F)||$.set(F,[]),$.get(F).push(P)}),$})(),N=$=>(T.get($)||[]).length>1,k=$=>$.id.slice(-4).toUpperCase(),S=async($,P)=>{try{t?await t($,P):await o($,P)}catch(F){console.error("Erro ao atualizar status:",F)}},C=async($,P)=>{try{await r($,P),_(null)}catch(F){console.error("Erro ao marcar prioridade:",F)}},M=$=>{switch($){case"pending":return e.jsx(Vt,{className:"h-4 w-4"});case"preparing":return e.jsx(_j,{className:"h-4 w-4"});case"ready":return e.jsx(ts,{className:"h-4 w-4"});default:return e.jsx(Vt,{className:"h-4 w-4"})}},z=$=>{switch($){case"pending":return"text-yellow-600 bg-yellow-100";case"preparing":return"text-blue-600 bg-blue-100";case"ready":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},A=$=>{switch($){case"pending":return"Pendente";case"preparing":return"Preparando";case"ready":return"Pronto";default:return $}};return a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(Wa,{children:g&&h.length>0&&e.jsxs(be.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(cR,{className:"h-5 w-5 text-red-600"}),e.jsxs("h3",{className:"text-lg font-semibold text-red-800",children:["Alertas (",h.length,")"]})]}),e.jsx("button",{onClick:()=>v(!1),className:"text-red-600 hover:text-red-800",title:"Fechar alertas","aria-label":"Fechar alertas",children:e.jsx(lt,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"space-y-2",children:h.slice(0,3).map($=>e.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded border",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-red-800",children:$.message}),e.jsx("p",{className:"text-xs text-red-600",children:St($.timestamp,"HH:mm",{locale:ss})})]}),e.jsx("button",{onClick:()=>acknowledgeAlert($.id),className:"text-red-600 hover:text-red-800 ml-2",title:"Reconhecer alerta","aria-label":"Reconhecer alerta",children:e.jsx(ts,{className:"h-4 w-4"})})]},$.id))})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Fila de Pedidos"}),e.jsxs("p",{className:"text-gray-600",children:[w.length," itens na fila, ordenados por prioridade"]}),Array.from(T.entries()).filter(([$,P])=>P.length>1).length>0&&e.jsxs("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium mt-1 inline-block",children:[Array.from(T.entries()).filter(([$,P])=>P.length>1).length," mesa(s) com mltiplos pedidos"]})]}),h.length>0&&!g&&e.jsxs("button",{onClick:()=>v(!0),className:"flex items-center space-x-2 bg-red-100 text-red-800 px-3 py-2 rounded-lg hover:bg-red-200 transition-colors",title:"Mostrar alertas","aria-label":"Mostrar alertas",children:[e.jsx(yg,{className:"h-4 w-4"}),e.jsxs("span",{children:[h.length," alertas"]})]})]}),Array.from(T.entries()).filter(([$,P])=>P.length>1).length>0&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-orange-800 mb-2",children:" Mesas com Mltiplos Pedidos:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from(T.entries()).filter(([$,P])=>P.length>1).map(([$,P])=>e.jsxs("span",{className:"bg-orange-200 text-orange-800 px-3 py-1 rounded-full text-sm font-medium",children:["Mesa ",$,": ",P.length," itens"]},$))})]}),e.jsx("div",{className:"space-y-4",children:w.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Vt,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhum pedido na fila"})]}):w.map(($,P)=>{var J,pe,te,L,G,ee;const F=c($),I=l($);return e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:P*.1},className:`bg-white rounded-lg shadow-md p-6 border-l-4 ${I!=null&&I.isManuallyPrioritized?"border-red-500":(I==null?void 0:I.level)==="high"?"border-orange-500":(I==null?void 0:I.level)==="medium"?"border-yellow-500":"border-green-500"} ${N(((pe=(J=$.comandas)==null?void 0:J.bar_tables)==null?void 0:pe.number)||"Balco")?"ring-2 ring-orange-300 ring-offset-2":""}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded text-sm font-medium",children:["#",P+1]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:((te=$.menu_items)==null?void 0:te.name)||"Item sem nome"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["x",$.quantity]}),e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:["#",k($)]})]}),(I==null?void 0:I.isManuallyPrioritized)&&e.jsx(f0,{className:"h-5 w-5 text-red-500"})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mb-3",children:[((G=(L=$.comandas)==null?void 0:L.bar_tables)==null?void 0:G.number)&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{children:["Mesa ",$.comandas.bar_tables.number]}),e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:["#",k($)]}),N($.comandas.bar_tables.number)&&e.jsxs("span",{className:"bg-orange-500 text-white px-2 py-1 rounded-full text-xs font-bold",children:[(T.get($.comandas.bar_tables.number)||[]).length," itens"]})]}),((ee=$.comandas)==null?void 0:ee.customer_name)&&e.jsxs("span",{children:["Cliente: ",$.comandas.customer_name]}),e.jsxs("span",{children:["Pedido s ",St(new Date($.added_at||""),"HH:mm",{locale:ss})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium border ${p((I==null?void 0:I.level)||"low")}`,children:f((I==null?void 0:I.level)||"low")}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Tempo estimado: ",(I==null?void 0:I.estimatedTime)||0,"min"]}),e.jsxs("div",{className:`flex items-center space-x-1 px-2 py-1 rounded text-sm ${F==="overdue"?"bg-red-100 text-red-800":F==="warning"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:[e.jsx(_j,{className:"h-3 w-3"}),e.jsx("span",{children:u($)}),F==="overdue"&&e.jsx(mt,{className:"h-3 w-3"})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{className:`flex items-center space-x-1 px-3 py-1 rounded-full text-sm font-medium ${z($.status||"pending")}`,children:[M($.status||"pending"),e.jsx("span",{children:A($.status||"pending")})]})})]}),e.jsxs("div",{className:"flex flex-col space-y-2 ml-4",children:[e.jsxs("button",{onClick:()=>_($.id),className:"flex items-center space-x-1 px-3 py-1 bg-orange-100 text-orange-800 rounded hover:bg-orange-200 transition-colors",title:"Marcar como prioritrio","aria-label":"Marcar como prioritrio",children:[e.jsx(sR,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:"Priorizar"})]}),$.status==="pending"&&e.jsx("button",{onClick:()=>S($.id,"preparing"),className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors",children:"Iniciar"}),$.status==="preparing"&&e.jsx("button",{onClick:()=>S($.id,"ready"),className:"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 transition-colors",children:"Pronto"})]})]})},$.id)})}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-96",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Definir Prioridade"}),e.jsx("div",{className:"space-y-3",children:["urgent","high","medium","low"].map($=>e.jsxs("button",{onClick:()=>C(b||"",!0),className:`w-full p-3 rounded border-2 text-left transition-colors ${p($)} hover:opacity-80`,children:[e.jsx("div",{className:"font-medium",children:f($)}),e.jsxs("div",{className:"text-sm opacity-75",children:[$==="urgent"&&"Para pedidos que precisam ser feitos imediatamente",$==="high"&&"Para pedidos importantes com prazo apertado",$==="medium"&&"Para pedidos com prioridade normal",$==="low"&&"Para pedidos que podem aguardar"]})]},$))}),e.jsx("div",{className:"mt-4 flex space-x-3",children:e.jsx("button",{onClick:()=>_(null),className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded hover:bg-gray-400 transition-colors",children:"Cancelar"})})]})})]})},v7=({orders:t,menuItems:s})=>{const{updateOrderStatus:a}=Tt(),[r,o]=y.useState(new Set),c=(()=>{const w=new Map;return t.forEach(E=>{const T=E.tableNumber||"Balco";w.has(T)||w.set(T,[]),w.get(T).push(E)}),w})(),u=w=>w.items.reduce((E,T)=>{const N=s.find(S=>S.id===T.menuItemId)||T.menuItem,k=(N==null?void 0:N.preparation_time)||(N==null?void 0:N.preparationTime)||0;return E+k},0),h=w=>{const E=(new Date().getTime()-w.createdAt.getTime())/6e4;return E>20?"high":E>10?"medium":"low"},f=w=>{switch(w){case"high":return"border-red-400 bg-red-50";case"medium":return"border-yellow-400 bg-yellow-50";case"low":return"border-green-400 bg-green-50";default:return"border-gray-200 bg-white"}},p=w=>w.id.slice(-4).toUpperCase(),g=w=>w.id.startsWith("balcao-"),v=w=>w.id.startsWith("comanda-"),b=async(w,E)=>{o(T=>new Set([...T,w]));try{await a(w,E),console.log(` Status do pedido ${w} atualizado para ${E}`)}catch(T){console.error("Erro ao atualizar status:",T)}finally{setTimeout(()=>{o(T=>{const N=new Set(T);return N.delete(w),N})},1e3)}},_=w=>(c.get(w)||[]).length>1;return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Pedidos do Bar"}),e.jsx("div",{className:"text-sm text-gray-600",children:Array.from(c.entries()).filter(([w,E])=>E.length>1).length>0&&e.jsxs("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium",children:[Array.from(c.entries()).filter(([w,E])=>E.length>1).length," mesa(s) com mltiplos pedidos"]})})]}),Array.from(c.entries()).filter(([w,E])=>E.length>1).length>0&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-orange-800 mb-2",children:" Mesas com Mltiplos Pedidos:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from(c.entries()).filter(([w,E])=>E.length>1).map(([w,E])=>e.jsxs("span",{className:"bg-orange-200 text-orange-800 px-3 py-1 rounded-full text-sm font-medium",children:["Mesa ",w,": ",E.length," pedidos"]},w))})]}),t.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhum pedido pendente no bar"})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:t.map(w=>{const E=h(w),T=u(w),N=w.items,k=_(w.tableNumber||"Balco");return e.jsxs(be.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:`border-2 rounded-lg p-4 ${f(E)} ${k?"ring-2 ring-orange-300 ring-offset-2":""} ${g(w)?"border-green-400 bg-green-50 shadow-lg":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(qc,{size:16,className:"text-gray-500"}),e.jsx("span",{className:"font-bold text-lg",children:Og(w.tableNumber)}),e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:["#",p(w)]}),g(w)&&e.jsx("span",{className:"bg-green-600 text-white px-2 py-1 rounded-full text-xs font-bold animate-pulse",children:" PAGO"}),v(w)&&e.jsx("span",{className:"bg-yellow-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:"AGUARDA PAGTO"}),_(w.tableNumber||"Balco")&&e.jsxs("span",{className:"bg-orange-500 text-white px-2 py-1 rounded-full text-xs font-bold",children:[(c.get(w.tableNumber||"Balco")||[]).length," pedidos"]})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(Vt,{size:14}),e.jsx("span",{children:St(w.createdAt,"HH:mm",{locale:ss})})]})]}),e.jsx("div",{className:"space-y-2 mb-4",children:N.map(S=>{const C=s.find(M=>M.id===S.menuItemId)||S.menuItem;return e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-medium",children:[S.quantity,"x ",(C==null?void 0:C.name)||"Item no encontrado"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[(C==null?void 0:C.preparation_time)||(C==null?void 0:C.preparationTime)||0,"min"]})]},S.id)})}),w.notes&&e.jsx("div",{className:"mb-4 p-2 bg-yellow-100 rounded border",children:e.jsx("p",{className:"text-sm text-yellow-800",children:w.notes})}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Tempo estimado: ",T,"min"]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${E==="high"?"bg-red-200 text-red-800":E==="medium"?"bg-yellow-200 text-yellow-800":"bg-green-200 text-green-800"}`,children:E==="high"?"Urgente":E==="medium"?"Mdio":"Normal"})]}),e.jsxs("div",{className:"space-y-2",children:[w.status==="pending"&&e.jsx("button",{onClick:()=>b(w.id,"preparing"),disabled:r.has(w.id),className:`w-full py-2 rounded-lg font-medium transition-all duration-300 ${r.has(w.id)?"bg-blue-300 text-blue-700 cursor-not-allowed animate-pulse scale-95":"bg-blue-600 text-white hover:bg-blue-700 hover:shadow-lg transform hover:scale-105 active:scale-95"}`,children:r.has(w.id)?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-700 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Iniciando..."})]}):"Iniciar Preparo"}),w.status==="preparing"&&e.jsx("button",{onClick:()=>b(w.id,"ready"),disabled:r.has(w.id),className:`w-full py-2 rounded-lg font-medium transition-all duration-300 ${r.has(w.id)?"bg-green-300 text-green-700 cursor-not-allowed animate-pulse scale-95":"bg-green-600 text-white hover:bg-green-700 hover:shadow-lg transform hover:scale-105 active:scale-95"}`,children:r.has(w.id)?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-green-700 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Finalizando..."})]}):"Marcar como Pronto"}),w.status==="ready"&&e.jsx("div",{className:"w-full py-2 rounded-lg font-medium bg-green-100 text-green-800 border-2 border-green-300 text-center animate-pulse",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-5 h-5 bg-green-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:""})}),e.jsx("span",{children:"Pronto para Entrega"})]})})]})]},w.id)})})]})},w7=()=>null,j7=()=>{const{user:t}=Et(),{updateItemStatus:s}=Yi(),{barOrders:a,menuItems:r}=Tt(),[o,l]=y.useState("balcao"),[c,u]=y.useState(!1),h=g=>{l(g)},f=async(g,v)=>{try{await s(g,v)}catch(b){throw console.error("Erro ao atualizar status do item:",b),b}},p=()=>{switch(o){case"balcao":return c?e.jsx(e7,{}):e.jsx(Qj,{});case"mesas":return e.jsx(m7,{});case"comandas":return e.jsx(x7,{});case"fila":return e.jsx(b7,{onUpdateItemStatus:f});case"pedidos":return e.jsx(v7,{orders:a,menuItems:r});default:return e.jsx(Qj,{})}};return e.jsxs("div",{className:"bar-attendance-container min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(i$,{mode:o,onModeChange:h,user:t}),o==="balcao"&&e.jsx("div",{className:"bg-white border-b border-gray-200 px-4 py-2",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("button",{onClick:()=>u(!1),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-blue-600 text-white"}`,children:" Criar Pedido"}),e.jsx("button",{onClick:()=>u(!0),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:" Gerenciar Pedidos"})]})}),e.jsx("main",{className:"bar-content flex-1 p-4 md:p-6 overflow-auto",children:p()}),e.jsx(w7,{})]})};function Ne(t,s,a){function r(u,h){var f;Object.defineProperty(u,"_zod",{value:u._zod??{},enumerable:!1}),(f=u._zod).traits??(f.traits=new Set),u._zod.traits.add(t),s(u,h);for(const p in c.prototype)p in u||Object.defineProperty(u,p,{value:c.prototype[p].bind(u)});u._zod.constr=c,u._zod.def=h}const o=(a==null?void 0:a.Parent)??Object;class l extends o{}Object.defineProperty(l,"name",{value:t});function c(u){var h;const f=a!=null&&a.Parent?new l:this;r(f,u),(h=f._zod).deferred??(h.deferred=[]);for(const p of f._zod.deferred)p();return f}return Object.defineProperty(c,"init",{value:r}),Object.defineProperty(c,Symbol.hasInstance,{value:u=>{var h,f;return a!=null&&a.Parent&&u instanceof a.Parent?!0:(f=(h=u==null?void 0:u._zod)==null?void 0:h.traits)==null?void 0:f.has(t)}}),Object.defineProperty(c,"name",{value:t}),c}class Ai extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class W2 extends Error{constructor(s){super(`Encountered unidirectional transform during encode: ${s}`),this.name="ZodEncodeError"}}const Y2={};function uo(t){return Y2}function _7(t){const s=Object.values(t).filter(r=>typeof r=="number");return Object.entries(t).filter(([r,o])=>s.indexOf(+r)===-1).map(([r,o])=>o)}function N0(t,s){return typeof s=="bigint"?s.toString():s}function Dg(t){return{get value(){{const s=t();return Object.defineProperty(this,"value",{value:s}),s}}}}function Pg(t){return t==null}function zg(t){const s=t.startsWith("^")?1:0,a=t.endsWith("$")?t.length-1:t.length;return t.slice(s,a)}function N7(t,s){const a=(t.toString().split(".")[1]||"").length,r=s.toString();let o=(r.split(".")[1]||"").length;if(o===0&&/\d?e-\d?/.test(r)){const h=r.match(/\d?e-(\d?)/);h!=null&&h[1]&&(o=Number.parseInt(h[1]))}const l=a>o?a:o,c=Number.parseInt(t.toFixed(l).replace(".","")),u=Number.parseInt(s.toFixed(l).replace(".",""));return c%u/10**l}const e_=Symbol("evaluating");function Nt(t,s,a){let r;Object.defineProperty(t,s,{get(){if(r!==e_)return r===void 0&&(r=e_,r=a()),r},set(o){Object.defineProperty(t,s,{value:o})},configurable:!0})}function S7(t){return Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t))}function xn(t,s,a){Object.defineProperty(t,s,{value:a,writable:!0,enumerable:!0,configurable:!0})}function Xi(...t){const s={};for(const a of t){const r=Object.getOwnPropertyDescriptors(a);Object.assign(s,r)}return Object.defineProperties({},s)}function t_(t){return JSON.stringify(t)}const K2="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function im(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const E7=Dg(()=>{var t;if(typeof navigator<"u"&&((t=navigator==null?void 0:navigator.userAgent)!=null&&t.includes("Cloudflare")))return!1;try{const s=Function;return new s(""),!0}catch{return!1}});function Oc(t){if(im(t)===!1)return!1;const s=t.constructor;if(s===void 0)return!0;const a=s.prototype;return!(im(a)===!1||Object.prototype.hasOwnProperty.call(a,"isPrototypeOf")===!1)}function X2(t){return Oc(t)?{...t}:Array.isArray(t)?[...t]:t}const C7=new Set(["string","number","symbol"]);function Tm(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function yn(t,s,a){const r=new t._zod.constr(s??t._zod.def);return(!s||a!=null&&a.parent)&&(r._zod.parent=t),r}function qe(t){const s=t;if(!s)return{};if(typeof s=="string")return{error:()=>s};if((s==null?void 0:s.message)!==void 0){if((s==null?void 0:s.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");s.error=s.message}return delete s.message,typeof s.error=="string"?{...s,error:()=>s.error}:s}function k7(t){return Object.keys(t).filter(s=>t[s]._zod.optin==="optional"&&t[s]._zod.optout==="optional")}const T7={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function A7(t,s){const a=t._zod.def,r=Xi(t._zod.def,{get shape(){const o={};for(const l in s){if(!(l in a.shape))throw new Error(`Unrecognized key: "${l}"`);s[l]&&(o[l]=a.shape[l])}return xn(this,"shape",o),o},checks:[]});return yn(t,r)}function M7(t,s){const a=t._zod.def,r=Xi(t._zod.def,{get shape(){const o={...t._zod.def.shape};for(const l in s){if(!(l in a.shape))throw new Error(`Unrecognized key: "${l}"`);s[l]&&delete o[l]}return xn(this,"shape",o),o},checks:[]});return yn(t,r)}function R7(t,s){if(!Oc(s))throw new Error("Invalid input to extend: expected a plain object");const a=t._zod.def.checks;if(a&&a.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const o=Xi(t._zod.def,{get shape(){const l={...t._zod.def.shape,...s};return xn(this,"shape",l),l},checks:[]});return yn(t,o)}function O7(t,s){if(!Oc(s))throw new Error("Invalid input to safeExtend: expected a plain object");const a={...t._zod.def,get shape(){const r={...t._zod.def.shape,...s};return xn(this,"shape",r),r},checks:t._zod.def.checks};return yn(t,a)}function D7(t,s){const a=Xi(t._zod.def,{get shape(){const r={...t._zod.def.shape,...s._zod.def.shape};return xn(this,"shape",r),r},get catchall(){return s._zod.def.catchall},checks:[]});return yn(t,a)}function P7(t,s,a){const r=Xi(s._zod.def,{get shape(){const o=s._zod.def.shape,l={...o};if(a)for(const c in a){if(!(c in o))throw new Error(`Unrecognized key: "${c}"`);a[c]&&(l[c]=t?new t({type:"optional",innerType:o[c]}):o[c])}else for(const c in o)l[c]=t?new t({type:"optional",innerType:o[c]}):o[c];return xn(this,"shape",l),l},checks:[]});return yn(s,r)}function z7(t,s,a){const r=Xi(s._zod.def,{get shape(){const o=s._zod.def.shape,l={...o};if(a)for(const c in a){if(!(c in l))throw new Error(`Unrecognized key: "${c}"`);a[c]&&(l[c]=new t({type:"nonoptional",innerType:o[c]}))}else for(const c in o)l[c]=new t({type:"nonoptional",innerType:o[c]});return xn(this,"shape",l),l},checks:[]});return yn(s,r)}function Ni(t,s=0){var a;if(t.aborted===!0)return!0;for(let r=s;r<t.issues.length;r++)if(((a=t.issues[r])==null?void 0:a.continue)!==!0)return!0;return!1}function Q2(t,s){return s.map(a=>{var r;return(r=a).path??(r.path=[]),a.path.unshift(t),a})}function vu(t){return typeof t=="string"?t:t==null?void 0:t.message}function mo(t,s,a){var o,l,c,u,h,f;const r={...t,path:t.path??[]};if(!t.message){const p=vu((c=(l=(o=t.inst)==null?void 0:o._zod.def)==null?void 0:l.error)==null?void 0:c.call(l,t))??vu((u=s==null?void 0:s.error)==null?void 0:u.call(s,t))??vu((h=a.customError)==null?void 0:h.call(a,t))??vu((f=a.localeError)==null?void 0:f.call(a,t))??"Invalid input";r.message=p}return delete r.inst,delete r.continue,s!=null&&s.reportInput||delete r.input,r}function $g(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Dc(...t){const[s,a,r]=t;return typeof s=="string"?{message:s,code:"custom",input:a,inst:r}:{...s}}const J2=(t,s)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:s,enumerable:!1}),t.message=JSON.stringify(s,N0,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},eS=Ne("$ZodError",J2),tS=Ne("$ZodError",J2,{Parent:Error});function $7(t,s=a=>a.message){const a={},r=[];for(const o of t.issues)o.path.length>0?(a[o.path[0]]=a[o.path[0]]||[],a[o.path[0]].push(s(o))):r.push(s(o));return{formErrors:r,fieldErrors:a}}function L7(t,s){const a=s||function(l){return l.message},r={_errors:[]},o=l=>{for(const c of l.issues)if(c.code==="invalid_union"&&c.errors.length)c.errors.map(u=>o({issues:u}));else if(c.code==="invalid_key")o({issues:c.issues});else if(c.code==="invalid_element")o({issues:c.issues});else if(c.path.length===0)r._errors.push(a(c));else{let u=r,h=0;for(;h<c.path.length;){const f=c.path[h];h===c.path.length-1?(u[f]=u[f]||{_errors:[]},u[f]._errors.push(a(c))):u[f]=u[f]||{_errors:[]},u=u[f],h++}}};return o(t),r}const Lg=t=>(s,a,r,o)=>{const l=r?Object.assign(r,{async:!1}):{async:!1},c=s._zod.run({value:a,issues:[]},l);if(c instanceof Promise)throw new Ai;if(c.issues.length){const u=new((o==null?void 0:o.Err)??t)(c.issues.map(h=>mo(h,l,uo())));throw K2(u,o==null?void 0:o.callee),u}return c.value},Ig=t=>async(s,a,r,o)=>{const l=r?Object.assign(r,{async:!0}):{async:!0};let c=s._zod.run({value:a,issues:[]},l);if(c instanceof Promise&&(c=await c),c.issues.length){const u=new((o==null?void 0:o.Err)??t)(c.issues.map(h=>mo(h,l,uo())));throw K2(u,o==null?void 0:o.callee),u}return c.value},Am=t=>(s,a,r)=>{const o=r?{...r,async:!1}:{async:!1},l=s._zod.run({value:a,issues:[]},o);if(l instanceof Promise)throw new Ai;return l.issues.length?{success:!1,error:new(t??eS)(l.issues.map(c=>mo(c,o,uo())))}:{success:!0,data:l.value}},I7=Am(tS),Mm=t=>async(s,a,r)=>{const o=r?Object.assign(r,{async:!0}):{async:!0};let l=s._zod.run({value:a,issues:[]},o);return l instanceof Promise&&(l=await l),l.issues.length?{success:!1,error:new t(l.issues.map(c=>mo(c,o,uo())))}:{success:!0,data:l.value}},U7=Mm(tS),B7=t=>(s,a,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Lg(t)(s,a,o)},V7=t=>(s,a,r)=>Lg(t)(s,a,r),q7=t=>async(s,a,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Ig(t)(s,a,o)},F7=t=>async(s,a,r)=>Ig(t)(s,a,r),H7=t=>(s,a,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Am(t)(s,a,o)},G7=t=>(s,a,r)=>Am(t)(s,a,r),Z7=t=>async(s,a,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Mm(t)(s,a,o)},W7=t=>async(s,a,r)=>Mm(t)(s,a,r),Y7=/^[cC][^\s-]{8,}$/,K7=/^[0-9a-z]+$/,X7=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,Q7=/^[0-9a-vA-V]{20}$/,J7=/^[A-Za-z0-9]{27}$/,e9=/^[a-zA-Z0-9_-]{21}$/,t9=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,s9=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,s_=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,a9=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,r9="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function n9(){return new RegExp(r9,"u")}const o9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,i9=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,l9=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,c9=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,d9=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,sS=/^[A-Za-z0-9_-]*$/,u9=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,m9=/^\+(?:[0-9]){6,14}[0-9]$/,aS="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",h9=new RegExp(`^${aS}$`);function rS(t){const s="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${s}`:t.precision===0?`${s}:[0-5]\\d`:`${s}:[0-5]\\d\\.\\d{${t.precision}}`:`${s}(?::[0-5]\\d(?:\\.\\d+)?)?`}function f9(t){return new RegExp(`^${rS(t)}$`)}function p9(t){const s=rS({precision:t.precision}),a=["Z"];t.local&&a.push(""),t.offset&&a.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const r=`${s}(?:${a.join("|")})`;return new RegExp(`^${aS}T(?:${r})$`)}const g9=t=>{const s=t?`[\\s\\S]{${(t==null?void 0:t.minimum)??0},${(t==null?void 0:t.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${s}$`)},x9=/^-?\d+$/,y9=/^-?\d+(?:\.\d+)?/,b9=/^(?:true|false)$/i,v9=/^[^A-Z]*$/,w9=/^[^a-z]*$/,Ls=Ne("$ZodCheck",(t,s)=>{var a;t._zod??(t._zod={}),t._zod.def=s,(a=t._zod).onattach??(a.onattach=[])}),nS={number:"number",bigint:"bigint",object:"date"},oS=Ne("$ZodCheckLessThan",(t,s)=>{Ls.init(t,s);const a=nS[typeof s.value];t._zod.onattach.push(r=>{const o=r._zod.bag,l=(s.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;s.value<l&&(s.inclusive?o.maximum=s.value:o.exclusiveMaximum=s.value)}),t._zod.check=r=>{(s.inclusive?r.value<=s.value:r.value<s.value)||r.issues.push({origin:a,code:"too_big",maximum:s.value,input:r.value,inclusive:s.inclusive,inst:t,continue:!s.abort})}}),iS=Ne("$ZodCheckGreaterThan",(t,s)=>{Ls.init(t,s);const a=nS[typeof s.value];t._zod.onattach.push(r=>{const o=r._zod.bag,l=(s.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;s.value>l&&(s.inclusive?o.minimum=s.value:o.exclusiveMinimum=s.value)}),t._zod.check=r=>{(s.inclusive?r.value>=s.value:r.value>s.value)||r.issues.push({origin:a,code:"too_small",minimum:s.value,input:r.value,inclusive:s.inclusive,inst:t,continue:!s.abort})}}),j9=Ne("$ZodCheckMultipleOf",(t,s)=>{Ls.init(t,s),t._zod.onattach.push(a=>{var r;(r=a._zod.bag).multipleOf??(r.multipleOf=s.value)}),t._zod.check=a=>{if(typeof a.value!=typeof s.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof a.value=="bigint"?a.value%s.value===BigInt(0):N7(a.value,s.value)===0)||a.issues.push({origin:typeof a.value,code:"not_multiple_of",divisor:s.value,input:a.value,inst:t,continue:!s.abort})}}),_9=Ne("$ZodCheckNumberFormat",(t,s)=>{var c;Ls.init(t,s),s.format=s.format||"float64";const a=(c=s.format)==null?void 0:c.includes("int"),r=a?"int":"number",[o,l]=T7[s.format];t._zod.onattach.push(u=>{const h=u._zod.bag;h.format=s.format,h.minimum=o,h.maximum=l,a&&(h.pattern=x9)}),t._zod.check=u=>{const h=u.value;if(a){if(!Number.isInteger(h)){u.issues.push({expected:r,format:s.format,code:"invalid_type",continue:!1,input:h,inst:t});return}if(!Number.isSafeInteger(h)){h>0?u.issues.push({input:h,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,continue:!s.abort}):u.issues.push({input:h,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,continue:!s.abort});return}}h<o&&u.issues.push({origin:"number",input:h,code:"too_small",minimum:o,inclusive:!0,inst:t,continue:!s.abort}),h>l&&u.issues.push({origin:"number",input:h,code:"too_big",maximum:l,inst:t})}}),N9=Ne("$ZodCheckMaxLength",(t,s)=>{var a;Ls.init(t,s),(a=t._zod.def).when??(a.when=r=>{const o=r.value;return!Pg(o)&&o.length!==void 0}),t._zod.onattach.push(r=>{const o=r._zod.bag.maximum??Number.POSITIVE_INFINITY;s.maximum<o&&(r._zod.bag.maximum=s.maximum)}),t._zod.check=r=>{const o=r.value;if(o.length<=s.maximum)return;const c=$g(o);r.issues.push({origin:c,code:"too_big",maximum:s.maximum,inclusive:!0,input:o,inst:t,continue:!s.abort})}}),S9=Ne("$ZodCheckMinLength",(t,s)=>{var a;Ls.init(t,s),(a=t._zod.def).when??(a.when=r=>{const o=r.value;return!Pg(o)&&o.length!==void 0}),t._zod.onattach.push(r=>{const o=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;s.minimum>o&&(r._zod.bag.minimum=s.minimum)}),t._zod.check=r=>{const o=r.value;if(o.length>=s.minimum)return;const c=$g(o);r.issues.push({origin:c,code:"too_small",minimum:s.minimum,inclusive:!0,input:o,inst:t,continue:!s.abort})}}),E9=Ne("$ZodCheckLengthEquals",(t,s)=>{var a;Ls.init(t,s),(a=t._zod.def).when??(a.when=r=>{const o=r.value;return!Pg(o)&&o.length!==void 0}),t._zod.onattach.push(r=>{const o=r._zod.bag;o.minimum=s.length,o.maximum=s.length,o.length=s.length}),t._zod.check=r=>{const o=r.value,l=o.length;if(l===s.length)return;const c=$g(o),u=l>s.length;r.issues.push({origin:c,...u?{code:"too_big",maximum:s.length}:{code:"too_small",minimum:s.length},inclusive:!0,exact:!0,input:r.value,inst:t,continue:!s.abort})}}),Rm=Ne("$ZodCheckStringFormat",(t,s)=>{var a,r;Ls.init(t,s),t._zod.onattach.push(o=>{const l=o._zod.bag;l.format=s.format,s.pattern&&(l.patterns??(l.patterns=new Set),l.patterns.add(s.pattern))}),s.pattern?(a=t._zod).check??(a.check=o=>{s.pattern.lastIndex=0,!s.pattern.test(o.value)&&o.issues.push({origin:"string",code:"invalid_format",format:s.format,input:o.value,...s.pattern?{pattern:s.pattern.toString()}:{},inst:t,continue:!s.abort})}):(r=t._zod).check??(r.check=()=>{})}),C9=Ne("$ZodCheckRegex",(t,s)=>{Rm.init(t,s),t._zod.check=a=>{s.pattern.lastIndex=0,!s.pattern.test(a.value)&&a.issues.push({origin:"string",code:"invalid_format",format:"regex",input:a.value,pattern:s.pattern.toString(),inst:t,continue:!s.abort})}}),k9=Ne("$ZodCheckLowerCase",(t,s)=>{s.pattern??(s.pattern=v9),Rm.init(t,s)}),T9=Ne("$ZodCheckUpperCase",(t,s)=>{s.pattern??(s.pattern=w9),Rm.init(t,s)}),A9=Ne("$ZodCheckIncludes",(t,s)=>{Ls.init(t,s);const a=Tm(s.includes),r=new RegExp(typeof s.position=="number"?`^.{${s.position}}${a}`:a);s.pattern=r,t._zod.onattach.push(o=>{const l=o._zod.bag;l.patterns??(l.patterns=new Set),l.patterns.add(r)}),t._zod.check=o=>{o.value.includes(s.includes,s.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:s.includes,input:o.value,inst:t,continue:!s.abort})}}),M9=Ne("$ZodCheckStartsWith",(t,s)=>{Ls.init(t,s);const a=new RegExp(`^${Tm(s.prefix)}.*`);s.pattern??(s.pattern=a),t._zod.onattach.push(r=>{const o=r._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(a)}),t._zod.check=r=>{r.value.startsWith(s.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:s.prefix,input:r.value,inst:t,continue:!s.abort})}}),R9=Ne("$ZodCheckEndsWith",(t,s)=>{Ls.init(t,s);const a=new RegExp(`.*${Tm(s.suffix)}$`);s.pattern??(s.pattern=a),t._zod.onattach.push(r=>{const o=r._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(a)}),t._zod.check=r=>{r.value.endsWith(s.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:s.suffix,input:r.value,inst:t,continue:!s.abort})}}),O9=Ne("$ZodCheckOverwrite",(t,s)=>{Ls.init(t,s),t._zod.check=a=>{a.value=s.tx(a.value)}});class D9{constructor(s=[]){this.content=[],this.indent=0,this&&(this.args=s)}indented(s){this.indent+=1,s(this),this.indent-=1}write(s){if(typeof s=="function"){s(this,{execution:"sync"}),s(this,{execution:"async"});return}const r=s.split(`
`).filter(c=>c),o=Math.min(...r.map(c=>c.length-c.trimStart().length)),l=r.map(c=>c.slice(o)).map(c=>" ".repeat(this.indent*2)+c);for(const c of l)this.content.push(c)}compile(){const s=Function,a=this==null?void 0:this.args,o=[...((this==null?void 0:this.content)??[""]).map(l=>`  ${l}`)];return new s(...a,o.join(`
`))}}const P9={major:4,minor:1,patch:9},Kt=Ne("$ZodType",(t,s)=>{var o;var a;t??(t={}),t._zod.def=s,t._zod.bag=t._zod.bag||{},t._zod.version=P9;const r=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&r.unshift(t);for(const l of r)for(const c of l._zod.onattach)c(t);if(r.length===0)(a=t._zod).deferred??(a.deferred=[]),(o=t._zod.deferred)==null||o.push(()=>{t._zod.run=t._zod.parse});else{const l=(u,h,f)=>{let p=Ni(u),g;for(const v of h){if(v._zod.def.when){if(!v._zod.def.when(u))continue}else if(p)continue;const b=u.issues.length,_=v._zod.check(u);if(_ instanceof Promise&&(f==null?void 0:f.async)===!1)throw new Ai;if(g||_ instanceof Promise)g=(g??Promise.resolve()).then(async()=>{await _,u.issues.length!==b&&(p||(p=Ni(u,b)))});else{if(u.issues.length===b)continue;p||(p=Ni(u,b))}}return g?g.then(()=>u):u},c=(u,h,f)=>{if(Ni(u))return u.aborted=!0,u;const p=l(h,r,f);if(p instanceof Promise){if(f.async===!1)throw new Ai;return p.then(g=>t._zod.parse(g,f))}return t._zod.parse(p,f)};t._zod.run=(u,h)=>{if(h.skipChecks)return t._zod.parse(u,h);if(h.direction==="backward"){const p=t._zod.parse({value:u.value,issues:[]},{...h,skipChecks:!0});return p instanceof Promise?p.then(g=>c(g,u,h)):c(p,u,h)}const f=t._zod.parse(u,h);if(f instanceof Promise){if(h.async===!1)throw new Ai;return f.then(p=>l(p,r,h))}return l(f,r,h)}}t["~standard"]={validate:l=>{var c;try{const u=I7(t,l);return u.success?{value:u.data}:{issues:(c=u.error)==null?void 0:c.issues}}catch{return U7(t,l).then(h=>{var f;return h.success?{value:h.data}:{issues:(f=h.error)==null?void 0:f.issues}})}},vendor:"zod",version:1}}),Ug=Ne("$ZodString",(t,s)=>{var a;Kt.init(t,s),t._zod.pattern=[...((a=t==null?void 0:t._zod.bag)==null?void 0:a.patterns)??[]].pop()??g9(t._zod.bag),t._zod.parse=(r,o)=>{if(s.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),Ot=Ne("$ZodStringFormat",(t,s)=>{Rm.init(t,s),Ug.init(t,s)}),z9=Ne("$ZodGUID",(t,s)=>{s.pattern??(s.pattern=s9),Ot.init(t,s)}),$9=Ne("$ZodUUID",(t,s)=>{if(s.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[s.version];if(r===void 0)throw new Error(`Invalid UUID version: "${s.version}"`);s.pattern??(s.pattern=s_(r))}else s.pattern??(s.pattern=s_());Ot.init(t,s)}),L9=Ne("$ZodEmail",(t,s)=>{s.pattern??(s.pattern=a9),Ot.init(t,s)}),I9=Ne("$ZodURL",(t,s)=>{Ot.init(t,s),t._zod.check=a=>{try{const r=a.value.trim(),o=new URL(r);s.hostname&&(s.hostname.lastIndex=0,s.hostname.test(o.hostname)||a.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:u9.source,input:a.value,inst:t,continue:!s.abort})),s.protocol&&(s.protocol.lastIndex=0,s.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||a.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:s.protocol.source,input:a.value,inst:t,continue:!s.abort})),s.normalize?a.value=o.href:a.value=r;return}catch{a.issues.push({code:"invalid_format",format:"url",input:a.value,inst:t,continue:!s.abort})}}}),U9=Ne("$ZodEmoji",(t,s)=>{s.pattern??(s.pattern=n9()),Ot.init(t,s)}),B9=Ne("$ZodNanoID",(t,s)=>{s.pattern??(s.pattern=e9),Ot.init(t,s)}),V9=Ne("$ZodCUID",(t,s)=>{s.pattern??(s.pattern=Y7),Ot.init(t,s)}),q9=Ne("$ZodCUID2",(t,s)=>{s.pattern??(s.pattern=K7),Ot.init(t,s)}),F9=Ne("$ZodULID",(t,s)=>{s.pattern??(s.pattern=X7),Ot.init(t,s)}),H9=Ne("$ZodXID",(t,s)=>{s.pattern??(s.pattern=Q7),Ot.init(t,s)}),G9=Ne("$ZodKSUID",(t,s)=>{s.pattern??(s.pattern=J7),Ot.init(t,s)}),Z9=Ne("$ZodISODateTime",(t,s)=>{s.pattern??(s.pattern=p9(s)),Ot.init(t,s)}),W9=Ne("$ZodISODate",(t,s)=>{s.pattern??(s.pattern=h9),Ot.init(t,s)}),Y9=Ne("$ZodISOTime",(t,s)=>{s.pattern??(s.pattern=f9(s)),Ot.init(t,s)}),K9=Ne("$ZodISODuration",(t,s)=>{s.pattern??(s.pattern=t9),Ot.init(t,s)}),X9=Ne("$ZodIPv4",(t,s)=>{s.pattern??(s.pattern=o9),Ot.init(t,s),t._zod.onattach.push(a=>{const r=a._zod.bag;r.format="ipv4"})}),Q9=Ne("$ZodIPv6",(t,s)=>{s.pattern??(s.pattern=i9),Ot.init(t,s),t._zod.onattach.push(a=>{const r=a._zod.bag;r.format="ipv6"}),t._zod.check=a=>{try{new URL(`http://[${a.value}]`)}catch{a.issues.push({code:"invalid_format",format:"ipv6",input:a.value,inst:t,continue:!s.abort})}}}),J9=Ne("$ZodCIDRv4",(t,s)=>{s.pattern??(s.pattern=l9),Ot.init(t,s)}),eL=Ne("$ZodCIDRv6",(t,s)=>{s.pattern??(s.pattern=c9),Ot.init(t,s),t._zod.check=a=>{const r=a.value.split("/");try{if(r.length!==2)throw new Error;const[o,l]=r;if(!l)throw new Error;const c=Number(l);if(`${c}`!==l)throw new Error;if(c<0||c>128)throw new Error;new URL(`http://[${o}]`)}catch{a.issues.push({code:"invalid_format",format:"cidrv6",input:a.value,inst:t,continue:!s.abort})}}});function lS(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const tL=Ne("$ZodBase64",(t,s)=>{s.pattern??(s.pattern=d9),Ot.init(t,s),t._zod.onattach.push(a=>{a._zod.bag.contentEncoding="base64"}),t._zod.check=a=>{lS(a.value)||a.issues.push({code:"invalid_format",format:"base64",input:a.value,inst:t,continue:!s.abort})}});function sL(t){if(!sS.test(t))return!1;const s=t.replace(/[-_]/g,r=>r==="-"?"+":"/"),a=s.padEnd(Math.ceil(s.length/4)*4,"=");return lS(a)}const aL=Ne("$ZodBase64URL",(t,s)=>{s.pattern??(s.pattern=sS),Ot.init(t,s),t._zod.onattach.push(a=>{a._zod.bag.contentEncoding="base64url"}),t._zod.check=a=>{sL(a.value)||a.issues.push({code:"invalid_format",format:"base64url",input:a.value,inst:t,continue:!s.abort})}}),rL=Ne("$ZodE164",(t,s)=>{s.pattern??(s.pattern=m9),Ot.init(t,s)});function nL(t,s=null){try{const a=t.split(".");if(a.length!==3)return!1;const[r]=a;if(!r)return!1;const o=JSON.parse(atob(r));return!("typ"in o&&(o==null?void 0:o.typ)!=="JWT"||!o.alg||s&&(!("alg"in o)||o.alg!==s))}catch{return!1}}const oL=Ne("$ZodJWT",(t,s)=>{Ot.init(t,s),t._zod.check=a=>{nL(a.value,s.alg)||a.issues.push({code:"invalid_format",format:"jwt",input:a.value,inst:t,continue:!s.abort})}}),cS=Ne("$ZodNumber",(t,s)=>{Kt.init(t,s),t._zod.pattern=t._zod.bag.pattern??y9,t._zod.parse=(a,r)=>{if(s.coerce)try{a.value=Number(a.value)}catch{}const o=a.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return a;const l=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return a.issues.push({expected:"number",code:"invalid_type",input:o,inst:t,...l?{received:l}:{}}),a}}),iL=Ne("$ZodNumber",(t,s)=>{_9.init(t,s),cS.init(t,s)}),lL=Ne("$ZodBoolean",(t,s)=>{Kt.init(t,s),t._zod.pattern=b9,t._zod.parse=(a,r)=>{if(s.coerce)try{a.value=!!a.value}catch{}const o=a.value;return typeof o=="boolean"||a.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:t}),a}}),cL=Ne("$ZodUnknown",(t,s)=>{Kt.init(t,s),t._zod.parse=a=>a}),dL=Ne("$ZodNever",(t,s)=>{Kt.init(t,s),t._zod.parse=(a,r)=>(a.issues.push({expected:"never",code:"invalid_type",input:a.value,inst:t}),a)});function a_(t,s,a){t.issues.length&&s.issues.push(...Q2(a,t.issues)),s.value[a]=t.value}const uL=Ne("$ZodArray",(t,s)=>{Kt.init(t,s),t._zod.parse=(a,r)=>{const o=a.value;if(!Array.isArray(o))return a.issues.push({expected:"array",code:"invalid_type",input:o,inst:t}),a;a.value=Array(o.length);const l=[];for(let c=0;c<o.length;c++){const u=o[c],h=s.element._zod.run({value:u,issues:[]},r);h instanceof Promise?l.push(h.then(f=>a_(f,a,c))):a_(h,a,c)}return l.length?Promise.all(l).then(()=>a):a}});function lm(t,s,a,r){t.issues.length&&s.issues.push(...Q2(a,t.issues)),t.value===void 0?a in r&&(s.value[a]=void 0):s.value[a]=t.value}function dS(t){var r,o,l,c;const s=Object.keys(t.shape);for(const u of s)if(!((c=(l=(o=(r=t.shape)==null?void 0:r[u])==null?void 0:o._zod)==null?void 0:l.traits)!=null&&c.has("$ZodType")))throw new Error(`Invalid element at key "${u}": expected a Zod schema`);const a=k7(t.shape);return{...t,keys:s,keySet:new Set(s),numKeys:s.length,optionalKeys:new Set(a)}}function uS(t,s,a,r,o,l){const c=[],u=o.keySet,h=o.catchall._zod,f=h.def.type;for(const p of Object.keys(s)){if(u.has(p))continue;if(f==="never"){c.push(p);continue}const g=h.run({value:s[p],issues:[]},r);g instanceof Promise?t.push(g.then(v=>lm(v,a,p,s))):lm(g,a,p,s)}return c.length&&a.issues.push({code:"unrecognized_keys",keys:c,input:s,inst:l}),t.length?Promise.all(t).then(()=>a):a}const mL=Ne("$ZodObject",(t,s)=>{Kt.init(t,s);const a=Dg(()=>dS(s));Nt(t._zod,"propValues",()=>{const c=s.shape,u={};for(const h in c){const f=c[h]._zod;if(f.values){u[h]??(u[h]=new Set);for(const p of f.values)u[h].add(p)}}return u});const r=im,o=s.catchall;let l;t._zod.parse=(c,u)=>{l??(l=a.value);const h=c.value;if(!r(h))return c.issues.push({expected:"object",code:"invalid_type",input:h,inst:t}),c;c.value={};const f=[],p=l.shape;for(const g of l.keys){const b=p[g]._zod.run({value:h[g],issues:[]},u);b instanceof Promise?f.push(b.then(_=>lm(_,c,g,h))):lm(b,c,g,h)}return o?uS(f,h,c,u,a.value,t):f.length?Promise.all(f).then(()=>c):c}}),hL=Ne("$ZodObjectJIT",(t,s)=>{mL.init(t,s);const a=t._zod.parse,r=Dg(()=>dS(s)),o=v=>{const b=new D9(["shape","payload","ctx"]),_=r.value,w=k=>{const S=t_(k);return`shape[${S}]._zod.run({ value: input[${S}], issues: [] }, ctx)`};b.write("const input = payload.value;");const E=Object.create(null);let T=0;for(const k of _.keys)E[k]=`key_${T++}`;b.write("const newResult = {};");for(const k of _.keys){const S=E[k],C=t_(k);b.write(`const ${S} = ${w(k)};`),b.write(`
        if (${S}.issues.length) {
          payload.issues = payload.issues.concat(${S}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${C}, ...iss.path] : [${C}]
          })));
        }
        
        
        if (${S}.value === undefined) {
          if (${C} in input) {
            newResult[${C}] = undefined;
          }
        } else {
          newResult[${C}] = ${S}.value;
        }
        
      `)}b.write("payload.value = newResult;"),b.write("return payload;");const N=b.compile();return(k,S)=>N(v,k,S)};let l;const c=im,u=!Y2.jitless,f=u&&E7.value,p=s.catchall;let g;t._zod.parse=(v,b)=>{g??(g=r.value);const _=v.value;return c(_)?u&&f&&(b==null?void 0:b.async)===!1&&b.jitless!==!0?(l||(l=o(s.shape)),v=l(v,b),p?uS([],_,v,b,g,t):v):a(v,b):(v.issues.push({expected:"object",code:"invalid_type",input:_,inst:t}),v)}});function r_(t,s,a,r){for(const l of t)if(l.issues.length===0)return s.value=l.value,s;const o=t.filter(l=>!Ni(l));return o.length===1?(s.value=o[0].value,o[0]):(s.issues.push({code:"invalid_union",input:s.value,inst:a,errors:t.map(l=>l.issues.map(c=>mo(c,r,uo())))}),s)}const fL=Ne("$ZodUnion",(t,s)=>{Kt.init(t,s),Nt(t._zod,"optin",()=>s.options.some(o=>o._zod.optin==="optional")?"optional":void 0),Nt(t._zod,"optout",()=>s.options.some(o=>o._zod.optout==="optional")?"optional":void 0),Nt(t._zod,"values",()=>{if(s.options.every(o=>o._zod.values))return new Set(s.options.flatMap(o=>Array.from(o._zod.values)))}),Nt(t._zod,"pattern",()=>{if(s.options.every(o=>o._zod.pattern)){const o=s.options.map(l=>l._zod.pattern);return new RegExp(`^(${o.map(l=>zg(l.source)).join("|")})$`)}});const a=s.options.length===1,r=s.options[0]._zod.run;t._zod.parse=(o,l)=>{if(a)return r(o,l);let c=!1;const u=[];for(const h of s.options){const f=h._zod.run({value:o.value,issues:[]},l);if(f instanceof Promise)u.push(f),c=!0;else{if(f.issues.length===0)return f;u.push(f)}}return c?Promise.all(u).then(h=>r_(h,o,t,l)):r_(u,o,t,l)}}),pL=Ne("$ZodIntersection",(t,s)=>{Kt.init(t,s),t._zod.parse=(a,r)=>{const o=a.value,l=s.left._zod.run({value:o,issues:[]},r),c=s.right._zod.run({value:o,issues:[]},r);return l instanceof Promise||c instanceof Promise?Promise.all([l,c]).then(([h,f])=>n_(a,h,f)):n_(a,l,c)}});function S0(t,s){if(t===s)return{valid:!0,data:t};if(t instanceof Date&&s instanceof Date&&+t==+s)return{valid:!0,data:t};if(Oc(t)&&Oc(s)){const a=Object.keys(s),r=Object.keys(t).filter(l=>a.indexOf(l)!==-1),o={...t,...s};for(const l of r){const c=S0(t[l],s[l]);if(!c.valid)return{valid:!1,mergeErrorPath:[l,...c.mergeErrorPath]};o[l]=c.data}return{valid:!0,data:o}}if(Array.isArray(t)&&Array.isArray(s)){if(t.length!==s.length)return{valid:!1,mergeErrorPath:[]};const a=[];for(let r=0;r<t.length;r++){const o=t[r],l=s[r],c=S0(o,l);if(!c.valid)return{valid:!1,mergeErrorPath:[r,...c.mergeErrorPath]};a.push(c.data)}return{valid:!0,data:a}}return{valid:!1,mergeErrorPath:[]}}function n_(t,s,a){if(s.issues.length&&t.issues.push(...s.issues),a.issues.length&&t.issues.push(...a.issues),Ni(t))return t;const r=S0(s.value,a.value);if(!r.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return t.value=r.data,t}const gL=Ne("$ZodEnum",(t,s)=>{Kt.init(t,s);const a=_7(s.entries),r=new Set(a);t._zod.values=r,t._zod.pattern=new RegExp(`^(${a.filter(o=>C7.has(typeof o)).map(o=>typeof o=="string"?Tm(o):o.toString()).join("|")})$`),t._zod.parse=(o,l)=>{const c=o.value;return r.has(c)||o.issues.push({code:"invalid_value",values:a,input:c,inst:t}),o}}),xL=Ne("$ZodTransform",(t,s)=>{Kt.init(t,s),t._zod.parse=(a,r)=>{if(r.direction==="backward")throw new W2(t.constructor.name);const o=s.transform(a.value,a);if(r.async)return(o instanceof Promise?o:Promise.resolve(o)).then(c=>(a.value=c,a));if(o instanceof Promise)throw new Ai;return a.value=o,a}});function o_(t,s){return t.issues.length&&s===void 0?{issues:[],value:void 0}:t}const yL=Ne("$ZodOptional",(t,s)=>{Kt.init(t,s),t._zod.optin="optional",t._zod.optout="optional",Nt(t._zod,"values",()=>s.innerType._zod.values?new Set([...s.innerType._zod.values,void 0]):void 0),Nt(t._zod,"pattern",()=>{const a=s.innerType._zod.pattern;return a?new RegExp(`^(${zg(a.source)})?$`):void 0}),t._zod.parse=(a,r)=>{if(s.innerType._zod.optin==="optional"){const o=s.innerType._zod.run(a,r);return o instanceof Promise?o.then(l=>o_(l,a.value)):o_(o,a.value)}return a.value===void 0?a:s.innerType._zod.run(a,r)}}),bL=Ne("$ZodNullable",(t,s)=>{Kt.init(t,s),Nt(t._zod,"optin",()=>s.innerType._zod.optin),Nt(t._zod,"optout",()=>s.innerType._zod.optout),Nt(t._zod,"pattern",()=>{const a=s.innerType._zod.pattern;return a?new RegExp(`^(${zg(a.source)}|null)$`):void 0}),Nt(t._zod,"values",()=>s.innerType._zod.values?new Set([...s.innerType._zod.values,null]):void 0),t._zod.parse=(a,r)=>a.value===null?a:s.innerType._zod.run(a,r)}),vL=Ne("$ZodDefault",(t,s)=>{Kt.init(t,s),t._zod.optin="optional",Nt(t._zod,"values",()=>s.innerType._zod.values),t._zod.parse=(a,r)=>{if(r.direction==="backward")return s.innerType._zod.run(a,r);if(a.value===void 0)return a.value=s.defaultValue,a;const o=s.innerType._zod.run(a,r);return o instanceof Promise?o.then(l=>i_(l,s)):i_(o,s)}});function i_(t,s){return t.value===void 0&&(t.value=s.defaultValue),t}const wL=Ne("$ZodPrefault",(t,s)=>{Kt.init(t,s),t._zod.optin="optional",Nt(t._zod,"values",()=>s.innerType._zod.values),t._zod.parse=(a,r)=>(r.direction==="backward"||a.value===void 0&&(a.value=s.defaultValue),s.innerType._zod.run(a,r))}),jL=Ne("$ZodNonOptional",(t,s)=>{Kt.init(t,s),Nt(t._zod,"values",()=>{const a=s.innerType._zod.values;return a?new Set([...a].filter(r=>r!==void 0)):void 0}),t._zod.parse=(a,r)=>{const o=s.innerType._zod.run(a,r);return o instanceof Promise?o.then(l=>l_(l,t)):l_(o,t)}});function l_(t,s){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:s}),t}const _L=Ne("$ZodCatch",(t,s)=>{Kt.init(t,s),Nt(t._zod,"optin",()=>s.innerType._zod.optin),Nt(t._zod,"optout",()=>s.innerType._zod.optout),Nt(t._zod,"values",()=>s.innerType._zod.values),t._zod.parse=(a,r)=>{if(r.direction==="backward")return s.innerType._zod.run(a,r);const o=s.innerType._zod.run(a,r);return o instanceof Promise?o.then(l=>(a.value=l.value,l.issues.length&&(a.value=s.catchValue({...a,error:{issues:l.issues.map(c=>mo(c,r,uo()))},input:a.value}),a.issues=[]),a)):(a.value=o.value,o.issues.length&&(a.value=s.catchValue({...a,error:{issues:o.issues.map(l=>mo(l,r,uo()))},input:a.value}),a.issues=[]),a)}}),NL=Ne("$ZodPipe",(t,s)=>{Kt.init(t,s),Nt(t._zod,"values",()=>s.in._zod.values),Nt(t._zod,"optin",()=>s.in._zod.optin),Nt(t._zod,"optout",()=>s.out._zod.optout),Nt(t._zod,"propValues",()=>s.in._zod.propValues),t._zod.parse=(a,r)=>{if(r.direction==="backward"){const l=s.out._zod.run(a,r);return l instanceof Promise?l.then(c=>wu(c,s.in,r)):wu(l,s.in,r)}const o=s.in._zod.run(a,r);return o instanceof Promise?o.then(l=>wu(l,s.out,r)):wu(o,s.out,r)}});function wu(t,s,a){return t.issues.length?(t.aborted=!0,t):s._zod.run({value:t.value,issues:t.issues},a)}const SL=Ne("$ZodReadonly",(t,s)=>{Kt.init(t,s),Nt(t._zod,"propValues",()=>s.innerType._zod.propValues),Nt(t._zod,"values",()=>s.innerType._zod.values),Nt(t._zod,"optin",()=>s.innerType._zod.optin),Nt(t._zod,"optout",()=>s.innerType._zod.optout),t._zod.parse=(a,r)=>{if(r.direction==="backward")return s.innerType._zod.run(a,r);const o=s.innerType._zod.run(a,r);return o instanceof Promise?o.then(c_):c_(o)}});function c_(t){return t.value=Object.freeze(t.value),t}const EL=Ne("$ZodCustom",(t,s)=>{Ls.init(t,s),Kt.init(t,s),t._zod.parse=(a,r)=>a,t._zod.check=a=>{const r=a.value,o=s.fn(r);if(o instanceof Promise)return o.then(l=>d_(l,a,r,t));d_(o,a,r,t)}});function d_(t,s,a,r){if(!t){const o={code:"custom",input:a,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(o.params=r._zod.def.params),s.issues.push(Dc(o))}}class CL{constructor(){this._map=new WeakMap,this._idmap=new Map}add(s,...a){const r=a[0];if(this._map.set(s,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,s)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(s){const a=this._map.get(s);return a&&typeof a=="object"&&"id"in a&&this._idmap.delete(a.id),this._map.delete(s),this}get(s){const a=s._zod.parent;if(a){const r={...this.get(a)??{}};delete r.id;const o={...r,...this._map.get(s)};return Object.keys(o).length?o:void 0}return this._map.get(s)}has(s){return this._map.has(s)}}function kL(){return new CL}const ju=kL();function TL(t,s){return new t({type:"string",...qe(s)})}function AL(t,s){return new t({type:"string",format:"email",check:"string_format",abort:!1,...qe(s)})}function u_(t,s){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...qe(s)})}function ML(t,s){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...qe(s)})}function RL(t,s){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...qe(s)})}function OL(t,s){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...qe(s)})}function DL(t,s){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...qe(s)})}function PL(t,s){return new t({type:"string",format:"url",check:"string_format",abort:!1,...qe(s)})}function zL(t,s){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...qe(s)})}function $L(t,s){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...qe(s)})}function LL(t,s){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...qe(s)})}function IL(t,s){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...qe(s)})}function UL(t,s){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...qe(s)})}function BL(t,s){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...qe(s)})}function VL(t,s){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...qe(s)})}function qL(t,s){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...qe(s)})}function FL(t,s){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...qe(s)})}function HL(t,s){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...qe(s)})}function GL(t,s){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...qe(s)})}function ZL(t,s){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...qe(s)})}function WL(t,s){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...qe(s)})}function YL(t,s){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...qe(s)})}function KL(t,s){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...qe(s)})}function XL(t,s){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...qe(s)})}function QL(t,s){return new t({type:"string",format:"date",check:"string_format",...qe(s)})}function JL(t,s){return new t({type:"string",format:"time",check:"string_format",precision:null,...qe(s)})}function eI(t,s){return new t({type:"string",format:"duration",check:"string_format",...qe(s)})}function tI(t,s){return new t({type:"number",checks:[],...qe(s)})}function sI(t,s){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...qe(s)})}function aI(t,s){return new t({type:"boolean",...qe(s)})}function rI(t){return new t({type:"unknown"})}function nI(t,s){return new t({type:"never",...qe(s)})}function m_(t,s){return new oS({check:"less_than",...qe(s),value:t,inclusive:!1})}function Cp(t,s){return new oS({check:"less_than",...qe(s),value:t,inclusive:!0})}function h_(t,s){return new iS({check:"greater_than",...qe(s),value:t,inclusive:!1})}function kp(t,s){return new iS({check:"greater_than",...qe(s),value:t,inclusive:!0})}function f_(t,s){return new j9({check:"multiple_of",...qe(s),value:t})}function mS(t,s){return new N9({check:"max_length",...qe(s),maximum:t})}function cm(t,s){return new S9({check:"min_length",...qe(s),minimum:t})}function hS(t,s){return new E9({check:"length_equals",...qe(s),length:t})}function oI(t,s){return new C9({check:"string_format",format:"regex",...qe(s),pattern:t})}function iI(t){return new k9({check:"string_format",format:"lowercase",...qe(t)})}function lI(t){return new T9({check:"string_format",format:"uppercase",...qe(t)})}function cI(t,s){return new A9({check:"string_format",format:"includes",...qe(s),includes:t})}function dI(t,s){return new M9({check:"string_format",format:"starts_with",...qe(s),prefix:t})}function uI(t,s){return new R9({check:"string_format",format:"ends_with",...qe(s),suffix:t})}function Gc(t){return new O9({check:"overwrite",tx:t})}function mI(t){return Gc(s=>s.normalize(t))}function hI(){return Gc(t=>t.trim())}function fI(){return Gc(t=>t.toLowerCase())}function pI(){return Gc(t=>t.toUpperCase())}function gI(t,s,a){return new t({type:"array",element:s,...qe(a)})}function xI(t,s,a){return new t({type:"custom",check:"custom",fn:s,...qe(a)})}function yI(t){const s=bI(a=>(a.addIssue=r=>{if(typeof r=="string")a.issues.push(Dc(r,a.value,s._zod.def));else{const o=r;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=a.value),o.inst??(o.inst=s),o.continue??(o.continue=!s._zod.def.abort),a.issues.push(Dc(o))}},t(a.value,a)));return s}function bI(t,s){const a=new Ls({check:"custom",...qe(s)});return a._zod.check=t,a}const vI=Ne("ZodISODateTime",(t,s)=>{Z9.init(t,s),$t.init(t,s)});function wI(t){return XL(vI,t)}const jI=Ne("ZodISODate",(t,s)=>{W9.init(t,s),$t.init(t,s)});function _I(t){return QL(jI,t)}const NI=Ne("ZodISOTime",(t,s)=>{Y9.init(t,s),$t.init(t,s)});function SI(t){return JL(NI,t)}const EI=Ne("ZodISODuration",(t,s)=>{K9.init(t,s),$t.init(t,s)});function CI(t){return eI(EI,t)}const kI=(t,s)=>{eS.init(t,s),t.name="ZodError",Object.defineProperties(t,{format:{value:a=>L7(t,a)},flatten:{value:a=>$7(t,a)},addIssue:{value:a=>{t.issues.push(a),t.message=JSON.stringify(t.issues,N0,2)}},addIssues:{value:a=>{t.issues.push(...a),t.message=JSON.stringify(t.issues,N0,2)}},isEmpty:{get(){return t.issues.length===0}}})},ha=Ne("ZodError",kI,{Parent:Error}),TI=Lg(ha),AI=Ig(ha),MI=Am(ha),RI=Mm(ha),OI=B7(ha),DI=V7(ha),PI=q7(ha),zI=F7(ha),$I=H7(ha),LI=G7(ha),II=Z7(ha),UI=W7(ha),as=Ne("ZodType",(t,s)=>(Kt.init(t,s),t.def=s,t.type=s.type,Object.defineProperty(t,"_def",{value:s}),t.check=(...a)=>t.clone({...s,checks:[...s.checks??[],...a.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]}),t.clone=(a,r)=>yn(t,a,r),t.brand=()=>t,t.register=(a,r)=>(a.add(t,r),t),t.parse=(a,r)=>TI(t,a,r,{callee:t.parse}),t.safeParse=(a,r)=>MI(t,a,r),t.parseAsync=async(a,r)=>AI(t,a,r,{callee:t.parseAsync}),t.safeParseAsync=async(a,r)=>RI(t,a,r),t.spa=t.safeParseAsync,t.encode=(a,r)=>OI(t,a,r),t.decode=(a,r)=>DI(t,a,r),t.encodeAsync=async(a,r)=>PI(t,a,r),t.decodeAsync=async(a,r)=>zI(t,a,r),t.safeEncode=(a,r)=>$I(t,a,r),t.safeDecode=(a,r)=>LI(t,a,r),t.safeEncodeAsync=async(a,r)=>II(t,a,r),t.safeDecodeAsync=async(a,r)=>UI(t,a,r),t.refine=(a,r)=>t.check(RU(a,r)),t.superRefine=a=>t.check(OU(a)),t.overwrite=a=>t.check(Gc(a)),t.optional=()=>y_(t),t.nullable=()=>b_(t),t.nullish=()=>y_(b_(t)),t.nonoptional=a=>SU(t,a),t.array=()=>mU(t),t.or=a=>pU([t,a]),t.and=a=>xU(t,a),t.transform=a=>v_(t,bU(a)),t.default=a=>jU(t,a),t.prefault=a=>NU(t,a),t.catch=a=>CU(t,a),t.pipe=a=>v_(t,a),t.readonly=()=>AU(t),t.describe=a=>{const r=t.clone();return ju.add(r,{description:a}),r},Object.defineProperty(t,"description",{get(){var a;return(a=ju.get(t))==null?void 0:a.description},configurable:!0}),t.meta=(...a)=>{if(a.length===0)return ju.get(t);const r=t.clone();return ju.add(r,a[0]),r},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),fS=Ne("_ZodString",(t,s)=>{Ug.init(t,s),as.init(t,s);const a=t._zod.bag;t.format=a.format??null,t.minLength=a.minimum??null,t.maxLength=a.maximum??null,t.regex=(...r)=>t.check(oI(...r)),t.includes=(...r)=>t.check(cI(...r)),t.startsWith=(...r)=>t.check(dI(...r)),t.endsWith=(...r)=>t.check(uI(...r)),t.min=(...r)=>t.check(cm(...r)),t.max=(...r)=>t.check(mS(...r)),t.length=(...r)=>t.check(hS(...r)),t.nonempty=(...r)=>t.check(cm(1,...r)),t.lowercase=r=>t.check(iI(r)),t.uppercase=r=>t.check(lI(r)),t.trim=()=>t.check(hI()),t.normalize=(...r)=>t.check(mI(...r)),t.toLowerCase=()=>t.check(fI()),t.toUpperCase=()=>t.check(pI())}),BI=Ne("ZodString",(t,s)=>{Ug.init(t,s),fS.init(t,s),t.email=a=>t.check(AL(VI,a)),t.url=a=>t.check(PL(qI,a)),t.jwt=a=>t.check(KL(rU,a)),t.emoji=a=>t.check(zL(FI,a)),t.guid=a=>t.check(u_(p_,a)),t.uuid=a=>t.check(ML(_u,a)),t.uuidv4=a=>t.check(RL(_u,a)),t.uuidv6=a=>t.check(OL(_u,a)),t.uuidv7=a=>t.check(DL(_u,a)),t.nanoid=a=>t.check($L(HI,a)),t.guid=a=>t.check(u_(p_,a)),t.cuid=a=>t.check(LL(GI,a)),t.cuid2=a=>t.check(IL(ZI,a)),t.ulid=a=>t.check(UL(WI,a)),t.base64=a=>t.check(ZL(tU,a)),t.base64url=a=>t.check(WL(sU,a)),t.xid=a=>t.check(BL(YI,a)),t.ksuid=a=>t.check(VL(KI,a)),t.ipv4=a=>t.check(qL(XI,a)),t.ipv6=a=>t.check(FL(QI,a)),t.cidrv4=a=>t.check(HL(JI,a)),t.cidrv6=a=>t.check(GL(eU,a)),t.e164=a=>t.check(YL(aU,a)),t.datetime=a=>t.check(wI(a)),t.date=a=>t.check(_I(a)),t.time=a=>t.check(SI(a)),t.duration=a=>t.check(CI(a))});function Wt(t){return TL(BI,t)}const $t=Ne("ZodStringFormat",(t,s)=>{Ot.init(t,s),fS.init(t,s)}),VI=Ne("ZodEmail",(t,s)=>{L9.init(t,s),$t.init(t,s)}),p_=Ne("ZodGUID",(t,s)=>{z9.init(t,s),$t.init(t,s)}),_u=Ne("ZodUUID",(t,s)=>{$9.init(t,s),$t.init(t,s)}),qI=Ne("ZodURL",(t,s)=>{I9.init(t,s),$t.init(t,s)}),FI=Ne("ZodEmoji",(t,s)=>{U9.init(t,s),$t.init(t,s)}),HI=Ne("ZodNanoID",(t,s)=>{B9.init(t,s),$t.init(t,s)}),GI=Ne("ZodCUID",(t,s)=>{V9.init(t,s),$t.init(t,s)}),ZI=Ne("ZodCUID2",(t,s)=>{q9.init(t,s),$t.init(t,s)}),WI=Ne("ZodULID",(t,s)=>{F9.init(t,s),$t.init(t,s)}),YI=Ne("ZodXID",(t,s)=>{H9.init(t,s),$t.init(t,s)}),KI=Ne("ZodKSUID",(t,s)=>{G9.init(t,s),$t.init(t,s)}),XI=Ne("ZodIPv4",(t,s)=>{X9.init(t,s),$t.init(t,s)}),QI=Ne("ZodIPv6",(t,s)=>{Q9.init(t,s),$t.init(t,s)}),JI=Ne("ZodCIDRv4",(t,s)=>{J9.init(t,s),$t.init(t,s)}),eU=Ne("ZodCIDRv6",(t,s)=>{eL.init(t,s),$t.init(t,s)}),tU=Ne("ZodBase64",(t,s)=>{tL.init(t,s),$t.init(t,s)}),sU=Ne("ZodBase64URL",(t,s)=>{aL.init(t,s),$t.init(t,s)}),aU=Ne("ZodE164",(t,s)=>{rL.init(t,s),$t.init(t,s)}),rU=Ne("ZodJWT",(t,s)=>{oL.init(t,s),$t.init(t,s)}),pS=Ne("ZodNumber",(t,s)=>{cS.init(t,s),as.init(t,s),t.gt=(r,o)=>t.check(h_(r,o)),t.gte=(r,o)=>t.check(kp(r,o)),t.min=(r,o)=>t.check(kp(r,o)),t.lt=(r,o)=>t.check(m_(r,o)),t.lte=(r,o)=>t.check(Cp(r,o)),t.max=(r,o)=>t.check(Cp(r,o)),t.int=r=>t.check(g_(r)),t.safe=r=>t.check(g_(r)),t.positive=r=>t.check(h_(0,r)),t.nonnegative=r=>t.check(kp(0,r)),t.negative=r=>t.check(m_(0,r)),t.nonpositive=r=>t.check(Cp(0,r)),t.multipleOf=(r,o)=>t.check(f_(r,o)),t.step=(r,o)=>t.check(f_(r,o)),t.finite=()=>t;const a=t._zod.bag;t.minValue=Math.max(a.minimum??Number.NEGATIVE_INFINITY,a.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(a.maximum??Number.POSITIVE_INFINITY,a.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(a.format??"").includes("int")||Number.isSafeInteger(a.multipleOf??.5),t.isFinite=!0,t.format=a.format??null});function un(t){return tI(pS,t)}const nU=Ne("ZodNumberFormat",(t,s)=>{iL.init(t,s),pS.init(t,s)});function g_(t){return sI(nU,t)}const oU=Ne("ZodBoolean",(t,s)=>{lL.init(t,s),as.init(t,s)});function iU(t){return aI(oU,t)}const lU=Ne("ZodUnknown",(t,s)=>{cL.init(t,s),as.init(t,s)});function x_(){return rI(lU)}const cU=Ne("ZodNever",(t,s)=>{dL.init(t,s),as.init(t,s)});function dU(t){return nI(cU,t)}const uU=Ne("ZodArray",(t,s)=>{uL.init(t,s),as.init(t,s),t.element=s.element,t.min=(a,r)=>t.check(cm(a,r)),t.nonempty=a=>t.check(cm(1,a)),t.max=(a,r)=>t.check(mS(a,r)),t.length=(a,r)=>t.check(hS(a,r)),t.unwrap=()=>t.element});function mU(t,s){return gI(uU,t,s)}const hU=Ne("ZodObject",(t,s)=>{hL.init(t,s),as.init(t,s),Nt(t,"shape",()=>s.shape),t.keyof=()=>Nr(Object.keys(t._zod.def.shape)),t.catchall=a=>t.clone({...t._zod.def,catchall:a}),t.passthrough=()=>t.clone({...t._zod.def,catchall:x_()}),t.loose=()=>t.clone({...t._zod.def,catchall:x_()}),t.strict=()=>t.clone({...t._zod.def,catchall:dU()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=a=>R7(t,a),t.safeExtend=a=>O7(t,a),t.merge=a=>D7(t,a),t.pick=a=>A7(t,a),t.omit=a=>M7(t,a),t.partial=(...a)=>P7(gS,t,a[0]),t.required=(...a)=>z7(xS,t,a[0])});function Zc(t,s){const a={type:"object",get shape(){return xn(this,"shape",t?S7(t):{}),this.shape},...qe(s)};return new hU(a)}const fU=Ne("ZodUnion",(t,s)=>{fL.init(t,s),as.init(t,s),t.options=s.options});function pU(t,s){return new fU({type:"union",options:t,...qe(s)})}const gU=Ne("ZodIntersection",(t,s)=>{pL.init(t,s),as.init(t,s)});function xU(t,s){return new gU({type:"intersection",left:t,right:s})}const E0=Ne("ZodEnum",(t,s)=>{gL.init(t,s),as.init(t,s),t.enum=s.entries,t.options=Object.values(s.entries);const a=new Set(Object.keys(s.entries));t.extract=(r,o)=>{const l={};for(const c of r)if(a.has(c))l[c]=s.entries[c];else throw new Error(`Key ${c} not found in enum`);return new E0({...s,checks:[],...qe(o),entries:l})},t.exclude=(r,o)=>{const l={...s.entries};for(const c of r)if(a.has(c))delete l[c];else throw new Error(`Key ${c} not found in enum`);return new E0({...s,checks:[],...qe(o),entries:l})}});function Nr(t,s){const a=Array.isArray(t)?Object.fromEntries(t.map(r=>[r,r])):t;return new E0({type:"enum",entries:a,...qe(s)})}const yU=Ne("ZodTransform",(t,s)=>{xL.init(t,s),as.init(t,s),t._zod.parse=(a,r)=>{if(r.direction==="backward")throw new W2(t.constructor.name);a.addIssue=l=>{if(typeof l=="string")a.issues.push(Dc(l,a.value,s));else{const c=l;c.fatal&&(c.continue=!1),c.code??(c.code="custom"),c.input??(c.input=a.value),c.inst??(c.inst=t),a.issues.push(Dc(c))}};const o=s.transform(a.value,a);return o instanceof Promise?o.then(l=>(a.value=l,a)):(a.value=o,a)}});function bU(t){return new yU({type:"transform",transform:t})}const gS=Ne("ZodOptional",(t,s)=>{yL.init(t,s),as.init(t,s),t.unwrap=()=>t._zod.def.innerType});function y_(t){return new gS({type:"optional",innerType:t})}const vU=Ne("ZodNullable",(t,s)=>{bL.init(t,s),as.init(t,s),t.unwrap=()=>t._zod.def.innerType});function b_(t){return new vU({type:"nullable",innerType:t})}const wU=Ne("ZodDefault",(t,s)=>{vL.init(t,s),as.init(t,s),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function jU(t,s){return new wU({type:"default",innerType:t,get defaultValue(){return typeof s=="function"?s():X2(s)}})}const _U=Ne("ZodPrefault",(t,s)=>{wL.init(t,s),as.init(t,s),t.unwrap=()=>t._zod.def.innerType});function NU(t,s){return new _U({type:"prefault",innerType:t,get defaultValue(){return typeof s=="function"?s():X2(s)}})}const xS=Ne("ZodNonOptional",(t,s)=>{jL.init(t,s),as.init(t,s),t.unwrap=()=>t._zod.def.innerType});function SU(t,s){return new xS({type:"nonoptional",innerType:t,...qe(s)})}const EU=Ne("ZodCatch",(t,s)=>{_L.init(t,s),as.init(t,s),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function CU(t,s){return new EU({type:"catch",innerType:t,catchValue:typeof s=="function"?s:()=>s})}const kU=Ne("ZodPipe",(t,s)=>{NL.init(t,s),as.init(t,s),t.in=s.in,t.out=s.out});function v_(t,s){return new kU({type:"pipe",in:t,out:s})}const TU=Ne("ZodReadonly",(t,s)=>{SL.init(t,s),as.init(t,s),t.unwrap=()=>t._zod.def.innerType});function AU(t){return new TU({type:"readonly",innerType:t})}const MU=Ne("ZodCustom",(t,s)=>{EL.init(t,s),as.init(t,s)});function RU(t,s={}){return xI(MU,t,s)}function OU(t){return yI(t)}const DU=Zc({amount:un().positive("O valor deve ser positivo").max(Ct.MAX_SUPPLY_WITHOUT_APPROVAL*10,"Valor muito alto para suprimento").refine(t=>Number.isFinite(t)&&t>0,"Valor invlido"),reason:Wt().min(5,"A justificativa deve ter pelo menos 5 caracteres").max(500,"A justificativa no pode exceder 500 caracteres"),source:Wt().min(3,"A origem deve ter pelo menos 3 caracteres").max(100,"A origem no pode exceder 100 caracteres"),authorized_by:Wt().uuid("ID de autorizao invlido").optional(),purpose:Nr(["change_fund","security","expense","transfer","correction","other"]),reference_number:Wt().max(50).optional(),notes:Wt().max(1e3).optional()}).refine(t=>t.amount>Ct.MAX_SUPPLY_WITHOUT_APPROVAL?!!t.authorized_by:!0,{message:`Suprimentos acima de R$ ${Ct.MAX_SUPPLY_WITHOUT_APPROVAL} requerem autorizao de supervisor`,path:["authorized_by"]}),PU=Zc({amount:un().positive("O valor deve ser positivo").max(Ct.AUTO_SANGRIA_THRESHOLD*2,"Valor muito alto para sangria").refine(t=>Number.isFinite(t)&&t>0,"Valor invlido"),reason:Wt().min(5,"A justificativa deve ter pelo menos 5 caracteres").max(500,"A justificativa no pode exceder 500 caracteres"),destination:Wt().min(3,"O destino deve ter pelo menos 3 caracteres").max(100,"O destino no pode exceder 100 caracteres"),authorized_by:Wt().uuid("ID de autorizao invlido").optional(),purpose:Nr(["change_fund","security","expense","transfer","correction","other"]),recipient:Wt().max(100).optional(),reference_number:Wt().max(50).optional(),notes:Wt().max(1e3).optional()}).refine(t=>t.amount>Ct.SUPERVISOR_APPROVAL_THRESHOLD?!!t.authorized_by:!0,{message:`Sangrias acima de R$ ${Ct.SUPERVISOR_APPROVAL_THRESHOLD} requerem autorizao de supervisor`,path:["authorized_by"]});Zc({cash_session_id:Wt().uuid("ID de sesso invlido"),movement_type:Nr(["supply","withdrawal","transfer"]),amount:un().positive("O valor deve ser positivo"),reason:Wt().min(5).max(500),authorized_by:Wt().uuid().optional(),authorization_status:Nr(["pending","approved","rejected","not_required"]),recipient:Wt().max(100).optional(),purpose:Nr(["change_fund","security","expense","transfer","correction","other"]),reference_number:Wt().max(50).optional()});Zc({user_id:Wt().uuid("ID de usurio invlido"),role:Wt().min(1,"Funo  obrigatria"),max_supply_amount:un().nonnegative("O limite de suprimento no pode ser negativo").max(1e5,"Limite muito alto"),max_withdrawal_amount:un().nonnegative("O limite de sangria no pode ser negativo").max(1e5,"Limite muito alto"),requires_supervisor_approval_above:un().nonnegative("O limite de aprovao no pode ser negativo"),can_authorize_movements:iU()});Zc({start_date:Wt().datetime().optional(),end_date:Wt().datetime().optional(),movement_type:Nr(["supply","withdrawal","transfer"]).optional(),purpose:Nr(["change_fund","security","expense","transfer","correction","other"]).optional(),min_amount:un().nonnegative().optional(),max_amount:un().positive().optional(),authorized_by:Wt().uuid().optional(),authorization_status:Nr(["pending","approved","rejected","not_required"]).optional()}).refine(t=>t.start_date&&t.end_date?new Date(t.start_date)<=new Date(t.end_date):!0,{message:"A data inicial deve ser anterior  data final",path:["end_date"]}).refine(t=>t.min_amount!==void 0&&t.max_amount!==void 0?t.min_amount<=t.max_amount:!0,{message:"O valor mnimo deve ser menor ou igual ao valor mximo",path:["max_amount"]});const w_=(t,s,a)=>{if(s==="supply"){if(t>a.max_supply_amount)return{requiresApproval:!0,reason:`Valor excede o limite de suprimento (R$ ${a.max_supply_amount})`}}else if(s==="withdrawal"&&t>a.max_withdrawal_amount)return{requiresApproval:!0,reason:`Valor excede o limite de sangria (R$ ${a.max_withdrawal_amount})`};return{requiresApproval:!1}},zU=(t,s)=>{const a=t-s;return a<0?{isValid:!1,reason:"Saldo insuficiente para realizar a sangria"}:a<Ct.MIN_CASH_BALANCE?{isValid:!1,reason:`A sangria deixaria o caixa abaixo do saldo mnimo recomendado (R$ ${Ct.MIN_CASH_BALANCE})`}:{isValid:!0}},$U=t=>t>=Ct.AUTO_SANGRIA_THRESHOLD?{required:!0,severity:"critical",message:`Caixa com valor muito alto (R$ ${t.toFixed(2)}). Sangria urgente recomendada!`}:t>=Ct.MAX_CASH_IN_REGISTER?{required:!0,severity:"warning",message:`Caixa com valor elevado (R$ ${t.toFixed(2)}). Considere realizar uma sangria.`}:{required:!1,severity:null},LU=t=>DU.safeParse(t),IU=t=>PU.safeParse(t),Om=()=>{const{user:t}=Et(),{fecharComanda:s,recarregarDados:a}=Z2(),{refreshKitchenOrders:r,refreshBarOrders:o}=Tt(),[l,c]=y.useState({currentSession:null,pendingComandas:[],todaysTransactions:[],todaysSessions:[],todaysSummary:{session_date:new Date().toISOString().split("T")[0],total_sessions:0,total_sales:0,total_transactions:0,total_cash_withdrawals:0,total_treasury_transfers:0,cash_balance:0,by_payment_method:[],by_employee:[],discrepancies:[],avg_ticket:0,peak_hours:[]},loading:!0,error:null}),u=y.useCallback(D=>{c(q=>({...q,...D}))},[]),h=y.useCallback((D,q)=>{console.error(`Erro em ${q}:`,D),u({error:`Erro em ${q}: ${D.message||"Erro desconhecido"}`,loading:!1})},[u]),f=y.useCallback(async()=>{if(!t){console.log("useCashManagement: Usurio no encontrado, pulando carregamento");return}try{console.log("useCashManagement: Iniciando carregamento para usurio:",t),u({loading:!0,error:null});const D=new Date().toISOString().split("T")[0];console.log("useCashManagement: Data atual:",D),console.log("useCashManagement: Buscando sesso para usurio ID:",t.id);const{data:q,error:Q}=await V.from("cash_sessions").select("*").eq("employee_id",t.id).eq("status","open").maybeSingle();if(console.log("useCashManagement: Resultado da busca de sesso:",{currentSessionData:q,sessionError:Q}),Q&&Q.code!=="PGRST116")throw console.error("Erro ao carregar sesso:",Q),Q;const{data:K,error:he}=await V.from("comandas").select("*").eq("status","pending_payment").order("opened_at",{ascending:!1});if(he)throw he;console.log(" Buscando TODAS as transaes...");const{data:we,error:_e}=await V.from("cash_transactions").select("id, transaction_type, payment_method, amount, created_at").order("created_at",{ascending:!1}).limit(10);console.log(" ltimas 10 transaes no banco:",(we==null?void 0:we.length)||0),we&&we.length>0&&console.table(we.map(Oe=>({id:Oe.id.slice(-8),tipo:Oe.transaction_type,metodo:Oe.payment_method,valor:Oe.amount,data:new Date(Oe.created_at).toLocaleDateString("pt-BR")}))),console.log(" Buscando transaes para o dia:",D);const Re=gu(D);console.log(" Range de datas para busca:",Re);let ze=[],Ie=null;const{data:Me,error:$e}=await V.from("cash_transactions").select(`
          *,
          comandas(id, customer_name, table_id, total),
          profiles!cash_transactions_processed_by_fkey(id, name),
          cash_sessions(id, session_date, employee_id)
        `).gte("created_at",Re.start).lte("created_at",Re.end).order("created_at",{ascending:!1});if(!$e&&Me&&(ze=Me,console.log(" Transaes encontradas por created_at:",ze.length)),ze.length===0){const{data:Oe,error:Ge}=await V.from("cash_transactions").select(`
            *,
            comandas(id, customer_name, table_id, total),
            profiles!cash_transactions_processed_by_fkey(id, name),
            cash_sessions(id, session_date, employee_id)
          `).gte("processed_at",Re.start).lte("processed_at",Re.end).order("processed_at",{ascending:!1});!Ge&&Oe?(ze=Oe,console.log(" Transaes encontradas por processed_at:",ze.length)):Ie=Ge}if(console.log(" Transaes de hoje encontradas:",(ze==null?void 0:ze.length)||0),ze&&ze.length>0&&(console.log(" Primeira transao de hoje:",ze[0]),console.log(" Mtodos de pagamento de hoje:",[...new Set(ze.map(Oe=>Oe.payment_method))])),Ie)throw console.error(" Erro ao buscar transaes:",Ie),Ie;const{data:Z,error:se}=await V.from("cash_sessions").select("*").eq("session_date",D).order("opened_at",{ascending:!1});if(se)throw se;console.log("Dados da sesso atual:",q),console.log("Usurio atual:",t);const de=q?{...q,employee:{id:t.id,name:t.name||"Usurio",role:t.role||"employee"},supervisor:void 0}:null;console.log("Sesso processada:",de);const Ce=(K==null?void 0:K.map(Oe=>({...Oe,items:[],table:void 0,customer:void 0})))||[],ke=(ze==null?void 0:ze.map(Oe=>({...Oe,comanda:Oe.comandas||void 0,processed_by_employee:Oe.profiles||{id:t.id,name:t.name||"Usurio"},session:Oe.cash_sessions||void 0})))||[],ye=(Z==null?void 0:Z.map(Oe=>({...Oe,employee:{id:t.id,name:t.name||"Usurio",role:"employee"}})))||[],Te=await G(new Date);u({currentSession:de,pendingComandas:Ce,todaysTransactions:ke,todaysSessions:ye,todaysSummary:Te,loading:!1})}catch(D){h(D,"carregamento inicial")}},[t,u,h]),p=y.useCallback(async D=>{try{const q=D||(t==null?void 0:t.id);if(!q)return 0;const{data:Q,error:K}=await V.from("cash_sessions").select("closing_amount, session_date").eq("employee_id",q).eq("status","closed").order("session_date",{ascending:!1}).order("closed_at",{ascending:!1}).limit(1).maybeSingle();return K&&K.code!=="PGRST116"?(console.error("Erro ao buscar ltima sesso fechada:",K),0):(Q==null?void 0:Q.closing_amount)||0}catch(q){return console.error("Erro ao obter saldo da ltima sesso:",q),0}},[t]),g=y.useCallback(async D=>{try{const{data:q,error:Q}=await V.from("cash_sessions").select(`
          *,
          profiles!cash_sessions_employee_id_fkey(id, name, role)
        `).eq("session_date",D).order("opened_at",{ascending:!0});if(Q)throw Q;console.log(" Buscando transaes para movimento do dia:",D);const K=gu(D);console.log(" Range de datas:",K);const{data:he,error:we}=await V.from("cash_transactions").select(`
          *,
          comandas(id, customer_name, table_id, total),
          profiles!cash_transactions_processed_by_fkey(id, name),
          cash_sessions(id, session_date, employee_id)
        `).gte("created_at",K.start).lte("created_at",K.end).order("created_at",{ascending:!0});if(console.log(" Transaes encontradas para movimento:",(he==null?void 0:he.length)||0),we)throw we;const _e=(q==null?void 0:q.map(ye=>({...ye,employee:ye.profiles||{id:ye.employee_id,name:"Usurio",role:"employee"}})))||[],Re=(he==null?void 0:he.map(ye=>({...ye,comanda:ye.comandas||void 0,processed_by_employee:ye.profiles||{id:ye.processed_by,name:"Usurio"},session:ye.cash_sessions||void 0})))||[],ze=_e.reduce((ye,Te)=>ye+(Te.opening_amount||0),0),Ie=_e.reduce((ye,Te)=>ye+(Te.closing_amount||0),0),Me=_e.reduce((ye,Te)=>ye+(Te.cash_discrepancy||0),0),$e=Re.filter(ye=>ye.transaction_type==="sale"),Z=$e.reduce((ye,Te)=>ye+Te.amount,0),se=$e.filter(ye=>ye.payment_method==="dinheiro").reduce((ye,Te)=>ye+Te.amount,0),de=$e.filter(ye=>["cartao_debito","cartao_credito"].includes(ye.payment_method)).reduce((ye,Te)=>ye+Te.amount,0),Ce=$e.filter(ye=>ye.payment_method==="pix").reduce((ye,Te)=>ye+Te.amount,0),ke=Re.filter(ye=>ye.transaction_type==="adjustment").reduce((ye,Te)=>ye+Te.amount,0);return{sessions:_e,transactions:Re,summary:{opening_total:ze,closing_total:Ie,sales_total:Z,cash_sales:se,card_sales:de,pix_sales:Ce,adjustments:ke,discrepancy_total:Me,transaction_count:Re.length}}}catch(q){return console.error("Erro ao obter movimento dirio:",q),{sessions:[],transactions:[],summary:{opening_total:0,closing_total:0,sales_total:0,cash_sales:0,card_sales:0,pix_sales:0,adjustments:0,discrepancy_total:0,transaction_count:0}}}},[]),v=y.useCallback(async D=>{if(!t)throw new Error("Usurio no autenticado");try{console.log("Iniciando abertura de caixa para usurio:",t.id),u({loading:!0,error:null}),console.log("Buscando empresa_id para o usurio...");const{data:q,error:Q}=await V.from("usuarios_empresa").select("empresa_id").eq("user_id",t.id).single();Q&&(console.error("Erro ao buscar empresa do usurio:",Q),console.log("Usando empresa padro..."));const K=(q==null?void 0:q.empresa_id)||"1",he={employee_id:t.id,empresa_id:K,opening_amount:D.opening_amount,opening_notes:D.opening_notes,supervisor_approval_id:D.supervisor_approval_id,status:"open"};console.log("Dados da sesso com empresa_id:",he);const{data:we,error:_e}=await V.from("cash_sessions").insert(he).select("*").single();if(_e)throw console.error("Erro ao inserir sesso:",_e),_e;console.log("Sesso criada com sucesso:",we),await f()}catch(q){throw h(q,"abertura de caixa"),q}},[t,u,h,f]),b=y.useCallback(async D=>{if(!l.currentSession)throw new Error("Nenhuma sesso aberta");try{u({loading:!0,error:null});const q=D.closing_amount-l.currentSession.expected_amount,{error:Q}=await V.from("cash_sessions").update({status:"closed",closed_at:new Date().toISOString(),closing_amount:D.closing_amount,cash_discrepancy:q,closing_notes:D.closing_notes}).eq("id",l.currentSession.id);if(Q)throw Q;const K=D.reconciliation.map(we=>({cash_session_id:l.currentSession.id,payment_method:we.payment_method,expected_amount:we.expected_amount,actual_amount:we.actual_amount,transaction_count:we.transaction_count,reconciled_by:t.id,notes:we.notes})),{error:he}=await V.from("payment_reconciliation").insert(K);if(he)throw he;await f()}catch(q){throw h(q,"fechamento de caixa"),q}},[l.currentSession,t,u,h,f]),_=y.useCallback(()=>l.currentSession,[l.currentSession]),w=y.useCallback(async D=>{if(console.log(" NOVA VERSO - Processando pagamento de comanda..."),console.log(" Sesso atual:",l.currentSession),console.log(" Dados do pagamento:",D),!l.currentSession)throw console.error(" Nenhuma sesso de caixa aberta!"),new Error("Nenhuma sesso de caixa aberta");try{u({loading:!0,error:null});const q=await bt();if(!q)throw new Error("No foi possvel identificar a empresa do usurio");console.log(" Buscando dados da comanda...");const{data:Q,error:K}=await V.from("comandas").select("table_id, total, customer_name").eq("id",D.comanda_id).single();if(K)throw console.error(" Erro ao buscar comanda:",K),K;console.log(" Comanda encontrada:",Q),console.log(" Fechando comanda...");const{error:he}=await V.from("comandas").update({status:"closed",payment_method:D.payment_method,notes:D.notes,updated_at:new Date().toISOString()}).eq("id",D.comanda_id);if(he)throw console.error(" Erro ao fechar comanda:",he),he;if(console.log(" Comanda fechada com sucesso"),Q.table_id){console.log(" Liberando mesa:",Q.table_id);const{error:ze}=await V.from("bar_tables").update({status:"available",current_comanda_id:null,updated_at:new Date().toISOString()}).eq("id",Q.table_id);ze?console.warn(" Erro ao liberar mesa:",ze):console.log(" Mesa liberada com sucesso")}console.log(" Criando transao de pagamento...");const we={cash_session_id:l.currentSession.id,comanda_id:D.comanda_id,transaction_type:"sale",payment_method:D.payment_method,amount:D.amount,processed_by:t.id,reference_number:D.reference_number,customer_name:D.customer_name||Q.customer_name,notes:D.notes,empresa_id:q};console.log(" Dados da transao:",we);const{data:_e,error:Re}=await V.from("cash_transactions").insert(we).select().single();if(Re)throw console.error(" Erro ao inserir transao:",Re),Re;console.log(" Transao criada com sucesso:",_e),await me(D.amount),await f(),await a(),D.notes&&D.notes.includes("balco")&&(console.log(" Forando atualizao dos monitores aps pagamento de balco..."),setTimeout(async()=>{await Promise.all([r(),o()]),console.log(" Monitores atualizados imediatamente!")},500),setTimeout(async()=>{await Promise.all([r(),o()]),console.log(" Atualizao backup dos monitores concluda!")},2e3))}catch(q){throw h(q,"processamento de pagamento"),q}},[l.currentSession,t,s,u,h,f,a]),E=y.useCallback(async D=>{if(!l.currentSession)throw new Error("Nenhuma sesso de caixa aberta");try{u({loading:!0,error:null});const q=await bt();if(!q)throw new Error("No foi possvel identificar a empresa do usurio");const Q={cash_session_id:l.currentSession.id,transaction_type:"refund",payment_method:D.refund_method,amount:-Math.abs(D.amount),processed_by:t.id,notes:`Estorno: ${D.reason}. Transao original: ${D.original_transaction_id}`,empresa_id:q},{error:K}=await V.from("cash_transactions").insert(Q);if(K)throw K;await f()}catch(q){throw h(q,"processamento de estorno"),q}},[l.currentSession,t,u,h,f]),T=y.useCallback(async D=>{if(!l.currentSession)throw new Error("Nenhuma sesso de caixa aberta");try{u({loading:!0,error:null});const q=await bt();if(!q)throw new Error("No foi possvel identificar a empresa do usurio");const Q=D.adjustment_type==="add"?D.amount:-D.amount,K={cash_session_id:l.currentSession.id,transaction_type:"adjustment",payment_method:D.payment_method||"dinheiro",amount:Q,processed_by:t.id,notes:`Ajuste ${D.adjustment_type==="add"?"positivo":"negativo"}: ${D.reason}`,empresa_id:q},{error:he}=await V.from("cash_transactions").insert(K);if(he)throw he;await f()}catch(q){throw h(q,"processamento de ajuste"),q}},[l.currentSession,t,u,h,f]),N=y.useCallback(async D=>{if(!l.currentSession)throw new Error("Nenhuma sesso de caixa aberta");try{u({loading:!0,error:null});const q=await bt();if(!q)throw new Error("No foi possvel identificar a empresa do usurio");const Q={cash_session_id:l.currentSession.id,transaction_type:"adjustment",payment_method:"dinheiro",amount:-Math.abs(D.amount),processed_by:t.id,notes:`[SADA] ${D.purpose}: ${D.reason}. Autorizado por: ${D.authorized_by}${D.recipient?`. Destinatrio: ${D.recipient}`:""}`,empresa_id:q},{data:K,error:he}=await V.from("cash_transactions").insert(Q).select("*").single();if(he)throw he;const we=l.currentSession.expected_amount-D.amount,{error:_e}=await V.from("cash_sessions").update({expected_amount:we}).eq("id",l.currentSession.id);if(_e)throw _e;return await f(),K.id}catch(q){throw h(q,"processamento de sada de dinheiro"),q}},[l.currentSession,t,u,h,f]),k=y.useCallback(async D=>{if(!l.currentSession)throw new Error("Nenhuma sesso de caixa aberta");try{u({loading:!0,error:null});const q=await bt();if(!q)throw new Error("No foi possvel identificar a empresa do usurio");const Q={cash_session_id:l.currentSession.id,transaction_type:"adjustment",payment_method:"dinheiro",amount:-Math.abs(D.amount),processed_by:t.id,notes:`[TRANSFERNCIA TESOURARIA] Autorizado por: ${D.authorized_by}${D.treasury_receipt_number?`. Comprovante: ${D.treasury_receipt_number}`:""}${D.notes?`. Obs: ${D.notes}`:""}`,empresa_id:q},{data:K,error:he}=await V.from("cash_transactions").insert(Q).select("*").single();if(he)throw he;const we=l.currentSession.expected_amount-D.amount,{error:_e}=await V.from("cash_sessions").update({expected_amount:we}).eq("id",l.currentSession.id);if(_e)throw _e;return await f(),K.id}catch(q){throw h(q,"processamento de transferncia para tesouraria"),q}},[l.currentSession,t,u,h,f]),S=y.useCallback(async D=>{if(!l.currentSession)throw new Error("Nenhuma sesso de caixa aberta");try{u({loading:!0,error:null});const q=LU(D);if(!q.success)throw new Error(`Dados invlidos: ${q.error.errors.map(se=>se.message).join(", ")}`);const Q=await bt();if(!Q)throw new Error("No foi possvel identificar a empresa do usurio");const K={max_supply_amount:Ct.MAX_SUPPLY_WITHOUT_APPROVAL,max_withdrawal_amount:Ct.MAX_WITHDRAWAL_WITHOUT_APPROVAL},he=w_(D.amount,"supply",K);if(he.requiresApproval&&!D.authorized_by)throw new Error(he.reason||"Autorizao de supervisor necessria");const we={cash_session_id:l.currentSession.id,movement_type:"supply",amount:D.amount,reason:D.reason,authorized_by:D.authorized_by||t.id,authorization_status:D.authorized_by?"approved":"not_required",purpose:D.purpose,reference_number:D.reference_number,empresa_id:Q},{data:_e,error:Re}=await V.from("cash_movements").insert(we).select("*").single();if(Re)throw Re;const ze={cash_session_id:l.currentSession.id,transaction_type:"adjustment",payment_method:"dinheiro",amount:D.amount,processed_by:t.id,notes:`[SUPRIMENTO] ${D.source} - ${D.reason}${D.notes?` | ${D.notes}`:""}`,reference_number:D.reference_number,empresa_id:Q},{data:Ie,error:Me}=await V.from("cash_transactions").insert(ze).select("*").single();if(Me)throw Me;const $e=l.currentSession.expected_amount+D.amount,{error:Z}=await V.from("cash_sessions").update({expected_amount:$e}).eq("id",l.currentSession.id);if(Z)throw Z;return await V.from("cash_audit_enhanced").insert({cash_session_id:l.currentSession.id,action_type:"cash_supply",performed_by:t.id,new_values:{movement_id:_e.id,amount:D.amount,source:D.source},reason:D.reason,risk_level:D.amount>Ct.SUPERVISOR_APPROVAL_THRESHOLD?"medium":"low",empresa_id:Q}),await f(),_e.id}catch(q){throw h(q,"processamento de suprimento"),q}},[l.currentSession,t,u,h,f]),C=y.useCallback(async D=>{if(!l.currentSession)throw new Error("Nenhuma sesso de caixa aberta");try{u({loading:!0,error:null});const q=IU(D);if(!q.success)throw new Error(`Dados invlidos: ${q.error.errors.map(Ce=>Ce.message).join(", ")}`);const Q=l.currentSession.expected_amount,K=zU(Q,D.amount);if(!K.isValid)throw new Error(K.reason||"Saldo insuficiente");const he={max_supply_amount:Ct.MAX_SUPPLY_WITHOUT_APPROVAL,max_withdrawal_amount:Ct.MAX_WITHDRAWAL_WITHOUT_APPROVAL},we=w_(D.amount,"withdrawal",he);if(we.requiresApproval&&!D.authorized_by)throw new Error(we.reason||"Autorizao de supervisor necessria");const _e=await bt();if(!_e)throw new Error("No foi possvel identificar a empresa do usurio");const Re={cash_session_id:l.currentSession.id,movement_type:"withdrawal",amount:D.amount,reason:D.reason,authorized_by:D.authorized_by||t.id,authorization_status:D.authorized_by?"approved":"not_required",recipient:D.recipient,purpose:D.purpose,reference_number:D.reference_number,empresa_id:_e},{data:ze,error:Ie}=await V.from("cash_movements").insert(Re).select("*").single();if(Ie)throw Ie;const Me={cash_session_id:l.currentSession.id,transaction_type:"adjustment",payment_method:"dinheiro",amount:-Math.abs(D.amount),processed_by:t.id,notes:`[SANGRIA] ${D.destination} - ${D.reason}${D.recipient?` | Destinatrio: ${D.recipient}`:""}${D.notes?` | ${D.notes}`:""}`,reference_number:D.reference_number,empresa_id:_e},{data:$e,error:Z}=await V.from("cash_transactions").insert(Me).select("*").single();if(Z)throw Z;const se=l.currentSession.expected_amount-D.amount,{error:de}=await V.from("cash_sessions").update({expected_amount:se}).eq("id",l.currentSession.id);if(de)throw de;return await V.from("cash_audit_enhanced").insert({cash_session_id:l.currentSession.id,action_type:"cash_withdrawal",performed_by:t.id,new_values:{movement_id:ze.id,amount:D.amount,destination:D.destination},reason:D.reason,risk_level:D.amount>Ct.SUPERVISOR_APPROVAL_THRESHOLD?"high":"medium",empresa_id:_e}),await f(),ze.id}catch(q){throw h(q,"processamento de sangria"),q}},[l.currentSession,t,u,h,f]),M=y.useCallback(async D=>{var q;try{const Q=D||((q=l.currentSession)==null?void 0:q.id);if(!Q)return[];const{data:K,error:he}=await V.from("cash_movements").select(`
          *,
          cash_sessions(id, session_date, employee_id),
          authorized_by_profile:profiles!cash_movements_authorized_by_fkey(id, name, role)
        `).eq("cash_session_id",Q).order("created_at",{ascending:!1});if(he)throw he;return(K==null?void 0:K.map(we=>({...we,session:we.cash_sessions,authorized_by_employee:we.authorized_by_profile})))||[]}catch(Q){return console.error("Erro ao buscar movimentaes:",Q),[]}},[l.currentSession]),z=y.useCallback(async()=>{if(!l.currentSession)return[];const D=[],q=l.currentSession.expected_amount,Q=$U(q);return Q.required&&D.push({id:`alert-${Date.now()}`,alert_type:"high_cash_amount",severity:Q.severity==="critical"?"critical":"high",message:Q.message||"Sangria recomendada",cash_session_id:l.currentSession.id,threshold_value:Q.severity==="critical"?Ct.AUTO_SANGRIA_THRESHOLD:Ct.MAX_CASH_IN_REGISTER,current_value:q,created_at:new Date().toISOString(),acknowledged:!1}),q<Ct.MIN_CASH_BALANCE&&D.push({id:`alert-low-${Date.now()}`,alert_type:"high_cash_amount",severity:"medium",message:`Saldo baixo no caixa (R$ ${q.toFixed(2)}). Considere um suprimento.`,cash_session_id:l.currentSession.id,threshold_value:Ct.MIN_CASH_BALANCE,current_value:q,created_at:new Date().toISOString(),acknowledged:!1}),D},[l.currentSession]),A=y.useCallback(async D=>{var q,Q;try{const{data:K,error:he}=await V.from("cash_movements").select(`
          *,
          cash_sessions(session_date, opening_amount, expected_amount),
          authorized_by_profile:profiles!cash_movements_authorized_by_fkey(name),
          created_by_profile:profiles(name)
        `).eq("id",D).single();if(he)throw he;if(!K)return null;const we=`MOV-${K.created_at.split("T")[0].replace(/-/g,"")}-${D.slice(-6).toUpperCase()}`;return{movement_id:K.id,receipt_number:we,movement_type:K.movement_type,amount:K.amount,date:new Date(K.created_at).toLocaleDateString("pt-BR"),time:new Date(K.created_at).toLocaleTimeString("pt-BR"),employee_name:((q=K.created_by_profile)==null?void 0:q.name)||"Desconhecido",authorized_by_name:(Q=K.authorized_by_profile)==null?void 0:Q.name,reason:K.reason,purpose:K.purpose,session_info:{session_date:K.cash_sessions.session_date,opening_amount:K.cash_sessions.opening_amount,current_balance:K.cash_sessions.expected_amount},signature_required:K.amount>Ct.SUPERVISOR_APPROVAL_THRESHOLD}}catch(K){return console.error("Erro ao gerar comprovante:",K),null}},[]),$=y.useCallback(async(D,q)=>{try{const{data:Q,error:K}=await V.from("cash_movements").select(`
          *,
          cash_sessions(employee_id),
          profiles(name)
        `).gte("created_at",D).lte("created_at",q);if(K)throw K;const he=(Q==null?void 0:Q.filter(Me=>Me.movement_type==="supply"))||[],we=(Q==null?void 0:Q.filter(Me=>Me.movement_type==="withdrawal"))||[],_e=he.reduce((Me,$e)=>Me+$e.amount,0),Re=we.reduce((Me,$e)=>Me+$e.amount,0),ze=(Q==null?void 0:Q.reduce((Me,$e)=>{const Z=Me.find(se=>se.purpose===$e.purpose);return Z?(Z.total_amount+=$e.amount,Z.count+=1):Me.push({purpose:$e.purpose,total_amount:$e.amount,count:1}),Me},[]))||[],Ie=(Q==null?void 0:Q.reduce((Me,$e)=>{var de,Ce;const Z=(de=$e.cash_sessions)==null?void 0:de.employee_id,se=Me.find(ke=>ke.employee_id===Z);return se?(se.total_movements+=1,se.total_amount+=Math.abs($e.amount)):Me.push({employee_id:Z,employee_name:((Ce=$e.profiles)==null?void 0:Ce.name)||"Desconhecido",total_movements:1,total_amount:Math.abs($e.amount)}),Me},[]))||[];return{period:{start:D,end:q},total_supplies:_e,total_withdrawals:Re,net_movement:_e-Re,movement_count:(Q==null?void 0:Q.length)||0,by_purpose:ze,by_employee:Ie,alerts_generated:0,pending_authorizations:(Q==null?void 0:Q.filter(Me=>Me.authorization_status==="pending").length)||0}}catch(Q){throw console.error("Erro ao gerar resumo de movimentaes:",Q),Q}},[]),P=y.useCallback(async D=>{try{const{data:q,error:Q}=await V.from("cash_transactions").select("*").eq("cash_session_id",D).in("transaction_type",["sale","refund","adjustment"]);if(Q)throw Q;const K={dinheiro:{payment_method:"dinheiro",expected_amount:0,actual_amount:0,transaction_count:0,discrepancy:0,discrepancy_percentage:0,transactions:[]},cartao_debito:{payment_method:"cartao_debito",expected_amount:0,actual_amount:0,transaction_count:0,discrepancy:0,discrepancy_percentage:0,transactions:[]},cartao_credito:{payment_method:"cartao_credito",expected_amount:0,actual_amount:0,transaction_count:0,discrepancy:0,discrepancy_percentage:0,transactions:[]},pix:{payment_method:"pix",expected_amount:0,actual_amount:0,transaction_count:0,discrepancy:0,discrepancy_percentage:0,transactions:[]},transferencia:{payment_method:"transferencia",expected_amount:0,actual_amount:0,transaction_count:0,discrepancy:0,discrepancy_percentage:0,transactions:[]}};return q==null||q.forEach(he=>{const we=he.payment_method;K[we]&&(K[we].expected_amount+=he.amount,K[we].transaction_count+=1,K[we].transactions.push(he))}),Object.values(K)}catch(q){return console.error("Erro ao calcular breakdown de pagamentos:",q),[]}},[]),F=y.useCallback(async(D,q)=>{try{const Q=l.todaysSessions.find(ze=>ze.id===D)||l.currentSession;if(!Q)return{valid:!1,discrepancy:0,requires_approval:!1,expected_amount:0,closing_amount:q,warnings:[],errors:["Sesso no encontrada"]};if(Q.status!=="open")return{valid:!1,discrepancy:0,requires_approval:!1,expected_amount:Q.expected_amount,closing_amount:q,warnings:[],errors:["Sesso j est fechada"]};const K=q-Q.expected_amount,he=Q.expected_amount>0?Math.abs(K/Q.expected_amount*100):0,we=Math.abs(K)>Ct.MAX_DISCREPANCY_WITHOUT_APPROVAL,_e=[],Re=[];return Math.abs(K)>Ct.MAX_DISCREPANCY_AUTO_ACCEPT&&_e.push(`Discrepncia de ${Pe(Math.abs(K))} detectada`),he>Ct.MAX_DISCREPANCY_PERCENTAGE&&_e.push(`Discrepncia de ${he.toFixed(2)}% excede o limite de ${Ct.MAX_DISCREPANCY_PERCENTAGE}%`),we&&_e.push("Aprovao de supervisor necessria"),{valid:Re.length===0,discrepancy:K,requires_approval:we,expected_amount:Q.expected_amount,closing_amount:q,warnings:_e,errors:Re}}catch(Q){return console.error("Erro ao validar fechamento:",Q),{valid:!1,discrepancy:0,requires_approval:!1,expected_amount:0,closing_amount:q,warnings:[],errors:["Erro ao validar fechamento"]}}},[l.currentSession,l.todaysSessions]),I=y.useCallback(async(D,q)=>{try{const Q=await bt();if(!Q)throw new Error("No foi possvel identificar a empresa do usurio");const{data:K,error:he}=await V.from("treasury_transfers").insert({cash_session_id:D,amount:q.amount,transferred_at:q.transferred_at||new Date().toISOString(),authorized_by:q.authorized_by,recipient_name:q.recipient_name,destination:q.destination,receipt_number:q.receipt_number,notes:q.notes,empresa_id:Q}).select("id").single();if(he)throw he;return await V.from("cash_audit_enhanced").insert({cash_session_id:D,action_type:"treasury_transfer",performed_by:t.id,new_values:q,reason:`Transferncia para ${q.destination}`,risk_level:q.amount>1e3?"medium":"low",empresa_id:Q}),K.id}catch(Q){throw console.error("Erro ao registrar transferncia:",Q),Q}},[t]),J=y.useCallback(async(D,q)=>{try{const Q=await bt();if(!Q)throw new Error("No foi possvel identificar a empresa do usurio");const{data:K,error:he}=await V.from("discrepancy_handling").insert({cash_session_id:D,discrepancy_amount:q.discrepancy_amount,reason:q.reason,action_taken:q.action_taken,approved_by:q.approved_by,resolution_notes:q.resolution_notes,resolved_at:q.action_taken!=="pending"?new Date().toISOString():null,empresa_id:Q}).select("id").single();if(he)throw he;return await V.from("cash_audit_enhanced").insert({cash_session_id:D,action_type:"discrepancy_handling",performed_by:t.id,new_values:q,reason:q.reason,risk_level:Math.abs(q.discrepancy_amount)>50?"high":"medium",empresa_id:Q}),K.id}catch(Q){throw console.error("Erro ao registrar discrepncia:",Q),Q}},[t]),pe=y.useCallback(async D=>{var q,Q;try{const K=await bt();if(!K)throw new Error("No foi possvel identificar a empresa do usurio");const{data:he,error:we}=await V.from("cash_sessions").select(`
          *,
          employee:profiles!cash_sessions_employee_id_fkey(id, name),
          supervisor:profiles!cash_sessions_supervisor_approval_id_fkey(id, name)
        `).eq("id",D).single();if(we)throw we;const _e=await P(D),{data:Re}=await V.from("payment_reconciliation").select("*").eq("cash_session_id",D),ze=_e.map(de=>{const Ce=Re==null?void 0:Re.find(ke=>ke.payment_method===de.payment_method);return{...de,actual_amount:(Ce==null?void 0:Ce.actual_amount)||0,discrepancy:((Ce==null?void 0:Ce.actual_amount)||0)-de.expected_amount,discrepancy_percentage:de.expected_amount>0?(((Ce==null?void 0:Ce.actual_amount)||0)-de.expected_amount)/de.expected_amount*100:0}}),{data:Ie}=await V.from("treasury_transfers").select("*").eq("cash_session_id",D).maybeSingle(),{data:Me}=await V.from("discrepancy_handling").select(`
          *,
          approved_by_profile:profiles!discrepancy_handling_approved_by_fkey(name)
        `).eq("cash_session_id",D).maybeSingle(),{data:$e}=await V.rpc("generate_closing_receipt_number"),Z=$e||`FECH-${Date.now()}`,se={id:D,session_id:D,receipt_number:Z,closing_date:new Date(he.closed_at).toLocaleDateString("pt-BR"),closing_time:new Date(he.closed_at).toLocaleTimeString("pt-BR"),employee_name:((q=he.employee)==null?void 0:q.name)||"Desconhecido",employee_id:he.employee_id,opening_amount:he.opening_amount,closing_amount:he.closing_amount,expected_amount:he.expected_amount,total_sales:ze.reduce((de,Ce)=>de+Ce.expected_amount,0),cash_discrepancy:he.cash_discrepancy||0,payment_breakdown:ze,treasury_transfer:Ie?{amount:Ie.amount,destination:Ie.destination,receipt_number:Ie.receipt_number,recipient_name:Ie.recipient_name}:void 0,discrepancy_handling:Me?{reason:Me.reason,action_taken:Me.action_taken,approved_by_name:(Q=Me.approved_by_profile)==null?void 0:Q.name}:void 0,supervisor_approval:he.supervisor?{name:he.supervisor.name,approved_at:he.closed_at}:void 0,generated_at:new Date().toISOString()};return await V.from("cash_closing_receipts").insert({cash_session_id:D,receipt_number:Z,receipt_data:se,generated_by:t.id,empresa_id:K}),se}catch(K){throw console.error("Erro ao gerar comprovante:",K),K}},[t,P]),te=y.useCallback(async(D,q)=>{try{console.log(" Registrando movimentao diria...");const Q={};q.reconciliation.forEach(_e=>{Q[_e.payment_method]={expected:_e.expected_amount,actual:_e.actual_amount,count:_e.transaction_count}});const K=q.treasury_transfer?[{amount:q.treasury_transfer.amount,payment_method:"dinheiro",destination:q.treasury_transfer.destination,received_by_name:q.treasury_transfer.recipient_name,receipt_number:q.treasury_transfer.receipt_number,notes:q.treasury_transfer.notes}]:null,{data:he,error:we}=await V.rpc("register_cash_closing",{p_session_id:D,p_employee_id:t.id,p_payment_breakdown:Q,p_total_expected:q.reconciliation.reduce((_e,Re)=>_e+Re.expected_amount,0),p_total_actual:q.reconciliation.reduce((_e,Re)=>_e+Re.actual_amount,0),p_transfers:K,p_notes:q.closing_notes});if(we)throw console.error(" Erro ao registrar movimentao diria:",we),we;console.log(" Movimentao diria registrada com sucesso:",he)}catch(Q){throw console.error("Erro ao registrar movimentao diria:",Q),Q}},[t]),L=y.useCallback(async D=>{var q,Q,K;if(!l.currentSession)throw new Error("Nenhuma sesso aberta");try{u({loading:!0,error:null});const he=await F(l.currentSession.id,D.closing_amount);if(!he.valid)throw new Error(`Validao falhou: ${he.errors.join(", ")}`);if(he.requires_approval&&!((q=D.discrepancy_handling)!=null&&q.approved_by))throw new Error("Discrepncia requer aprovao de supervisor");const we=await bt();if(!we)throw new Error("No foi possvel identificar a empresa do usurio");const{error:_e}=await V.from("cash_sessions").update({status:"closed",closed_at:new Date().toISOString(),closing_amount:D.closing_amount,cash_discrepancy:he.discrepancy,closing_notes:D.closing_notes,supervisor_approval_id:(Q=D.discrepancy_handling)==null?void 0:Q.approved_by}).eq("id",l.currentSession.id);if(_e)throw _e;const Re=D.reconciliation.map(Me=>({cash_session_id:l.currentSession.id,payment_method:Me.payment_method,expected_amount:Me.expected_amount,actual_amount:Me.actual_amount,transaction_count:Me.transaction_count,reconciled_by:t.id,notes:Me.notes})),{error:ze}=await V.from("payment_reconciliation").insert(Re);if(ze)throw ze;if(D.treasury_transfer)try{await I(l.currentSession.id,D.treasury_transfer)}catch(Me){console.warn(" Erro ao registrar transferncia (tabela pode no existir):",Me)}try{await te(l.currentSession.id,D)}catch(Me){console.warn(" Erro ao registrar movimentao diria:",Me)}if(D.discrepancy_handling&&Math.abs(he.discrepancy)>.01)try{await J(l.currentSession.id,{...D.discrepancy_handling,discrepancy_amount:he.discrepancy})}catch(Me){console.warn(" Erro ao registrar discrepncia (tabela pode no existir):",Me)}let Ie;try{Ie=await pe(l.currentSession.id)}catch(Me){console.warn(" Erro ao gerar comprovante (tabela pode no existir):",Me),Ie={id:l.currentSession.id,receipt_number:`FECH-${new Date().toISOString().split("T")[0]}-TEMP`,session_id:l.currentSession.id,closing_date:new Date().toISOString().split("T")[0],closing_time:new Date().toLocaleTimeString("pt-BR"),employee_name:((K=session==null?void 0:session.employee)==null?void 0:K.name)||"Desconhecido",opening_amount:(session==null?void 0:session.opening_amount)||0,closing_amount:D.closing_amount,total_sales:he.expected_amount,cash_discrepancy:he.discrepancy,payment_breakdown:[],generated_at:new Date().toISOString()}}return await V.from("cash_audit_enhanced").insert({cash_session_id:l.currentSession.id,action_type:"close_session",performed_by:t.id,new_values:{closing_amount:D.closing_amount,discrepancy:he.discrepancy,treasury_transfer:D.treasury_transfer,discrepancy_handling:D.discrepancy_handling},reason:D.closing_notes||"Fechamento de caixa",risk_level:he.requires_approval?"high":"low",empresa_id:we}),await f(),Ie}catch(he){throw h(he,"fechamento aprimorado de caixa"),he}},[l.currentSession,t,u,h,f,F,I,J,pe]),G=y.useCallback(async D=>{const Q=(D||new Date).toISOString().split("T")[0];try{console.log(" Gerando resumo para o dia:",Q);let K=[];const he=gu(Q);console.log(" Range de datas para resumo:",he);const{data:we,error:_e}=await V.from("cash_transactions").select(`
          *,
          comandas(id, customer_name, table_id, total),
          profiles!cash_transactions_processed_by_fkey(id, name),
          cash_sessions(id, session_date, employee_id)
        `).gte("created_at",he.start).lte("created_at",he.end);if(!_e&&we&&(K=we,console.log(" Resumo: transaes por created_at:",K.length)),K.length===0){const{data:Ue,error:W}=await V.from("cash_transactions").select(`
            *,
            comandas(id, customer_name, table_id, total),
            profiles!cash_transactions_processed_by_fkey(id, name),
            cash_sessions(id, session_date, employee_id)
          `).gte("processed_at",he.start).lte("processed_at",he.end);!W&&Ue&&(K=Ue,console.log(" Resumo: transaes por processed_at:",K.length))}const Re=null;console.log(" TODAS as transaes encontradas:",(K==null?void 0:K.length)||0);const ze=(K==null?void 0:K.filter(Ue=>Ue.transaction_type==="sale"))||[];console.log(" Transaes de venda:",ze.length),K&&K.length>0&&(console.log(" Tipos de transao encontrados:",[...new Set(K.map(Ue=>Ue.transaction_type))]),console.log(" Mtodos de pagamento encontrados:",[...new Set(K.map(Ue=>Ue.payment_method))]),console.log(" Primeira transao:",K[0]));const{data:Ie,error:Me}=await V.from("cash_sessions").select(`
          *,
          profiles!cash_sessions_employee_id_fkey(id, name, role)
        `).eq("session_date",Q);if(Me)throw console.error("Erro ao buscar sesses para resumo:",Me),Me;const $e=ze||[],Z=Ie||[];console.log(" Iniciando clculo de totais..."),console.log(" Transaes para calcular:",$e.length);const se={};$e.forEach((Ue,W)=>{const re=Ue.payment_method||"desconhecido",Ee=Number(Ue.amount)||0;console.log(` [${W+1}] ${re}: R$ ${Ee}`),se[re]||(se[re]={amount:0,count:0}),se[re].amount+=Ee,se[re].count+=1}),console.log(" Totais finais por mtodo:",se);const de=$e.reduce((Ue,W)=>Ue+W.amount,0),Ce=$e.length;console.log(" Criando array de mtodos de pagamento...");const ye=["dinheiro","cartao_debito","cartao_credito","pix","transferencia"].map(Ue=>{const W=se[Ue]||{amount:0,count:0},re=de>0?W.amount/de*100:0;return console.log(` ${Ue}: R$ ${W.amount} (${W.count} transaes) - ${re.toFixed(1)}%`),{payment_method:Ue,amount:W.amount,transaction_count:W.count,percentage:re,expected_amount:W.amount,actual_amount:W.amount,discrepancy:0}});console.log(" Array de mtodos criado:",ye);const Te=$e.reduce((Ue,W)=>{var Le;const re=W.processed_by,Ee=((Le=W.profiles)==null?void 0:Le.name)||"Funcionrio";return Ue[re]||(Ue[re]={employee_id:re,employee_name:Ee,session_count:0,total_sales:0,transaction_count:0,avg_ticket:0,cash_discrepancy:0,session_duration:"8:00"}),Ue[re].total_sales+=W.amount,Ue[re].transaction_count+=1,Ue},{});Object.values(Te).forEach(Ue=>{Ue.avg_ticket=Ue.transaction_count>0?Ue.total_sales/Ue.transaction_count:0});const Oe=gu(Q),{data:Ge}=await V.from("cash_transactions").select("amount, notes, transaction_type").gte("created_at",Oe.start).lte("created_at",Oe.end).in("transaction_type",["adjustment","refund"]),Je=(Ge||[]).filter(Ue=>{var W;return(W=Ue.notes)==null?void 0:W.includes("[SADA]")}).reduce((Ue,W)=>Ue+Math.abs(W.amount),0),rs=(Ge||[]).filter(Ue=>{var W;return(W=Ue.notes)==null?void 0:W.includes("[TRANSFERNCIA TESOURARIA]")}).reduce((Ue,W)=>Ue+Math.abs(W.amount),0);return{session_date:Q,total_sessions:Z.length,total_sales:de,total_transactions:Ce,total_cash_withdrawals:Je,total_treasury_transfers:rs,cash_balance:de-Je-rs,by_payment_method:ye,by_employee:Object.values(Te),discrepancies:Z.filter(Ue=>Math.abs(Ue.cash_discrepancy||0)>0).map(Ue=>{var W;return{employee_id:Ue.employee_id,employee_name:((W=Ue.profiles)==null?void 0:W.name)||"Funcionrio",session_id:Ue.id,cash_discrepancy:Ue.cash_discrepancy||0,payment_discrepancies:[],total_discrepancy:Ue.cash_discrepancy||0}}),avg_ticket:Ce>0?de/Ce:0,peak_hours:[]}}catch(K){throw console.error("Erro ao gerar resumo dirio:",K),K}},[]),ee=y.useCallback(async D=>G(D),[G]),xe=y.useCallback(async D=>{throw new Error("Relatrio mensal ainda no implementado")},[]),O=y.useCallback(async(D,q)=>{throw new Error("Relatrio de performance ainda no implementado")},[]),H=y.useCallback(async D=>{if(!l.currentSession)return{isValid:!1,warnings:[],errors:[{type:"invalid_state",message:"Nenhuma sesso ativa"}],suggestions:["Abra uma sesso de caixa primeiro"]};const q=D-l.currentSession.expected_amount,Q=Math.abs(q/l.currentSession.expected_amount)*100,K=[],he=[],we=[];return Math.abs(q)>10&&(K.push({type:"discrepancy",message:`Discrepncia alta: R$ ${q.toFixed(2)}`,severity:"high",data:{discrepancy:q,percentage:Q}}),we.push("Recontagem recomendada")),{isValid:Math.abs(q)<=5,warnings:K,errors:he,suggestions:we}},[l.currentSession]),B=y.useCallback(async D=>({isValid:!0,warnings:[],errors:[],suggestions:[]}),[]),Y=y.useCallback(async()=>{await f()},[f]),ne=y.useCallback(async(D,q)=>{throw new Error("Exportao de relatrios ainda no implementada")},[]),ie=y.useCallback(async D=>{try{let q=V.from("cash_transactions").select(`
          *,
          comandas(id, customer_name, table_id, total),
          profiles!cash_transactions_processed_by_fkey(id, name),
          cash_sessions(id, session_date, employee_id)
        `);D.start_date&&(q=q.gte("processed_at",D.start_date)),D.end_date&&(q=q.lte("processed_at",D.end_date)),D.payment_method&&(q=q.eq("payment_method",D.payment_method)),D.transaction_type&&(q=q.eq("transaction_type",D.transaction_type)),D.employee_id&&(q=q.eq("processed_by",D.employee_id)),D.session_id&&(q=q.eq("cash_session_id",D.session_id)),D.min_amount&&(q=q.gte("amount",D.min_amount)),D.max_amount&&(q=q.lte("amount",D.max_amount));const{data:Q,error:K}=await q.order("processed_at",{ascending:!1});if(K)throw K;return(Q==null?void 0:Q.map(he=>({...he,comanda:he.comandas||void 0,processed_by_employee:he.profiles||void 0,session:he.cash_sessions||void 0})))||[]}catch(q){throw console.error("Erro na busca de transaes:",q),q}},[]),oe=y.useCallback(async D=>{try{let q=V.from("cash_sessions").select(`
          *,
          profiles!cash_sessions_employee_id_fkey(id, name, role)
        `);D.start_date&&(q=q.gte("session_date",D.start_date)),D.end_date&&(q=q.lte("session_date",D.end_date)),D.employee_id&&(q=q.eq("employee_id",D.employee_id)),D.status&&(q=q.eq("status",D.status)),D.has_discrepancy&&(q=q.neq("cash_discrepancy",0));const{data:Q,error:K}=await q.order("session_date",{ascending:!1});if(K)throw K;return(Q==null?void 0:Q.map(he=>({...he,employee:he.profiles||void 0})))||[]}catch(q){throw console.error("Erro na busca de sesses:",q),q}},[]),me=y.useCallback(async D=>{if(t)try{const q=new Date().toISOString().split("T")[0],{error:Q}=await V.rpc("atualizar_metricas_venda",{p_employee_id:t.id,p_date:q,p_sale_amount:D});Q&&console.warn("Erro ao atualizar mtricas:",Q)}catch(q){console.warn("Erro ao atualizar mtricas:",q)}},[t]);return y.useEffect(()=>{f()},[f]),y.useEffect(()=>{if(!t)return;const D=[],q=V.channel("cash-sessions-changes").on("postgres_changes",{event:"*",schema:"public",table:"cash_sessions"},he=>{console.log("Mudana em sesses de caixa:",he),f()}).subscribe();D.push(q);const Q=V.channel("cash-transactions-changes").on("postgres_changes",{event:"*",schema:"public",table:"cash_transactions"},he=>{console.log("Mudana em transaes:",he),f()}).subscribe();D.push(Q);const K=V.channel("comandas-changes").on("postgres_changes",{event:"*",schema:"public",table:"comandas"},he=>{console.log("Mudana em comandas:",he),f()}).subscribe();return D.push(K),()=>{D.forEach(he=>{V.removeChannel(he)})}},[t,f]),{...l,openCashSession:v,closeCashSession:b,getCurrentSession:_,processComandaPayment:w,processRefund:E,processAdjustment:T,processCashWithdrawal:N,processTreasuryTransfer:k,processCashSupply:S,processCashWithdrawalAdvanced:C,getCashMovements:M,checkCashAlerts:z,generateMovementReceipt:A,getCashMovementSummary:$,calculatePaymentBreakdown:P,validateCashClosing:F,registerTreasuryTransfer:I,registerDiscrepancyHandling:J,generateClosingReceipt:pe,closeCashSessionEnhanced:L,getDailySummary:ee,getMonthlyCashReport:xe,getEmployeePerformance:O,validateCashCount:H,validateSession:B,refreshData:Y,exportReport:ne,searchTransactions:ie,searchSessions:oe,getLastClosedSessionBalance:p,getDailyCashMovement:g}},UU=({isOpen:t,onClose:s,onOpenCash:a,getLastClosedSessionBalance:r})=>{const[o,l]=y.useState({opening_amount:0,opening_notes:""}),[c,u]=y.useState(!1),[h,f]=y.useState(null),[p,g]=y.useState(!1);y.useEffect(()=>{(async()=>{if(t&&r){g(!0);try{const w=await r();f(w),w>0&&o.opening_amount===0&&l(E=>({...E,opening_amount:w}))}catch(w){console.error("Erro ao carregar saldo da ltima sesso:",w)}finally{g(!1)}}})()},[t,r,o.opening_amount]);const v=()=>{h!==null&&l(_=>({..._,opening_amount:h}))},b=async _=>{_.preventDefault(),u(!0);try{await a(o),s(),l({opening_amount:0,opening_notes:""})}catch(w){console.error("Erro ao abrir caixa:",w)}finally{u(!1)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-green-100 p-2 rounded-lg",children:e.jsx(kt,{className:"h-6 w-6 text-green-600"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Abrir Caixa"})]}),e.jsx("button",{onClick:s,disabled:c,className:"text-gray-400 hover:text-gray-600","aria-label":"Fechar modal",children:e.jsx(lt,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[h!==null&&h>0&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Vt,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Saldo da ltima sesso fechada"}),e.jsxs("p",{className:"text-lg font-bold text-blue-700",children:["R$ ",h.toFixed(2)]}),e.jsx("button",{type:"button",onClick:v,className:"mt-2 text-sm text-blue-600 hover:text-blue-800 underline",disabled:c,children:"Usar este valor como abertura"})]})]})}),p&&e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center",children:e.jsxs("div",{className:"inline-flex items-center space-x-2 text-gray-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600"}),e.jsx("span",{className:"text-sm",children:"Carregando histrico..."})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Valor Inicial (R$) *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:o.opening_amount,onChange:_=>l(w=>({...w,opening_amount:parseFloat(_.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-green-500",required:!0,disabled:c,"aria-label":"Valor inicial em reais"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observaes"}),e.jsx("textarea",{value:o.opening_notes||"",onChange:_=>l(w=>({...w,opening_notes:_.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Observaes sobre a abertura do caixa...",disabled:c})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,disabled:c,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:c,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:c?"Abrindo...":"Abrir Caixa"})]})]})]})}):null},BU=({isOpen:t,onClose:s,session:a})=>{var xe;const{preparingOrders:r,readyOrders:o}=Cm(),{closeCashSessionEnhanced:l}=Om(),{user:c}=Et(),[u,h]=y.useState("reconciliation"),[f,p]=y.useState({closing_amount:a.expected_amount,closing_notes:"",reconciliation:[{payment_method:"dinheiro",expected_amount:0,actual_amount:0,transaction_count:0},{payment_method:"cartao_debito",expected_amount:0,actual_amount:0,transaction_count:0},{payment_method:"cartao_credito",expected_amount:0,actual_amount:0,transaction_count:0},{payment_method:"pix",expected_amount:0,actual_amount:0,transaction_count:0},{payment_method:"transferencia",expected_amount:0,actual_amount:0,transaction_count:0}]}),[g,v]=y.useState(!1),[b,_]=y.useState({amount:0,transferred_at:new Date().toISOString(),authorized_by:(c==null?void 0:c.id)||"",destination:"cofre",notes:""}),[w,E]=y.useState(!1),[T,N]=y.useState([]),[k,S]=y.useState(!1),[C,M]=y.useState(!1);y.useEffect(()=>{t&&a&&(z(),A())},[t,a]);const z=async()=>{M(!0);try{console.log(" Carregando breakdown para sesso:",a.id);const{data:O,error:H}=await V.from("cash_transactions").select("*").eq("cash_session_id",a.id);if(H)throw console.error(" Erro ao buscar transaes:",H),H;console.log(" Transaes encontradas:",(O==null?void 0:O.length)||0),console.log(" Transaes:",O),O&&O.length>0&&(console.log(" Tipos de transao:",[...new Set(O.map(Y=>Y.transaction_type))]),console.log(" Mtodos de pagamento:",[...new Set(O.map(Y=>Y.payment_method))]));const B={dinheiro:{expected_amount:a.opening_amount,transaction_count:0},cartao_debito:{expected_amount:0,transaction_count:0},cartao_credito:{expected_amount:0,transaction_count:0},pix:{expected_amount:0,transaction_count:0},transferencia:{expected_amount:0,transaction_count:0}};O==null||O.forEach(Y=>{if(Y.transaction_type!=="sale"){console.log(" Ignorando transao no-venda:",Y.transaction_type);return}const ne=Y.payment_method,ie=Number(Y.amount)||0;console.log(` Processando: ${ne} = R$ ${ie.toFixed(2)}`),B[ne]&&(B[ne].expected_amount+=ie,B[ne].transaction_count+=1)}),console.log(" Breakdown calculado:",B),console.log(" Dinheiro esperado:",B.dinheiro.expected_amount),console.log(" Carto Dbito esperado:",B.cartao_debito.expected_amount),console.log(" PIX esperado:",B.pix.expected_amount),p(Y=>({...Y,closing_amount:a.expected_amount,reconciliation:Object.entries(B).map(([ne,ie])=>({payment_method:ne,expected_amount:ie.expected_amount,actual_amount:0,transaction_count:ie.transaction_count}))}))}catch(O){console.error(" Erro ao carregar breakdown de pagamentos:",O)}finally{M(!1)}},A=async()=>{S(!0);try{const{data:O,error:H}=await V.from("comanda_items").select(`
          *,
          comanda:comandas!inner(
            id,
            customer_name,
            table_id,
            employee_id,
            bar_tables(number)
          ),
          menu_item:menu_items(name)
        `).in("status",["pending","preparing","ready"]).eq("comanda.status","open").eq("comanda.employee_id",a.employee_id).order("added_at",{ascending:!0});H?(console.error("Erro ao carregar itens pendentes:",H),N([])):N(O||[])}catch(O){console.error("Erro ao validar pedidos pendentes:",O),N([])}finally{S(!1)}},$=async O=>{O.preventDefault();const H=await P();if(H.length>0){alert(` No  possvel fechar o caixa:

${H.join(`
`)}`);return}const B=f.reconciliation.find(ne=>ne.payment_method==="dinheiro"),Y=(B==null?void 0:B.actual_amount)||0;if(Y>0&&!g){alert(` Transferncia obrigatria!

Existe R$ ${Pe(Y)} em dinheiro no caixa.

Voc deve transferir o dinheiro para o cofre/tesouraria antes de fechar o caixa.`),h("transfer");return}if(g&&b.amount!==Y){alert(` Valor de transferncia incorreto!

Dinheiro no caixa: ${Pe(Y)}
Valor a transferir: ${Pe(b.amount)}

O valor da transferncia deve ser igual ao saldo em dinheiro.`),h("transfer");return}if(g&&Y>0&&!b.recipient_name){alert(" Informe o nome do responsvel que recebeu o dinheiro."),h("transfer");return}E(!0);try{const ne={...f,treasury_transfer:g?b:void 0,discrepancy_handling:I()},ie=await l(ne);F(ie,ne),alert(` Caixa fechado com sucesso!

Comprovante: ${ie.receipt_number}`),s()}catch(ne){console.error("Erro ao fechar caixa:",ne),alert(` Erro ao fechar caixa: ${ne.message}`)}finally{E(!1)}},P=async()=>{const O=[];try{const{data:H,error:B}=await V.from("comandas").select("id, customer_name, table_id, bar_tables(number)").eq("status","open").eq("employee_id",a.employee_id);if(B)throw B;if(H&&H.length>0&&(O.push(` ${H.length} comanda(s) ainda aberta(s):`),H.slice(0,5).forEach(ie=>{const oe=ie.bar_tables?`Mesa ${ie.bar_tables.number}`:"Balco";O.push(`    ${oe} - ${ie.customer_name||"Sem nome"}`)}),H.length>5&&O.push(`   ... e mais ${H.length-5} comanda(s)`)),H&&H.length>0){const ie=H.filter(oe=>oe.table_id).map(oe=>oe.table_id);if(ie.length>0){const{data:oe,error:me}=await V.from("bar_tables").select("id, number").in("id",ie).eq("status","occupied");if(me)throw me;oe&&oe.length>0&&(O.push(` ${oe.length} mesa(s) com comandas suas ainda ocupada(s):`),oe.slice(0,5).forEach(D=>{O.push(`    Mesa ${D.number}`)}))}}const{data:Y,error:ne}=await V.from("balcao_orders").select("id, order_number, status, employee_id").in("status",["pending","preparing","ready"]).eq("employee_id",a.employee_id);if(ne)throw ne;Y&&Y.length>0&&(O.push(` ${Y.length} pedido(s) de balco seus pendente(s):`),Y.slice(0,5).forEach(ie=>{O.push(`    Pedido #${ie.order_number} - ${ie.status}`)})),T.length>0&&O.push(` ${T.length} item(ns) de comanda seus no entregue(s)`)}catch(H){console.error("Erro na validao:",H),O.push(" Erro ao validar pendncias. Tente novamente.")}return O},F=(O,H)=>{var ne,ie;const B=window.open("","_blank");if(!B){alert(" No foi possvel abrir a janela de impresso. Verifique se pop-ups esto bloqueados.");return}const Y=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>Comprovante de Fechamento - ${O.receipt_number}</title>
        <style>
          @media print {
            @page { margin: 0; }
            body { margin: 1cm; }
          }
          body {
            font-family: 'Courier New', monospace;
            max-width: 80mm;
            margin: 0 auto;
            padding: 10px;
            font-size: 12px;
          }
          .header {
            text-align: center;
            border-bottom: 2px dashed #000;
            padding-bottom: 10px;
            margin-bottom: 10px;
          }
          .header h1 {
            margin: 0;
            font-size: 18px;
          }
          .header p {
            margin: 5px 0;
            font-size: 11px;
          }
          .section {
            margin: 15px 0;
            border-bottom: 1px dashed #ccc;
            padding-bottom: 10px;
          }
          .section h2 {
            font-size: 14px;
            margin: 0 0 8px 0;
            font-weight: bold;
          }
          .row {
            display: flex;
            justify-content: space-between;
            margin: 3px 0;
          }
          .row.total {
            font-weight: bold;
            font-size: 14px;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #000;
          }
          .highlight {
            background: #f0f0f0;
            padding: 8px;
            margin: 10px 0;
            border-radius: 4px;
          }
          .footer {
            text-align: center;
            margin-top: 20px;
            font-size: 10px;
            border-top: 2px dashed #000;
            padding-top: 10px;
          }
          .signature {
            margin-top: 30px;
            border-top: 1px solid #000;
            padding-top: 5px;
            text-align: center;
          }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>COMPROVANTE DE FECHAMENTO</h1>
          <p>N ${O.receipt_number}</p>
          <p>${new Date().toLocaleString("pt-BR")}</p>
        </div>

        <div class="section">
          <h2>DADOS DA SESSO</h2>
          <div class="row">
            <span>Sesso:</span>
            <span>#${a.id.slice(0,8)}</span>
          </div>
          <div class="row">
            <span>Funcionrio:</span>
            <span>${((ne=a.employee)==null?void 0:ne.name)||"N/A"}</span>
          </div>
          <div class="row">
            <span>Abertura:</span>
            <span>${new Date(a.opened_at).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})}</span>
          </div>
          <div class="row">
            <span>Fechamento:</span>
            <span>${new Date().toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})}</span>
          </div>
          <div class="row">
            <span>Valor Inicial:</span>
            <span>${Pe(a.opening_amount)}</span>
          </div>
        </div>

        <div class="section">
          <h2>RECONCILIAO POR MTODO</h2>
          ${H.reconciliation.map(oe=>`
            <div style="margin-bottom: 10px;">
              <div class="row" style="font-weight: bold;">
                <span>${Rc[oe.payment_method]}</span>
                <span>${oe.transaction_count} transaes</span>
              </div>
              <div class="row">
                <span>Esperado:</span>
                <span>${Pe(oe.expected_amount)}</span>
              </div>
              <div class="row">
                <span>Contado:</span>
                <span>${Pe(oe.actual_amount)}</span>
              </div>
              ${Math.abs(oe.actual_amount-oe.expected_amount)>.01?`
                <div class="row" style="color: ${oe.actual_amount>oe.expected_amount?"green":"red"};">
                  <span>${oe.actual_amount>oe.expected_amount?"Sobra:":"Falta:"}</span>
                  <span>${Pe(Math.abs(oe.actual_amount-oe.expected_amount))}</span>
                </div>
              `:""}
            </div>
          `).join("")}
        </div>

        <div class="section">
          <h2>RESUMO FINANCEIRO</h2>
          <div class="row">
            <span>Total Esperado:</span>
            <span>${Pe(pe)}</span>
          </div>
          <div class="row">
            <span>Total Contado:</span>
            <span>${Pe(te)}</span>
          </div>
          <div class="row total" style="color: ${Math.abs(L)<.01||L>0?"green":"red"};">
            <span>Diferena:</span>
            <span>${Math.abs(L)<.01?"EXATO ":Pe(L)}</span>
          </div>
        </div>

        ${g&&b.amount>0?`
          <div class="section">
            <h2>TRANSFERNCIA PARA TESOURARIA</h2>
            <div class="highlight">
              <div class="row">
                <span>Valor Transferido:</span>
                <span style="font-weight: bold;">${Pe(b.amount)}</span>
              </div>
              <div class="row">
                <span>Destino:</span>
                <span>${b.destination==="cofre"?"Cofre":b.destination==="banco"?"Banco":"Tesouraria Central"}</span>
              </div>
              <div class="row">
                <span>Recebido por:</span>
                <span>${b.recipient_name||"N/A"}</span>
              </div>
              ${b.receipt_number?`
                <div class="row">
                  <span>Comprovante:</span>
                  <span>${b.receipt_number}</span>
                </div>
              `:""}
            </div>
          </div>
        `:""}

        ${H.closing_notes?`
          <div class="section">
            <h2>OBSERVAES</h2>
            <p style="margin: 5px 0; white-space: pre-wrap;">${H.closing_notes}</p>
          </div>
        `:""}

        <div class="signature">
          <p>_________________________________</p>
          <p>Assinatura do Responsvel</p>
          <p style="margin-top: 5px; font-size: 10px;">${((ie=a.employee)==null?void 0:ie.name)||""}</p>
        </div>

        <div class="footer">
          <p>Sistema de Gesto - Fechamento de Caixa</p>
          <p>Documento gerado automaticamente</p>
          <p>Guarde este comprovante para auditoria</p>
        </div>

        <script>
          window.onload = function() {
            window.print();
          };
        <\/script>
      </body>
      </html>
    `;B.document.write(Y),B.document.close()},I=()=>{const O=L;if(Math.abs(O)<.01)return;if(Math.abs(O)<5)return{discrepancy_amount:O,reason:f.closing_notes||"Diferena pequena - aceita automaticamente",action_taken:"accepted"};if(Math.abs(O)<=50){if(!f.closing_notes||f.closing_notes.length<5)throw new Error("Para discrepncias entre R$ 5,00 e R$ 50,00,  necessrio informar o motivo (mnimo 5 caracteres)");return{discrepancy_amount:O,reason:f.closing_notes,action_taken:"accepted",resolution_notes:"Discrepncia mdia - justificada pelo operador"}}if(!f.closing_notes||f.closing_notes.length<10)throw new Error("Para discrepncias acima de R$ 50,00,  necessrio informar o motivo detalhadamente (mnimo 10 caracteres)");const H=prompt("Discrepncia alta detectada! Informe o ID do supervisor que aprovou:");if(!H)throw new Error("Aprovao de supervisor  obrigatria para discrepncias acima de R$ 50,00");return{discrepancy_amount:O,reason:f.closing_notes,action_taken:"investigation",approved_by:H,resolution_notes:"Discrepncia alta - requer investigao"}},J=(O,H,B)=>{p(Y=>({...Y,reconciliation:Y.reconciliation.map(ne=>ne.payment_method===O?{...ne,[H]:B}:ne)}))},pe=f.reconciliation.reduce((O,H)=>O+H.expected_amount,0),te=f.reconciliation.reduce((O,H)=>O+H.actual_amount,0),L=te-pe,ee=r.length+o.length+T.length>0;return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-5xl mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-red-100 p-2 rounded-lg",children:e.jsx(kt,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Fechar Caixa"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Sesso #",a.id.slice(0,8)]})]})]}),e.jsx("button",{onClick:s,disabled:w,className:"text-gray-400 hover:text-gray-600",children:e.jsx(lt,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex space-x-1 mb-6 border-b border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>h("reconciliation"),className:`px-4 py-2 font-medium text-sm transition-colors ${u==="reconciliation"?"text-red-600 border-b-2 border-red-600":"text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(kt,{className:"h-4 w-4"}),e.jsx("span",{children:"Reconciliao"})]})}),e.jsx("button",{type:"button",onClick:()=>h("transfer"),className:`px-4 py-2 font-medium text-sm transition-colors ${u==="transfer"?"text-red-600 border-b-2 border-red-600":"text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(no,{className:"h-4 w-4"}),e.jsx("span",{children:"Transferncia"})]})}),Math.abs(L)>.01&&e.jsx("button",{type:"button",onClick:()=>h("discrepancy"),className:`px-4 py-2 font-medium text-sm transition-colors ${u==="discrepancy"?"text-red-600 border-b-2 border-red-600":"text-orange-500 hover:text-orange-700"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(mt,{className:"h-4 w-4"}),e.jsx("span",{children:"Discrepncia"})]})})]}),e.jsxs("form",{onSubmit:$,className:"space-y-6",children:[ee&&e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(mt,{className:"h-6 w-6 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800 mb-2",children:" Ateno: Pedidos Pendentes de Entrega"}),e.jsxs("div",{className:"text-sm text-yellow-700 space-y-1",children:[r.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsxs("span",{children:[r.length," pedidos de balco em preparo"]})]}),o.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(h0,{className:"h-4 w-4"}),e.jsxs("span",{children:[o.length," pedidos de balco prontos para entrega"]})]}),T.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Vt,{className:"h-4 w-4"}),e.jsxs("span",{children:[T.length," itens de comandas no entregues"]})]})]}),e.jsx("p",{className:"text-xs text-yellow-600 mt-2",children:"Recomenda-se entregar todos os pedidos antes de fechar o caixa."})]})]})}),u==="reconciliation"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Resumo da Sesso"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Valor inicial:"}),e.jsx("span",{className:"font-medium",children:Pe(a.opening_amount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Valor esperado total:"}),e.jsx("span",{className:"font-medium",children:Pe(pe)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Aberta em:"}),e.jsx("span",{className:"font-medium",children:new Date(a.opened_at).toLocaleString("pt-BR")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Funcionrio:"}),e.jsx("span",{className:"font-medium",children:(xe=a.employee)==null?void 0:xe.name})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Reconciliao por Mtodo de Pagamento"}),C&&e.jsx("span",{className:"text-sm text-gray-500",children:"Carregando valores..."})]}),e.jsx("div",{className:"space-y-4",children:f.reconciliation.map(O=>{const H=B=>{switch(B){case"dinheiro":return e.jsx(kt,{className:"h-5 w-5"});case"cartao_debito":case"cartao_credito":return e.jsx(Wi,{className:"h-5 w-5"});case"pix":return e.jsx(io,{className:"h-5 w-5"});case"transferencia":return e.jsx(bj,{className:"h-5 w-5"});default:return e.jsx(kt,{className:"h-5 w-5"})}};return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[H(O.payment_method),e.jsx("h4",{className:"font-medium text-gray-900",children:Rc[O.payment_method]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Valor Esperado"}),e.jsx("div",{className:"px-3 py-2 bg-gray-50 rounded text-sm font-medium",children:Pe(O.expected_amount)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Valor Real *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:O.actual_amount,onChange:B=>J(O.payment_method,"actual_amount",parseFloat(B.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-red-500 focus:border-red-500",disabled:w||C})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Transaes"}),e.jsx("div",{className:"px-3 py-2 bg-gray-50 rounded text-sm font-medium",children:O.transaction_count})]})]}),Math.abs(O.actual_amount-O.expected_amount)>.01&&e.jsxs("div",{className:`mt-2 p-2 rounded text-xs ${O.actual_amount>O.expected_amount?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:[O.actual_amount>O.expected_amount?"Sobra":"Falta",":",Pe(Math.abs(O.actual_amount-O.expected_amount))]})]},O.payment_method)})})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-blue-900 mb-3",children:"Resumo Final"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total esperado:"}),e.jsx("span",{className:"font-medium",children:Pe(pe)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total contado:"}),e.jsx("span",{className:"font-medium",children:Pe(te)})]}),e.jsxs("div",{className:"flex justify-between col-span-2 pt-2 border-t border-blue-200",children:[e.jsx("span",{className:"font-medium",children:"Diferena:"}),e.jsxs("span",{className:`font-bold ${Math.abs(L)<.01||L>0?"text-green-600":"text-red-600"}`,children:[Math.abs(L)<.01?"Exato ":Pe(L),L>0&&" (Sobra)",L<0&&" (Falta)"]})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Observaes do Fechamento",Math.abs(L)>=5&&e.jsx("span",{className:"text-red-600 ml-1",children:"*"})]}),e.jsx("textarea",{value:f.closing_notes||"",onChange:O=>p(H=>({...H,closing_notes:O.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:Math.abs(L)>=50?"Obrigatrio: Descreva detalhadamente o motivo da discrepncia (mn. 10 caracteres)":Math.abs(L)>=5?"Obrigatrio: Informe o motivo da discrepncia (mn. 5 caracteres)":"Observaes sobre o fechamento...",disabled:w}),Math.abs(L)>=5&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Math.abs(L)>=50?" Discrepncia alta - Justificativa detalhada obrigatria":" Justificativa obrigatria para discrepncias acima de R$ 5,00"})]})]}),u==="transfer"&&e.jsxs("div",{className:"space-y-6",children:[(()=>{const O=f.reconciliation.find(B=>B.payment_method==="dinheiro"),H=(O==null?void 0:O.actual_amount)||0;return H>0?e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(mt,{className:"h-6 w-6 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-bold text-red-800 mb-2",children:" TRANSFERNCIA OBRIGATRIA"}),e.jsxs("p",{className:"text-sm text-red-700 mb-2",children:["Existe ",e.jsx("span",{className:"font-bold",children:Pe(H)})," em dinheiro no caixa."]}),e.jsxs("p",{className:"text-sm text-red-700",children:["O fechamento s ser permitido aps transferir todo o dinheiro para o cofre/tesouraria.",e.jsx("br",{}),e.jsx("strong",{children:"O caixa deve ser fechado com saldo ZERO em dinheiro."})]})]})]})}):e.jsx("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ts,{className:"h-6 w-6 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-bold text-green-800",children:" Sem dinheiro no caixa"}),e.jsx("p",{className:"text-sm text-green-700",children:"No h valores em dinheiro para transferir."})]})]})})})(),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(bj,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-blue-900",children:"Transferncia para Tesouraria"}),e.jsx("p",{className:"text-sm text-blue-700",children:(()=>{const O=f.reconciliation.find(B=>B.payment_method==="dinheiro");return((O==null?void 0:O.actual_amount)||0)>0?" OBRIGATRIO: Registre a transferncia do dinheiro":"Registre a transferncia de valores do caixa (opcional)"})()})]})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:O=>{const H=f.reconciliation.find(Y=>Y.payment_method==="dinheiro"),B=(H==null?void 0:H.actual_amount)||0;O.target.checked&&B>0&&_(Y=>({...Y,amount:B})),v(O.target.checked)},className:"w-5 h-5 text-red-600 rounded focus:ring-red-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Registrar transferncia"})]})]}),g&&e.jsxs("div",{className:"space-y-4 mt-4 pt-4 border-t border-blue-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Valor a Transferir *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:te,value:b.amount,onChange:O=>_(H=>({...H,amount:parseFloat(O.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-red-500",disabled:w}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Saldo disponvel: ",Pe(te)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Destino *"}),e.jsxs("select",{value:b.destination,onChange:O=>_(H=>({...H,destination:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-red-500",disabled:w,children:[e.jsx("option",{value:"cofre",children:"Cofre"}),e.jsx("option",{value:"banco",children:"Banco"}),e.jsx("option",{value:"tesouraria_central",children:"Tesouraria Central"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Responsvel pelo Recebimento"}),e.jsx("input",{type:"text",value:b.recipient_name||"",onChange:O=>_(H=>({...H,recipient_name:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:"Nome de quem recebeu",disabled:w})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nmero do Comprovante"}),e.jsx("input",{type:"text",value:b.receipt_number||"",onChange:O=>_(H=>({...H,receipt_number:O.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:"Ex: COMP-2025-001",disabled:w})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observaes"}),e.jsx("textarea",{value:b.notes||"",onChange:O=>_(H=>({...H,notes:O.target.value})),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:"Detalhes adicionais sobre a transferncia...",disabled:w})]}),b.amount>0&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx(ts,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-green-900",children:["Saldo restante no caixa: ",Pe(te-b.amount)]}),e.jsxs("p",{className:"text-green-700 text-xs",children:["Transferindo ",Pe(b.amount)," para ",b.destination]})]})]})})]}),!g&&e.jsx("p",{className:"text-sm text-gray-600 text-center py-4",children:"Ative a opo acima para registrar uma transferncia para tesouraria"})]})]}),u==="discrepancy"&&Math.abs(L)>.01&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:`border-l-4 rounded-lg p-4 ${Math.abs(L)>=50?"bg-red-50 border-red-500":Math.abs(L)>=5?"bg-orange-50 border-orange-500":"bg-yellow-50 border-yellow-500"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(mt,{className:`h-6 w-6 mt-0.5 ${Math.abs(L)>=50?"text-red-600":Math.abs(L)>=5?"text-orange-600":"text-yellow-600"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`text-lg font-medium mb-2 ${Math.abs(L)>=50?"text-red-900":Math.abs(L)>=5?"text-orange-900":"text-yellow-900"}`,children:Math.abs(L)>=50?" Aprovao de Supervisor Necessria":Math.abs(L)>=5?" Justificativa Necessria":" Discrepncia Aceitvel"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Valor da Discrepncia:"}),e.jsxs("span",{className:`font-bold ${L>0?"text-green-600":"text-red-600"}`,children:[Pe(Math.abs(L))," (",L>0?"Sobra":"Falta",")"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Nvel de Risco:"}),e.jsx("span",{className:`font-bold ${Math.abs(L)>=50?"text-red-600":Math.abs(L)>=5?"text-orange-600":"text-yellow-600"}`,children:Math.abs(L)>=50?"ALTA":Math.abs(L)>=5?"MDIA":"BAIXA"})]})]}),e.jsx("p",{className:`text-sm mt-3 ${Math.abs(L)>=50?"text-red-700":Math.abs(L)>=5?"text-orange-700":"text-yellow-700"}`,children:Math.abs(L)>=50?"A discrepncia excede R$ 50,00.  necessria a aprovao de um supervisor para prosseguir com o fechamento.":Math.abs(L)>=5?"Por favor, informe o motivo da discrepncia. Uma justificativa detalhada  necessria.":"A diferena est dentro do limite aceitvel. Voc pode aceitar automaticamente ou informar o motivo."})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Informaes Adicionais"}),e.jsx("p",{className:"text-sm text-gray-600",children:'Volte para a aba "Reconciliao" e preencha o campo "Observaes do Fechamento" com:'}),e.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 mt-2 space-y-1",children:[e.jsx("li",{children:"Motivo da discrepncia"}),e.jsx("li",{children:"Aes tomadas para investigar"}),Math.abs(L)>=50&&e.jsx("li",{className:"text-red-600 font-medium",children:"ID do supervisor que aprovou (ser solicitado no fechamento)"})]})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:s,disabled:w,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:w||k||C,className:`flex-1 px-4 py-2 text-white rounded-md disabled:opacity-50 transition-colors ${Math.abs(L)>=50?"bg-red-600 hover:bg-red-700":ee?"bg-yellow-600 hover:bg-yellow-700":"bg-red-600 hover:bg-red-700"}`,children:w?"Fechando...":k?"Validando...":C?"Carregando...":Math.abs(L)>=50?"Fechar com Aprovao":ee?"Fechar Mesmo Assim":"Fechar Caixa"})]})]})]})}):null},VU=({isOpen:t,onClose:s,onProcessWithdrawal:a,currentCashBalance:r,loading:o=!1})=>{const[l,c]=y.useState({amount:0,reason:"",authorized_by:"",recipient:"",purpose:"other"}),[u,h]=y.useState({}),[f,p]=y.useState(!1),g=(E,T)=>{c(N=>({...N,[E]:T})),u[E]&&h(N=>({...N,[E]:""}))},v=()=>{var T;const E={};return(!l.amount||l.amount<=0)&&(E.amount="Valor deve ser maior que zero"),l.amount>r&&(E.amount="Valor no pode ser maior que o saldo em caixa"),l.reason.trim()||(E.reason="Motivo  obrigatrio"),l.authorized_by.trim()||(E.authorized_by="Nome do autorizador  obrigatrio"),l.purpose==="transfer"&&!((T=l.recipient)!=null&&T.trim())&&(E.recipient="Destinatrio  obrigatrio para transferncias"),h(E),Object.keys(E).length===0},b=async E=>{if(E.preventDefault(),!!v()){p(!0);try{await a(l),_()}catch(T){console.error("Erro ao processar sada:",T)}finally{p(!1)}}},_=()=>{c({amount:0,reason:"",authorized_by:"",recipient:"",purpose:"other"}),h({}),p(!1),s()},w=[{value:"change",label:"Troco"},{value:"expense",label:"Despesa"},{value:"transfer",label:"Transferncia"},{value:"other",label:"Outros"}];return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(be.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-orange-100 p-2 rounded-full",children:e.jsx($i,{className:"h-5 w-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Sada de Dinheiro"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Saldo disponvel: ",Pe(r)]})]})]}),e.jsx("button",{onClick:_,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:f,title:"Fechar modal","aria-label":"Fechar modal",children:e.jsx(lt,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"p-6 pb-0",children:e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex items-start space-x-3",children:[e.jsx(mt,{className:"h-5 w-5 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-yellow-800",children:"Ateno"}),e.jsx("p",{className:"text-yellow-700 mt-1",children:"Esta operao reduzir o saldo em caixa e deve ser autorizada por um supervisor."})]})]})}),e.jsxs("form",{onSubmit:b,className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor da Sada *"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"R$"}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:r,value:l.amount||"",onChange:E=>g("amount",parseFloat(E.target.value)||0),className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent ${u.amount?"border-red-300":"border-gray-300"}`,placeholder:"0,00",disabled:f})]}),u.amount&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.amount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Finalidade *"}),e.jsx("select",{value:l.purpose,onChange:E=>g("purpose",E.target.value),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",disabled:f,title:"Selecione a finalidade da sada","aria-label":"Finalidade da sada de dinheiro",children:w.map(E=>e.jsx("option",{value:E.value,children:E.label},E.value))})]}),l.purpose==="transfer"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destinatrio *"}),e.jsx("input",{type:"text",value:l.recipient||"",onChange:E=>g("recipient",E.target.value),className:`w-full px-3 py-3 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent ${u.recipient?"border-red-300":"border-gray-300"}`,placeholder:"Nome do destinatrio",disabled:f}),u.recipient&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.recipient})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo/Descrio *"}),e.jsx("textarea",{value:l.reason,onChange:E=>g("reason",E.target.value),rows:3,className:`w-full px-3 py-3 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none ${u.reason?"border-red-300":"border-gray-300"}`,placeholder:"Descreva o motivo da sada de dinheiro...",disabled:f}),u.reason&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.reason})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autorizado por *"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ys,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",value:l.authorized_by,onChange:E=>g("authorized_by",E.target.value),className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent ${u.authorized_by?"border-red-300":"border-gray-300"}`,placeholder:"Nome do supervisor/gerente",disabled:f})]}),u.authorized_by&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.authorized_by})]})]}),l.amount>0&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Resumo da Operao"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Saldo atual:"}),e.jsx("span",{className:"font-medium",children:Pe(r)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Valor da sada:"}),e.jsxs("span",{className:"font-medium text-red-600",children:["-",Pe(l.amount)]})]}),e.jsx("div",{className:"border-t pt-1 mt-2",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-900 font-medium",children:"Saldo aps sada:"}),e.jsx("span",{className:"font-bold",children:Pe(r-l.amount)})]})})]})]}),e.jsxs("div",{className:"flex space-x-3 mt-6 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:_,className:"flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-400 transition-colors font-medium",disabled:f,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"flex-1 bg-orange-600 text-white py-3 rounded-lg hover:bg-orange-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",disabled:f||o||!l.amount||!l.reason.trim()||!l.authorized_by.trim(),children:f?"Processando...":"Processar Sada"})]})]})]})}):null},qU=({isOpen:t,onClose:s,onProcessTransfer:a,currentCashBalance:r,loading:o=!1})=>{const[l,c]=y.useState({amount:r,transfer_date:new Date().toISOString().split("T")[0],authorized_by:"",treasury_receipt_number:"",notes:""}),[u,h]=y.useState({}),[f,p]=y.useState(!1),g=(E,T)=>{c(N=>({...N,[E]:T})),u[E]&&h(N=>({...N,[E]:""}))},v=()=>{const E={};(!l.amount||l.amount<=0)&&(E.amount="Valor deve ser maior que zero"),l.amount>r&&(E.amount="Valor no pode ser maior que o saldo em caixa"),l.transfer_date||(E.transfer_date="Data da transferncia  obrigatria"),l.authorized_by.trim()||(E.authorized_by="Nome do autorizador  obrigatrio");const T=new Date(l.transfer_date),N=new Date;return N.setHours(23,59,59,999),T>N&&(E.transfer_date="Data no pode ser futura"),h(E),Object.keys(E).length===0},b=async E=>{if(E.preventDefault(),!!v()){p(!0);try{await a(l),_()}catch(T){console.error("Erro ao processar transferncia:",T)}finally{p(!1)}}},_=()=>{c({amount:r,transfer_date:new Date().toISOString().split("T")[0],authorized_by:"",treasury_receipt_number:"",notes:""}),h({}),p(!1),s()},w=()=>{g("amount",r)};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(be.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-lg shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-purple-100 p-2 rounded-full",children:e.jsx(Cc,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Transferncia para Tesouraria"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Saldo disponvel: ",Pe(r)]})]})]}),e.jsx("button",{onClick:_,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:f,title:"Fechar modal","aria-label":"Fechar modal",children:e.jsx(lt,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"p-6 pb-0",children:e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start space-x-3",children:[e.jsx(hR,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-blue-800",children:"Transferncia para Tesouraria"}),e.jsx("p",{className:"text-blue-700 mt-1",children:"Esta operao transfere o dinheiro em caixa para a tesouraria central. Um comprovante ser gerado para assinatura do conferente."})]})]})}),e.jsxs("form",{onSubmit:b,className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Valor da Transferncia *"}),e.jsx("button",{type:"button",onClick:w,className:"text-xs text-purple-600 hover:text-purple-700 underline",disabled:f,children:"Transferir todo o saldo"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"R$"}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:r,value:l.amount||"",onChange:E=>g("amount",parseFloat(E.target.value)||0),className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent ${u.amount?"border-red-300":"border-gray-300"}`,placeholder:"0,00",disabled:f})]}),u.amount&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.amount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data da Transferncia *"}),e.jsxs("div",{className:"relative",children:[e.jsx(Mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"date",value:l.transfer_date,onChange:E=>g("transfer_date",E.target.value),max:new Date().toISOString().split("T")[0],className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent ${u.transfer_date?"border-red-300":"border-gray-300"}`,disabled:f,title:"Selecione a data da transferncia","aria-label":"Data da transferncia"})]}),u.transfer_date&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.transfer_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autorizado por *"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ys,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",value:l.authorized_by,onChange:E=>g("authorized_by",E.target.value),className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent ${u.authorized_by?"border-red-300":"border-gray-300"}`,placeholder:"Nome do supervisor/gerente",disabled:f})]}),u.authorized_by&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.authorized_by})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nmero do Comprovante da Tesouraria"}),e.jsxs("div",{className:"relative",children:[e.jsx(KN,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",value:l.treasury_receipt_number||"",onChange:E=>g("treasury_receipt_number",E.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Ex: TSR-2024-001234",disabled:f})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Nmero de referncia do comprovante da tesouraria (opcional)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observaes"}),e.jsx("textarea",{value:l.notes||"",onChange:E=>g("notes",E.target.value),rows:3,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",placeholder:"Observaes adicionais sobre a transferncia...",disabled:f})]})]}),l.amount>0&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Resumo da Transferncia"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Saldo atual em caixa:"}),e.jsx("span",{className:"font-medium",children:Pe(r)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Valor a transferir:"}),e.jsx("span",{className:"font-medium text-purple-600",children:Pe(l.amount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Data da transferncia:"}),e.jsx("span",{className:"font-medium",children:St(new Date(l.transfer_date),"dd 'de' MMMM 'de' yyyy",{locale:ss})})]}),e.jsx("div",{className:"border-t pt-2 mt-2",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-900 font-medium",children:"Saldo restante em caixa:"}),e.jsx("span",{className:"font-bold",children:Pe(r-l.amount)})]})})]})]}),l.amount===r&&l.amount>0&&e.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg flex items-start space-x-2",children:[e.jsx(mt,{className:"h-4 w-4 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-yellow-800",children:"Transferncia Total"}),e.jsx("p",{className:"text-yellow-700",children:"Voc est transferindo todo o saldo em caixa. O caixa ficar zerado aps esta operao."})]})]}),e.jsxs("div",{className:"flex space-x-3 mt-6 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:_,className:"flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-400 transition-colors font-medium",disabled:f,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"flex-1 bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",disabled:f||o||!l.amount||!l.authorized_by.trim(),children:f?"Processando...":"Transferir e Imprimir Comprovante"})]})]})]})}):null},FU=({receiptData:t,onPrint:s})=>{const a=()=>{const r=document.getElementById("treasury-transfer-receipt");if(!r)return;const o=window.open("","_blank");o&&(o.document.write(`
      <html>
        <head>
          <title>Comprovante de Transferncia - Tesouraria</title>
          <style>
            body {
              font-family: 'Courier New', monospace;
              font-size: 12px;
              line-height: 1.4;
              margin: 0;
              padding: 20px;
              background: white;
            }
            .receipt {
              max-width: 300px;
              margin: 0 auto;
            }
            .header {
              text-align: center;
              border-bottom: 2px solid #000;
              padding-bottom: 10px;
              margin-bottom: 15px;
            }
            .company-name {
              font-size: 16px;
              font-weight: bold;
              margin-bottom: 5px;
            }
            .receipt-title {
              font-size: 14px;
              font-weight: bold;
              margin-top: 10px;
            }
            .section {
              margin-bottom: 15px;
            }
            .section-title {
              font-weight: bold;
              border-bottom: 1px solid #000;
              margin-bottom: 5px;
              text-transform: uppercase;
            }
            .row {
              display: flex;
              justify-content: space-between;
              margin-bottom: 3px;
            }
            .row-full {
              margin-bottom: 3px;
            }
            .total {
              border-top: 2px solid #000;
              border-bottom: 2px solid #000;
              padding: 8px 0;
              margin: 15px 0;
              font-weight: bold;
              font-size: 14px;
            }
            .signatures {
              margin-top: 30px;
              border-top: 1px solid #000;
              padding-top: 20px;
            }
            .signature-line {
              border-bottom: 1px solid #000;
              margin: 30px 0 10px 0;
              height: 1px;
            }
            .signature-label {
              text-align: center;
              font-size: 10px;
              margin-top: 5px;
            }
            .footer {
              text-align: center;
              margin-top: 30px;
              font-size: 10px;
              border-top: 1px solid #000;
              padding-top: 10px;
            }
            @media print {
              body { margin: 0; padding: 10px; }
              .no-print { display: none; }
            }
          </style>
        </head>
        <body>
          ${r.innerHTML}
        </body>
      </html>
    `),o.document.close(),o.focus(),o.print(),s&&s())};return e.jsxs("div",{className:"bg-white p-6 rounded-lg",children:[e.jsxs("div",{id:"treasury-transfer-receipt",className:"receipt",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"company-name",children:"AABB - SISTEMA DE GESTO"}),e.jsx("div",{children:"Associao Atltica Banco do Brasil"}),e.jsx("div",{className:"receipt-title",children:"COMPROVANTE DE TRANSFERNCIA"}),e.jsx("div",{className:"receipt-title",children:"TESOURARIA"})]}),e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Dados da Transferncia"}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"ID Transferncia:"}),e.jsxs("span",{children:["#",t.transferId.slice(-8).toUpperCase()]})]}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"Data/Hora:"}),e.jsx("span",{children:St(t.timestamp,"dd/MM/yyyy HH:mm",{locale:ss})})]}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"Data Transferncia:"}),e.jsx("span",{children:St(new Date(t.transferDate),"dd/MM/yyyy",{locale:ss})})]}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"Sesso Caixa:"}),e.jsxs("span",{children:["#",t.sessionId.slice(-6).toUpperCase()]})]})]}),e.jsx("div",{className:"total",children:e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"VALOR TRANSFERIDO:"}),e.jsx("span",{children:Pe(t.amount)})]})}),e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Autorizao"}),e.jsxs("div",{className:"row-full",children:[e.jsx("strong",{children:"Autorizado por:"})," ",t.authorizedBy]}),e.jsxs("div",{className:"row-full",children:[e.jsx("strong",{children:"Operador:"})," ",t.cashierName]}),t.treasuryReceiptNumber&&e.jsxs("div",{className:"row-full",children:[e.jsx("strong",{children:"Comprovante Tesouraria:"})," ",t.treasuryReceiptNumber]})]}),t.notes&&e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Observaes"}),e.jsx("div",{className:"row-full",children:t.notes})]}),e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Informaes"}),e.jsx("div",{className:"row-full",style:{fontSize:"10px"},children:"Este comprovante confirma a transferncia de valores em dinheiro do caixa operacional para a tesouraria central."}),e.jsx("div",{className:"row-full",style:{fontSize:"10px",marginTop:"5px"},children:"Confira os dados e guarde este comprovante."})]}),e.jsxs("div",{className:"signatures",children:[e.jsx("div",{className:"section-title",children:"Assinaturas"}),e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx("div",{className:"signature-line"}),e.jsx("div",{className:"signature-label",children:"OPERADOR DE CAIXA"}),e.jsx("div",{className:"signature-label",children:t.cashierName})]}),e.jsxs("div",{style:{marginTop:"25px"},children:[e.jsx("div",{className:"signature-line"}),e.jsx("div",{className:"signature-label",children:"SUPERVISOR/AUTORIZAO"}),e.jsx("div",{className:"signature-label",children:t.authorizedBy})]}),e.jsxs("div",{style:{marginTop:"25px"},children:[e.jsx("div",{className:"signature-line"}),e.jsx("div",{className:"signature-label",children:"CONFERENTE TESOURARIA"}),e.jsx("div",{className:"signature-label",children:"Nome: ___________________________"})]})]}),e.jsxs("div",{className:"footer",children:[e.jsx("div",{children:"AABB - Sistema de Gesto v1.0"}),e.jsx("div",{children:"Documento gerado automaticamente"}),e.jsx("div",{children:St(new Date,"dd/MM/yyyy HH:mm:ss",{locale:ss})})]})]}),e.jsx("div",{className:"flex justify-center mt-6 no-print",children:e.jsxs("button",{onClick:a,className:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center space-x-2",children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a2 2 0 002 2h6a2 2 0 002-2v-2h1a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z",clipRule:"evenodd"})}),e.jsx("span",{children:"Imprimir Comprovante"})]})})]})},HU={change:"Troco",expense:"Despesa",transfer:"Transferncia",other:"Outros"},GU=({receiptData:t,onPrint:s})=>{const a=()=>{const r=document.getElementById("cash-withdrawal-receipt");if(!r)return;const o=window.open("","_blank");o&&(o.document.write(`
      <html>
        <head>
          <title>Comprovante de Sada de Dinheiro</title>
          <style>
            body {
              font-family: 'Courier New', monospace;
              font-size: 12px;
              line-height: 1.4;
              margin: 0;
              padding: 20px;
              background: white;
            }
            .receipt {
              max-width: 300px;
              margin: 0 auto;
            }
            .header {
              text-align: center;
              border-bottom: 2px solid #000;
              padding-bottom: 10px;
              margin-bottom: 15px;
            }
            .company-name {
              font-size: 16px;
              font-weight: bold;
              margin-bottom: 5px;
            }
            .receipt-title {
              font-size: 14px;
              font-weight: bold;
              margin-top: 10px;
            }
            .section {
              margin-bottom: 15px;
            }
            .section-title {
              font-weight: bold;
              border-bottom: 1px solid #000;
              margin-bottom: 5px;
              text-transform: uppercase;
            }
            .row {
              display: flex;
              justify-content: space-between;
              margin-bottom: 3px;
            }
            .row-full {
              margin-bottom: 3px;
            }
            .total {
              border-top: 2px solid #000;
              border-bottom: 2px solid #000;
              padding: 8px 0;
              margin: 15px 0;
              font-weight: bold;
              font-size: 14px;
            }
            .signatures {
              margin-top: 30px;
              border-top: 1px solid #000;
              padding-top: 20px;
            }
            .signature-line {
              border-bottom: 1px solid #000;
              margin: 30px 0 10px 0;
              height: 1px;
            }
            .signature-label {
              text-align: center;
              font-size: 10px;
              margin-top: 5px;
            }
            .footer {
              text-align: center;
              margin-top: 30px;
              font-size: 10px;
              border-top: 1px solid #000;
              padding-top: 10px;
            }
            .highlight {
              background-color: #f0f0f0;
              padding: 5px;
              border: 1px solid #000;
              margin: 10px 0;
            }
            @media print {
              body { margin: 0; padding: 10px; }
              .no-print { display: none; }
            }
          </style>
        </head>
        <body>
          ${r.innerHTML}
        </body>
      </html>
    `),o.document.close(),o.focus(),o.print(),s&&s())};return e.jsxs("div",{className:"bg-white p-6 rounded-lg",children:[e.jsxs("div",{id:"cash-withdrawal-receipt",className:"receipt",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"company-name",children:"AABB - SISTEMA DE GESTO"}),e.jsx("div",{children:"Associao Atltica Banco do Brasil"}),e.jsx("div",{className:"receipt-title",children:"COMPROVANTE DE SADA"}),e.jsx("div",{className:"receipt-title",children:"DE DINHEIRO"})]}),e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Dados da Operao"}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"ID Operao:"}),e.jsxs("span",{children:["#",t.withdrawalId.slice(-8).toUpperCase()]})]}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"Data/Hora:"}),e.jsx("span",{children:St(t.timestamp,"dd/MM/yyyy HH:mm",{locale:ss})})]}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"Sesso Caixa:"}),e.jsxs("span",{children:["#",t.sessionId.slice(-6).toUpperCase()]})]}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"Finalidade:"}),e.jsx("span",{children:HU[t.purpose]})]})]}),e.jsx("div",{className:"total",children:e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"VALOR DA SADA:"}),e.jsx("span",{children:Pe(t.amount)})]})}),e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Justificativa"}),e.jsx("div",{className:"highlight",children:e.jsx("div",{className:"row-full",children:t.reason})})]}),e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Autorizao"}),e.jsxs("div",{className:"row-full",children:[e.jsx("strong",{children:"Autorizado por:"})," ",t.authorizedBy]}),e.jsxs("div",{className:"row-full",children:[e.jsx("strong",{children:"Operador de Caixa:"})," ",t.cashierName]}),t.recipient&&e.jsxs("div",{className:"row-full",children:[e.jsx("strong",{children:"Beneficirio:"})," ",t.recipient]})]}),e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Informaes"}),e.jsx("div",{className:"row-full",style:{fontSize:"10px"},children:"Este comprovante documenta a sada de dinheiro do caixa operacional."}),e.jsx("div",{className:"row-full",style:{fontSize:"10px",marginTop:"5px"},children:"Operao devidamente autorizada e registrada no sistema."}),e.jsx("div",{className:"row-full",style:{fontSize:"10px",marginTop:"5px"},children:"Confira os dados e mantenha este comprovante arquivado."})]}),e.jsxs("div",{className:"signatures",children:[e.jsx("div",{className:"section-title",children:"Assinaturas e Confirmaes"}),e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx("div",{className:"signature-line"}),e.jsx("div",{className:"signature-label",children:"OPERADOR DE CAIXA"}),e.jsx("div",{className:"signature-label",children:t.cashierName})]}),e.jsxs("div",{style:{marginTop:"25px"},children:[e.jsx("div",{className:"signature-line"}),e.jsx("div",{className:"signature-label",children:"SUPERVISOR/AUTORIZAO"}),e.jsx("div",{className:"signature-label",children:t.authorizedBy})]}),t.recipient&&e.jsxs("div",{style:{marginTop:"25px"},children:[e.jsx("div",{className:"signature-line"}),e.jsx("div",{className:"signature-label",children:"BENEFICIRIO/RECEBEDOR"}),e.jsx("div",{className:"signature-label",children:t.recipient})]}),e.jsxs("div",{style:{marginTop:"25px"},children:[e.jsx("div",{className:"signature-line"}),e.jsx("div",{className:"signature-label",children:"TESTEMUNHA (se necessrio)"}),e.jsx("div",{className:"signature-label",children:"Nome: ___________________________"})]})]}),e.jsxs("div",{className:"footer",children:[e.jsx("div",{children:"AABB - Sistema de Gesto v1.0"}),e.jsx("div",{children:"Documento gerado automaticamente"}),e.jsx("div",{children:St(new Date,"dd/MM/yyyy HH:mm:ss",{locale:ss})}),e.jsx("div",{style:{marginTop:"10px",fontSize:"8px"},children:" Este documento possui valor legal e deve ser arquivado"})]})]}),e.jsx("div",{className:"flex justify-center mt-6 no-print",children:e.jsxs("button",{onClick:a,className:"bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700 transition-colors flex items-center space-x-2",children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a2 2 0 002 2h6a2 2 0 002-2v-2h1a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z",clipRule:"evenodd"})}),e.jsx("span",{children:"Imprimir Comprovante"})]})})]})},ZU=({transactions:t,onAddWithdrawal:s,onExportReport:a,isCashSessionOpen:r=!1})=>{const[o,l]=y.useState("all"),[c,u]=y.useState("all"),h=b=>{var _,w;return(_=b.notes)!=null&&_.includes("[SADA]")?"cash_withdrawal":(w=b.notes)!=null&&w.includes("[TRANSFERNCIA TESOURARIA]")?"treasury_transfer":b.transaction_type},f=t.filter(b=>{const _=h(b),w=o==="all"||_===o,E=c==="all"||b.payment_method===c;return w&&E}),p={entradas:t.filter(b=>{const _=h(b);return["sale","adjustment"].includes(_)&&b.amount>0}).reduce((b,_)=>b+_.amount,0),saidas:t.filter(b=>{const _=h(b);return["refund","cash_withdrawal","treasury_transfer"].includes(_)||_==="adjustment"&&b.amount<0}).reduce((b,_)=>b+Math.abs(_.amount),0),saldo:0};p.saldo=p.entradas-p.saidas;const g=b=>{switch(b){case"sale":return e.jsx(ma,{className:"h-4 w-4 text-green-600"});case"refund":return e.jsx(Yu,{className:"h-4 w-4 text-red-600"});case"adjustment":return e.jsx(Cc,{className:"h-4 w-4 text-blue-600"});case"cash_withdrawal":return e.jsx($i,{className:"h-4 w-4 text-orange-600"});case"treasury_transfer":return e.jsx(Cc,{className:"h-4 w-4 text-purple-600"});default:return e.jsx(kt,{className:"h-4 w-4 text-gray-600"})}},v=(b,_)=>b==="sale"||b==="adjustment"&&_>0?"text-green-600":["refund","cash_withdrawal","treasury_transfer"].includes(b)||b==="adjustment"&&_<0?"text-red-600":"text-gray-600";return e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Movimentao do Dia"}),e.jsx("p",{className:"text-sm text-gray-600",children:St(new Date,"dd 'de' MMMM 'de' yyyy",{locale:ss})})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:s,disabled:!r,className:`px-4 py-2 rounded-lg flex items-center space-x-2 text-sm transition-colors ${r?"bg-orange-600 text-white hover:bg-orange-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,title:r?"Registrar sada de dinheiro":"Caixa deve estar aberto para realizar sadas de dinheiro",children:[e.jsx($i,{className:"h-4 w-4"}),e.jsx("span",{children:"Sada de Dinheiro"})]}),e.jsxs("button",{onClick:a,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2 text-sm",children:[e.jsx(Vc,{className:"h-4 w-4"}),e.jsx("span",{children:"Exportar"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Entradas"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:Pe(p.entradas)})]}),e.jsx(ma,{className:"h-8 w-8 text-green-600"})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"Sadas"}),e.jsx("p",{className:"text-2xl font-bold text-red-900",children:Pe(p.saidas)})]}),e.jsx(Yu,{className:"h-8 w-8 text-red-600"})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:`border rounded-lg p-4 ${p.saldo>=0?"bg-blue-50 border-blue-200":"bg-orange-50 border-orange-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium ${p.saldo>=0?"text-blue-800":"text-orange-800"}`,children:"Saldo"}),e.jsx("p",{className:`text-2xl font-bold ${p.saldo>=0?"text-blue-900":"text-orange-900"}`,children:Pe(Math.abs(p.saldo))})]}),e.jsx(kt,{className:`h-8 w-8 ${p.saldo>=0?"text-blue-600":"text-orange-600"}`})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 space-y-3 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("select",{value:o,onChange:b=>l(b.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",title:"Filtrar por tipo de transao","aria-label":"Filtro por tipo de transao",children:[e.jsx("option",{value:"all",children:"Todos os Tipos"}),e.jsx("option",{value:"sale",children:"Vendas"}),e.jsx("option",{value:"refund",children:"Estornos"}),e.jsx("option",{value:"adjustment",children:"Ajustes"}),e.jsx("option",{value:"cash_withdrawal",children:"Sadas de Dinheiro"}),e.jsx("option",{value:"treasury_transfer",children:"Transferncias"})]}),e.jsxs("select",{value:c,onChange:b=>u(b.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",title:"Filtrar por mtodo de pagamento","aria-label":"Filtro por mtodo de pagamento",children:[e.jsx("option",{value:"all",children:"Todos os Mtodos"}),e.jsx("option",{value:"dinheiro",children:"Dinheiro"}),e.jsx("option",{value:"cartao_debito",children:"Carto de Dbito"}),e.jsx("option",{value:"cartao_credito",children:"Carto de Crdito"}),e.jsx("option",{value:"pix",children:"PIX"}),e.jsx("option",{value:"transferencia",children:"Transferncia"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[f.length," de ",t.length," transaes"]})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:f.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhuma transao encontrada"})}):f.map(b=>{var w,E;const _=h(b);return e.jsxs(be.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[g(_),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[F2[_]||"Transao",b.comanda&&e.jsxs("span",{className:"ml-2 text-blue-600",children:["- Comanda #",Nm(b.comanda.id)]}),!b.comanda&&b.notes&&(b.notes.includes("Pedido Balco")||b.notes.includes("Pedido de balco"))&&e.jsxs("span",{className:"ml-2 text-green-600",children:["- Pedido Balco ",I2(b.notes)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[e.jsx(Vt,{className:"h-3 w-3"}),e.jsx("span",{children:St(new Date(b.processed_at),"HH:mm",{locale:ss})}),e.jsx("span",{children:""}),e.jsx("span",{children:Rc[b.payment_method]}),((w=b.comanda)==null?void 0:w.customer_name)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsx("span",{children:b.comanda.customer_name})]}),((E=b.comanda)==null?void 0:E.table_number)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsxs("span",{children:["Mesa ",b.comanda.table_number]})]}),b.processed_by_employee&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:""}),e.jsx(Ys,{className:"h-3 w-3"}),e.jsx("span",{children:b.processed_by_employee.name})]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-sm font-bold ${v(_,b.amount)}`,children:[["refund","cash_withdrawal","treasury_transfer"].includes(_)||_==="adjustment"&&b.amount<0?"-":"+",Pe(Math.abs(b.amount))]}),b.reference_number&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Ref: ",b.reference_number]})]})]},b.id)})})]})},WU=({receiptData:t,onPrint:s})=>{var g;const{order:a,paymentMethod:r,amountPaid:o,cashierName:l,referenceNumber:c,timestamp:u}=t,h=v=>({dinheiro:"Dinheiro",cartao_debito:"Carto Dbito",cartao_credito:"Carto Crdito",pix:"PIX",transferencia:"Transferncia"})[v]||v,f=()=>{s&&s();const v=window.open("","_blank");v&&(v.document.write(p()),v.document.close(),v.print(),v.close())},p=()=>{var v;return`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Comprovante - ${a.order_number.toString().padStart(4,"0")}</title>
        <style>
          body {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            margin: 0;
            padding: 20px;
            width: 300px;
          }
          .header {
            text-align: center;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
            margin-bottom: 15px;
          }
          .title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
          }
          .subtitle {
            font-size: 10px;
            color: #666;
          }
          .section {
            margin-bottom: 15px;
          }
          .section-title {
            font-weight: bold;
            border-bottom: 1px solid #ccc;
            padding-bottom: 2px;
            margin-bottom: 5px;
          }
          .item-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 3px;
          }
          .item-name {
            flex: 1;
          }
          .item-qty {
            width: 30px;
            text-align: center;
          }
          .item-price {
            width: 60px;
            text-align: right;
          }
          .total-row {
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            border-top: 1px solid #000;
            padding-top: 5px;
            margin-top: 10px;
          }
          .footer {
            text-align: center;
            border-top: 2px solid #000;
            padding-top: 10px;
            margin-top: 15px;
            font-size: 10px;
          }
          .dashed-line {
            border-top: 1px dashed #666;
            margin: 10px 0;
          }
          .payment-status {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            margin: 15px 0;
          }
          @media print {
            body { margin: 0; padding: 10px; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div class="title">CLUBE SOCIAL</div>
          <div class="subtitle">Bar & Restaurante</div>
          <div class="subtitle">CNPJ: 12.345.678/0001-90</div>
        </div>

        <div class="section">
          <div class="section-title">COMPROVANTE DE PAGAMENTO</div>
          <div>Pedido: #${a.order_number.toString().padStart(4,"0")}</div>
          <div>Data Pedido: ${new Date(a.created_at).toLocaleDateString("pt-BR")}</div>
          <div>Hora Pedido: ${new Date(a.created_at).toLocaleTimeString("pt-BR")}</div>
          <div>Data Pagto: ${u.toLocaleDateString("pt-BR")}</div>
          <div>Hora Pagto: ${u.toLocaleTimeString("pt-BR")}</div>
          <div>Atendente: ${a.employee_name||"N/A"}</div>
          <div>Caixa: ${l}</div>
          ${a.customer_name?`<div>Cliente: ${a.customer_name}</div>`:""}
          ${a.customer_phone?`<div>Telefone: ${a.customer_phone}</div>`:""}
        </div>

        <div class="dashed-line"></div>

        <div class="section">
          <div class="section-title">ITENS VENDIDOS</div>
          ${((v=a.items)==null?void 0:v.map(b=>{var _;return`
            <div class="item-row">
              <div class="item-name">${((_=b.menu_item)==null?void 0:_.name)||"Item"}</div>
              <div class="item-qty">${b.quantity}x</div>
              <div class="item-price">R$ ${(b.unit_price*b.quantity).toFixed(2)}</div>
            </div>
            ${b.notes?`<div style="font-size: 10px; color: #666; margin-left: 10px;">Obs: ${b.notes}</div>`:""}
          `}).join(""))||"<div>Nenhum item encontrado</div>"}
        </div>

        <div class="dashed-line"></div>

        <div class="section">
          <div class="item-row">
            <div>Subtotal:</div>
            <div>R$ ${a.total_amount.toFixed(2)}</div>
          </div>
          ${a.discount_amount&&a.discount_amount>0?`
            <div class="item-row" style="color: #666;">
              <div>Desconto:</div>
              <div>-R$ ${a.discount_amount.toFixed(2)}</div>
            </div>
          `:""}
          <div class="total-row">
            <div>TOTAL PAGO:</div>
            <div>R$ ${o.toFixed(2)}</div>
          </div>
        </div>

        <div class="dashed-line"></div>

        <div class="section">
          <div class="section-title">INFORMAES DE PAGAMENTO</div>
          <div>Forma de Pagamento: ${h(r)}</div>
          <div>Valor Pago: R$ ${o.toFixed(2)}</div>
          ${c?`<div>Ref. Transao: ${c}</div>`:""}
          <div>Status: PAGO </div>
        </div>

        ${a.notes?`
          <div class="dashed-line"></div>
          <div class="section">
            <div class="section-title">OBSERVAES DO PEDIDO</div>
            <div>${a.notes}</div>
          </div>
        `:""}

        ${a.customer_notes?`
          <div class="dashed-line"></div>
          <div class="section">
            <div class="section-title">OBSERVAES DO CLIENTE</div>
            <div>${a.customer_notes}</div>
          </div>
        `:""}

        <div class="payment-status">
          <div> PAGAMENTO APROVADO </div>
          <div style="margin-top: 5px; font-size: 10px;">
            Transao processada com sucesso
          </div>
        </div>

        <div class="footer">
          <div>Obrigado pela preferncia!</div>
          <div>Volte sempre!</div>
          <div style="margin-top: 10px;">
            ${a.customer_name?`Pontos acumulados: +${Math.floor(a.final_amount/10)}`:"Cadastre-se e ganhe pontos!"}
          </div>
          <div style="margin-top: 10px;">
            ID: ${a.id.substring(0,8).toUpperCase()}
          </div>
        </div>
      </body>
      </html>
    `};return e.jsxs("div",{className:"payment-receipt",children:[e.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-6 max-w-sm mx-auto font-mono text-sm",children:[e.jsxs("div",{className:"text-center border-b-2 border-black pb-3 mb-4",children:[e.jsx("div",{className:"font-bold text-lg",children:"CLUBE SOCIAL"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Bar & Restaurante"}),e.jsx("div",{className:"text-xs text-gray-600",children:"CNPJ: 12.345.678/0001-90"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"font-bold border-b border-gray-400 pb-1 mb-2",children:"COMPROVANTE DE PAGAMENTO"}),e.jsxs("div",{children:["Pedido: #",a.order_number.toString().padStart(4,"0")]}),e.jsxs("div",{children:["Data Pedido: ",new Date(a.created_at).toLocaleDateString("pt-BR")]}),e.jsxs("div",{children:["Hora Pedido: ",new Date(a.created_at).toLocaleTimeString("pt-BR")]}),e.jsxs("div",{children:["Data Pagto: ",u.toLocaleDateString("pt-BR")]}),e.jsxs("div",{children:["Hora Pagto: ",u.toLocaleTimeString("pt-BR")]}),e.jsxs("div",{children:["Atendente: ",a.employee_name||"N/A"]}),e.jsxs("div",{children:["Caixa: ",l]}),a.customer_name&&e.jsxs("div",{children:["Cliente: ",a.customer_name]}),a.customer_phone&&e.jsxs("div",{children:["Telefone: ",a.customer_phone]})]}),e.jsxs("div",{className:"border-t border-dashed border-gray-400 pt-3 mb-4",children:[e.jsx("div",{className:"font-bold border-b border-gray-400 pb-1 mb-2",children:"ITENS VENDIDOS"}),((g=a.items)==null?void 0:g.map((v,b)=>{var _;return e.jsxs("div",{className:"mb-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"flex-1",children:((_=v.menu_item)==null?void 0:_.name)||"Item"}),e.jsxs("span",{className:"w-8 text-center",children:[v.quantity,"x"]}),e.jsxs("span",{className:"w-16 text-right",children:["R$ ",(v.unit_price*v.quantity).toFixed(2)]})]}),v.notes&&e.jsxs("div",{className:"text-xs text-gray-600 ml-2",children:["Obs: ",v.notes]})]},b)}))||e.jsx("div",{className:"text-gray-500 text-center py-2",children:"Nenhum item encontrado"})]}),e.jsxs("div",{className:"border-t border-dashed border-gray-400 pt-3 mb-4",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{children:["R$ ",a.total_amount.toFixed(2)]})]}),a.discount_amount&&a.discount_amount>0&&e.jsxs("div",{className:"flex justify-between mb-1 text-gray-600",children:[e.jsx("span",{children:"Desconto:"}),e.jsxs("span",{children:["-R$ ",a.discount_amount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between font-bold border-t border-black pt-2",children:[e.jsx("span",{children:"TOTAL PAGO:"}),e.jsxs("span",{children:["R$ ",o.toFixed(2)]})]})]}),e.jsxs("div",{className:"border-t border-dashed border-gray-400 pt-3 mb-4",children:[e.jsx("div",{className:"font-bold border-b border-gray-400 pb-1 mb-2",children:"INFORMAES DE PAGAMENTO"}),e.jsxs("div",{children:["Forma: ",h(r)]}),e.jsxs("div",{children:["Valor Pago: ",Pe(o)]}),c&&e.jsxs("div",{children:["Ref.: ",c]}),e.jsx("div",{children:"Status: PAGO "})]}),a.notes&&e.jsxs("div",{className:"border-t border-dashed border-gray-400 pt-3 mb-4",children:[e.jsx("div",{className:"font-bold border-b border-gray-400 pb-1 mb-2",children:"OBSERVAES DO PEDIDO"}),e.jsx("div",{children:a.notes})]}),a.customer_notes&&e.jsxs("div",{className:"border-t border-dashed border-gray-400 pt-3 mb-4",children:[e.jsx("div",{className:"font-bold border-b border-gray-400 pb-1 mb-2",children:"OBSERVAES DO CLIENTE"}),e.jsx("div",{children:a.customer_notes})]}),e.jsxs("div",{className:"bg-green-100 border border-green-300 text-green-800 p-3 text-center font-bold mb-4",children:[e.jsx("div",{children:" PAGAMENTO APROVADO "}),e.jsx("div",{className:"text-xs mt-1",children:"Transao processada com sucesso"})]}),e.jsxs("div",{className:"text-center border-t-2 border-black pt-3 text-xs",children:[e.jsx("div",{children:"Obrigado pela preferncia!"}),e.jsx("div",{children:"Volte sempre!"}),e.jsx("div",{className:"mt-2",children:a.customer_name?`Pontos acumulados: +${Math.floor(a.final_amount/10)}`:"Cadastre-se e ganhe pontos!"}),e.jsxs("div",{className:"mt-2",children:["ID: ",a.id.substring(0,8).toUpperCase()]})]})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsx("button",{onClick:f,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Imprimir Comprovante"})})]})},YU=({comandas:t,onPayComanda:s,disabled:a=!1})=>{const r=l=>{const c=new Date,u=new Date(l),h=Math.floor((c.getTime()-u.getTime())/(1e3*60));if(h<60)return`${h}min`;const f=Math.floor(h/60),p=h%60;return`${f}h ${p}min`},o=l=>{const c=Math.floor((new Date().getTime()-new Date(l).getTime())/6e4);return c>120?"text-red-600 bg-red-50":c>60?"text-orange-600 bg-orange-50":"text-green-600 bg-green-50"};return t.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(ts,{className:"h-6 w-6 text-green-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Comandas Pendentes de Pagamento"})]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ts,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"Todas as comandas foram pagas!"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"No h comandas aguardando pagamento no momento."})]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Vt,{className:"h-6 w-6 text-orange-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Comandas Pendentes de Pagamento"}),e.jsx("span",{className:"bg-orange-100 text-orange-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:t.length})]}),a&&e.jsxs("div",{className:"flex items-center space-x-2 text-amber-600",children:[e.jsx(Ya,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Abra o caixa para processar pagamentos"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(l=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"flex items-center space-x-2",children:l.table?e.jsxs(e.Fragment,{children:[e.jsx(qc,{className:"h-4 w-4 text-gray-600"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["Mesa ",l.table.number]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Wi,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Balco"})]})}),e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${o(l.opened_at)}`,children:r(l.opened_at)})]}),l.customer_name&&e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ss,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:l.customer_name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",l.people_count," pessoas)"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Mr,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:new Date(l.opened_at).toLocaleString("pt-BR")})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:[l.items.length," ",l.items.length===1?"item":"itens"]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Pe(l.total)}),e.jsx("p",{className:"text-xs text-gray-600",children:"Total da comanda"})]}),e.jsx("button",{onClick:()=>s(l),disabled:a,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Receber"})]})]},l.id))})]})},KU=()=>{const{user:t}=Et(),s=Ks(),{currentSession:a,pendingComandas:r,todaysSummary:o,todaysTransactions:l,loading:c,error:u,openCashSession:h,processComandaPayment:f,processCashWithdrawal:p,processTreasuryTransfer:g,refreshData:v}=Om(),{pendingOrders:b,processPayment:_,refreshData:w}=Cm(),[E,T]=y.useState(!1),[N,k]=y.useState(!1),[S,C]=y.useState(!1),[M,z]=y.useState(!1),[A,$]=y.useState(!1),[P,F]=y.useState(!1),[I,J]=y.useState(!1),[pe,te]=y.useState(!1),[L,G]=y.useState(null),[ee,xe]=y.useState(null),[O,H]=y.useState(!1),[B,Y]=y.useState("dinheiro"),[ne,ie]=y.useState(!1),[oe,me]=y.useState(null),[D,q]=y.useState(null),[Q,K]=y.useState(null),[he,we]=y.useState(!0),[_e,Re]=y.useState(!1),[ze,Ie]=y.useState(0),[Me,$e]=y.useState(!1),Z=async re=>{if(!a){alert(" necessrio ter uma sesso de caixa aberta para processar pagamentos.");return}G(re),C(!0)},se=re=>{if(!a){alert(" necessrio ter uma sesso de caixa aberta para processar pagamentos.");return}xe(re),H(!0)},de=async(re,Ee)=>{if(!(!ee||!a))try{ie(!0),await f({comanda_id:ee.id,payment_method:re,amount:ee.total||0,notes:Ee}),console.log(" Pagamento da comanda processado com sucesso"),H(!1),xe(null)}catch(Le){console.error(" Erro ao processar pagamento da comanda:",Le),alert("Erro ao processar pagamento da comanda")}finally{ie(!1)}},Ce=async()=>{if(!(!L||!a)){ie(!0);try{await _({order_id:L.id,payment_method:B,cash_session_id:a.id,amount_paid:L.final_amount}),console.log(" Forando atualizao dos dados aps pagamento..."),await Promise.all([w(),v()]),setTimeout(async()=>{console.log(" Segunda atualizao dos dados..."),await Promise.all([w(),v()])},1e3),me({order:L,paymentMethod:B,amountPaid:L.final_amount,cashierName:(t==null?void 0:t.name)||(t==null?void 0:t.email)||"Operador de Caixa",timestamp:new Date}),C(!1),z(!0),G(null)}catch(re){console.error("Erro ao processar pagamento:",re),alert("Erro ao processar pagamento. Tente novamente.")}finally{ie(!1)}}},ke=()=>{z(!1),me(null)},ye=async re=>{try{const Ee=await p(re);K({withdrawalId:Ee,amount:re.amount,reason:re.reason,authorizedBy:re.authorized_by,recipient:re.recipient,purpose:re.purpose,cashierName:(t==null?void 0:t.name)||(t==null?void 0:t.email)||"Operador de Caixa",timestamp:new Date,sessionId:(a==null?void 0:a.id)||""}),$(!1),te(!0)}catch(Ee){console.error("Erro ao processar sada de dinheiro:",Ee),alert("Erro ao processar sada de dinheiro. Tente novamente.")}},Te=async re=>{try{const Ee=await g(re);q({transferId:Ee,amount:re.amount,transferDate:re.transfer_date,authorizedBy:re.authorized_by,treasuryReceiptNumber:re.treasury_receipt_number,notes:re.notes,cashierName:(t==null?void 0:t.name)||(t==null?void 0:t.email)||"Operador de Caixa",timestamp:new Date,sessionId:(a==null?void 0:a.id)||""}),F(!1),J(!0)}catch(Ee){console.error("Erro ao processar transferncia:",Ee),alert("Erro ao processar transferncia. Tente novamente.")}},Oe=()=>{$(!0)},Ge=()=>{console.log("Exportando relatrio...")},Je=()=>{J(!1),q(null)},rs=()=>{te(!1),K(null)};y.useEffect(()=>{const re=b.length;if(re>ze&&ze>0){Re(!0),we(!0);const Ee=setTimeout(()=>{Re(!1)},1e4);return()=>clearTimeout(Ee)}Ie(re)},[b.length,ze]);const Ue=()=>{we(!1),Re(!1);const re=document.getElementById("pending-orders-section");re&&re.scrollIntoView({behavior:"smooth"})},W=()=>{we(!1),Re(!1)};return c?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})}):u?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(mt,{className:"h-6 w-6 text-red-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Erro no Sistema"}),e.jsx("p",{className:"text-red-600",children:u})]})]})})}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gesto de Caixa"}),e.jsx("p",{className:"text-gray-600 mt-1",children:new Date().toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>s("/cash/movement"),className:"bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 flex items-center space-x-2 transition-colors",children:[e.jsx(KN,{className:"h-5 w-5"}),e.jsx("span",{children:"Movimento"})]}),a?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>F(!0),className:"bg-purple-600 text-white px-4 py-3 rounded-lg hover:bg-purple-700 flex items-center space-x-2 transition-colors",children:[e.jsx(Cc,{className:"h-5 w-5"}),e.jsx("span",{children:"Transferncia"})]}),e.jsxs("button",{onClick:()=>k(!0),className:"bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 flex items-center space-x-2 transition-colors",children:[e.jsx(kt,{className:"h-5 w-5"}),e.jsx("span",{children:"Fechar Caixa"})]})]}):e.jsxs("button",{onClick:()=>T(!0),className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 flex items-center space-x-2 transition-colors",children:[e.jsx(Zs,{className:"h-5 w-5"}),e.jsx("span",{children:"Abrir Caixa"})]})]})]}),a?e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:e.jsx(kt,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"Caixa Aberto"}),e.jsxs("p",{className:"text-green-600",children:["Aberto s ",new Date(a.opened_at).toLocaleTimeString("pt-BR")]}),e.jsxs("p",{className:"text-sm text-green-600",children:["Valor inicial: ",Pe(a.opening_amount)]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-green-800",children:Pe(a.expected_amount)}),e.jsx("p",{className:"text-sm text-green-600",children:"Valor esperado"})]})]})}):e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-8",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"bg-yellow-100 p-3 rounded-full",children:e.jsx(mt,{className:"h-8 w-8 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-yellow-800",children:"Caixa Fechado"}),e.jsx("p",{className:"text-yellow-600",children:" necessrio abrir o caixa para processar pagamentos"})]})]})}),b.length>0&&he&&e.jsx("div",{className:`mb-8 transition-all duration-300 ${_e?"animate-pulse":""}`,children:e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 border-2 border-orange-300 rounded-lg p-6 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`p-3 rounded-full ${_e?"bg-red-200 animate-bounce":"bg-orange-100"}`,children:e.jsxs("div",{className:"relative",children:[e.jsx(h0,{className:`h-8 w-8 ${_e?"text-red-600":"text-orange-600"}`}),b.length>0&&e.jsx("div",{className:`absolute -top-2 -right-2 h-6 w-6 rounded-full flex items-center justify-center text-xs font-bold text-white ${_e?"bg-red-500 animate-ping":"bg-orange-500"}`,children:b.length})]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:`text-xl font-bold flex items-center space-x-2 ${_e?"text-red-800":"text-orange-800"}`,children:[e.jsx("span",{children:"Pedidos Aguardando Pagamento"}),_e&&e.jsx(yg,{className:"h-5 w-5 text-red-600 animate-bounce"})]}),e.jsxs("p",{className:`${_e?"text-red-600":"text-orange-600"} font-medium`,children:[b.length," ",b.length===1?"pedido pendente":"pedidos pendentes"]}),e.jsx("div",{className:"mt-2 text-sm text-gray-700",children:e.jsxs("p",{children:["Valor total: ",e.jsx("span",{className:"font-semibold text-green-600",children:Pe(b.reduce((re,Ee)=>re+Ee.final_amount,0))})]})})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:Ue,className:`px-6 py-3 rounded-lg font-medium flex items-center space-x-2 transition-all duration-200 ${_e?"bg-red-600 hover:bg-red-700 text-white shadow-lg transform hover:scale-105":"bg-orange-600 hover:bg-orange-700 text-white"}`,children:[e.jsx(Ws,{className:"h-5 w-5"}),e.jsx("span",{children:"Ver Pedidos"})]}),e.jsx("button",{onClick:W,className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors",title:"Dispensar alerta","aria-label":"Dispensar alerta",children:e.jsx(lt,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-orange-200",children:[e.jsx("h4",{className:"text-sm font-medium text-orange-800 mb-3",children:"Pedidos mais recentes:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:b.slice(0,3).map(re=>e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-orange-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("span",{className:"font-bold text-gray-900",children:["#",re.order_number.toString().padStart(4,"0")]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(re.created_at).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]}),re.customer_name&&e.jsx("p",{className:"text-sm text-gray-700 mb-1 truncate",children:re.customer_name}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[(re.items||[]).length," ",(re.items||[]).length===1?"item":"itens"]}),e.jsx("span",{className:"font-bold text-green-600",children:Pe(re.final_amount)})]})]},re.id))}),b.length>3&&e.jsxs("p",{className:"text-sm text-orange-600 mt-3 text-center",children:["+",b.length-3," pedidos adicionais aguardando pagamento"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsx(ma,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Vendas Hoje"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Pe(o.total_sales)})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:e.jsx(xO,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Transaes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.total_transactions})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:e.jsx(bg,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Ticket Mdio"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Pe(o.avg_ticket)})]})]})}),e.jsx("div",{className:`bg-white rounded-lg shadow p-6 relative ${r.length>0?"ring-2 ring-orange-300":""}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-3 rounded-full ${r.length>0,"bg-orange-100"}`,children:e.jsx(Vt,{className:`h-6 w-6 ${r.length>0,"text-orange-600"}`})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Comandas Pendentes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]}),r.length>0&&e.jsx("div",{className:"absolute -top-2 -right-2 h-6 w-6 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold animate-pulse",children:"!"})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Vendas por Mtodo de Pagamento"}),e.jsx("div",{className:"space-y-4",children:o.by_payment_method.map(re=>{const Ee=re.payment_method==="dinheiro"?iR:re.payment_method==="pix"?io:Wi;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ee,{className:"h-5 w-5 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Rc[re.payment_method]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:Pe(re.amount)}),e.jsxs("p",{className:"text-xs text-gray-600",children:[re.percentage.toFixed(1),"%"]})]})]},re.payment_method)})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance por Funcionrio"}),e.jsx("div",{className:"space-y-4",children:o.by_employee.map(re=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-gray-100 p-2 rounded-full",children:e.jsx(Ss,{className:"h-4 w-4 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:re.employee_name}),e.jsxs("p",{className:"text-xs text-gray-600",children:[re.transaction_count," transaes"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:Pe(re.total_sales)}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Mdia: ",Pe(re.avg_ticket)]})]})]},re.employee_id))})]})]}),e.jsx(ZU,{transactions:l,onAddWithdrawal:Oe,onExportReport:Ge,isCashSessionOpen:(a==null?void 0:a.status)==="open"}),e.jsx("div",{className:"mb-8",children:e.jsx(YU,{comandas:r,onPayComanda:se,disabled:!a||ne})}),e.jsxs("div",{id:"pending-orders-section",className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(pn,{className:"h-6 w-6 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Pedidos de Balco Aguardando Pagamento"}),e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:b.length})]}),e.jsxs("button",{onClick:async()=>{$e(!0);try{console.log(" Atualizando pedidos de balco..."),await w(),console.log(" Pedidos atualizados!")}catch(re){console.error(" Erro ao atualizar:",re)}finally{$e(!1)}},disabled:Me,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed",title:"Atualizar lista de pedidos",children:[e.jsx(Cc,{className:`h-4 w-4 ${Me?"animate-spin":""}`}),e.jsx("span",{children:Me?"Atualizando...":"Atualizar"})]})]}),b.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(pn,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"Todos os pedidos foram pagos!"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"No h pedidos de balco aguardando pagamento."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map(re=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["#",re.order_number.toString().padStart(4,"0")]}),e.jsx("span",{className:"bg-yellow-100 text-yellow-800 text-xs font-medium px-2 py-1 rounded-full",children:"Aguardando Pagamento"})]}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(re.created_at).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]}),re.customer_name&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:re.customer_name}),re.customer_phone&&e.jsx("p",{className:"text-xs text-gray-600",children:re.customer_phone})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-700 mb-1",children:[(re.items||[]).length," ",(re.items||[]).length===1?"item":"itens"]}),e.jsxs("div",{className:"space-y-1",children:[(re.items||[]).slice(0,3).map((Ee,Le)=>{var rt;return e.jsxs("p",{className:"text-xs text-gray-600",children:[Ee.quantity,"x ",((rt=Ee.menu_item)==null?void 0:rt.name)||"Item"]},Le)}),(re.items||[]).length>3&&e.jsxs("p",{className:"text-xs text-gray-500 italic",children:["+",(re.items||[]).length-3," mais..."]})]})]}),re.customer_notes&&e.jsx("div",{className:"mb-3 p-2 bg-yellow-50 rounded border",children:e.jsx("p",{className:"text-xs text-yellow-800",children:re.customer_notes})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-lg font-bold text-green-600",children:Pe(re.final_amount)}),e.jsx("button",{onClick:()=>Z(re),disabled:!a,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Receber Pagamento"})]})]},re.id))})]}),e.jsx(UU,{isOpen:E,onClose:()=>T(!1),onOpenCash:h}),a&&e.jsx(BU,{isOpen:N,onClose:()=>k(!1),session:a}),S&&L&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-h-screen overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Receber Pagamento - #",L.order_number.toString().padStart(4,"0")]}),e.jsx("button",{onClick:()=>C(!1),className:"text-gray-400 hover:text-gray-600","aria-label":"Fechar modal",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Resumo do Pedido"}),L.customer_name&&e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Cliente: ",L.customer_name]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[(L.items||[]).map((re,Ee)=>{var Le;return e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[re.quantity,"x ",(Le=re.menu_item)==null?void 0:Le.name]}),e.jsx("span",{children:Pe(re.unit_price*re.quantity)})]},Ee)}),(L.discount_amount||0)>0&&e.jsxs("div",{className:"flex justify-between text-green-600 border-t pt-1",children:[e.jsx("span",{children:"Desconto:"}),e.jsxs("span",{children:["-",Pe(L.discount_amount||0)]})]}),e.jsxs("div",{className:"border-t pt-2 flex justify-between font-medium",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{children:Pe(L.final_amount)})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mtodo de Pagamento"}),e.jsxs("select",{value:B,onChange:re=>Y(re.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent","aria-label":"Mtodo de pagamento",children:[e.jsx("option",{value:"dinheiro",children:"Dinheiro"}),e.jsx("option",{value:"cartao_debito",children:"Carto de Dbito"}),e.jsx("option",{value:"cartao_credito",children:"Carto de Crdito"}),e.jsx("option",{value:"pix",children:"PIX"}),e.jsx("option",{value:"transferencia",children:"Transferncia"})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>C(!1),className:"flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:Ce,disabled:ne||!a,className:"flex-1 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:ne?"Processando...":"Processar e Imprimir"})]})]})}),e.jsx(G2,{isOpen:O,comanda:ee,onClose:()=>{H(!1),xe(null)},onConfirm:de,loading:ne}),M&&oe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 sticky top-0 bg-white pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Pagamento Processado!"})]}),e.jsx("button",{onClick:ke,className:"text-gray-400 hover:text-gray-600",title:"Fechar modal de comprovante","aria-label":"Fechar modal de comprovante",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"mb-6 text-center",children:[e.jsxs("p",{className:"text-gray-600 mb-2",children:["Pagamento de #",oe.order.order_number.toString().padStart(4,"0")," processado com sucesso!"]}),e.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Comprovante de pagamento gerado"})]}),e.jsx("div",{className:"mb-6",children:e.jsx(WU,{receiptData:oe,onPrint:ke})}),e.jsxs("div",{className:"flex space-x-3 sticky bottom-0 bg-white pt-4 border-t",children:[e.jsx("button",{onClick:ke,className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Fechar"}),e.jsxs("button",{onClick:()=>{console.log("Reimprimindo comprovante de pagamento...")},className:"flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a2 2 0 002 2h6a2 2 0 002-2v-2h1a2 2 0 002-2V9a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z",clipRule:"evenodd"})}),e.jsx("span",{children:"Reimprimir"})]})]})]})}),e.jsx(VU,{isOpen:A,onClose:()=>$(!1),onProcessWithdrawal:ye,currentCashBalance:(a==null?void 0:a.expected_amount)||0,loading:ne}),e.jsx(qU,{isOpen:P,onClose:()=>F(!1),onProcessTransfer:Te,currentCashBalance:(a==null?void 0:a.expected_amount)||0,loading:ne}),I&&D&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Transferncia Processada!"})]}),e.jsx("button",{onClick:Je,className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Fechar modal de comprovante","aria-label":"Fechar modal de comprovante",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-600 mb-4 text-center",children:"Transferncia para tesouraria processada com sucesso!"}),e.jsx("p",{className:"text-sm text-green-600 font-medium text-center mb-4",children:"Comprovante de transferncia gerado"}),e.jsx(FU,{receiptData:D,onPrint:Je})]}),e.jsx("div",{className:"flex space-x-3 p-6 pt-0 border-t border-gray-200",children:e.jsx("button",{onClick:Je,className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Fechar"})})]})}),pe&&Q&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Sada de Dinheiro Processada!"})]}),e.jsx("button",{onClick:rs,className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Fechar modal de comprovante","aria-label":"Fechar modal de comprovante",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-600 mb-4 text-center",children:"Sada de dinheiro processada com sucesso!"}),e.jsx("p",{className:"text-sm text-orange-600 font-medium text-center mb-4",children:"Comprovante gerado para assinatura"}),e.jsx(GU,{receiptData:Q,onPrint:rs})]}),e.jsx("div",{className:"flex space-x-3 p-6 pt-0 border-t border-gray-200",children:e.jsx("button",{onClick:rs,className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Fechar"})})]})}),b.length>0&&!he&&e.jsx("div",{className:"fixed bottom-6 right-6 z-40",children:e.jsxs("button",{onClick:Ue,className:"bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-full p-4 shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-200 flex items-center space-x-2 animate-bounce",title:`${b.length} pedidos aguardando pagamento`,children:[e.jsxs("div",{className:"relative",children:[e.jsx(h0,{className:"h-6 w-6"}),e.jsx("div",{className:"absolute -top-2 -right-2 h-5 w-5 bg-white rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-orange-600 text-xs font-bold",children:b.length})})]}),e.jsx("span",{className:"hidden sm:block font-medium",children:"Pedidos Pendentes"})]})})]})},XU=()=>e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Relatrios de Caixa"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Anlise detalhada das operaes financeiras"})]}),e.jsxs("button",{className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[e.jsx(Vc,{className:"h-5 w-5"}),e.jsx("span",{children:"Exportar"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Filtros"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Perodo"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{children:"Hoje"}),e.jsx("option",{children:"Esta Semana"}),e.jsx("option",{children:"Este Ms"}),e.jsx("option",{children:"Personalizado"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Funcionrio"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{children:"Todos"}),e.jsx("option",{children:"Joo Silva"}),e.jsx("option",{children:"Maria Santos"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mtodo de Pagamento"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{children:"Todos"}),e.jsx("option",{children:"Dinheiro"}),e.jsx("option",{children:"Carto"}),e.jsx("option",{children:"PIX"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Aplicar Filtros"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:e.jsx(ma,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Vendas Totais"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"R$ 12.450,00"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsx(bg,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Transaes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"247"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:e.jsx(Mr,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Sesses"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"8"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-orange-100 p-3 rounded-full",children:e.jsx(ma,{className:"h-6 w-6 text-orange-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Ticket Mdio"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"R$ 50,40"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Vendas por Dia"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Grfico de vendas dirias (a implementar)"})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Mtodos de Pagamento"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Grfico de pizza (a implementar)"})})]})]})]}),QU=()=>e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex justify-between items-center mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Histrico de Transaes"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Todas as transaes registradas no sistema"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0 md:space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Ka,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",placeholder:"Buscar por cliente, valor, mtodo...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[e.jsx(vg,{className:"h-4 w-4"}),e.jsx("span",{children:"Filtros"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[e.jsx(Mr,{className:"h-4 w-4"}),e.jsx("span",{children:"Perodo"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[e.jsx(QM,{className:"h-4 w-4"}),e.jsx("span",{children:"Ordenar"})]})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data/Hora"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mtodo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Funcionrio"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"08/09/2025 14:30"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Venda"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Maria Silva"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"PIX"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"R$ 45,80"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Joo Santos"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Concluda"})})]}),e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:[e.jsx("p",{children:"Carregando transaes..."}),e.jsx("p",{className:"text-sm mt-1",children:"A integrao com dados reais ser implementada"})]})})]})]})}),e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Anterior"}),e.jsx("button",{className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Prximo"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Mostrando ",e.jsx("span",{className:"font-medium",children:"1"})," at ",e.jsx("span",{className:"font-medium",children:"10"})," de"," ",e.jsx("span",{className:"font-medium",children:"247"})," resultados"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx("button",{className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Anterior"}),e.jsx("button",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",children:"1"}),e.jsx("button",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-blue-600 text-sm font-medium text-white",children:"2"}),e.jsx("button",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",children:"3"}),e.jsx("button",{className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Prximo"})]})})]})]})]})]}),JU=()=>{const{user:t}=Et(),{currentSession:s,loading:a,error:r}=Om();return y.useEffect(()=>{console.log("CashTest: Usurio:",t),console.log("CashTest: Sesso atual:",s),console.log("CashTest: Loading:",a),console.log("CashTest: Error:",r)},[t,s,a,r]),e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Teste de Cash Management"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gray-100 rounded",children:[e.jsx("h3",{className:"font-semibold",children:"Usurio:"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]}),e.jsxs("div",{className:"p-4 bg-gray-100 rounded",children:[e.jsx("h3",{className:"font-semibold",children:"Sesso Atual:"}),e.jsx("pre",{children:JSON.stringify(s,null,2)})]}),e.jsxs("div",{className:"p-4 bg-gray-100 rounded",children:[e.jsx("h3",{className:"font-semibold",children:"Status:"}),e.jsxs("p",{children:["Loading: ",a.toString()]}),e.jsxs("p",{children:["Error: ",r||"Nenhum erro"]})]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Recarregar Pgina"})]})]})},eB=({onNewOrder:t,onOrderUpdate:s,empresaId:a})=>{const r=y.useCallback(o=>{var l;console.log(" REALTIME CAIXA:",o.eventType,(l=o.new)==null?void 0:l.status),o.eventType==="INSERT"&&(console.log(" Novo pedido no caixa!"),t==null||t()),o.eventType==="UPDATE"&&(console.log(" Pedido atualizado no caixa"),s==null||s())},[t,s]);y.useEffect(()=>{console.log(" Conectando realtime do caixa...");const o=V.channel("cash-realtime").on("postgres_changes",{event:"*",schema:"public",table:"balcao_orders",filter:a?`empresa_id=eq.${a}`:void 0},r).subscribe(l=>{l==="SUBSCRIBED"?console.log(" Realtime do caixa ativo!"):l==="CHANNEL_ERROR"&&console.error(" Erro no realtime do caixa")});return()=>{console.log(" Desconectando realtime do caixa"),o.unsubscribe()}},[r,a])},tB=()=>{const{getDailyCashMovement:t}=Om();eB({onNewOrder:()=>{console.log(" Novo pedido detectado! Recarregando..."),s===fc()&&w(s)},onOrderUpdate:()=>{console.log(" Pedido atualizado! Recarregando..."),s===fc()&&w(s)}});const[s,a]=y.useState(fc()),[r,o]=y.useState(null),[l,c]=y.useState(!1),[u,h]=y.useState(null),[f,p]=y.useState(!0),[g,v]=y.useState(!0),[b,_]=y.useState(!0),w=async S=>{c(!0),h(null);try{const C=await t(S);o(C)}catch(C){const M=C.message||"Erro ao carregar dados do movimento";h(M),console.error("Erro ao carregar movimento dirio:",C),o({sessions:[],transactions:[],summary:{opening_total:0,closing_total:0,sales_total:0,cash_sales:0,card_sales:0,pix_sales:0,adjustments:0,discrepancy_total:0,transaction_count:0}})}finally{c(!1)}};y.useEffect(()=>{w(s)},[s]);const E=S=>new Date(S).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),T=S=>{const C={open:{bg:"bg-green-100",text:"text-green-800",label:"Aberto"},closed:{bg:"bg-gray-100",text:"text-gray-800",label:"Fechado"},reconciled:{bg:"bg-blue-100",text:"text-blue-800",label:"Reconciliado"}},M=C[S]||C.closed;return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${M.bg} ${M.text}`,children:M.label})},N=S=>({sale:"text-green-600",refund:"text-red-600",adjustment:"text-blue-600",tip:"text-purple-600"})[S]||"text-gray-600",k=({isVisible:S,onClick:C,title:M})=>e.jsxs("button",{onClick:C,className:"flex items-center space-x-1 text-sm text-gray-600 hover:text-gray-800",title:S?`Ocultar ${M}`:`Mostrar ${M}`,children:[S?e.jsx(fn,{className:"h-4 w-4"}):e.jsx(Ws,{className:"h-4 w-4"}),e.jsx("span",{children:S?"Ocultar":"Mostrar"})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:e.jsx(Mr,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Movimento do Caixa"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Consulte o movimento detalhado por data"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"date",value:s,onChange:S=>a(S.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:l,"aria-label":"Selecione a data"}),e.jsx("button",{onClick:()=>w(s),disabled:l,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:l?"Carregando...":"Consultar"})]})]}),u&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ya,{className:"h-5 w-5 text-red-600"}),e.jsx("p",{className:"text-red-800",children:u})]})}),l&&e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"inline-flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-gray-600",children:"Carregando movimento..."})]})}),r&&!l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Resumo do Dia"}),e.jsx(k,{isVisible:b,onClick:()=>_(!b),title:"resumo"})]}),b&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-lg inline-flex",children:e.jsx(kt,{className:"h-6 w-6 text-green-600"})}),e.jsx("p",{className:"mt-2 text-sm font-medium text-gray-600",children:"Vendas Totais"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Pe(r.summary.sales_total)})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-lg inline-flex",children:e.jsx(Ss,{className:"h-6 w-6 text-blue-600"})}),e.jsx("p",{className:"mt-2 text-sm font-medium text-gray-600",children:"Sesses"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.sessions.length})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-lg inline-flex",children:e.jsx(ma,{className:"h-6 w-6 text-purple-600"})}),e.jsx("p",{className:"mt-2 text-sm font-medium text-gray-600",children:"Transaes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.summary.transaction_count})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-yellow-100 p-3 rounded-lg inline-flex",children:e.jsx(Ya,{className:"h-6 w-6 text-yellow-600"})}),e.jsx("p",{className:"mt-2 text-sm font-medium text-gray-600",children:"Discrepncias"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:Pe(Math.abs(r.summary.discrepancy_total))})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Por Mtodo de Pagamento"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Dinheiro"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Pe(r.summary.cash_sales)})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Cartes"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Pe(r.summary.card_sales)})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"PIX"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Pe(r.summary.pix_sales)})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Ajustes"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:Pe(r.summary.adjustments)})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Sesses do Dia (",r.sessions.length,")"]}),e.jsx(k,{isVisible:f,onClick:()=>p(!f),title:"sesses"})]}),f&&e.jsx("div",{className:"p-6",children:r.sessions.length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"Nenhuma sesso encontrada para esta data"}):e.jsx("div",{className:"space-y-4",children:r.sessions.map(S=>{var C;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:e.jsx(Ss,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:((C=S.employee)==null?void 0:C.name)||"Funcionrio"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Sesso #",S.id.slice(-8)]})]})]}),T(S.status)]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Abertura"}),e.jsx("p",{className:"text-lg font-bold text-green-600",children:Pe(S.opening_amount)}),e.jsx("p",{className:"text-xs text-gray-500",children:E(S.opened_at)})]}),S.closed_at&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Fechamento"}),e.jsx("p",{className:"text-lg font-bold text-red-600",children:Pe(S.closing_amount||0)}),e.jsx("p",{className:"text-xs text-gray-500",children:E(S.closed_at)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Esperado"}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:Pe(S.expected_amount)})]}),S.cash_discrepancy!==null&&S.cash_discrepancy!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Discrepncia"}),e.jsx("p",{className:`text-lg font-bold ${S.cash_discrepancy>=0?"text-green-600":"text-red-600"}`,children:Pe(S.cash_discrepancy)})]})]}),(S.opening_notes||S.closing_notes)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[S.opening_notes&&e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Obs. Abertura:"})," ",S.opening_notes]}),S.closing_notes&&e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Obs. Fechamento:"})," ",S.closing_notes]})]})]},S.id)})})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Transaes do Dia (",r.transactions.length,")"]}),e.jsx(k,{isVisible:g,onClick:()=>v(!g),title:"transaes"})]}),g&&e.jsx("div",{className:"p-6",children:r.transactions.length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"Nenhuma transao encontrada para esta data"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Horrio"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Tipo"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Mtodo"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-600",children:"Valor"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Cliente/Obs"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Funcionrio"})]})}),e.jsx("tbody",{children:r.transactions.map(S=>{var C;return e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 text-sm text-gray-900",children:E(S.processed_at)}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`text-sm font-medium ${N(S.transaction_type)}`,children:F2[S.transaction_type]||S.transaction_type})}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:Rc[S.payment_method]||S.payment_method}),e.jsx("td",{className:`py-3 px-4 text-right text-sm font-medium ${S.amount>=0?"text-green-600":"text-red-600"}`,children:Pe(S.amount)}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:S.comanda?e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium text-blue-600",children:["Comanda #",Nm(S.comanda.id)]}),S.comanda.customer_name&&e.jsx("div",{className:"text-xs text-gray-500",children:S.comanda.customer_name}),S.comanda.table_number&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Mesa ",S.comanda.table_number]})]}):S.notes&&(S.notes.includes("Pedido Balco")||S.notes.includes("Pedido de balco"))?e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium text-green-600",children:["Pedido Balco ",I2(S.notes)]}),S.customer_name&&e.jsx("div",{className:"text-xs text-gray-500",children:S.customer_name}),e.jsx("div",{className:"text-xs text-gray-500",children:"Balco"})]}):S.customer_name||S.notes||"-"}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:((C=S.processed_by_employee)==null?void 0:C.name)||"Funcionrio"})]},S.id)})})]})})})]})]})]})},sB=()=>e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs(O_,{children:[e.jsx(ot,{path:"/",element:e.jsx(KU,{})}),e.jsx(ot,{path:"/reports",element:e.jsx(XU,{})}),e.jsx(ot,{path:"/transactions",element:e.jsx(QU,{})}),e.jsx(ot,{path:"/movement",element:e.jsx(tB,{})}),e.jsx(ot,{path:"/test",element:e.jsx(JU,{})})]})});var yS=(t=>(t.ABERTA="aberta",t.PENDENTE_PAGAMENTO="pendente_pagamento",t.FECHADA="fechada",t.CANCELADA="cancelada",t))(yS||{}),Pu=(t=>(t.PENDENTE="pendente",t.PREPARANDO="preparando",t.PRONTO="pronto",t.ENTREGUE="entregue",t.CANCELADO="cancelado",t))(Pu||{});const j_=10,fi=0,pi=30;class zs{static validatePercentage(s){return s>=fi&&s<=pi&&!isNaN(s)&&isFinite(s)}static calculateCommission(s,a){if(!this.validatePercentage(a))throw new Error(`Percentual de comisso deve estar entre ${fi}% e ${pi}%`);if(s<=0)throw new Error("Valor base deve ser maior que zero");return s*a/100}static calculateTotal(s,a){const r=this.calculateCommission(s,a);return s+r}static calculateWithValidation(s,a){try{if(!this.validatePercentage(a))return{valor_base:s,percentual_comissao:a,valor_comissao:0,valor_total:s,percentual_valido:!1,erro:`Percentual deve estar entre ${fi}% e ${pi}%`};if(s<=0)return{valor_base:s,percentual_comissao:a,valor_comissao:0,valor_total:s,percentual_valido:!1,erro:"Valor base deve ser maior que zero"};const o=this.calculateCommission(s,a),l=s+o;return{valor_base:s,percentual_comissao:a,valor_comissao:o,valor_total:l,percentual_valido:!0}}catch(r){return{valor_base:s,percentual_comissao:a,valor_comissao:0,valor_total:s,percentual_valido:!1,erro:r instanceof Error?r.message:"Erro desconhecido"}}}static validateCommissionData(s,a){const r=[];let o=!0,l;s<=0&&(o=!1,l="Valor base deve ser maior que zero"),this.validatePercentage(a)||(o=!1,l=`Percentual deve estar entre ${fi}% e ${pi}%`,a<fi?r.push(`Percentual mnimo  ${fi}%`):a>pi&&r.push(`Percentual mximo  ${pi}%`)),o&&(a===0?r.push("Comisso zerada - confirme se est correto"):a<5?r.push("Percentual baixo - considere o padro de 10%"):a>20&&r.push("Percentual alto - verifique se est correto"));const c=o?this.calculateCommission(s,a):0;return{valido:o,percentual:a,valor_calculado:c,mensagem_erro:l,sugestoes:r.length>0?r:void 0}}static calculatePercentageFromAmount(s,a){if(s<=0)throw new Error("Valor base deve ser maior que zero");return a/s*100}static formatCurrency(s){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s)}static formatPercentage(s){return`${s.toFixed(1)}%`}}zs.validatePercentage;zs.calculateCommission;zs.calculateTotal;zs.formatCurrency;const aB=({isOpen:t,comanda:s,onClose:a,onConfirm:r,loading:o=!1})=>{var _;const[l,c]=y.useState(j_),[u,h]=y.useState(""),[f,p]=y.useState(),g=zs.calculateWithValidation(s.total,l);y.useEffect(()=>{t&&(c(j_),h(""),p(void 0))},[t]);const v=w=>{const E=parseFloat(w)||0;c(E),p(void 0)},b=async()=>{try{if(p(void 0),!g.percentual_valido){p(g.erro);return}const w={comanda_id:s.id,valor_base:s.total,percentual_comissao:l,valor_comissao:g.valor_comissao,valor_total:g.valor_total,metodo_pagamento:"dinheiro",observacoes:u.trim()||void 0};await r(w)}catch(w){p(w instanceof Error?w.message:"Erro ao processar fechamento")}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(m0,{className:"w-6 h-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Fechamento de Conta"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Comanda #",Nm(s.id),((_=s.mesa)==null?void 0:_.numero)&&` - Mesa ${s.mesa.numero}`]})]})]}),e.jsx("button",{onClick:a,disabled:o,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(lt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"Itens Consumidos"}),s.itens&&s.itens.length>0&&e.jsxs("span",{className:"text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:[s.itens.length," ",s.itens.length===1?"item":"itens"]})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 max-h-60 overflow-y-auto",children:s.itens&&s.itens.length>0?e.jsxs("div",{className:"space-y-3",children:[s.itens.map((w,E)=>e.jsxs("div",{className:"flex justify-between items-start bg-white rounded-lg p-3 shadow-sm",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs bg-gray-200 text-gray-600 px-2 py-1 rounded-full",children:E+1}),e.jsx("div",{className:"font-medium text-gray-900",children:w.nome_produto})]}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[e.jsxs("span",{className:"font-medium",children:[w.quantidade,"x"]})," ",zs.formatCurrency(w.preco_unitario),w.observacoes&&e.jsxs("div",{className:"text-xs text-gray-400 italic mt-1",children:["Obs: ",w.observacoes]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium text-gray-900",children:zs.formatCurrency(w.preco_total)}),e.jsx("div",{className:"text-xs text-gray-500",children:w.quantidade>1&&`${w.quantidade} unidades`})]})]},w.id)),e.jsx("div",{className:"border-t pt-3 mt-3 bg-white rounded-lg p-3",children:e.jsxs("div",{className:"flex justify-between items-center font-semibold text-gray-900",children:[e.jsx("span",{children:"Subtotal dos Itens"}),e.jsx("span",{className:"text-lg",children:zs.formatCurrency(s.total)})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 mb-2",children:e.jsx(m0,{className:"w-12 h-12 mx-auto"})}),e.jsx("p",{className:"text-gray-500",children:"Nenhum item encontrado na comanda"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Verifique se a comanda possui itens adicionados"})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Comisso do Garom"}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Percentual de Comisso (0% - 30%)"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"number",min:"0",max:"30",step:"0.1",value:l,onChange:w=>v(w.target.value),disabled:o,className:`flex-1 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${g.percentual_valido?"border-gray-300":"border-red-300 bg-red-50"}`,placeholder:"10.0"}),e.jsx("span",{className:"text-sm text-gray-500",children:"%"}),e.jsx("button",{type:"button",onClick:()=>c(0),disabled:o,className:"px-3 py-2 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Zerar"})]}),!g.percentual_valido&&g.erro&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:g.erro}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Voc pode ajustar o percentual ou zer-lo completamente"})]}),g.percentual_valido&&e.jsxs("div",{className:"bg-white rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Valor da comisso:"}),e.jsx("span",{className:"font-medium",children:zs.formatCurrency(g.valor_comissao)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Percentual aplicado:"}),e.jsx("span",{className:"font-medium",children:zs.formatPercentage(g.percentual_comissao)})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observaes (opcional)"}),e.jsx("textarea",{value:u,onChange:w=>h(w.target.value),disabled:o,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Adicione observaes sobre o fechamento..."})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-blue-600 mt-0.5",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-1",children:"Envio para Caixa"}),e.jsxs("p",{className:"text-sm text-blue-700",children:["Esta comanda ser enviada como ",e.jsx("strong",{children:"pendente de pagamento"})," para o caixa. O operador do caixa escolher o mtodo de pagamento (dinheiro, carto, PIX, etc.) no momento do processamento."]})]})]})}),f&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-red-600 mt-0.5",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-red-800 mb-1",children:"Erro no Processamento"}),e.jsx("p",{className:"text-red-700 text-sm",children:f})]})]})})]}),e.jsx("div",{className:"border-t bg-gray-50 p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Valor dos itens:"}),e.jsx("span",{children:zs.formatCurrency(s.total)})]}),g.percentual_valido&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Comisso (",zs.formatPercentage(l),"):"]}),e.jsx("span",{children:zs.formatCurrency(g.valor_comissao)})]}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Total a Pagar:"}),e.jsx("span",{className:"text-2xl font-bold text-green-600",children:zs.formatCurrency(g.percentual_valido?g.valor_total:s.total)})]})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,disabled:o,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancelar"}),e.jsx("button",{onClick:b,disabled:o||!g.percentual_valido,className:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Enviando para Caixa..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Wi,{className:"w-4 h-4"}),"Fechar e Enviar para Caixa"]})})]})]})})]})}):null},rB=(t={})=>{const[s,a]=y.useState(!1),[r,o]=y.useState(null),[l,c]=y.useState(!1),[u,h]=y.useState(null),f=y.useCallback(b=>{o(b),a(!0),h(null)},[]),p=y.useCallback(()=>{a(!1),o(null),h(null),c(!1)},[]),g=y.useCallback(()=>{h(null)},[]),v=y.useCallback(async b=>{try{c(!0),h(null),console.log(" Processando fechamento de comanda:",b),await new Promise(w=>setTimeout(w,1e3));const _={success:!0,data:{transaction_id:`TXN-${Date.now()}`,reference_number:`REF-${Date.now()}`,pending_id:`PEND-${Date.now()}`,total_amount:b.valor_total,commission_amount:b.valor_comissao,payment_method:b.metodo_pagamento,receipt:void 0,processed_at:new Date().toISOString(),additional_data:{status:"pending_payment",message:"Comanda enviada para processamento no caixa"}}};return t.onSuccess&&t.onSuccess(_),setTimeout(()=>{p()},1500),_}catch(_){const w=_ instanceof Error?_:new Error("Erro interno do sistema");return h(w.message),t.onError&&t.onError(w),{success:!1,error:{type:"system",message:w.message,details:{error:w instanceof Error?w.stack:String(w)}}}}finally{c(!1)}},[p,t]);return{isOpen:s,selectedComanda:r,loading:l,error:u,openModal:f,closeModal:p,handleConfirm:v,clearError:g}},nB={id:"CMD-TEST-001",mesa_id:"MESA-05",cliente_id:"CLI-123",nome_cliente:"Joo Silva",funcionario_id:"FUNC-001",status:"aberta",total:87.5,quantidade_pessoas:4,aberta_em:new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString(),data_abertura:new Date().toISOString(),mesa:{id:"MESA-05",numero:5,capacidade:6},itens:[{id:"ITEM-001",comanda_id:"CMD-TEST-001",produto_id:"PROD-001",nome_produto:"Bolinho de Bacalhau",quantidade:2,preco_unitario:16.9,preco_total:33.8,status:"entregue",adicionado_em:new Date().toISOString(),entregue_em:new Date().toISOString(),created_at:new Date().toISOString(),observacoes:"Sem cebola"},{id:"ITEM-002",comanda_id:"CMD-TEST-001",produto_id:"PROD-002",nome_produto:"Cerveja Heineken 350ml",quantidade:3,preco_unitario:10.3,preco_total:30.9,status:"entregue",adicionado_em:new Date().toISOString(),entregue_em:new Date().toISOString(),created_at:new Date().toISOString()}]},oB=()=>{const{isOpen:t,selectedComanda:s,loading:a,error:r,openModal:o,closeModal:l,handleConfirm:c,clearError:u}=rB({onSuccess:h=>{console.log(" Teste - Modal funcionou:",h),alert("Modal funcionou! Verifique o console.")},onError:h=>{console.error(" Teste - Erro no modal:",h),alert(`Erro no modal: ${h.message}`)}});return e.jsxs("div",{className:"p-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Teste do Novo Modal"}),e.jsx("button",{onClick:()=>o(nB),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Abrir Modal de Teste"}),r&&e.jsx("div",{className:"mt-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{children:["Erro: ",r]}),e.jsx("button",{onClick:u,className:"text-red-600 hover:text-red-800",children:""})]})}),s&&e.jsx(aB,{isOpen:t,comanda:s,onClose:l,onConfirm:c,loading:a})]})},iB=()=>{const{user:t}=Et(),[s,a]=y.useState("empresa"),[r,o]=y.useState(!0),[l,c]=y.useState(!1),[u,h]=y.useState(""),[f,p]=y.useState(""),[g,v]=y.useState({nome:"",cnpj:"",email_admin:"",telefone:"",endereco:{logradouro:"",cidade:"",estado:"",cep:""}});y.useEffect(()=>{(async()=>{if(!t){console.log(" ConfiguracoesEmpresa: Usurio no autenticado");return}try{o(!0),h(""),console.log(" ConfiguracoesEmpresa: Carregando dados para usurio:",t.id,t.email);let w=null;console.log(" ConfiguracoesEmpresa: Buscando na tabela usuarios_empresa...");const{data:E,error:T}=await V.from("usuarios_empresa").select("empresa_id").eq("user_id",t.id).single();if(console.log(" ConfiguracoesEmpresa: Resultado usuarios_empresa:",{usuarioEmpresa:E,userError:T}),E!=null&&E.empresa_id)w=E.empresa_id,console.log(" ConfiguracoesEmpresa: Empresa encontrada via usuarios_empresa:",w);else{console.log(" ConfiguracoesEmpresa: No encontrou na usuarios_empresa, tentando por email...");const{data:S,error:C}=await V.from("empresas").select("id").eq("email_admin",t.email).limit(1);console.log(" ConfiguracoesEmpresa: Resultado empresas por email:",{empresasPorEmail:S,emailError:C}),S&&S.length>0&&(w=S[0].id,console.log(" ConfiguracoesEmpresa: Empresa encontrada via email:",w))}if(!w){console.error(" ConfiguracoesEmpresa: Usurio no est associado a nenhuma empresa"),h("Usurio no est associado a nenhuma empresa. Entre em contato com o suporte.");return}console.log(" ConfiguracoesEmpresa: Carregando dados da empresa:",w);const{data:N,error:k}=await V.from("empresas").select("nome, cnpj, email_admin, telefone, endereco").eq("id",w).single();if(console.log(" ConfiguracoesEmpresa: Resultado dados empresa:",{empresaData:N,empresaError:k}),k){console.error(" ConfiguracoesEmpresa: Erro ao carregar dados da empresa:",k),h(`Erro ao carregar dados da empresa: ${k.message}`);return}if(N){const S=N.endereco||{};v({nome:N.nome||"",cnpj:N.cnpj||"",email_admin:N.email_admin||"",telefone:N.telefone||"",endereco:{logradouro:S.logradouro||"",cidade:S.cidade||"",estado:S.estado||"",cep:S.cep||""}})}}catch(w){console.error("Erro ao carregar dados:",w),h("Erro interno ao carregar dados")}finally{o(!1)}})()},[t]);const b=async()=>{if(t)try{c(!0),h(""),p("");const _=await bt();if(!_){h("Erro ao identificar empresa do usurio. Verifique se voc est logado corretamente.");return}if(!g.nome.trim()){h("Nome da empresa  obrigatrio");return}if(!g.email_admin.trim()){h("Email  obrigatrio");return}const w={nome:g.nome.trim(),cnpj:g.cnpj.replace(/[^\d]/g,"")||null,email_admin:g.email_admin.trim(),telefone:g.telefone.trim(),endereco:{logradouro:g.endereco.logradouro.trim(),cidade:g.endereco.cidade.trim(),estado:g.endereco.estado,cep:g.endereco.cep.replace(/[^\d]/g,"")},updated_at:new Date().toISOString()},{error:E}=await V.from("empresas").update(w).eq("id",_);if(E){console.error("Erro ao atualizar empresa:",E),h("Erro ao salvar dados da empresa");return}p("Dados salvos com sucesso!"),setTimeout(()=>p(""),3e3)}catch(_){console.error("Erro ao salvar dados:",_),h("Erro interno ao salvar dados")}finally{c(!1)}};return r?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Carregando configuraes..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Configuraes da Empresa"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Configure as informaes da sua empresa"})]}),f&&e.jsx("div",{className:"mb-6 rounded-md bg-green-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-green-800",children:f})})]})}),u&&e.jsx("div",{className:"mb-6 rounded-md bg-red-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-red-800",children:u})})]})}),e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8 px-6","aria-label":"Tabs",children:e.jsxs("button",{onClick:()=>a("empresa"),className:`group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm ${s==="empresa"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("span",{className:"text-lg mr-2",children:""}),"Dados da Empresa"]})})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informaes da Empresa"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Configure as informaes bsicas da sua empresa."})]}),e.jsx("button",{onClick:b,disabled:l,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:l?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Salvando..."]}):"Salvar Dados"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome da Empresa *"}),e.jsx("input",{type:"text",value:g.nome,onChange:_=>v(w=>({...w,nome:_.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Digite o nome da empresa",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CNPJ"}),e.jsx("input",{type:"text",value:g.cnpj,onChange:_=>v(w=>({...w,cnpj:_.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"00.000.000/0000-00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:g.email_admin,onChange:_=>v(w=>({...w,email_admin:_.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"contato@empresa.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telefone"}),e.jsx("input",{type:"tel",value:g.telefone,onChange:_=>v(w=>({...w,telefone:_.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"(11) 99999-9999"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Endereo"}),e.jsx("input",{type:"text",value:g.endereco.logradouro,onChange:_=>v(w=>({...w,endereco:{...w.endereco,logradouro:_.target.value}})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Rua, nmero, bairro"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cidade"}),e.jsx("input",{type:"text",value:g.endereco.cidade,onChange:_=>v(w=>({...w,endereco:{...w.endereco,cidade:_.target.value}})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nome da cidade"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado"}),e.jsxs("select",{value:g.endereco.estado,onChange:_=>v(w=>({...w,endereco:{...w.endereco,estado:_.target.value}})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Selecione o estado"}),e.jsx("option",{value:"AC",children:"Acre"}),e.jsx("option",{value:"AL",children:"Alagoas"}),e.jsx("option",{value:"AP",children:"Amap"}),e.jsx("option",{value:"AM",children:"Amazonas"}),e.jsx("option",{value:"BA",children:"Bahia"}),e.jsx("option",{value:"CE",children:"Cear"}),e.jsx("option",{value:"DF",children:"Distrito Federal"}),e.jsx("option",{value:"ES",children:"Esprito Santo"}),e.jsx("option",{value:"GO",children:"Gois"}),e.jsx("option",{value:"MA",children:"Maranho"}),e.jsx("option",{value:"MT",children:"Mato Grosso"}),e.jsx("option",{value:"MS",children:"Mato Grosso do Sul"}),e.jsx("option",{value:"MG",children:"Minas Gerais"}),e.jsx("option",{value:"PA",children:"Par"}),e.jsx("option",{value:"PB",children:"Paraba"}),e.jsx("option",{value:"PR",children:"Paran"}),e.jsx("option",{value:"PE",children:"Pernambuco"}),e.jsx("option",{value:"PI",children:"Piau"}),e.jsx("option",{value:"RJ",children:"Rio de Janeiro"}),e.jsx("option",{value:"RN",children:"Rio Grande do Norte"}),e.jsx("option",{value:"RS",children:"Rio Grande do Sul"}),e.jsx("option",{value:"RO",children:"Rondnia"}),e.jsx("option",{value:"RR",children:"Roraima"}),e.jsx("option",{value:"SC",children:"Santa Catarina"}),e.jsx("option",{value:"SP",children:"So Paulo"}),e.jsx("option",{value:"SE",children:"Sergipe"}),e.jsx("option",{value:"TO",children:"Tocantins"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CEP"}),e.jsx("input",{type:"text",value:g.endereco.cep,onChange:_=>v(w=>({...w,endereco:{...w.endereco,cep:_.target.value}})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"00000-000"})]})]})]})})]})]})})};class lB{async createBasicEmployee(s,a){try{const r=await bt();if(!r||r!==a)return{success:!1,error:"Acesso negado: voc no tem permisso para esta empresa"};const{data:o,error:l}=await V.from("employees").select("id, email").eq("empresa_id",a).eq("email",s.email).single();if(l&&l.code!=="PGRST116")return console.error("Erro ao verificar email existente:",l),{success:!1,error:"Erro ao verificar email existente"};if(o)return{success:!1,error:"J existe um funcionrio com este email nesta empresa"};const u={employee_code:s.employee_code||`EMP${Date.now().toString().slice(-6)}`,name:s.name,email:s.email,phone:s.phone||null,cpf:s.cpf||null,position_id:s.position_id,department_id:s.department_id,empresa_id:a,status:"active",tem_acesso_sistema:!1,auth_user_id:null,hire_date:new Date().toISOString().split("T")[0]};console.log(" DEBUG - Dados para insero:",u),console.log(" DEBUG - CPF recebido:",s.cpf);const{data:h,error:f}=await V.from("employees").insert(u).select(`
          *,
          position:positions(name),
          department:departments(name)
        `).single();return f?(console.error("Erro ao criar funcionrio bsico:",f),{success:!1,error:"Erro ao criar funcionrio bsico"}):(console.log(" DEBUG - Funcionrio criado:",h),console.log(" DEBUG - CPF no retorno:",h==null?void 0:h.cpf),{success:!0,employee:h})}catch(r){return console.error("Erro inesperado ao criar funcionrio bsico:",r),{success:!1,error:"Erro inesperado ao criar funcionrio bsico"}}}async getBasicEmployees(s){try{const a=await bt();if(!a||a!==s)return{success:!1,error:"Acesso negado: voc no tem permisso para esta empresa"};const{data:r,error:o}=await V.from("employees").select(`
          id, name, email, phone, cpf, employee_code, status, 
          tem_acesso_sistema, auth_user_id, position_id, department_id,
          created_at, updated_at, hire_date
        `).eq("empresa_id",s).eq("tem_acesso_sistema",!1).eq("status","active").order("name");return o?(console.error("Erro ao buscar funcionrios bsicos:",o),{success:!1,error:"Erro ao buscar funcionrios bsicos"}):{success:!0,employees:r}}catch(a){return console.error("Erro inesperado ao buscar funcionrios bsicos:",a),{success:!1,error:"Erro inesperado ao buscar funcionrios bsicos"}}}async updateBasicEmployee(s,a,r){try{const o=await bt();if(!o||o!==r)return{success:!1,error:"Acesso negado: voc no tem permisso para esta empresa"};const{data:l,error:c}=await V.from("employees").update({name:a.name,email:a.email,phone:a.phone,cpf:a.cpf,position_id:a.position_id,department_id:a.department_id,updated_at:new Date().toISOString()}).eq("id",s).eq("empresa_id",r).select(`
          *,
          position:positions(name),
          department:departments(name)
        `).single();return c?(console.error("Erro ao atualizar funcionrio bsico:",c),{success:!1,error:"Erro ao atualizar funcionrio bsico"}):{success:!0,employee:l}}catch(o){return console.error("Erro inesperado ao atualizar funcionrio bsico:",o),{success:!1,error:"Erro inesperado ao atualizar funcionrio bsico"}}}}class cB{generateTemporaryPassword(){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#$%";let a="";a+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(Math.random()*26)],a+="abcdefghijklmnopqrstuvwxyz"[Math.floor(Math.random()*26)],a+="0123456789"[Math.floor(Math.random()*10)],a+="@#$%"[Math.floor(Math.random()*4)];for(let r=4;r<12;r++)a+=s[Math.floor(Math.random()*s.length)];return a.split("").sort(()=>Math.random()-.5).join("")}async assignCredentials(s,a){var r,o,l,c;try{const u=await bt();if(!u||u!==a)return{success:!1,error:"Acesso negado: voc no tem permisso para esta empresa"};const{data:h,error:f}=await V.from("employees").select(`
          id, name, email, phone, cpf, employee_code, status,
          tem_acesso_sistema, auth_user_id, position_id, department_id,
          created_at, updated_at, hire_date
        `).eq("id",s).eq("empresa_id",a).eq("status","active").single();if(f||!h)return console.error("Funcionrio no encontrado:",f),{success:!1,error:"Funcionrio no encontrado"};if(h.tem_acesso_sistema&&h.auth_user_id)return{success:!1,error:"Este funcionrio j possui credenciais de acesso"};const p=this.generateTemporaryPassword();let g,v;if(Gt){const w=await ut.auth.admin.createUser({email:h.email,password:p,email_confirm:!0,user_metadata:{name:h.name,position:(r=h.position)==null?void 0:r.name,department:(o=h.department)==null?void 0:o.name,empresa_id:a,employee_id:s,tipo_usuario:"funcionario"}});g=w.data,v=w.error}else{const w=await V.auth.signUp({email:h.email,password:p,options:{data:{name:h.name,position:(l=h.position)==null?void 0:l.name,department:(c=h.department)==null?void 0:c.name,empresa_id:a,employee_id:s,tipo_usuario:"funcionario"}}});g=w.data,v=w.error}if(v||!g.user)return console.error("Erro ao criar usurio Auth:",v),{success:!1,error:"Erro ao criar credenciais de acesso"};const{error:b}=await V.from("employees").update({auth_user_id:g.user.id,tem_acesso_sistema:!0,data_credenciais_criadas:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",s).eq("empresa_id",a);if(b){console.error("Erro ao atualizar funcionrio:",b);try{await V.auth.admin.deleteUser(g.user.id)}catch(w){console.error("Erro ao limpar usurio Auth:",w)}return{success:!1,error:"Erro ao vincular credenciais ao funcionrio"}}const _=null;return{success:!0,credentials:{email:h.email,temporaryPassword:p,authUserId:g.user.id}}}catch(u){return console.error("Erro inesperado ao atribuir credenciais:",u),{success:!1,error:"Erro inesperado ao atribuir credenciais"}}}async removeCredentials(s,a){try{const r=await bt();if(!r||r!==a)return{success:!1,error:"Acesso negado: voc no tem permisso para esta empresa"};const{data:o,error:l}=await V.from("employees").select("auth_user_id").eq("id",s).eq("empresa_id",a).single();if(l||!o||!o.auth_user_id)return{success:!1,error:"Funcionrio no encontrado ou sem credenciais"};const{error:c}=Gt?await ut.auth.admin.deleteUser(o.auth_user_id):await V.auth.admin.deleteUser(o.auth_user_id);if(c)return console.error("Erro ao remover usurio Auth:",c),{success:!1,error:"Erro ao remover credenciais"};const{error:u}=await V.from("employees").update({auth_user_id:null,tem_acesso_sistema:!1,data_credenciais_criadas:null,updated_at:new Date().toISOString()}).eq("id",s).eq("empresa_id",a);if(u)return console.error("Erro ao atualizar funcionrio:",u),{success:!1,error:"Erro ao atualizar funcionrio"};const h=null;return{success:!0}}catch(r){return console.error("Erro inesperado ao remover credenciais:",r),{success:!1,error:"Erro inesperado ao remover credenciais"}}}async getEmployeesWithCredentials(s){try{const a=await bt();if(!a||a!==s)return{success:!1,error:"Acesso negado: voc no tem permisso para esta empresa"};const{data:r,error:o}=await V.from("employees").select(`
          id, name, email, phone, cpf, employee_code, status,
          tem_acesso_sistema, auth_user_id, position_id, department_id,
          created_at, updated_at, hire_date, data_credenciais_criadas
        `).eq("empresa_id",s).eq("tem_acesso_sistema",!0).eq("status","active").not("auth_user_id","is",null).order("name");return o?(console.error("Erro ao buscar funcionrios com credenciais:",o),{success:!1,error:"Erro ao buscar funcionrios com credenciais"}):{success:!0,employees:r}}catch(a){return console.error("Erro inesperado ao buscar funcionrios com credenciais:",a),{success:!1,error:"Erro inesperado ao buscar funcionrios com credenciais"}}}}const dB=t=>{const[s,a]=y.useState({isLoading:!1,error:null,basicEmployees:[],employeesWithCredentials:[]}),r=new lB,o=new cB,l=y.useCallback(w=>{a(E=>({...E,isLoading:w}))},[]),c=y.useCallback(w=>{a(E=>({...E,error:w}))},[]),u=y.useCallback(async w=>{l(!0),c(null);try{const E=await r.createBasicEmployee(w,t);return E.success?await g():c(E.error||"Erro ao criar funcionrio"),E}catch{const T="Erro inesperado ao criar funcionrio";return c(T),{success:!1,error:T}}finally{l(!1)}},[t]),h=y.useCallback(async w=>{l(!0),c(null);try{const E=await o.assignCredentials(w,t);return E.success?await Promise.all([g(),v()]):c(E.error||"Erro ao atribuir credenciais"),E}catch{const T="Erro inesperado ao atribuir credenciais";return c(T),{success:!1,error:T}}finally{l(!1)}},[t]),f=y.useCallback(async w=>{l(!0),c(null);try{const E=await o.removeCredentials(w,t);return E.success?await Promise.all([g(),v()]):c(E.error||"Erro ao remover credenciais"),E}catch{const T="Erro inesperado ao remover credenciais";return c(T),{success:!1,error:T}}finally{l(!1)}},[t]),p=y.useCallback(async(w,E)=>{l(!0),c(null);try{const T=await r.updateBasicEmployee(w,E,t);return T.success?(await g(),await v()):c(T.error||"Erro ao atualizar funcionrio"),T}catch{const N="Erro inesperado ao atualizar funcionrio";return c(N),{success:!1,error:N}}finally{l(!1)}},[t]),g=y.useCallback(async()=>{l(!0),c(null);try{const w=await r.getBasicEmployees(t);w.success?a(E=>({...E,basicEmployees:w.employees||[]})):c(w.error||"Erro ao carregar funcionrios bsicos")}catch{c("Erro inesperado ao carregar funcionrios bsicos")}finally{l(!1)}},[t]),v=y.useCallback(async()=>{l(!0),c(null);try{const w=await o.getEmployeesWithCredentials(t);w.success?a(E=>({...E,employeesWithCredentials:w.employees||[]})):c(w.error||"Erro ao carregar funcionrios com credenciais")}catch{c("Erro inesperado ao carregar funcionrios com credenciais")}finally{l(!1)}},[t]),b=y.useCallback(async()=>{l(!0),c(null);try{await Promise.all([g(),v()])}catch{c("Erro ao carregar funcionrios")}finally{l(!1)}},[g,v]),_=y.useCallback(()=>{c(null)},[]);return{isLoading:s.isLoading,error:s.error,basicEmployees:s.basicEmployees,employeesWithCredentials:s.employeesWithCredentials,createBasicEmployee:u,updateBasicEmployee:p,loadBasicEmployees:g,assignCredentials:h,removeCredentials:f,loadEmployeesWithCredentials:v,loadAllEmployees:b,clearError:_}};class uB{async getDepartments(){try{const{data:s,error:a}=await V.from("departments").select("id, name").order("name");return a?(console.error("Erro ao buscar departamentos:",a),{success:!1,error:"Erro ao buscar departamentos"}):{success:!0,departments:s}}catch(s){return console.error("Erro inesperado ao buscar departamentos:",s),{success:!1,error:"Erro inesperado ao buscar departamentos"}}}async getPositions(){try{const{data:s,error:a}=await V.from("positions").select(`
          id,
          name,
          department_id,
          department:departments(id, name)
        `).order("name");return a?(console.error("Erro ao buscar posies:",a),{success:!1,error:"Erro ao buscar posies"}):{success:!0,positions:s}}catch(s){return console.error("Erro inesperado ao buscar posies:",s),{success:!1,error:"Erro inesperado ao buscar posies"}}}async getPositionsByDepartment(s){try{const{data:a,error:r}=await V.from("positions").select(`
          id,
          name,
          department_id,
          department:departments(id, name)
        `).eq("department_id",s).order("name");return r?(console.error("Erro ao buscar posies por departamento:",r),{success:!1,error:"Erro ao buscar posies por departamento"}):{success:!0,positions:a}}catch(a){return console.error("Erro inesperado ao buscar posies por departamento:",a),{success:!1,error:"Erro inesperado ao buscar posies por departamento"}}}}const mB=({className:t})=>{var me;const{user:s}=Et(),a=(me=s==null?void 0:s.user_metadata)==null?void 0:me.empresa_id,{isLoading:r,error:o,basicEmployees:l,employeesWithCredentials:c,createBasicEmployee:u,assignCredentials:h,removeCredentials:f,updateBasicEmployee:p,loadAllEmployees:g,clearError:v}=dB(a),[b,_]=y.useState("basic"),[w,E]=y.useState(!1),[T,N]=y.useState(!1),[k,S]=y.useState(null),[C,M]=y.useState(null),[z,A]=y.useState(null),[$,P]=y.useState({name:"",email:"",phone:"",cpf:"",position_id:"",department_id:"",employee_code:""}),[F,I]=y.useState([]),[J,pe]=y.useState([]),[te,L]=y.useState([]),G=new uB;y.useEffect(()=>{a&&(g(),ee())},[a,g]);const ee=async()=>{try{const[D,q]=await Promise.all([G.getDepartments(),G.getPositions()]);D.success&&D.departments&&I(D.departments),q.success&&q.positions&&(pe(q.positions),L(q.positions))}catch(D){console.error("Erro ao carregar departamentos e posies:",D)}},xe=D=>{if(P(q=>({...q,department_id:D,position_id:""})),D){const q=J.filter(Q=>Q.department_id===D);L(q)}else L(J)},O=async D=>{D.preventDefault();try{const q=await u($);q.success&&(E(!1),ie(),console.log(" Funcionrio criado com sucesso:",q.employee))}catch(q){console.error("Erro ao criar funcionrio:",q)}},H=async D=>{try{const q=await h(D.id);q.success&&q.credentials&&(M(q.credentials),S(D),N(!0))}catch(q){console.error("Erro ao atribuir credenciais:",q)}},B=async D=>{if(window.confirm(`Tem certeza que deseja remover as credenciais de acesso de ${D.nome_completo}?`))try{await f(D.id)}catch(q){console.error("Erro ao remover credenciais:",q)}},Y=async D=>{if(D.preventDefault(),!!z)try{(await p(z.id,$)).success&&(A(null),ie(),E(!1))}catch(q){console.error("Erro ao atualizar funcionrio:",q)}},ne=D=>{if(A(D),P({name:D.name,email:D.email,phone:D.phone||"",cpf:D.cpf||"",position_id:D.position_id,department_id:D.department_id,employee_code:D.employee_code}),D.department_id){const q=J.filter(Q=>Q.department_id===D.department_id);L(q)}E(!0)},ie=()=>{P({name:"",email:"",phone:"",cpf:"",position_id:"",department_id:"",employee_code:""}),L(J)},oe=()=>{A(null),E(!1),ie()};return a?e.jsxs("div",{className:`bg-white rounded-lg shadow-md ${t}`,children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[e.jsx(Ss,{className:"w-6 h-6 mr-2 text-blue-600"}),"Gesto de Funcionrios"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Sistema de duas etapas: Criar funcionrio  Atribuir credenciais"})]}),e.jsxs("button",{onClick:()=>g(),disabled:r,className:"flex items-center px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 disabled:opacity-50",children:[e.jsx(_a,{className:`w-4 h-4 mr-1 ${r?"animate-spin":""}`}),"Atualizar"]})]})}),o&&e.jsx("div",{className:"mx-6 mt-4 bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ya,{className:"w-5 h-5 text-red-600 mr-2"}),e.jsx("p",{className:"text-red-800",children:o})]}),e.jsx("button",{onClick:v,className:"text-red-600 hover:text-red-800",children:""})]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8 px-6",children:[e.jsxs("button",{onClick:()=>_("basic"),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center ${b==="basic"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(Ou,{className:"w-4 h-4 mr-2"}),"Funcionrios Bsicos",e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-900 py-0.5 px-2.5 rounded-full text-xs",children:l.length})]}),e.jsxs("button",{onClick:()=>_("credentials"),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center ${b==="credentials"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(jr,{className:"w-4 h-4 mr-2"}),"Com Credenciais",e.jsx("span",{className:"ml-2 bg-green-100 text-green-900 py-0.5 px-2.5 rounded-full text-xs",children:c.length})]})]})}),e.jsxs("div",{className:"p-6",children:[b==="basic"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Etapa 1: Funcionrios Bsicos"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Funcionrios cadastrados sem credenciais de acesso ao sistema"})]}),e.jsxs("button",{onClick:()=>E(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors flex items-center",children:[e.jsx(Ou,{className:"w-4 h-4 mr-2"}),"Novo Funcionrio"]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Funcionrio"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cargo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Telefone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(D=>{var q,Q;return e.jsxs(be.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:D.name}),e.jsx("div",{className:"text-sm text-gray-500",children:D.email}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Cdigo: ",D.employee_code]}),D.cpf&&e.jsxs("div",{className:"text-sm text-gray-400",children:["CPF: ",D.cpf]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:((q=D.position)==null?void 0:q.name)||"N/A"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:((Q=D.department)==null?void 0:Q.name)||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:D.phone||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Sem credenciais"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[e.jsxs("button",{onClick:()=>H(D),className:"bg-green-600 text-white px-3 py-1 rounded text-xs hover:bg-green-700 flex items-center",disabled:r,children:[e.jsx(jr,{className:"w-3 h-3 mr-1"}),"Criar Credenciais"]}),e.jsxs("button",{onClick:()=>ne(D),className:"text-blue-600 hover:text-blue-900 flex items-center",children:[e.jsx(lo,{className:"w-3 h-3 mr-1"}),"Editar"]})]})]},D.id)})})]}),l.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ou,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-2",children:"Nenhum funcionrio bsico cadastrado"}),e.jsx("button",{onClick:()=>E(!0),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Cadastrar primeiro funcionrio "})]})]})]}),b==="credentials"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Etapa 2: Funcionrios com Credenciais"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Funcionrios que possuem acesso ao sistema"})]})}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Funcionrio"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cargo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Credenciais Criadas"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Aes"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(D=>{var q,Q;return e.jsxs(be.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:D.name}),e.jsx("div",{className:"text-sm text-gray-500",children:D.email}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Cdigo: ",D.employee_code]}),D.cpf&&e.jsxs("div",{className:"text-sm text-gray-400",children:["CPF: ",D.cpf]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:((q=D.position)==null?void 0:q.name)||"N/A"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:((Q=D.department)==null?void 0:Q.name)||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:D.data_credenciais_criadas?new Date(D.data_credenciais_criadas).toLocaleDateString("pt-BR"):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(ts,{className:"w-3 h-3 mr-1"}),"Com acesso"]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[e.jsxs("button",{onClick:()=>ne(D),className:"text-blue-600 hover:text-blue-900 flex items-center",children:[e.jsx(lo,{className:"w-3 h-3 mr-1"}),"Editar"]}),e.jsxs("button",{onClick:()=>B(D),className:"text-red-600 hover:text-red-900 flex items-center",disabled:r,children:[e.jsx(Fc,{className:"w-3 h-3 mr-1"}),"Remover Acesso"]})]})]},D.id)})})]}),c.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(jr,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-2",children:"Nenhum funcionrio com credenciais ainda"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Crie funcionrios bsicos primeiro, depois atribua credenciais"})]})]})]})]}),w&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:z?"Editar Funcionrio":"Novo Funcionrio"}),e.jsxs("form",{onSubmit:z?Y:O,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo *"}),e.jsx("input",{type:"text",required:!0,value:$.name,onChange:D=>P(q=>({...q,name:D.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nome completo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",required:!0,value:$.email,onChange:D=>P(q=>({...q,email:D.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"email@exemplo.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CPF"}),e.jsx("input",{type:"text",value:$.cpf,onChange:D=>P(q=>({...q,cpf:D.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"000.000.000-00",maxLength:14})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone"}),e.jsx("input",{type:"tel",value:$.phone,onChange:D=>P(q=>({...q,phone:D.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"(11) 99999-9999"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cdigo do Funcionrio"}),e.jsx("input",{type:"text",value:$.employee_code,onChange:D=>P(q=>({...q,employee_code:D.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Deixe vazio para gerar automaticamente"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento *"}),e.jsxs("select",{required:!0,value:$.department_id,onChange:D=>xe(D.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Selecione um departamento"}),F.map(D=>e.jsx("option",{value:D.id,children:D.name},D.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Posio *"}),e.jsxs("select",{required:!0,value:$.position_id,onChange:D=>P(q=>({...q,position_id:D.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!$.department_id,children:[e.jsx("option",{value:"",children:"Selecione uma posio"}),te.map(D=>e.jsx("option",{value:D.id,children:D.name},D.id))]}),!$.department_id&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Selecione um departamento primeiro"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:oe,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",disabled:r,children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:r,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Salvando...":z?"Atualizar":"Criar Funcionrio"})]})]})]})})}),T&&C&&k&&e.jsx(E2,{isOpen:T,onClose:()=>{N(!1),M(null),S(null)},credentials:{system:{email:C.email,password:C.temporaryPassword}},employeeName:k.nome_completo})]}):e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("p",{className:"text-red-800",children:"Erro: Empresa no identificada"})})},hB=()=>e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-8",children:[e.jsx("div",{className:"flex items-center space-x-4 mb-4",children:e.jsxs(gs,{to:"/",className:"flex items-center text-gray-600 hover:text-gray-800 transition-colors",children:[e.jsx(fo,{className:"w-5 h-5 mr-2"}),"Voltar ao Dashboard"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gesto de Funcionrios"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Sistema completo de cadastro e gerenciamento de funcionrios com fluxo de duas etapas"})]})]}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:" Etapa 1: Funcionrio Bsico"}),e.jsx("p",{className:"text-blue-800 text-sm",children:"Cadastre os dados bsicos do funcionrio (nome, email, cargo, etc.) sem criar credenciais de acesso ainda."})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-900 mb-2",children:" Etapa 2: Credenciais de Acesso"}),e.jsx("p",{className:"text-green-800 text-sm",children:"Aps criar o funcionrio bsico, atribua credenciais de acesso ao sistema quando necessrio."})]})]}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:e.jsx(mB,{})}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},className:"mt-8 bg-gray-50 border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:" Como usar o sistema"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Fluxo Recomendado:"}),e.jsxs("ol",{className:"text-sm text-gray-600 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Cadastre o funcionrio bsico com dados pessoais"}),e.jsx("li",{children:"Verifique se os dados esto corretos"}),e.jsx("li",{children:'Clique em "Criar Credenciais" quando necessrio'}),e.jsx("li",{children:"Entregue as credenciais geradas ao funcionrio"}),e.jsx("li",{children:"O funcionrio deve alterar a senha no primeiro acesso"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Vantagens do Sistema:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Controle total sobre quem tem acesso ao sistema"}),e.jsx("li",{children:"Possibilidade de cadastrar funcionrios sem dar acesso imediato"}),e.jsx("li",{children:"Credenciais seguras geradas automaticamente"}),e.jsx("li",{children:"Fcil remoo de acesso quando necessrio"}),e.jsx("li",{children:"Histrico completo de criao de credenciais"})]})]})]})]})]})});yS.ABERTA,Pu.ENTREGUE,Pu.ENTREGUE,Pu.ENTREGUE;new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString();const fB=()=>{const t=[{tableNumber:5,expected:"Mesa 5"},{tableNumber:"10",expected:"Mesa 10"},{tableNumber:null,expected:"Balco"},{tableNumber:void 0,expected:"Balco"},{tableNumber:"",expected:"Balco"}];return e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Teste de Formatao Mesa/Balco"}),e.jsx("div",{className:"space-y-3",children:t.map((s,a)=>{const r=Og(s.tableNumber),o=r===s.expected;return e.jsx("div",{className:`p-3 rounded border ${o?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Input:"})," ",JSON.stringify(s.tableNumber)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Resultado:"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded text-sm ${o?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Esperado:"})," ",s.expected]}),e.jsx("div",{children:o?e.jsx("span",{className:"text-green-600 font-bold",children:""}):e.jsx("span",{className:"text-red-600 font-bold",children:""})})]})},a)})}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded",children:[e.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"Exemplos de Uso:"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("code",{children:"formatTableDisplay(5)"}),"  ",e.jsx("strong",{children:"Mesa 5"})]}),e.jsxs("div",{children:[e.jsx("code",{children:"formatTableDisplay('10')"}),"  ",e.jsx("strong",{children:"Mesa 10"})]}),e.jsxs("div",{children:[e.jsx("code",{children:"formatTableDisplay(null)"}),"  ",e.jsx("strong",{children:"Balco"})]}),e.jsxs("div",{children:[e.jsx("code",{children:"formatTableDisplay(undefined)"}),"  ",e.jsx("strong",{children:"Balco"})]})]})]})]})},pB=()=>{const[t,s]=y.useState(null),[a,r]=y.useState(!1),[o,l]=y.useState(null),c=async()=>{r(!0),l(null),s(null);try{console.log("Testing bar_tables connection...");const{data:h,error:f}=await V.from("bar_tables").select("*").limit(5);if(console.log("Tables query result:",{tables:h,tablesError:f}),f)throw new Error(`Erro na consulta: ${f.message}`);const{data:p,error:g}=await V.rpc("get_table_info",{table_name:"bar_tables"}).single();console.log("Table info result:",{tableInfo:p,infoError:g}),s({tablesCount:(h==null?void 0:h.length)||0,tables:h||[],tableExists:!f,error:(f==null?void 0:f.message)||null})}catch(h){console.error("Test error:",h),l(h instanceof Error?h.message:"Erro desconhecido")}finally{r(!1)}},u=async()=>{r(!0),l(null);try{const{data:h,error:f}=await V.from("empresas").select("id").limit(1);if(f||!h||h.length===0)throw new Error("Nenhuma empresa encontrada para teste");const{data:p,error:g}=await V.from("bar_tables").insert({number:"TEST-1",capacity:4,status:"available",position_x:100,position_y:100,notes:"Mesa de teste",empresa_id:h[0].id}).select().single();if(g)throw g;console.log("Table created:",p),alert("Mesa de teste criada com sucesso!"),c()}catch(h){console.error("Create error:",h),l(h instanceof Error?h.message:"Erro ao criar mesa")}finally{r(!1)}};return y.useEffect(()=>{c()},[]),e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-lg max-w-2xl mx-auto",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Teste de Conexo - bar_tables"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:c,disabled:a,className:"bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:a?"Testando...":"Testar Conexo"}),e.jsx("button",{onClick:u,disabled:a,className:"bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 ml-2",children:a?"Criando...":"Criar Mesa de Teste"}),o&&e.jsxs("div",{className:"p-3 bg-red-100 text-red-800 rounded-lg border border-red-200",children:[e.jsx("strong",{children:"Erro:"})," ",o]}),t&&e.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Resultado do Teste:"}),e.jsx("pre",{className:"text-sm overflow-auto",children:JSON.stringify(t,null,2)})]})]})]})},gB=()=>{const[t,s]=y.useState(!1),[a,r]=y.useState(""),o=async()=>{s(!0),r("");try{const{data:l,error:c}=await V.from("bar_tables").select("id").limit(1);if(c&&c.code==="42P01"){r("Tabela bar_tables no encontrada. Criando...");const f=`
          CREATE TABLE IF NOT EXISTS public.bar_tables (
              id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
              number VARCHAR(50) NOT NULL UNIQUE,
              capacity INTEGER NOT NULL CHECK (capacity > 0),
              status VARCHAR(20) DEFAULT 'available' CHECK (status IN ('available', 'occupied', 'reserved', 'cleaning', 'maintenance')),
              position_x INTEGER DEFAULT 100,
              position_y INTEGER DEFAULT 100,
              notes TEXT,
              created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
              updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
          );
        `,{error:p}=await V.rpc("exec_sql",{sql:f});if(p)throw new Error(`Erro ao criar tabela: ${p.message}`);r("Tabela bar_tables criada com sucesso!")}else{if(c)throw c;r(`Tabela bar_tables j existe. Encontradas ${(l==null?void 0:l.length)||0} mesas.`)}const{data:u,error:h}=await V.from("bar_tables").select("*");if(h)throw h;if(!u||u.length===0){r(g=>g+`

Nenhuma mesa encontrada. Criando mesas de exemplo...`);const f=[{number:"1",capacity:2,status:"available",position_x:100,position_y:100},{number:"2",capacity:4,status:"available",position_x:200,position_y:100},{number:"3",capacity:2,status:"available",position_x:300,position_y:100},{number:"4",capacity:6,status:"available",position_x:400,position_y:100},{number:"5",capacity:4,status:"available",position_x:100,position_y:200},{number:"6",capacity:2,status:"available",position_x:200,position_y:200},{number:"7",capacity:8,status:"available",position_x:300,position_y:200},{number:"8",capacity:4,status:"available",position_x:400,position_y:200},{number:"9",capacity:2,status:"available",position_x:100,position_y:300},{number:"10",capacity:6,status:"available",position_x:200,position_y:300}],{error:p}=await V.from("bar_tables").insert(f);if(p)throw p;r(g=>g+`

${f.length} mesas de exemplo criadas com sucesso!`)}else r(f=>f+`

Encontradas ${u.length} mesas no sistema.`)}catch(l){console.error("Erro ao inicializar tabelas:",l),r(`Erro: ${l.message}`)}finally{s(!1)}};return e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-lg max-w-2xl mx-auto",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Inicializar Sistema de Mesas"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600",children:"Este utilitrio verifica se a tabela bar_tables existe e cria mesas de exemplo se necessrio."}),e.jsx("button",{onClick:o,disabled:t,className:"bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:t?"Inicializando...":"Inicializar Sistema de Mesas"}),a&&e.jsx("div",{className:`p-4 rounded-lg text-sm whitespace-pre-line ${a.includes("Erro")?"bg-red-100 text-red-800 border border-red-200":"bg-green-100 text-green-800 border border-green-200"}`,children:a})]})]})},xB=()=>{const{config:t,healthStatus:s,performHealthCheck:a,isLoading:r}=jg(),[o,l]=y.useState(!1),[c,u]=y.useState(null),h=t&&t.supabaseUrl!=="https://your-project-dev.supabase.co"&&t.supabaseUrl!=="https://your-project-prod.supabase.co"&&t.supabaseUrl!=="https://mock.supabase.co"&&t.supabaseAnonKey!=="your_development_anon_key_here"&&t.supabaseAnonKey!=="your_production_anon_key_here"&&t.supabaseAnonKey!=="mock-anon-key",f=async()=>{l(!0);try{await a()}finally{l(!1)}},p=async(_,w)=>{try{await navigator.clipboard.writeText(_),u(w),setTimeout(()=>u(null),2e3)}catch(E){console.error("Erro ao copiar:",E)}},g=()=>h?s?s.overall.status==="healthy"?e.jsx(ts,{className:"text-green-500",size:24}):s.overall.status==="degraded"?e.jsx(mt,{className:"text-yellow-500",size:24}):e.jsx(yr,{className:"text-red-500",size:24}):e.jsx(mt,{className:"text-yellow-500",size:24}):e.jsx(yr,{className:"text-red-500",size:24}),v=()=>h?s?s.overall.status==="healthy"?"Configurao Perfeita":s.overall.status==="degraded"?"Configurao Parcial":"Configurao com Problemas":"Validao Pendente":"Configurao Necessria",b=()=>h?s?s.overall.status==="healthy"?"border-green-200 bg-green-50":s.overall.status==="degraded"?"border-yellow-200 bg-yellow-50":"border-red-200 bg-red-50":"border-yellow-200 bg-yellow-50":"border-red-200 bg-red-50";return e.jsxs("div",{className:`border rounded-lg p-6 ${b()}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[g(),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Status da Configurao Supabase"}),e.jsx("p",{className:"text-sm text-gray-600",children:v()})]})]}),e.jsxs("button",{onClick:f,disabled:o||r,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(_a,{size:16,className:o?"animate-spin":""}),e.jsx("span",{children:"Validar"})]})]}),t&&e.jsx("div",{className:"space-y-3 mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"URL do Projeto:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[h&&t.supabaseUrl.includes(".supabase.co")?e.jsx(ts,{size:16,className:"text-green-500"}):e.jsx(yr,{size:16,className:"text-red-500"}),e.jsx("span",{className:"font-mono text-xs",children:t.supabaseUrl.length>30?`${t.supabaseUrl.substring(0,30)}...`:t.supabaseUrl})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Chave Annima:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[h&&t.supabaseAnonKey.length>50?e.jsx(ts,{size:16,className:"text-green-500"}):e.jsx(yr,{size:16,className:"text-red-500"}),e.jsx("span",{className:"font-mono text-xs",children:t.supabaseAnonKey.length>20?`${t.supabaseAnonKey.substring(0,20)}...`:t.supabaseAnonKey})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Chave de Servio:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[t.supabaseServiceRoleKey&&t.supabaseServiceRoleKey!=="mock-service-role-key"&&t.supabaseServiceRoleKey.length>50?e.jsx(ts,{size:16,className:"text-green-500"}):e.jsx(mt,{size:16,className:"text-yellow-500"}),e.jsx("span",{className:"font-mono text-xs",children:t.supabaseServiceRoleKey&&t.supabaseServiceRoleKey.length>20?`${t.supabaseServiceRoleKey.substring(0,20)}...`:"No configurada"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Ambiente:"}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${t.name==="production"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:t.name==="production"?"PRODUO":"DESENVOLVIMENTO"})]})]})}),s&&e.jsxs("div",{className:"border-t pt-4 mb-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Status dos Servios"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[{name:"Database",status:s.database},{name:"Auth",status:s.auth},{name:"Storage",status:s.storage},{name:"Realtime",status:s.realtime}].map(({name:_,status:w})=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-white rounded border",children:[w.isConnected?e.jsx(ts,{size:14,className:"text-green-500"}):e.jsx(yr,{size:14,className:"text-red-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium",children:_}),e.jsx("div",{className:"text-xs text-gray-500",children:w.isConnected?`${w.responseTime}ms`:"Falha"})]})]},_))})]}),!h&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Como Configurar:"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"1."}),e.jsx("span",{children:"Acesse o"}),e.jsxs("a",{href:"https://supabase.com/dashboard",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 flex items-center space-x-1",children:[e.jsx("span",{children:"Dashboard do Supabase"}),e.jsx(BR,{size:12})]})]}),e.jsx("div",{children:"2. Selecione seu projeto  Settings  API"}),e.jsx("div",{children:"3. Configure o arquivo .env.local com suas credenciais:"})]}),e.jsxs("div",{className:"mt-3 bg-gray-800 text-green-400 p-3 rounded font-mono text-xs relative",children:[e.jsx("button",{onClick:()=>p(`VITE_SUPABASE_URL=https://seu-projeto.supabase.co
VITE_SUPABASE_ANON_KEY=sua_chave_anonima
VITE_SUPABASE_SERVICE_ROLE_KEY=sua_chave_service_role`,"config"),className:"absolute top-2 right-2 text-gray-400 hover:text-white",title:"Copiar configurao",children:c==="config"?e.jsx(Zu,{size:14}):e.jsx(La,{size:14})}),e.jsx("pre",{children:`VITE_SUPABASE_URL=https://seu-projeto.supabase.co
VITE_SUPABASE_ANON_KEY=sua_chave_anonima
VITE_SUPABASE_SERVICE_ROLE_KEY=sua_chave_service_role`})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"4. Recarregue a pgina aps configurar"})]}),s&&e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Score Geral:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-16 h-2 rounded-full ${s.overall.score>=80?"bg-green-200":s.overall.score>=50?"bg-yellow-200":"bg-red-200"}`,children:e.jsx("div",{className:`h-full rounded-full ${s.overall.score>=80?"bg-green-500":s.overall.score>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${s.overall.score}%`}})}),e.jsxs("span",{className:"text-sm font-medium",children:[s.overall.score,"%"]})]})]})})]})},yB=()=>{const{config:t,environment:s,isConnected:a,healthStatus:r,isLoading:o,error:l,switchEnvironment:c,performHealthCheck:u,getSystemInfo:h}=jg(),[f,p]=y.useState(null),[g,v]=y.useState(!1),b=async()=>{await u()},_=async()=>{const E=s==="development"?"production":"development";window.confirm(`Tem certeza que deseja trocar para ${E}?`)&&await c(E)},w=async()=>{v(!0);try{const E=await h();p(E)}catch(E){console.error("Erro ao obter informaes do sistema:",E)}finally{v(!1)}};return o?e.jsx("div",{className:"p-6 bg-white rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_a,{className:"animate-spin",size:20}),e.jsx("span",{children:"Carregando configuraes..."})]})}):l&&!t?e.jsx("div",{className:"p-6 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2 text-red-700",children:[e.jsx(mt,{size:20}),e.jsxs("span",{children:["Erro: ",l]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(xB,{}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center space-x-2",children:[e.jsx(Li,{size:24}),e.jsx("span",{children:"Configuraes de Ambiente"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:b,disabled:o,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(_a,{size:16,className:o?"animate-spin":""}),e.jsx("span",{children:"Verificar Sade"})]}),e.jsxs("button",{onClick:_,disabled:o,className:"flex items-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 disabled:opacity-50",children:[e.jsx(mc,{size:16}),e.jsx("span",{children:"Trocar Ambiente"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(mc,{size:20,className:"text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Ambiente Atual"})]}),e.jsx("div",{className:`text-lg font-bold ${s==="production"?"text-red-600":"text-green-600"}`,children:s==="production"?"PRODUO":"DESENVOLVIMENTO"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a?e.jsx(ts,{size:20,className:"text-green-600"}):e.jsx(yr,{size:20,className:"text-red-600"}),e.jsx("span",{className:"font-medium",children:"Conectividade"})]}),e.jsx("div",{className:`text-lg font-bold ${a?"text-green-600":"text-red-600"}`,children:a?"CONECTADO":"DESCONECTADO"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(mc,{size:20,className:"text-purple-600"}),e.jsx("span",{className:"font-medium",children:"Banco de Dados"})]}),e.jsx("div",{className:"text-lg font-bold text-purple-600",children:(t==null?void 0:t.databaseName)||"N/A"})]})]}),t&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Configuraes Detalhadas"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"URL do Supabase:"}),e.jsx("div",{className:"font-mono bg-gray-100 p-2 rounded mt-1 break-all",children:t.supabaseUrl})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Chave Annima:"}),e.jsx("div",{className:"font-mono bg-gray-100 p-2 rounded mt-1",children:t.supabaseAnonKey?`${t.supabaseAnonKey.substring(0,20)}...`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Modo Debug:"}),e.jsx("div",{className:`font-medium mt-1 ${t.debugMode?"text-green-600":"text-gray-600"}`,children:t.debugMode?"Ativo":"Inativo"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Nvel de Log:"}),e.jsx("div",{className:"font-medium mt-1 text-blue-600",children:t.logLevel.toUpperCase()})]})]})]})]}),r&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Status dos Servios"}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:"Status Geral"}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${r.overall.status==="healthy"?"bg-green-100 text-green-800":r.overall.status==="degraded"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[r.overall.status.toUpperCase()," (",r.overall.score,"%)"]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{name:"Database",status:r.database},{name:"Auth",status:r.auth},{name:"Storage",status:r.storage},{name:"Realtime",status:r.realtime}].map(({name:E,status:T})=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{className:"font-medium",children:E}),e.jsxs("div",{className:"flex items-center space-x-2",children:[T.isConnected?e.jsx(ts,{size:16,className:"text-green-600"}):e.jsx(yr,{size:16,className:"text-red-600"}),e.jsx("span",{className:`text-sm ${T.isConnected?"text-green-600":"text-red-600"}`,children:T.isConnected?"OK":"Falha"}),T.responseTime&&e.jsxs("span",{className:"text-xs text-gray-500",children:["(",T.responseTime,"ms)"]})]})]},E))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold",children:"Informaes do Sistema"}),e.jsxs("button",{onClick:w,disabled:g,className:"flex items-center space-x-2 px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 disabled:opacity-50",children:[e.jsx(_a,{size:14,className:g?"animate-spin":""}),e.jsx("span",{children:"Atualizar"})]})]}),f?e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Ambiente:"}),e.jsx("span",{className:"font-medium",children:f.environment})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Branch Git:"}),e.jsx("span",{className:"font-mono",children:f.branch})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Banco:"}),e.jsx("span",{className:"font-mono",children:f.database})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Inicializado:"}),e.jsx("span",{className:f.initialized?"text-green-600":"text-red-600",children:f.initialized?"Sim":"No"})]})]}):e.jsx("p",{className:"text-gray-500 text-sm",children:'Clique em "Atualizar" para obter informaes do sistema'})]})]})},bB=async()=>{console.log(" INICIANDO DEBUG DE TRANSAES"),console.log("================================");try{const{data:t,error:s}=await V.from("cash_transactions").select("*").order("created_at",{ascending:!1}).limit(10);console.log(" ltimas 10 transaes no banco:",(t==null?void 0:t.length)||0),t&&t.length>0&&console.table(t.map(f=>({id:f.id.slice(-8),tipo:f.transaction_type,metodo:f.payment_method,valor:f.amount,data:new Date(f.created_at).toLocaleString("pt-BR")})));const a=new Date().toISOString().split("T")[0],{data:r,error:o}=await V.from("cash_transactions").select("*").gte("created_at",`${a}T00:00:00.000Z`).lt("created_at",`${a}T23:59:59.999Z`).order("created_at",{ascending:!1});if(console.log(` Transaes de hoje (${a}):`,(r==null?void 0:r.length)||0),r&&r.length>0){console.table(r.map(p=>({id:p.id.slice(-8),tipo:p.transaction_type,metodo:p.payment_method,valor:p.amount,hora:new Date(p.created_at).toLocaleTimeString("pt-BR")})));const f=r.reduce((p,g)=>(g.transaction_type==="sale"&&(p[g.payment_method]||(p[g.payment_method]={valor:0,quantidade:0}),p[g.payment_method].valor+=g.amount,p[g.payment_method].quantidade+=1),p),{});console.log(" Totais por mtodo de pagamento:",f)}const{data:l,error:c}=await V.from("cash_sessions").select("*").eq("session_date",a).order("opened_at",{ascending:!1});console.log(" Sesses de caixa de hoje:",(l==null?void 0:l.length)||0),l&&l.length>0&&console.table(l.map(f=>({id:f.id.slice(-8),funcionario:f.employee_id.slice(-8),status:f.status,abertura:f.opening_amount,esperado:f.expected_amount,aberto_em:new Date(f.opened_at).toLocaleTimeString("pt-BR")})));const{data:u,error:h}=await V.from("comandas").select("*").eq("status","pending_payment").limit(5);return console.log(" Comandas pendentes de pagamento:",(u==null?void 0:u.length)||0),console.log(" DEBUG CONCLUDO"),console.log("=================="),{allTransactions:(t==null?void 0:t.length)||0,todayTransactions:(r==null?void 0:r.length)||0,sessions:(l==null?void 0:l.length)||0,comandas:(u==null?void 0:u.length)||0}}catch(t){return console.error(" Erro no debug:",t),null}},vB=async()=>{console.log(" Criando transao de teste...");try{const t={transaction_type:"sale",payment_method:"dinheiro",amount:50,processed_by:"test-user-id",notes:"Transao de teste para debug"},{data:s,error:a}=await V.from("cash_transactions").insert(t).select().single();if(a)throw a;return console.log(" Transao de teste criada:",s),s}catch(t){return console.error(" Erro ao criar transao de teste:",t),null}},wB=async()=>{console.log(" Verificando notas das transaes...");try{const{data:t,error:s}=await V.from("cash_transactions").select("id, notes, created_at, amount, payment_method").order("created_at",{ascending:!1}).limit(10);if(s)throw s;return console.log(" ltimas transaes com notas:"),t==null||t.forEach((a,r)=>{console.log(`${r+1}. ${a.notes} (R$ ${a.amount} - ${a.payment_method})`)}),t}catch(t){return console.error(" Erro ao verificar notas:",t),null}},jB=async()=>{console.log(" Testando insero direta de transao...");try{const t={transaction_type:"sale",payment_method:"dinheiro",amount:25.5,processed_by:"test-user-123",notes:"Teste direto de insero"};console.log(" Dados para inserir:",t);const{data:s,error:a}=await V.from("cash_transactions").insert(t).select().single();return a?(console.error(" Erro na insero:",a),{success:!1,error:a}):(console.log(" Transao inserida com sucesso:",s),{success:!0,data:s})}catch(t){return console.error(" Erro geral:",t),{success:!1,error:t}}};typeof window<"u"&&(window.debugTransactions=bB,window.createTestTransaction=vB,window.testDirectInsert=jB,window.checkTransactionNotes=wB);const _B=()=>{const{user:t}=Et();if(!t)return e.jsx(Mi,{to:"/login",replace:!0});const s=JO;return e.jsx(XO,{children:e.jsx(s,{children:e.jsxs(eD,{children:[e.jsx(vD,{})," "]})})})},NB=()=>{const{user:t}=Et();return t?e.jsx(Mi,{to:"/",replace:!0}):e.jsx(hD,{})},SB=()=>{const{user:t}=Et();return t?e.jsx(Mi,{to:"/",replace:!0}):e.jsx(fD,{})};function EB(){return e.jsx(x8,{children:e.jsx(yD,{children:e.jsx(a5,{children:e.jsx(KO,{children:e.jsxs(O_,{children:[e.jsx(ot,{path:"/login",element:e.jsx(NB,{})}),e.jsx(ot,{path:"/register",element:e.jsx(SB,{})}),e.jsx(ot,{path:"/alterar-senha-provisoria",element:e.jsx(lD,{})}),e.jsxs(ot,{element:e.jsx(_B,{}),children:[e.jsx(ot,{index:!0,element:e.jsx(Pt,{module:"dashboard",children:e.jsx(m8,{})})}),e.jsx(ot,{path:"dashboard/complete",element:e.jsx(Pt,{module:"dashboard",children:e.jsx(g8,{})})}),e.jsx(ot,{path:"dashboard/simple",element:e.jsx(Pt,{module:"dashboard",children:e.jsx(n8,{})})}),e.jsx(ot,{path:"dashboard/optimized",element:e.jsx(Pt,{module:"dashboard",children:e.jsx(u8,{})})}),e.jsx(ot,{path:"bar",element:e.jsx(Pt,{module:"monitor_bar",children:e.jsx(_8,{})})}),e.jsx(ot,{path:"bar/pedidos-entregues",element:e.jsx(Pt,{module:"monitor_bar",children:e.jsx(S8,{})})}),e.jsx(ot,{path:"bar/attendance",element:e.jsx(Pt,{module:"atendimento_bar",children:e.jsx(j7,{})})}),e.jsx(ot,{path:"bar-customers",element:e.jsx(Pt,{module:"clientes",children:e.jsx(E8,{})})}),e.jsx(ot,{path:"members",element:e.jsx(Pt,{module:"clientes",children:e.jsx(o$,{})})}),e.jsx(ot,{path:"bar-employees",element:e.jsx(Pt,{module:"funcionarios",children:e.jsx(wz,{})})}),e.jsx(ot,{path:"admin/funcionarios",element:e.jsx(Pt,{module:"funcionarios",children:e.jsx(hB,{})})}),e.jsx(ot,{path:"kitchen",element:e.jsx(Pt,{module:"monitor_cozinha",children:e.jsx(Hz,{})})}),e.jsx(ot,{path:"cash/*",element:e.jsx(Pt,{module:"gestao_caixa",children:e.jsx(sB,{})})}),e.jsx(ot,{path:"inventory",element:e.jsx(Pt,{module:"funcionarios",children:e.jsx(Qz,{})})}),e.jsx(ot,{path:"inventory/movements",element:e.jsx(Pt,{module:"funcionarios",children:e.jsx(a$,{})})}),e.jsx(ot,{path:"inventory/estoque-baixo",element:e.jsx(Pt,{module:"funcionarios",children:e.jsx(e$,{})})}),e.jsx(ot,{path:"inventory/atualizacao-massiva",element:e.jsx(Pt,{module:"funcionarios",children:e.jsx(t$,{})})}),e.jsx(ot,{path:"settings",element:e.jsx(Pt,{module:"configuracoes",children:e.jsx(iB,{})})}),e.jsx(ot,{path:"environment",element:e.jsx(Pt,{module:"configuracoes",children:e.jsx(yB,{})})}),e.jsx(ot,{path:"test-modal",element:e.jsx(Pt,{module:"configuracoes",children:e.jsx(oB,{})})}),e.jsx(ot,{path:"test-table-display",element:e.jsx(Pt,{module:"configuracoes",children:e.jsx(fB,{})})}),e.jsx(ot,{path:"test-bar-tables",element:e.jsx(Pt,{module:"configuracoes",children:e.jsx(pB,{})})}),e.jsx(ot,{path:"init-bar-tables",element:e.jsx(Pt,{module:"configuracoes",children:e.jsx(gB,{})})})]}),e.jsx(ot,{path:"*",element:e.jsx(Mi,{to:"/",replace:!0})})]})})})})})}VC.createRoot(document.getElementById("root")).render(e.jsx(y.StrictMode,{children:e.jsx(EB,{})}));export{yS as C,Pu as I,V as s};
