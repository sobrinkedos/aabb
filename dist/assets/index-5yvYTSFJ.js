var RC=Object.defineProperty;var OC=(t,s,a)=>s in t?RC(t,s,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[s]=a;var dt=(t,s,a)=>OC(t,typeof s!="symbol"?s+"":s,a);(function(){const s=document.createElement("link").relList;if(s&&s.supports&&s.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))r(o);new MutationObserver(o=>{for(const l of o)if(l.type==="childList")for(const c of l.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&r(c)}).observe(document,{childList:!0,subtree:!0});function a(o){const l={};return o.integrity&&(l.integrity=o.integrity),o.referrerPolicy&&(l.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?l.credentials="include":o.crossOrigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function r(o){if(o.ep)return;o.ep=!0;const l=a(o);fetch(o.href,l)}})();function E_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function DC(t){if(Object.prototype.hasOwnProperty.call(t,"__esModule"))return t;var s=t.default;if(typeof s=="function"){var a=function r(){return this instanceof r?Reflect.construct(s,arguments,this.constructor):s.apply(this,arguments)};a.prototype=s.prototype}else a={};return Object.defineProperty(a,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var o=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(a,r,o.get?o:{enumerable:!0,get:function(){return t[r]}})}),a}var Ff={exports:{}},Wl={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Tv;function PC(){if(Tv)return Wl;Tv=1;var t=Symbol.for("react.transitional.element"),s=Symbol.for("react.fragment");function a(r,o,l){var c=null;if(l!==void 0&&(c=""+l),o.key!==void 0&&(c=""+o.key),"key"in o){l={};for(var u in o)u!=="key"&&(l[u]=o[u])}else l=o;return o=l.ref,{$$typeof:t,type:r,key:c,ref:o!==void 0?o:null,props:l}}return Wl.Fragment=s,Wl.jsx=a,Wl.jsxs=a,Wl}var kv;function zC(){return kv||(kv=1,Ff.exports=PC()),Ff.exports}var e=zC(),Hf={exports:{}},Xe={};/**
 * @license React
 * react.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Av;function $C(){if(Av)return Xe;Av=1;var t=Symbol.for("react.transitional.element"),s=Symbol.for("react.portal"),a=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),o=Symbol.for("react.profiler"),l=Symbol.for("react.consumer"),c=Symbol.for("react.context"),u=Symbol.for("react.forward_ref"),h=Symbol.for("react.suspense"),f=Symbol.for("react.memo"),p=Symbol.for("react.lazy"),g=Symbol.iterator;function v(D){return D===null||typeof D!="object"?null:(D=g&&D[g]||D["@@iterator"],typeof D=="function"?D:null)}var b={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},_=Object.assign,w={};function E(D,H,F){this.props=D,this.context=H,this.refs=w,this.updater=F||b}E.prototype.isReactComponent={},E.prototype.setState=function(D,H){if(typeof D!="object"&&typeof D!="function"&&D!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,D,H,"setState")},E.prototype.forceUpdate=function(D){this.updater.enqueueForceUpdate(this,D,"forceUpdate")};function k(){}k.prototype=E.prototype;function N(D,H,F){this.props=D,this.context=H,this.refs=w,this.updater=F||b}var C=N.prototype=new k;C.constructor=N,_(C,E.prototype),C.isPureReactComponent=!0;var S=Array.isArray,T={H:null,A:null,T:null,S:null,V:null},M=Object.prototype.hasOwnProperty;function $(D,H,F,Z,re,oe){return F=oe.ref,{$$typeof:t,type:D,key:H,ref:F!==void 0?F:null,props:oe}}function A(D,H){return $(D.type,H,void 0,void 0,void 0,D.props)}function z(D){return typeof D=="object"&&D!==null&&D.$$typeof===t}function R(D){var H={"=":"=0",":":"=2"};return"$"+D.replace(/[=:]/g,function(F){return H[F]})}var L=/\/+/g;function I(D,H){return typeof D=="object"&&D!==null&&D.key!=null?R(""+D.key):H.toString(36)}function X(){}function ce(D){switch(D.status){case"fulfilled":return D.value;case"rejected":throw D.reason;default:switch(typeof D.status=="string"?D.then(X,X):(D.status="pending",D.then(function(H){D.status==="pending"&&(D.status="fulfilled",D.value=H)},function(H){D.status==="pending"&&(D.status="rejected",D.reason=H)})),D.status){case"fulfilled":return D.value;case"rejected":throw D.reason}}throw D}function J(D,H,F,Z,re){var oe=typeof D;(oe==="undefined"||oe==="boolean")&&(D=null);var ae=!1;if(D===null)ae=!0;else switch(oe){case"bigint":case"string":case"number":ae=!0;break;case"object":switch(D.$$typeof){case t:case s:ae=!0;break;case p:return ae=D._init,J(ae(D._payload),H,F,Z,re)}}if(ae)return re=re(D),ae=Z===""?"."+I(D,0):Z,S(re)?(F="",ae!=null&&(F=ae.replace(L,"$&/")+"/"),J(re,H,F,"",function(q){return q})):re!=null&&(z(re)&&(re=A(re,F+(re.key==null||D&&D.key===re.key?"":(""+re.key).replace(L,"$&/")+"/")+ae)),H.push(re)),1;ae=0;var pe=Z===""?".":Z+":";if(S(D))for(var P=0;P<D.length;P++)Z=D[P],oe=pe+I(Z,P),ae+=J(Z,H,F,oe,re);else if(P=v(D),typeof P=="function")for(D=P.call(D),P=0;!(Z=D.next()).done;)Z=Z.value,oe=pe+I(Z,P++),ae+=J(Z,H,F,oe,re);else if(oe==="object"){if(typeof D.then=="function")return J(ce(D),H,F,Z,re);throw H=String(D),Error("Objects are not valid as a React child (found: "+(H==="[object Object]"?"object with keys {"+Object.keys(D).join(", ")+"}":H)+"). If you meant to render a collection of children, use an array instead.")}return ae}function V(D,H,F){if(D==null)return D;var Z=[],re=0;return J(D,Z,"","",function(oe){return H.call(F,oe,re++)}),Z}function Y(D){if(D._status===-1){var H=D._result;H=H(),H.then(function(F){(D._status===0||D._status===-1)&&(D._status=1,D._result=F)},function(F){(D._status===0||D._status===-1)&&(D._status=2,D._result=F)}),D._status===-1&&(D._status=0,D._result=H)}if(D._status===1)return D._result.default;throw D._result}var ee=typeof reportError=="function"?reportError:function(D){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var H=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof D=="object"&&D!==null&&typeof D.message=="string"?String(D.message):String(D),error:D});if(!window.dispatchEvent(H))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",D);return}console.error(D)};function we(){}return Xe.Children={map:V,forEach:function(D,H,F){V(D,function(){H.apply(this,arguments)},F)},count:function(D){var H=0;return V(D,function(){H++}),H},toArray:function(D){return V(D,function(H){return H})||[]},only:function(D){if(!z(D))throw Error("React.Children.only expected to receive a single React element child.");return D}},Xe.Component=E,Xe.Fragment=a,Xe.Profiler=o,Xe.PureComponent=N,Xe.StrictMode=r,Xe.Suspense=h,Xe.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,Xe.__COMPILER_RUNTIME={__proto__:null,c:function(D){return T.H.useMemoCache(D)}},Xe.cache=function(D){return function(){return D.apply(null,arguments)}},Xe.cloneElement=function(D,H,F){if(D==null)throw Error("The argument must be a React element, but you passed "+D+".");var Z=_({},D.props),re=D.key,oe=void 0;if(H!=null)for(ae in H.ref!==void 0&&(oe=void 0),H.key!==void 0&&(re=""+H.key),H)!M.call(H,ae)||ae==="key"||ae==="__self"||ae==="__source"||ae==="ref"&&H.ref===void 0||(Z[ae]=H[ae]);var ae=arguments.length-2;if(ae===1)Z.children=F;else if(1<ae){for(var pe=Array(ae),P=0;P<ae;P++)pe[P]=arguments[P+2];Z.children=pe}return $(D.type,re,void 0,void 0,oe,Z)},Xe.createContext=function(D){return D={$$typeof:c,_currentValue:D,_currentValue2:D,_threadCount:0,Provider:null,Consumer:null},D.Provider=D,D.Consumer={$$typeof:l,_context:D},D},Xe.createElement=function(D,H,F){var Z,re={},oe=null;if(H!=null)for(Z in H.key!==void 0&&(oe=""+H.key),H)M.call(H,Z)&&Z!=="key"&&Z!=="__self"&&Z!=="__source"&&(re[Z]=H[Z]);var ae=arguments.length-2;if(ae===1)re.children=F;else if(1<ae){for(var pe=Array(ae),P=0;P<ae;P++)pe[P]=arguments[P+2];re.children=pe}if(D&&D.defaultProps)for(Z in ae=D.defaultProps,ae)re[Z]===void 0&&(re[Z]=ae[Z]);return $(D,oe,void 0,void 0,null,re)},Xe.createRef=function(){return{current:null}},Xe.forwardRef=function(D){return{$$typeof:u,render:D}},Xe.isValidElement=z,Xe.lazy=function(D){return{$$typeof:p,_payload:{_status:-1,_result:D},_init:Y}},Xe.memo=function(D,H){return{$$typeof:f,type:D,compare:H===void 0?null:H}},Xe.startTransition=function(D){var H=T.T,F={};T.T=F;try{var Z=D(),re=T.S;re!==null&&re(F,Z),typeof Z=="object"&&Z!==null&&typeof Z.then=="function"&&Z.then(we,ee)}catch(oe){ee(oe)}finally{T.T=H}},Xe.unstable_useCacheRefresh=function(){return T.H.useCacheRefresh()},Xe.use=function(D){return T.H.use(D)},Xe.useActionState=function(D,H,F){return T.H.useActionState(D,H,F)},Xe.useCallback=function(D,H){return T.H.useCallback(D,H)},Xe.useContext=function(D){return T.H.useContext(D)},Xe.useDebugValue=function(){},Xe.useDeferredValue=function(D,H){return T.H.useDeferredValue(D,H)},Xe.useEffect=function(D,H,F){var Z=T.H;if(typeof F=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return Z.useEffect(D,H)},Xe.useId=function(){return T.H.useId()},Xe.useImperativeHandle=function(D,H,F){return T.H.useImperativeHandle(D,H,F)},Xe.useInsertionEffect=function(D,H){return T.H.useInsertionEffect(D,H)},Xe.useLayoutEffect=function(D,H){return T.H.useLayoutEffect(D,H)},Xe.useMemo=function(D,H){return T.H.useMemo(D,H)},Xe.useOptimistic=function(D,H){return T.H.useOptimistic(D,H)},Xe.useReducer=function(D,H,F){return T.H.useReducer(D,H,F)},Xe.useRef=function(D){return T.H.useRef(D)},Xe.useState=function(D){return T.H.useState(D)},Xe.useSyncExternalStore=function(D,H,F){return T.H.useSyncExternalStore(D,H,F)},Xe.useTransition=function(){return T.H.useTransition()},Xe.version="19.1.0",Xe}var Mv;function C0(){return Mv||(Mv=1,Hf.exports=$C()),Hf.exports}var y=C0();const Ye=E_(y);var Gf={exports:{}},Yl={},Zf={exports:{}},Wf={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Rv;function IC(){return Rv||(Rv=1,function(t){function s(V,Y){var ee=V.length;V.push(Y);e:for(;0<ee;){var we=ee-1>>>1,D=V[we];if(0<o(D,Y))V[we]=Y,V[ee]=D,ee=we;else break e}}function a(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var Y=V[0],ee=V.pop();if(ee!==Y){V[0]=ee;e:for(var we=0,D=V.length,H=D>>>1;we<H;){var F=2*(we+1)-1,Z=V[F],re=F+1,oe=V[re];if(0>o(Z,ee))re<D&&0>o(oe,Z)?(V[we]=oe,V[re]=ee,we=re):(V[we]=Z,V[F]=ee,we=F);else if(re<D&&0>o(oe,ee))V[we]=oe,V[re]=ee,we=re;else break e}}return Y}function o(V,Y){var ee=V.sortIndex-Y.sortIndex;return ee!==0?ee:V.id-Y.id}if(t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var l=performance;t.unstable_now=function(){return l.now()}}else{var c=Date,u=c.now();t.unstable_now=function(){return c.now()-u}}var h=[],f=[],p=1,g=null,v=3,b=!1,_=!1,w=!1,E=!1,k=typeof setTimeout=="function"?setTimeout:null,N=typeof clearTimeout=="function"?clearTimeout:null,C=typeof setImmediate<"u"?setImmediate:null;function S(V){for(var Y=a(f);Y!==null;){if(Y.callback===null)r(f);else if(Y.startTime<=V)r(f),Y.sortIndex=Y.expirationTime,s(h,Y);else break;Y=a(f)}}function T(V){if(w=!1,S(V),!_)if(a(h)!==null)_=!0,M||(M=!0,I());else{var Y=a(f);Y!==null&&J(T,Y.startTime-V)}}var M=!1,$=-1,A=5,z=-1;function R(){return E?!0:!(t.unstable_now()-z<A)}function L(){if(E=!1,M){var V=t.unstable_now();z=V;var Y=!0;try{e:{_=!1,w&&(w=!1,N($),$=-1),b=!0;var ee=v;try{t:{for(S(V),g=a(h);g!==null&&!(g.expirationTime>V&&R());){var we=g.callback;if(typeof we=="function"){g.callback=null,v=g.priorityLevel;var D=we(g.expirationTime<=V);if(V=t.unstable_now(),typeof D=="function"){g.callback=D,S(V),Y=!0;break t}g===a(h)&&r(h),S(V)}else r(h);g=a(h)}if(g!==null)Y=!0;else{var H=a(f);H!==null&&J(T,H.startTime-V),Y=!1}}break e}finally{g=null,v=ee,b=!1}Y=void 0}}finally{Y?I():M=!1}}}var I;if(typeof C=="function")I=function(){C(L)};else if(typeof MessageChannel<"u"){var X=new MessageChannel,ce=X.port2;X.port1.onmessage=L,I=function(){ce.postMessage(null)}}else I=function(){k(L,0)};function J(V,Y){$=k(function(){V(t.unstable_now())},Y)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):A=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return v},t.unstable_next=function(V){switch(v){case 1:case 2:case 3:var Y=3;break;default:Y=v}var ee=v;v=Y;try{return V()}finally{v=ee}},t.unstable_requestPaint=function(){E=!0},t.unstable_runWithPriority=function(V,Y){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var ee=v;v=V;try{return Y()}finally{v=ee}},t.unstable_scheduleCallback=function(V,Y,ee){var we=t.unstable_now();switch(typeof ee=="object"&&ee!==null?(ee=ee.delay,ee=typeof ee=="number"&&0<ee?we+ee:we):ee=we,V){case 1:var D=-1;break;case 2:D=250;break;case 5:D=1073741823;break;case 4:D=1e4;break;default:D=5e3}return D=ee+D,V={id:p++,callback:Y,priorityLevel:V,startTime:ee,expirationTime:D,sortIndex:-1},ee>we?(V.sortIndex=ee,s(f,V),a(h)===null&&V===a(f)&&(w?(N($),$=-1):w=!0,J(T,ee-we))):(V.sortIndex=D,s(h,V),_||b||(_=!0,M||(M=!0,I()))),V},t.unstable_shouldYield=R,t.unstable_wrapCallback=function(V){var Y=v;return function(){var ee=v;v=Y;try{return V.apply(this,arguments)}finally{v=ee}}}}(Wf)),Wf}var Ov;function LC(){return Ov||(Ov=1,Zf.exports=IC()),Zf.exports}var Yf={exports:{}},js={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Dv;function UC(){if(Dv)return js;Dv=1;var t=C0();function s(h){var f="https://react.dev/errors/"+h;if(1<arguments.length){f+="?args[]="+encodeURIComponent(arguments[1]);for(var p=2;p<arguments.length;p++)f+="&args[]="+encodeURIComponent(arguments[p])}return"Minified React error #"+h+"; visit "+f+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function a(){}var r={d:{f:a,r:function(){throw Error(s(522))},D:a,C:a,L:a,m:a,X:a,S:a,M:a},p:0,findDOMNode:null},o=Symbol.for("react.portal");function l(h,f,p){var g=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:o,key:g==null?null:""+g,children:h,containerInfo:f,implementation:p}}var c=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function u(h,f){if(h==="font")return"";if(typeof f=="string")return f==="use-credentials"?f:""}return js.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,js.createPortal=function(h,f){var p=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!f||f.nodeType!==1&&f.nodeType!==9&&f.nodeType!==11)throw Error(s(299));return l(h,f,null,p)},js.flushSync=function(h){var f=c.T,p=r.p;try{if(c.T=null,r.p=2,h)return h()}finally{c.T=f,r.p=p,r.d.f()}},js.preconnect=function(h,f){typeof h=="string"&&(f?(f=f.crossOrigin,f=typeof f=="string"?f==="use-credentials"?f:"":void 0):f=null,r.d.C(h,f))},js.prefetchDNS=function(h){typeof h=="string"&&r.d.D(h)},js.preinit=function(h,f){if(typeof h=="string"&&f&&typeof f.as=="string"){var p=f.as,g=u(p,f.crossOrigin),v=typeof f.integrity=="string"?f.integrity:void 0,b=typeof f.fetchPriority=="string"?f.fetchPriority:void 0;p==="style"?r.d.S(h,typeof f.precedence=="string"?f.precedence:void 0,{crossOrigin:g,integrity:v,fetchPriority:b}):p==="script"&&r.d.X(h,{crossOrigin:g,integrity:v,fetchPriority:b,nonce:typeof f.nonce=="string"?f.nonce:void 0})}},js.preinitModule=function(h,f){if(typeof h=="string")if(typeof f=="object"&&f!==null){if(f.as==null||f.as==="script"){var p=u(f.as,f.crossOrigin);r.d.M(h,{crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0})}}else f==null&&r.d.M(h)},js.preload=function(h,f){if(typeof h=="string"&&typeof f=="object"&&f!==null&&typeof f.as=="string"){var p=f.as,g=u(p,f.crossOrigin);r.d.L(h,p,{crossOrigin:g,integrity:typeof f.integrity=="string"?f.integrity:void 0,nonce:typeof f.nonce=="string"?f.nonce:void 0,type:typeof f.type=="string"?f.type:void 0,fetchPriority:typeof f.fetchPriority=="string"?f.fetchPriority:void 0,referrerPolicy:typeof f.referrerPolicy=="string"?f.referrerPolicy:void 0,imageSrcSet:typeof f.imageSrcSet=="string"?f.imageSrcSet:void 0,imageSizes:typeof f.imageSizes=="string"?f.imageSizes:void 0,media:typeof f.media=="string"?f.media:void 0})}},js.preloadModule=function(h,f){if(typeof h=="string")if(f){var p=u(f.as,f.crossOrigin);r.d.m(h,{as:typeof f.as=="string"&&f.as!=="script"?f.as:void 0,crossOrigin:p,integrity:typeof f.integrity=="string"?f.integrity:void 0})}else r.d.m(h)},js.requestFormReset=function(h){r.d.r(h)},js.unstable_batchedUpdates=function(h,f){return h(f)},js.useFormState=function(h,f,p){return c.H.useFormState(h,f,p)},js.useFormStatus=function(){return c.H.useHostTransitionStatus()},js.version="19.1.0",js}var Pv;function BC(){if(Pv)return Yf.exports;Pv=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(s){console.error(s)}}return t(),Yf.exports=UC(),Yf.exports}/**
 * @license React
 * react-dom-client.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var zv;function VC(){if(zv)return Yl;zv=1;var t=LC(),s=C0(),a=BC();function r(n){var i="https://react.dev/errors/"+n;if(1<arguments.length){i+="?args[]="+encodeURIComponent(arguments[1]);for(var d=2;d<arguments.length;d++)i+="&args[]="+encodeURIComponent(arguments[d])}return"Minified React error #"+n+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function o(n){return!(!n||n.nodeType!==1&&n.nodeType!==9&&n.nodeType!==11)}function l(n){var i=n,d=n;if(n.alternate)for(;i.return;)i=i.return;else{n=i;do i=n,(i.flags&4098)!==0&&(d=i.return),n=i.return;while(n)}return i.tag===3?d:null}function c(n){if(n.tag===13){var i=n.memoizedState;if(i===null&&(n=n.alternate,n!==null&&(i=n.memoizedState)),i!==null)return i.dehydrated}return null}function u(n){if(l(n)!==n)throw Error(r(188))}function h(n){var i=n.alternate;if(!i){if(i=l(n),i===null)throw Error(r(188));return i!==n?null:n}for(var d=n,m=i;;){var x=d.return;if(x===null)break;var j=x.alternate;if(j===null){if(m=x.return,m!==null){d=m;continue}break}if(x.child===j.child){for(j=x.child;j;){if(j===d)return u(x),n;if(j===m)return u(x),i;j=j.sibling}throw Error(r(188))}if(d.return!==m.return)d=x,m=j;else{for(var O=!1,U=x.child;U;){if(U===d){O=!0,d=x,m=j;break}if(U===m){O=!0,m=x,d=j;break}U=U.sibling}if(!O){for(U=j.child;U;){if(U===d){O=!0,d=j,m=x;break}if(U===m){O=!0,m=j,d=x;break}U=U.sibling}if(!O)throw Error(r(189))}}if(d.alternate!==m)throw Error(r(190))}if(d.tag!==3)throw Error(r(188));return d.stateNode.current===d?n:i}function f(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n;for(n=n.child;n!==null;){if(i=f(n),i!==null)return i;n=n.sibling}return null}var p=Object.assign,g=Symbol.for("react.element"),v=Symbol.for("react.transitional.element"),b=Symbol.for("react.portal"),_=Symbol.for("react.fragment"),w=Symbol.for("react.strict_mode"),E=Symbol.for("react.profiler"),k=Symbol.for("react.provider"),N=Symbol.for("react.consumer"),C=Symbol.for("react.context"),S=Symbol.for("react.forward_ref"),T=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),$=Symbol.for("react.memo"),A=Symbol.for("react.lazy"),z=Symbol.for("react.activity"),R=Symbol.for("react.memo_cache_sentinel"),L=Symbol.iterator;function I(n){return n===null||typeof n!="object"?null:(n=L&&n[L]||n["@@iterator"],typeof n=="function"?n:null)}var X=Symbol.for("react.client.reference");function ce(n){if(n==null)return null;if(typeof n=="function")return n.$$typeof===X?null:n.displayName||n.name||null;if(typeof n=="string")return n;switch(n){case _:return"Fragment";case E:return"Profiler";case w:return"StrictMode";case T:return"Suspense";case M:return"SuspenseList";case z:return"Activity"}if(typeof n=="object")switch(n.$$typeof){case b:return"Portal";case C:return(n.displayName||"Context")+".Provider";case N:return(n._context.displayName||"Context")+".Consumer";case S:var i=n.render;return n=n.displayName,n||(n=i.displayName||i.name||"",n=n!==""?"ForwardRef("+n+")":"ForwardRef"),n;case $:return i=n.displayName||null,i!==null?i:ce(n.type)||"Memo";case A:i=n._payload,n=n._init;try{return ce(n(i))}catch{}}return null}var J=Array.isArray,V=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Y=a.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,ee={pending:!1,data:null,method:null,action:null},we=[],D=-1;function H(n){return{current:n}}function F(n){0>D||(n.current=we[D],we[D]=null,D--)}function Z(n,i){D++,we[D]=n.current,n.current=i}var re=H(null),oe=H(null),ae=H(null),pe=H(null);function P(n,i){switch(Z(ae,i),Z(oe,n),Z(re,null),i.nodeType){case 9:case 11:n=(n=i.documentElement)&&(n=n.namespaceURI)?sv(n):0;break;default:if(n=i.tagName,i=i.namespaceURI)i=sv(i),n=av(i,n);else switch(n){case"svg":n=1;break;case"math":n=2;break;default:n=0}}F(re),Z(re,n)}function q(){F(re),F(oe),F(ae)}function Q(n){n.memoizedState!==null&&Z(pe,n);var i=re.current,d=av(i,n.type);i!==d&&(Z(oe,n),Z(re,d))}function G(n){oe.current===n&&(F(re),F(oe)),pe.current===n&&(F(pe),ql._currentValue=ee)}var me=Object.prototype.hasOwnProperty,Ne=t.unstable_scheduleCallback,je=t.unstable_cancelCallback,Re=t.unstable_shouldYield,Ie=t.unstable_requestPaint,Ve=t.unstable_now,De=t.unstable_getCurrentPriorityLevel,Ue=t.unstable_ImmediatePriority,W=t.unstable_UserBlockingPriority,se=t.unstable_NormalPriority,ue=t.unstable_LowPriority,Ce=t.unstable_IdlePriority,ke=t.log,ye=t.unstable_setDisableYieldValue,Me=null,Pe=null;function Ge(n){if(typeof ke=="function"&&ye(n),Pe&&typeof Pe.setStrictMode=="function")try{Pe.setStrictMode(Me,n)}catch{}}var Qe=Math.clz32?Math.clz32:he,xe=Math.log,Te=Math.LN2;function he(n){return n>>>=0,n===0?32:31-(xe(n)/Te|0)|0}var le=256,Oe=4194304;function tt(n){var i=n&42;if(i!==0)return i;switch(n&-n){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return n&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return n&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return n}}function bs(n,i,d){var m=n.pendingLanes;if(m===0)return 0;var x=0,j=n.suspendedLanes,O=n.pingedLanes;n=n.warmLanes;var U=m&134217727;return U!==0?(m=U&~j,m!==0?x=tt(m):(O&=U,O!==0?x=tt(O):d||(d=U&~n,d!==0&&(x=tt(d))))):(U=m&~j,U!==0?x=tt(U):O!==0?x=tt(O):d||(d=m&~n,d!==0&&(x=tt(d)))),x===0?0:i!==0&&i!==x&&(i&j)===0&&(j=x&-x,d=i&-i,j>=d||j===32&&(d&4194048)!==0)?i:x}function Ls(n,i){return(n.pendingLanes&~(n.suspendedLanes&~n.pingedLanes)&i)===0}function ka(n,i){switch(n){case 1:case 2:case 4:case 8:case 64:return i+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function Or(){var n=le;return le<<=1,(le&4194048)===0&&(le=256),n}function Ji(){var n=Oe;return Oe<<=1,(Oe&62914560)===0&&(Oe=4194304),n}function po(n){for(var i=[],d=0;31>d;d++)i.push(n);return i}function yn(n,i){n.pendingLanes|=i,i!==268435456&&(n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0)}function Bg(n,i,d,m,x,j){var O=n.pendingLanes;n.pendingLanes=d,n.suspendedLanes=0,n.pingedLanes=0,n.warmLanes=0,n.expiredLanes&=d,n.entangledLanes&=d,n.errorRecoveryDisabledLanes&=d,n.shellSuspendCounter=0;var U=n.entanglements,K=n.expirationTimes,de=n.hiddenUpdates;for(d=O&~d;0<d;){var ve=31-Qe(d),Ee=1<<ve;U[ve]=0,K[ve]=-1;var fe=de[ve];if(fe!==null)for(de[ve]=null,ve=0;ve<fe.length;ve++){var ge=fe[ve];ge!==null&&(ge.lane&=-536870913)}d&=~Ee}m!==0&&go(n,m,0),j!==0&&x===0&&n.tag!==0&&(n.suspendedLanes|=j&~(O&~i))}function go(n,i,d){n.pendingLanes|=i,n.suspendedLanes&=~i;var m=31-Qe(i);n.entangledLanes|=i,n.entanglements[m]=n.entanglements[m]|1073741824|d&4194090}function Vg(n,i){var d=n.entangledLanes|=i;for(n=n.entanglements;d;){var m=31-Qe(d),x=1<<m;x&i|n[m]&i&&(n[m]|=i),d&=~x}}function Om(n){switch(n){case 2:n=1;break;case 8:n=4;break;case 32:n=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:n=128;break;case 268435456:n=134217728;break;default:n=0}return n}function Dm(n){return n&=-n,2<n?8<n?(n&134217727)!==0?32:268435456:8:2}function qg(){var n=Y.p;return n!==0?n:(n=window.event,n===void 0?32:jv(n.type))}function wS(n,i){var d=Y.p;try{return Y.p=n,i()}finally{Y.p=d}}var Dr=Math.random().toString(36).slice(2),vs="__reactFiber$"+Dr,ks="__reactProps$"+Dr,xo="__reactContainer$"+Dr,Pm="__reactEvents$"+Dr,jS="__reactListeners$"+Dr,_S="__reactHandles$"+Dr,Fg="__reactResources$"+Dr,el="__reactMarker$"+Dr;function zm(n){delete n[vs],delete n[ks],delete n[Pm],delete n[jS],delete n[_S]}function yo(n){var i=n[vs];if(i)return i;for(var d=n.parentNode;d;){if(i=d[xo]||d[vs]){if(d=i.alternate,i.child!==null||d!==null&&d.child!==null)for(n=iv(n);n!==null;){if(d=n[vs])return d;n=iv(n)}return i}n=d,d=n.parentNode}return null}function bo(n){if(n=n[vs]||n[xo]){var i=n.tag;if(i===5||i===6||i===13||i===26||i===27||i===3)return n}return null}function tl(n){var i=n.tag;if(i===5||i===26||i===27||i===6)return n.stateNode;throw Error(r(33))}function vo(n){var i=n[Fg];return i||(i=n[Fg]={hoistableStyles:new Map,hoistableScripts:new Map}),i}function cs(n){n[el]=!0}var Hg=new Set,Gg={};function bn(n,i){wo(n,i),wo(n+"Capture",i)}function wo(n,i){for(Gg[n]=i,n=0;n<i.length;n++)Hg.add(i[n])}var NS=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Zg={},Wg={};function SS(n){return me.call(Wg,n)?!0:me.call(Zg,n)?!1:NS.test(n)?Wg[n]=!0:(Zg[n]=!0,!1)}function Wc(n,i,d){if(SS(i))if(d===null)n.removeAttribute(i);else{switch(typeof d){case"undefined":case"function":case"symbol":n.removeAttribute(i);return;case"boolean":var m=i.toLowerCase().slice(0,5);if(m!=="data-"&&m!=="aria-"){n.removeAttribute(i);return}}n.setAttribute(i,""+d)}}function Yc(n,i,d){if(d===null)n.removeAttribute(i);else{switch(typeof d){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(i);return}n.setAttribute(i,""+d)}}function Qa(n,i,d,m){if(m===null)n.removeAttribute(d);else{switch(typeof m){case"undefined":case"function":case"symbol":case"boolean":n.removeAttribute(d);return}n.setAttributeNS(i,d,""+m)}}var $m,Yg;function jo(n){if($m===void 0)try{throw Error()}catch(d){var i=d.stack.trim().match(/\n( *(at )?)/);$m=i&&i[1]||"",Yg=-1<d.stack.indexOf(`
    at`)?" (<anonymous>)":-1<d.stack.indexOf("@")?"@unknown:0:0":""}return`
`+$m+n+Yg}var Im=!1;function Lm(n,i){if(!n||Im)return"";Im=!0;var d=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var m={DetermineComponentFrameRoot:function(){try{if(i){var Ee=function(){throw Error()};if(Object.defineProperty(Ee.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Ee,[])}catch(ge){var fe=ge}Reflect.construct(n,[],Ee)}else{try{Ee.call()}catch(ge){fe=ge}n.call(Ee.prototype)}}else{try{throw Error()}catch(ge){fe=ge}(Ee=n())&&typeof Ee.catch=="function"&&Ee.catch(function(){})}}catch(ge){if(ge&&fe&&typeof ge.stack=="string")return[ge.stack,fe.stack]}return[null,null]}};m.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var x=Object.getOwnPropertyDescriptor(m.DetermineComponentFrameRoot,"name");x&&x.configurable&&Object.defineProperty(m.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var j=m.DetermineComponentFrameRoot(),O=j[0],U=j[1];if(O&&U){var K=O.split(`
`),de=U.split(`
`);for(x=m=0;m<K.length&&!K[m].includes("DetermineComponentFrameRoot");)m++;for(;x<de.length&&!de[x].includes("DetermineComponentFrameRoot");)x++;if(m===K.length||x===de.length)for(m=K.length-1,x=de.length-1;1<=m&&0<=x&&K[m]!==de[x];)x--;for(;1<=m&&0<=x;m--,x--)if(K[m]!==de[x]){if(m!==1||x!==1)do if(m--,x--,0>x||K[m]!==de[x]){var ve=`
`+K[m].replace(" at new "," at ");return n.displayName&&ve.includes("<anonymous>")&&(ve=ve.replace("<anonymous>",n.displayName)),ve}while(1<=m&&0<=x);break}}}finally{Im=!1,Error.prepareStackTrace=d}return(d=n?n.displayName||n.name:"")?jo(d):""}function ES(n){switch(n.tag){case 26:case 27:case 5:return jo(n.type);case 16:return jo("Lazy");case 13:return jo("Suspense");case 19:return jo("SuspenseList");case 0:case 15:return Lm(n.type,!1);case 11:return Lm(n.type.render,!1);case 1:return Lm(n.type,!0);case 31:return jo("Activity");default:return""}}function Kg(n){try{var i="";do i+=ES(n),n=n.return;while(n);return i}catch(d){return`
Error generating stack: `+d.message+`
`+d.stack}}function Qs(n){switch(typeof n){case"bigint":case"boolean":case"number":case"string":case"undefined":return n;case"object":return n;default:return""}}function Xg(n){var i=n.type;return(n=n.nodeName)&&n.toLowerCase()==="input"&&(i==="checkbox"||i==="radio")}function CS(n){var i=Xg(n)?"checked":"value",d=Object.getOwnPropertyDescriptor(n.constructor.prototype,i),m=""+n[i];if(!n.hasOwnProperty(i)&&typeof d<"u"&&typeof d.get=="function"&&typeof d.set=="function"){var x=d.get,j=d.set;return Object.defineProperty(n,i,{configurable:!0,get:function(){return x.call(this)},set:function(O){m=""+O,j.call(this,O)}}),Object.defineProperty(n,i,{enumerable:d.enumerable}),{getValue:function(){return m},setValue:function(O){m=""+O},stopTracking:function(){n._valueTracker=null,delete n[i]}}}}function Kc(n){n._valueTracker||(n._valueTracker=CS(n))}function Qg(n){if(!n)return!1;var i=n._valueTracker;if(!i)return!0;var d=i.getValue(),m="";return n&&(m=Xg(n)?n.checked?"true":"false":n.value),n=m,n!==d?(i.setValue(n),!0):!1}function Xc(n){if(n=n||(typeof document<"u"?document:void 0),typeof n>"u")return null;try{return n.activeElement||n.body}catch{return n.body}}var TS=/[\n"\\]/g;function Js(n){return n.replace(TS,function(i){return"\\"+i.charCodeAt(0).toString(16)+" "})}function Um(n,i,d,m,x,j,O,U){n.name="",O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"?n.type=O:n.removeAttribute("type"),i!=null?O==="number"?(i===0&&n.value===""||n.value!=i)&&(n.value=""+Qs(i)):n.value!==""+Qs(i)&&(n.value=""+Qs(i)):O!=="submit"&&O!=="reset"||n.removeAttribute("value"),i!=null?Bm(n,O,Qs(i)):d!=null?Bm(n,O,Qs(d)):m!=null&&n.removeAttribute("value"),x==null&&j!=null&&(n.defaultChecked=!!j),x!=null&&(n.checked=x&&typeof x!="function"&&typeof x!="symbol"),U!=null&&typeof U!="function"&&typeof U!="symbol"&&typeof U!="boolean"?n.name=""+Qs(U):n.removeAttribute("name")}function Jg(n,i,d,m,x,j,O,U){if(j!=null&&typeof j!="function"&&typeof j!="symbol"&&typeof j!="boolean"&&(n.type=j),i!=null||d!=null){if(!(j!=="submit"&&j!=="reset"||i!=null))return;d=d!=null?""+Qs(d):"",i=i!=null?""+Qs(i):d,U||i===n.value||(n.value=i),n.defaultValue=i}m=m??x,m=typeof m!="function"&&typeof m!="symbol"&&!!m,n.checked=U?n.checked:!!m,n.defaultChecked=!!m,O!=null&&typeof O!="function"&&typeof O!="symbol"&&typeof O!="boolean"&&(n.name=O)}function Bm(n,i,d){i==="number"&&Xc(n.ownerDocument)===n||n.defaultValue===""+d||(n.defaultValue=""+d)}function _o(n,i,d,m){if(n=n.options,i){i={};for(var x=0;x<d.length;x++)i["$"+d[x]]=!0;for(d=0;d<n.length;d++)x=i.hasOwnProperty("$"+n[d].value),n[d].selected!==x&&(n[d].selected=x),x&&m&&(n[d].defaultSelected=!0)}else{for(d=""+Qs(d),i=null,x=0;x<n.length;x++){if(n[x].value===d){n[x].selected=!0,m&&(n[x].defaultSelected=!0);return}i!==null||n[x].disabled||(i=n[x])}i!==null&&(i.selected=!0)}}function ex(n,i,d){if(i!=null&&(i=""+Qs(i),i!==n.value&&(n.value=i),d==null)){n.defaultValue!==i&&(n.defaultValue=i);return}n.defaultValue=d!=null?""+Qs(d):""}function tx(n,i,d,m){if(i==null){if(m!=null){if(d!=null)throw Error(r(92));if(J(m)){if(1<m.length)throw Error(r(93));m=m[0]}d=m}d==null&&(d=""),i=d}d=Qs(i),n.defaultValue=d,m=n.textContent,m===d&&m!==""&&m!==null&&(n.value=m)}function No(n,i){if(i){var d=n.firstChild;if(d&&d===n.lastChild&&d.nodeType===3){d.nodeValue=i;return}}n.textContent=i}var kS=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function sx(n,i,d){var m=i.indexOf("--")===0;d==null||typeof d=="boolean"||d===""?m?n.setProperty(i,""):i==="float"?n.cssFloat="":n[i]="":m?n.setProperty(i,d):typeof d!="number"||d===0||kS.has(i)?i==="float"?n.cssFloat=d:n[i]=(""+d).trim():n[i]=d+"px"}function ax(n,i,d){if(i!=null&&typeof i!="object")throw Error(r(62));if(n=n.style,d!=null){for(var m in d)!d.hasOwnProperty(m)||i!=null&&i.hasOwnProperty(m)||(m.indexOf("--")===0?n.setProperty(m,""):m==="float"?n.cssFloat="":n[m]="");for(var x in i)m=i[x],i.hasOwnProperty(x)&&d[x]!==m&&sx(n,x,m)}else for(var j in i)i.hasOwnProperty(j)&&sx(n,j,i[j])}function Vm(n){if(n.indexOf("-")===-1)return!1;switch(n){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var AS=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),MS=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Qc(n){return MS.test(""+n)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":n}var qm=null;function Fm(n){return n=n.target||n.srcElement||window,n.correspondingUseElement&&(n=n.correspondingUseElement),n.nodeType===3?n.parentNode:n}var So=null,Eo=null;function rx(n){var i=bo(n);if(i&&(n=i.stateNode)){var d=n[ks]||null;e:switch(n=i.stateNode,i.type){case"input":if(Um(n,d.value,d.defaultValue,d.defaultValue,d.checked,d.defaultChecked,d.type,d.name),i=d.name,d.type==="radio"&&i!=null){for(d=n;d.parentNode;)d=d.parentNode;for(d=d.querySelectorAll('input[name="'+Js(""+i)+'"][type="radio"]'),i=0;i<d.length;i++){var m=d[i];if(m!==n&&m.form===n.form){var x=m[ks]||null;if(!x)throw Error(r(90));Um(m,x.value,x.defaultValue,x.defaultValue,x.checked,x.defaultChecked,x.type,x.name)}}for(i=0;i<d.length;i++)m=d[i],m.form===n.form&&Qg(m)}break e;case"textarea":ex(n,d.value,d.defaultValue);break e;case"select":i=d.value,i!=null&&_o(n,!!d.multiple,i,!1)}}}var Hm=!1;function nx(n,i,d){if(Hm)return n(i,d);Hm=!0;try{var m=n(i);return m}finally{if(Hm=!1,(So!==null||Eo!==null)&&($d(),So&&(i=So,n=Eo,Eo=So=null,rx(i),n)))for(i=0;i<n.length;i++)rx(n[i])}}function sl(n,i){var d=n.stateNode;if(d===null)return null;var m=d[ks]||null;if(m===null)return null;d=m[i];e:switch(i){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(m=!m.disabled)||(n=n.type,m=!(n==="button"||n==="input"||n==="select"||n==="textarea")),n=!m;break e;default:n=!1}if(n)return null;if(d&&typeof d!="function")throw Error(r(231,i,typeof d));return d}var Ja=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Gm=!1;if(Ja)try{var al={};Object.defineProperty(al,"passive",{get:function(){Gm=!0}}),window.addEventListener("test",al,al),window.removeEventListener("test",al,al)}catch{Gm=!1}var Pr=null,Zm=null,Jc=null;function ox(){if(Jc)return Jc;var n,i=Zm,d=i.length,m,x="value"in Pr?Pr.value:Pr.textContent,j=x.length;for(n=0;n<d&&i[n]===x[n];n++);var O=d-n;for(m=1;m<=O&&i[d-m]===x[j-m];m++);return Jc=x.slice(n,1<m?1-m:void 0)}function ed(n){var i=n.keyCode;return"charCode"in n?(n=n.charCode,n===0&&i===13&&(n=13)):n=i,n===10&&(n=13),32<=n||n===13?n:0}function td(){return!0}function ix(){return!1}function As(n){function i(d,m,x,j,O){this._reactName=d,this._targetInst=x,this.type=m,this.nativeEvent=j,this.target=O,this.currentTarget=null;for(var U in n)n.hasOwnProperty(U)&&(d=n[U],this[U]=d?d(j):j[U]);return this.isDefaultPrevented=(j.defaultPrevented!=null?j.defaultPrevented:j.returnValue===!1)?td:ix,this.isPropagationStopped=ix,this}return p(i.prototype,{preventDefault:function(){this.defaultPrevented=!0;var d=this.nativeEvent;d&&(d.preventDefault?d.preventDefault():typeof d.returnValue!="unknown"&&(d.returnValue=!1),this.isDefaultPrevented=td)},stopPropagation:function(){var d=this.nativeEvent;d&&(d.stopPropagation?d.stopPropagation():typeof d.cancelBubble!="unknown"&&(d.cancelBubble=!0),this.isPropagationStopped=td)},persist:function(){},isPersistent:td}),i}var vn={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(n){return n.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},sd=As(vn),rl=p({},vn,{view:0,detail:0}),RS=As(rl),Wm,Ym,nl,ad=p({},rl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Xm,button:0,buttons:0,relatedTarget:function(n){return n.relatedTarget===void 0?n.fromElement===n.srcElement?n.toElement:n.fromElement:n.relatedTarget},movementX:function(n){return"movementX"in n?n.movementX:(n!==nl&&(nl&&n.type==="mousemove"?(Wm=n.screenX-nl.screenX,Ym=n.screenY-nl.screenY):Ym=Wm=0,nl=n),Wm)},movementY:function(n){return"movementY"in n?n.movementY:Ym}}),lx=As(ad),OS=p({},ad,{dataTransfer:0}),DS=As(OS),PS=p({},rl,{relatedTarget:0}),Km=As(PS),zS=p({},vn,{animationName:0,elapsedTime:0,pseudoElement:0}),$S=As(zS),IS=p({},vn,{clipboardData:function(n){return"clipboardData"in n?n.clipboardData:window.clipboardData}}),LS=As(IS),US=p({},vn,{data:0}),cx=As(US),BS={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},VS={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},qS={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function FS(n){var i=this.nativeEvent;return i.getModifierState?i.getModifierState(n):(n=qS[n])?!!i[n]:!1}function Xm(){return FS}var HS=p({},rl,{key:function(n){if(n.key){var i=BS[n.key]||n.key;if(i!=="Unidentified")return i}return n.type==="keypress"?(n=ed(n),n===13?"Enter":String.fromCharCode(n)):n.type==="keydown"||n.type==="keyup"?VS[n.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Xm,charCode:function(n){return n.type==="keypress"?ed(n):0},keyCode:function(n){return n.type==="keydown"||n.type==="keyup"?n.keyCode:0},which:function(n){return n.type==="keypress"?ed(n):n.type==="keydown"||n.type==="keyup"?n.keyCode:0}}),GS=As(HS),ZS=p({},ad,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),dx=As(ZS),WS=p({},rl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Xm}),YS=As(WS),KS=p({},vn,{propertyName:0,elapsedTime:0,pseudoElement:0}),XS=As(KS),QS=p({},ad,{deltaX:function(n){return"deltaX"in n?n.deltaX:"wheelDeltaX"in n?-n.wheelDeltaX:0},deltaY:function(n){return"deltaY"in n?n.deltaY:"wheelDeltaY"in n?-n.wheelDeltaY:"wheelDelta"in n?-n.wheelDelta:0},deltaZ:0,deltaMode:0}),JS=As(QS),eE=p({},vn,{newState:0,oldState:0}),tE=As(eE),sE=[9,13,27,32],Qm=Ja&&"CompositionEvent"in window,ol=null;Ja&&"documentMode"in document&&(ol=document.documentMode);var aE=Ja&&"TextEvent"in window&&!ol,ux=Ja&&(!Qm||ol&&8<ol&&11>=ol),mx=" ",hx=!1;function fx(n,i){switch(n){case"keyup":return sE.indexOf(i.keyCode)!==-1;case"keydown":return i.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function px(n){return n=n.detail,typeof n=="object"&&"data"in n?n.data:null}var Co=!1;function rE(n,i){switch(n){case"compositionend":return px(i);case"keypress":return i.which!==32?null:(hx=!0,mx);case"textInput":return n=i.data,n===mx&&hx?null:n;default:return null}}function nE(n,i){if(Co)return n==="compositionend"||!Qm&&fx(n,i)?(n=ox(),Jc=Zm=Pr=null,Co=!1,n):null;switch(n){case"paste":return null;case"keypress":if(!(i.ctrlKey||i.altKey||i.metaKey)||i.ctrlKey&&i.altKey){if(i.char&&1<i.char.length)return i.char;if(i.which)return String.fromCharCode(i.which)}return null;case"compositionend":return ux&&i.locale!=="ko"?null:i.data;default:return null}}var oE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function gx(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i==="input"?!!oE[n.type]:i==="textarea"}function xx(n,i,d,m){So?Eo?Eo.push(m):Eo=[m]:So=m,i=qd(i,"onChange"),0<i.length&&(d=new sd("onChange","change",null,d,m),n.push({event:d,listeners:i}))}var il=null,ll=null;function iE(n){Xb(n,0)}function rd(n){var i=tl(n);if(Qg(i))return n}function yx(n,i){if(n==="change")return i}var bx=!1;if(Ja){var Jm;if(Ja){var eh="oninput"in document;if(!eh){var vx=document.createElement("div");vx.setAttribute("oninput","return;"),eh=typeof vx.oninput=="function"}Jm=eh}else Jm=!1;bx=Jm&&(!document.documentMode||9<document.documentMode)}function wx(){il&&(il.detachEvent("onpropertychange",jx),ll=il=null)}function jx(n){if(n.propertyName==="value"&&rd(ll)){var i=[];xx(i,ll,n,Fm(n)),nx(iE,i)}}function lE(n,i,d){n==="focusin"?(wx(),il=i,ll=d,il.attachEvent("onpropertychange",jx)):n==="focusout"&&wx()}function cE(n){if(n==="selectionchange"||n==="keyup"||n==="keydown")return rd(ll)}function dE(n,i){if(n==="click")return rd(i)}function uE(n,i){if(n==="input"||n==="change")return rd(i)}function mE(n,i){return n===i&&(n!==0||1/n===1/i)||n!==n&&i!==i}var Us=typeof Object.is=="function"?Object.is:mE;function cl(n,i){if(Us(n,i))return!0;if(typeof n!="object"||n===null||typeof i!="object"||i===null)return!1;var d=Object.keys(n),m=Object.keys(i);if(d.length!==m.length)return!1;for(m=0;m<d.length;m++){var x=d[m];if(!me.call(i,x)||!Us(n[x],i[x]))return!1}return!0}function _x(n){for(;n&&n.firstChild;)n=n.firstChild;return n}function Nx(n,i){var d=_x(n);n=0;for(var m;d;){if(d.nodeType===3){if(m=n+d.textContent.length,n<=i&&m>=i)return{node:d,offset:i-n};n=m}e:{for(;d;){if(d.nextSibling){d=d.nextSibling;break e}d=d.parentNode}d=void 0}d=_x(d)}}function Sx(n,i){return n&&i?n===i?!0:n&&n.nodeType===3?!1:i&&i.nodeType===3?Sx(n,i.parentNode):"contains"in n?n.contains(i):n.compareDocumentPosition?!!(n.compareDocumentPosition(i)&16):!1:!1}function Ex(n){n=n!=null&&n.ownerDocument!=null&&n.ownerDocument.defaultView!=null?n.ownerDocument.defaultView:window;for(var i=Xc(n.document);i instanceof n.HTMLIFrameElement;){try{var d=typeof i.contentWindow.location.href=="string"}catch{d=!1}if(d)n=i.contentWindow;else break;i=Xc(n.document)}return i}function th(n){var i=n&&n.nodeName&&n.nodeName.toLowerCase();return i&&(i==="input"&&(n.type==="text"||n.type==="search"||n.type==="tel"||n.type==="url"||n.type==="password")||i==="textarea"||n.contentEditable==="true")}var hE=Ja&&"documentMode"in document&&11>=document.documentMode,To=null,sh=null,dl=null,ah=!1;function Cx(n,i,d){var m=d.window===d?d.document:d.nodeType===9?d:d.ownerDocument;ah||To==null||To!==Xc(m)||(m=To,"selectionStart"in m&&th(m)?m={start:m.selectionStart,end:m.selectionEnd}:(m=(m.ownerDocument&&m.ownerDocument.defaultView||window).getSelection(),m={anchorNode:m.anchorNode,anchorOffset:m.anchorOffset,focusNode:m.focusNode,focusOffset:m.focusOffset}),dl&&cl(dl,m)||(dl=m,m=qd(sh,"onSelect"),0<m.length&&(i=new sd("onSelect","select",null,i,d),n.push({event:i,listeners:m}),i.target=To)))}function wn(n,i){var d={};return d[n.toLowerCase()]=i.toLowerCase(),d["Webkit"+n]="webkit"+i,d["Moz"+n]="moz"+i,d}var ko={animationend:wn("Animation","AnimationEnd"),animationiteration:wn("Animation","AnimationIteration"),animationstart:wn("Animation","AnimationStart"),transitionrun:wn("Transition","TransitionRun"),transitionstart:wn("Transition","TransitionStart"),transitioncancel:wn("Transition","TransitionCancel"),transitionend:wn("Transition","TransitionEnd")},rh={},Tx={};Ja&&(Tx=document.createElement("div").style,"AnimationEvent"in window||(delete ko.animationend.animation,delete ko.animationiteration.animation,delete ko.animationstart.animation),"TransitionEvent"in window||delete ko.transitionend.transition);function jn(n){if(rh[n])return rh[n];if(!ko[n])return n;var i=ko[n],d;for(d in i)if(i.hasOwnProperty(d)&&d in Tx)return rh[n]=i[d];return n}var kx=jn("animationend"),Ax=jn("animationiteration"),Mx=jn("animationstart"),fE=jn("transitionrun"),pE=jn("transitionstart"),gE=jn("transitioncancel"),Rx=jn("transitionend"),Ox=new Map,nh="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");nh.push("scrollEnd");function pa(n,i){Ox.set(n,i),bn(i,[n])}var Dx=new WeakMap;function ea(n,i){if(typeof n=="object"&&n!==null){var d=Dx.get(n);return d!==void 0?d:(i={value:n,source:i,stack:Kg(i)},Dx.set(n,i),i)}return{value:n,source:i,stack:Kg(i)}}var ta=[],Ao=0,oh=0;function nd(){for(var n=Ao,i=oh=Ao=0;i<n;){var d=ta[i];ta[i++]=null;var m=ta[i];ta[i++]=null;var x=ta[i];ta[i++]=null;var j=ta[i];if(ta[i++]=null,m!==null&&x!==null){var O=m.pending;O===null?x.next=x:(x.next=O.next,O.next=x),m.pending=x}j!==0&&Px(d,x,j)}}function od(n,i,d,m){ta[Ao++]=n,ta[Ao++]=i,ta[Ao++]=d,ta[Ao++]=m,oh|=m,n.lanes|=m,n=n.alternate,n!==null&&(n.lanes|=m)}function ih(n,i,d,m){return od(n,i,d,m),id(n)}function Mo(n,i){return od(n,null,null,i),id(n)}function Px(n,i,d){n.lanes|=d;var m=n.alternate;m!==null&&(m.lanes|=d);for(var x=!1,j=n.return;j!==null;)j.childLanes|=d,m=j.alternate,m!==null&&(m.childLanes|=d),j.tag===22&&(n=j.stateNode,n===null||n._visibility&1||(x=!0)),n=j,j=j.return;return n.tag===3?(j=n.stateNode,x&&i!==null&&(x=31-Qe(d),n=j.hiddenUpdates,m=n[x],m===null?n[x]=[i]:m.push(i),i.lane=d|536870912),j):null}function id(n){if(50<Pl)throw Pl=0,ff=null,Error(r(185));for(var i=n.return;i!==null;)n=i,i=n.return;return n.tag===3?n.stateNode:null}var Ro={};function xE(n,i,d,m){this.tag=n,this.key=d,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=m,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bs(n,i,d,m){return new xE(n,i,d,m)}function lh(n){return n=n.prototype,!(!n||!n.isReactComponent)}function er(n,i){var d=n.alternate;return d===null?(d=Bs(n.tag,i,n.key,n.mode),d.elementType=n.elementType,d.type=n.type,d.stateNode=n.stateNode,d.alternate=n,n.alternate=d):(d.pendingProps=i,d.type=n.type,d.flags=0,d.subtreeFlags=0,d.deletions=null),d.flags=n.flags&65011712,d.childLanes=n.childLanes,d.lanes=n.lanes,d.child=n.child,d.memoizedProps=n.memoizedProps,d.memoizedState=n.memoizedState,d.updateQueue=n.updateQueue,i=n.dependencies,d.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},d.sibling=n.sibling,d.index=n.index,d.ref=n.ref,d.refCleanup=n.refCleanup,d}function zx(n,i){n.flags&=65011714;var d=n.alternate;return d===null?(n.childLanes=0,n.lanes=i,n.child=null,n.subtreeFlags=0,n.memoizedProps=null,n.memoizedState=null,n.updateQueue=null,n.dependencies=null,n.stateNode=null):(n.childLanes=d.childLanes,n.lanes=d.lanes,n.child=d.child,n.subtreeFlags=0,n.deletions=null,n.memoizedProps=d.memoizedProps,n.memoizedState=d.memoizedState,n.updateQueue=d.updateQueue,n.type=d.type,i=d.dependencies,n.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext}),n}function ld(n,i,d,m,x,j){var O=0;if(m=n,typeof n=="function")lh(n)&&(O=1);else if(typeof n=="string")O=bC(n,d,re.current)?26:n==="html"||n==="head"||n==="body"?27:5;else e:switch(n){case z:return n=Bs(31,d,i,x),n.elementType=z,n.lanes=j,n;case _:return _n(d.children,x,j,i);case w:O=8,x|=24;break;case E:return n=Bs(12,d,i,x|2),n.elementType=E,n.lanes=j,n;case T:return n=Bs(13,d,i,x),n.elementType=T,n.lanes=j,n;case M:return n=Bs(19,d,i,x),n.elementType=M,n.lanes=j,n;default:if(typeof n=="object"&&n!==null)switch(n.$$typeof){case k:case C:O=10;break e;case N:O=9;break e;case S:O=11;break e;case $:O=14;break e;case A:O=16,m=null;break e}O=29,d=Error(r(130,n===null?"null":typeof n,"")),m=null}return i=Bs(O,d,i,x),i.elementType=n,i.type=m,i.lanes=j,i}function _n(n,i,d,m){return n=Bs(7,n,m,i),n.lanes=d,n}function ch(n,i,d){return n=Bs(6,n,null,i),n.lanes=d,n}function dh(n,i,d){return i=Bs(4,n.children!==null?n.children:[],n.key,i),i.lanes=d,i.stateNode={containerInfo:n.containerInfo,pendingChildren:null,implementation:n.implementation},i}var Oo=[],Do=0,cd=null,dd=0,sa=[],aa=0,Nn=null,tr=1,sr="";function Sn(n,i){Oo[Do++]=dd,Oo[Do++]=cd,cd=n,dd=i}function $x(n,i,d){sa[aa++]=tr,sa[aa++]=sr,sa[aa++]=Nn,Nn=n;var m=tr;n=sr;var x=32-Qe(m)-1;m&=~(1<<x),d+=1;var j=32-Qe(i)+x;if(30<j){var O=x-x%5;j=(m&(1<<O)-1).toString(32),m>>=O,x-=O,tr=1<<32-Qe(i)+x|d<<x|m,sr=j+n}else tr=1<<j|d<<x|m,sr=n}function uh(n){n.return!==null&&(Sn(n,1),$x(n,1,0))}function mh(n){for(;n===cd;)cd=Oo[--Do],Oo[Do]=null,dd=Oo[--Do],Oo[Do]=null;for(;n===Nn;)Nn=sa[--aa],sa[aa]=null,sr=sa[--aa],sa[aa]=null,tr=sa[--aa],sa[aa]=null}var Ss=null,$t=null,ct=!1,En=null,Aa=!1,hh=Error(r(519));function Cn(n){var i=Error(r(418,""));throw hl(ea(i,n)),hh}function Ix(n){var i=n.stateNode,d=n.type,m=n.memoizedProps;switch(i[vs]=n,i[ks]=m,d){case"dialog":at("cancel",i),at("close",i);break;case"iframe":case"object":case"embed":at("load",i);break;case"video":case"audio":for(d=0;d<$l.length;d++)at($l[d],i);break;case"source":at("error",i);break;case"img":case"image":case"link":at("error",i),at("load",i);break;case"details":at("toggle",i);break;case"input":at("invalid",i),Jg(i,m.value,m.defaultValue,m.checked,m.defaultChecked,m.type,m.name,!0),Kc(i);break;case"select":at("invalid",i);break;case"textarea":at("invalid",i),tx(i,m.value,m.defaultValue,m.children),Kc(i)}d=m.children,typeof d!="string"&&typeof d!="number"&&typeof d!="bigint"||i.textContent===""+d||m.suppressHydrationWarning===!0||tv(i.textContent,d)?(m.popover!=null&&(at("beforetoggle",i),at("toggle",i)),m.onScroll!=null&&at("scroll",i),m.onScrollEnd!=null&&at("scrollend",i),m.onClick!=null&&(i.onclick=Fd),i=!0):i=!1,i||Cn(n)}function Lx(n){for(Ss=n.return;Ss;)switch(Ss.tag){case 5:case 13:Aa=!1;return;case 27:case 3:Aa=!0;return;default:Ss=Ss.return}}function ul(n){if(n!==Ss)return!1;if(!ct)return Lx(n),ct=!0,!1;var i=n.tag,d;if((d=i!==3&&i!==27)&&((d=i===5)&&(d=n.type,d=!(d!=="form"&&d!=="button")||Af(n.type,n.memoizedProps)),d=!d),d&&$t&&Cn(n),Lx(n),i===13){if(n=n.memoizedState,n=n!==null?n.dehydrated:null,!n)throw Error(r(317));e:{for(n=n.nextSibling,i=0;n;){if(n.nodeType===8)if(d=n.data,d==="/$"){if(i===0){$t=xa(n.nextSibling);break e}i--}else d!=="$"&&d!=="$!"&&d!=="$?"||i++;n=n.nextSibling}$t=null}}else i===27?(i=$t,Xr(n.type)?(n=Df,Df=null,$t=n):$t=i):$t=Ss?xa(n.stateNode.nextSibling):null;return!0}function ml(){$t=Ss=null,ct=!1}function Ux(){var n=En;return n!==null&&(Os===null?Os=n:Os.push.apply(Os,n),En=null),n}function hl(n){En===null?En=[n]:En.push(n)}var fh=H(null),Tn=null,ar=null;function zr(n,i,d){Z(fh,i._currentValue),i._currentValue=d}function rr(n){n._currentValue=fh.current,F(fh)}function ph(n,i,d){for(;n!==null;){var m=n.alternate;if((n.childLanes&i)!==i?(n.childLanes|=i,m!==null&&(m.childLanes|=i)):m!==null&&(m.childLanes&i)!==i&&(m.childLanes|=i),n===d)break;n=n.return}}function gh(n,i,d,m){var x=n.child;for(x!==null&&(x.return=n);x!==null;){var j=x.dependencies;if(j!==null){var O=x.child;j=j.firstContext;e:for(;j!==null;){var U=j;j=x;for(var K=0;K<i.length;K++)if(U.context===i[K]){j.lanes|=d,U=j.alternate,U!==null&&(U.lanes|=d),ph(j.return,d,n),m||(O=null);break e}j=U.next}}else if(x.tag===18){if(O=x.return,O===null)throw Error(r(341));O.lanes|=d,j=O.alternate,j!==null&&(j.lanes|=d),ph(O,d,n),O=null}else O=x.child;if(O!==null)O.return=x;else for(O=x;O!==null;){if(O===n){O=null;break}if(x=O.sibling,x!==null){x.return=O.return,O=x;break}O=O.return}x=O}}function fl(n,i,d,m){n=null;for(var x=i,j=!1;x!==null;){if(!j){if((x.flags&524288)!==0)j=!0;else if((x.flags&262144)!==0)break}if(x.tag===10){var O=x.alternate;if(O===null)throw Error(r(387));if(O=O.memoizedProps,O!==null){var U=x.type;Us(x.pendingProps.value,O.value)||(n!==null?n.push(U):n=[U])}}else if(x===pe.current){if(O=x.alternate,O===null)throw Error(r(387));O.memoizedState.memoizedState!==x.memoizedState.memoizedState&&(n!==null?n.push(ql):n=[ql])}x=x.return}n!==null&&gh(i,n,d,m),i.flags|=262144}function ud(n){for(n=n.firstContext;n!==null;){if(!Us(n.context._currentValue,n.memoizedValue))return!0;n=n.next}return!1}function kn(n){Tn=n,ar=null,n=n.dependencies,n!==null&&(n.firstContext=null)}function ws(n){return Bx(Tn,n)}function md(n,i){return Tn===null&&kn(n),Bx(n,i)}function Bx(n,i){var d=i._currentValue;if(i={context:i,memoizedValue:d,next:null},ar===null){if(n===null)throw Error(r(308));ar=i,n.dependencies={lanes:0,firstContext:i},n.flags|=524288}else ar=ar.next=i;return d}var yE=typeof AbortController<"u"?AbortController:function(){var n=[],i=this.signal={aborted:!1,addEventListener:function(d,m){n.push(m)}};this.abort=function(){i.aborted=!0,n.forEach(function(d){return d()})}},bE=t.unstable_scheduleCallback,vE=t.unstable_NormalPriority,as={$$typeof:C,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function xh(){return{controller:new yE,data:new Map,refCount:0}}function pl(n){n.refCount--,n.refCount===0&&bE(vE,function(){n.controller.abort()})}var gl=null,yh=0,Po=0,zo=null;function wE(n,i){if(gl===null){var d=gl=[];yh=0,Po=wf(),zo={status:"pending",value:void 0,then:function(m){d.push(m)}}}return yh++,i.then(Vx,Vx),i}function Vx(){if(--yh===0&&gl!==null){zo!==null&&(zo.status="fulfilled");var n=gl;gl=null,Po=0,zo=null;for(var i=0;i<n.length;i++)(0,n[i])()}}function jE(n,i){var d=[],m={status:"pending",value:null,reason:null,then:function(x){d.push(x)}};return n.then(function(){m.status="fulfilled",m.value=i;for(var x=0;x<d.length;x++)(0,d[x])(i)},function(x){for(m.status="rejected",m.reason=x,x=0;x<d.length;x++)(0,d[x])(void 0)}),m}var qx=V.S;V.S=function(n,i){typeof i=="object"&&i!==null&&typeof i.then=="function"&&wE(n,i),qx!==null&&qx(n,i)};var An=H(null);function bh(){var n=An.current;return n!==null?n:_t.pooledCache}function hd(n,i){i===null?Z(An,An.current):Z(An,i.pool)}function Fx(){var n=bh();return n===null?null:{parent:as._currentValue,pool:n}}var xl=Error(r(460)),Hx=Error(r(474)),fd=Error(r(542)),vh={then:function(){}};function Gx(n){return n=n.status,n==="fulfilled"||n==="rejected"}function pd(){}function Zx(n,i,d){switch(d=n[d],d===void 0?n.push(i):d!==i&&(i.then(pd,pd),i=d),i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Yx(n),n;default:if(typeof i.status=="string")i.then(pd,pd);else{if(n=_t,n!==null&&100<n.shellSuspendCounter)throw Error(r(482));n=i,n.status="pending",n.then(function(m){if(i.status==="pending"){var x=i;x.status="fulfilled",x.value=m}},function(m){if(i.status==="pending"){var x=i;x.status="rejected",x.reason=m}})}switch(i.status){case"fulfilled":return i.value;case"rejected":throw n=i.reason,Yx(n),n}throw yl=i,xl}}var yl=null;function Wx(){if(yl===null)throw Error(r(459));var n=yl;return yl=null,n}function Yx(n){if(n===xl||n===fd)throw Error(r(483))}var $r=!1;function wh(n){n.updateQueue={baseState:n.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function jh(n,i){n=n.updateQueue,i.updateQueue===n&&(i.updateQueue={baseState:n.baseState,firstBaseUpdate:n.firstBaseUpdate,lastBaseUpdate:n.lastBaseUpdate,shared:n.shared,callbacks:null})}function Ir(n){return{lane:n,tag:0,payload:null,callback:null,next:null}}function Lr(n,i,d){var m=n.updateQueue;if(m===null)return null;if(m=m.shared,(mt&2)!==0){var x=m.pending;return x===null?i.next=i:(i.next=x.next,x.next=i),m.pending=i,i=id(n),Px(n,null,d),i}return od(n,m,i,d),id(n)}function bl(n,i,d){if(i=i.updateQueue,i!==null&&(i=i.shared,(d&4194048)!==0)){var m=i.lanes;m&=n.pendingLanes,d|=m,i.lanes=d,Vg(n,d)}}function _h(n,i){var d=n.updateQueue,m=n.alternate;if(m!==null&&(m=m.updateQueue,d===m)){var x=null,j=null;if(d=d.firstBaseUpdate,d!==null){do{var O={lane:d.lane,tag:d.tag,payload:d.payload,callback:null,next:null};j===null?x=j=O:j=j.next=O,d=d.next}while(d!==null);j===null?x=j=i:j=j.next=i}else x=j=i;d={baseState:m.baseState,firstBaseUpdate:x,lastBaseUpdate:j,shared:m.shared,callbacks:m.callbacks},n.updateQueue=d;return}n=d.lastBaseUpdate,n===null?d.firstBaseUpdate=i:n.next=i,d.lastBaseUpdate=i}var Nh=!1;function vl(){if(Nh){var n=zo;if(n!==null)throw n}}function wl(n,i,d,m){Nh=!1;var x=n.updateQueue;$r=!1;var j=x.firstBaseUpdate,O=x.lastBaseUpdate,U=x.shared.pending;if(U!==null){x.shared.pending=null;var K=U,de=K.next;K.next=null,O===null?j=de:O.next=de,O=K;var ve=n.alternate;ve!==null&&(ve=ve.updateQueue,U=ve.lastBaseUpdate,U!==O&&(U===null?ve.firstBaseUpdate=de:U.next=de,ve.lastBaseUpdate=K))}if(j!==null){var Ee=x.baseState;O=0,ve=de=K=null,U=j;do{var fe=U.lane&-536870913,ge=fe!==U.lane;if(ge?(ot&fe)===fe:(m&fe)===fe){fe!==0&&fe===Po&&(Nh=!0),ve!==null&&(ve=ve.next={lane:0,tag:U.tag,payload:U.payload,callback:null,next:null});e:{var Ze=n,Fe=U;fe=i;var xt=d;switch(Fe.tag){case 1:if(Ze=Fe.payload,typeof Ze=="function"){Ee=Ze.call(xt,Ee,fe);break e}Ee=Ze;break e;case 3:Ze.flags=Ze.flags&-65537|128;case 0:if(Ze=Fe.payload,fe=typeof Ze=="function"?Ze.call(xt,Ee,fe):Ze,fe==null)break e;Ee=p({},Ee,fe);break e;case 2:$r=!0}}fe=U.callback,fe!==null&&(n.flags|=64,ge&&(n.flags|=8192),ge=x.callbacks,ge===null?x.callbacks=[fe]:ge.push(fe))}else ge={lane:fe,tag:U.tag,payload:U.payload,callback:U.callback,next:null},ve===null?(de=ve=ge,K=Ee):ve=ve.next=ge,O|=fe;if(U=U.next,U===null){if(U=x.shared.pending,U===null)break;ge=U,U=ge.next,ge.next=null,x.lastBaseUpdate=ge,x.shared.pending=null}}while(!0);ve===null&&(K=Ee),x.baseState=K,x.firstBaseUpdate=de,x.lastBaseUpdate=ve,j===null&&(x.shared.lanes=0),Zr|=O,n.lanes=O,n.memoizedState=Ee}}function Kx(n,i){if(typeof n!="function")throw Error(r(191,n));n.call(i)}function Xx(n,i){var d=n.callbacks;if(d!==null)for(n.callbacks=null,n=0;n<d.length;n++)Kx(d[n],i)}var $o=H(null),gd=H(0);function Qx(n,i){n=ur,Z(gd,n),Z($o,i),ur=n|i.baseLanes}function Sh(){Z(gd,ur),Z($o,$o.current)}function Eh(){ur=gd.current,F($o),F(gd)}var Ur=0,Je=null,pt=null,Xt=null,xd=!1,Io=!1,Mn=!1,yd=0,jl=0,Lo=null,_E=0;function Vt(){throw Error(r(321))}function Ch(n,i){if(i===null)return!1;for(var d=0;d<i.length&&d<n.length;d++)if(!Us(n[d],i[d]))return!1;return!0}function Th(n,i,d,m,x,j){return Ur=j,Je=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,V.H=n===null||n.memoizedState===null?Py:zy,Mn=!1,j=d(m,x),Mn=!1,Io&&(j=ey(i,d,m,x)),Jx(n),j}function Jx(n){V.H=Nd;var i=pt!==null&&pt.next!==null;if(Ur=0,Xt=pt=Je=null,xd=!1,jl=0,Lo=null,i)throw Error(r(300));n===null||ds||(n=n.dependencies,n!==null&&ud(n)&&(ds=!0))}function ey(n,i,d,m){Je=n;var x=0;do{if(Io&&(Lo=null),jl=0,Io=!1,25<=x)throw Error(r(301));if(x+=1,Xt=pt=null,n.updateQueue!=null){var j=n.updateQueue;j.lastEffect=null,j.events=null,j.stores=null,j.memoCache!=null&&(j.memoCache.index=0)}V.H=AE,j=i(d,m)}while(Io);return j}function NE(){var n=V.H,i=n.useState()[0];return i=typeof i.then=="function"?_l(i):i,n=n.useState()[0],(pt!==null?pt.memoizedState:null)!==n&&(Je.flags|=1024),i}function kh(){var n=yd!==0;return yd=0,n}function Ah(n,i,d){i.updateQueue=n.updateQueue,i.flags&=-2053,n.lanes&=~d}function Mh(n){if(xd){for(n=n.memoizedState;n!==null;){var i=n.queue;i!==null&&(i.pending=null),n=n.next}xd=!1}Ur=0,Xt=pt=Je=null,Io=!1,jl=yd=0,Lo=null}function Ms(){var n={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Xt===null?Je.memoizedState=Xt=n:Xt=Xt.next=n,Xt}function Qt(){if(pt===null){var n=Je.alternate;n=n!==null?n.memoizedState:null}else n=pt.next;var i=Xt===null?Je.memoizedState:Xt.next;if(i!==null)Xt=i,pt=n;else{if(n===null)throw Je.alternate===null?Error(r(467)):Error(r(310));pt=n,n={memoizedState:pt.memoizedState,baseState:pt.baseState,baseQueue:pt.baseQueue,queue:pt.queue,next:null},Xt===null?Je.memoizedState=Xt=n:Xt=Xt.next=n}return Xt}function Rh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function _l(n){var i=jl;return jl+=1,Lo===null&&(Lo=[]),n=Zx(Lo,n,i),i=Je,(Xt===null?i.memoizedState:Xt.next)===null&&(i=i.alternate,V.H=i===null||i.memoizedState===null?Py:zy),n}function bd(n){if(n!==null&&typeof n=="object"){if(typeof n.then=="function")return _l(n);if(n.$$typeof===C)return ws(n)}throw Error(r(438,String(n)))}function Oh(n){var i=null,d=Je.updateQueue;if(d!==null&&(i=d.memoCache),i==null){var m=Je.alternate;m!==null&&(m=m.updateQueue,m!==null&&(m=m.memoCache,m!=null&&(i={data:m.data.map(function(x){return x.slice()}),index:0})))}if(i==null&&(i={data:[],index:0}),d===null&&(d=Rh(),Je.updateQueue=d),d.memoCache=i,d=i.data[i.index],d===void 0)for(d=i.data[i.index]=Array(n),m=0;m<n;m++)d[m]=R;return i.index++,d}function nr(n,i){return typeof i=="function"?i(n):i}function vd(n){var i=Qt();return Dh(i,pt,n)}function Dh(n,i,d){var m=n.queue;if(m===null)throw Error(r(311));m.lastRenderedReducer=d;var x=n.baseQueue,j=m.pending;if(j!==null){if(x!==null){var O=x.next;x.next=j.next,j.next=O}i.baseQueue=x=j,m.pending=null}if(j=n.baseState,x===null)n.memoizedState=j;else{i=x.next;var U=O=null,K=null,de=i,ve=!1;do{var Ee=de.lane&-536870913;if(Ee!==de.lane?(ot&Ee)===Ee:(Ur&Ee)===Ee){var fe=de.revertLane;if(fe===0)K!==null&&(K=K.next={lane:0,revertLane:0,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null}),Ee===Po&&(ve=!0);else if((Ur&fe)===fe){de=de.next,fe===Po&&(ve=!0);continue}else Ee={lane:0,revertLane:de.revertLane,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},K===null?(U=K=Ee,O=j):K=K.next=Ee,Je.lanes|=fe,Zr|=fe;Ee=de.action,Mn&&d(j,Ee),j=de.hasEagerState?de.eagerState:d(j,Ee)}else fe={lane:Ee,revertLane:de.revertLane,action:de.action,hasEagerState:de.hasEagerState,eagerState:de.eagerState,next:null},K===null?(U=K=fe,O=j):K=K.next=fe,Je.lanes|=Ee,Zr|=Ee;de=de.next}while(de!==null&&de!==i);if(K===null?O=j:K.next=U,!Us(j,n.memoizedState)&&(ds=!0,ve&&(d=zo,d!==null)))throw d;n.memoizedState=j,n.baseState=O,n.baseQueue=K,m.lastRenderedState=j}return x===null&&(m.lanes=0),[n.memoizedState,m.dispatch]}function Ph(n){var i=Qt(),d=i.queue;if(d===null)throw Error(r(311));d.lastRenderedReducer=n;var m=d.dispatch,x=d.pending,j=i.memoizedState;if(x!==null){d.pending=null;var O=x=x.next;do j=n(j,O.action),O=O.next;while(O!==x);Us(j,i.memoizedState)||(ds=!0),i.memoizedState=j,i.baseQueue===null&&(i.baseState=j),d.lastRenderedState=j}return[j,m]}function ty(n,i,d){var m=Je,x=Qt(),j=ct;if(j){if(d===void 0)throw Error(r(407));d=d()}else d=i();var O=!Us((pt||x).memoizedState,d);O&&(x.memoizedState=d,ds=!0),x=x.queue;var U=ry.bind(null,m,x,n);if(Nl(2048,8,U,[n]),x.getSnapshot!==i||O||Xt!==null&&Xt.memoizedState.tag&1){if(m.flags|=2048,Uo(9,wd(),ay.bind(null,m,x,d,i),null),_t===null)throw Error(r(349));j||(Ur&124)!==0||sy(m,i,d)}return d}function sy(n,i,d){n.flags|=16384,n={getSnapshot:i,value:d},i=Je.updateQueue,i===null?(i=Rh(),Je.updateQueue=i,i.stores=[n]):(d=i.stores,d===null?i.stores=[n]:d.push(n))}function ay(n,i,d,m){i.value=d,i.getSnapshot=m,ny(i)&&oy(n)}function ry(n,i,d){return d(function(){ny(i)&&oy(n)})}function ny(n){var i=n.getSnapshot;n=n.value;try{var d=i();return!Us(n,d)}catch{return!0}}function oy(n){var i=Mo(n,2);i!==null&&Gs(i,n,2)}function zh(n){var i=Ms();if(typeof n=="function"){var d=n;if(n=d(),Mn){Ge(!0);try{d()}finally{Ge(!1)}}}return i.memoizedState=i.baseState=n,i.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:nr,lastRenderedState:n},i}function iy(n,i,d,m){return n.baseState=d,Dh(n,pt,typeof m=="function"?m:nr)}function SE(n,i,d,m,x){if(_d(n))throw Error(r(485));if(n=i.action,n!==null){var j={payload:x,action:n,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(O){j.listeners.push(O)}};V.T!==null?d(!0):j.isTransition=!1,m(j),d=i.pending,d===null?(j.next=i.pending=j,ly(i,j)):(j.next=d.next,i.pending=d.next=j)}}function ly(n,i){var d=i.action,m=i.payload,x=n.state;if(i.isTransition){var j=V.T,O={};V.T=O;try{var U=d(x,m),K=V.S;K!==null&&K(O,U),cy(n,i,U)}catch(de){$h(n,i,de)}finally{V.T=j}}else try{j=d(x,m),cy(n,i,j)}catch(de){$h(n,i,de)}}function cy(n,i,d){d!==null&&typeof d=="object"&&typeof d.then=="function"?d.then(function(m){dy(n,i,m)},function(m){return $h(n,i,m)}):dy(n,i,d)}function dy(n,i,d){i.status="fulfilled",i.value=d,uy(i),n.state=d,i=n.pending,i!==null&&(d=i.next,d===i?n.pending=null:(d=d.next,i.next=d,ly(n,d)))}function $h(n,i,d){var m=n.pending;if(n.pending=null,m!==null){m=m.next;do i.status="rejected",i.reason=d,uy(i),i=i.next;while(i!==m)}n.action=null}function uy(n){n=n.listeners;for(var i=0;i<n.length;i++)(0,n[i])()}function my(n,i){return i}function hy(n,i){if(ct){var d=_t.formState;if(d!==null){e:{var m=Je;if(ct){if($t){t:{for(var x=$t,j=Aa;x.nodeType!==8;){if(!j){x=null;break t}if(x=xa(x.nextSibling),x===null){x=null;break t}}j=x.data,x=j==="F!"||j==="F"?x:null}if(x){$t=xa(x.nextSibling),m=x.data==="F!";break e}}Cn(m)}m=!1}m&&(i=d[0])}}return d=Ms(),d.memoizedState=d.baseState=i,m={pending:null,lanes:0,dispatch:null,lastRenderedReducer:my,lastRenderedState:i},d.queue=m,d=Ry.bind(null,Je,m),m.dispatch=d,m=zh(!1),j=Vh.bind(null,Je,!1,m.queue),m=Ms(),x={state:i,dispatch:null,action:n,pending:null},m.queue=x,d=SE.bind(null,Je,x,j,d),x.dispatch=d,m.memoizedState=n,[i,d,!1]}function fy(n){var i=Qt();return py(i,pt,n)}function py(n,i,d){if(i=Dh(n,i,my)[0],n=vd(nr)[0],typeof i=="object"&&i!==null&&typeof i.then=="function")try{var m=_l(i)}catch(O){throw O===xl?fd:O}else m=i;i=Qt();var x=i.queue,j=x.dispatch;return d!==i.memoizedState&&(Je.flags|=2048,Uo(9,wd(),EE.bind(null,x,d),null)),[m,j,n]}function EE(n,i){n.action=i}function gy(n){var i=Qt(),d=pt;if(d!==null)return py(i,d,n);Qt(),i=i.memoizedState,d=Qt();var m=d.queue.dispatch;return d.memoizedState=n,[i,m,!1]}function Uo(n,i,d,m){return n={tag:n,create:d,deps:m,inst:i,next:null},i=Je.updateQueue,i===null&&(i=Rh(),Je.updateQueue=i),d=i.lastEffect,d===null?i.lastEffect=n.next=n:(m=d.next,d.next=n,n.next=m,i.lastEffect=n),n}function wd(){return{destroy:void 0,resource:void 0}}function xy(){return Qt().memoizedState}function jd(n,i,d,m){var x=Ms();m=m===void 0?null:m,Je.flags|=n,x.memoizedState=Uo(1|i,wd(),d,m)}function Nl(n,i,d,m){var x=Qt();m=m===void 0?null:m;var j=x.memoizedState.inst;pt!==null&&m!==null&&Ch(m,pt.memoizedState.deps)?x.memoizedState=Uo(i,j,d,m):(Je.flags|=n,x.memoizedState=Uo(1|i,j,d,m))}function yy(n,i){jd(8390656,8,n,i)}function by(n,i){Nl(2048,8,n,i)}function vy(n,i){return Nl(4,2,n,i)}function wy(n,i){return Nl(4,4,n,i)}function jy(n,i){if(typeof i=="function"){n=n();var d=i(n);return function(){typeof d=="function"?d():i(null)}}if(i!=null)return n=n(),i.current=n,function(){i.current=null}}function _y(n,i,d){d=d!=null?d.concat([n]):null,Nl(4,4,jy.bind(null,i,n),d)}function Ih(){}function Ny(n,i){var d=Qt();i=i===void 0?null:i;var m=d.memoizedState;return i!==null&&Ch(i,m[1])?m[0]:(d.memoizedState=[n,i],n)}function Sy(n,i){var d=Qt();i=i===void 0?null:i;var m=d.memoizedState;if(i!==null&&Ch(i,m[1]))return m[0];if(m=n(),Mn){Ge(!0);try{n()}finally{Ge(!1)}}return d.memoizedState=[m,i],m}function Lh(n,i,d){return d===void 0||(Ur&1073741824)!==0?n.memoizedState=i:(n.memoizedState=d,n=Tb(),Je.lanes|=n,Zr|=n,d)}function Ey(n,i,d,m){return Us(d,i)?d:$o.current!==null?(n=Lh(n,d,m),Us(n,i)||(ds=!0),n):(Ur&42)===0?(ds=!0,n.memoizedState=d):(n=Tb(),Je.lanes|=n,Zr|=n,i)}function Cy(n,i,d,m,x){var j=Y.p;Y.p=j!==0&&8>j?j:8;var O=V.T,U={};V.T=U,Vh(n,!1,i,d);try{var K=x(),de=V.S;if(de!==null&&de(U,K),K!==null&&typeof K=="object"&&typeof K.then=="function"){var ve=jE(K,m);Sl(n,i,ve,Hs(n))}else Sl(n,i,m,Hs(n))}catch(Ee){Sl(n,i,{then:function(){},status:"rejected",reason:Ee},Hs())}finally{Y.p=j,V.T=O}}function CE(){}function Uh(n,i,d,m){if(n.tag!==5)throw Error(r(476));var x=Ty(n).queue;Cy(n,x,i,ee,d===null?CE:function(){return ky(n),d(m)})}function Ty(n){var i=n.memoizedState;if(i!==null)return i;i={memoizedState:ee,baseState:ee,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:nr,lastRenderedState:ee},next:null};var d={};return i.next={memoizedState:d,baseState:d,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:nr,lastRenderedState:d},next:null},n.memoizedState=i,n=n.alternate,n!==null&&(n.memoizedState=i),i}function ky(n){var i=Ty(n).next.queue;Sl(n,i,{},Hs())}function Bh(){return ws(ql)}function Ay(){return Qt().memoizedState}function My(){return Qt().memoizedState}function TE(n){for(var i=n.return;i!==null;){switch(i.tag){case 24:case 3:var d=Hs();n=Ir(d);var m=Lr(i,n,d);m!==null&&(Gs(m,i,d),bl(m,i,d)),i={cache:xh()},n.payload=i;return}i=i.return}}function kE(n,i,d){var m=Hs();d={lane:m,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null},_d(n)?Oy(i,d):(d=ih(n,i,d,m),d!==null&&(Gs(d,n,m),Dy(d,i,m)))}function Ry(n,i,d){var m=Hs();Sl(n,i,d,m)}function Sl(n,i,d,m){var x={lane:m,revertLane:0,action:d,hasEagerState:!1,eagerState:null,next:null};if(_d(n))Oy(i,x);else{var j=n.alternate;if(n.lanes===0&&(j===null||j.lanes===0)&&(j=i.lastRenderedReducer,j!==null))try{var O=i.lastRenderedState,U=j(O,d);if(x.hasEagerState=!0,x.eagerState=U,Us(U,O))return od(n,i,x,0),_t===null&&nd(),!1}catch{}finally{}if(d=ih(n,i,x,m),d!==null)return Gs(d,n,m),Dy(d,i,m),!0}return!1}function Vh(n,i,d,m){if(m={lane:2,revertLane:wf(),action:m,hasEagerState:!1,eagerState:null,next:null},_d(n)){if(i)throw Error(r(479))}else i=ih(n,d,m,2),i!==null&&Gs(i,n,2)}function _d(n){var i=n.alternate;return n===Je||i!==null&&i===Je}function Oy(n,i){Io=xd=!0;var d=n.pending;d===null?i.next=i:(i.next=d.next,d.next=i),n.pending=i}function Dy(n,i,d){if((d&4194048)!==0){var m=i.lanes;m&=n.pendingLanes,d|=m,i.lanes=d,Vg(n,d)}}var Nd={readContext:ws,use:bd,useCallback:Vt,useContext:Vt,useEffect:Vt,useImperativeHandle:Vt,useLayoutEffect:Vt,useInsertionEffect:Vt,useMemo:Vt,useReducer:Vt,useRef:Vt,useState:Vt,useDebugValue:Vt,useDeferredValue:Vt,useTransition:Vt,useSyncExternalStore:Vt,useId:Vt,useHostTransitionStatus:Vt,useFormState:Vt,useActionState:Vt,useOptimistic:Vt,useMemoCache:Vt,useCacheRefresh:Vt},Py={readContext:ws,use:bd,useCallback:function(n,i){return Ms().memoizedState=[n,i===void 0?null:i],n},useContext:ws,useEffect:yy,useImperativeHandle:function(n,i,d){d=d!=null?d.concat([n]):null,jd(4194308,4,jy.bind(null,i,n),d)},useLayoutEffect:function(n,i){return jd(4194308,4,n,i)},useInsertionEffect:function(n,i){jd(4,2,n,i)},useMemo:function(n,i){var d=Ms();i=i===void 0?null:i;var m=n();if(Mn){Ge(!0);try{n()}finally{Ge(!1)}}return d.memoizedState=[m,i],m},useReducer:function(n,i,d){var m=Ms();if(d!==void 0){var x=d(i);if(Mn){Ge(!0);try{d(i)}finally{Ge(!1)}}}else x=i;return m.memoizedState=m.baseState=x,n={pending:null,lanes:0,dispatch:null,lastRenderedReducer:n,lastRenderedState:x},m.queue=n,n=n.dispatch=kE.bind(null,Je,n),[m.memoizedState,n]},useRef:function(n){var i=Ms();return n={current:n},i.memoizedState=n},useState:function(n){n=zh(n);var i=n.queue,d=Ry.bind(null,Je,i);return i.dispatch=d,[n.memoizedState,d]},useDebugValue:Ih,useDeferredValue:function(n,i){var d=Ms();return Lh(d,n,i)},useTransition:function(){var n=zh(!1);return n=Cy.bind(null,Je,n.queue,!0,!1),Ms().memoizedState=n,[!1,n]},useSyncExternalStore:function(n,i,d){var m=Je,x=Ms();if(ct){if(d===void 0)throw Error(r(407));d=d()}else{if(d=i(),_t===null)throw Error(r(349));(ot&124)!==0||sy(m,i,d)}x.memoizedState=d;var j={value:d,getSnapshot:i};return x.queue=j,yy(ry.bind(null,m,j,n),[n]),m.flags|=2048,Uo(9,wd(),ay.bind(null,m,j,d,i),null),d},useId:function(){var n=Ms(),i=_t.identifierPrefix;if(ct){var d=sr,m=tr;d=(m&~(1<<32-Qe(m)-1)).toString(32)+d,i="«"+i+"R"+d,d=yd++,0<d&&(i+="H"+d.toString(32)),i+="»"}else d=_E++,i="«"+i+"r"+d.toString(32)+"»";return n.memoizedState=i},useHostTransitionStatus:Bh,useFormState:hy,useActionState:hy,useOptimistic:function(n){var i=Ms();i.memoizedState=i.baseState=n;var d={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return i.queue=d,i=Vh.bind(null,Je,!0,d),d.dispatch=i,[n,i]},useMemoCache:Oh,useCacheRefresh:function(){return Ms().memoizedState=TE.bind(null,Je)}},zy={readContext:ws,use:bd,useCallback:Ny,useContext:ws,useEffect:by,useImperativeHandle:_y,useInsertionEffect:vy,useLayoutEffect:wy,useMemo:Sy,useReducer:vd,useRef:xy,useState:function(){return vd(nr)},useDebugValue:Ih,useDeferredValue:function(n,i){var d=Qt();return Ey(d,pt.memoizedState,n,i)},useTransition:function(){var n=vd(nr)[0],i=Qt().memoizedState;return[typeof n=="boolean"?n:_l(n),i]},useSyncExternalStore:ty,useId:Ay,useHostTransitionStatus:Bh,useFormState:fy,useActionState:fy,useOptimistic:function(n,i){var d=Qt();return iy(d,pt,n,i)},useMemoCache:Oh,useCacheRefresh:My},AE={readContext:ws,use:bd,useCallback:Ny,useContext:ws,useEffect:by,useImperativeHandle:_y,useInsertionEffect:vy,useLayoutEffect:wy,useMemo:Sy,useReducer:Ph,useRef:xy,useState:function(){return Ph(nr)},useDebugValue:Ih,useDeferredValue:function(n,i){var d=Qt();return pt===null?Lh(d,n,i):Ey(d,pt.memoizedState,n,i)},useTransition:function(){var n=Ph(nr)[0],i=Qt().memoizedState;return[typeof n=="boolean"?n:_l(n),i]},useSyncExternalStore:ty,useId:Ay,useHostTransitionStatus:Bh,useFormState:gy,useActionState:gy,useOptimistic:function(n,i){var d=Qt();return pt!==null?iy(d,pt,n,i):(d.baseState=n,[n,d.queue.dispatch])},useMemoCache:Oh,useCacheRefresh:My},Bo=null,El=0;function Sd(n){var i=El;return El+=1,Bo===null&&(Bo=[]),Zx(Bo,n,i)}function Cl(n,i){i=i.props.ref,n.ref=i!==void 0?i:null}function Ed(n,i){throw i.$$typeof===g?Error(r(525)):(n=Object.prototype.toString.call(i),Error(r(31,n==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":n)))}function $y(n){var i=n._init;return i(n._payload)}function Iy(n){function i(ne,te){if(n){var ie=ne.deletions;ie===null?(ne.deletions=[te],ne.flags|=16):ie.push(te)}}function d(ne,te){if(!n)return null;for(;te!==null;)i(ne,te),te=te.sibling;return null}function m(ne){for(var te=new Map;ne!==null;)ne.key!==null?te.set(ne.key,ne):te.set(ne.index,ne),ne=ne.sibling;return te}function x(ne,te){return ne=er(ne,te),ne.index=0,ne.sibling=null,ne}function j(ne,te,ie){return ne.index=ie,n?(ie=ne.alternate,ie!==null?(ie=ie.index,ie<te?(ne.flags|=67108866,te):ie):(ne.flags|=67108866,te)):(ne.flags|=1048576,te)}function O(ne){return n&&ne.alternate===null&&(ne.flags|=67108866),ne}function U(ne,te,ie,_e){return te===null||te.tag!==6?(te=ch(ie,ne.mode,_e),te.return=ne,te):(te=x(te,ie),te.return=ne,te)}function K(ne,te,ie,_e){var Le=ie.type;return Le===_?ve(ne,te,ie.props.children,_e,ie.key):te!==null&&(te.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===A&&$y(Le)===te.type)?(te=x(te,ie.props),Cl(te,ie),te.return=ne,te):(te=ld(ie.type,ie.key,ie.props,null,ne.mode,_e),Cl(te,ie),te.return=ne,te)}function de(ne,te,ie,_e){return te===null||te.tag!==4||te.stateNode.containerInfo!==ie.containerInfo||te.stateNode.implementation!==ie.implementation?(te=dh(ie,ne.mode,_e),te.return=ne,te):(te=x(te,ie.children||[]),te.return=ne,te)}function ve(ne,te,ie,_e,Le){return te===null||te.tag!==7?(te=_n(ie,ne.mode,_e,Le),te.return=ne,te):(te=x(te,ie),te.return=ne,te)}function Ee(ne,te,ie){if(typeof te=="string"&&te!==""||typeof te=="number"||typeof te=="bigint")return te=ch(""+te,ne.mode,ie),te.return=ne,te;if(typeof te=="object"&&te!==null){switch(te.$$typeof){case v:return ie=ld(te.type,te.key,te.props,null,ne.mode,ie),Cl(ie,te),ie.return=ne,ie;case b:return te=dh(te,ne.mode,ie),te.return=ne,te;case A:var _e=te._init;return te=_e(te._payload),Ee(ne,te,ie)}if(J(te)||I(te))return te=_n(te,ne.mode,ie,null),te.return=ne,te;if(typeof te.then=="function")return Ee(ne,Sd(te),ie);if(te.$$typeof===C)return Ee(ne,md(ne,te),ie);Ed(ne,te)}return null}function fe(ne,te,ie,_e){var Le=te!==null?te.key:null;if(typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint")return Le!==null?null:U(ne,te,""+ie,_e);if(typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case v:return ie.key===Le?K(ne,te,ie,_e):null;case b:return ie.key===Le?de(ne,te,ie,_e):null;case A:return Le=ie._init,ie=Le(ie._payload),fe(ne,te,ie,_e)}if(J(ie)||I(ie))return Le!==null?null:ve(ne,te,ie,_e,null);if(typeof ie.then=="function")return fe(ne,te,Sd(ie),_e);if(ie.$$typeof===C)return fe(ne,te,md(ne,ie),_e);Ed(ne,ie)}return null}function ge(ne,te,ie,_e,Le){if(typeof _e=="string"&&_e!==""||typeof _e=="number"||typeof _e=="bigint")return ne=ne.get(ie)||null,U(te,ne,""+_e,Le);if(typeof _e=="object"&&_e!==null){switch(_e.$$typeof){case v:return ne=ne.get(_e.key===null?ie:_e.key)||null,K(te,ne,_e,Le);case b:return ne=ne.get(_e.key===null?ie:_e.key)||null,de(te,ne,_e,Le);case A:var et=_e._init;return _e=et(_e._payload),ge(ne,te,ie,_e,Le)}if(J(_e)||I(_e))return ne=ne.get(ie)||null,ve(te,ne,_e,Le,null);if(typeof _e.then=="function")return ge(ne,te,ie,Sd(_e),Le);if(_e.$$typeof===C)return ge(ne,te,ie,md(te,_e),Le);Ed(te,_e)}return null}function Ze(ne,te,ie,_e){for(var Le=null,et=null,Be=te,He=te=0,ms=null;Be!==null&&He<ie.length;He++){Be.index>He?(ms=Be,Be=null):ms=Be.sibling;var lt=fe(ne,Be,ie[He],_e);if(lt===null){Be===null&&(Be=ms);break}n&&Be&&lt.alternate===null&&i(ne,Be),te=j(lt,te,He),et===null?Le=lt:et.sibling=lt,et=lt,Be=ms}if(He===ie.length)return d(ne,Be),ct&&Sn(ne,He),Le;if(Be===null){for(;He<ie.length;He++)Be=Ee(ne,ie[He],_e),Be!==null&&(te=j(Be,te,He),et===null?Le=Be:et.sibling=Be,et=Be);return ct&&Sn(ne,He),Le}for(Be=m(Be);He<ie.length;He++)ms=ge(Be,ne,He,ie[He],_e),ms!==null&&(n&&ms.alternate!==null&&Be.delete(ms.key===null?He:ms.key),te=j(ms,te,He),et===null?Le=ms:et.sibling=ms,et=ms);return n&&Be.forEach(function(sn){return i(ne,sn)}),ct&&Sn(ne,He),Le}function Fe(ne,te,ie,_e){if(ie==null)throw Error(r(151));for(var Le=null,et=null,Be=te,He=te=0,ms=null,lt=ie.next();Be!==null&&!lt.done;He++,lt=ie.next()){Be.index>He?(ms=Be,Be=null):ms=Be.sibling;var sn=fe(ne,Be,lt.value,_e);if(sn===null){Be===null&&(Be=ms);break}n&&Be&&sn.alternate===null&&i(ne,Be),te=j(sn,te,He),et===null?Le=sn:et.sibling=sn,et=sn,Be=ms}if(lt.done)return d(ne,Be),ct&&Sn(ne,He),Le;if(Be===null){for(;!lt.done;He++,lt=ie.next())lt=Ee(ne,lt.value,_e),lt!==null&&(te=j(lt,te,He),et===null?Le=lt:et.sibling=lt,et=lt);return ct&&Sn(ne,He),Le}for(Be=m(Be);!lt.done;He++,lt=ie.next())lt=ge(Be,ne,He,lt.value,_e),lt!==null&&(n&&lt.alternate!==null&&Be.delete(lt.key===null?He:lt.key),te=j(lt,te,He),et===null?Le=lt:et.sibling=lt,et=lt);return n&&Be.forEach(function(MC){return i(ne,MC)}),ct&&Sn(ne,He),Le}function xt(ne,te,ie,_e){if(typeof ie=="object"&&ie!==null&&ie.type===_&&ie.key===null&&(ie=ie.props.children),typeof ie=="object"&&ie!==null){switch(ie.$$typeof){case v:e:{for(var Le=ie.key;te!==null;){if(te.key===Le){if(Le=ie.type,Le===_){if(te.tag===7){d(ne,te.sibling),_e=x(te,ie.props.children),_e.return=ne,ne=_e;break e}}else if(te.elementType===Le||typeof Le=="object"&&Le!==null&&Le.$$typeof===A&&$y(Le)===te.type){d(ne,te.sibling),_e=x(te,ie.props),Cl(_e,ie),_e.return=ne,ne=_e;break e}d(ne,te);break}else i(ne,te);te=te.sibling}ie.type===_?(_e=_n(ie.props.children,ne.mode,_e,ie.key),_e.return=ne,ne=_e):(_e=ld(ie.type,ie.key,ie.props,null,ne.mode,_e),Cl(_e,ie),_e.return=ne,ne=_e)}return O(ne);case b:e:{for(Le=ie.key;te!==null;){if(te.key===Le)if(te.tag===4&&te.stateNode.containerInfo===ie.containerInfo&&te.stateNode.implementation===ie.implementation){d(ne,te.sibling),_e=x(te,ie.children||[]),_e.return=ne,ne=_e;break e}else{d(ne,te);break}else i(ne,te);te=te.sibling}_e=dh(ie,ne.mode,_e),_e.return=ne,ne=_e}return O(ne);case A:return Le=ie._init,ie=Le(ie._payload),xt(ne,te,ie,_e)}if(J(ie))return Ze(ne,te,ie,_e);if(I(ie)){if(Le=I(ie),typeof Le!="function")throw Error(r(150));return ie=Le.call(ie),Fe(ne,te,ie,_e)}if(typeof ie.then=="function")return xt(ne,te,Sd(ie),_e);if(ie.$$typeof===C)return xt(ne,te,md(ne,ie),_e);Ed(ne,ie)}return typeof ie=="string"&&ie!==""||typeof ie=="number"||typeof ie=="bigint"?(ie=""+ie,te!==null&&te.tag===6?(d(ne,te.sibling),_e=x(te,ie),_e.return=ne,ne=_e):(d(ne,te),_e=ch(ie,ne.mode,_e),_e.return=ne,ne=_e),O(ne)):d(ne,te)}return function(ne,te,ie,_e){try{El=0;var Le=xt(ne,te,ie,_e);return Bo=null,Le}catch(Be){if(Be===xl||Be===fd)throw Be;var et=Bs(29,Be,null,ne.mode);return et.lanes=_e,et.return=ne,et}finally{}}}var Vo=Iy(!0),Ly=Iy(!1),ra=H(null),Ma=null;function Br(n){var i=n.alternate;Z(rs,rs.current&1),Z(ra,n),Ma===null&&(i===null||$o.current!==null||i.memoizedState!==null)&&(Ma=n)}function Uy(n){if(n.tag===22){if(Z(rs,rs.current),Z(ra,n),Ma===null){var i=n.alternate;i!==null&&i.memoizedState!==null&&(Ma=n)}}else Vr()}function Vr(){Z(rs,rs.current),Z(ra,ra.current)}function or(n){F(ra),Ma===n&&(Ma=null),F(rs)}var rs=H(0);function Cd(n){for(var i=n;i!==null;){if(i.tag===13){var d=i.memoizedState;if(d!==null&&(d=d.dehydrated,d===null||d.data==="$?"||Of(d)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if((i.flags&128)!==0)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}function qh(n,i,d,m){i=n.memoizedState,d=d(m,i),d=d==null?i:p({},i,d),n.memoizedState=d,n.lanes===0&&(n.updateQueue.baseState=d)}var Fh={enqueueSetState:function(n,i,d){n=n._reactInternals;var m=Hs(),x=Ir(m);x.payload=i,d!=null&&(x.callback=d),i=Lr(n,x,m),i!==null&&(Gs(i,n,m),bl(i,n,m))},enqueueReplaceState:function(n,i,d){n=n._reactInternals;var m=Hs(),x=Ir(m);x.tag=1,x.payload=i,d!=null&&(x.callback=d),i=Lr(n,x,m),i!==null&&(Gs(i,n,m),bl(i,n,m))},enqueueForceUpdate:function(n,i){n=n._reactInternals;var d=Hs(),m=Ir(d);m.tag=2,i!=null&&(m.callback=i),i=Lr(n,m,d),i!==null&&(Gs(i,n,d),bl(i,n,d))}};function By(n,i,d,m,x,j,O){return n=n.stateNode,typeof n.shouldComponentUpdate=="function"?n.shouldComponentUpdate(m,j,O):i.prototype&&i.prototype.isPureReactComponent?!cl(d,m)||!cl(x,j):!0}function Vy(n,i,d,m){n=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(d,m),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(d,m),i.state!==n&&Fh.enqueueReplaceState(i,i.state,null)}function Rn(n,i){var d=i;if("ref"in i){d={};for(var m in i)m!=="ref"&&(d[m]=i[m])}if(n=n.defaultProps){d===i&&(d=p({},d));for(var x in n)d[x]===void 0&&(d[x]=n[x])}return d}var Td=typeof reportError=="function"?reportError:function(n){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var i=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof n=="object"&&n!==null&&typeof n.message=="string"?String(n.message):String(n),error:n});if(!window.dispatchEvent(i))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",n);return}console.error(n)};function qy(n){Td(n)}function Fy(n){console.error(n)}function Hy(n){Td(n)}function kd(n,i){try{var d=n.onUncaughtError;d(i.value,{componentStack:i.stack})}catch(m){setTimeout(function(){throw m})}}function Gy(n,i,d){try{var m=n.onCaughtError;m(d.value,{componentStack:d.stack,errorBoundary:i.tag===1?i.stateNode:null})}catch(x){setTimeout(function(){throw x})}}function Hh(n,i,d){return d=Ir(d),d.tag=3,d.payload={element:null},d.callback=function(){kd(n,i)},d}function Zy(n){return n=Ir(n),n.tag=3,n}function Wy(n,i,d,m){var x=d.type.getDerivedStateFromError;if(typeof x=="function"){var j=m.value;n.payload=function(){return x(j)},n.callback=function(){Gy(i,d,m)}}var O=d.stateNode;O!==null&&typeof O.componentDidCatch=="function"&&(n.callback=function(){Gy(i,d,m),typeof x!="function"&&(Wr===null?Wr=new Set([this]):Wr.add(this));var U=m.stack;this.componentDidCatch(m.value,{componentStack:U!==null?U:""})})}function ME(n,i,d,m,x){if(d.flags|=32768,m!==null&&typeof m=="object"&&typeof m.then=="function"){if(i=d.alternate,i!==null&&fl(i,d,x,!0),d=ra.current,d!==null){switch(d.tag){case 13:return Ma===null?gf():d.alternate===null&&It===0&&(It=3),d.flags&=-257,d.flags|=65536,d.lanes=x,m===vh?d.flags|=16384:(i=d.updateQueue,i===null?d.updateQueue=new Set([m]):i.add(m),yf(n,m,x)),!1;case 22:return d.flags|=65536,m===vh?d.flags|=16384:(i=d.updateQueue,i===null?(i={transitions:null,markerInstances:null,retryQueue:new Set([m])},d.updateQueue=i):(d=i.retryQueue,d===null?i.retryQueue=new Set([m]):d.add(m)),yf(n,m,x)),!1}throw Error(r(435,d.tag))}return yf(n,m,x),gf(),!1}if(ct)return i=ra.current,i!==null?((i.flags&65536)===0&&(i.flags|=256),i.flags|=65536,i.lanes=x,m!==hh&&(n=Error(r(422),{cause:m}),hl(ea(n,d)))):(m!==hh&&(i=Error(r(423),{cause:m}),hl(ea(i,d))),n=n.current.alternate,n.flags|=65536,x&=-x,n.lanes|=x,m=ea(m,d),x=Hh(n.stateNode,m,x),_h(n,x),It!==4&&(It=2)),!1;var j=Error(r(520),{cause:m});if(j=ea(j,d),Dl===null?Dl=[j]:Dl.push(j),It!==4&&(It=2),i===null)return!0;m=ea(m,d),d=i;do{switch(d.tag){case 3:return d.flags|=65536,n=x&-x,d.lanes|=n,n=Hh(d.stateNode,m,n),_h(d,n),!1;case 1:if(i=d.type,j=d.stateNode,(d.flags&128)===0&&(typeof i.getDerivedStateFromError=="function"||j!==null&&typeof j.componentDidCatch=="function"&&(Wr===null||!Wr.has(j))))return d.flags|=65536,x&=-x,d.lanes|=x,x=Zy(x),Wy(x,n,d,m),_h(d,x),!1}d=d.return}while(d!==null);return!1}var Yy=Error(r(461)),ds=!1;function ps(n,i,d,m){i.child=n===null?Ly(i,null,d,m):Vo(i,n.child,d,m)}function Ky(n,i,d,m,x){d=d.render;var j=i.ref;if("ref"in m){var O={};for(var U in m)U!=="ref"&&(O[U]=m[U])}else O=m;return kn(i),m=Th(n,i,d,O,j,x),U=kh(),n!==null&&!ds?(Ah(n,i,x),ir(n,i,x)):(ct&&U&&uh(i),i.flags|=1,ps(n,i,m,x),i.child)}function Xy(n,i,d,m,x){if(n===null){var j=d.type;return typeof j=="function"&&!lh(j)&&j.defaultProps===void 0&&d.compare===null?(i.tag=15,i.type=j,Qy(n,i,j,m,x)):(n=ld(d.type,null,m,i,i.mode,x),n.ref=i.ref,n.return=i,i.child=n)}if(j=n.child,!Jh(n,x)){var O=j.memoizedProps;if(d=d.compare,d=d!==null?d:cl,d(O,m)&&n.ref===i.ref)return ir(n,i,x)}return i.flags|=1,n=er(j,m),n.ref=i.ref,n.return=i,i.child=n}function Qy(n,i,d,m,x){if(n!==null){var j=n.memoizedProps;if(cl(j,m)&&n.ref===i.ref)if(ds=!1,i.pendingProps=m=j,Jh(n,x))(n.flags&131072)!==0&&(ds=!0);else return i.lanes=n.lanes,ir(n,i,x)}return Gh(n,i,d,m,x)}function Jy(n,i,d){var m=i.pendingProps,x=m.children,j=n!==null?n.memoizedState:null;if(m.mode==="hidden"){if((i.flags&128)!==0){if(m=j!==null?j.baseLanes|d:d,n!==null){for(x=i.child=n.child,j=0;x!==null;)j=j|x.lanes|x.childLanes,x=x.sibling;i.childLanes=j&~m}else i.childLanes=0,i.child=null;return eb(n,i,m,d)}if((d&536870912)!==0)i.memoizedState={baseLanes:0,cachePool:null},n!==null&&hd(i,j!==null?j.cachePool:null),j!==null?Qx(i,j):Sh(),Uy(i);else return i.lanes=i.childLanes=536870912,eb(n,i,j!==null?j.baseLanes|d:d,d)}else j!==null?(hd(i,j.cachePool),Qx(i,j),Vr(),i.memoizedState=null):(n!==null&&hd(i,null),Sh(),Vr());return ps(n,i,x,d),i.child}function eb(n,i,d,m){var x=bh();return x=x===null?null:{parent:as._currentValue,pool:x},i.memoizedState={baseLanes:d,cachePool:x},n!==null&&hd(i,null),Sh(),Uy(i),n!==null&&fl(n,i,m,!0),null}function Ad(n,i){var d=i.ref;if(d===null)n!==null&&n.ref!==null&&(i.flags|=4194816);else{if(typeof d!="function"&&typeof d!="object")throw Error(r(284));(n===null||n.ref!==d)&&(i.flags|=4194816)}}function Gh(n,i,d,m,x){return kn(i),d=Th(n,i,d,m,void 0,x),m=kh(),n!==null&&!ds?(Ah(n,i,x),ir(n,i,x)):(ct&&m&&uh(i),i.flags|=1,ps(n,i,d,x),i.child)}function tb(n,i,d,m,x,j){return kn(i),i.updateQueue=null,d=ey(i,m,d,x),Jx(n),m=kh(),n!==null&&!ds?(Ah(n,i,j),ir(n,i,j)):(ct&&m&&uh(i),i.flags|=1,ps(n,i,d,j),i.child)}function sb(n,i,d,m,x){if(kn(i),i.stateNode===null){var j=Ro,O=d.contextType;typeof O=="object"&&O!==null&&(j=ws(O)),j=new d(m,j),i.memoizedState=j.state!==null&&j.state!==void 0?j.state:null,j.updater=Fh,i.stateNode=j,j._reactInternals=i,j=i.stateNode,j.props=m,j.state=i.memoizedState,j.refs={},wh(i),O=d.contextType,j.context=typeof O=="object"&&O!==null?ws(O):Ro,j.state=i.memoizedState,O=d.getDerivedStateFromProps,typeof O=="function"&&(qh(i,d,O,m),j.state=i.memoizedState),typeof d.getDerivedStateFromProps=="function"||typeof j.getSnapshotBeforeUpdate=="function"||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(O=j.state,typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount(),O!==j.state&&Fh.enqueueReplaceState(j,j.state,null),wl(i,m,j,x),vl(),j.state=i.memoizedState),typeof j.componentDidMount=="function"&&(i.flags|=4194308),m=!0}else if(n===null){j=i.stateNode;var U=i.memoizedProps,K=Rn(d,U);j.props=K;var de=j.context,ve=d.contextType;O=Ro,typeof ve=="object"&&ve!==null&&(O=ws(ve));var Ee=d.getDerivedStateFromProps;ve=typeof Ee=="function"||typeof j.getSnapshotBeforeUpdate=="function",U=i.pendingProps!==U,ve||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(U||de!==O)&&Vy(i,j,m,O),$r=!1;var fe=i.memoizedState;j.state=fe,wl(i,m,j,x),vl(),de=i.memoizedState,U||fe!==de||$r?(typeof Ee=="function"&&(qh(i,d,Ee,m),de=i.memoizedState),(K=$r||By(i,d,K,m,fe,de,O))?(ve||typeof j.UNSAFE_componentWillMount!="function"&&typeof j.componentWillMount!="function"||(typeof j.componentWillMount=="function"&&j.componentWillMount(),typeof j.UNSAFE_componentWillMount=="function"&&j.UNSAFE_componentWillMount()),typeof j.componentDidMount=="function"&&(i.flags|=4194308)):(typeof j.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=m,i.memoizedState=de),j.props=m,j.state=de,j.context=O,m=K):(typeof j.componentDidMount=="function"&&(i.flags|=4194308),m=!1)}else{j=i.stateNode,jh(n,i),O=i.memoizedProps,ve=Rn(d,O),j.props=ve,Ee=i.pendingProps,fe=j.context,de=d.contextType,K=Ro,typeof de=="object"&&de!==null&&(K=ws(de)),U=d.getDerivedStateFromProps,(de=typeof U=="function"||typeof j.getSnapshotBeforeUpdate=="function")||typeof j.UNSAFE_componentWillReceiveProps!="function"&&typeof j.componentWillReceiveProps!="function"||(O!==Ee||fe!==K)&&Vy(i,j,m,K),$r=!1,fe=i.memoizedState,j.state=fe,wl(i,m,j,x),vl();var ge=i.memoizedState;O!==Ee||fe!==ge||$r||n!==null&&n.dependencies!==null&&ud(n.dependencies)?(typeof U=="function"&&(qh(i,d,U,m),ge=i.memoizedState),(ve=$r||By(i,d,ve,m,fe,ge,K)||n!==null&&n.dependencies!==null&&ud(n.dependencies))?(de||typeof j.UNSAFE_componentWillUpdate!="function"&&typeof j.componentWillUpdate!="function"||(typeof j.componentWillUpdate=="function"&&j.componentWillUpdate(m,ge,K),typeof j.UNSAFE_componentWillUpdate=="function"&&j.UNSAFE_componentWillUpdate(m,ge,K)),typeof j.componentDidUpdate=="function"&&(i.flags|=4),typeof j.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof j.componentDidUpdate!="function"||O===n.memoizedProps&&fe===n.memoizedState||(i.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||O===n.memoizedProps&&fe===n.memoizedState||(i.flags|=1024),i.memoizedProps=m,i.memoizedState=ge),j.props=m,j.state=ge,j.context=K,m=ve):(typeof j.componentDidUpdate!="function"||O===n.memoizedProps&&fe===n.memoizedState||(i.flags|=4),typeof j.getSnapshotBeforeUpdate!="function"||O===n.memoizedProps&&fe===n.memoizedState||(i.flags|=1024),m=!1)}return j=m,Ad(n,i),m=(i.flags&128)!==0,j||m?(j=i.stateNode,d=m&&typeof d.getDerivedStateFromError!="function"?null:j.render(),i.flags|=1,n!==null&&m?(i.child=Vo(i,n.child,null,x),i.child=Vo(i,null,d,x)):ps(n,i,d,x),i.memoizedState=j.state,n=i.child):n=ir(n,i,x),n}function ab(n,i,d,m){return ml(),i.flags|=256,ps(n,i,d,m),i.child}var Zh={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function Wh(n){return{baseLanes:n,cachePool:Fx()}}function Yh(n,i,d){return n=n!==null?n.childLanes&~d:0,i&&(n|=na),n}function rb(n,i,d){var m=i.pendingProps,x=!1,j=(i.flags&128)!==0,O;if((O=j)||(O=n!==null&&n.memoizedState===null?!1:(rs.current&2)!==0),O&&(x=!0,i.flags&=-129),O=(i.flags&32)!==0,i.flags&=-33,n===null){if(ct){if(x?Br(i):Vr(),ct){var U=$t,K;if(K=U){e:{for(K=U,U=Aa;K.nodeType!==8;){if(!U){U=null;break e}if(K=xa(K.nextSibling),K===null){U=null;break e}}U=K}U!==null?(i.memoizedState={dehydrated:U,treeContext:Nn!==null?{id:tr,overflow:sr}:null,retryLane:536870912,hydrationErrors:null},K=Bs(18,null,null,0),K.stateNode=U,K.return=i,i.child=K,Ss=i,$t=null,K=!0):K=!1}K||Cn(i)}if(U=i.memoizedState,U!==null&&(U=U.dehydrated,U!==null))return Of(U)?i.lanes=32:i.lanes=536870912,null;or(i)}return U=m.children,m=m.fallback,x?(Vr(),x=i.mode,U=Md({mode:"hidden",children:U},x),m=_n(m,x,d,null),U.return=i,m.return=i,U.sibling=m,i.child=U,x=i.child,x.memoizedState=Wh(d),x.childLanes=Yh(n,O,d),i.memoizedState=Zh,m):(Br(i),Kh(i,U))}if(K=n.memoizedState,K!==null&&(U=K.dehydrated,U!==null)){if(j)i.flags&256?(Br(i),i.flags&=-257,i=Xh(n,i,d)):i.memoizedState!==null?(Vr(),i.child=n.child,i.flags|=128,i=null):(Vr(),x=m.fallback,U=i.mode,m=Md({mode:"visible",children:m.children},U),x=_n(x,U,d,null),x.flags|=2,m.return=i,x.return=i,m.sibling=x,i.child=m,Vo(i,n.child,null,d),m=i.child,m.memoizedState=Wh(d),m.childLanes=Yh(n,O,d),i.memoizedState=Zh,i=x);else if(Br(i),Of(U)){if(O=U.nextSibling&&U.nextSibling.dataset,O)var de=O.dgst;O=de,m=Error(r(419)),m.stack="",m.digest=O,hl({value:m,source:null,stack:null}),i=Xh(n,i,d)}else if(ds||fl(n,i,d,!1),O=(d&n.childLanes)!==0,ds||O){if(O=_t,O!==null&&(m=d&-d,m=(m&42)!==0?1:Om(m),m=(m&(O.suspendedLanes|d))!==0?0:m,m!==0&&m!==K.retryLane))throw K.retryLane=m,Mo(n,m),Gs(O,n,m),Yy;U.data==="$?"||gf(),i=Xh(n,i,d)}else U.data==="$?"?(i.flags|=192,i.child=n.child,i=null):(n=K.treeContext,$t=xa(U.nextSibling),Ss=i,ct=!0,En=null,Aa=!1,n!==null&&(sa[aa++]=tr,sa[aa++]=sr,sa[aa++]=Nn,tr=n.id,sr=n.overflow,Nn=i),i=Kh(i,m.children),i.flags|=4096);return i}return x?(Vr(),x=m.fallback,U=i.mode,K=n.child,de=K.sibling,m=er(K,{mode:"hidden",children:m.children}),m.subtreeFlags=K.subtreeFlags&65011712,de!==null?x=er(de,x):(x=_n(x,U,d,null),x.flags|=2),x.return=i,m.return=i,m.sibling=x,i.child=m,m=x,x=i.child,U=n.child.memoizedState,U===null?U=Wh(d):(K=U.cachePool,K!==null?(de=as._currentValue,K=K.parent!==de?{parent:de,pool:de}:K):K=Fx(),U={baseLanes:U.baseLanes|d,cachePool:K}),x.memoizedState=U,x.childLanes=Yh(n,O,d),i.memoizedState=Zh,m):(Br(i),d=n.child,n=d.sibling,d=er(d,{mode:"visible",children:m.children}),d.return=i,d.sibling=null,n!==null&&(O=i.deletions,O===null?(i.deletions=[n],i.flags|=16):O.push(n)),i.child=d,i.memoizedState=null,d)}function Kh(n,i){return i=Md({mode:"visible",children:i},n.mode),i.return=n,n.child=i}function Md(n,i){return n=Bs(22,n,null,i),n.lanes=0,n.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},n}function Xh(n,i,d){return Vo(i,n.child,null,d),n=Kh(i,i.pendingProps.children),n.flags|=2,i.memoizedState=null,n}function nb(n,i,d){n.lanes|=i;var m=n.alternate;m!==null&&(m.lanes|=i),ph(n.return,i,d)}function Qh(n,i,d,m,x){var j=n.memoizedState;j===null?n.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:m,tail:d,tailMode:x}:(j.isBackwards=i,j.rendering=null,j.renderingStartTime=0,j.last=m,j.tail=d,j.tailMode=x)}function ob(n,i,d){var m=i.pendingProps,x=m.revealOrder,j=m.tail;if(ps(n,i,m.children,d),m=rs.current,(m&2)!==0)m=m&1|2,i.flags|=128;else{if(n!==null&&(n.flags&128)!==0)e:for(n=i.child;n!==null;){if(n.tag===13)n.memoizedState!==null&&nb(n,d,i);else if(n.tag===19)nb(n,d,i);else if(n.child!==null){n.child.return=n,n=n.child;continue}if(n===i)break e;for(;n.sibling===null;){if(n.return===null||n.return===i)break e;n=n.return}n.sibling.return=n.return,n=n.sibling}m&=1}switch(Z(rs,m),x){case"forwards":for(d=i.child,x=null;d!==null;)n=d.alternate,n!==null&&Cd(n)===null&&(x=d),d=d.sibling;d=x,d===null?(x=i.child,i.child=null):(x=d.sibling,d.sibling=null),Qh(i,!1,x,d,j);break;case"backwards":for(d=null,x=i.child,i.child=null;x!==null;){if(n=x.alternate,n!==null&&Cd(n)===null){i.child=x;break}n=x.sibling,x.sibling=d,d=x,x=n}Qh(i,!0,d,null,j);break;case"together":Qh(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function ir(n,i,d){if(n!==null&&(i.dependencies=n.dependencies),Zr|=i.lanes,(d&i.childLanes)===0)if(n!==null){if(fl(n,i,d,!1),(d&i.childLanes)===0)return null}else return null;if(n!==null&&i.child!==n.child)throw Error(r(153));if(i.child!==null){for(n=i.child,d=er(n,n.pendingProps),i.child=d,d.return=i;n.sibling!==null;)n=n.sibling,d=d.sibling=er(n,n.pendingProps),d.return=i;d.sibling=null}return i.child}function Jh(n,i){return(n.lanes&i)!==0?!0:(n=n.dependencies,!!(n!==null&&ud(n)))}function RE(n,i,d){switch(i.tag){case 3:P(i,i.stateNode.containerInfo),zr(i,as,n.memoizedState.cache),ml();break;case 27:case 5:Q(i);break;case 4:P(i,i.stateNode.containerInfo);break;case 10:zr(i,i.type,i.memoizedProps.value);break;case 13:var m=i.memoizedState;if(m!==null)return m.dehydrated!==null?(Br(i),i.flags|=128,null):(d&i.child.childLanes)!==0?rb(n,i,d):(Br(i),n=ir(n,i,d),n!==null?n.sibling:null);Br(i);break;case 19:var x=(n.flags&128)!==0;if(m=(d&i.childLanes)!==0,m||(fl(n,i,d,!1),m=(d&i.childLanes)!==0),x){if(m)return ob(n,i,d);i.flags|=128}if(x=i.memoizedState,x!==null&&(x.rendering=null,x.tail=null,x.lastEffect=null),Z(rs,rs.current),m)break;return null;case 22:case 23:return i.lanes=0,Jy(n,i,d);case 24:zr(i,as,n.memoizedState.cache)}return ir(n,i,d)}function ib(n,i,d){if(n!==null)if(n.memoizedProps!==i.pendingProps)ds=!0;else{if(!Jh(n,d)&&(i.flags&128)===0)return ds=!1,RE(n,i,d);ds=(n.flags&131072)!==0}else ds=!1,ct&&(i.flags&1048576)!==0&&$x(i,dd,i.index);switch(i.lanes=0,i.tag){case 16:e:{n=i.pendingProps;var m=i.elementType,x=m._init;if(m=x(m._payload),i.type=m,typeof m=="function")lh(m)?(n=Rn(m,n),i.tag=1,i=sb(null,i,m,n,d)):(i.tag=0,i=Gh(null,i,m,n,d));else{if(m!=null){if(x=m.$$typeof,x===S){i.tag=11,i=Ky(null,i,m,n,d);break e}else if(x===$){i.tag=14,i=Xy(null,i,m,n,d);break e}}throw i=ce(m)||m,Error(r(306,i,""))}}return i;case 0:return Gh(n,i,i.type,i.pendingProps,d);case 1:return m=i.type,x=Rn(m,i.pendingProps),sb(n,i,m,x,d);case 3:e:{if(P(i,i.stateNode.containerInfo),n===null)throw Error(r(387));m=i.pendingProps;var j=i.memoizedState;x=j.element,jh(n,i),wl(i,m,null,d);var O=i.memoizedState;if(m=O.cache,zr(i,as,m),m!==j.cache&&gh(i,[as],d,!0),vl(),m=O.element,j.isDehydrated)if(j={element:m,isDehydrated:!1,cache:O.cache},i.updateQueue.baseState=j,i.memoizedState=j,i.flags&256){i=ab(n,i,m,d);break e}else if(m!==x){x=ea(Error(r(424)),i),hl(x),i=ab(n,i,m,d);break e}else{switch(n=i.stateNode.containerInfo,n.nodeType){case 9:n=n.body;break;default:n=n.nodeName==="HTML"?n.ownerDocument.body:n}for($t=xa(n.firstChild),Ss=i,ct=!0,En=null,Aa=!0,d=Ly(i,null,m,d),i.child=d;d;)d.flags=d.flags&-3|4096,d=d.sibling}else{if(ml(),m===x){i=ir(n,i,d);break e}ps(n,i,m,d)}i=i.child}return i;case 26:return Ad(n,i),n===null?(d=uv(i.type,null,i.pendingProps,null))?i.memoizedState=d:ct||(d=i.type,n=i.pendingProps,m=Hd(ae.current).createElement(d),m[vs]=i,m[ks]=n,xs(m,d,n),cs(m),i.stateNode=m):i.memoizedState=uv(i.type,n.memoizedProps,i.pendingProps,n.memoizedState),null;case 27:return Q(i),n===null&&ct&&(m=i.stateNode=lv(i.type,i.pendingProps,ae.current),Ss=i,Aa=!0,x=$t,Xr(i.type)?(Df=x,$t=xa(m.firstChild)):$t=x),ps(n,i,i.pendingProps.children,d),Ad(n,i),n===null&&(i.flags|=4194304),i.child;case 5:return n===null&&ct&&((x=m=$t)&&(m=oC(m,i.type,i.pendingProps,Aa),m!==null?(i.stateNode=m,Ss=i,$t=xa(m.firstChild),Aa=!1,x=!0):x=!1),x||Cn(i)),Q(i),x=i.type,j=i.pendingProps,O=n!==null?n.memoizedProps:null,m=j.children,Af(x,j)?m=null:O!==null&&Af(x,O)&&(i.flags|=32),i.memoizedState!==null&&(x=Th(n,i,NE,null,null,d),ql._currentValue=x),Ad(n,i),ps(n,i,m,d),i.child;case 6:return n===null&&ct&&((n=d=$t)&&(d=iC(d,i.pendingProps,Aa),d!==null?(i.stateNode=d,Ss=i,$t=null,n=!0):n=!1),n||Cn(i)),null;case 13:return rb(n,i,d);case 4:return P(i,i.stateNode.containerInfo),m=i.pendingProps,n===null?i.child=Vo(i,null,m,d):ps(n,i,m,d),i.child;case 11:return Ky(n,i,i.type,i.pendingProps,d);case 7:return ps(n,i,i.pendingProps,d),i.child;case 8:return ps(n,i,i.pendingProps.children,d),i.child;case 12:return ps(n,i,i.pendingProps.children,d),i.child;case 10:return m=i.pendingProps,zr(i,i.type,m.value),ps(n,i,m.children,d),i.child;case 9:return x=i.type._context,m=i.pendingProps.children,kn(i),x=ws(x),m=m(x),i.flags|=1,ps(n,i,m,d),i.child;case 14:return Xy(n,i,i.type,i.pendingProps,d);case 15:return Qy(n,i,i.type,i.pendingProps,d);case 19:return ob(n,i,d);case 31:return m=i.pendingProps,d=i.mode,m={mode:m.mode,children:m.children},n===null?(d=Md(m,d),d.ref=i.ref,i.child=d,d.return=i,i=d):(d=er(n.child,m),d.ref=i.ref,i.child=d,d.return=i,i=d),i;case 22:return Jy(n,i,d);case 24:return kn(i),m=ws(as),n===null?(x=bh(),x===null&&(x=_t,j=xh(),x.pooledCache=j,j.refCount++,j!==null&&(x.pooledCacheLanes|=d),x=j),i.memoizedState={parent:m,cache:x},wh(i),zr(i,as,x)):((n.lanes&d)!==0&&(jh(n,i),wl(i,null,null,d),vl()),x=n.memoizedState,j=i.memoizedState,x.parent!==m?(x={parent:m,cache:m},i.memoizedState=x,i.lanes===0&&(i.memoizedState=i.updateQueue.baseState=x),zr(i,as,m)):(m=j.cache,zr(i,as,m),m!==x.cache&&gh(i,[as],d,!0))),ps(n,i,i.pendingProps.children,d),i.child;case 29:throw i.pendingProps}throw Error(r(156,i.tag))}function lr(n){n.flags|=4}function lb(n,i){if(i.type!=="stylesheet"||(i.state.loading&4)!==0)n.flags&=-16777217;else if(n.flags|=16777216,!gv(i)){if(i=ra.current,i!==null&&((ot&4194048)===ot?Ma!==null:(ot&62914560)!==ot&&(ot&536870912)===0||i!==Ma))throw yl=vh,Hx;n.flags|=8192}}function Rd(n,i){i!==null&&(n.flags|=4),n.flags&16384&&(i=n.tag!==22?Ji():536870912,n.lanes|=i,Go|=i)}function Tl(n,i){if(!ct)switch(n.tailMode){case"hidden":i=n.tail;for(var d=null;i!==null;)i.alternate!==null&&(d=i),i=i.sibling;d===null?n.tail=null:d.sibling=null;break;case"collapsed":d=n.tail;for(var m=null;d!==null;)d.alternate!==null&&(m=d),d=d.sibling;m===null?i||n.tail===null?n.tail=null:n.tail.sibling=null:m.sibling=null}}function Ot(n){var i=n.alternate!==null&&n.alternate.child===n.child,d=0,m=0;if(i)for(var x=n.child;x!==null;)d|=x.lanes|x.childLanes,m|=x.subtreeFlags&65011712,m|=x.flags&65011712,x.return=n,x=x.sibling;else for(x=n.child;x!==null;)d|=x.lanes|x.childLanes,m|=x.subtreeFlags,m|=x.flags,x.return=n,x=x.sibling;return n.subtreeFlags|=m,n.childLanes=d,i}function OE(n,i,d){var m=i.pendingProps;switch(mh(i),i.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ot(i),null;case 1:return Ot(i),null;case 3:return d=i.stateNode,m=null,n!==null&&(m=n.memoizedState.cache),i.memoizedState.cache!==m&&(i.flags|=2048),rr(as),q(),d.pendingContext&&(d.context=d.pendingContext,d.pendingContext=null),(n===null||n.child===null)&&(ul(i)?lr(i):n===null||n.memoizedState.isDehydrated&&(i.flags&256)===0||(i.flags|=1024,Ux())),Ot(i),null;case 26:return d=i.memoizedState,n===null?(lr(i),d!==null?(Ot(i),lb(i,d)):(Ot(i),i.flags&=-16777217)):d?d!==n.memoizedState?(lr(i),Ot(i),lb(i,d)):(Ot(i),i.flags&=-16777217):(n.memoizedProps!==m&&lr(i),Ot(i),i.flags&=-16777217),null;case 27:G(i),d=ae.current;var x=i.type;if(n!==null&&i.stateNode!=null)n.memoizedProps!==m&&lr(i);else{if(!m){if(i.stateNode===null)throw Error(r(166));return Ot(i),null}n=re.current,ul(i)?Ix(i):(n=lv(x,m,d),i.stateNode=n,lr(i))}return Ot(i),null;case 5:if(G(i),d=i.type,n!==null&&i.stateNode!=null)n.memoizedProps!==m&&lr(i);else{if(!m){if(i.stateNode===null)throw Error(r(166));return Ot(i),null}if(n=re.current,ul(i))Ix(i);else{switch(x=Hd(ae.current),n){case 1:n=x.createElementNS("http://www.w3.org/2000/svg",d);break;case 2:n=x.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;default:switch(d){case"svg":n=x.createElementNS("http://www.w3.org/2000/svg",d);break;case"math":n=x.createElementNS("http://www.w3.org/1998/Math/MathML",d);break;case"script":n=x.createElement("div"),n.innerHTML="<script><\/script>",n=n.removeChild(n.firstChild);break;case"select":n=typeof m.is=="string"?x.createElement("select",{is:m.is}):x.createElement("select"),m.multiple?n.multiple=!0:m.size&&(n.size=m.size);break;default:n=typeof m.is=="string"?x.createElement(d,{is:m.is}):x.createElement(d)}}n[vs]=i,n[ks]=m;e:for(x=i.child;x!==null;){if(x.tag===5||x.tag===6)n.appendChild(x.stateNode);else if(x.tag!==4&&x.tag!==27&&x.child!==null){x.child.return=x,x=x.child;continue}if(x===i)break e;for(;x.sibling===null;){if(x.return===null||x.return===i)break e;x=x.return}x.sibling.return=x.return,x=x.sibling}i.stateNode=n;e:switch(xs(n,d,m),d){case"button":case"input":case"select":case"textarea":n=!!m.autoFocus;break e;case"img":n=!0;break e;default:n=!1}n&&lr(i)}}return Ot(i),i.flags&=-16777217,null;case 6:if(n&&i.stateNode!=null)n.memoizedProps!==m&&lr(i);else{if(typeof m!="string"&&i.stateNode===null)throw Error(r(166));if(n=ae.current,ul(i)){if(n=i.stateNode,d=i.memoizedProps,m=null,x=Ss,x!==null)switch(x.tag){case 27:case 5:m=x.memoizedProps}n[vs]=i,n=!!(n.nodeValue===d||m!==null&&m.suppressHydrationWarning===!0||tv(n.nodeValue,d)),n||Cn(i)}else n=Hd(n).createTextNode(m),n[vs]=i,i.stateNode=n}return Ot(i),null;case 13:if(m=i.memoizedState,n===null||n.memoizedState!==null&&n.memoizedState.dehydrated!==null){if(x=ul(i),m!==null&&m.dehydrated!==null){if(n===null){if(!x)throw Error(r(318));if(x=i.memoizedState,x=x!==null?x.dehydrated:null,!x)throw Error(r(317));x[vs]=i}else ml(),(i.flags&128)===0&&(i.memoizedState=null),i.flags|=4;Ot(i),x=!1}else x=Ux(),n!==null&&n.memoizedState!==null&&(n.memoizedState.hydrationErrors=x),x=!0;if(!x)return i.flags&256?(or(i),i):(or(i),null)}if(or(i),(i.flags&128)!==0)return i.lanes=d,i;if(d=m!==null,n=n!==null&&n.memoizedState!==null,d){m=i.child,x=null,m.alternate!==null&&m.alternate.memoizedState!==null&&m.alternate.memoizedState.cachePool!==null&&(x=m.alternate.memoizedState.cachePool.pool);var j=null;m.memoizedState!==null&&m.memoizedState.cachePool!==null&&(j=m.memoizedState.cachePool.pool),j!==x&&(m.flags|=2048)}return d!==n&&d&&(i.child.flags|=8192),Rd(i,i.updateQueue),Ot(i),null;case 4:return q(),n===null&&Sf(i.stateNode.containerInfo),Ot(i),null;case 10:return rr(i.type),Ot(i),null;case 19:if(F(rs),x=i.memoizedState,x===null)return Ot(i),null;if(m=(i.flags&128)!==0,j=x.rendering,j===null)if(m)Tl(x,!1);else{if(It!==0||n!==null&&(n.flags&128)!==0)for(n=i.child;n!==null;){if(j=Cd(n),j!==null){for(i.flags|=128,Tl(x,!1),n=j.updateQueue,i.updateQueue=n,Rd(i,n),i.subtreeFlags=0,n=d,d=i.child;d!==null;)zx(d,n),d=d.sibling;return Z(rs,rs.current&1|2),i.child}n=n.sibling}x.tail!==null&&Ve()>Pd&&(i.flags|=128,m=!0,Tl(x,!1),i.lanes=4194304)}else{if(!m)if(n=Cd(j),n!==null){if(i.flags|=128,m=!0,n=n.updateQueue,i.updateQueue=n,Rd(i,n),Tl(x,!0),x.tail===null&&x.tailMode==="hidden"&&!j.alternate&&!ct)return Ot(i),null}else 2*Ve()-x.renderingStartTime>Pd&&d!==536870912&&(i.flags|=128,m=!0,Tl(x,!1),i.lanes=4194304);x.isBackwards?(j.sibling=i.child,i.child=j):(n=x.last,n!==null?n.sibling=j:i.child=j,x.last=j)}return x.tail!==null?(i=x.tail,x.rendering=i,x.tail=i.sibling,x.renderingStartTime=Ve(),i.sibling=null,n=rs.current,Z(rs,m?n&1|2:n&1),i):(Ot(i),null);case 22:case 23:return or(i),Eh(),m=i.memoizedState!==null,n!==null?n.memoizedState!==null!==m&&(i.flags|=8192):m&&(i.flags|=8192),m?(d&536870912)!==0&&(i.flags&128)===0&&(Ot(i),i.subtreeFlags&6&&(i.flags|=8192)):Ot(i),d=i.updateQueue,d!==null&&Rd(i,d.retryQueue),d=null,n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(d=n.memoizedState.cachePool.pool),m=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(m=i.memoizedState.cachePool.pool),m!==d&&(i.flags|=2048),n!==null&&F(An),null;case 24:return d=null,n!==null&&(d=n.memoizedState.cache),i.memoizedState.cache!==d&&(i.flags|=2048),rr(as),Ot(i),null;case 25:return null;case 30:return null}throw Error(r(156,i.tag))}function DE(n,i){switch(mh(i),i.tag){case 1:return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 3:return rr(as),q(),n=i.flags,(n&65536)!==0&&(n&128)===0?(i.flags=n&-65537|128,i):null;case 26:case 27:case 5:return G(i),null;case 13:if(or(i),n=i.memoizedState,n!==null&&n.dehydrated!==null){if(i.alternate===null)throw Error(r(340));ml()}return n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 19:return F(rs),null;case 4:return q(),null;case 10:return rr(i.type),null;case 22:case 23:return or(i),Eh(),n!==null&&F(An),n=i.flags,n&65536?(i.flags=n&-65537|128,i):null;case 24:return rr(as),null;case 25:return null;default:return null}}function cb(n,i){switch(mh(i),i.tag){case 3:rr(as),q();break;case 26:case 27:case 5:G(i);break;case 4:q();break;case 13:or(i);break;case 19:F(rs);break;case 10:rr(i.type);break;case 22:case 23:or(i),Eh(),n!==null&&F(An);break;case 24:rr(as)}}function kl(n,i){try{var d=i.updateQueue,m=d!==null?d.lastEffect:null;if(m!==null){var x=m.next;d=x;do{if((d.tag&n)===n){m=void 0;var j=d.create,O=d.inst;m=j(),O.destroy=m}d=d.next}while(d!==x)}}catch(U){bt(i,i.return,U)}}function qr(n,i,d){try{var m=i.updateQueue,x=m!==null?m.lastEffect:null;if(x!==null){var j=x.next;m=j;do{if((m.tag&n)===n){var O=m.inst,U=O.destroy;if(U!==void 0){O.destroy=void 0,x=i;var K=d,de=U;try{de()}catch(ve){bt(x,K,ve)}}}m=m.next}while(m!==j)}}catch(ve){bt(i,i.return,ve)}}function db(n){var i=n.updateQueue;if(i!==null){var d=n.stateNode;try{Xx(i,d)}catch(m){bt(n,n.return,m)}}}function ub(n,i,d){d.props=Rn(n.type,n.memoizedProps),d.state=n.memoizedState;try{d.componentWillUnmount()}catch(m){bt(n,i,m)}}function Al(n,i){try{var d=n.ref;if(d!==null){switch(n.tag){case 26:case 27:case 5:var m=n.stateNode;break;case 30:m=n.stateNode;break;default:m=n.stateNode}typeof d=="function"?n.refCleanup=d(m):d.current=m}}catch(x){bt(n,i,x)}}function Ra(n,i){var d=n.ref,m=n.refCleanup;if(d!==null)if(typeof m=="function")try{m()}catch(x){bt(n,i,x)}finally{n.refCleanup=null,n=n.alternate,n!=null&&(n.refCleanup=null)}else if(typeof d=="function")try{d(null)}catch(x){bt(n,i,x)}else d.current=null}function mb(n){var i=n.type,d=n.memoizedProps,m=n.stateNode;try{e:switch(i){case"button":case"input":case"select":case"textarea":d.autoFocus&&m.focus();break e;case"img":d.src?m.src=d.src:d.srcSet&&(m.srcset=d.srcSet)}}catch(x){bt(n,n.return,x)}}function ef(n,i,d){try{var m=n.stateNode;tC(m,n.type,d,i),m[ks]=i}catch(x){bt(n,n.return,x)}}function hb(n){return n.tag===5||n.tag===3||n.tag===26||n.tag===27&&Xr(n.type)||n.tag===4}function tf(n){e:for(;;){for(;n.sibling===null;){if(n.return===null||hb(n.return))return null;n=n.return}for(n.sibling.return=n.return,n=n.sibling;n.tag!==5&&n.tag!==6&&n.tag!==18;){if(n.tag===27&&Xr(n.type)||n.flags&2||n.child===null||n.tag===4)continue e;n.child.return=n,n=n.child}if(!(n.flags&2))return n.stateNode}}function sf(n,i,d){var m=n.tag;if(m===5||m===6)n=n.stateNode,i?(d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d).insertBefore(n,i):(i=d.nodeType===9?d.body:d.nodeName==="HTML"?d.ownerDocument.body:d,i.appendChild(n),d=d._reactRootContainer,d!=null||i.onclick!==null||(i.onclick=Fd));else if(m!==4&&(m===27&&Xr(n.type)&&(d=n.stateNode,i=null),n=n.child,n!==null))for(sf(n,i,d),n=n.sibling;n!==null;)sf(n,i,d),n=n.sibling}function Od(n,i,d){var m=n.tag;if(m===5||m===6)n=n.stateNode,i?d.insertBefore(n,i):d.appendChild(n);else if(m!==4&&(m===27&&Xr(n.type)&&(d=n.stateNode),n=n.child,n!==null))for(Od(n,i,d),n=n.sibling;n!==null;)Od(n,i,d),n=n.sibling}function fb(n){var i=n.stateNode,d=n.memoizedProps;try{for(var m=n.type,x=i.attributes;x.length;)i.removeAttributeNode(x[0]);xs(i,m,d),i[vs]=n,i[ks]=d}catch(j){bt(n,n.return,j)}}var cr=!1,qt=!1,af=!1,pb=typeof WeakSet=="function"?WeakSet:Set,us=null;function PE(n,i){if(n=n.containerInfo,Tf=Xd,n=Ex(n),th(n)){if("selectionStart"in n)var d={start:n.selectionStart,end:n.selectionEnd};else e:{d=(d=n.ownerDocument)&&d.defaultView||window;var m=d.getSelection&&d.getSelection();if(m&&m.rangeCount!==0){d=m.anchorNode;var x=m.anchorOffset,j=m.focusNode;m=m.focusOffset;try{d.nodeType,j.nodeType}catch{d=null;break e}var O=0,U=-1,K=-1,de=0,ve=0,Ee=n,fe=null;t:for(;;){for(var ge;Ee!==d||x!==0&&Ee.nodeType!==3||(U=O+x),Ee!==j||m!==0&&Ee.nodeType!==3||(K=O+m),Ee.nodeType===3&&(O+=Ee.nodeValue.length),(ge=Ee.firstChild)!==null;)fe=Ee,Ee=ge;for(;;){if(Ee===n)break t;if(fe===d&&++de===x&&(U=O),fe===j&&++ve===m&&(K=O),(ge=Ee.nextSibling)!==null)break;Ee=fe,fe=Ee.parentNode}Ee=ge}d=U===-1||K===-1?null:{start:U,end:K}}else d=null}d=d||{start:0,end:0}}else d=null;for(kf={focusedElem:n,selectionRange:d},Xd=!1,us=i;us!==null;)if(i=us,n=i.child,(i.subtreeFlags&1024)!==0&&n!==null)n.return=i,us=n;else for(;us!==null;){switch(i=us,j=i.alternate,n=i.flags,i.tag){case 0:break;case 11:case 15:break;case 1:if((n&1024)!==0&&j!==null){n=void 0,d=i,x=j.memoizedProps,j=j.memoizedState,m=d.stateNode;try{var Ze=Rn(d.type,x,d.elementType===d.type);n=m.getSnapshotBeforeUpdate(Ze,j),m.__reactInternalSnapshotBeforeUpdate=n}catch(Fe){bt(d,d.return,Fe)}}break;case 3:if((n&1024)!==0){if(n=i.stateNode.containerInfo,d=n.nodeType,d===9)Rf(n);else if(d===1)switch(n.nodeName){case"HEAD":case"HTML":case"BODY":Rf(n);break;default:n.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((n&1024)!==0)throw Error(r(163))}if(n=i.sibling,n!==null){n.return=i.return,us=n;break}us=i.return}}function gb(n,i,d){var m=d.flags;switch(d.tag){case 0:case 11:case 15:Fr(n,d),m&4&&kl(5,d);break;case 1:if(Fr(n,d),m&4)if(n=d.stateNode,i===null)try{n.componentDidMount()}catch(O){bt(d,d.return,O)}else{var x=Rn(d.type,i.memoizedProps);i=i.memoizedState;try{n.componentDidUpdate(x,i,n.__reactInternalSnapshotBeforeUpdate)}catch(O){bt(d,d.return,O)}}m&64&&db(d),m&512&&Al(d,d.return);break;case 3:if(Fr(n,d),m&64&&(n=d.updateQueue,n!==null)){if(i=null,d.child!==null)switch(d.child.tag){case 27:case 5:i=d.child.stateNode;break;case 1:i=d.child.stateNode}try{Xx(n,i)}catch(O){bt(d,d.return,O)}}break;case 27:i===null&&m&4&&fb(d);case 26:case 5:Fr(n,d),i===null&&m&4&&mb(d),m&512&&Al(d,d.return);break;case 12:Fr(n,d);break;case 13:Fr(n,d),m&4&&bb(n,d),m&64&&(n=d.memoizedState,n!==null&&(n=n.dehydrated,n!==null&&(d=FE.bind(null,d),lC(n,d))));break;case 22:if(m=d.memoizedState!==null||cr,!m){i=i!==null&&i.memoizedState!==null||qt,x=cr;var j=qt;cr=m,(qt=i)&&!j?Hr(n,d,(d.subtreeFlags&8772)!==0):Fr(n,d),cr=x,qt=j}break;case 30:break;default:Fr(n,d)}}function xb(n){var i=n.alternate;i!==null&&(n.alternate=null,xb(i)),n.child=null,n.deletions=null,n.sibling=null,n.tag===5&&(i=n.stateNode,i!==null&&zm(i)),n.stateNode=null,n.return=null,n.dependencies=null,n.memoizedProps=null,n.memoizedState=null,n.pendingProps=null,n.stateNode=null,n.updateQueue=null}var kt=null,Rs=!1;function dr(n,i,d){for(d=d.child;d!==null;)yb(n,i,d),d=d.sibling}function yb(n,i,d){if(Pe&&typeof Pe.onCommitFiberUnmount=="function")try{Pe.onCommitFiberUnmount(Me,d)}catch{}switch(d.tag){case 26:qt||Ra(d,i),dr(n,i,d),d.memoizedState?d.memoizedState.count--:d.stateNode&&(d=d.stateNode,d.parentNode.removeChild(d));break;case 27:qt||Ra(d,i);var m=kt,x=Rs;Xr(d.type)&&(kt=d.stateNode,Rs=!1),dr(n,i,d),Ll(d.stateNode),kt=m,Rs=x;break;case 5:qt||Ra(d,i);case 6:if(m=kt,x=Rs,kt=null,dr(n,i,d),kt=m,Rs=x,kt!==null)if(Rs)try{(kt.nodeType===9?kt.body:kt.nodeName==="HTML"?kt.ownerDocument.body:kt).removeChild(d.stateNode)}catch(j){bt(d,i,j)}else try{kt.removeChild(d.stateNode)}catch(j){bt(d,i,j)}break;case 18:kt!==null&&(Rs?(n=kt,ov(n.nodeType===9?n.body:n.nodeName==="HTML"?n.ownerDocument.body:n,d.stateNode),Zl(n)):ov(kt,d.stateNode));break;case 4:m=kt,x=Rs,kt=d.stateNode.containerInfo,Rs=!0,dr(n,i,d),kt=m,Rs=x;break;case 0:case 11:case 14:case 15:qt||qr(2,d,i),qt||qr(4,d,i),dr(n,i,d);break;case 1:qt||(Ra(d,i),m=d.stateNode,typeof m.componentWillUnmount=="function"&&ub(d,i,m)),dr(n,i,d);break;case 21:dr(n,i,d);break;case 22:qt=(m=qt)||d.memoizedState!==null,dr(n,i,d),qt=m;break;default:dr(n,i,d)}}function bb(n,i){if(i.memoizedState===null&&(n=i.alternate,n!==null&&(n=n.memoizedState,n!==null&&(n=n.dehydrated,n!==null))))try{Zl(n)}catch(d){bt(i,i.return,d)}}function zE(n){switch(n.tag){case 13:case 19:var i=n.stateNode;return i===null&&(i=n.stateNode=new pb),i;case 22:return n=n.stateNode,i=n._retryCache,i===null&&(i=n._retryCache=new pb),i;default:throw Error(r(435,n.tag))}}function rf(n,i){var d=zE(n);i.forEach(function(m){var x=HE.bind(null,n,m);d.has(m)||(d.add(m),m.then(x,x))})}function Vs(n,i){var d=i.deletions;if(d!==null)for(var m=0;m<d.length;m++){var x=d[m],j=n,O=i,U=O;e:for(;U!==null;){switch(U.tag){case 27:if(Xr(U.type)){kt=U.stateNode,Rs=!1;break e}break;case 5:kt=U.stateNode,Rs=!1;break e;case 3:case 4:kt=U.stateNode.containerInfo,Rs=!0;break e}U=U.return}if(kt===null)throw Error(r(160));yb(j,O,x),kt=null,Rs=!1,j=x.alternate,j!==null&&(j.return=null),x.return=null}if(i.subtreeFlags&13878)for(i=i.child;i!==null;)vb(i,n),i=i.sibling}var ga=null;function vb(n,i){var d=n.alternate,m=n.flags;switch(n.tag){case 0:case 11:case 14:case 15:Vs(i,n),qs(n),m&4&&(qr(3,n,n.return),kl(3,n),qr(5,n,n.return));break;case 1:Vs(i,n),qs(n),m&512&&(qt||d===null||Ra(d,d.return)),m&64&&cr&&(n=n.updateQueue,n!==null&&(m=n.callbacks,m!==null&&(d=n.shared.hiddenCallbacks,n.shared.hiddenCallbacks=d===null?m:d.concat(m))));break;case 26:var x=ga;if(Vs(i,n),qs(n),m&512&&(qt||d===null||Ra(d,d.return)),m&4){var j=d!==null?d.memoizedState:null;if(m=n.memoizedState,d===null)if(m===null)if(n.stateNode===null){e:{m=n.type,d=n.memoizedProps,x=x.ownerDocument||x;t:switch(m){case"title":j=x.getElementsByTagName("title")[0],(!j||j[el]||j[vs]||j.namespaceURI==="http://www.w3.org/2000/svg"||j.hasAttribute("itemprop"))&&(j=x.createElement(m),x.head.insertBefore(j,x.querySelector("head > title"))),xs(j,m,d),j[vs]=n,cs(j),m=j;break e;case"link":var O=fv("link","href",x).get(m+(d.href||""));if(O){for(var U=0;U<O.length;U++)if(j=O[U],j.getAttribute("href")===(d.href==null||d.href===""?null:d.href)&&j.getAttribute("rel")===(d.rel==null?null:d.rel)&&j.getAttribute("title")===(d.title==null?null:d.title)&&j.getAttribute("crossorigin")===(d.crossOrigin==null?null:d.crossOrigin)){O.splice(U,1);break t}}j=x.createElement(m),xs(j,m,d),x.head.appendChild(j);break;case"meta":if(O=fv("meta","content",x).get(m+(d.content||""))){for(U=0;U<O.length;U++)if(j=O[U],j.getAttribute("content")===(d.content==null?null:""+d.content)&&j.getAttribute("name")===(d.name==null?null:d.name)&&j.getAttribute("property")===(d.property==null?null:d.property)&&j.getAttribute("http-equiv")===(d.httpEquiv==null?null:d.httpEquiv)&&j.getAttribute("charset")===(d.charSet==null?null:d.charSet)){O.splice(U,1);break t}}j=x.createElement(m),xs(j,m,d),x.head.appendChild(j);break;default:throw Error(r(468,m))}j[vs]=n,cs(j),m=j}n.stateNode=m}else pv(x,n.type,n.stateNode);else n.stateNode=hv(x,m,n.memoizedProps);else j!==m?(j===null?d.stateNode!==null&&(d=d.stateNode,d.parentNode.removeChild(d)):j.count--,m===null?pv(x,n.type,n.stateNode):hv(x,m,n.memoizedProps)):m===null&&n.stateNode!==null&&ef(n,n.memoizedProps,d.memoizedProps)}break;case 27:Vs(i,n),qs(n),m&512&&(qt||d===null||Ra(d,d.return)),d!==null&&m&4&&ef(n,n.memoizedProps,d.memoizedProps);break;case 5:if(Vs(i,n),qs(n),m&512&&(qt||d===null||Ra(d,d.return)),n.flags&32){x=n.stateNode;try{No(x,"")}catch(ge){bt(n,n.return,ge)}}m&4&&n.stateNode!=null&&(x=n.memoizedProps,ef(n,x,d!==null?d.memoizedProps:x)),m&1024&&(af=!0);break;case 6:if(Vs(i,n),qs(n),m&4){if(n.stateNode===null)throw Error(r(162));m=n.memoizedProps,d=n.stateNode;try{d.nodeValue=m}catch(ge){bt(n,n.return,ge)}}break;case 3:if(Wd=null,x=ga,ga=Gd(i.containerInfo),Vs(i,n),ga=x,qs(n),m&4&&d!==null&&d.memoizedState.isDehydrated)try{Zl(i.containerInfo)}catch(ge){bt(n,n.return,ge)}af&&(af=!1,wb(n));break;case 4:m=ga,ga=Gd(n.stateNode.containerInfo),Vs(i,n),qs(n),ga=m;break;case 12:Vs(i,n),qs(n);break;case 13:Vs(i,n),qs(n),n.child.flags&8192&&n.memoizedState!==null!=(d!==null&&d.memoizedState!==null)&&(uf=Ve()),m&4&&(m=n.updateQueue,m!==null&&(n.updateQueue=null,rf(n,m)));break;case 22:x=n.memoizedState!==null;var K=d!==null&&d.memoizedState!==null,de=cr,ve=qt;if(cr=de||x,qt=ve||K,Vs(i,n),qt=ve,cr=de,qs(n),m&8192)e:for(i=n.stateNode,i._visibility=x?i._visibility&-2:i._visibility|1,x&&(d===null||K||cr||qt||On(n)),d=null,i=n;;){if(i.tag===5||i.tag===26){if(d===null){K=d=i;try{if(j=K.stateNode,x)O=j.style,typeof O.setProperty=="function"?O.setProperty("display","none","important"):O.display="none";else{U=K.stateNode;var Ee=K.memoizedProps.style,fe=Ee!=null&&Ee.hasOwnProperty("display")?Ee.display:null;U.style.display=fe==null||typeof fe=="boolean"?"":(""+fe).trim()}}catch(ge){bt(K,K.return,ge)}}}else if(i.tag===6){if(d===null){K=i;try{K.stateNode.nodeValue=x?"":K.memoizedProps}catch(ge){bt(K,K.return,ge)}}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===n)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===n)break e;for(;i.sibling===null;){if(i.return===null||i.return===n)break e;d===i&&(d=null),i=i.return}d===i&&(d=null),i.sibling.return=i.return,i=i.sibling}m&4&&(m=n.updateQueue,m!==null&&(d=m.retryQueue,d!==null&&(m.retryQueue=null,rf(n,d))));break;case 19:Vs(i,n),qs(n),m&4&&(m=n.updateQueue,m!==null&&(n.updateQueue=null,rf(n,m)));break;case 30:break;case 21:break;default:Vs(i,n),qs(n)}}function qs(n){var i=n.flags;if(i&2){try{for(var d,m=n.return;m!==null;){if(hb(m)){d=m;break}m=m.return}if(d==null)throw Error(r(160));switch(d.tag){case 27:var x=d.stateNode,j=tf(n);Od(n,j,x);break;case 5:var O=d.stateNode;d.flags&32&&(No(O,""),d.flags&=-33);var U=tf(n);Od(n,U,O);break;case 3:case 4:var K=d.stateNode.containerInfo,de=tf(n);sf(n,de,K);break;default:throw Error(r(161))}}catch(ve){bt(n,n.return,ve)}n.flags&=-3}i&4096&&(n.flags&=-4097)}function wb(n){if(n.subtreeFlags&1024)for(n=n.child;n!==null;){var i=n;wb(i),i.tag===5&&i.flags&1024&&i.stateNode.reset(),n=n.sibling}}function Fr(n,i){if(i.subtreeFlags&8772)for(i=i.child;i!==null;)gb(n,i.alternate,i),i=i.sibling}function On(n){for(n=n.child;n!==null;){var i=n;switch(i.tag){case 0:case 11:case 14:case 15:qr(4,i,i.return),On(i);break;case 1:Ra(i,i.return);var d=i.stateNode;typeof d.componentWillUnmount=="function"&&ub(i,i.return,d),On(i);break;case 27:Ll(i.stateNode);case 26:case 5:Ra(i,i.return),On(i);break;case 22:i.memoizedState===null&&On(i);break;case 30:On(i);break;default:On(i)}n=n.sibling}}function Hr(n,i,d){for(d=d&&(i.subtreeFlags&8772)!==0,i=i.child;i!==null;){var m=i.alternate,x=n,j=i,O=j.flags;switch(j.tag){case 0:case 11:case 15:Hr(x,j,d),kl(4,j);break;case 1:if(Hr(x,j,d),m=j,x=m.stateNode,typeof x.componentDidMount=="function")try{x.componentDidMount()}catch(de){bt(m,m.return,de)}if(m=j,x=m.updateQueue,x!==null){var U=m.stateNode;try{var K=x.shared.hiddenCallbacks;if(K!==null)for(x.shared.hiddenCallbacks=null,x=0;x<K.length;x++)Kx(K[x],U)}catch(de){bt(m,m.return,de)}}d&&O&64&&db(j),Al(j,j.return);break;case 27:fb(j);case 26:case 5:Hr(x,j,d),d&&m===null&&O&4&&mb(j),Al(j,j.return);break;case 12:Hr(x,j,d);break;case 13:Hr(x,j,d),d&&O&4&&bb(x,j);break;case 22:j.memoizedState===null&&Hr(x,j,d),Al(j,j.return);break;case 30:break;default:Hr(x,j,d)}i=i.sibling}}function nf(n,i){var d=null;n!==null&&n.memoizedState!==null&&n.memoizedState.cachePool!==null&&(d=n.memoizedState.cachePool.pool),n=null,i.memoizedState!==null&&i.memoizedState.cachePool!==null&&(n=i.memoizedState.cachePool.pool),n!==d&&(n!=null&&n.refCount++,d!=null&&pl(d))}function of(n,i){n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&pl(n))}function Oa(n,i,d,m){if(i.subtreeFlags&10256)for(i=i.child;i!==null;)jb(n,i,d,m),i=i.sibling}function jb(n,i,d,m){var x=i.flags;switch(i.tag){case 0:case 11:case 15:Oa(n,i,d,m),x&2048&&kl(9,i);break;case 1:Oa(n,i,d,m);break;case 3:Oa(n,i,d,m),x&2048&&(n=null,i.alternate!==null&&(n=i.alternate.memoizedState.cache),i=i.memoizedState.cache,i!==n&&(i.refCount++,n!=null&&pl(n)));break;case 12:if(x&2048){Oa(n,i,d,m),n=i.stateNode;try{var j=i.memoizedProps,O=j.id,U=j.onPostCommit;typeof U=="function"&&U(O,i.alternate===null?"mount":"update",n.passiveEffectDuration,-0)}catch(K){bt(i,i.return,K)}}else Oa(n,i,d,m);break;case 13:Oa(n,i,d,m);break;case 23:break;case 22:j=i.stateNode,O=i.alternate,i.memoizedState!==null?j._visibility&2?Oa(n,i,d,m):Ml(n,i):j._visibility&2?Oa(n,i,d,m):(j._visibility|=2,qo(n,i,d,m,(i.subtreeFlags&10256)!==0)),x&2048&&nf(O,i);break;case 24:Oa(n,i,d,m),x&2048&&of(i.alternate,i);break;default:Oa(n,i,d,m)}}function qo(n,i,d,m,x){for(x=x&&(i.subtreeFlags&10256)!==0,i=i.child;i!==null;){var j=n,O=i,U=d,K=m,de=O.flags;switch(O.tag){case 0:case 11:case 15:qo(j,O,U,K,x),kl(8,O);break;case 23:break;case 22:var ve=O.stateNode;O.memoizedState!==null?ve._visibility&2?qo(j,O,U,K,x):Ml(j,O):(ve._visibility|=2,qo(j,O,U,K,x)),x&&de&2048&&nf(O.alternate,O);break;case 24:qo(j,O,U,K,x),x&&de&2048&&of(O.alternate,O);break;default:qo(j,O,U,K,x)}i=i.sibling}}function Ml(n,i){if(i.subtreeFlags&10256)for(i=i.child;i!==null;){var d=n,m=i,x=m.flags;switch(m.tag){case 22:Ml(d,m),x&2048&&nf(m.alternate,m);break;case 24:Ml(d,m),x&2048&&of(m.alternate,m);break;default:Ml(d,m)}i=i.sibling}}var Rl=8192;function Fo(n){if(n.subtreeFlags&Rl)for(n=n.child;n!==null;)_b(n),n=n.sibling}function _b(n){switch(n.tag){case 26:Fo(n),n.flags&Rl&&n.memoizedState!==null&&wC(ga,n.memoizedState,n.memoizedProps);break;case 5:Fo(n);break;case 3:case 4:var i=ga;ga=Gd(n.stateNode.containerInfo),Fo(n),ga=i;break;case 22:n.memoizedState===null&&(i=n.alternate,i!==null&&i.memoizedState!==null?(i=Rl,Rl=16777216,Fo(n),Rl=i):Fo(n));break;default:Fo(n)}}function Nb(n){var i=n.alternate;if(i!==null&&(n=i.child,n!==null)){i.child=null;do i=n.sibling,n.sibling=null,n=i;while(n!==null)}}function Ol(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var d=0;d<i.length;d++){var m=i[d];us=m,Eb(m,n)}Nb(n)}if(n.subtreeFlags&10256)for(n=n.child;n!==null;)Sb(n),n=n.sibling}function Sb(n){switch(n.tag){case 0:case 11:case 15:Ol(n),n.flags&2048&&qr(9,n,n.return);break;case 3:Ol(n);break;case 12:Ol(n);break;case 22:var i=n.stateNode;n.memoizedState!==null&&i._visibility&2&&(n.return===null||n.return.tag!==13)?(i._visibility&=-3,Dd(n)):Ol(n);break;default:Ol(n)}}function Dd(n){var i=n.deletions;if((n.flags&16)!==0){if(i!==null)for(var d=0;d<i.length;d++){var m=i[d];us=m,Eb(m,n)}Nb(n)}for(n=n.child;n!==null;){switch(i=n,i.tag){case 0:case 11:case 15:qr(8,i,i.return),Dd(i);break;case 22:d=i.stateNode,d._visibility&2&&(d._visibility&=-3,Dd(i));break;default:Dd(i)}n=n.sibling}}function Eb(n,i){for(;us!==null;){var d=us;switch(d.tag){case 0:case 11:case 15:qr(8,d,i);break;case 23:case 22:if(d.memoizedState!==null&&d.memoizedState.cachePool!==null){var m=d.memoizedState.cachePool.pool;m!=null&&m.refCount++}break;case 24:pl(d.memoizedState.cache)}if(m=d.child,m!==null)m.return=d,us=m;else e:for(d=n;us!==null;){m=us;var x=m.sibling,j=m.return;if(xb(m),m===d){us=null;break e}if(x!==null){x.return=j,us=x;break e}us=j}}}var $E={getCacheForType:function(n){var i=ws(as),d=i.data.get(n);return d===void 0&&(d=n(),i.data.set(n,d)),d}},IE=typeof WeakMap=="function"?WeakMap:Map,mt=0,_t=null,st=null,ot=0,ht=0,Fs=null,Gr=!1,Ho=!1,lf=!1,ur=0,It=0,Zr=0,Dn=0,cf=0,na=0,Go=0,Dl=null,Os=null,df=!1,uf=0,Pd=1/0,zd=null,Wr=null,gs=0,Yr=null,Zo=null,Wo=0,mf=0,hf=null,Cb=null,Pl=0,ff=null;function Hs(){if((mt&2)!==0&&ot!==0)return ot&-ot;if(V.T!==null){var n=Po;return n!==0?n:wf()}return qg()}function Tb(){na===0&&(na=(ot&536870912)===0||ct?Or():536870912);var n=ra.current;return n!==null&&(n.flags|=32),na}function Gs(n,i,d){(n===_t&&(ht===2||ht===9)||n.cancelPendingCommit!==null)&&(Yo(n,0),Kr(n,ot,na,!1)),yn(n,d),((mt&2)===0||n!==_t)&&(n===_t&&((mt&2)===0&&(Dn|=d),It===4&&Kr(n,ot,na,!1)),Da(n))}function kb(n,i,d){if((mt&6)!==0)throw Error(r(327));var m=!d&&(i&124)===0&&(i&n.expiredLanes)===0||Ls(n,i),x=m?BE(n,i):xf(n,i,!0),j=m;do{if(x===0){Ho&&!m&&Kr(n,i,0,!1);break}else{if(d=n.current.alternate,j&&!LE(d)){x=xf(n,i,!1),j=!1;continue}if(x===2){if(j=i,n.errorRecoveryDisabledLanes&j)var O=0;else O=n.pendingLanes&-536870913,O=O!==0?O:O&536870912?536870912:0;if(O!==0){i=O;e:{var U=n;x=Dl;var K=U.current.memoizedState.isDehydrated;if(K&&(Yo(U,O).flags|=256),O=xf(U,O,!1),O!==2){if(lf&&!K){U.errorRecoveryDisabledLanes|=j,Dn|=j,x=4;break e}j=Os,Os=x,j!==null&&(Os===null?Os=j:Os.push.apply(Os,j))}x=O}if(j=!1,x!==2)continue}}if(x===1){Yo(n,0),Kr(n,i,0,!0);break}e:{switch(m=n,j=x,j){case 0:case 1:throw Error(r(345));case 4:if((i&4194048)!==i)break;case 6:Kr(m,i,na,!Gr);break e;case 2:Os=null;break;case 3:case 5:break;default:throw Error(r(329))}if((i&62914560)===i&&(x=uf+300-Ve(),10<x)){if(Kr(m,i,na,!Gr),bs(m,0,!0)!==0)break e;m.timeoutHandle=rv(Ab.bind(null,m,d,Os,zd,df,i,na,Dn,Go,Gr,j,2,-0,0),x);break e}Ab(m,d,Os,zd,df,i,na,Dn,Go,Gr,j,0,-0,0)}}break}while(!0);Da(n)}function Ab(n,i,d,m,x,j,O,U,K,de,ve,Ee,fe,ge){if(n.timeoutHandle=-1,Ee=i.subtreeFlags,(Ee&8192||(Ee&16785408)===16785408)&&(Vl={stylesheets:null,count:0,unsuspend:vC},_b(i),Ee=jC(),Ee!==null)){n.cancelPendingCommit=Ee($b.bind(null,n,i,j,d,m,x,O,U,K,ve,1,fe,ge)),Kr(n,j,O,!de);return}$b(n,i,j,d,m,x,O,U,K)}function LE(n){for(var i=n;;){var d=i.tag;if((d===0||d===11||d===15)&&i.flags&16384&&(d=i.updateQueue,d!==null&&(d=d.stores,d!==null)))for(var m=0;m<d.length;m++){var x=d[m],j=x.getSnapshot;x=x.value;try{if(!Us(j(),x))return!1}catch{return!1}}if(d=i.child,i.subtreeFlags&16384&&d!==null)d.return=i,i=d;else{if(i===n)break;for(;i.sibling===null;){if(i.return===null||i.return===n)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function Kr(n,i,d,m){i&=~cf,i&=~Dn,n.suspendedLanes|=i,n.pingedLanes&=~i,m&&(n.warmLanes|=i),m=n.expirationTimes;for(var x=i;0<x;){var j=31-Qe(x),O=1<<j;m[j]=-1,x&=~O}d!==0&&go(n,d,i)}function $d(){return(mt&6)===0?(zl(0),!1):!0}function pf(){if(st!==null){if(ht===0)var n=st.return;else n=st,ar=Tn=null,Mh(n),Bo=null,El=0,n=st;for(;n!==null;)cb(n.alternate,n),n=n.return;st=null}}function Yo(n,i){var d=n.timeoutHandle;d!==-1&&(n.timeoutHandle=-1,aC(d)),d=n.cancelPendingCommit,d!==null&&(n.cancelPendingCommit=null,d()),pf(),_t=n,st=d=er(n.current,null),ot=i,ht=0,Fs=null,Gr=!1,Ho=Ls(n,i),lf=!1,Go=na=cf=Dn=Zr=It=0,Os=Dl=null,df=!1,(i&8)!==0&&(i|=i&32);var m=n.entangledLanes;if(m!==0)for(n=n.entanglements,m&=i;0<m;){var x=31-Qe(m),j=1<<x;i|=n[x],m&=~j}return ur=i,nd(),d}function Mb(n,i){Je=null,V.H=Nd,i===xl||i===fd?(i=Wx(),ht=3):i===Hx?(i=Wx(),ht=4):ht=i===Yy?8:i!==null&&typeof i=="object"&&typeof i.then=="function"?6:1,Fs=i,st===null&&(It=1,kd(n,ea(i,n.current)))}function Rb(){var n=V.H;return V.H=Nd,n===null?Nd:n}function Ob(){var n=V.A;return V.A=$E,n}function gf(){It=4,Gr||(ot&4194048)!==ot&&ra.current!==null||(Ho=!0),(Zr&134217727)===0&&(Dn&134217727)===0||_t===null||Kr(_t,ot,na,!1)}function xf(n,i,d){var m=mt;mt|=2;var x=Rb(),j=Ob();(_t!==n||ot!==i)&&(zd=null,Yo(n,i)),i=!1;var O=It;e:do try{if(ht!==0&&st!==null){var U=st,K=Fs;switch(ht){case 8:pf(),O=6;break e;case 3:case 2:case 9:case 6:ra.current===null&&(i=!0);var de=ht;if(ht=0,Fs=null,Ko(n,U,K,de),d&&Ho){O=0;break e}break;default:de=ht,ht=0,Fs=null,Ko(n,U,K,de)}}UE(),O=It;break}catch(ve){Mb(n,ve)}while(!0);return i&&n.shellSuspendCounter++,ar=Tn=null,mt=m,V.H=x,V.A=j,st===null&&(_t=null,ot=0,nd()),O}function UE(){for(;st!==null;)Db(st)}function BE(n,i){var d=mt;mt|=2;var m=Rb(),x=Ob();_t!==n||ot!==i?(zd=null,Pd=Ve()+500,Yo(n,i)):Ho=Ls(n,i);e:do try{if(ht!==0&&st!==null){i=st;var j=Fs;t:switch(ht){case 1:ht=0,Fs=null,Ko(n,i,j,1);break;case 2:case 9:if(Gx(j)){ht=0,Fs=null,Pb(i);break}i=function(){ht!==2&&ht!==9||_t!==n||(ht=7),Da(n)},j.then(i,i);break e;case 3:ht=7;break e;case 4:ht=5;break e;case 7:Gx(j)?(ht=0,Fs=null,Pb(i)):(ht=0,Fs=null,Ko(n,i,j,7));break;case 5:var O=null;switch(st.tag){case 26:O=st.memoizedState;case 5:case 27:var U=st;if(!O||gv(O)){ht=0,Fs=null;var K=U.sibling;if(K!==null)st=K;else{var de=U.return;de!==null?(st=de,Id(de)):st=null}break t}}ht=0,Fs=null,Ko(n,i,j,5);break;case 6:ht=0,Fs=null,Ko(n,i,j,6);break;case 8:pf(),It=6;break e;default:throw Error(r(462))}}VE();break}catch(ve){Mb(n,ve)}while(!0);return ar=Tn=null,V.H=m,V.A=x,mt=d,st!==null?0:(_t=null,ot=0,nd(),It)}function VE(){for(;st!==null&&!Re();)Db(st)}function Db(n){var i=ib(n.alternate,n,ur);n.memoizedProps=n.pendingProps,i===null?Id(n):st=i}function Pb(n){var i=n,d=i.alternate;switch(i.tag){case 15:case 0:i=tb(d,i,i.pendingProps,i.type,void 0,ot);break;case 11:i=tb(d,i,i.pendingProps,i.type.render,i.ref,ot);break;case 5:Mh(i);default:cb(d,i),i=st=zx(i,ur),i=ib(d,i,ur)}n.memoizedProps=n.pendingProps,i===null?Id(n):st=i}function Ko(n,i,d,m){ar=Tn=null,Mh(i),Bo=null,El=0;var x=i.return;try{if(ME(n,x,i,d,ot)){It=1,kd(n,ea(d,n.current)),st=null;return}}catch(j){if(x!==null)throw st=x,j;It=1,kd(n,ea(d,n.current)),st=null;return}i.flags&32768?(ct||m===1?n=!0:Ho||(ot&536870912)!==0?n=!1:(Gr=n=!0,(m===2||m===9||m===3||m===6)&&(m=ra.current,m!==null&&m.tag===13&&(m.flags|=16384))),zb(i,n)):Id(i)}function Id(n){var i=n;do{if((i.flags&32768)!==0){zb(i,Gr);return}n=i.return;var d=OE(i.alternate,i,ur);if(d!==null){st=d;return}if(i=i.sibling,i!==null){st=i;return}st=i=n}while(i!==null);It===0&&(It=5)}function zb(n,i){do{var d=DE(n.alternate,n);if(d!==null){d.flags&=32767,st=d;return}if(d=n.return,d!==null&&(d.flags|=32768,d.subtreeFlags=0,d.deletions=null),!i&&(n=n.sibling,n!==null)){st=n;return}st=n=d}while(n!==null);It=6,st=null}function $b(n,i,d,m,x,j,O,U,K){n.cancelPendingCommit=null;do Ld();while(gs!==0);if((mt&6)!==0)throw Error(r(327));if(i!==null){if(i===n.current)throw Error(r(177));if(j=i.lanes|i.childLanes,j|=oh,Bg(n,d,j,O,U,K),n===_t&&(st=_t=null,ot=0),Zo=i,Yr=n,Wo=d,mf=j,hf=x,Cb=m,(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?(n.callbackNode=null,n.callbackPriority=0,GE(se,function(){return Vb(),null})):(n.callbackNode=null,n.callbackPriority=0),m=(i.flags&13878)!==0,(i.subtreeFlags&13878)!==0||m){m=V.T,V.T=null,x=Y.p,Y.p=2,O=mt,mt|=4;try{PE(n,i,d)}finally{mt=O,Y.p=x,V.T=m}}gs=1,Ib(),Lb(),Ub()}}function Ib(){if(gs===1){gs=0;var n=Yr,i=Zo,d=(i.flags&13878)!==0;if((i.subtreeFlags&13878)!==0||d){d=V.T,V.T=null;var m=Y.p;Y.p=2;var x=mt;mt|=4;try{vb(i,n);var j=kf,O=Ex(n.containerInfo),U=j.focusedElem,K=j.selectionRange;if(O!==U&&U&&U.ownerDocument&&Sx(U.ownerDocument.documentElement,U)){if(K!==null&&th(U)){var de=K.start,ve=K.end;if(ve===void 0&&(ve=de),"selectionStart"in U)U.selectionStart=de,U.selectionEnd=Math.min(ve,U.value.length);else{var Ee=U.ownerDocument||document,fe=Ee&&Ee.defaultView||window;if(fe.getSelection){var ge=fe.getSelection(),Ze=U.textContent.length,Fe=Math.min(K.start,Ze),xt=K.end===void 0?Fe:Math.min(K.end,Ze);!ge.extend&&Fe>xt&&(O=xt,xt=Fe,Fe=O);var ne=Nx(U,Fe),te=Nx(U,xt);if(ne&&te&&(ge.rangeCount!==1||ge.anchorNode!==ne.node||ge.anchorOffset!==ne.offset||ge.focusNode!==te.node||ge.focusOffset!==te.offset)){var ie=Ee.createRange();ie.setStart(ne.node,ne.offset),ge.removeAllRanges(),Fe>xt?(ge.addRange(ie),ge.extend(te.node,te.offset)):(ie.setEnd(te.node,te.offset),ge.addRange(ie))}}}}for(Ee=[],ge=U;ge=ge.parentNode;)ge.nodeType===1&&Ee.push({element:ge,left:ge.scrollLeft,top:ge.scrollTop});for(typeof U.focus=="function"&&U.focus(),U=0;U<Ee.length;U++){var _e=Ee[U];_e.element.scrollLeft=_e.left,_e.element.scrollTop=_e.top}}Xd=!!Tf,kf=Tf=null}finally{mt=x,Y.p=m,V.T=d}}n.current=i,gs=2}}function Lb(){if(gs===2){gs=0;var n=Yr,i=Zo,d=(i.flags&8772)!==0;if((i.subtreeFlags&8772)!==0||d){d=V.T,V.T=null;var m=Y.p;Y.p=2;var x=mt;mt|=4;try{gb(n,i.alternate,i)}finally{mt=x,Y.p=m,V.T=d}}gs=3}}function Ub(){if(gs===4||gs===3){gs=0,Ie();var n=Yr,i=Zo,d=Wo,m=Cb;(i.subtreeFlags&10256)!==0||(i.flags&10256)!==0?gs=5:(gs=0,Zo=Yr=null,Bb(n,n.pendingLanes));var x=n.pendingLanes;if(x===0&&(Wr=null),Dm(d),i=i.stateNode,Pe&&typeof Pe.onCommitFiberRoot=="function")try{Pe.onCommitFiberRoot(Me,i,void 0,(i.current.flags&128)===128)}catch{}if(m!==null){i=V.T,x=Y.p,Y.p=2,V.T=null;try{for(var j=n.onRecoverableError,O=0;O<m.length;O++){var U=m[O];j(U.value,{componentStack:U.stack})}}finally{V.T=i,Y.p=x}}(Wo&3)!==0&&Ld(),Da(n),x=n.pendingLanes,(d&4194090)!==0&&(x&42)!==0?n===ff?Pl++:(Pl=0,ff=n):Pl=0,zl(0)}}function Bb(n,i){(n.pooledCacheLanes&=i)===0&&(i=n.pooledCache,i!=null&&(n.pooledCache=null,pl(i)))}function Ld(n){return Ib(),Lb(),Ub(),Vb()}function Vb(){if(gs!==5)return!1;var n=Yr,i=mf;mf=0;var d=Dm(Wo),m=V.T,x=Y.p;try{Y.p=32>d?32:d,V.T=null,d=hf,hf=null;var j=Yr,O=Wo;if(gs=0,Zo=Yr=null,Wo=0,(mt&6)!==0)throw Error(r(331));var U=mt;if(mt|=4,Sb(j.current),jb(j,j.current,O,d),mt=U,zl(0,!1),Pe&&typeof Pe.onPostCommitFiberRoot=="function")try{Pe.onPostCommitFiberRoot(Me,j)}catch{}return!0}finally{Y.p=x,V.T=m,Bb(n,i)}}function qb(n,i,d){i=ea(d,i),i=Hh(n.stateNode,i,2),n=Lr(n,i,2),n!==null&&(yn(n,2),Da(n))}function bt(n,i,d){if(n.tag===3)qb(n,n,d);else for(;i!==null;){if(i.tag===3){qb(i,n,d);break}else if(i.tag===1){var m=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof m.componentDidCatch=="function"&&(Wr===null||!Wr.has(m))){n=ea(d,n),d=Zy(2),m=Lr(i,d,2),m!==null&&(Wy(d,m,i,n),yn(m,2),Da(m));break}}i=i.return}}function yf(n,i,d){var m=n.pingCache;if(m===null){m=n.pingCache=new IE;var x=new Set;m.set(i,x)}else x=m.get(i),x===void 0&&(x=new Set,m.set(i,x));x.has(d)||(lf=!0,x.add(d),n=qE.bind(null,n,i,d),i.then(n,n))}function qE(n,i,d){var m=n.pingCache;m!==null&&m.delete(i),n.pingedLanes|=n.suspendedLanes&d,n.warmLanes&=~d,_t===n&&(ot&d)===d&&(It===4||It===3&&(ot&62914560)===ot&&300>Ve()-uf?(mt&2)===0&&Yo(n,0):cf|=d,Go===ot&&(Go=0)),Da(n)}function Fb(n,i){i===0&&(i=Ji()),n=Mo(n,i),n!==null&&(yn(n,i),Da(n))}function FE(n){var i=n.memoizedState,d=0;i!==null&&(d=i.retryLane),Fb(n,d)}function HE(n,i){var d=0;switch(n.tag){case 13:var m=n.stateNode,x=n.memoizedState;x!==null&&(d=x.retryLane);break;case 19:m=n.stateNode;break;case 22:m=n.stateNode._retryCache;break;default:throw Error(r(314))}m!==null&&m.delete(i),Fb(n,d)}function GE(n,i){return Ne(n,i)}var Ud=null,Xo=null,bf=!1,Bd=!1,vf=!1,Pn=0;function Da(n){n!==Xo&&n.next===null&&(Xo===null?Ud=Xo=n:Xo=Xo.next=n),Bd=!0,bf||(bf=!0,WE())}function zl(n,i){if(!vf&&Bd){vf=!0;do for(var d=!1,m=Ud;m!==null;){if(n!==0){var x=m.pendingLanes;if(x===0)var j=0;else{var O=m.suspendedLanes,U=m.pingedLanes;j=(1<<31-Qe(42|n)+1)-1,j&=x&~(O&~U),j=j&201326741?j&201326741|1:j?j|2:0}j!==0&&(d=!0,Wb(m,j))}else j=ot,j=bs(m,m===_t?j:0,m.cancelPendingCommit!==null||m.timeoutHandle!==-1),(j&3)===0||Ls(m,j)||(d=!0,Wb(m,j));m=m.next}while(d);vf=!1}}function ZE(){Hb()}function Hb(){Bd=bf=!1;var n=0;Pn!==0&&(sC()&&(n=Pn),Pn=0);for(var i=Ve(),d=null,m=Ud;m!==null;){var x=m.next,j=Gb(m,i);j===0?(m.next=null,d===null?Ud=x:d.next=x,x===null&&(Xo=d)):(d=m,(n!==0||(j&3)!==0)&&(Bd=!0)),m=x}zl(n)}function Gb(n,i){for(var d=n.suspendedLanes,m=n.pingedLanes,x=n.expirationTimes,j=n.pendingLanes&-62914561;0<j;){var O=31-Qe(j),U=1<<O,K=x[O];K===-1?((U&d)===0||(U&m)!==0)&&(x[O]=ka(U,i)):K<=i&&(n.expiredLanes|=U),j&=~U}if(i=_t,d=ot,d=bs(n,n===i?d:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),m=n.callbackNode,d===0||n===i&&(ht===2||ht===9)||n.cancelPendingCommit!==null)return m!==null&&m!==null&&je(m),n.callbackNode=null,n.callbackPriority=0;if((d&3)===0||Ls(n,d)){if(i=d&-d,i===n.callbackPriority)return i;switch(m!==null&&je(m),Dm(d)){case 2:case 8:d=W;break;case 32:d=se;break;case 268435456:d=Ce;break;default:d=se}return m=Zb.bind(null,n),d=Ne(d,m),n.callbackPriority=i,n.callbackNode=d,i}return m!==null&&m!==null&&je(m),n.callbackPriority=2,n.callbackNode=null,2}function Zb(n,i){if(gs!==0&&gs!==5)return n.callbackNode=null,n.callbackPriority=0,null;var d=n.callbackNode;if(Ld()&&n.callbackNode!==d)return null;var m=ot;return m=bs(n,n===_t?m:0,n.cancelPendingCommit!==null||n.timeoutHandle!==-1),m===0?null:(kb(n,m,i),Gb(n,Ve()),n.callbackNode!=null&&n.callbackNode===d?Zb.bind(null,n):null)}function Wb(n,i){if(Ld())return null;kb(n,i,!0)}function WE(){rC(function(){(mt&6)!==0?Ne(Ue,ZE):Hb()})}function wf(){return Pn===0&&(Pn=Or()),Pn}function Yb(n){return n==null||typeof n=="symbol"||typeof n=="boolean"?null:typeof n=="function"?n:Qc(""+n)}function Kb(n,i){var d=i.ownerDocument.createElement("input");return d.name=i.name,d.value=i.value,n.id&&d.setAttribute("form",n.id),i.parentNode.insertBefore(d,i),n=new FormData(n),d.parentNode.removeChild(d),n}function YE(n,i,d,m,x){if(i==="submit"&&d&&d.stateNode===x){var j=Yb((x[ks]||null).action),O=m.submitter;O&&(i=(i=O[ks]||null)?Yb(i.formAction):O.getAttribute("formAction"),i!==null&&(j=i,O=null));var U=new sd("action","action",null,m,x);n.push({event:U,listeners:[{instance:null,listener:function(){if(m.defaultPrevented){if(Pn!==0){var K=O?Kb(x,O):new FormData(x);Uh(d,{pending:!0,data:K,method:x.method,action:j},null,K)}}else typeof j=="function"&&(U.preventDefault(),K=O?Kb(x,O):new FormData(x),Uh(d,{pending:!0,data:K,method:x.method,action:j},j,K))},currentTarget:x}]})}}for(var jf=0;jf<nh.length;jf++){var _f=nh[jf],KE=_f.toLowerCase(),XE=_f[0].toUpperCase()+_f.slice(1);pa(KE,"on"+XE)}pa(kx,"onAnimationEnd"),pa(Ax,"onAnimationIteration"),pa(Mx,"onAnimationStart"),pa("dblclick","onDoubleClick"),pa("focusin","onFocus"),pa("focusout","onBlur"),pa(fE,"onTransitionRun"),pa(pE,"onTransitionStart"),pa(gE,"onTransitionCancel"),pa(Rx,"onTransitionEnd"),wo("onMouseEnter",["mouseout","mouseover"]),wo("onMouseLeave",["mouseout","mouseover"]),wo("onPointerEnter",["pointerout","pointerover"]),wo("onPointerLeave",["pointerout","pointerover"]),bn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),bn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),bn("onBeforeInput",["compositionend","keypress","textInput","paste"]),bn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),bn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),bn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $l="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),QE=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat($l));function Xb(n,i){i=(i&4)!==0;for(var d=0;d<n.length;d++){var m=n[d],x=m.event;m=m.listeners;e:{var j=void 0;if(i)for(var O=m.length-1;0<=O;O--){var U=m[O],K=U.instance,de=U.currentTarget;if(U=U.listener,K!==j&&x.isPropagationStopped())break e;j=U,x.currentTarget=de;try{j(x)}catch(ve){Td(ve)}x.currentTarget=null,j=K}else for(O=0;O<m.length;O++){if(U=m[O],K=U.instance,de=U.currentTarget,U=U.listener,K!==j&&x.isPropagationStopped())break e;j=U,x.currentTarget=de;try{j(x)}catch(ve){Td(ve)}x.currentTarget=null,j=K}}}}function at(n,i){var d=i[Pm];d===void 0&&(d=i[Pm]=new Set);var m=n+"__bubble";d.has(m)||(Qb(i,n,2,!1),d.add(m))}function Nf(n,i,d){var m=0;i&&(m|=4),Qb(d,n,m,i)}var Vd="_reactListening"+Math.random().toString(36).slice(2);function Sf(n){if(!n[Vd]){n[Vd]=!0,Hg.forEach(function(d){d!=="selectionchange"&&(QE.has(d)||Nf(d,!1,n),Nf(d,!0,n))});var i=n.nodeType===9?n:n.ownerDocument;i===null||i[Vd]||(i[Vd]=!0,Nf("selectionchange",!1,i))}}function Qb(n,i,d,m){switch(jv(i)){case 2:var x=SC;break;case 8:x=EC;break;default:x=Lf}d=x.bind(null,i,d,n),x=void 0,!Gm||i!=="touchstart"&&i!=="touchmove"&&i!=="wheel"||(x=!0),m?x!==void 0?n.addEventListener(i,d,{capture:!0,passive:x}):n.addEventListener(i,d,!0):x!==void 0?n.addEventListener(i,d,{passive:x}):n.addEventListener(i,d,!1)}function Ef(n,i,d,m,x){var j=m;if((i&1)===0&&(i&2)===0&&m!==null)e:for(;;){if(m===null)return;var O=m.tag;if(O===3||O===4){var U=m.stateNode.containerInfo;if(U===x)break;if(O===4)for(O=m.return;O!==null;){var K=O.tag;if((K===3||K===4)&&O.stateNode.containerInfo===x)return;O=O.return}for(;U!==null;){if(O=yo(U),O===null)return;if(K=O.tag,K===5||K===6||K===26||K===27){m=j=O;continue e}U=U.parentNode}}m=m.return}nx(function(){var de=j,ve=Fm(d),Ee=[];e:{var fe=Ox.get(n);if(fe!==void 0){var ge=sd,Ze=n;switch(n){case"keypress":if(ed(d)===0)break e;case"keydown":case"keyup":ge=GS;break;case"focusin":Ze="focus",ge=Km;break;case"focusout":Ze="blur",ge=Km;break;case"beforeblur":case"afterblur":ge=Km;break;case"click":if(d.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ge=lx;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ge=DS;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ge=YS;break;case kx:case Ax:case Mx:ge=$S;break;case Rx:ge=XS;break;case"scroll":case"scrollend":ge=RS;break;case"wheel":ge=JS;break;case"copy":case"cut":case"paste":ge=LS;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ge=dx;break;case"toggle":case"beforetoggle":ge=tE}var Fe=(i&4)!==0,xt=!Fe&&(n==="scroll"||n==="scrollend"),ne=Fe?fe!==null?fe+"Capture":null:fe;Fe=[];for(var te=de,ie;te!==null;){var _e=te;if(ie=_e.stateNode,_e=_e.tag,_e!==5&&_e!==26&&_e!==27||ie===null||ne===null||(_e=sl(te,ne),_e!=null&&Fe.push(Il(te,_e,ie))),xt)break;te=te.return}0<Fe.length&&(fe=new ge(fe,Ze,null,d,ve),Ee.push({event:fe,listeners:Fe}))}}if((i&7)===0){e:{if(fe=n==="mouseover"||n==="pointerover",ge=n==="mouseout"||n==="pointerout",fe&&d!==qm&&(Ze=d.relatedTarget||d.fromElement)&&(yo(Ze)||Ze[xo]))break e;if((ge||fe)&&(fe=ve.window===ve?ve:(fe=ve.ownerDocument)?fe.defaultView||fe.parentWindow:window,ge?(Ze=d.relatedTarget||d.toElement,ge=de,Ze=Ze?yo(Ze):null,Ze!==null&&(xt=l(Ze),Fe=Ze.tag,Ze!==xt||Fe!==5&&Fe!==27&&Fe!==6)&&(Ze=null)):(ge=null,Ze=de),ge!==Ze)){if(Fe=lx,_e="onMouseLeave",ne="onMouseEnter",te="mouse",(n==="pointerout"||n==="pointerover")&&(Fe=dx,_e="onPointerLeave",ne="onPointerEnter",te="pointer"),xt=ge==null?fe:tl(ge),ie=Ze==null?fe:tl(Ze),fe=new Fe(_e,te+"leave",ge,d,ve),fe.target=xt,fe.relatedTarget=ie,_e=null,yo(ve)===de&&(Fe=new Fe(ne,te+"enter",Ze,d,ve),Fe.target=ie,Fe.relatedTarget=xt,_e=Fe),xt=_e,ge&&Ze)t:{for(Fe=ge,ne=Ze,te=0,ie=Fe;ie;ie=Qo(ie))te++;for(ie=0,_e=ne;_e;_e=Qo(_e))ie++;for(;0<te-ie;)Fe=Qo(Fe),te--;for(;0<ie-te;)ne=Qo(ne),ie--;for(;te--;){if(Fe===ne||ne!==null&&Fe===ne.alternate)break t;Fe=Qo(Fe),ne=Qo(ne)}Fe=null}else Fe=null;ge!==null&&Jb(Ee,fe,ge,Fe,!1),Ze!==null&&xt!==null&&Jb(Ee,xt,Ze,Fe,!0)}}e:{if(fe=de?tl(de):window,ge=fe.nodeName&&fe.nodeName.toLowerCase(),ge==="select"||ge==="input"&&fe.type==="file")var Le=yx;else if(gx(fe))if(bx)Le=uE;else{Le=cE;var et=lE}else ge=fe.nodeName,!ge||ge.toLowerCase()!=="input"||fe.type!=="checkbox"&&fe.type!=="radio"?de&&Vm(de.elementType)&&(Le=yx):Le=dE;if(Le&&(Le=Le(n,de))){xx(Ee,Le,d,ve);break e}et&&et(n,fe,de),n==="focusout"&&de&&fe.type==="number"&&de.memoizedProps.value!=null&&Bm(fe,"number",fe.value)}switch(et=de?tl(de):window,n){case"focusin":(gx(et)||et.contentEditable==="true")&&(To=et,sh=de,dl=null);break;case"focusout":dl=sh=To=null;break;case"mousedown":ah=!0;break;case"contextmenu":case"mouseup":case"dragend":ah=!1,Cx(Ee,d,ve);break;case"selectionchange":if(hE)break;case"keydown":case"keyup":Cx(Ee,d,ve)}var Be;if(Qm)e:{switch(n){case"compositionstart":var He="onCompositionStart";break e;case"compositionend":He="onCompositionEnd";break e;case"compositionupdate":He="onCompositionUpdate";break e}He=void 0}else Co?fx(n,d)&&(He="onCompositionEnd"):n==="keydown"&&d.keyCode===229&&(He="onCompositionStart");He&&(ux&&d.locale!=="ko"&&(Co||He!=="onCompositionStart"?He==="onCompositionEnd"&&Co&&(Be=ox()):(Pr=ve,Zm="value"in Pr?Pr.value:Pr.textContent,Co=!0)),et=qd(de,He),0<et.length&&(He=new cx(He,n,null,d,ve),Ee.push({event:He,listeners:et}),Be?He.data=Be:(Be=px(d),Be!==null&&(He.data=Be)))),(Be=aE?rE(n,d):nE(n,d))&&(He=qd(de,"onBeforeInput"),0<He.length&&(et=new cx("onBeforeInput","beforeinput",null,d,ve),Ee.push({event:et,listeners:He}),et.data=Be)),YE(Ee,n,de,d,ve)}Xb(Ee,i)})}function Il(n,i,d){return{instance:n,listener:i,currentTarget:d}}function qd(n,i){for(var d=i+"Capture",m=[];n!==null;){var x=n,j=x.stateNode;if(x=x.tag,x!==5&&x!==26&&x!==27||j===null||(x=sl(n,d),x!=null&&m.unshift(Il(n,x,j)),x=sl(n,i),x!=null&&m.push(Il(n,x,j))),n.tag===3)return m;n=n.return}return[]}function Qo(n){if(n===null)return null;do n=n.return;while(n&&n.tag!==5&&n.tag!==27);return n||null}function Jb(n,i,d,m,x){for(var j=i._reactName,O=[];d!==null&&d!==m;){var U=d,K=U.alternate,de=U.stateNode;if(U=U.tag,K!==null&&K===m)break;U!==5&&U!==26&&U!==27||de===null||(K=de,x?(de=sl(d,j),de!=null&&O.unshift(Il(d,de,K))):x||(de=sl(d,j),de!=null&&O.push(Il(d,de,K)))),d=d.return}O.length!==0&&n.push({event:i,listeners:O})}var JE=/\r\n?/g,eC=/\u0000|\uFFFD/g;function ev(n){return(typeof n=="string"?n:""+n).replace(JE,`
`).replace(eC,"")}function tv(n,i){return i=ev(i),ev(n)===i}function Fd(){}function gt(n,i,d,m,x,j){switch(d){case"children":typeof m=="string"?i==="body"||i==="textarea"&&m===""||No(n,m):(typeof m=="number"||typeof m=="bigint")&&i!=="body"&&No(n,""+m);break;case"className":Yc(n,"class",m);break;case"tabIndex":Yc(n,"tabindex",m);break;case"dir":case"role":case"viewBox":case"width":case"height":Yc(n,d,m);break;case"style":ax(n,m,j);break;case"data":if(i!=="object"){Yc(n,"data",m);break}case"src":case"href":if(m===""&&(i!=="a"||d!=="href")){n.removeAttribute(d);break}if(m==null||typeof m=="function"||typeof m=="symbol"||typeof m=="boolean"){n.removeAttribute(d);break}m=Qc(""+m),n.setAttribute(d,m);break;case"action":case"formAction":if(typeof m=="function"){n.setAttribute(d,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof j=="function"&&(d==="formAction"?(i!=="input"&&gt(n,i,"name",x.name,x,null),gt(n,i,"formEncType",x.formEncType,x,null),gt(n,i,"formMethod",x.formMethod,x,null),gt(n,i,"formTarget",x.formTarget,x,null)):(gt(n,i,"encType",x.encType,x,null),gt(n,i,"method",x.method,x,null),gt(n,i,"target",x.target,x,null)));if(m==null||typeof m=="symbol"||typeof m=="boolean"){n.removeAttribute(d);break}m=Qc(""+m),n.setAttribute(d,m);break;case"onClick":m!=null&&(n.onclick=Fd);break;case"onScroll":m!=null&&at("scroll",n);break;case"onScrollEnd":m!=null&&at("scrollend",n);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(r(61));if(d=m.__html,d!=null){if(x.children!=null)throw Error(r(60));n.innerHTML=d}}break;case"multiple":n.multiple=m&&typeof m!="function"&&typeof m!="symbol";break;case"muted":n.muted=m&&typeof m!="function"&&typeof m!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(m==null||typeof m=="function"||typeof m=="boolean"||typeof m=="symbol"){n.removeAttribute("xlink:href");break}d=Qc(""+m),n.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",d);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":m!=null&&typeof m!="function"&&typeof m!="symbol"?n.setAttribute(d,""+m):n.removeAttribute(d);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":m&&typeof m!="function"&&typeof m!="symbol"?n.setAttribute(d,""):n.removeAttribute(d);break;case"capture":case"download":m===!0?n.setAttribute(d,""):m!==!1&&m!=null&&typeof m!="function"&&typeof m!="symbol"?n.setAttribute(d,m):n.removeAttribute(d);break;case"cols":case"rows":case"size":case"span":m!=null&&typeof m!="function"&&typeof m!="symbol"&&!isNaN(m)&&1<=m?n.setAttribute(d,m):n.removeAttribute(d);break;case"rowSpan":case"start":m==null||typeof m=="function"||typeof m=="symbol"||isNaN(m)?n.removeAttribute(d):n.setAttribute(d,m);break;case"popover":at("beforetoggle",n),at("toggle",n),Wc(n,"popover",m);break;case"xlinkActuate":Qa(n,"http://www.w3.org/1999/xlink","xlink:actuate",m);break;case"xlinkArcrole":Qa(n,"http://www.w3.org/1999/xlink","xlink:arcrole",m);break;case"xlinkRole":Qa(n,"http://www.w3.org/1999/xlink","xlink:role",m);break;case"xlinkShow":Qa(n,"http://www.w3.org/1999/xlink","xlink:show",m);break;case"xlinkTitle":Qa(n,"http://www.w3.org/1999/xlink","xlink:title",m);break;case"xlinkType":Qa(n,"http://www.w3.org/1999/xlink","xlink:type",m);break;case"xmlBase":Qa(n,"http://www.w3.org/XML/1998/namespace","xml:base",m);break;case"xmlLang":Qa(n,"http://www.w3.org/XML/1998/namespace","xml:lang",m);break;case"xmlSpace":Qa(n,"http://www.w3.org/XML/1998/namespace","xml:space",m);break;case"is":Wc(n,"is",m);break;case"innerText":case"textContent":break;default:(!(2<d.length)||d[0]!=="o"&&d[0]!=="O"||d[1]!=="n"&&d[1]!=="N")&&(d=AS.get(d)||d,Wc(n,d,m))}}function Cf(n,i,d,m,x,j){switch(d){case"style":ax(n,m,j);break;case"dangerouslySetInnerHTML":if(m!=null){if(typeof m!="object"||!("__html"in m))throw Error(r(61));if(d=m.__html,d!=null){if(x.children!=null)throw Error(r(60));n.innerHTML=d}}break;case"children":typeof m=="string"?No(n,m):(typeof m=="number"||typeof m=="bigint")&&No(n,""+m);break;case"onScroll":m!=null&&at("scroll",n);break;case"onScrollEnd":m!=null&&at("scrollend",n);break;case"onClick":m!=null&&(n.onclick=Fd);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!Gg.hasOwnProperty(d))e:{if(d[0]==="o"&&d[1]==="n"&&(x=d.endsWith("Capture"),i=d.slice(2,x?d.length-7:void 0),j=n[ks]||null,j=j!=null?j[d]:null,typeof j=="function"&&n.removeEventListener(i,j,x),typeof m=="function")){typeof j!="function"&&j!==null&&(d in n?n[d]=null:n.hasAttribute(d)&&n.removeAttribute(d)),n.addEventListener(i,m,x);break e}d in n?n[d]=m:m===!0?n.setAttribute(d,""):Wc(n,d,m)}}}function xs(n,i,d){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":at("error",n),at("load",n);var m=!1,x=!1,j;for(j in d)if(d.hasOwnProperty(j)){var O=d[j];if(O!=null)switch(j){case"src":m=!0;break;case"srcSet":x=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:gt(n,i,j,O,d,null)}}x&&gt(n,i,"srcSet",d.srcSet,d,null),m&&gt(n,i,"src",d.src,d,null);return;case"input":at("invalid",n);var U=j=O=x=null,K=null,de=null;for(m in d)if(d.hasOwnProperty(m)){var ve=d[m];if(ve!=null)switch(m){case"name":x=ve;break;case"type":O=ve;break;case"checked":K=ve;break;case"defaultChecked":de=ve;break;case"value":j=ve;break;case"defaultValue":U=ve;break;case"children":case"dangerouslySetInnerHTML":if(ve!=null)throw Error(r(137,i));break;default:gt(n,i,m,ve,d,null)}}Jg(n,j,U,K,de,O,x,!1),Kc(n);return;case"select":at("invalid",n),m=O=j=null;for(x in d)if(d.hasOwnProperty(x)&&(U=d[x],U!=null))switch(x){case"value":j=U;break;case"defaultValue":O=U;break;case"multiple":m=U;default:gt(n,i,x,U,d,null)}i=j,d=O,n.multiple=!!m,i!=null?_o(n,!!m,i,!1):d!=null&&_o(n,!!m,d,!0);return;case"textarea":at("invalid",n),j=x=m=null;for(O in d)if(d.hasOwnProperty(O)&&(U=d[O],U!=null))switch(O){case"value":m=U;break;case"defaultValue":x=U;break;case"children":j=U;break;case"dangerouslySetInnerHTML":if(U!=null)throw Error(r(91));break;default:gt(n,i,O,U,d,null)}tx(n,m,x,j),Kc(n);return;case"option":for(K in d)if(d.hasOwnProperty(K)&&(m=d[K],m!=null))switch(K){case"selected":n.selected=m&&typeof m!="function"&&typeof m!="symbol";break;default:gt(n,i,K,m,d,null)}return;case"dialog":at("beforetoggle",n),at("toggle",n),at("cancel",n),at("close",n);break;case"iframe":case"object":at("load",n);break;case"video":case"audio":for(m=0;m<$l.length;m++)at($l[m],n);break;case"image":at("error",n),at("load",n);break;case"details":at("toggle",n);break;case"embed":case"source":case"link":at("error",n),at("load",n);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(de in d)if(d.hasOwnProperty(de)&&(m=d[de],m!=null))switch(de){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,i));default:gt(n,i,de,m,d,null)}return;default:if(Vm(i)){for(ve in d)d.hasOwnProperty(ve)&&(m=d[ve],m!==void 0&&Cf(n,i,ve,m,d,void 0));return}}for(U in d)d.hasOwnProperty(U)&&(m=d[U],m!=null&&gt(n,i,U,m,d,null))}function tC(n,i,d,m){switch(i){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var x=null,j=null,O=null,U=null,K=null,de=null,ve=null;for(ge in d){var Ee=d[ge];if(d.hasOwnProperty(ge)&&Ee!=null)switch(ge){case"checked":break;case"value":break;case"defaultValue":K=Ee;default:m.hasOwnProperty(ge)||gt(n,i,ge,null,m,Ee)}}for(var fe in m){var ge=m[fe];if(Ee=d[fe],m.hasOwnProperty(fe)&&(ge!=null||Ee!=null))switch(fe){case"type":j=ge;break;case"name":x=ge;break;case"checked":de=ge;break;case"defaultChecked":ve=ge;break;case"value":O=ge;break;case"defaultValue":U=ge;break;case"children":case"dangerouslySetInnerHTML":if(ge!=null)throw Error(r(137,i));break;default:ge!==Ee&&gt(n,i,fe,ge,m,Ee)}}Um(n,O,U,K,de,ve,j,x);return;case"select":ge=O=U=fe=null;for(j in d)if(K=d[j],d.hasOwnProperty(j)&&K!=null)switch(j){case"value":break;case"multiple":ge=K;default:m.hasOwnProperty(j)||gt(n,i,j,null,m,K)}for(x in m)if(j=m[x],K=d[x],m.hasOwnProperty(x)&&(j!=null||K!=null))switch(x){case"value":fe=j;break;case"defaultValue":U=j;break;case"multiple":O=j;default:j!==K&&gt(n,i,x,j,m,K)}i=U,d=O,m=ge,fe!=null?_o(n,!!d,fe,!1):!!m!=!!d&&(i!=null?_o(n,!!d,i,!0):_o(n,!!d,d?[]:"",!1));return;case"textarea":ge=fe=null;for(U in d)if(x=d[U],d.hasOwnProperty(U)&&x!=null&&!m.hasOwnProperty(U))switch(U){case"value":break;case"children":break;default:gt(n,i,U,null,m,x)}for(O in m)if(x=m[O],j=d[O],m.hasOwnProperty(O)&&(x!=null||j!=null))switch(O){case"value":fe=x;break;case"defaultValue":ge=x;break;case"children":break;case"dangerouslySetInnerHTML":if(x!=null)throw Error(r(91));break;default:x!==j&&gt(n,i,O,x,m,j)}ex(n,fe,ge);return;case"option":for(var Ze in d)if(fe=d[Ze],d.hasOwnProperty(Ze)&&fe!=null&&!m.hasOwnProperty(Ze))switch(Ze){case"selected":n.selected=!1;break;default:gt(n,i,Ze,null,m,fe)}for(K in m)if(fe=m[K],ge=d[K],m.hasOwnProperty(K)&&fe!==ge&&(fe!=null||ge!=null))switch(K){case"selected":n.selected=fe&&typeof fe!="function"&&typeof fe!="symbol";break;default:gt(n,i,K,fe,m,ge)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Fe in d)fe=d[Fe],d.hasOwnProperty(Fe)&&fe!=null&&!m.hasOwnProperty(Fe)&&gt(n,i,Fe,null,m,fe);for(de in m)if(fe=m[de],ge=d[de],m.hasOwnProperty(de)&&fe!==ge&&(fe!=null||ge!=null))switch(de){case"children":case"dangerouslySetInnerHTML":if(fe!=null)throw Error(r(137,i));break;default:gt(n,i,de,fe,m,ge)}return;default:if(Vm(i)){for(var xt in d)fe=d[xt],d.hasOwnProperty(xt)&&fe!==void 0&&!m.hasOwnProperty(xt)&&Cf(n,i,xt,void 0,m,fe);for(ve in m)fe=m[ve],ge=d[ve],!m.hasOwnProperty(ve)||fe===ge||fe===void 0&&ge===void 0||Cf(n,i,ve,fe,m,ge);return}}for(var ne in d)fe=d[ne],d.hasOwnProperty(ne)&&fe!=null&&!m.hasOwnProperty(ne)&&gt(n,i,ne,null,m,fe);for(Ee in m)fe=m[Ee],ge=d[Ee],!m.hasOwnProperty(Ee)||fe===ge||fe==null&&ge==null||gt(n,i,Ee,fe,m,ge)}var Tf=null,kf=null;function Hd(n){return n.nodeType===9?n:n.ownerDocument}function sv(n){switch(n){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function av(n,i){if(n===0)switch(i){case"svg":return 1;case"math":return 2;default:return 0}return n===1&&i==="foreignObject"?0:n}function Af(n,i){return n==="textarea"||n==="noscript"||typeof i.children=="string"||typeof i.children=="number"||typeof i.children=="bigint"||typeof i.dangerouslySetInnerHTML=="object"&&i.dangerouslySetInnerHTML!==null&&i.dangerouslySetInnerHTML.__html!=null}var Mf=null;function sC(){var n=window.event;return n&&n.type==="popstate"?n===Mf?!1:(Mf=n,!0):(Mf=null,!1)}var rv=typeof setTimeout=="function"?setTimeout:void 0,aC=typeof clearTimeout=="function"?clearTimeout:void 0,nv=typeof Promise=="function"?Promise:void 0,rC=typeof queueMicrotask=="function"?queueMicrotask:typeof nv<"u"?function(n){return nv.resolve(null).then(n).catch(nC)}:rv;function nC(n){setTimeout(function(){throw n})}function Xr(n){return n==="head"}function ov(n,i){var d=i,m=0,x=0;do{var j=d.nextSibling;if(n.removeChild(d),j&&j.nodeType===8)if(d=j.data,d==="/$"){if(0<m&&8>m){d=m;var O=n.ownerDocument;if(d&1&&Ll(O.documentElement),d&2&&Ll(O.body),d&4)for(d=O.head,Ll(d),O=d.firstChild;O;){var U=O.nextSibling,K=O.nodeName;O[el]||K==="SCRIPT"||K==="STYLE"||K==="LINK"&&O.rel.toLowerCase()==="stylesheet"||d.removeChild(O),O=U}}if(x===0){n.removeChild(j),Zl(i);return}x--}else d==="$"||d==="$?"||d==="$!"?x++:m=d.charCodeAt(0)-48;else m=0;d=j}while(d);Zl(i)}function Rf(n){var i=n.firstChild;for(i&&i.nodeType===10&&(i=i.nextSibling);i;){var d=i;switch(i=i.nextSibling,d.nodeName){case"HTML":case"HEAD":case"BODY":Rf(d),zm(d);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(d.rel.toLowerCase()==="stylesheet")continue}n.removeChild(d)}}function oC(n,i,d,m){for(;n.nodeType===1;){var x=d;if(n.nodeName.toLowerCase()!==i.toLowerCase()){if(!m&&(n.nodeName!=="INPUT"||n.type!=="hidden"))break}else if(m){if(!n[el])switch(i){case"meta":if(!n.hasAttribute("itemprop"))break;return n;case"link":if(j=n.getAttribute("rel"),j==="stylesheet"&&n.hasAttribute("data-precedence"))break;if(j!==x.rel||n.getAttribute("href")!==(x.href==null||x.href===""?null:x.href)||n.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin)||n.getAttribute("title")!==(x.title==null?null:x.title))break;return n;case"style":if(n.hasAttribute("data-precedence"))break;return n;case"script":if(j=n.getAttribute("src"),(j!==(x.src==null?null:x.src)||n.getAttribute("type")!==(x.type==null?null:x.type)||n.getAttribute("crossorigin")!==(x.crossOrigin==null?null:x.crossOrigin))&&j&&n.hasAttribute("async")&&!n.hasAttribute("itemprop"))break;return n;default:return n}}else if(i==="input"&&n.type==="hidden"){var j=x.name==null?null:""+x.name;if(x.type==="hidden"&&n.getAttribute("name")===j)return n}else return n;if(n=xa(n.nextSibling),n===null)break}return null}function iC(n,i,d){if(i==="")return null;for(;n.nodeType!==3;)if((n.nodeType!==1||n.nodeName!=="INPUT"||n.type!=="hidden")&&!d||(n=xa(n.nextSibling),n===null))return null;return n}function Of(n){return n.data==="$!"||n.data==="$?"&&n.ownerDocument.readyState==="complete"}function lC(n,i){var d=n.ownerDocument;if(n.data!=="$?"||d.readyState==="complete")i();else{var m=function(){i(),d.removeEventListener("DOMContentLoaded",m)};d.addEventListener("DOMContentLoaded",m),n._reactRetry=m}}function xa(n){for(;n!=null;n=n.nextSibling){var i=n.nodeType;if(i===1||i===3)break;if(i===8){if(i=n.data,i==="$"||i==="$!"||i==="$?"||i==="F!"||i==="F")break;if(i==="/$")return null}}return n}var Df=null;function iv(n){n=n.previousSibling;for(var i=0;n;){if(n.nodeType===8){var d=n.data;if(d==="$"||d==="$!"||d==="$?"){if(i===0)return n;i--}else d==="/$"&&i++}n=n.previousSibling}return null}function lv(n,i,d){switch(i=Hd(d),n){case"html":if(n=i.documentElement,!n)throw Error(r(452));return n;case"head":if(n=i.head,!n)throw Error(r(453));return n;case"body":if(n=i.body,!n)throw Error(r(454));return n;default:throw Error(r(451))}}function Ll(n){for(var i=n.attributes;i.length;)n.removeAttributeNode(i[0]);zm(n)}var oa=new Map,cv=new Set;function Gd(n){return typeof n.getRootNode=="function"?n.getRootNode():n.nodeType===9?n:n.ownerDocument}var mr=Y.d;Y.d={f:cC,r:dC,D:uC,C:mC,L:hC,m:fC,X:gC,S:pC,M:xC};function cC(){var n=mr.f(),i=$d();return n||i}function dC(n){var i=bo(n);i!==null&&i.tag===5&&i.type==="form"?ky(i):mr.r(n)}var Jo=typeof document>"u"?null:document;function dv(n,i,d){var m=Jo;if(m&&typeof i=="string"&&i){var x=Js(i);x='link[rel="'+n+'"][href="'+x+'"]',typeof d=="string"&&(x+='[crossorigin="'+d+'"]'),cv.has(x)||(cv.add(x),n={rel:n,crossOrigin:d,href:i},m.querySelector(x)===null&&(i=m.createElement("link"),xs(i,"link",n),cs(i),m.head.appendChild(i)))}}function uC(n){mr.D(n),dv("dns-prefetch",n,null)}function mC(n,i){mr.C(n,i),dv("preconnect",n,i)}function hC(n,i,d){mr.L(n,i,d);var m=Jo;if(m&&n&&i){var x='link[rel="preload"][as="'+Js(i)+'"]';i==="image"&&d&&d.imageSrcSet?(x+='[imagesrcset="'+Js(d.imageSrcSet)+'"]',typeof d.imageSizes=="string"&&(x+='[imagesizes="'+Js(d.imageSizes)+'"]')):x+='[href="'+Js(n)+'"]';var j=x;switch(i){case"style":j=ei(n);break;case"script":j=ti(n)}oa.has(j)||(n=p({rel:"preload",href:i==="image"&&d&&d.imageSrcSet?void 0:n,as:i},d),oa.set(j,n),m.querySelector(x)!==null||i==="style"&&m.querySelector(Ul(j))||i==="script"&&m.querySelector(Bl(j))||(i=m.createElement("link"),xs(i,"link",n),cs(i),m.head.appendChild(i)))}}function fC(n,i){mr.m(n,i);var d=Jo;if(d&&n){var m=i&&typeof i.as=="string"?i.as:"script",x='link[rel="modulepreload"][as="'+Js(m)+'"][href="'+Js(n)+'"]',j=x;switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":j=ti(n)}if(!oa.has(j)&&(n=p({rel:"modulepreload",href:n},i),oa.set(j,n),d.querySelector(x)===null)){switch(m){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(d.querySelector(Bl(j)))return}m=d.createElement("link"),xs(m,"link",n),cs(m),d.head.appendChild(m)}}}function pC(n,i,d){mr.S(n,i,d);var m=Jo;if(m&&n){var x=vo(m).hoistableStyles,j=ei(n);i=i||"default";var O=x.get(j);if(!O){var U={loading:0,preload:null};if(O=m.querySelector(Ul(j)))U.loading=5;else{n=p({rel:"stylesheet",href:n,"data-precedence":i},d),(d=oa.get(j))&&Pf(n,d);var K=O=m.createElement("link");cs(K),xs(K,"link",n),K._p=new Promise(function(de,ve){K.onload=de,K.onerror=ve}),K.addEventListener("load",function(){U.loading|=1}),K.addEventListener("error",function(){U.loading|=2}),U.loading|=4,Zd(O,i,m)}O={type:"stylesheet",instance:O,count:1,state:U},x.set(j,O)}}}function gC(n,i){mr.X(n,i);var d=Jo;if(d&&n){var m=vo(d).hoistableScripts,x=ti(n),j=m.get(x);j||(j=d.querySelector(Bl(x)),j||(n=p({src:n,async:!0},i),(i=oa.get(x))&&zf(n,i),j=d.createElement("script"),cs(j),xs(j,"link",n),d.head.appendChild(j)),j={type:"script",instance:j,count:1,state:null},m.set(x,j))}}function xC(n,i){mr.M(n,i);var d=Jo;if(d&&n){var m=vo(d).hoistableScripts,x=ti(n),j=m.get(x);j||(j=d.querySelector(Bl(x)),j||(n=p({src:n,async:!0,type:"module"},i),(i=oa.get(x))&&zf(n,i),j=d.createElement("script"),cs(j),xs(j,"link",n),d.head.appendChild(j)),j={type:"script",instance:j,count:1,state:null},m.set(x,j))}}function uv(n,i,d,m){var x=(x=ae.current)?Gd(x):null;if(!x)throw Error(r(446));switch(n){case"meta":case"title":return null;case"style":return typeof d.precedence=="string"&&typeof d.href=="string"?(i=ei(d.href),d=vo(x).hoistableStyles,m=d.get(i),m||(m={type:"style",instance:null,count:0,state:null},d.set(i,m)),m):{type:"void",instance:null,count:0,state:null};case"link":if(d.rel==="stylesheet"&&typeof d.href=="string"&&typeof d.precedence=="string"){n=ei(d.href);var j=vo(x).hoistableStyles,O=j.get(n);if(O||(x=x.ownerDocument||x,O={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},j.set(n,O),(j=x.querySelector(Ul(n)))&&!j._p&&(O.instance=j,O.state.loading=5),oa.has(n)||(d={rel:"preload",as:"style",href:d.href,crossOrigin:d.crossOrigin,integrity:d.integrity,media:d.media,hrefLang:d.hrefLang,referrerPolicy:d.referrerPolicy},oa.set(n,d),j||yC(x,n,d,O.state))),i&&m===null)throw Error(r(528,""));return O}if(i&&m!==null)throw Error(r(529,""));return null;case"script":return i=d.async,d=d.src,typeof d=="string"&&i&&typeof i!="function"&&typeof i!="symbol"?(i=ti(d),d=vo(x).hoistableScripts,m=d.get(i),m||(m={type:"script",instance:null,count:0,state:null},d.set(i,m)),m):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,n))}}function ei(n){return'href="'+Js(n)+'"'}function Ul(n){return'link[rel="stylesheet"]['+n+"]"}function mv(n){return p({},n,{"data-precedence":n.precedence,precedence:null})}function yC(n,i,d,m){n.querySelector('link[rel="preload"][as="style"]['+i+"]")?m.loading=1:(i=n.createElement("link"),m.preload=i,i.addEventListener("load",function(){return m.loading|=1}),i.addEventListener("error",function(){return m.loading|=2}),xs(i,"link",d),cs(i),n.head.appendChild(i))}function ti(n){return'[src="'+Js(n)+'"]'}function Bl(n){return"script[async]"+n}function hv(n,i,d){if(i.count++,i.instance===null)switch(i.type){case"style":var m=n.querySelector('style[data-href~="'+Js(d.href)+'"]');if(m)return i.instance=m,cs(m),m;var x=p({},d,{"data-href":d.href,"data-precedence":d.precedence,href:null,precedence:null});return m=(n.ownerDocument||n).createElement("style"),cs(m),xs(m,"style",x),Zd(m,d.precedence,n),i.instance=m;case"stylesheet":x=ei(d.href);var j=n.querySelector(Ul(x));if(j)return i.state.loading|=4,i.instance=j,cs(j),j;m=mv(d),(x=oa.get(x))&&Pf(m,x),j=(n.ownerDocument||n).createElement("link"),cs(j);var O=j;return O._p=new Promise(function(U,K){O.onload=U,O.onerror=K}),xs(j,"link",m),i.state.loading|=4,Zd(j,d.precedence,n),i.instance=j;case"script":return j=ti(d.src),(x=n.querySelector(Bl(j)))?(i.instance=x,cs(x),x):(m=d,(x=oa.get(j))&&(m=p({},d),zf(m,x)),n=n.ownerDocument||n,x=n.createElement("script"),cs(x),xs(x,"link",m),n.head.appendChild(x),i.instance=x);case"void":return null;default:throw Error(r(443,i.type))}else i.type==="stylesheet"&&(i.state.loading&4)===0&&(m=i.instance,i.state.loading|=4,Zd(m,d.precedence,n));return i.instance}function Zd(n,i,d){for(var m=d.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),x=m.length?m[m.length-1]:null,j=x,O=0;O<m.length;O++){var U=m[O];if(U.dataset.precedence===i)j=U;else if(j!==x)break}j?j.parentNode.insertBefore(n,j.nextSibling):(i=d.nodeType===9?d.head:d,i.insertBefore(n,i.firstChild))}function Pf(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.title==null&&(n.title=i.title)}function zf(n,i){n.crossOrigin==null&&(n.crossOrigin=i.crossOrigin),n.referrerPolicy==null&&(n.referrerPolicy=i.referrerPolicy),n.integrity==null&&(n.integrity=i.integrity)}var Wd=null;function fv(n,i,d){if(Wd===null){var m=new Map,x=Wd=new Map;x.set(d,m)}else x=Wd,m=x.get(d),m||(m=new Map,x.set(d,m));if(m.has(n))return m;for(m.set(n,null),d=d.getElementsByTagName(n),x=0;x<d.length;x++){var j=d[x];if(!(j[el]||j[vs]||n==="link"&&j.getAttribute("rel")==="stylesheet")&&j.namespaceURI!=="http://www.w3.org/2000/svg"){var O=j.getAttribute(i)||"";O=n+O;var U=m.get(O);U?U.push(j):m.set(O,[j])}}return m}function pv(n,i,d){n=n.ownerDocument||n,n.head.insertBefore(d,i==="title"?n.querySelector("head > title"):null)}function bC(n,i,d){if(d===1||i.itemProp!=null)return!1;switch(n){case"meta":case"title":return!0;case"style":if(typeof i.precedence!="string"||typeof i.href!="string"||i.href==="")break;return!0;case"link":if(typeof i.rel!="string"||typeof i.href!="string"||i.href===""||i.onLoad||i.onError)break;switch(i.rel){case"stylesheet":return n=i.disabled,typeof i.precedence=="string"&&n==null;default:return!0}case"script":if(i.async&&typeof i.async!="function"&&typeof i.async!="symbol"&&!i.onLoad&&!i.onError&&i.src&&typeof i.src=="string")return!0}return!1}function gv(n){return!(n.type==="stylesheet"&&(n.state.loading&3)===0)}var Vl=null;function vC(){}function wC(n,i,d){if(Vl===null)throw Error(r(475));var m=Vl;if(i.type==="stylesheet"&&(typeof d.media!="string"||matchMedia(d.media).matches!==!1)&&(i.state.loading&4)===0){if(i.instance===null){var x=ei(d.href),j=n.querySelector(Ul(x));if(j){n=j._p,n!==null&&typeof n=="object"&&typeof n.then=="function"&&(m.count++,m=Yd.bind(m),n.then(m,m)),i.state.loading|=4,i.instance=j,cs(j);return}j=n.ownerDocument||n,d=mv(d),(x=oa.get(x))&&Pf(d,x),j=j.createElement("link"),cs(j);var O=j;O._p=new Promise(function(U,K){O.onload=U,O.onerror=K}),xs(j,"link",d),i.instance=j}m.stylesheets===null&&(m.stylesheets=new Map),m.stylesheets.set(i,n),(n=i.state.preload)&&(i.state.loading&3)===0&&(m.count++,i=Yd.bind(m),n.addEventListener("load",i),n.addEventListener("error",i))}}function jC(){if(Vl===null)throw Error(r(475));var n=Vl;return n.stylesheets&&n.count===0&&$f(n,n.stylesheets),0<n.count?function(i){var d=setTimeout(function(){if(n.stylesheets&&$f(n,n.stylesheets),n.unsuspend){var m=n.unsuspend;n.unsuspend=null,m()}},6e4);return n.unsuspend=i,function(){n.unsuspend=null,clearTimeout(d)}}:null}function Yd(){if(this.count--,this.count===0){if(this.stylesheets)$f(this,this.stylesheets);else if(this.unsuspend){var n=this.unsuspend;this.unsuspend=null,n()}}}var Kd=null;function $f(n,i){n.stylesheets=null,n.unsuspend!==null&&(n.count++,Kd=new Map,i.forEach(_C,n),Kd=null,Yd.call(n))}function _C(n,i){if(!(i.state.loading&4)){var d=Kd.get(n);if(d)var m=d.get(null);else{d=new Map,Kd.set(n,d);for(var x=n.querySelectorAll("link[data-precedence],style[data-precedence]"),j=0;j<x.length;j++){var O=x[j];(O.nodeName==="LINK"||O.getAttribute("media")!=="not all")&&(d.set(O.dataset.precedence,O),m=O)}m&&d.set(null,m)}x=i.instance,O=x.getAttribute("data-precedence"),j=d.get(O)||m,j===m&&d.set(null,x),d.set(O,x),this.count++,m=Yd.bind(this),x.addEventListener("load",m),x.addEventListener("error",m),j?j.parentNode.insertBefore(x,j.nextSibling):(n=n.nodeType===9?n.head:n,n.insertBefore(x,n.firstChild)),i.state.loading|=4}}var ql={$$typeof:C,Provider:null,Consumer:null,_currentValue:ee,_currentValue2:ee,_threadCount:0};function NC(n,i,d,m,x,j,O,U){this.tag=1,this.containerInfo=n,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=po(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=po(0),this.hiddenUpdates=po(null),this.identifierPrefix=m,this.onUncaughtError=x,this.onCaughtError=j,this.onRecoverableError=O,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=U,this.incompleteTransitions=new Map}function xv(n,i,d,m,x,j,O,U,K,de,ve,Ee){return n=new NC(n,i,d,O,U,K,de,Ee),i=1,j===!0&&(i|=24),j=Bs(3,null,null,i),n.current=j,j.stateNode=n,i=xh(),i.refCount++,n.pooledCache=i,i.refCount++,j.memoizedState={element:m,isDehydrated:d,cache:i},wh(j),n}function yv(n){return n?(n=Ro,n):Ro}function bv(n,i,d,m,x,j){x=yv(x),m.context===null?m.context=x:m.pendingContext=x,m=Ir(i),m.payload={element:d},j=j===void 0?null:j,j!==null&&(m.callback=j),d=Lr(n,m,i),d!==null&&(Gs(d,n,i),bl(d,n,i))}function vv(n,i){if(n=n.memoizedState,n!==null&&n.dehydrated!==null){var d=n.retryLane;n.retryLane=d!==0&&d<i?d:i}}function If(n,i){vv(n,i),(n=n.alternate)&&vv(n,i)}function wv(n){if(n.tag===13){var i=Mo(n,67108864);i!==null&&Gs(i,n,67108864),If(n,67108864)}}var Xd=!0;function SC(n,i,d,m){var x=V.T;V.T=null;var j=Y.p;try{Y.p=2,Lf(n,i,d,m)}finally{Y.p=j,V.T=x}}function EC(n,i,d,m){var x=V.T;V.T=null;var j=Y.p;try{Y.p=8,Lf(n,i,d,m)}finally{Y.p=j,V.T=x}}function Lf(n,i,d,m){if(Xd){var x=Uf(m);if(x===null)Ef(n,i,m,Qd,d),_v(n,m);else if(TC(x,n,i,d,m))m.stopPropagation();else if(_v(n,m),i&4&&-1<CC.indexOf(n)){for(;x!==null;){var j=bo(x);if(j!==null)switch(j.tag){case 3:if(j=j.stateNode,j.current.memoizedState.isDehydrated){var O=tt(j.pendingLanes);if(O!==0){var U=j;for(U.pendingLanes|=2,U.entangledLanes|=2;O;){var K=1<<31-Qe(O);U.entanglements[1]|=K,O&=~K}Da(j),(mt&6)===0&&(Pd=Ve()+500,zl(0))}}break;case 13:U=Mo(j,2),U!==null&&Gs(U,j,2),$d(),If(j,2)}if(j=Uf(m),j===null&&Ef(n,i,m,Qd,d),j===x)break;x=j}x!==null&&m.stopPropagation()}else Ef(n,i,m,null,d)}}function Uf(n){return n=Fm(n),Bf(n)}var Qd=null;function Bf(n){if(Qd=null,n=yo(n),n!==null){var i=l(n);if(i===null)n=null;else{var d=i.tag;if(d===13){if(n=c(i),n!==null)return n;n=null}else if(d===3){if(i.stateNode.current.memoizedState.isDehydrated)return i.tag===3?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}return Qd=n,null}function jv(n){switch(n){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(De()){case Ue:return 2;case W:return 8;case se:case ue:return 32;case Ce:return 268435456;default:return 32}default:return 32}}var Vf=!1,Qr=null,Jr=null,en=null,Fl=new Map,Hl=new Map,tn=[],CC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function _v(n,i){switch(n){case"focusin":case"focusout":Qr=null;break;case"dragenter":case"dragleave":Jr=null;break;case"mouseover":case"mouseout":en=null;break;case"pointerover":case"pointerout":Fl.delete(i.pointerId);break;case"gotpointercapture":case"lostpointercapture":Hl.delete(i.pointerId)}}function Gl(n,i,d,m,x,j){return n===null||n.nativeEvent!==j?(n={blockedOn:i,domEventName:d,eventSystemFlags:m,nativeEvent:j,targetContainers:[x]},i!==null&&(i=bo(i),i!==null&&wv(i)),n):(n.eventSystemFlags|=m,i=n.targetContainers,x!==null&&i.indexOf(x)===-1&&i.push(x),n)}function TC(n,i,d,m,x){switch(i){case"focusin":return Qr=Gl(Qr,n,i,d,m,x),!0;case"dragenter":return Jr=Gl(Jr,n,i,d,m,x),!0;case"mouseover":return en=Gl(en,n,i,d,m,x),!0;case"pointerover":var j=x.pointerId;return Fl.set(j,Gl(Fl.get(j)||null,n,i,d,m,x)),!0;case"gotpointercapture":return j=x.pointerId,Hl.set(j,Gl(Hl.get(j)||null,n,i,d,m,x)),!0}return!1}function Nv(n){var i=yo(n.target);if(i!==null){var d=l(i);if(d!==null){if(i=d.tag,i===13){if(i=c(d),i!==null){n.blockedOn=i,wS(n.priority,function(){if(d.tag===13){var m=Hs();m=Om(m);var x=Mo(d,m);x!==null&&Gs(x,d,m),If(d,m)}});return}}else if(i===3&&d.stateNode.current.memoizedState.isDehydrated){n.blockedOn=d.tag===3?d.stateNode.containerInfo:null;return}}}n.blockedOn=null}function Jd(n){if(n.blockedOn!==null)return!1;for(var i=n.targetContainers;0<i.length;){var d=Uf(n.nativeEvent);if(d===null){d=n.nativeEvent;var m=new d.constructor(d.type,d);qm=m,d.target.dispatchEvent(m),qm=null}else return i=bo(d),i!==null&&wv(i),n.blockedOn=d,!1;i.shift()}return!0}function Sv(n,i,d){Jd(n)&&d.delete(i)}function kC(){Vf=!1,Qr!==null&&Jd(Qr)&&(Qr=null),Jr!==null&&Jd(Jr)&&(Jr=null),en!==null&&Jd(en)&&(en=null),Fl.forEach(Sv),Hl.forEach(Sv)}function eu(n,i){n.blockedOn===i&&(n.blockedOn=null,Vf||(Vf=!0,t.unstable_scheduleCallback(t.unstable_NormalPriority,kC)))}var tu=null;function Ev(n){tu!==n&&(tu=n,t.unstable_scheduleCallback(t.unstable_NormalPriority,function(){tu===n&&(tu=null);for(var i=0;i<n.length;i+=3){var d=n[i],m=n[i+1],x=n[i+2];if(typeof m!="function"){if(Bf(m||d)===null)continue;break}var j=bo(d);j!==null&&(n.splice(i,3),i-=3,Uh(j,{pending:!0,data:x,method:d.method,action:m},m,x))}}))}function Zl(n){function i(K){return eu(K,n)}Qr!==null&&eu(Qr,n),Jr!==null&&eu(Jr,n),en!==null&&eu(en,n),Fl.forEach(i),Hl.forEach(i);for(var d=0;d<tn.length;d++){var m=tn[d];m.blockedOn===n&&(m.blockedOn=null)}for(;0<tn.length&&(d=tn[0],d.blockedOn===null);)Nv(d),d.blockedOn===null&&tn.shift();if(d=(n.ownerDocument||n).$$reactFormReplay,d!=null)for(m=0;m<d.length;m+=3){var x=d[m],j=d[m+1],O=x[ks]||null;if(typeof j=="function")O||Ev(d);else if(O){var U=null;if(j&&j.hasAttribute("formAction")){if(x=j,O=j[ks]||null)U=O.formAction;else if(Bf(x)!==null)continue}else U=O.action;typeof U=="function"?d[m+1]=U:(d.splice(m,3),m-=3),Ev(d)}}}function qf(n){this._internalRoot=n}su.prototype.render=qf.prototype.render=function(n){var i=this._internalRoot;if(i===null)throw Error(r(409));var d=i.current,m=Hs();bv(d,m,n,i,null,null)},su.prototype.unmount=qf.prototype.unmount=function(){var n=this._internalRoot;if(n!==null){this._internalRoot=null;var i=n.containerInfo;bv(n.current,2,null,n,null,null),$d(),i[xo]=null}};function su(n){this._internalRoot=n}su.prototype.unstable_scheduleHydration=function(n){if(n){var i=qg();n={blockedOn:null,target:n,priority:i};for(var d=0;d<tn.length&&i!==0&&i<tn[d].priority;d++);tn.splice(d,0,n),d===0&&Nv(n)}};var Cv=s.version;if(Cv!=="19.1.0")throw Error(r(527,Cv,"19.1.0"));Y.findDOMNode=function(n){var i=n._reactInternals;if(i===void 0)throw typeof n.render=="function"?Error(r(188)):(n=Object.keys(n).join(","),Error(r(268,n)));return n=h(i),n=n!==null?f(n):null,n=n===null?null:n.stateNode,n};var AC={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:V,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var au=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!au.isDisabled&&au.supportsFiber)try{Me=au.inject(AC),Pe=au}catch{}}return Yl.createRoot=function(n,i){if(!o(n))throw Error(r(299));var d=!1,m="",x=qy,j=Fy,O=Hy,U=null;return i!=null&&(i.unstable_strictMode===!0&&(d=!0),i.identifierPrefix!==void 0&&(m=i.identifierPrefix),i.onUncaughtError!==void 0&&(x=i.onUncaughtError),i.onCaughtError!==void 0&&(j=i.onCaughtError),i.onRecoverableError!==void 0&&(O=i.onRecoverableError),i.unstable_transitionCallbacks!==void 0&&(U=i.unstable_transitionCallbacks)),i=xv(n,1,!1,null,null,d,m,x,j,O,U,null),n[xo]=i.current,Sf(n),new qf(i)},Yl.hydrateRoot=function(n,i,d){if(!o(n))throw Error(r(299));var m=!1,x="",j=qy,O=Fy,U=Hy,K=null,de=null;return d!=null&&(d.unstable_strictMode===!0&&(m=!0),d.identifierPrefix!==void 0&&(x=d.identifierPrefix),d.onUncaughtError!==void 0&&(j=d.onUncaughtError),d.onCaughtError!==void 0&&(O=d.onCaughtError),d.onRecoverableError!==void 0&&(U=d.onRecoverableError),d.unstable_transitionCallbacks!==void 0&&(K=d.unstable_transitionCallbacks),d.formState!==void 0&&(de=d.formState)),i=xv(n,1,!0,i,d??null,m,x,j,O,U,K,de),i.context=yv(null),d=i.current,m=Hs(),m=Om(m),x=Ir(m),x.callback=null,Lr(d,x,m),d=m,i.current.lanes=d,yn(i,d),Da(i),n[xo]=i.current,Sf(n),new su(i)},Yl.version="19.1.0",Yl}var $v;function qC(){if($v)return Gf.exports;$v=1;function t(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(t)}catch(s){console.error(s)}}return t(),Gf.exports=VC(),Gf.exports}var FC=qC();/**
 * react-router v7.8.2
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Iv="popstate";function HC(t={}){function s(r,o){let{pathname:l,search:c,hash:u}=r.location;return Tp("",{pathname:l,search:c,hash:u},o.state&&o.state.usr||null,o.state&&o.state.key||"default")}function a(r,o){return typeof o=="string"?o:bc(o)}return ZC(s,a,null,t)}function Mt(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function Na(t,s){if(!t){typeof console<"u"&&console.warn(s);try{throw new Error(s)}catch{}}}function GC(){return Math.random().toString(36).substring(2,10)}function Lv(t,s){return{usr:t.state,key:t.key,idx:s}}function Tp(t,s,a=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof s=="string"?Bi(s):s,state:a,key:s&&s.key||r||GC()}}function bc({pathname:t="/",search:s="",hash:a=""}){return s&&s!=="?"&&(t+=s.charAt(0)==="?"?s:"?"+s),a&&a!=="#"&&(t+=a.charAt(0)==="#"?a:"#"+a),t}function Bi(t){let s={};if(t){let a=t.indexOf("#");a>=0&&(s.hash=t.substring(a),t=t.substring(0,a));let r=t.indexOf("?");r>=0&&(s.search=t.substring(r),t=t.substring(0,r)),t&&(s.pathname=t)}return s}function ZC(t,s,a,r={}){let{window:o=document.defaultView,v5Compat:l=!1}=r,c=o.history,u="POP",h=null,f=p();f==null&&(f=0,c.replaceState({...c.state,idx:f},""));function p(){return(c.state||{idx:null}).idx}function g(){u="POP";let E=p(),k=E==null?null:E-f;f=E,h&&h({action:u,location:w.location,delta:k})}function v(E,k){u="PUSH";let N=Tp(w.location,E,k);f=p()+1;let C=Lv(N,f),S=w.createHref(N);try{c.pushState(C,"",S)}catch(T){if(T instanceof DOMException&&T.name==="DataCloneError")throw T;o.location.assign(S)}l&&h&&h({action:u,location:w.location,delta:1})}function b(E,k){u="REPLACE";let N=Tp(w.location,E,k);f=p();let C=Lv(N,f),S=w.createHref(N);c.replaceState(C,"",S),l&&h&&h({action:u,location:w.location,delta:0})}function _(E){return WC(E)}let w={get action(){return u},get location(){return t(o,c)},listen(E){if(h)throw new Error("A history only accepts one active listener");return o.addEventListener(Iv,g),h=E,()=>{o.removeEventListener(Iv,g),h=null}},createHref(E){return s(o,E)},createURL:_,encodeLocation(E){let k=_(E);return{pathname:k.pathname,search:k.search,hash:k.hash}},push:v,replace:b,go(E){return c.go(E)}};return w}function WC(t,s=!1){let a="http://localhost";typeof window<"u"&&(a=window.location.origin!=="null"?window.location.origin:window.location.href),Mt(a,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:bc(t);return r=r.replace(/ $/,"%20"),!s&&r.startsWith("//")&&(r=a+r),new URL(r,a)}function C_(t,s,a="/"){return YC(t,s,a,!1)}function YC(t,s,a,r){let o=typeof s=="string"?Bi(s):s,l=Sr(o.pathname||"/",a);if(l==null)return null;let c=T_(t);KC(c);let u=null;for(let h=0;u==null&&h<c.length;++h){let f=i4(l);u=n4(c[h],f,r)}return u}function T_(t,s=[],a=[],r="",o=!1){let l=(c,u,h=o,f)=>{let p={relativePath:f===void 0?c.path||"":f,caseSensitive:c.caseSensitive===!0,childrenIndex:u,route:c};if(p.relativePath.startsWith("/")){if(!p.relativePath.startsWith(r)&&h)return;Mt(p.relativePath.startsWith(r),`Absolute route path "${p.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),p.relativePath=p.relativePath.slice(r.length)}let g=wr([r,p.relativePath]),v=a.concat(p);c.children&&c.children.length>0&&(Mt(c.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${g}".`),T_(c.children,s,v,g,h)),!(c.path==null&&!c.index)&&s.push({path:g,score:a4(g,c.index),routesMeta:v})};return t.forEach((c,u)=>{var h;if(c.path===""||!((h=c.path)!=null&&h.includes("?")))l(c,u);else for(let f of k_(c.path))l(c,u,!0,f)}),s}function k_(t){let s=t.split("/");if(s.length===0)return[];let[a,...r]=s,o=a.endsWith("?"),l=a.replace(/\?$/,"");if(r.length===0)return o?[l,""]:[l];let c=k_(r.join("/")),u=[];return u.push(...c.map(h=>h===""?l:[l,h].join("/"))),o&&u.push(...c),u.map(h=>t.startsWith("/")&&h===""?"/":h)}function KC(t){t.sort((s,a)=>s.score!==a.score?a.score-s.score:r4(s.routesMeta.map(r=>r.childrenIndex),a.routesMeta.map(r=>r.childrenIndex)))}var XC=/^:[\w-]+$/,QC=3,JC=2,e4=1,t4=10,s4=-2,Uv=t=>t==="*";function a4(t,s){let a=t.split("/"),r=a.length;return a.some(Uv)&&(r+=s4),s&&(r+=JC),a.filter(o=>!Uv(o)).reduce((o,l)=>o+(XC.test(l)?QC:l===""?e4:t4),r)}function r4(t,s){return t.length===s.length&&t.slice(0,-1).every((r,o)=>r===s[o])?t[t.length-1]-s[s.length-1]:0}function n4(t,s,a=!1){let{routesMeta:r}=t,o={},l="/",c=[];for(let u=0;u<r.length;++u){let h=r[u],f=u===r.length-1,p=l==="/"?s:s.slice(l.length)||"/",g=Du({path:h.relativePath,caseSensitive:h.caseSensitive,end:f},p),v=h.route;if(!g&&f&&a&&!r[r.length-1].route.index&&(g=Du({path:h.relativePath,caseSensitive:h.caseSensitive,end:!1},p)),!g)return null;Object.assign(o,g.params),c.push({params:o,pathname:wr([l,g.pathname]),pathnameBase:u4(wr([l,g.pathnameBase])),route:v}),g.pathnameBase!=="/"&&(l=wr([l,g.pathnameBase]))}return c}function Du(t,s){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[a,r]=o4(t.path,t.caseSensitive,t.end),o=s.match(a);if(!o)return null;let l=o[0],c=l.replace(/(.)\/+$/,"$1"),u=o.slice(1);return{params:r.reduce((f,{paramName:p,isOptional:g},v)=>{if(p==="*"){let _=u[v]||"";c=l.slice(0,l.length-_.length).replace(/(.)\/+$/,"$1")}const b=u[v];return g&&!b?f[p]=void 0:f[p]=(b||"").replace(/%2F/g,"/"),f},{}),pathname:l,pathnameBase:c,pattern:t}}function o4(t,s=!1,a=!0){Na(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],o="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(c,u,h)=>(r.push({paramName:u,isOptional:h!=null}),h?"/?([^\\/]+)?":"/([^\\/]+)")).replace(/\/([\w-]+)\?(\/|$)/g,"(/$1)?$2");return t.endsWith("*")?(r.push({paramName:"*"}),o+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):a?o+="\\/*$":t!==""&&t!=="/"&&(o+="(?:(?=\\/|$))"),[new RegExp(o,s?void 0:"i"),r]}function i4(t){try{return t.split("/").map(s=>decodeURIComponent(s).replace(/\//g,"%2F")).join("/")}catch(s){return Na(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${s}).`),t}}function Sr(t,s){if(s==="/")return t;if(!t.toLowerCase().startsWith(s.toLowerCase()))return null;let a=s.endsWith("/")?s.length-1:s.length,r=t.charAt(a);return r&&r!=="/"?null:t.slice(a)||"/"}function l4(t,s="/"){let{pathname:a,search:r="",hash:o=""}=typeof t=="string"?Bi(t):t;return{pathname:a?a.startsWith("/")?a:c4(a,s):s,search:m4(r),hash:h4(o)}}function c4(t,s){let a=s.replace(/\/+$/,"").split("/");return t.split("/").forEach(o=>{o===".."?a.length>1&&a.pop():o!=="."&&a.push(o)}),a.length>1?a.join("/"):"/"}function Kf(t,s,a,r){return`Cannot include a '${t}' character in a manually specified \`to.${s}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${a}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function d4(t){return t.filter((s,a)=>a===0||s.route.path&&s.route.path.length>0)}function T0(t){let s=d4(t);return s.map((a,r)=>r===s.length-1?a.pathname:a.pathnameBase)}function k0(t,s,a,r=!1){let o;typeof t=="string"?o=Bi(t):(o={...t},Mt(!o.pathname||!o.pathname.includes("?"),Kf("?","pathname","search",o)),Mt(!o.pathname||!o.pathname.includes("#"),Kf("#","pathname","hash",o)),Mt(!o.search||!o.search.includes("#"),Kf("#","search","hash",o)));let l=t===""||o.pathname==="",c=l?"/":o.pathname,u;if(c==null)u=a;else{let g=s.length-1;if(!r&&c.startsWith("..")){let v=c.split("/");for(;v[0]==="..";)v.shift(),g-=1;o.pathname=v.join("/")}u=g>=0?s[g]:"/"}let h=l4(o,u),f=c&&c!=="/"&&c.endsWith("/"),p=(l||c===".")&&a.endsWith("/");return!h.pathname.endsWith("/")&&(f||p)&&(h.pathname+="/"),h}var wr=t=>t.join("/").replace(/\/\/+/g,"/"),u4=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),m4=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,h4=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function f4(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var A_=["POST","PUT","PATCH","DELETE"];new Set(A_);var p4=["GET",...A_];new Set(p4);var Vi=y.createContext(null);Vi.displayName="DataRouter";var cm=y.createContext(null);cm.displayName="DataRouterState";y.createContext(!1);var M_=y.createContext({isTransitioning:!1});M_.displayName="ViewTransition";var g4=y.createContext(new Map);g4.displayName="Fetchers";var x4=y.createContext(null);x4.displayName="Await";var Ca=y.createContext(null);Ca.displayName="Navigation";var zc=y.createContext(null);zc.displayName="Location";var Ta=y.createContext({outlet:null,matches:[],isDataRoute:!1});Ta.displayName="Route";var A0=y.createContext(null);A0.displayName="RouteError";function y4(t,{relative:s}={}){Mt(qi(),"useHref() may be used only in the context of a <Router> component.");let{basename:a,navigator:r}=y.useContext(Ca),{hash:o,pathname:l,search:c}=$c(t,{relative:s}),u=l;return a!=="/"&&(u=l==="/"?a:wr([a,l])),r.createHref({pathname:u,search:c,hash:o})}function qi(){return y.useContext(zc)!=null}function kr(){return Mt(qi(),"useLocation() may be used only in the context of a <Router> component."),y.useContext(zc).location}var R_="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function O_(t){y.useContext(Ca).static||y.useLayoutEffect(t)}function Xs(){let{isDataRoute:t}=y.useContext(Ta);return t?O4():b4()}function b4(){Mt(qi(),"useNavigate() may be used only in the context of a <Router> component.");let t=y.useContext(Vi),{basename:s,navigator:a}=y.useContext(Ca),{matches:r}=y.useContext(Ta),{pathname:o}=kr(),l=JSON.stringify(T0(r)),c=y.useRef(!1);return O_(()=>{c.current=!0}),y.useCallback((h,f={})=>{if(Na(c.current,R_),!c.current)return;if(typeof h=="number"){a.go(h);return}let p=k0(h,JSON.parse(l),o,f.relative==="path");t==null&&s!=="/"&&(p.pathname=p.pathname==="/"?s:wr([s,p.pathname])),(f.replace?a.replace:a.push)(p,f.state,f)},[s,a,l,o,t])}var v4=y.createContext(null);function w4(t){let s=y.useContext(Ta).outlet;return s&&y.createElement(v4.Provider,{value:t},s)}function $c(t,{relative:s}={}){let{matches:a}=y.useContext(Ta),{pathname:r}=kr(),o=JSON.stringify(T0(a));return y.useMemo(()=>k0(t,JSON.parse(o),r,s==="path"),[t,o,r,s])}function j4(t,s){return D_(t,s)}function D_(t,s,a,r,o){var N;Mt(qi(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:l}=y.useContext(Ca),{matches:c}=y.useContext(Ta),u=c[c.length-1],h=u?u.params:{},f=u?u.pathname:"/",p=u?u.pathnameBase:"/",g=u&&u.route;{let C=g&&g.path||"";P_(f,!g||C.endsWith("*")||C.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${f}" (under <Route path="${C}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${C}"> to <Route path="${C==="/"?"*":`${C}/*`}">.`)}let v=kr(),b;if(s){let C=typeof s=="string"?Bi(s):s;Mt(p==="/"||((N=C.pathname)==null?void 0:N.startsWith(p)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${p}" but pathname "${C.pathname}" was given in the \`location\` prop.`),b=C}else b=v;let _=b.pathname||"/",w=_;if(p!=="/"){let C=p.replace(/^\//,"").split("/");w="/"+_.replace(/^\//,"").split("/").slice(C.length).join("/")}let E=C_(t,{pathname:w});Na(g||E!=null,`No routes matched location "${b.pathname}${b.search}${b.hash}" `),Na(E==null||E[E.length-1].route.element!==void 0||E[E.length-1].route.Component!==void 0||E[E.length-1].route.lazy!==void 0,`Matched leaf route at location "${b.pathname}${b.search}${b.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let k=C4(E&&E.map(C=>Object.assign({},C,{params:Object.assign({},h,C.params),pathname:wr([p,l.encodeLocation?l.encodeLocation(C.pathname).pathname:C.pathname]),pathnameBase:C.pathnameBase==="/"?p:wr([p,l.encodeLocation?l.encodeLocation(C.pathnameBase).pathname:C.pathnameBase])})),c,a,r,o);return s&&k?y.createElement(zc.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...b},navigationType:"POP"}},k):k}function _4(){let t=R4(),s=f4(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),a=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",o={padding:"0.5rem",backgroundColor:r},l={padding:"2px 4px",backgroundColor:r},c=null;return console.error("Error handled by React Router default ErrorBoundary:",t),c=y.createElement(y.Fragment,null,y.createElement("p",null,"💿 Hey developer 👋"),y.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",y.createElement("code",{style:l},"ErrorBoundary")," or"," ",y.createElement("code",{style:l},"errorElement")," prop on your route.")),y.createElement(y.Fragment,null,y.createElement("h2",null,"Unexpected Application Error!"),y.createElement("h3",{style:{fontStyle:"italic"}},s),a?y.createElement("pre",{style:o},a):null,c)}var N4=y.createElement(_4,null),S4=class extends y.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,s){return s.location!==t.location||s.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:s.error,location:s.location,revalidation:t.revalidation||s.revalidation}}componentDidCatch(t,s){this.props.unstable_onError?this.props.unstable_onError(t,s):console.error("React Router caught the following error during render",t)}render(){return this.state.error!==void 0?y.createElement(Ta.Provider,{value:this.props.routeContext},y.createElement(A0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function E4({routeContext:t,match:s,children:a}){let r=y.useContext(Vi);return r&&r.static&&r.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=s.route.id),y.createElement(Ta.Provider,{value:t},a)}function C4(t,s=[],a=null,r=null,o=null){if(t==null){if(!a)return null;if(a.errors)t=a.matches;else if(s.length===0&&!a.initialized&&a.matches.length>0)t=a.matches;else return null}let l=t,c=a==null?void 0:a.errors;if(c!=null){let f=l.findIndex(p=>p.route.id&&(c==null?void 0:c[p.route.id])!==void 0);Mt(f>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(c).join(",")}`),l=l.slice(0,Math.min(l.length,f+1))}let u=!1,h=-1;if(a)for(let f=0;f<l.length;f++){let p=l[f];if((p.route.HydrateFallback||p.route.hydrateFallbackElement)&&(h=f),p.route.id){let{loaderData:g,errors:v}=a,b=p.route.loader&&!g.hasOwnProperty(p.route.id)&&(!v||v[p.route.id]===void 0);if(p.route.lazy||b){u=!0,h>=0?l=l.slice(0,h+1):l=[l[0]];break}}}return l.reduceRight((f,p,g)=>{let v,b=!1,_=null,w=null;a&&(v=c&&p.route.id?c[p.route.id]:void 0,_=p.route.errorElement||N4,u&&(h<0&&g===0?(P_("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),b=!0,w=null):h===g&&(b=!0,w=p.route.hydrateFallbackElement||null)));let E=s.concat(l.slice(0,g+1)),k=()=>{let N;return v?N=_:b?N=w:p.route.Component?N=y.createElement(p.route.Component,null):p.route.element?N=p.route.element:N=f,y.createElement(E4,{match:p,routeContext:{outlet:f,matches:E,isDataRoute:a!=null},children:N})};return a&&(p.route.ErrorBoundary||p.route.errorElement||g===0)?y.createElement(S4,{location:a.location,revalidation:a.revalidation,component:_,error:v,children:k(),routeContext:{outlet:null,matches:E,isDataRoute:!0},unstable_onError:r}):k()},null)}function M0(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function T4(t){let s=y.useContext(Vi);return Mt(s,M0(t)),s}function k4(t){let s=y.useContext(cm);return Mt(s,M0(t)),s}function A4(t){let s=y.useContext(Ta);return Mt(s,M0(t)),s}function R0(t){let s=A4(t),a=s.matches[s.matches.length-1];return Mt(a.route.id,`${t} can only be used on routes that contain a unique "id"`),a.route.id}function M4(){return R0("useRouteId")}function R4(){var r;let t=y.useContext(A0),s=k4("useRouteError"),a=R0("useRouteError");return t!==void 0?t:(r=s.errors)==null?void 0:r[a]}function O4(){let{router:t}=T4("useNavigate"),s=R0("useNavigate"),a=y.useRef(!1);return O_(()=>{a.current=!0}),y.useCallback(async(o,l={})=>{Na(a.current,R_),a.current&&(typeof o=="number"?t.navigate(o):await t.navigate(o,{fromRouteId:s,...l}))},[t,s])}var Bv={};function P_(t,s,a){!s&&!Bv[t]&&(Bv[t]=!0,Na(!1,a))}y.memo(D4);function D4({routes:t,future:s,state:a,unstable_onError:r}){return D_(t,void 0,a,r,s)}function Ri({to:t,replace:s,state:a,relative:r}){Mt(qi(),"<Navigate> may be used only in the context of a <Router> component.");let{static:o}=y.useContext(Ca);Na(!o,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:l}=y.useContext(Ta),{pathname:c}=kr(),u=Xs(),h=k0(t,T0(l),c,r==="path"),f=JSON.stringify(h);return y.useEffect(()=>{u(JSON.parse(f),{replace:s,state:a,relative:r})},[u,f,r,s,a]),null}function P4(t){return w4(t.context)}function it(t){Mt(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function z4({basename:t="/",children:s=null,location:a,navigationType:r="POP",navigator:o,static:l=!1}){Mt(!qi(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let c=t.replace(/^\/*/,"/"),u=y.useMemo(()=>({basename:c,navigator:o,static:l,future:{}}),[c,o,l]);typeof a=="string"&&(a=Bi(a));let{pathname:h="/",search:f="",hash:p="",state:g=null,key:v="default"}=a,b=y.useMemo(()=>{let _=Sr(h,c);return _==null?null:{location:{pathname:_,search:f,hash:p,state:g,key:v},navigationType:r}},[c,h,f,p,g,v,r]);return Na(b!=null,`<Router basename="${c}"> is not able to match the URL "${h}${f}${p}" because it does not start with the basename, so the <Router> won't render anything.`),b==null?null:y.createElement(Ca.Provider,{value:u},y.createElement(zc.Provider,{children:s,value:b}))}function z_({children:t,location:s}){return j4(kp(t),s)}function kp(t,s=[]){let a=[];return y.Children.forEach(t,(r,o)=>{if(!y.isValidElement(r))return;let l=[...s,o];if(r.type===y.Fragment){a.push.apply(a,kp(r.props.children,l));return}Mt(r.type===it,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Mt(!r.props.index||!r.props.children,"An index route cannot have child routes.");let c={id:r.props.id||l.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(c.children=kp(r.props.children,l)),a.push(c)}),a}var ju="get",_u="application/x-www-form-urlencoded";function dm(t){return t!=null&&typeof t.tagName=="string"}function $4(t){return dm(t)&&t.tagName.toLowerCase()==="button"}function I4(t){return dm(t)&&t.tagName.toLowerCase()==="form"}function L4(t){return dm(t)&&t.tagName.toLowerCase()==="input"}function U4(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function B4(t,s){return t.button===0&&(!s||s==="_self")&&!U4(t)}var ru=null;function V4(){if(ru===null)try{new FormData(document.createElement("form"),0),ru=!1}catch{ru=!0}return ru}var q4=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Xf(t){return t!=null&&!q4.has(t)?(Na(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${_u}"`),null):t}function F4(t,s){let a,r,o,l,c;if(I4(t)){let u=t.getAttribute("action");r=u?Sr(u,s):null,a=t.getAttribute("method")||ju,o=Xf(t.getAttribute("enctype"))||_u,l=new FormData(t)}else if($4(t)||L4(t)&&(t.type==="submit"||t.type==="image")){let u=t.form;if(u==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let h=t.getAttribute("formaction")||u.getAttribute("action");if(r=h?Sr(h,s):null,a=t.getAttribute("formmethod")||u.getAttribute("method")||ju,o=Xf(t.getAttribute("formenctype"))||Xf(u.getAttribute("enctype"))||_u,l=new FormData(u,t),!V4()){let{name:f,type:p,value:g}=t;if(p==="image"){let v=f?`${f}.`:"";l.append(`${v}x`,"0"),l.append(`${v}y`,"0")}else f&&l.append(f,g)}}else{if(dm(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');a=ju,r=null,o=_u,c=t}return l&&o==="text/plain"&&(c=l,l=void 0),{action:r,method:a.toLowerCase(),encType:o,formData:l,body:c}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function O0(t,s){if(t===!1||t===null||typeof t>"u")throw new Error(s)}function H4(t,s,a){let r=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return r.pathname==="/"?r.pathname=`_root.${a}`:s&&Sr(r.pathname,s)==="/"?r.pathname=`${s.replace(/\/$/,"")}/_root.${a}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${a}`,r}async function G4(t,s){if(t.id in s)return s[t.id];try{let a=await import(t.module);return s[t.id]=a,a}catch(a){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(a),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function Z4(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function W4(t,s,a){let r=await Promise.all(t.map(async o=>{let l=s.routes[o.route.id];if(l){let c=await G4(l,a);return c.links?c.links():[]}return[]}));return Q4(r.flat(1).filter(Z4).filter(o=>o.rel==="stylesheet"||o.rel==="preload").map(o=>o.rel==="stylesheet"?{...o,rel:"prefetch",as:"style"}:{...o,rel:"prefetch"}))}function Vv(t,s,a,r,o,l){let c=(h,f)=>a[f]?h.route.id!==a[f].route.id:!0,u=(h,f)=>{var p;return a[f].pathname!==h.pathname||((p=a[f].route.path)==null?void 0:p.endsWith("*"))&&a[f].params["*"]!==h.params["*"]};return l==="assets"?s.filter((h,f)=>c(h,f)||u(h,f)):l==="data"?s.filter((h,f)=>{var g;let p=r.routes[h.route.id];if(!p||!p.hasLoader)return!1;if(c(h,f)||u(h,f))return!0;if(h.route.shouldRevalidate){let v=h.route.shouldRevalidate({currentUrl:new URL(o.pathname+o.search+o.hash,window.origin),currentParams:((g=a[0])==null?void 0:g.params)||{},nextUrl:new URL(t,window.origin),nextParams:h.params,defaultShouldRevalidate:!0});if(typeof v=="boolean")return v}return!0}):[]}function Y4(t,s,{includeHydrateFallback:a}={}){return K4(t.map(r=>{let o=s.routes[r.route.id];if(!o)return[];let l=[o.module];return o.clientActionModule&&(l=l.concat(o.clientActionModule)),o.clientLoaderModule&&(l=l.concat(o.clientLoaderModule)),a&&o.hydrateFallbackModule&&(l=l.concat(o.hydrateFallbackModule)),o.imports&&(l=l.concat(o.imports)),l}).flat(1))}function K4(t){return[...new Set(t)]}function X4(t){let s={},a=Object.keys(t).sort();for(let r of a)s[r]=t[r];return s}function Q4(t,s){let a=new Set;return new Set(s),t.reduce((r,o)=>{let l=JSON.stringify(X4(o));return a.has(l)||(a.add(l),r.push({key:l,link:o})),r},[])}function $_(){let t=y.useContext(Vi);return O0(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function J4(){let t=y.useContext(cm);return O0(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var D0=y.createContext(void 0);D0.displayName="FrameworkContext";function I_(){let t=y.useContext(D0);return O0(t,"You must render this element inside a <HydratedRouter> element"),t}function e5(t,s){let a=y.useContext(D0),[r,o]=y.useState(!1),[l,c]=y.useState(!1),{onFocus:u,onBlur:h,onMouseEnter:f,onMouseLeave:p,onTouchStart:g}=s,v=y.useRef(null);y.useEffect(()=>{if(t==="render"&&c(!0),t==="viewport"){let w=k=>{k.forEach(N=>{c(N.isIntersecting)})},E=new IntersectionObserver(w,{threshold:.5});return v.current&&E.observe(v.current),()=>{E.disconnect()}}},[t]),y.useEffect(()=>{if(r){let w=setTimeout(()=>{c(!0)},100);return()=>{clearTimeout(w)}}},[r]);let b=()=>{o(!0)},_=()=>{o(!1),c(!1)};return a?t!=="intent"?[l,v,{}]:[l,v,{onFocus:Kl(u,b),onBlur:Kl(h,_),onMouseEnter:Kl(f,b),onMouseLeave:Kl(p,_),onTouchStart:Kl(g,b)}]:[!1,v,{}]}function Kl(t,s){return a=>{t&&t(a),a.defaultPrevented||s(a)}}function t5({page:t,...s}){let{router:a}=$_(),r=y.useMemo(()=>C_(a.routes,t,a.basename),[a.routes,t,a.basename]);return r?y.createElement(a5,{page:t,matches:r,...s}):null}function s5(t){let{manifest:s,routeModules:a}=I_(),[r,o]=y.useState([]);return y.useEffect(()=>{let l=!1;return W4(t,s,a).then(c=>{l||o(c)}),()=>{l=!0}},[t,s,a]),r}function a5({page:t,matches:s,...a}){let r=kr(),{manifest:o,routeModules:l}=I_(),{basename:c}=$_(),{loaderData:u,matches:h}=J4(),f=y.useMemo(()=>Vv(t,s,h,o,r,"data"),[t,s,h,o,r]),p=y.useMemo(()=>Vv(t,s,h,o,r,"assets"),[t,s,h,o,r]),g=y.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let _=new Set,w=!1;if(s.forEach(k=>{var C;let N=o.routes[k.route.id];!N||!N.hasLoader||(!f.some(S=>S.route.id===k.route.id)&&k.route.id in u&&((C=l[k.route.id])!=null&&C.shouldRevalidate)||N.hasClientLoader?w=!0:_.add(k.route.id))}),_.size===0)return[];let E=H4(t,c,"data");return w&&_.size>0&&E.searchParams.set("_routes",s.filter(k=>_.has(k.route.id)).map(k=>k.route.id).join(",")),[E.pathname+E.search]},[c,u,r,o,f,s,t,l]),v=y.useMemo(()=>Y4(p,o),[p,o]),b=s5(p);return y.createElement(y.Fragment,null,g.map(_=>y.createElement("link",{key:_,rel:"prefetch",as:"fetch",href:_,...a})),v.map(_=>y.createElement("link",{key:_,rel:"modulepreload",href:_,...a})),b.map(({key:_,link:w})=>y.createElement("link",{key:_,nonce:a.nonce,...w})))}function r5(...t){return s=>{t.forEach(a=>{typeof a=="function"?a(s):a!=null&&(a.current=s)})}}var L_=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{L_&&(window.__reactRouterVersion="7.8.2")}catch{}function n5({basename:t,children:s,window:a}){let r=y.useRef();r.current==null&&(r.current=HC({window:a,v5Compat:!0}));let o=r.current,[l,c]=y.useState({action:o.action,location:o.location}),u=y.useCallback(h=>{y.startTransition(()=>c(h))},[c]);return y.useLayoutEffect(()=>o.listen(u),[o,u]),y.createElement(z4,{basename:t,children:s,location:l.location,navigationType:l.action,navigator:o})}var U_=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,fs=y.forwardRef(function({onClick:s,discover:a="render",prefetch:r="none",relative:o,reloadDocument:l,replace:c,state:u,target:h,to:f,preventScrollReset:p,viewTransition:g,...v},b){let{basename:_}=y.useContext(Ca),w=typeof f=="string"&&U_.test(f),E,k=!1;if(typeof f=="string"&&w&&(E=f,L_))try{let z=new URL(window.location.href),R=f.startsWith("//")?new URL(z.protocol+f):new URL(f),L=Sr(R.pathname,_);R.origin===z.origin&&L!=null?f=L+R.search+R.hash:k=!0}catch{Na(!1,`<Link to="${f}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let N=y4(f,{relative:o}),[C,S,T]=e5(r,v),M=l5(f,{replace:c,state:u,target:h,preventScrollReset:p,relative:o,viewTransition:g});function $(z){s&&s(z),z.defaultPrevented||M(z)}let A=y.createElement("a",{...v,...T,href:E||N,onClick:k||l?s:$,ref:r5(b,S),target:h,"data-discover":!w&&a==="render"?"true":void 0});return C&&!w?y.createElement(y.Fragment,null,A,y.createElement(t5,{page:N})):A});fs.displayName="Link";var Ap=y.forwardRef(function({"aria-current":s="page",caseSensitive:a=!1,className:r="",end:o=!1,style:l,to:c,viewTransition:u,children:h,...f},p){let g=$c(c,{relative:f.relative}),v=kr(),b=y.useContext(cm),{navigator:_,basename:w}=y.useContext(Ca),E=b!=null&&h5(g)&&u===!0,k=_.encodeLocation?_.encodeLocation(g).pathname:g.pathname,N=v.pathname,C=b&&b.navigation&&b.navigation.location?b.navigation.location.pathname:null;a||(N=N.toLowerCase(),C=C?C.toLowerCase():null,k=k.toLowerCase()),C&&w&&(C=Sr(C,w)||C);const S=k!=="/"&&k.endsWith("/")?k.length-1:k.length;let T=N===k||!o&&N.startsWith(k)&&N.charAt(S)==="/",M=C!=null&&(C===k||!o&&C.startsWith(k)&&C.charAt(k.length)==="/"),$={isActive:T,isPending:M,isTransitioning:E},A=T?s:void 0,z;typeof r=="function"?z=r($):z=[r,T?"active":null,M?"pending":null,E?"transitioning":null].filter(Boolean).join(" ");let R=typeof l=="function"?l($):l;return y.createElement(fs,{...f,"aria-current":A,className:z,ref:p,style:R,to:c,viewTransition:u},typeof h=="function"?h($):h)});Ap.displayName="NavLink";var o5=y.forwardRef(({discover:t="render",fetcherKey:s,navigate:a,reloadDocument:r,replace:o,state:l,method:c=ju,action:u,onSubmit:h,relative:f,preventScrollReset:p,viewTransition:g,...v},b)=>{let _=u5(),w=m5(u,{relative:f}),E=c.toLowerCase()==="get"?"get":"post",k=typeof u=="string"&&U_.test(u),N=C=>{if(h&&h(C),C.defaultPrevented)return;C.preventDefault();let S=C.nativeEvent.submitter,T=(S==null?void 0:S.getAttribute("formmethod"))||c;_(S||C.currentTarget,{fetcherKey:s,method:T,navigate:a,replace:o,state:l,relative:f,preventScrollReset:p,viewTransition:g})};return y.createElement("form",{ref:b,method:E,action:w,onSubmit:r?h:N,...v,"data-discover":!k&&t==="render"?"true":void 0})});o5.displayName="Form";function i5(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function B_(t){let s=y.useContext(Vi);return Mt(s,i5(t)),s}function l5(t,{target:s,replace:a,state:r,preventScrollReset:o,relative:l,viewTransition:c}={}){let u=Xs(),h=kr(),f=$c(t,{relative:l});return y.useCallback(p=>{if(B4(p,s)){p.preventDefault();let g=a!==void 0?a:bc(h)===bc(f);u(t,{replace:g,state:r,preventScrollReset:o,relative:l,viewTransition:c})}},[h,u,f,a,r,s,t,o,l,c])}var c5=0,d5=()=>`__${String(++c5)}__`;function u5(){let{router:t}=B_("useSubmit"),{basename:s}=y.useContext(Ca),a=M4();return y.useCallback(async(r,o={})=>{let{action:l,method:c,encType:u,formData:h,body:f}=F4(r,s);if(o.navigate===!1){let p=o.fetcherKey||d5();await t.fetch(p,a,o.action||l,{preventScrollReset:o.preventScrollReset,formData:h,body:f,formMethod:o.method||c,formEncType:o.encType||u,flushSync:o.flushSync})}else await t.navigate(o.action||l,{preventScrollReset:o.preventScrollReset,formData:h,body:f,formMethod:o.method||c,formEncType:o.encType||u,replace:o.replace,state:o.state,fromRouteId:a,flushSync:o.flushSync,viewTransition:o.viewTransition})},[t,s,a])}function m5(t,{relative:s}={}){let{basename:a}=y.useContext(Ca),r=y.useContext(Ta);Mt(r,"useFormAction must be used inside a RouteContext");let[o]=r.matches.slice(-1),l={...$c(t||".",{relative:s})},c=kr();if(t==null){l.search=c.search;let u=new URLSearchParams(l.search),h=u.getAll("index");if(h.some(p=>p==="")){u.delete("index"),h.filter(g=>g).forEach(g=>u.append("index",g));let p=u.toString();l.search=p?`?${p}`:""}}return(!t||t===".")&&o.route.index&&(l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index"),a!=="/"&&(l.pathname=l.pathname==="/"?a:wr([a,l.pathname])),bc(l)}function h5(t,{relative:s}={}){let a=y.useContext(M_);Mt(a!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=B_("useViewTransitionState"),o=$c(t,{relative:s});if(!a.isTransitioning)return!1;let l=Sr(a.currentLocation.pathname,r)||a.currentLocation.pathname,c=Sr(a.nextLocation.pathname,r)||a.nextLocation.pathname;return Du(o.pathname,c)!=null||Du(o.pathname,l)!=null}const f5="modulepreload",p5=function(t){return"/"+t},qv={},ha=function(s,a,r){let o=Promise.resolve();if(a&&a.length>0){let c=function(f){return Promise.all(f.map(p=>Promise.resolve(p).then(g=>({status:"fulfilled",value:g}),g=>({status:"rejected",reason:g}))))};document.getElementsByTagName("link");const u=document.querySelector("meta[property=csp-nonce]"),h=(u==null?void 0:u.nonce)||(u==null?void 0:u.getAttribute("nonce"));o=c(a.map(f=>{if(f=p5(f),f in qv)return;qv[f]=!0;const p=f.endsWith(".css"),g=p?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${f}"]${g}`))return;const v=document.createElement("link");if(v.rel=p?"stylesheet":f5,p||(v.as="script"),v.crossOrigin="",v.href=f,h&&v.setAttribute("nonce",h),document.head.appendChild(v),p)return new Promise((b,_)=>{v.addEventListener("load",b),v.addEventListener("error",()=>_(new Error(`Unable to preload CSS for ${f}`)))})}))}function l(c){const u=new Event("vite:preloadError",{cancelable:!0});if(u.payload=c,window.dispatchEvent(u),!u.defaultPrevented)throw c}return o.then(c=>{for(const u of c||[])u.status==="rejected"&&l(u.reason);return s().catch(l)})},g5=t=>{let s;return t?s=t:typeof fetch>"u"?s=(...a)=>ha(async()=>{const{default:r}=await Promise.resolve().then(()=>Fi);return{default:r}},[]).then(({default:r})=>r(...a)):s=fetch,(...a)=>s(...a)};class um extends Error{constructor(s,a="FunctionsError",r){super(s),this.name=a,this.context=r}}class V_ extends um{constructor(s){super("Failed to send a request to the Edge Function","FunctionsFetchError",s)}}class Mp extends um{constructor(s){super("Relay Error invoking the Edge Function","FunctionsRelayError",s)}}class Rp extends um{constructor(s){super("Edge Function returned a non-2xx status code","FunctionsHttpError",s)}}var Pu;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Pu||(Pu={}));var x5=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};class y5{constructor(s,{headers:a={},customFetch:r,region:o=Pu.Any}={}){this.url=s,this.headers=a,this.region=o,this.fetch=g5(r)}setAuth(s){this.headers.Authorization=`Bearer ${s}`}invoke(s,a={}){var r;return x5(this,void 0,void 0,function*(){try{const{headers:o,method:l,body:c}=a;let u={},{region:h}=a;h||(h=this.region);const f=new URL(`${this.url}/${s}`);h&&h!=="any"&&(u["x-region"]=h,f.searchParams.set("forceFunctionRegion",h));let p;c&&(o&&!Object.prototype.hasOwnProperty.call(o,"Content-Type")||!o)&&(typeof Blob<"u"&&c instanceof Blob||c instanceof ArrayBuffer?(u["Content-Type"]="application/octet-stream",p=c):typeof c=="string"?(u["Content-Type"]="text/plain",p=c):typeof FormData<"u"&&c instanceof FormData?p=c:(u["Content-Type"]="application/json",p=JSON.stringify(c)));const g=yield this.fetch(f.toString(),{method:l||"POST",headers:Object.assign(Object.assign(Object.assign({},u),this.headers),o),body:p}).catch(w=>{throw new V_(w)}),v=g.headers.get("x-relay-error");if(v&&v==="true")throw new Mp(g);if(!g.ok)throw new Rp(g);let b=((r=g.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),_;return b==="application/json"?_=yield g.json():b==="application/octet-stream"?_=yield g.blob():b==="text/event-stream"?_=g:b==="multipart/form-data"?_=yield g.formData():_=yield g.text(),{data:_,error:null,response:g}}catch(o){return{data:null,error:o,response:o instanceof Rp||o instanceof Mp?o.context:void 0}}})}}var hs={},si={},ai={},ri={},ni={},oi={},b5=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Oi=b5();const v5=Oi.fetch,q_=Oi.fetch.bind(Oi),F_=Oi.Headers,w5=Oi.Request,j5=Oi.Response,Fi=Object.freeze(Object.defineProperty({__proto__:null,Headers:F_,Request:w5,Response:j5,default:q_,fetch:v5},Symbol.toStringTag,{value:"Module"})),_5=DC(Fi);var nu={},Fv;function H_(){if(Fv)return nu;Fv=1,Object.defineProperty(nu,"__esModule",{value:!0});class t extends Error{constructor(a){super(a.message),this.name="PostgrestError",this.details=a.details,this.hint=a.hint,this.code=a.code}}return nu.default=t,nu}var Hv;function G_(){if(Hv)return oi;Hv=1;var t=oi&&oi.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(oi,"__esModule",{value:!0});const s=t(_5),a=t(H_());class r{constructor(l){var c,u;this.shouldThrowOnError=!1,this.method=l.method,this.url=l.url,this.headers=new Headers(l.headers),this.schema=l.schema,this.body=l.body,this.shouldThrowOnError=(c=l.shouldThrowOnError)!==null&&c!==void 0?c:!1,this.signal=l.signal,this.isMaybeSingle=(u=l.isMaybeSingle)!==null&&u!==void 0?u:!1,l.fetch?this.fetch=l.fetch:typeof fetch>"u"?this.fetch=s.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(l,c){return this.headers=new Headers(this.headers),this.headers.set(l,c),this}then(l,c){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers.set("Accept-Profile",this.schema):this.headers.set("Content-Profile",this.schema)),this.method!=="GET"&&this.method!=="HEAD"&&this.headers.set("Content-Type","application/json");const u=this.fetch;let h=u(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async f=>{var p,g,v,b;let _=null,w=null,E=null,k=f.status,N=f.statusText;if(f.ok){if(this.method!=="HEAD"){const M=await f.text();M===""||(this.headers.get("Accept")==="text/csv"||this.headers.get("Accept")&&(!((p=this.headers.get("Accept"))===null||p===void 0)&&p.includes("application/vnd.pgrst.plan+text"))?w=M:w=JSON.parse(M))}const S=(g=this.headers.get("Prefer"))===null||g===void 0?void 0:g.match(/count=(exact|planned|estimated)/),T=(v=f.headers.get("content-range"))===null||v===void 0?void 0:v.split("/");S&&T&&T.length>1&&(E=parseInt(T[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(w)&&(w.length>1?(_={code:"PGRST116",details:`Results contain ${w.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},w=null,E=null,k=406,N="Not Acceptable"):w.length===1?w=w[0]:w=null)}else{const S=await f.text();try{_=JSON.parse(S),Array.isArray(_)&&f.status===404&&(w=[],_=null,k=200,N="OK")}catch{f.status===404&&S===""?(k=204,N="No Content"):_={message:S}}if(_&&this.isMaybeSingle&&(!((b=_==null?void 0:_.details)===null||b===void 0)&&b.includes("0 rows"))&&(_=null,k=200,N="OK"),_&&this.shouldThrowOnError)throw new a.default(_)}return{error:_,data:w,count:E,status:k,statusText:N}});return this.shouldThrowOnError||(h=h.catch(f=>{var p,g,v;return{error:{message:`${(p=f==null?void 0:f.name)!==null&&p!==void 0?p:"FetchError"}: ${f==null?void 0:f.message}`,details:`${(g=f==null?void 0:f.stack)!==null&&g!==void 0?g:""}`,hint:"",code:`${(v=f==null?void 0:f.code)!==null&&v!==void 0?v:""}`},data:null,count:null,status:0,statusText:""}})),h.then(l,c)}returns(){return this}overrideTypes(){return this}}return oi.default=r,oi}var Gv;function Z_(){if(Gv)return ni;Gv=1;var t=ni&&ni.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ni,"__esModule",{value:!0});const s=t(G_());class a extends s.default{select(o){let l=!1;const c=(o??"*").split("").map(u=>/\s/.test(u)&&!l?"":(u==='"'&&(l=!l),u)).join("");return this.url.searchParams.set("select",c),this.headers.append("Prefer","return=representation"),this}order(o,{ascending:l=!0,nullsFirst:c,foreignTable:u,referencedTable:h=u}={}){const f=h?`${h}.order`:"order",p=this.url.searchParams.get(f);return this.url.searchParams.set(f,`${p?`${p},`:""}${o}.${l?"asc":"desc"}${c===void 0?"":c?".nullsfirst":".nullslast"}`),this}limit(o,{foreignTable:l,referencedTable:c=l}={}){const u=typeof c>"u"?"limit":`${c}.limit`;return this.url.searchParams.set(u,`${o}`),this}range(o,l,{foreignTable:c,referencedTable:u=c}={}){const h=typeof u>"u"?"offset":`${u}.offset`,f=typeof u>"u"?"limit":`${u}.limit`;return this.url.searchParams.set(h,`${o}`),this.url.searchParams.set(f,`${l-o+1}`),this}abortSignal(o){return this.signal=o,this}single(){return this.headers.set("Accept","application/vnd.pgrst.object+json"),this}maybeSingle(){return this.method==="GET"?this.headers.set("Accept","application/json"):this.headers.set("Accept","application/vnd.pgrst.object+json"),this.isMaybeSingle=!0,this}csv(){return this.headers.set("Accept","text/csv"),this}geojson(){return this.headers.set("Accept","application/geo+json"),this}explain({analyze:o=!1,verbose:l=!1,settings:c=!1,buffers:u=!1,wal:h=!1,format:f="text"}={}){var p;const g=[o?"analyze":null,l?"verbose":null,c?"settings":null,u?"buffers":null,h?"wal":null].filter(Boolean).join("|"),v=(p=this.headers.get("Accept"))!==null&&p!==void 0?p:"application/json";return this.headers.set("Accept",`application/vnd.pgrst.plan+${f}; for="${v}"; options=${g};`),f==="json"?this:this}rollback(){return this.headers.append("Prefer","tx=rollback"),this}returns(){return this}maxAffected(o){return this.headers.append("Prefer","handling=strict"),this.headers.append("Prefer",`max-affected=${o}`),this}}return ni.default=a,ni}var Zv;function P0(){if(Zv)return ri;Zv=1;var t=ri&&ri.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ri,"__esModule",{value:!0});const s=t(Z_());class a extends s.default{eq(o,l){return this.url.searchParams.append(o,`eq.${l}`),this}neq(o,l){return this.url.searchParams.append(o,`neq.${l}`),this}gt(o,l){return this.url.searchParams.append(o,`gt.${l}`),this}gte(o,l){return this.url.searchParams.append(o,`gte.${l}`),this}lt(o,l){return this.url.searchParams.append(o,`lt.${l}`),this}lte(o,l){return this.url.searchParams.append(o,`lte.${l}`),this}like(o,l){return this.url.searchParams.append(o,`like.${l}`),this}likeAllOf(o,l){return this.url.searchParams.append(o,`like(all).{${l.join(",")}}`),this}likeAnyOf(o,l){return this.url.searchParams.append(o,`like(any).{${l.join(",")}}`),this}ilike(o,l){return this.url.searchParams.append(o,`ilike.${l}`),this}ilikeAllOf(o,l){return this.url.searchParams.append(o,`ilike(all).{${l.join(",")}}`),this}ilikeAnyOf(o,l){return this.url.searchParams.append(o,`ilike(any).{${l.join(",")}}`),this}is(o,l){return this.url.searchParams.append(o,`is.${l}`),this}in(o,l){const c=Array.from(new Set(l)).map(u=>typeof u=="string"&&new RegExp("[,()]").test(u)?`"${u}"`:`${u}`).join(",");return this.url.searchParams.append(o,`in.(${c})`),this}contains(o,l){return typeof l=="string"?this.url.searchParams.append(o,`cs.${l}`):Array.isArray(l)?this.url.searchParams.append(o,`cs.{${l.join(",")}}`):this.url.searchParams.append(o,`cs.${JSON.stringify(l)}`),this}containedBy(o,l){return typeof l=="string"?this.url.searchParams.append(o,`cd.${l}`):Array.isArray(l)?this.url.searchParams.append(o,`cd.{${l.join(",")}}`):this.url.searchParams.append(o,`cd.${JSON.stringify(l)}`),this}rangeGt(o,l){return this.url.searchParams.append(o,`sr.${l}`),this}rangeGte(o,l){return this.url.searchParams.append(o,`nxl.${l}`),this}rangeLt(o,l){return this.url.searchParams.append(o,`sl.${l}`),this}rangeLte(o,l){return this.url.searchParams.append(o,`nxr.${l}`),this}rangeAdjacent(o,l){return this.url.searchParams.append(o,`adj.${l}`),this}overlaps(o,l){return typeof l=="string"?this.url.searchParams.append(o,`ov.${l}`):this.url.searchParams.append(o,`ov.{${l.join(",")}}`),this}textSearch(o,l,{config:c,type:u}={}){let h="";u==="plain"?h="pl":u==="phrase"?h="ph":u==="websearch"&&(h="w");const f=c===void 0?"":`(${c})`;return this.url.searchParams.append(o,`${h}fts${f}.${l}`),this}match(o){return Object.entries(o).forEach(([l,c])=>{this.url.searchParams.append(l,`eq.${c}`)}),this}not(o,l,c){return this.url.searchParams.append(o,`not.${l}.${c}`),this}or(o,{foreignTable:l,referencedTable:c=l}={}){const u=c?`${c}.or`:"or";return this.url.searchParams.append(u,`(${o})`),this}filter(o,l,c){return this.url.searchParams.append(o,`${l}.${c}`),this}}return ri.default=a,ri}var Wv;function W_(){if(Wv)return ai;Wv=1;var t=ai&&ai.__importDefault||function(r){return r&&r.__esModule?r:{default:r}};Object.defineProperty(ai,"__esModule",{value:!0});const s=t(P0());class a{constructor(o,{headers:l={},schema:c,fetch:u}){this.url=o,this.headers=new Headers(l),this.schema=c,this.fetch=u}select(o,{head:l=!1,count:c}={}){const u=l?"HEAD":"GET";let h=!1;const f=(o??"*").split("").map(p=>/\s/.test(p)&&!h?"":(p==='"'&&(h=!h),p)).join("");return this.url.searchParams.set("select",f),c&&this.headers.append("Prefer",`count=${c}`),new s.default({method:u,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch})}insert(o,{count:l,defaultToNull:c=!0}={}){var u;const h="POST";if(l&&this.headers.append("Prefer",`count=${l}`),c||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const f=o.reduce((p,g)=>p.concat(Object.keys(g)),[]);if(f.length>0){const p=[...new Set(f)].map(g=>`"${g}"`);this.url.searchParams.set("columns",p.join(","))}}return new s.default({method:h,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(u=this.fetch)!==null&&u!==void 0?u:fetch})}upsert(o,{onConflict:l,ignoreDuplicates:c=!1,count:u,defaultToNull:h=!0}={}){var f;const p="POST";if(this.headers.append("Prefer",`resolution=${c?"ignore":"merge"}-duplicates`),l!==void 0&&this.url.searchParams.set("on_conflict",l),u&&this.headers.append("Prefer",`count=${u}`),h||this.headers.append("Prefer","missing=default"),Array.isArray(o)){const g=o.reduce((v,b)=>v.concat(Object.keys(b)),[]);if(g.length>0){const v=[...new Set(g)].map(b=>`"${b}"`);this.url.searchParams.set("columns",v.join(","))}}return new s.default({method:p,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(f=this.fetch)!==null&&f!==void 0?f:fetch})}update(o,{count:l}={}){var c;const u="PATCH";return l&&this.headers.append("Prefer",`count=${l}`),new s.default({method:u,url:this.url,headers:this.headers,schema:this.schema,body:o,fetch:(c=this.fetch)!==null&&c!==void 0?c:fetch})}delete({count:o}={}){var l;const c="DELETE";return o&&this.headers.append("Prefer",`count=${o}`),new s.default({method:c,url:this.url,headers:this.headers,schema:this.schema,fetch:(l=this.fetch)!==null&&l!==void 0?l:fetch})}}return ai.default=a,ai}var Yv;function N5(){if(Yv)return si;Yv=1;var t=si&&si.__importDefault||function(o){return o&&o.__esModule?o:{default:o}};Object.defineProperty(si,"__esModule",{value:!0});const s=t(W_()),a=t(P0());class r{constructor(l,{headers:c={},schema:u,fetch:h}={}){this.url=l,this.headers=new Headers(c),this.schemaName=u,this.fetch=h}from(l){const c=new URL(`${this.url}/${l}`);return new s.default(c,{headers:new Headers(this.headers),schema:this.schemaName,fetch:this.fetch})}schema(l){return new r(this.url,{headers:this.headers,schema:l,fetch:this.fetch})}rpc(l,c={},{head:u=!1,get:h=!1,count:f}={}){var p;let g;const v=new URL(`${this.url}/rpc/${l}`);let b;u||h?(g=u?"HEAD":"GET",Object.entries(c).filter(([w,E])=>E!==void 0).map(([w,E])=>[w,Array.isArray(E)?`{${E.join(",")}}`:`${E}`]).forEach(([w,E])=>{v.searchParams.append(w,E)})):(g="POST",b=c);const _=new Headers(this.headers);return f&&_.set("Prefer",`count=${f}`),new a.default({method:g,url:v,headers:_,schema:this.schemaName,body:b,fetch:(p=this.fetch)!==null&&p!==void 0?p:fetch})}}return si.default=r,si}var Kv;function S5(){if(Kv)return hs;Kv=1;var t=hs&&hs.__importDefault||function(u){return u&&u.__esModule?u:{default:u}};Object.defineProperty(hs,"__esModule",{value:!0}),hs.PostgrestError=hs.PostgrestBuilder=hs.PostgrestTransformBuilder=hs.PostgrestFilterBuilder=hs.PostgrestQueryBuilder=hs.PostgrestClient=void 0;const s=t(N5());hs.PostgrestClient=s.default;const a=t(W_());hs.PostgrestQueryBuilder=a.default;const r=t(P0());hs.PostgrestFilterBuilder=r.default;const o=t(Z_());hs.PostgrestTransformBuilder=o.default;const l=t(G_());hs.PostgrestBuilder=l.default;const c=t(H_());return hs.PostgrestError=c.default,hs.default={PostgrestClient:s.default,PostgrestQueryBuilder:a.default,PostgrestFilterBuilder:r.default,PostgrestTransformBuilder:o.default,PostgrestBuilder:l.default,PostgrestError:c.default},hs}var E5=S5();const C5=E_(E5),{PostgrestClient:T5,PostgrestQueryBuilder:LB,PostgrestFilterBuilder:UB,PostgrestTransformBuilder:BB,PostgrestBuilder:VB,PostgrestError:k5}=C5;class Y_{static detectEnvironment(){var s;if(typeof WebSocket<"u")return{type:"native",constructor:WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocket<"u")return{type:"native",constructor:globalThis.WebSocket};if(typeof global<"u"&&typeof global.WebSocket<"u")return{type:"native",constructor:global.WebSocket};if(typeof globalThis<"u"&&typeof globalThis.WebSocketPair<"u"&&typeof globalThis.WebSocket>"u")return{type:"cloudflare",error:"Cloudflare Workers detected. WebSocket clients are not supported in Cloudflare Workers.",workaround:"Use Cloudflare Workers WebSocket API for server-side WebSocket handling, or deploy to a different runtime."};if(typeof globalThis<"u"&&globalThis.EdgeRuntime||typeof navigator<"u"&&(!((s=navigator.userAgent)===null||s===void 0)&&s.includes("Vercel-Edge")))return{type:"unsupported",error:"Edge runtime detected (Vercel Edge/Netlify Edge). WebSockets are not supported in edge functions.",workaround:"Use serverless functions or a different deployment target for WebSocket functionality."};if(typeof process<"u"&&process.versions&&process.versions.node){const a=parseInt(process.versions.node.split(".")[0]);return a>=22?typeof globalThis.WebSocket<"u"?{type:"native",constructor:globalThis.WebSocket}:{type:"unsupported",error:`Node.js ${a} detected but native WebSocket not found.`,workaround:"Provide a WebSocket implementation via the transport option."}:{type:"unsupported",error:`Node.js ${a} detected without native WebSocket support.`,workaround:`For Node.js < 22, install "ws" package and provide it via the transport option:
import ws from "ws"
new RealtimeClient(url, { transport: ws })`}}return{type:"unsupported",error:"Unknown JavaScript runtime without WebSocket support.",workaround:"Ensure you're running in a supported environment (browser, Node.js, Deno) or provide a custom WebSocket implementation."}}static getWebSocketConstructor(){const s=this.detectEnvironment();if(s.constructor)return s.constructor;let a=s.error||"WebSocket not supported in this environment.";throw s.workaround&&(a+=`

Suggested solution: ${s.workaround}`),new Error(a)}static createWebSocket(s,a){const r=this.getWebSocketConstructor();return new r(s,a)}static isWebSocketSupported(){try{const s=this.detectEnvironment();return s.type==="native"||s.type==="ws"}catch{return!1}}}const A5="2.15.4",M5=`realtime-js/${A5}`,R5="1.0.0",Op=1e4,O5=1e3,D5=100;var ic;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(ic||(ic={}));var ns;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(ns||(ns={}));var wa;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(wa||(wa={}));var Dp;(function(t){t.websocket="websocket"})(Dp||(Dp={}));var Hn;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(Hn||(Hn={}));class P5{constructor(){this.HEADER_LENGTH=1}decode(s,a){return s.constructor===ArrayBuffer?a(this._binaryDecode(s)):a(typeof s=="string"?JSON.parse(s):{})}_binaryDecode(s){const a=new DataView(s),r=new TextDecoder;return this._decodeBroadcast(s,a,r)}_decodeBroadcast(s,a,r){const o=a.getUint8(1),l=a.getUint8(2);let c=this.HEADER_LENGTH+2;const u=r.decode(s.slice(c,c+o));c=c+o;const h=r.decode(s.slice(c,c+l));c=c+l;const f=JSON.parse(r.decode(s.slice(c,s.byteLength)));return{ref:null,topic:u,event:h,payload:f}}}let K_=class{constructor(s,a){this.callback=s,this.timerCalc=a,this.timer=void 0,this.tries=0,this.callback=s,this.timerCalc=a}reset(){this.tries=0,clearTimeout(this.timer),this.timer=void 0}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}};var Nt;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Nt||(Nt={}));const Xv=(t,s,a={})=>{var r;const o=(r=a.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(s).reduce((l,c)=>(l[c]=z5(c,t,s,o),l),{})},z5=(t,s,a,r)=>{const o=s.find(u=>u.name===t),l=o==null?void 0:o.type,c=a[t];return l&&!r.includes(l)?X_(l,c):Pp(c)},X_=(t,s)=>{if(t.charAt(0)==="_"){const a=t.slice(1,t.length);return U5(s,a)}switch(t){case Nt.bool:return $5(s);case Nt.float4:case Nt.float8:case Nt.int2:case Nt.int4:case Nt.int8:case Nt.numeric:case Nt.oid:return I5(s);case Nt.json:case Nt.jsonb:return L5(s);case Nt.timestamp:return B5(s);case Nt.abstime:case Nt.date:case Nt.daterange:case Nt.int4range:case Nt.int8range:case Nt.money:case Nt.reltime:case Nt.text:case Nt.time:case Nt.timestamptz:case Nt.timetz:case Nt.tsrange:case Nt.tstzrange:return Pp(s);default:return Pp(s)}},Pp=t=>t,$5=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},I5=t=>{if(typeof t=="string"){const s=parseFloat(t);if(!Number.isNaN(s))return s}return t},L5=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(s){return console.log(`JSON parse error: ${s}`),t}return t},U5=(t,s)=>{if(typeof t!="string")return t;const a=t.length-1,r=t[a];if(t[0]==="{"&&r==="}"){let l;const c=t.slice(1,a);try{l=JSON.parse("["+c+"]")}catch{l=c?c.split(","):[]}return l.map(u=>X_(s,u))}return t},B5=t=>typeof t=="string"?t.replace(" ","T"):t,Q_=t=>{let s=t;return s=s.replace(/^ws/i,"http"),s=s.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),s.replace(/\/+$/,"")+"/api/broadcast"};class Qf{constructor(s,a,r={},o=Op){this.channel=s,this.event=a,this.payload=r,this.timeout=o,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(s){this.timeout=s,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(s){this.payload=Object.assign(Object.assign({},this.payload),s)}receive(s,a){var r;return this._hasReceived(s)&&a((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:s,callback:a}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const s=a=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=a,this._matchReceive(a)};this.channel._on(this.refEvent,{},s),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(s,a){this.refEvent&&this.channel._trigger(this.refEvent,{status:s,response:a})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:s,response:a}){this.recHooks.filter(r=>r.status===s).forEach(r=>r.callback(a))}_hasReceived(s){return this.receivedResp&&this.receivedResp.status===s}}var zp;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(zp||(zp={}));class Ei{constructor(s,a){this.channel=s,this.state={},this.pendingDiffs=[],this.joinRef=null,this.enabled=!1,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=(a==null?void 0:a.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},o=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Ei.syncState(this.state,o,l,c),this.pendingDiffs.forEach(h=>{this.state=Ei.syncDiff(this.state,h,l,c)}),this.pendingDiffs=[],u()}),this.channel._on(r.diff,{},o=>{const{onJoin:l,onLeave:c,onSync:u}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(o):(this.state=Ei.syncDiff(this.state,o,l,c),u())}),this.onJoin((o,l,c)=>{this.channel._trigger("presence",{event:"join",key:o,currentPresences:l,newPresences:c})}),this.onLeave((o,l,c)=>{this.channel._trigger("presence",{event:"leave",key:o,currentPresences:l,leftPresences:c})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(s,a,r,o){const l=this.cloneDeep(s),c=this.transformState(a),u={},h={};return this.map(l,(f,p)=>{c[f]||(h[f]=p)}),this.map(c,(f,p)=>{const g=l[f];if(g){const v=p.map(E=>E.presence_ref),b=g.map(E=>E.presence_ref),_=p.filter(E=>b.indexOf(E.presence_ref)<0),w=g.filter(E=>v.indexOf(E.presence_ref)<0);_.length>0&&(u[f]=_),w.length>0&&(h[f]=w)}else u[f]=p}),this.syncDiff(l,{joins:u,leaves:h},r,o)}static syncDiff(s,a,r,o){const{joins:l,leaves:c}={joins:this.transformState(a.joins),leaves:this.transformState(a.leaves)};return r||(r=()=>{}),o||(o=()=>{}),this.map(l,(u,h)=>{var f;const p=(f=s[u])!==null&&f!==void 0?f:[];if(s[u]=this.cloneDeep(h),p.length>0){const g=s[u].map(b=>b.presence_ref),v=p.filter(b=>g.indexOf(b.presence_ref)<0);s[u].unshift(...v)}r(u,p,h)}),this.map(c,(u,h)=>{let f=s[u];if(!f)return;const p=h.map(g=>g.presence_ref);f=f.filter(g=>p.indexOf(g.presence_ref)<0),s[u]=f,o(u,f,h),f.length===0&&delete s[u]}),s}static map(s,a){return Object.getOwnPropertyNames(s).map(r=>a(r,s[r]))}static transformState(s){return s=this.cloneDeep(s),Object.getOwnPropertyNames(s).reduce((a,r)=>{const o=s[r];return"metas"in o?a[r]=o.metas.map(l=>(l.presence_ref=l.phx_ref,delete l.phx_ref,delete l.phx_ref_prev,l)):a[r]=o,a},{})}static cloneDeep(s){return JSON.parse(JSON.stringify(s))}onJoin(s){this.caller.onJoin=s}onLeave(s){this.caller.onLeave=s}onSync(s){this.caller.onSync=s}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var $p;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})($p||($p={}));var Ci;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(Ci||(Ci={}));var za;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(za||(za={}));class mm{constructor(s,a={config:{}},r){this.topic=s,this.params=a,this.socket=r,this.bindings={},this.state=ns.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=s.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:"",enabled:!1},private:!1},a.config),this.timeout=this.socket.timeout,this.joinPush=new Qf(this,wa.join,this.params,this.timeout),this.rejoinTimer=new K_(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=ns.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(o=>o.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=ns.closed,this.socket._remove(this)}),this._onError(o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ns.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=ns.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("error",o=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,o),this.state=ns.errored,this.rejoinTimer.scheduleTimeout())}),this._on(wa.reply,{},(o,l)=>{this._trigger(this._replyEventName(l),o)}),this.presence=new Ei(this),this.broadcastEndpointURL=Q_(this.socket.endPoint),this.private=this.params.config.private||!1}subscribe(s,a=this.timeout){var r,o,l;if(this.socket.isConnected()||this.socket.connect(),this.state==ns.closed){const{config:{broadcast:c,presence:u,private:h}}=this.params,f=(o=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(b=>b.filter))!==null&&o!==void 0?o:[],p=!!this.bindings[Ci.PRESENCE]&&this.bindings[Ci.PRESENCE].length>0||((l=this.params.config.presence)===null||l===void 0?void 0:l.enabled)===!0,g={},v={broadcast:c,presence:Object.assign(Object.assign({},u),{enabled:p}),postgres_changes:f,private:h};this.socket.accessTokenValue&&(g.access_token=this.socket.accessTokenValue),this._onError(b=>s==null?void 0:s(za.CHANNEL_ERROR,b)),this._onClose(()=>s==null?void 0:s(za.CLOSED)),this.updateJoinPayload(Object.assign({config:v},g)),this.joinedOnce=!0,this._rejoin(a),this.joinPush.receive("ok",async({postgres_changes:b})=>{var _;if(this.socket.setAuth(),b===void 0){s==null||s(za.SUBSCRIBED);return}else{const w=this.bindings.postgres_changes,E=(_=w==null?void 0:w.length)!==null&&_!==void 0?_:0,k=[];for(let N=0;N<E;N++){const C=w[N],{filter:{event:S,schema:T,table:M,filter:$}}=C,A=b&&b[N];if(A&&A.event===S&&A.schema===T&&A.table===M&&A.filter===$)k.push(Object.assign(Object.assign({},C),{id:A.id}));else{this.unsubscribe(),this.state=ns.errored,s==null||s(za.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=k,s&&s(za.SUBSCRIBED);return}}).receive("error",b=>{this.state=ns.errored,s==null||s(za.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(b).join(", ")||"error")))}).receive("timeout",()=>{s==null||s(za.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(s,a={}){return await this.send({type:"presence",event:"track",payload:s},a.timeout||this.timeout)}async untrack(s={}){return await this.send({type:"presence",event:"untrack"},s)}on(s,a,r){return this.state===ns.joined&&s===Ci.PRESENCE&&(this.socket.log("channel",`resubscribe to ${this.topic} due to change in presence callbacks on joined channel`),this.unsubscribe().then(()=>this.subscribe())),this._on(s,a,r)}async send(s,a={}){var r,o;if(!this._canPush()&&s.type==="broadcast"){const{event:l,payload:c}=s,h={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:l,payload:c,private:this.private}]})};try{const f=await this._fetchWithTimeout(this.broadcastEndpointURL,h,(r=a.timeout)!==null&&r!==void 0?r:this.timeout);return await((o=f.body)===null||o===void 0?void 0:o.cancel()),f.ok?"ok":"error"}catch(f){return f.name==="AbortError"?"timed out":"error"}}else return new Promise(l=>{var c,u,h;const f=this._push(s.type,s,a.timeout||this.timeout);s.type==="broadcast"&&!(!((h=(u=(c=this.params)===null||c===void 0?void 0:c.config)===null||u===void 0?void 0:u.broadcast)===null||h===void 0)&&h.ack)&&l("ok"),f.receive("ok",()=>l("ok")),f.receive("error",()=>l("error")),f.receive("timeout",()=>l("timed out"))})}updateJoinPayload(s){this.joinPush.updatePayload(s)}unsubscribe(s=this.timeout){this.state=ns.leaving;const a=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(wa.close,"leave",this._joinRef())};this.joinPush.destroy();let r=null;return new Promise(o=>{r=new Qf(this,wa.leave,{},s),r.receive("ok",()=>{a(),o("ok")}).receive("timeout",()=>{a(),o("timed out")}).receive("error",()=>{o("error")}),r.send(),this._canPush()||r.trigger("ok",{})}).finally(()=>{r==null||r.destroy()})}teardown(){this.pushBuffer.forEach(s=>s.destroy()),this.pushBuffer=[],this.rejoinTimer.reset(),this.joinPush.destroy(),this.state=ns.closed,this.bindings={}}async _fetchWithTimeout(s,a,r){const o=new AbortController,l=setTimeout(()=>o.abort(),r),c=await this.socket.fetch(s,Object.assign(Object.assign({},a),{signal:o.signal}));return clearTimeout(l),c}_push(s,a,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${s}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let o=new Qf(this,s,a,r);return this._canPush()?o.send():this._addToPushBuffer(o),o}_addToPushBuffer(s){if(s.startTimeout(),this.pushBuffer.push(s),this.pushBuffer.length>D5){const a=this.pushBuffer.shift();a&&(a.destroy(),this.socket.log("channel",`discarded push due to buffer overflow: ${a.event}`,a.payload))}}_onMessage(s,a,r){return a}_isMember(s){return this.topic===s}_joinRef(){return this.joinPush.ref}_trigger(s,a,r){var o,l;const c=s.toLocaleLowerCase(),{close:u,error:h,leave:f,join:p}=wa;if(r&&[u,h,f,p].indexOf(c)>=0&&r!==this._joinRef())return;let v=this._onMessage(c,a,r);if(a&&!v)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(c)?(o=this.bindings.postgres_changes)===null||o===void 0||o.filter(b=>{var _,w,E;return((_=b.filter)===null||_===void 0?void 0:_.event)==="*"||((E=(w=b.filter)===null||w===void 0?void 0:w.event)===null||E===void 0?void 0:E.toLocaleLowerCase())===c}).map(b=>b.callback(v,r)):(l=this.bindings[c])===null||l===void 0||l.filter(b=>{var _,w,E,k,N,C;if(["broadcast","presence","postgres_changes"].includes(c))if("id"in b){const S=b.id,T=(_=b.filter)===null||_===void 0?void 0:_.event;return S&&((w=a.ids)===null||w===void 0?void 0:w.includes(S))&&(T==="*"||(T==null?void 0:T.toLocaleLowerCase())===((E=a.data)===null||E===void 0?void 0:E.type.toLocaleLowerCase()))}else{const S=(N=(k=b==null?void 0:b.filter)===null||k===void 0?void 0:k.event)===null||N===void 0?void 0:N.toLocaleLowerCase();return S==="*"||S===((C=a==null?void 0:a.event)===null||C===void 0?void 0:C.toLocaleLowerCase())}else return b.type.toLocaleLowerCase()===c}).map(b=>{if(typeof v=="object"&&"ids"in v){const _=v.data,{schema:w,table:E,commit_timestamp:k,type:N,errors:C}=_;v=Object.assign(Object.assign({},{schema:w,table:E,commit_timestamp:k,eventType:N,new:{},old:{},errors:C}),this._getPayloadRecords(_))}b.callback(v,r)})}_isClosed(){return this.state===ns.closed}_isJoined(){return this.state===ns.joined}_isJoining(){return this.state===ns.joining}_isLeaving(){return this.state===ns.leaving}_replyEventName(s){return`chan_reply_${s}`}_on(s,a,r){const o=s.toLocaleLowerCase(),l={type:o,filter:a,callback:r};return this.bindings[o]?this.bindings[o].push(l):this.bindings[o]=[l],this}_off(s,a){const r=s.toLocaleLowerCase();return this.bindings[r]&&(this.bindings[r]=this.bindings[r].filter(o=>{var l;return!(((l=o.type)===null||l===void 0?void 0:l.toLocaleLowerCase())===r&&mm.isEqual(o.filter,a))})),this}static isEqual(s,a){if(Object.keys(s).length!==Object.keys(a).length)return!1;for(const r in s)if(s[r]!==a[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(s){this._on(wa.close,{},s)}_onError(s){this._on(wa.error,{},a=>s(a))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(s=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=ns.joining,this.joinPush.resend(s))}_getPayloadRecords(s){const a={new:{},old:{}};return(s.type==="INSERT"||s.type==="UPDATE")&&(a.new=Xv(s.columns,s.record)),(s.type==="UPDATE"||s.type==="DELETE")&&(a.old=Xv(s.columns,s.old_record)),a}}const Jf=()=>{},ou={HEARTBEAT_INTERVAL:25e3,RECONNECT_DELAY:10,HEARTBEAT_TIMEOUT_FALLBACK:100},V5=[1e3,2e3,5e3,1e4],q5=1e4,F5=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class J_{constructor(s,a){var r;if(this.accessTokenValue=null,this.apiKey=null,this.channels=new Array,this.endPoint="",this.httpEndpoint="",this.headers={},this.params={},this.timeout=Op,this.transport=null,this.heartbeatIntervalMs=ou.HEARTBEAT_INTERVAL,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.heartbeatCallback=Jf,this.ref=0,this.reconnectTimer=null,this.logger=Jf,this.conn=null,this.sendBuffer=[],this.serializer=new P5,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._connectionState="disconnected",this._wasManualDisconnect=!1,this._authPromise=null,this._resolveFetch=o=>{let l;return o?l=o:typeof fetch>"u"?l=(...c)=>ha(async()=>{const{default:u}=await Promise.resolve().then(()=>Fi);return{default:u}},void 0).then(({default:u})=>u(...c)).catch(u=>{throw new Error(`Failed to load @supabase/node-fetch: ${u.message}. This is required for HTTP requests in Node.js environments without native fetch.`)}):l=fetch,(...c)=>l(...c)},!(!((r=a==null?void 0:a.params)===null||r===void 0)&&r.apikey))throw new Error("API key is required to connect to Realtime");this.apiKey=a.params.apikey,this.endPoint=`${s}/${Dp.websocket}`,this.httpEndpoint=Q_(s),this._initializeOptions(a),this._setupReconnectionTimer(),this.fetch=this._resolveFetch(a==null?void 0:a.fetch)}connect(){if(!(this.isConnecting()||this.isDisconnecting()||this.conn!==null&&this.isConnected())){if(this._setConnectionState("connecting"),this._setAuthSafely("connect"),this.transport)this.conn=new this.transport(this.endpointURL());else try{this.conn=Y_.createWebSocket(this.endpointURL())}catch(s){this._setConnectionState("disconnected");const a=s.message;throw a.includes("Node.js")?new Error(`${a}

To use Realtime in Node.js, you need to provide a WebSocket implementation:

Option 1: Use Node.js 22+ which has native WebSocket support
Option 2: Install and provide the "ws" package:

  npm install ws

  import ws from "ws"
  const client = new RealtimeClient(url, {
    ...options,
    transport: ws
  })`):new Error(`WebSocket not available: ${a}`)}this._setupConnectionHandlers()}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:R5}))}disconnect(s,a){if(!this.isDisconnecting())if(this._setConnectionState("disconnecting",!0),this.conn){const r=setTimeout(()=>{this._setConnectionState("disconnected")},100);this.conn.onclose=()=>{clearTimeout(r),this._setConnectionState("disconnected")},s?this.conn.close(s,a??""):this.conn.close(),this._teardownConnection()}else this._setConnectionState("disconnected")}getChannels(){return this.channels}async removeChannel(s){const a=await s.unsubscribe();return this.channels.length===0&&this.disconnect(),a}async removeAllChannels(){const s=await Promise.all(this.channels.map(a=>a.unsubscribe()));return this.channels=[],this.disconnect(),s}log(s,a,r){this.logger(s,a,r)}connectionState(){switch(this.conn&&this.conn.readyState){case ic.connecting:return Hn.Connecting;case ic.open:return Hn.Open;case ic.closing:return Hn.Closing;default:return Hn.Closed}}isConnected(){return this.connectionState()===Hn.Open}isConnecting(){return this._connectionState==="connecting"}isDisconnecting(){return this._connectionState==="disconnecting"}channel(s,a={config:{}}){const r=`realtime:${s}`,o=this.getChannels().find(l=>l.topic===r);if(o)return o;{const l=new mm(`realtime:${s}`,a,this);return this.channels.push(l),l}}push(s){const{topic:a,event:r,payload:o,ref:l}=s,c=()=>{this.encode(s,u=>{var h;(h=this.conn)===null||h===void 0||h.send(u)})};this.log("push",`${a} ${r} (${l})`,o),this.isConnected()?c():this.sendBuffer.push(c)}async setAuth(s=null){this._authPromise=this._performAuth(s);try{await this._authPromise}finally{this._authPromise=null}}async sendHeartbeat(){var s;if(!this.isConnected()){try{this.heartbeatCallback("disconnected")}catch(a){this.log("error","error in heartbeat callback",a)}return}if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection");try{this.heartbeatCallback("timeout")}catch(a){this.log("error","error in heartbeat callback",a)}this._wasManualDisconnect=!1,(s=this.conn)===null||s===void 0||s.close(O5,"heartbeat timeout"),setTimeout(()=>{var a;this.isConnected()||(a=this.reconnectTimer)===null||a===void 0||a.scheduleTimeout()},ou.HEARTBEAT_TIMEOUT_FALLBACK);return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef});try{this.heartbeatCallback("sent")}catch(a){this.log("error","error in heartbeat callback",a)}this._setAuthSafely("heartbeat")}onHeartbeat(s){this.heartbeatCallback=s}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(s=>s()),this.sendBuffer=[])}_makeRef(){let s=this.ref+1;return s===this.ref?this.ref=0:this.ref=s,this.ref.toString()}_leaveOpenTopic(s){let a=this.channels.find(r=>r.topic===s&&(r._isJoined()||r._isJoining()));a&&(this.log("transport",`leaving duplicate topic "${s}"`),a.unsubscribe())}_remove(s){this.channels=this.channels.filter(a=>a.topic!==s.topic)}_onConnMessage(s){this.decode(s.data,a=>{if(a.topic==="phoenix"&&a.event==="phx_reply")try{this.heartbeatCallback(a.payload.status==="ok"?"ok":"error")}catch(f){this.log("error","error in heartbeat callback",f)}a.ref&&a.ref===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null);const{topic:r,event:o,payload:l,ref:c}=a,u=c?`(${c})`:"",h=l.status||"";this.log("receive",`${h} ${r} ${o} ${u}`.trim(),l),this.channels.filter(f=>f._isMember(r)).forEach(f=>f._trigger(o,l,c)),this._triggerStateCallbacks("message",a)})}_clearTimer(s){var a;s==="heartbeat"&&this.heartbeatTimer?(clearInterval(this.heartbeatTimer),this.heartbeatTimer=void 0):s==="reconnect"&&((a=this.reconnectTimer)===null||a===void 0||a.reset())}_clearAllTimers(){this._clearTimer("heartbeat"),this._clearTimer("reconnect")}_setupConnectionHandlers(){this.conn&&("binaryType"in this.conn&&(this.conn.binaryType="arraybuffer"),this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=s=>this._onConnError(s),this.conn.onmessage=s=>this._onConnMessage(s),this.conn.onclose=s=>this._onConnClose(s))}_teardownConnection(){this.conn&&(this.conn.onopen=null,this.conn.onerror=null,this.conn.onmessage=null,this.conn.onclose=null,this.conn=null),this._clearAllTimers(),this.channels.forEach(s=>s.teardown())}_onConnOpen(){this._setConnectionState("connected"),this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this._clearTimer("reconnect"),this.worker?this.workerRef||this._startWorkerHeartbeat():this._startHeartbeat(),this._triggerStateCallbacks("open")}_startHeartbeat(){this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs)}_startWorkerHeartbeat(){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const s=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(s),this.workerRef.onerror=a=>{this.log("worker","worker error",a.message),this.workerRef.terminate()},this.workerRef.onmessage=a=>{a.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}_onConnClose(s){var a;this._setConnectionState("disconnected"),this.log("transport","close",s),this._triggerChanError(),this._clearTimer("heartbeat"),this._wasManualDisconnect||(a=this.reconnectTimer)===null||a===void 0||a.scheduleTimeout(),this._triggerStateCallbacks("close",s)}_onConnError(s){this._setConnectionState("disconnected"),this.log("transport",`${s}`),this._triggerChanError(),this._triggerStateCallbacks("error",s)}_triggerChanError(){this.channels.forEach(s=>s._trigger(wa.error))}_appendParams(s,a){if(Object.keys(a).length===0)return s;const r=s.match(/\?/)?"&":"?",o=new URLSearchParams(a);return`${s}${r}${o}`}_workerObjectUrl(s){let a;if(s)a=s;else{const r=new Blob([F5],{type:"application/javascript"});a=URL.createObjectURL(r)}return a}_setConnectionState(s,a=!1){this._connectionState=s,s==="connecting"?this._wasManualDisconnect=!1:s==="disconnecting"&&(this._wasManualDisconnect=a)}async _performAuth(s=null){let a;s?a=s:this.accessToken?a=await this.accessToken():a=this.accessTokenValue,this.accessTokenValue!=a&&(this.accessTokenValue=a,this.channels.forEach(r=>{const o={access_token:a,version:M5};a&&r.updateJoinPayload(o),r.joinedOnce&&r._isJoined()&&r._push(wa.access_token,{access_token:a})}))}async _waitForAuthIfNeeded(){this._authPromise&&await this._authPromise}_setAuthSafely(s="general"){this.setAuth().catch(a=>{this.log("error",`error setting auth in ${s}`,a)})}_triggerStateCallbacks(s,a){try{this.stateChangeCallbacks[s].forEach(r=>{try{r(a)}catch(o){this.log("error",`error in ${s} callback`,o)}})}catch(r){this.log("error",`error triggering ${s} callbacks`,r)}}_setupReconnectionTimer(){this.reconnectTimer=new K_(async()=>{setTimeout(async()=>{await this._waitForAuthIfNeeded(),this.isConnected()||this.connect()},ou.RECONNECT_DELAY)},this.reconnectAfterMs)}_initializeOptions(s){var a,r,o,l,c,u,h,f,p;if(this.transport=(a=s==null?void 0:s.transport)!==null&&a!==void 0?a:null,this.timeout=(r=s==null?void 0:s.timeout)!==null&&r!==void 0?r:Op,this.heartbeatIntervalMs=(o=s==null?void 0:s.heartbeatIntervalMs)!==null&&o!==void 0?o:ou.HEARTBEAT_INTERVAL,this.worker=(l=s==null?void 0:s.worker)!==null&&l!==void 0?l:!1,this.accessToken=(c=s==null?void 0:s.accessToken)!==null&&c!==void 0?c:null,this.heartbeatCallback=(u=s==null?void 0:s.heartbeatCallback)!==null&&u!==void 0?u:Jf,s!=null&&s.params&&(this.params=s.params),s!=null&&s.logger&&(this.logger=s.logger),(s!=null&&s.logLevel||s!=null&&s.log_level)&&(this.logLevel=s.logLevel||s.log_level,this.params=Object.assign(Object.assign({},this.params),{log_level:this.logLevel})),this.reconnectAfterMs=(h=s==null?void 0:s.reconnectAfterMs)!==null&&h!==void 0?h:g=>V5[g-1]||q5,this.encode=(f=s==null?void 0:s.encode)!==null&&f!==void 0?f:(g,v)=>v(JSON.stringify(g)),this.decode=(p=s==null?void 0:s.decode)!==null&&p!==void 0?p:this.serializer.decode.bind(this.serializer),this.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.workerUrl=s==null?void 0:s.workerUrl}}}class z0 extends Error{constructor(s){super(s),this.__isStorageError=!0,this.name="StorageError"}}function is(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class H5 extends z0{constructor(s,a,r){super(s),this.name="StorageApiError",this.status=a,this.statusCode=r}toJSON(){return{name:this.name,message:this.message,status:this.status,statusCode:this.statusCode}}}class Ip extends z0{constructor(s,a){super(s),this.name="StorageUnknownError",this.originalError=a}}var G5=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};const e1=t=>{let s;return t?s=t:typeof fetch>"u"?s=(...a)=>ha(async()=>{const{default:r}=await Promise.resolve().then(()=>Fi);return{default:r}},void 0).then(({default:r})=>r(...a)):s=fetch,(...a)=>s(...a)},Z5=()=>G5(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield ha(()=>Promise.resolve().then(()=>Fi),void 0)).Response:Response}),Lp=t=>{if(Array.isArray(t))return t.map(a=>Lp(a));if(typeof t=="function"||t!==Object(t))return t;const s={};return Object.entries(t).forEach(([a,r])=>{const o=a.replace(/([-_][a-z])/gi,l=>l.toUpperCase().replace(/[-_]/g,""));s[o]=Lp(r)}),s},W5=t=>{if(typeof t!="object"||t===null)return!1;const s=Object.getPrototypeOf(t);return(s===null||s===Object.prototype||Object.getPrototypeOf(s)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)};var ho=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};const ep=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),Y5=(t,s,a)=>ho(void 0,void 0,void 0,function*(){const r=yield Z5();t instanceof r&&!(a!=null&&a.noResolveJson)?t.json().then(o=>{const l=t.status||500,c=(o==null?void 0:o.statusCode)||l+"";s(new H5(ep(o),l,c))}).catch(o=>{s(new Ip(ep(o),o))}):s(new Ip(ep(t),t))}),K5=(t,s,a,r)=>{const o={method:t,headers:(s==null?void 0:s.headers)||{}};return t==="GET"||!r?o:(W5(r)?(o.headers=Object.assign({"Content-Type":"application/json"},s==null?void 0:s.headers),o.body=JSON.stringify(r)):o.body=r,s!=null&&s.duplex&&(o.duplex=s.duplex),Object.assign(Object.assign({},o),a))};function Ic(t,s,a,r,o,l){return ho(this,void 0,void 0,function*(){return new Promise((c,u)=>{t(a,K5(s,r,o,l)).then(h=>{if(!h.ok)throw h;return r!=null&&r.noResolveJson?h:h.json()}).then(h=>c(h)).catch(h=>Y5(h,u,r))})})}function zu(t,s,a,r){return ho(this,void 0,void 0,function*(){return Ic(t,"GET",s,a,r)})}function Pa(t,s,a,r,o){return ho(this,void 0,void 0,function*(){return Ic(t,"POST",s,r,o,a)})}function Up(t,s,a,r,o){return ho(this,void 0,void 0,function*(){return Ic(t,"PUT",s,r,o,a)})}function X5(t,s,a,r){return ho(this,void 0,void 0,function*(){return Ic(t,"HEAD",s,Object.assign(Object.assign({},a),{noResolveJson:!0}),r)})}function t1(t,s,a,r,o){return ho(this,void 0,void 0,function*(){return Ic(t,"DELETE",s,r,o,a)})}var Es=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};const Q5={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},Qv={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class J5{constructor(s,a={},r,o){this.url=s,this.headers=a,this.bucketId=r,this.fetch=e1(o)}uploadOrUpdate(s,a,r,o){return Es(this,void 0,void 0,function*(){try{let l;const c=Object.assign(Object.assign({},Qv),o);let u=Object.assign(Object.assign({},this.headers),s==="POST"&&{"x-upsert":String(c.upsert)});const h=c.metadata;typeof Blob<"u"&&r instanceof Blob?(l=new FormData,l.append("cacheControl",c.cacheControl),h&&l.append("metadata",this.encodeMetadata(h)),l.append("",r)):typeof FormData<"u"&&r instanceof FormData?(l=r,l.append("cacheControl",c.cacheControl),h&&l.append("metadata",this.encodeMetadata(h))):(l=r,u["cache-control"]=`max-age=${c.cacheControl}`,u["content-type"]=c.contentType,h&&(u["x-metadata"]=this.toBase64(this.encodeMetadata(h)))),o!=null&&o.headers&&(u=Object.assign(Object.assign({},u),o.headers));const f=this._removeEmptyFolders(a),p=this._getFinalPath(f),g=yield(s=="PUT"?Up:Pa)(this.fetch,`${this.url}/object/${p}`,l,Object.assign({headers:u},c!=null&&c.duplex?{duplex:c.duplex}:{}));return{data:{path:f,id:g.Id,fullPath:g.Key},error:null}}catch(l){if(is(l))return{data:null,error:l};throw l}})}upload(s,a,r){return Es(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",s,a,r)})}uploadToSignedUrl(s,a,r,o){return Es(this,void 0,void 0,function*(){const l=this._removeEmptyFolders(s),c=this._getFinalPath(l),u=new URL(this.url+`/object/upload/sign/${c}`);u.searchParams.set("token",a);try{let h;const f=Object.assign({upsert:Qv.upsert},o),p=Object.assign(Object.assign({},this.headers),{"x-upsert":String(f.upsert)});typeof Blob<"u"&&r instanceof Blob?(h=new FormData,h.append("cacheControl",f.cacheControl),h.append("",r)):typeof FormData<"u"&&r instanceof FormData?(h=r,h.append("cacheControl",f.cacheControl)):(h=r,p["cache-control"]=`max-age=${f.cacheControl}`,p["content-type"]=f.contentType);const g=yield Up(this.fetch,u.toString(),h,{headers:p});return{data:{path:l,fullPath:g.Key},error:null}}catch(h){if(is(h))return{data:null,error:h};throw h}})}createSignedUploadUrl(s,a){return Es(this,void 0,void 0,function*(){try{let r=this._getFinalPath(s);const o=Object.assign({},this.headers);a!=null&&a.upsert&&(o["x-upsert"]="true");const l=yield Pa(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:o}),c=new URL(this.url+l.url),u=c.searchParams.get("token");if(!u)throw new z0("No token returned by API");return{data:{signedUrl:c.toString(),path:s,token:u},error:null}}catch(r){if(is(r))return{data:null,error:r};throw r}})}update(s,a,r){return Es(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",s,a,r)})}move(s,a,r){return Es(this,void 0,void 0,function*(){try{return{data:yield Pa(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:s,destinationKey:a,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers}),error:null}}catch(o){if(is(o))return{data:null,error:o};throw o}})}copy(s,a,r){return Es(this,void 0,void 0,function*(){try{return{data:{path:(yield Pa(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:s,destinationKey:a,destinationBucket:r==null?void 0:r.destinationBucket},{headers:this.headers})).Key},error:null}}catch(o){if(is(o))return{data:null,error:o};throw o}})}createSignedUrl(s,a,r){return Es(this,void 0,void 0,function*(){try{let o=this._getFinalPath(s),l=yield Pa(this.fetch,`${this.url}/object/sign/${o}`,Object.assign({expiresIn:a},r!=null&&r.transform?{transform:r.transform}:{}),{headers:this.headers});const c=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return l={signedUrl:encodeURI(`${this.url}${l.signedURL}${c}`)},{data:l,error:null}}catch(o){if(is(o))return{data:null,error:o};throw o}})}createSignedUrls(s,a,r){return Es(this,void 0,void 0,function*(){try{const o=yield Pa(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:a,paths:s},{headers:this.headers}),l=r!=null&&r.download?`&download=${r.download===!0?"":r.download}`:"";return{data:o.map(c=>Object.assign(Object.assign({},c),{signedUrl:c.signedURL?encodeURI(`${this.url}${c.signedURL}${l}`):null})),error:null}}catch(o){if(is(o))return{data:null,error:o};throw o}})}download(s,a){return Es(this,void 0,void 0,function*(){const o=typeof(a==null?void 0:a.transform)<"u"?"render/image/authenticated":"object",l=this.transformOptsToQueryString((a==null?void 0:a.transform)||{}),c=l?`?${l}`:"";try{const u=this._getFinalPath(s);return{data:yield(yield zu(this.fetch,`${this.url}/${o}/${u}${c}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(u){if(is(u))return{data:null,error:u};throw u}})}info(s){return Es(this,void 0,void 0,function*(){const a=this._getFinalPath(s);try{const r=yield zu(this.fetch,`${this.url}/object/info/${a}`,{headers:this.headers});return{data:Lp(r),error:null}}catch(r){if(is(r))return{data:null,error:r};throw r}})}exists(s){return Es(this,void 0,void 0,function*(){const a=this._getFinalPath(s);try{return yield X5(this.fetch,`${this.url}/object/${a}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(is(r)&&r instanceof Ip){const o=r.originalError;if([400,404].includes(o==null?void 0:o.status))return{data:!1,error:r}}throw r}})}getPublicUrl(s,a){const r=this._getFinalPath(s),o=[],l=a!=null&&a.download?`download=${a.download===!0?"":a.download}`:"";l!==""&&o.push(l);const u=typeof(a==null?void 0:a.transform)<"u"?"render/image":"object",h=this.transformOptsToQueryString((a==null?void 0:a.transform)||{});h!==""&&o.push(h);let f=o.join("&");return f!==""&&(f=`?${f}`),{data:{publicUrl:encodeURI(`${this.url}/${u}/public/${r}${f}`)}}}remove(s){return Es(this,void 0,void 0,function*(){try{return{data:yield t1(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:s},{headers:this.headers}),error:null}}catch(a){if(is(a))return{data:null,error:a};throw a}})}list(s,a,r){return Es(this,void 0,void 0,function*(){try{const o=Object.assign(Object.assign(Object.assign({},Q5),a),{prefix:s||""});return{data:yield Pa(this.fetch,`${this.url}/object/list/${this.bucketId}`,o,{headers:this.headers},r),error:null}}catch(o){if(is(o))return{data:null,error:o};throw o}})}listV2(s,a){return Es(this,void 0,void 0,function*(){try{const r=Object.assign({},s);return{data:yield Pa(this.fetch,`${this.url}/object/list-v2/${this.bucketId}`,r,{headers:this.headers},a),error:null}}catch(r){if(is(r))return{data:null,error:r};throw r}})}encodeMetadata(s){return JSON.stringify(s)}toBase64(s){return typeof Buffer<"u"?Buffer.from(s).toString("base64"):btoa(s)}_getFinalPath(s){return`${this.bucketId}/${s.replace(/^\/+/,"")}`}_removeEmptyFolders(s){return s.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(s){const a=[];return s.width&&a.push(`width=${s.width}`),s.height&&a.push(`height=${s.height}`),s.resize&&a.push(`resize=${s.resize}`),s.format&&a.push(`format=${s.format}`),s.quality&&a.push(`quality=${s.quality}`),a.join("&")}}const e6="2.11.0",t6={"X-Client-Info":`storage-js/${e6}`};var ii=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};class s6{constructor(s,a={},r,o){const l=new URL(s);o!=null&&o.useNewHostname&&/supabase\.(co|in|red)$/.test(l.hostname)&&!l.hostname.includes("storage.supabase.")&&(l.hostname=l.hostname.replace("supabase.","storage.supabase.")),this.url=l.href,this.headers=Object.assign(Object.assign({},t6),a),this.fetch=e1(r)}listBuckets(){return ii(this,void 0,void 0,function*(){try{return{data:yield zu(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(s){if(is(s))return{data:null,error:s};throw s}})}getBucket(s){return ii(this,void 0,void 0,function*(){try{return{data:yield zu(this.fetch,`${this.url}/bucket/${s}`,{headers:this.headers}),error:null}}catch(a){if(is(a))return{data:null,error:a};throw a}})}createBucket(s,a={public:!1}){return ii(this,void 0,void 0,function*(){try{return{data:yield Pa(this.fetch,`${this.url}/bucket`,{id:s,name:s,type:a.type,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(is(r))return{data:null,error:r};throw r}})}updateBucket(s,a){return ii(this,void 0,void 0,function*(){try{return{data:yield Up(this.fetch,`${this.url}/bucket/${s}`,{id:s,name:s,public:a.public,file_size_limit:a.fileSizeLimit,allowed_mime_types:a.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(is(r))return{data:null,error:r};throw r}})}emptyBucket(s){return ii(this,void 0,void 0,function*(){try{return{data:yield Pa(this.fetch,`${this.url}/bucket/${s}/empty`,{},{headers:this.headers}),error:null}}catch(a){if(is(a))return{data:null,error:a};throw a}})}deleteBucket(s){return ii(this,void 0,void 0,function*(){try{return{data:yield t1(this.fetch,`${this.url}/bucket/${s}`,{},{headers:this.headers}),error:null}}catch(a){if(is(a))return{data:null,error:a};throw a}})}}class a6 extends s6{constructor(s,a={},r,o){super(s,a,r,o)}from(s){return new J5(this.url,this.headers,s,this.fetch)}}const r6="2.56.1";let ec="";typeof Deno<"u"?ec="deno":typeof document<"u"?ec="web":typeof navigator<"u"&&navigator.product==="ReactNative"?ec="react-native":ec="node";const n6={"X-Client-Info":`supabase-js-${ec}/${r6}`},o6={headers:n6},i6={schema:"public"},l6={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},c6={};var d6=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};const u6=t=>{let s;return t?s=t:typeof fetch>"u"?s=q_:s=fetch,(...a)=>s(...a)},m6=()=>typeof Headers>"u"?F_:Headers,h6=(t,s,a)=>{const r=u6(a),o=m6();return(l,c)=>d6(void 0,void 0,void 0,function*(){var u;const h=(u=yield s())!==null&&u!==void 0?u:t;let f=new o(c==null?void 0:c.headers);return f.has("apikey")||f.set("apikey",t),f.has("Authorization")||f.set("Authorization",`Bearer ${h}`),r(l,Object.assign(Object.assign({},c),{headers:f}))})};var f6=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};function p6(t){return t.endsWith("/")?t:t+"/"}function g6(t,s){var a,r;const{db:o,auth:l,realtime:c,global:u}=t,{db:h,auth:f,realtime:p,global:g}=s,v={db:Object.assign(Object.assign({},h),o),auth:Object.assign(Object.assign({},f),l),realtime:Object.assign(Object.assign({},p),c),storage:{},global:Object.assign(Object.assign(Object.assign({},g),u),{headers:Object.assign(Object.assign({},(a=g==null?void 0:g.headers)!==null&&a!==void 0?a:{}),(r=u==null?void 0:u.headers)!==null&&r!==void 0?r:{})}),accessToken:()=>f6(this,void 0,void 0,function*(){return""})};return t.accessToken?v.accessToken=t.accessToken:delete v.accessToken,v}const s1="2.71.1",xi=30*1e3,Bp=3,tp=Bp*xi,x6="http://localhost:9999",y6="supabase.auth.token",b6={"X-Client-Info":`gotrue-js/${s1}`},Vp="X-Supabase-Api-Version",a1={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}},v6=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}$|[a-z0-9_-]{2}$)$/i,w6=10*60*1e3;class hm extends Error{constructor(s,a,r){super(s),this.__isAuthError=!0,this.name="AuthError",this.status=a,this.code=r}}function Ke(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class r1 extends hm{constructor(s,a,r){super(s,a,r),this.name="AuthApiError",this.status=a,this.code=r}}function n1(t){return Ke(t)&&t.name==="AuthApiError"}class $0 extends hm{constructor(s,a){super(s),this.name="AuthUnknownError",this.originalError=a}}class Ar extends hm{constructor(s,a,r,o){super(s,r,o),this.name=a,this.status=r}}class yr extends Ar{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function o1(t){return Ke(t)&&t.name==="AuthSessionMissingError"}class tc extends Ar{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class sc extends Ar{constructor(s){super(s,"AuthInvalidCredentialsError",400,void 0)}}class ac extends Ar{constructor(s,a=null){super(s,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function i1(t){return Ke(t)&&t.name==="AuthImplicitGrantRedirectError"}class qp extends Ar{constructor(s,a=null){super(s,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=a}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class $u extends Ar{constructor(s,a){super(s,"AuthRetryableFetchError",a,void 0)}}function Nu(t){return Ke(t)&&t.name==="AuthRetryableFetchError"}class Fp extends Ar{constructor(s,a,r){super(s,"AuthWeakPasswordError",a,"weak_password"),this.reasons=r}}class Iu extends Ar{constructor(s){super(s,"AuthInvalidJwtError",400,"invalid_jwt")}}const Lu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_".split(""),Jv=` 	
\r=`.split(""),j6=(()=>{const t=new Array(128);for(let s=0;s<t.length;s+=1)t[s]=-1;for(let s=0;s<Jv.length;s+=1)t[Jv[s].charCodeAt(0)]=-2;for(let s=0;s<Lu.length;s+=1)t[Lu[s].charCodeAt(0)]=s;return t})();function ew(t,s,a){if(t!==null)for(s.queue=s.queue<<8|t,s.queuedBits+=8;s.queuedBits>=6;){const r=s.queue>>s.queuedBits-6&63;a(Lu[r]),s.queuedBits-=6}else if(s.queuedBits>0)for(s.queue=s.queue<<6-s.queuedBits,s.queuedBits=6;s.queuedBits>=6;){const r=s.queue>>s.queuedBits-6&63;a(Lu[r]),s.queuedBits-=6}}function l1(t,s,a){const r=j6[t];if(r>-1)for(s.queue=s.queue<<6|r,s.queuedBits+=6;s.queuedBits>=8;)a(s.queue>>s.queuedBits-8&255),s.queuedBits-=8;else{if(r===-2)return;throw new Error(`Invalid Base64-URL character "${String.fromCharCode(t)}"`)}}function tw(t){const s=[],a=c=>{s.push(String.fromCodePoint(c))},r={utf8seq:0,codepoint:0},o={queue:0,queuedBits:0},l=c=>{S6(c,r,a)};for(let c=0;c<t.length;c+=1)l1(t.charCodeAt(c),o,l);return s.join("")}function _6(t,s){if(t<=127){s(t);return}else if(t<=2047){s(192|t>>6),s(128|t&63);return}else if(t<=65535){s(224|t>>12),s(128|t>>6&63),s(128|t&63);return}else if(t<=1114111){s(240|t>>18),s(128|t>>12&63),s(128|t>>6&63),s(128|t&63);return}throw new Error(`Unrecognized Unicode codepoint: ${t.toString(16)}`)}function N6(t,s){for(let a=0;a<t.length;a+=1){let r=t.charCodeAt(a);if(r>55295&&r<=56319){const o=(r-55296)*1024&65535;r=(t.charCodeAt(a+1)-56320&65535|o)+65536,a+=1}_6(r,s)}}function S6(t,s,a){if(s.utf8seq===0){if(t<=127){a(t);return}for(let r=1;r<6;r+=1)if((t>>7-r&1)===0){s.utf8seq=r;break}if(s.utf8seq===2)s.codepoint=t&31;else if(s.utf8seq===3)s.codepoint=t&15;else if(s.utf8seq===4)s.codepoint=t&7;else throw new Error("Invalid UTF-8 sequence");s.utf8seq-=1}else if(s.utf8seq>0){if(t<=127)throw new Error("Invalid UTF-8 sequence");s.codepoint=s.codepoint<<6|t&63,s.utf8seq-=1,s.utf8seq===0&&a(s.codepoint)}}function E6(t){const s=[],a={queue:0,queuedBits:0},r=o=>{s.push(o)};for(let o=0;o<t.length;o+=1)l1(t.charCodeAt(o),a,r);return new Uint8Array(s)}function C6(t){const s=[];return N6(t,a=>s.push(a)),new Uint8Array(s)}function T6(t){const s=[],a={queue:0,queuedBits:0},r=o=>{s.push(o)};return t.forEach(o=>ew(o,a,r)),ew(null,a,r),s.join("")}function k6(t){return Math.round(Date.now()/1e3)+t}function A6(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const s=Math.random()*16|0;return(t=="x"?s:s&3|8).toString(16)})}const ba=()=>typeof window<"u"&&typeof document<"u",zn={tested:!1,writable:!1},c1=()=>{if(!ba())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(zn.tested)return zn.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),zn.tested=!0,zn.writable=!0}catch{zn.tested=!0,zn.writable=!1}return zn.writable};function M6(t){const s={},a=new URL(t);if(a.hash&&a.hash[0]==="#")try{new URLSearchParams(a.hash.substring(1)).forEach((o,l)=>{s[l]=o})}catch{}return a.searchParams.forEach((r,o)=>{s[o]=r}),s}const d1=t=>{let s;return t?s=t:typeof fetch>"u"?s=(...a)=>ha(async()=>{const{default:r}=await Promise.resolve().then(()=>Fi);return{default:r}},void 0).then(({default:r})=>r(...a)):s=fetch,(...a)=>s(...a)},R6=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",yi=async(t,s,a)=>{await t.setItem(s,JSON.stringify(a))},$n=async(t,s)=>{const a=await t.getItem(s);if(!a)return null;try{return JSON.parse(a)}catch{return a}},an=async(t,s)=>{await t.removeItem(s)};class fm{constructor(){this.promise=new fm.promiseConstructor((s,a)=>{this.resolve=s,this.reject=a})}}fm.promiseConstructor=Promise;function sp(t){const s=t.split(".");if(s.length!==3)throw new Iu("Invalid JWT structure");for(let r=0;r<s.length;r++)if(!v6.test(s[r]))throw new Iu("JWT not in base64url format");return{header:JSON.parse(tw(s[0])),payload:JSON.parse(tw(s[1])),signature:E6(s[2]),raw:{header:s[0],payload:s[1]}}}async function O6(t){return await new Promise(s=>{setTimeout(()=>s(null),t)})}function D6(t,s){return new Promise((r,o)=>{(async()=>{for(let l=0;l<1/0;l++)try{const c=await t(l);if(!s(l,null,c)){r(c);return}}catch(c){if(!s(l,c)){o(c);return}}})()})}function P6(t){return("0"+t.toString(16)).substr(-2)}function z6(){const s=new Uint32Array(56);if(typeof crypto>"u"){const a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=a.length;let o="";for(let l=0;l<56;l++)o+=a.charAt(Math.floor(Math.random()*r));return o}return crypto.getRandomValues(s),Array.from(s,P6).join("")}async function $6(t){const a=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",a),o=new Uint8Array(r);return Array.from(o).map(l=>String.fromCharCode(l)).join("")}async function I6(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const a=await $6(t);return btoa(a).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function li(t,s,a=!1){const r=z6();let o=r;a&&(o+="/PASSWORD_RECOVERY"),await yi(t,`${s}-code-verifier`,o);const l=await I6(r);return[l,r===l?"plain":"s256"]}const L6=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function U6(t){const s=t.headers.get(Vp);if(!s||!s.match(L6))return null;try{return new Date(`${s}T00:00:00.0Z`)}catch{return null}}function B6(t){if(!t)throw new Error("Missing exp claim");const s=Math.floor(Date.now()/1e3);if(t<=s)throw new Error("JWT has expired")}function V6(t){switch(t){case"RS256":return{name:"RSASSA-PKCS1-v1_5",hash:{name:"SHA-256"}};case"ES256":return{name:"ECDSA",namedCurve:"P-256",hash:{name:"SHA-256"}};default:throw new Error("Invalid alg claim")}}const q6=/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/;function ci(t){if(!q6.test(t))throw new Error("@supabase/auth-js: Expected parameter to be UUID but is not")}function ap(){const t={};return new Proxy(t,{get:(s,a)=>{if(a==="__isUserNotAvailableProxy")return!0;if(typeof a=="symbol"){const r=a.toString();if(r==="Symbol(Symbol.toPrimitive)"||r==="Symbol(Symbol.toStringTag)"||r==="Symbol(util.inspect.custom)")return}throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Accessing the "${a}" property of the session object is not supported. Please use getUser() instead.`)},set:(s,a)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Setting the "${a}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)},deleteProperty:(s,a)=>{throw new Error(`@supabase/auth-js: client was created with userStorage option and there was no user stored in the user storage. Deleting the "${a}" property of the session object is not supported. Please use getUser() to fetch a user object you can manipulate.`)}})}function sw(t){return JSON.parse(JSON.stringify(t))}var F6=function(t,s){var a={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&s.indexOf(r)<0&&(a[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)s.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(a[r[o]]=t[r[o]]);return a};const Un=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),H6=[502,503,504];async function aw(t){var s;if(!R6(t))throw new $u(Un(t),0);if(H6.includes(t.status))throw new $u(Un(t),t.status);let a;try{a=await t.json()}catch(l){throw new $0(Un(l),l)}let r;const o=U6(t);if(o&&o.getTime()>=a1["2024-01-01"].timestamp&&typeof a=="object"&&a&&typeof a.code=="string"?r=a.code:typeof a=="object"&&a&&typeof a.error_code=="string"&&(r=a.error_code),r){if(r==="weak_password")throw new Fp(Un(a),t.status,((s=a.weak_password)===null||s===void 0?void 0:s.reasons)||[]);if(r==="session_not_found")throw new yr}else if(typeof a=="object"&&a&&typeof a.weak_password=="object"&&a.weak_password&&Array.isArray(a.weak_password.reasons)&&a.weak_password.reasons.length&&a.weak_password.reasons.reduce((l,c)=>l&&typeof c=="string",!0))throw new Fp(Un(a),t.status,a.weak_password.reasons);throw new r1(Un(a),t.status||500,r)}const G6=(t,s,a,r)=>{const o={method:t,headers:(s==null?void 0:s.headers)||{}};return t==="GET"?o:(o.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},s==null?void 0:s.headers),o.body=JSON.stringify(r),Object.assign(Object.assign({},o),a))};async function rt(t,s,a,r){var o;const l=Object.assign({},r==null?void 0:r.headers);l[Vp]||(l[Vp]=a1["2024-01-01"].name),r!=null&&r.jwt&&(l.Authorization=`Bearer ${r.jwt}`);const c=(o=r==null?void 0:r.query)!==null&&o!==void 0?o:{};r!=null&&r.redirectTo&&(c.redirect_to=r.redirectTo);const u=Object.keys(c).length?"?"+new URLSearchParams(c).toString():"",h=await Z6(t,s,a+u,{headers:l,noResolveJson:r==null?void 0:r.noResolveJson},{},r==null?void 0:r.body);return r!=null&&r.xform?r==null?void 0:r.xform(h):{data:Object.assign({},h),error:null}}async function Z6(t,s,a,r,o,l){const c=G6(s,r,o,l);let u;try{u=await t(a,Object.assign({},c))}catch(h){throw console.error(h),new $u(Un(h),0)}if(u.ok||await aw(u),r!=null&&r.noResolveJson)return u;try{return await u.json()}catch(h){await aw(h)}}function xr(t){var s;let a=null;X6(t)&&(a=Object.assign({},t),t.expires_at||(a.expires_at=k6(t.expires_in)));const r=(s=t.user)!==null&&s!==void 0?s:t;return{data:{session:a,user:r},error:null}}function rw(t){const s=xr(t);return!s.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((a,r)=>a&&typeof r=="string",!0)&&(s.data.weak_password=t.weak_password),s}function on(t){var s;return{data:{user:(s=t.user)!==null&&s!==void 0?s:t},error:null}}function W6(t){return{data:t,error:null}}function Y6(t){const{action_link:s,email_otp:a,hashed_token:r,redirect_to:o,verification_type:l}=t,c=F6(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),u={action_link:s,email_otp:a,hashed_token:r,redirect_to:o,verification_type:l},h=Object.assign({},c);return{data:{properties:u,user:h},error:null}}function K6(t){return t}function X6(t){return t.access_token&&t.refresh_token&&t.expires_in}const Su=["global","local","others"];var Q6=function(t,s){var a={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&s.indexOf(r)<0&&(a[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,r=Object.getOwnPropertySymbols(t);o<r.length;o++)s.indexOf(r[o])<0&&Object.prototype.propertyIsEnumerable.call(t,r[o])&&(a[r[o]]=t[r[o]]);return a};class u1{constructor({url:s="",headers:a={},fetch:r}){this.url=s,this.headers=a,this.fetch=d1(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(s,a=Su[0]){if(Su.indexOf(a)<0)throw new Error(`@supabase/auth-js: Parameter scope must be one of ${Su.join(", ")}`);try{return await rt(this.fetch,"POST",`${this.url}/logout?scope=${a}`,{headers:this.headers,jwt:s,noResolveJson:!0}),{data:null,error:null}}catch(r){if(Ke(r))return{data:null,error:r};throw r}}async inviteUserByEmail(s,a={}){try{return await rt(this.fetch,"POST",`${this.url}/invite`,{body:{email:s,data:a.data},headers:this.headers,redirectTo:a.redirectTo,xform:on})}catch(r){if(Ke(r))return{data:{user:null},error:r};throw r}}async generateLink(s){try{const{options:a}=s,r=Q6(s,["options"]),o=Object.assign(Object.assign({},r),a);return"newEmail"in r&&(o.new_email=r==null?void 0:r.newEmail,delete o.newEmail),await rt(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:o,headers:this.headers,xform:Y6,redirectTo:a==null?void 0:a.redirectTo})}catch(a){if(Ke(a))return{data:{properties:null,user:null},error:a};throw a}}async createUser(s){try{return await rt(this.fetch,"POST",`${this.url}/admin/users`,{body:s,headers:this.headers,xform:on})}catch(a){if(Ke(a))return{data:{user:null},error:a};throw a}}async listUsers(s){var a,r,o,l,c,u,h;try{const f={nextPage:null,lastPage:0,total:0},p=await rt(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(a=s==null?void 0:s.page)===null||a===void 0?void 0:a.toString())!==null&&r!==void 0?r:"",per_page:(l=(o=s==null?void 0:s.perPage)===null||o===void 0?void 0:o.toString())!==null&&l!==void 0?l:""},xform:K6});if(p.error)throw p.error;const g=await p.json(),v=(c=p.headers.get("x-total-count"))!==null&&c!==void 0?c:0,b=(h=(u=p.headers.get("link"))===null||u===void 0?void 0:u.split(","))!==null&&h!==void 0?h:[];return b.length>0&&(b.forEach(_=>{const w=parseInt(_.split(";")[0].split("=")[1].substring(0,1)),E=JSON.parse(_.split(";")[1].split("=")[1]);f[`${E}Page`]=w}),f.total=parseInt(v)),{data:Object.assign(Object.assign({},g),f),error:null}}catch(f){if(Ke(f))return{data:{users:[]},error:f};throw f}}async getUserById(s){ci(s);try{return await rt(this.fetch,"GET",`${this.url}/admin/users/${s}`,{headers:this.headers,xform:on})}catch(a){if(Ke(a))return{data:{user:null},error:a};throw a}}async updateUserById(s,a){ci(s);try{return await rt(this.fetch,"PUT",`${this.url}/admin/users/${s}`,{body:a,headers:this.headers,xform:on})}catch(r){if(Ke(r))return{data:{user:null},error:r};throw r}}async deleteUser(s,a=!1){ci(s);try{return await rt(this.fetch,"DELETE",`${this.url}/admin/users/${s}`,{headers:this.headers,body:{should_soft_delete:a},xform:on})}catch(r){if(Ke(r))return{data:{user:null},error:r};throw r}}async _listFactors(s){ci(s.userId);try{const{data:a,error:r}=await rt(this.fetch,"GET",`${this.url}/admin/users/${s.userId}/factors`,{headers:this.headers,xform:o=>({data:{factors:o},error:null})});return{data:a,error:r}}catch(a){if(Ke(a))return{data:null,error:a};throw a}}async _deleteFactor(s){ci(s.userId),ci(s.id);try{return{data:await rt(this.fetch,"DELETE",`${this.url}/admin/users/${s.userId}/factors/${s.id}`,{headers:this.headers}),error:null}}catch(a){if(Ke(a))return{data:null,error:a};throw a}}}function nw(t={}){return{getItem:s=>t[s]||null,setItem:(s,a)=>{t[s]=a},removeItem:s=>{delete t[s]}}}function J6(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Bn={debug:!!(globalThis&&c1()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class m1 extends Error{constructor(s){super(s),this.isAcquireTimeout=!0}}class h1 extends m1{}async function f1(t,s,a){Bn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,s);const r=new globalThis.AbortController;return s>0&&setTimeout(()=>{r.abort(),Bn.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},s),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,s===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async o=>{if(o){Bn.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,o.name);try{return await a()}finally{Bn.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,o.name)}}else{if(s===0)throw Bn.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new h1(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Bn.debug)try{const l=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(l,null,"  "))}catch(l){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",l)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await a()}}))}J6();const e3={url:x6,storageKey:y6,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:b6,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1};async function ow(t,s,a){return await a()}const di={};class Di{constructor(s){var a,r;this.userStorage=null,this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Di.nextInstanceID,Di.nextInstanceID+=1,this.instanceID>0&&ba()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const o=Object.assign(Object.assign({},e3),s);if(this.logDebugMessages=!!o.debug,typeof o.debug=="function"&&(this.logger=o.debug),this.persistSession=o.persistSession,this.storageKey=o.storageKey,this.autoRefreshToken=o.autoRefreshToken,this.admin=new u1({url:o.url,headers:o.headers,fetch:o.fetch}),this.url=o.url,this.headers=o.headers,this.fetch=d1(o.fetch),this.lock=o.lock||ow,this.detectSessionInUrl=o.detectSessionInUrl,this.flowType=o.flowType,this.hasCustomAuthorizationHeader=o.hasCustomAuthorizationHeader,o.lock?this.lock=o.lock:ba()&&(!((a=globalThis==null?void 0:globalThis.navigator)===null||a===void 0)&&a.locks)?this.lock=f1:this.lock=ow,this.jwks||(this.jwks={keys:[]},this.jwks_cached_at=Number.MIN_SAFE_INTEGER),this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?(o.storage?this.storage=o.storage:c1()?this.storage=globalThis.localStorage:(this.memoryStorage={},this.storage=nw(this.memoryStorage)),o.userStorage&&(this.userStorage=o.userStorage)):(this.memoryStorage={},this.storage=nw(this.memoryStorage)),ba()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(l){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",l)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async l=>{this._debug("received broadcast notification from other tab or client",l),await this._notifyAllSubscribers(l.data.event,l.data.session,!1)})}this.initialize()}get jwks(){var s,a;return(a=(s=di[this.storageKey])===null||s===void 0?void 0:s.jwks)!==null&&a!==void 0?a:{keys:[]}}set jwks(s){di[this.storageKey]=Object.assign(Object.assign({},di[this.storageKey]),{jwks:s})}get jwks_cached_at(){var s,a;return(a=(s=di[this.storageKey])===null||s===void 0?void 0:s.cachedAt)!==null&&a!==void 0?a:Number.MIN_SAFE_INTEGER}set jwks_cached_at(s){di[this.storageKey]=Object.assign(Object.assign({},di[this.storageKey]),{cachedAt:s})}_debug(...s){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${s1}) ${new Date().toISOString()}`,...s),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var s;try{const a=M6(window.location.href);let r="none";if(this._isImplicitGrantCallback(a)?r="implicit":await this._isPKCECallback(a)&&(r="pkce"),ba()&&this.detectSessionInUrl&&r!=="none"){const{data:o,error:l}=await this._getSessionFromURL(a,r);if(l){if(this._debug("#_initialize()","error detecting session from URL",l),i1(l)){const h=(s=l.details)===null||s===void 0?void 0:s.code;if(h==="identity_already_exists"||h==="identity_not_found"||h==="single_identity_not_deletable")return{error:l}}return await this._removeSession(),{error:l}}const{session:c,redirectType:u}=o;return this._debug("#_initialize()","detected session in URL",c,"redirect type",u),await this._saveSession(c),setTimeout(async()=>{u==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",c):await this._notifyAllSubscribers("SIGNED_IN",c)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(a){return Ke(a)?{error:a}:{error:new $0("Unexpected error during initialization",a)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(s){var a,r,o;try{const l=await rt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(a=s==null?void 0:s.options)===null||a===void 0?void 0:a.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(o=s==null?void 0:s.options)===null||o===void 0?void 0:o.captchaToken}},xform:xr}),{data:c,error:u}=l;if(u||!c)return{data:{user:null,session:null},error:u};const h=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:f,session:h},error:null}}catch(l){if(Ke(l))return{data:{user:null,session:null},error:l};throw l}}async signUp(s){var a,r,o;try{let l;if("email"in s){const{email:p,password:g,options:v}=s;let b=null,_=null;this.flowType==="pkce"&&([b,_]=await li(this.storage,this.storageKey)),l=await rt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:v==null?void 0:v.emailRedirectTo,body:{email:p,password:g,data:(a=v==null?void 0:v.data)!==null&&a!==void 0?a:{},gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken},code_challenge:b,code_challenge_method:_},xform:xr})}else if("phone"in s){const{phone:p,password:g,options:v}=s;l=await rt(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:p,password:g,data:(r=v==null?void 0:v.data)!==null&&r!==void 0?r:{},channel:(o=v==null?void 0:v.channel)!==null&&o!==void 0?o:"sms",gotrue_meta_security:{captcha_token:v==null?void 0:v.captchaToken}},xform:xr})}else throw new sc("You must provide either an email or phone number and a password");const{data:c,error:u}=l;if(u||!c)return{data:{user:null,session:null},error:u};const h=c.session,f=c.user;return c.session&&(await this._saveSession(c.session),await this._notifyAllSubscribers("SIGNED_IN",h)),{data:{user:f,session:h},error:null}}catch(l){if(Ke(l))return{data:{user:null,session:null},error:l};throw l}}async signInWithPassword(s){try{let a;if("email"in s){const{email:l,password:c,options:u}=s;a=await rt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:l,password:c,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:rw})}else if("phone"in s){const{phone:l,password:c,options:u}=s;a=await rt(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:l,password:c,gotrue_meta_security:{captcha_token:u==null?void 0:u.captchaToken}},xform:rw})}else throw new sc("You must provide either an email or phone number and a password");const{data:r,error:o}=a;return o?{data:{user:null,session:null},error:o}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new tc}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:o})}catch(a){if(Ke(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithOAuth(s){var a,r,o,l;return await this._handleProviderSignIn(s.provider,{redirectTo:(a=s.options)===null||a===void 0?void 0:a.redirectTo,scopes:(r=s.options)===null||r===void 0?void 0:r.scopes,queryParams:(o=s.options)===null||o===void 0?void 0:o.queryParams,skipBrowserRedirect:(l=s.options)===null||l===void 0?void 0:l.skipBrowserRedirect})}async exchangeCodeForSession(s){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(s))}async signInWithWeb3(s){const{chain:a}=s;if(a==="solana")return await this.signInWithSolana(s);throw new Error(`@supabase/auth-js: Unsupported chain "${a}"`)}async signInWithSolana(s){var a,r,o,l,c,u,h,f,p,g,v,b;let _,w;if("message"in s)_=s.message,w=s.signature;else{const{chain:E,wallet:k,statement:N,options:C}=s;let S;if(ba())if(typeof k=="object")S=k;else{const M=window;if("solana"in M&&typeof M.solana=="object"&&("signIn"in M.solana&&typeof M.solana.signIn=="function"||"signMessage"in M.solana&&typeof M.solana.signMessage=="function"))S=M.solana;else throw new Error("@supabase/auth-js: No compatible Solana wallet interface on the window object (window.solana) detected. Make sure the user already has a wallet installed and connected for this app. Prefer passing the wallet interface object directly to signInWithWeb3({ chain: 'solana', wallet: resolvedUserWallet }) instead.")}else{if(typeof k!="object"||!(C!=null&&C.url))throw new Error("@supabase/auth-js: Both wallet and url must be specified in non-browser environments.");S=k}const T=new URL((a=C==null?void 0:C.url)!==null&&a!==void 0?a:window.location.href);if("signIn"in S&&S.signIn){const M=await S.signIn(Object.assign(Object.assign(Object.assign({issuedAt:new Date().toISOString()},C==null?void 0:C.signInWithSolana),{version:"1",domain:T.host,uri:T.href}),N?{statement:N}:null));let $;if(Array.isArray(M)&&M[0]&&typeof M[0]=="object")$=M[0];else if(M&&typeof M=="object"&&"signedMessage"in M&&"signature"in M)$=M;else throw new Error("@supabase/auth-js: Wallet method signIn() returned unrecognized value");if("signedMessage"in $&&"signature"in $&&(typeof $.signedMessage=="string"||$.signedMessage instanceof Uint8Array)&&$.signature instanceof Uint8Array)_=typeof $.signedMessage=="string"?$.signedMessage:new TextDecoder().decode($.signedMessage),w=$.signature;else throw new Error("@supabase/auth-js: Wallet method signIn() API returned object without signedMessage and signature fields")}else{if(!("signMessage"in S)||typeof S.signMessage!="function"||!("publicKey"in S)||typeof S!="object"||!S.publicKey||!("toBase58"in S.publicKey)||typeof S.publicKey.toBase58!="function")throw new Error("@supabase/auth-js: Wallet does not have a compatible signMessage() and publicKey.toBase58() API");_=[`${T.host} wants you to sign in with your Solana account:`,S.publicKey.toBase58(),...N?["",N,""]:[""],"Version: 1",`URI: ${T.href}`,`Issued At: ${(o=(r=C==null?void 0:C.signInWithSolana)===null||r===void 0?void 0:r.issuedAt)!==null&&o!==void 0?o:new Date().toISOString()}`,...!((l=C==null?void 0:C.signInWithSolana)===null||l===void 0)&&l.notBefore?[`Not Before: ${C.signInWithSolana.notBefore}`]:[],...!((c=C==null?void 0:C.signInWithSolana)===null||c===void 0)&&c.expirationTime?[`Expiration Time: ${C.signInWithSolana.expirationTime}`]:[],...!((u=C==null?void 0:C.signInWithSolana)===null||u===void 0)&&u.chainId?[`Chain ID: ${C.signInWithSolana.chainId}`]:[],...!((h=C==null?void 0:C.signInWithSolana)===null||h===void 0)&&h.nonce?[`Nonce: ${C.signInWithSolana.nonce}`]:[],...!((f=C==null?void 0:C.signInWithSolana)===null||f===void 0)&&f.requestId?[`Request ID: ${C.signInWithSolana.requestId}`]:[],...!((g=(p=C==null?void 0:C.signInWithSolana)===null||p===void 0?void 0:p.resources)===null||g===void 0)&&g.length?["Resources",...C.signInWithSolana.resources.map($=>`- ${$}`)]:[]].join(`
`);const M=await S.signMessage(new TextEncoder().encode(_),"utf8");if(!M||!(M instanceof Uint8Array))throw new Error("@supabase/auth-js: Wallet signMessage() API returned an recognized value");w=M}}try{const{data:E,error:k}=await rt(this.fetch,"POST",`${this.url}/token?grant_type=web3`,{headers:this.headers,body:Object.assign({chain:"solana",message:_,signature:T6(w)},!((v=s.options)===null||v===void 0)&&v.captchaToken?{gotrue_meta_security:{captcha_token:(b=s.options)===null||b===void 0?void 0:b.captchaToken}}:null),xform:xr});if(k)throw k;return!E||!E.session||!E.user?{data:{user:null,session:null},error:new tc}:(E.session&&(await this._saveSession(E.session),await this._notifyAllSubscribers("SIGNED_IN",E.session)),{data:Object.assign({},E),error:k})}catch(E){if(Ke(E))return{data:{user:null,session:null},error:E};throw E}}async _exchangeCodeForSession(s){const a=await $n(this.storage,`${this.storageKey}-code-verifier`),[r,o]=(a??"").split("/");try{const{data:l,error:c}=await rt(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:s,code_verifier:r},xform:xr});if(await an(this.storage,`${this.storageKey}-code-verifier`),c)throw c;return!l||!l.session||!l.user?{data:{user:null,session:null,redirectType:null},error:new tc}:(l.session&&(await this._saveSession(l.session),await this._notifyAllSubscribers("SIGNED_IN",l.session)),{data:Object.assign(Object.assign({},l),{redirectType:o??null}),error:c})}catch(l){if(Ke(l))return{data:{user:null,session:null,redirectType:null},error:l};throw l}}async signInWithIdToken(s){try{const{options:a,provider:r,token:o,access_token:l,nonce:c}=s,u=await rt(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:o,access_token:l,nonce:c,gotrue_meta_security:{captcha_token:a==null?void 0:a.captchaToken}},xform:xr}),{data:h,error:f}=u;return f?{data:{user:null,session:null},error:f}:!h||!h.session||!h.user?{data:{user:null,session:null},error:new tc}:(h.session&&(await this._saveSession(h.session),await this._notifyAllSubscribers("SIGNED_IN",h.session)),{data:h,error:f})}catch(a){if(Ke(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithOtp(s){var a,r,o,l,c;try{if("email"in s){const{email:u,options:h}=s;let f=null,p=null;this.flowType==="pkce"&&([f,p]=await li(this.storage,this.storageKey));const{error:g}=await rt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:u,data:(a=h==null?void 0:h.data)!==null&&a!==void 0?a:{},create_user:(r=h==null?void 0:h.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},code_challenge:f,code_challenge_method:p},redirectTo:h==null?void 0:h.emailRedirectTo});return{data:{user:null,session:null},error:g}}if("phone"in s){const{phone:u,options:h}=s,{data:f,error:p}=await rt(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:u,data:(o=h==null?void 0:h.data)!==null&&o!==void 0?o:{},create_user:(l=h==null?void 0:h.shouldCreateUser)!==null&&l!==void 0?l:!0,gotrue_meta_security:{captcha_token:h==null?void 0:h.captchaToken},channel:(c=h==null?void 0:h.channel)!==null&&c!==void 0?c:"sms"}});return{data:{user:null,session:null,messageId:f==null?void 0:f.message_id},error:p}}throw new sc("You must provide either an email or phone number.")}catch(u){if(Ke(u))return{data:{user:null,session:null},error:u};throw u}}async verifyOtp(s){var a,r;try{let o,l;"options"in s&&(o=(a=s.options)===null||a===void 0?void 0:a.redirectTo,l=(r=s.options)===null||r===void 0?void 0:r.captchaToken);const{data:c,error:u}=await rt(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},s),{gotrue_meta_security:{captcha_token:l}}),redirectTo:o,xform:xr});if(u)throw u;if(!c)throw new Error("An error occurred on token verification.");const h=c.session,f=c.user;return h!=null&&h.access_token&&(await this._saveSession(h),await this._notifyAllSubscribers(s.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",h)),{data:{user:f,session:h},error:null}}catch(o){if(Ke(o))return{data:{user:null,session:null},error:o};throw o}}async signInWithSSO(s){var a,r,o;try{let l=null,c=null;return this.flowType==="pkce"&&([l,c]=await li(this.storage,this.storageKey)),await rt(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in s?{provider_id:s.providerId}:null),"domain"in s?{domain:s.domain}:null),{redirect_to:(r=(a=s.options)===null||a===void 0?void 0:a.redirectTo)!==null&&r!==void 0?r:void 0}),!((o=s==null?void 0:s.options)===null||o===void 0)&&o.captchaToken?{gotrue_meta_security:{captcha_token:s.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:l,code_challenge_method:c}),headers:this.headers,xform:W6})}catch(l){if(Ke(l))return{data:null,error:l};throw l}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async s=>{const{data:{session:a},error:r}=s;if(r)throw r;if(!a)throw new yr;const{error:o}=await rt(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:a.access_token});return{data:{user:null,session:null},error:o}})}catch(s){if(Ke(s))return{data:{user:null,session:null},error:s};throw s}}async resend(s){try{const a=`${this.url}/resend`;if("email"in s){const{email:r,type:o,options:l}=s,{error:c}=await rt(this.fetch,"POST",a,{headers:this.headers,body:{email:r,type:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}},redirectTo:l==null?void 0:l.emailRedirectTo});return{data:{user:null,session:null},error:c}}else if("phone"in s){const{phone:r,type:o,options:l}=s,{data:c,error:u}=await rt(this.fetch,"POST",a,{headers:this.headers,body:{phone:r,type:o,gotrue_meta_security:{captcha_token:l==null?void 0:l.captchaToken}}});return{data:{user:null,session:null,messageId:c==null?void 0:c.message_id},error:u}}throw new sc("You must provide either an email or phone number and a type")}catch(a){if(Ke(a))return{data:{user:null,session:null},error:a};throw a}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async a=>a))}async _acquireLock(s,a){this._debug("#_acquireLock","begin",s);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),o=(async()=>(await r,await a()))();return this.pendingInLock.push((async()=>{try{await o}catch{}})()),o}return await this.lock(`lock:${this.storageKey}`,s,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=a();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const o=[...this.pendingInLock];await Promise.all(o),this.pendingInLock.splice(0,o.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(s){this._debug("#_useSession","begin");try{const a=await this.__loadSession();return await s(a)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let s=null;const a=await $n(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",a),a!==null&&(this._isValidSession(a)?s=a:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!s)return{data:{session:null},error:null};const r=s.expires_at?s.expires_at*1e3-Date.now()<tp:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",s.expires_at),!r){if(this.userStorage){const c=await $n(this.userStorage,this.storageKey+"-user");c!=null&&c.user?s.user=c.user:s.user=ap()}if(this.storage.isServer&&s.user){let c=this.suppressGetSessionWarning;s=new Proxy(s,{get:(h,f,p)=>(!c&&f==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),c=!0,this.suppressGetSessionWarning=!0),Reflect.get(h,f,p))})}return{data:{session:s},error:null}}const{session:o,error:l}=await this._callRefreshToken(s.refresh_token);return l?{data:{session:null},error:l}:{data:{session:o},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(s){return s?await this._getUser(s):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(s){try{return s?await rt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:s,xform:on}):await this._useSession(async a=>{var r,o,l;const{data:c,error:u}=a;if(u)throw u;return!(!((r=c.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new yr}:await rt(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(l=(o=c.session)===null||o===void 0?void 0:o.access_token)!==null&&l!==void 0?l:void 0,xform:on})})}catch(a){if(Ke(a))return o1(a)&&(await this._removeSession(),await an(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:a};throw a}}async updateUser(s,a={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(s,a))}async _updateUser(s,a={}){try{return await this._useSession(async r=>{const{data:o,error:l}=r;if(l)throw l;if(!o.session)throw new yr;const c=o.session;let u=null,h=null;this.flowType==="pkce"&&s.email!=null&&([u,h]=await li(this.storage,this.storageKey));const{data:f,error:p}=await rt(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:a==null?void 0:a.emailRedirectTo,body:Object.assign(Object.assign({},s),{code_challenge:u,code_challenge_method:h}),jwt:c.access_token,xform:on});if(p)throw p;return c.user=f.user,await this._saveSession(c),await this._notifyAllSubscribers("USER_UPDATED",c),{data:{user:c.user},error:null}})}catch(r){if(Ke(r))return{data:{user:null},error:r};throw r}}async setSession(s){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(s))}async _setSession(s){try{if(!s.access_token||!s.refresh_token)throw new yr;const a=Date.now()/1e3;let r=a,o=!0,l=null;const{payload:c}=sp(s.access_token);if(c.exp&&(r=c.exp,o=r<=a),o){const{session:u,error:h}=await this._callRefreshToken(s.refresh_token);if(h)return{data:{user:null,session:null},error:h};if(!u)return{data:{user:null,session:null},error:null};l=u}else{const{data:u,error:h}=await this._getUser(s.access_token);if(h)throw h;l={access_token:s.access_token,refresh_token:s.refresh_token,user:u.user,token_type:"bearer",expires_in:r-a,expires_at:r},await this._saveSession(l),await this._notifyAllSubscribers("SIGNED_IN",l)}return{data:{user:l.user,session:l},error:null}}catch(a){if(Ke(a))return{data:{session:null,user:null},error:a};throw a}}async refreshSession(s){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(s))}async _refreshSession(s){try{return await this._useSession(async a=>{var r;if(!s){const{data:c,error:u}=a;if(u)throw u;s=(r=c.session)!==null&&r!==void 0?r:void 0}if(!(s!=null&&s.refresh_token))throw new yr;const{session:o,error:l}=await this._callRefreshToken(s.refresh_token);return l?{data:{user:null,session:null},error:l}:o?{data:{user:o.user,session:o},error:null}:{data:{user:null,session:null},error:null}})}catch(a){if(Ke(a))return{data:{user:null,session:null},error:a};throw a}}async _getSessionFromURL(s,a){try{if(!ba())throw new ac("No browser detected.");if(s.error||s.error_description||s.error_code)throw new ac(s.error_description||"Error in URL with unspecified error_description",{error:s.error||"unspecified_error",code:s.error_code||"unspecified_code"});switch(a){case"implicit":if(this.flowType==="pkce")throw new qp("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ac("Not a valid implicit grant flow url.");break;default:}if(a==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!s.code)throw new qp("No code detected.");const{data:N,error:C}=await this._exchangeCodeForSession(s.code);if(C)throw C;const S=new URL(window.location.href);return S.searchParams.delete("code"),window.history.replaceState(window.history.state,"",S.toString()),{data:{session:N.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:o,access_token:l,refresh_token:c,expires_in:u,expires_at:h,token_type:f}=s;if(!l||!u||!c||!f)throw new ac("No session defined in URL");const p=Math.round(Date.now()/1e3),g=parseInt(u);let v=p+g;h&&(v=parseInt(h));const b=v-p;b*1e3<=xi&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${b}s, should have been closer to ${g}s`);const _=v-g;p-_>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",_,v,p):p-_<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",_,v,p);const{data:w,error:E}=await this._getUser(l);if(E)throw E;const k={provider_token:r,provider_refresh_token:o,access_token:l,expires_in:g,expires_at:v,refresh_token:c,token_type:f,user:w.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:k,redirectType:s.type},error:null}}catch(r){if(Ke(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(s){return!!(s.access_token||s.error_description)}async _isPKCECallback(s){const a=await $n(this.storage,`${this.storageKey}-code-verifier`);return!!(s.code&&a)}async signOut(s={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(s))}async _signOut({scope:s}={scope:"global"}){return await this._useSession(async a=>{var r;const{data:o,error:l}=a;if(l)return{error:l};const c=(r=o.session)===null||r===void 0?void 0:r.access_token;if(c){const{error:u}=await this.admin.signOut(c,s);if(u&&!(n1(u)&&(u.status===404||u.status===401||u.status===403)))return{error:u}}return s!=="others"&&(await this._removeSession(),await an(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(s){const a=A6(),r={id:a,callback:s,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",a),this.stateChangeEmitters.delete(a)}};return this._debug("#onAuthStateChange()","registered callback with id",a),this.stateChangeEmitters.set(a,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(a)})))(),{data:{subscription:r}}}async _emitInitialSession(s){return await this._useSession(async a=>{var r,o;try{const{data:{session:l},error:c}=a;if(c)throw c;await((r=this.stateChangeEmitters.get(s))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",l)),this._debug("INITIAL_SESSION","callback id",s,"session",l)}catch(l){await((o=this.stateChangeEmitters.get(s))===null||o===void 0?void 0:o.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",s,"error",l),console.error(l)}})}async resetPasswordForEmail(s,a={}){let r=null,o=null;this.flowType==="pkce"&&([r,o]=await li(this.storage,this.storageKey,!0));try{return await rt(this.fetch,"POST",`${this.url}/recover`,{body:{email:s,code_challenge:r,code_challenge_method:o,gotrue_meta_security:{captcha_token:a.captchaToken}},headers:this.headers,redirectTo:a.redirectTo})}catch(l){if(Ke(l))return{data:null,error:l};throw l}}async getUserIdentities(){var s;try{const{data:a,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(s=a.user.identities)!==null&&s!==void 0?s:[]},error:null}}catch(a){if(Ke(a))return{data:null,error:a};throw a}}async linkIdentity(s){var a;try{const{data:r,error:o}=await this._useSession(async l=>{var c,u,h,f,p;const{data:g,error:v}=l;if(v)throw v;const b=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,s.provider,{redirectTo:(c=s.options)===null||c===void 0?void 0:c.redirectTo,scopes:(u=s.options)===null||u===void 0?void 0:u.scopes,queryParams:(h=s.options)===null||h===void 0?void 0:h.queryParams,skipBrowserRedirect:!0});return await rt(this.fetch,"GET",b,{headers:this.headers,jwt:(p=(f=g.session)===null||f===void 0?void 0:f.access_token)!==null&&p!==void 0?p:void 0})});if(o)throw o;return ba()&&!(!((a=s.options)===null||a===void 0)&&a.skipBrowserRedirect)&&window.location.assign(r==null?void 0:r.url),{data:{provider:s.provider,url:r==null?void 0:r.url},error:null}}catch(r){if(Ke(r))return{data:{provider:s.provider,url:null},error:r};throw r}}async unlinkIdentity(s){try{return await this._useSession(async a=>{var r,o;const{data:l,error:c}=a;if(c)throw c;return await rt(this.fetch,"DELETE",`${this.url}/user/identities/${s.identity_id}`,{headers:this.headers,jwt:(o=(r=l.session)===null||r===void 0?void 0:r.access_token)!==null&&o!==void 0?o:void 0})})}catch(a){if(Ke(a))return{data:null,error:a};throw a}}async _refreshAccessToken(s){const a=`#_refreshAccessToken(${s.substring(0,5)}...)`;this._debug(a,"begin");try{const r=Date.now();return await D6(async o=>(o>0&&await O6(200*Math.pow(2,o-1)),this._debug(a,"refreshing attempt",o),await rt(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:s},headers:this.headers,xform:xr})),(o,l)=>{const c=200*Math.pow(2,o);return l&&Nu(l)&&Date.now()+c-r<xi})}catch(r){if(this._debug(a,"error",r),Ke(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(a,"end")}}_isValidSession(s){return typeof s=="object"&&s!==null&&"access_token"in s&&"refresh_token"in s&&"expires_at"in s}async _handleProviderSignIn(s,a){const r=await this._getUrlForProvider(`${this.url}/authorize`,s,{redirectTo:a.redirectTo,scopes:a.scopes,queryParams:a.queryParams});return this._debug("#_handleProviderSignIn()","provider",s,"options",a,"url",r),ba()&&!a.skipBrowserRedirect&&window.location.assign(r),{data:{provider:s,url:r},error:null}}async _recoverAndRefresh(){var s,a;const r="#_recoverAndRefresh()";this._debug(r,"begin");try{const o=await $n(this.storage,this.storageKey);if(o&&this.userStorage){let c=await $n(this.userStorage,this.storageKey+"-user");!this.storage.isServer&&Object.is(this.storage,this.userStorage)&&!c&&(c={user:o.user},await yi(this.userStorage,this.storageKey+"-user",c)),o.user=(s=c==null?void 0:c.user)!==null&&s!==void 0?s:ap()}else if(o&&!o.user&&!o.user){const c=await $n(this.storage,this.storageKey+"-user");c&&(c!=null&&c.user)?(o.user=c.user,await an(this.storage,this.storageKey+"-user"),await yi(this.storage,this.storageKey,o)):o.user=ap()}if(this._debug(r,"session from storage",o),!this._isValidSession(o)){this._debug(r,"session is not valid"),o!==null&&await this._removeSession();return}const l=((a=o.expires_at)!==null&&a!==void 0?a:1/0)*1e3-Date.now()<tp;if(this._debug(r,`session has${l?"":" not"} expired with margin of ${tp}s`),l){if(this.autoRefreshToken&&o.refresh_token){const{error:c}=await this._callRefreshToken(o.refresh_token);c&&(console.error(c),Nu(c)||(this._debug(r,"refresh failed with a non-retryable error, removing the session",c),await this._removeSession()))}}else if(o.user&&o.user.__isUserNotAvailableProxy===!0)try{const{data:c,error:u}=await this._getUser(o.access_token);!u&&(c!=null&&c.user)?(o.user=c.user,await this._saveSession(o),await this._notifyAllSubscribers("SIGNED_IN",o)):this._debug(r,"could not get user data, skipping SIGNED_IN notification")}catch(c){console.error("Error getting user data:",c),this._debug(r,"error getting user data, skipping SIGNED_IN notification",c)}else await this._notifyAllSubscribers("SIGNED_IN",o)}catch(o){this._debug(r,"error",o),console.error(o);return}finally{this._debug(r,"end")}}async _callRefreshToken(s){var a,r;if(!s)throw new yr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const o=`#_callRefreshToken(${s.substring(0,5)}...)`;this._debug(o,"begin");try{this.refreshingDeferred=new fm;const{data:l,error:c}=await this._refreshAccessToken(s);if(c)throw c;if(!l.session)throw new yr;await this._saveSession(l.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",l.session);const u={session:l.session,error:null};return this.refreshingDeferred.resolve(u),u}catch(l){if(this._debug(o,"error",l),Ke(l)){const c={session:null,error:l};return Nu(l)||await this._removeSession(),(a=this.refreshingDeferred)===null||a===void 0||a.resolve(c),c}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(l),l}finally{this.refreshingDeferred=null,this._debug(o,"end")}}async _notifyAllSubscribers(s,a,r=!0){const o=`#_notifyAllSubscribers(${s})`;this._debug(o,"begin",a,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:s,session:a});const l=[],c=Array.from(this.stateChangeEmitters.values()).map(async u=>{try{await u.callback(s,a)}catch(h){l.push(h)}});if(await Promise.all(c),l.length>0){for(let u=0;u<l.length;u+=1)console.error(l[u]);throw l[0]}}finally{this._debug(o,"end")}}async _saveSession(s){this._debug("#_saveSession()",s),this.suppressGetSessionWarning=!0;const a=Object.assign({},s),r=a.user&&a.user.__isUserNotAvailableProxy===!0;if(this.userStorage){!r&&a.user&&await yi(this.userStorage,this.storageKey+"-user",{user:a.user});const o=Object.assign({},a);delete o.user;const l=sw(o);await yi(this.storage,this.storageKey,l)}else{const o=sw(a);await yi(this.storage,this.storageKey,o)}}async _removeSession(){this._debug("#_removeSession()"),await an(this.storage,this.storageKey),await an(this.storage,this.storageKey+"-code-verifier"),await an(this.storage,this.storageKey+"-user"),this.userStorage&&await an(this.userStorage,this.storageKey+"-user"),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const s=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{s&&ba()&&(window!=null&&window.removeEventListener)&&window.removeEventListener("visibilitychange",s)}catch(a){console.error("removing visibilitychange callback failed",a)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const s=setInterval(()=>this._autoRefreshTokenTick(),xi);this.autoRefreshTicker=s,s&&typeof s=="object"&&typeof s.unref=="function"?s.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(s),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const s=this.autoRefreshTicker;this.autoRefreshTicker=null,s&&clearInterval(s)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const s=Date.now();try{return await this._useSession(async a=>{const{data:{session:r}}=a;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const o=Math.floor((r.expires_at*1e3-s)/xi);this._debug("#_autoRefreshTokenTick()",`access token expires in ${o} ticks, a tick lasts ${xi}ms, refresh threshold is ${Bp} ticks`),o<=Bp&&await this._callRefreshToken(r.refresh_token)})}catch(a){console.error("Auto refresh tick failed with error. This is likely a transient error.",a)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(s){if(s.isAcquireTimeout||s instanceof m1)this._debug("auto refresh token tick lock not available");else throw s}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ba()||!(window!=null&&window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window==null||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(s){console.error("_handleVisibilityChange",s)}}async _onVisibilityChanged(s){const a=`#_onVisibilityChanged(${s})`;this._debug(a,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),s||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(a,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(s,a,r){const o=[`provider=${encodeURIComponent(a)}`];if(r!=null&&r.redirectTo&&o.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r!=null&&r.scopes&&o.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[l,c]=await li(this.storage,this.storageKey),u=new URLSearchParams({code_challenge:`${encodeURIComponent(l)}`,code_challenge_method:`${encodeURIComponent(c)}`});o.push(u.toString())}if(r!=null&&r.queryParams){const l=new URLSearchParams(r.queryParams);o.push(l.toString())}return r!=null&&r.skipBrowserRedirect&&o.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${s}?${o.join("&")}`}async _unenroll(s){try{return await this._useSession(async a=>{var r;const{data:o,error:l}=a;return l?{data:null,error:l}:await rt(this.fetch,"DELETE",`${this.url}/factors/${s.factorId}`,{headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(a){if(Ke(a))return{data:null,error:a};throw a}}async _enroll(s){try{return await this._useSession(async a=>{var r,o;const{data:l,error:c}=a;if(c)return{data:null,error:c};const u=Object.assign({friendly_name:s.friendlyName,factor_type:s.factorType},s.factorType==="phone"?{phone:s.phone}:{issuer:s.issuer}),{data:h,error:f}=await rt(this.fetch,"POST",`${this.url}/factors`,{body:u,headers:this.headers,jwt:(r=l==null?void 0:l.session)===null||r===void 0?void 0:r.access_token});return f?{data:null,error:f}:(s.factorType==="totp"&&(!((o=h==null?void 0:h.totp)===null||o===void 0)&&o.qr_code)&&(h.totp.qr_code=`data:image/svg+xml;utf-8,${h.totp.qr_code}`),{data:h,error:null})})}catch(a){if(Ke(a))return{data:null,error:a};throw a}}async _verify(s){return this._acquireLock(-1,async()=>{try{return await this._useSession(async a=>{var r;const{data:o,error:l}=a;if(l)return{data:null,error:l};const{data:c,error:u}=await rt(this.fetch,"POST",`${this.url}/factors/${s.factorId}/verify`,{body:{code:s.code,challenge_id:s.challengeId},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token});return u?{data:null,error:u}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+c.expires_in},c)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",c),{data:c,error:u})})}catch(a){if(Ke(a))return{data:null,error:a};throw a}})}async _challenge(s){return this._acquireLock(-1,async()=>{try{return await this._useSession(async a=>{var r;const{data:o,error:l}=a;return l?{data:null,error:l}:await rt(this.fetch,"POST",`${this.url}/factors/${s.factorId}/challenge`,{body:{channel:s.channel},headers:this.headers,jwt:(r=o==null?void 0:o.session)===null||r===void 0?void 0:r.access_token})})}catch(a){if(Ke(a))return{data:null,error:a};throw a}})}async _challengeAndVerify(s){const{data:a,error:r}=await this._challenge({factorId:s.factorId});return r?{data:null,error:r}:await this._verify({factorId:s.factorId,challengeId:a.id,code:s.code})}async _listFactors(){const{data:{user:s},error:a}=await this.getUser();if(a)return{data:null,error:a};const r=(s==null?void 0:s.factors)||[],o=r.filter(c=>c.factor_type==="totp"&&c.status==="verified"),l=r.filter(c=>c.factor_type==="phone"&&c.status==="verified");return{data:{all:r,totp:o,phone:l},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async s=>{var a,r;const{data:{session:o},error:l}=s;if(l)return{data:null,error:l};if(!o)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const{payload:c}=sp(o.access_token);let u=null;c.aal&&(u=c.aal);let h=u;((r=(a=o.user.factors)===null||a===void 0?void 0:a.filter(g=>g.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(h="aal2");const p=c.amr||[];return{data:{currentLevel:u,nextLevel:h,currentAuthenticationMethods:p},error:null}}))}async fetchJwk(s,a={keys:[]}){let r=a.keys.find(u=>u.kid===s);if(r)return r;const o=Date.now();if(r=this.jwks.keys.find(u=>u.kid===s),r&&this.jwks_cached_at+w6>o)return r;const{data:l,error:c}=await rt(this.fetch,"GET",`${this.url}/.well-known/jwks.json`,{headers:this.headers});if(c)throw c;return!l.keys||l.keys.length===0||(this.jwks=l,this.jwks_cached_at=o,r=l.keys.find(u=>u.kid===s),!r)?null:r}async getClaims(s,a={}){try{let r=s;if(!r){const{data:b,error:_}=await this.getSession();if(_||!b.session)return{data:null,error:_};r=b.session.access_token}const{header:o,payload:l,signature:c,raw:{header:u,payload:h}}=sp(r);a!=null&&a.allowExpired||B6(l.exp);const f=!o.alg||o.alg.startsWith("HS")||!o.kid||!("crypto"in globalThis&&"subtle"in globalThis.crypto)?null:await this.fetchJwk(o.kid,a!=null&&a.keys?{keys:a.keys}:a==null?void 0:a.jwks);if(!f){const{error:b}=await this.getUser(r);if(b)throw b;return{data:{claims:l,header:o,signature:c},error:null}}const p=V6(o.alg),g=await crypto.subtle.importKey("jwk",f,p,!0,["verify"]);if(!await crypto.subtle.verify(p,g,c,C6(`${u}.${h}`)))throw new Iu("Invalid JWT signature");return{data:{claims:l,header:o,signature:c},error:null}}catch(r){if(Ke(r))return{data:null,error:r};throw r}}}Di.nextInstanceID=0;const p1=Di;class t3 extends p1{constructor(s){super(s)}}var s3=function(t,s,a,r){function o(l){return l instanceof a?l:new a(function(c){c(l)})}return new(a||(a=Promise))(function(l,c){function u(p){try{f(r.next(p))}catch(g){c(g)}}function h(p){try{f(r.throw(p))}catch(g){c(g)}}function f(p){p.done?l(p.value):o(p.value).then(u,h)}f((r=r.apply(t,s||[])).next())})};class g1{constructor(s,a,r){var o,l,c;if(this.supabaseUrl=s,this.supabaseKey=a,!s)throw new Error("supabaseUrl is required.");if(!a)throw new Error("supabaseKey is required.");const u=p6(s),h=new URL(u);this.realtimeUrl=new URL("realtime/v1",h),this.realtimeUrl.protocol=this.realtimeUrl.protocol.replace("http","ws"),this.authUrl=new URL("auth/v1",h),this.storageUrl=new URL("storage/v1",h),this.functionsUrl=new URL("functions/v1",h);const f=`sb-${h.hostname.split(".")[0]}-auth-token`,p={db:i6,realtime:c6,auth:Object.assign(Object.assign({},l6),{storageKey:f}),global:o6},g=g6(r??{},p);this.storageKey=(o=g.auth.storageKey)!==null&&o!==void 0?o:"",this.headers=(l=g.global.headers)!==null&&l!==void 0?l:{},g.accessToken?(this.accessToken=g.accessToken,this.auth=new Proxy({},{get:(v,b)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(b)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((c=g.auth)!==null&&c!==void 0?c:{},this.headers,g.global.fetch),this.fetch=h6(a,this._getAccessToken.bind(this),g.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},g.realtime)),this.rest=new T5(new URL("rest/v1",h).href,{headers:this.headers,schema:g.db.schema,fetch:this.fetch}),this.storage=new a6(this.storageUrl.href,this.headers,this.fetch,r==null?void 0:r.storage),g.accessToken||this._listenForAuthEvents()}get functions(){return new y5(this.functionsUrl.href,{headers:this.headers,customFetch:this.fetch})}from(s){return this.rest.from(s)}schema(s){return this.rest.schema(s)}rpc(s,a={},r={}){return this.rest.rpc(s,a,r)}channel(s,a={config:{}}){return this.realtime.channel(s,a)}getChannels(){return this.realtime.getChannels()}removeChannel(s){return this.realtime.removeChannel(s)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var s,a;return s3(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(a=(s=r.session)===null||s===void 0?void 0:s.access_token)!==null&&a!==void 0?a:this.supabaseKey})}_initSupabaseAuthClient({autoRefreshToken:s,persistSession:a,detectSessionInUrl:r,storage:o,storageKey:l,flowType:c,lock:u,debug:h},f,p){const g={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new t3({url:this.authUrl.href,headers:Object.assign(Object.assign({},g),f),storageKey:l,autoRefreshToken:s,persistSession:a,detectSessionInUrl:r,storage:o,flowType:c,lock:u,debug:h,fetch:p,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(s){return new J_(this.realtimeUrl.href,Object.assign(Object.assign({},s),{params:Object.assign({apikey:this.supabaseKey},s==null?void 0:s.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((a,r)=>{this._handleTokenChanged(a,"CLIENT",r==null?void 0:r.access_token)})}_handleTokenChanged(s,a,r){(s==="TOKEN_REFRESHED"||s==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:s==="SIGNED_OUT"&&(this.realtime.setAuth(),a=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const Pi=(t,s,a)=>new g1(t,s,a);function a3(){if(typeof window<"u"||typeof process>"u")return!1;const t=process.version;if(t==null)return!1;const s=t.match(/^v(\d+)\./);return s?parseInt(s[1],10)<=18:!1}a3()&&console.warn("⚠️  Node.js 18 and below are deprecated and will no longer be supported in future versions of @supabase/supabase-js. Please upgrade to Node.js 20 or later. For more information, visit: https://github.com/orgs/supabase/discussions/37217");const r3=Object.freeze(Object.defineProperty({__proto__:null,AuthApiError:r1,AuthClient:p1,AuthError:hm,AuthImplicitGrantRedirectError:ac,AuthInvalidCredentialsError:sc,AuthInvalidJwtError:Iu,AuthInvalidTokenResponseError:tc,AuthPKCEGrantCodeExchangeError:qp,AuthRetryableFetchError:$u,AuthSessionMissingError:yr,AuthUnknownError:$0,AuthWeakPasswordError:Fp,CustomAuthError:Ar,get FunctionRegion(){return Pu},FunctionsError:um,FunctionsFetchError:V_,FunctionsHttpError:Rp,FunctionsRelayError:Mp,GoTrueAdminApi:u1,GoTrueClient:Di,NavigatorLockAcquireTimeoutError:h1,PostgrestError:k5,get REALTIME_LISTEN_TYPES(){return Ci},get REALTIME_POSTGRES_CHANGES_LISTEN_EVENT(){return $p},get REALTIME_PRESENCE_LISTEN_EVENTS(){return zp},get REALTIME_SUBSCRIBE_STATES(){return za},RealtimeChannel:mm,RealtimeClient:J_,RealtimePresence:Ei,SIGN_OUT_SCOPES:Su,SupabaseClient:g1,WebSocketFactory:Y_,createClient:Pi,isAuthApiError:n1,isAuthError:Ke,isAuthImplicitGrantRedirectError:i1,isAuthRetryableFetchError:Nu,isAuthSessionMissingError:o1,lockInternals:Bn,navigatorLock:f1},Symbol.toStringTag,{value:"Module"})),n3={development:{name:"development",supabaseUrl:"https://wznycskqsavpmejwpksp.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind6bnljc2txc2F2cG1landwa3NwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2MzA2NjUsImV4cCI6MjA3MjIwNjY2NX0.uYXbBwQDo1pLeBrmtZnBR2M3a3_TsYDa637pcKSVC_8",supabaseServiceRoleKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp0ZmR6am1yYXZrZXRwa3dqa3ZwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1ODM2MzU2MiwiZXhwIjoyMDczOTM5NTYyfQ.JhWvMLkw4Sp71PfMQzm37u2iHf_flIH8RDZUCkMRtq4",databaseName:"wznycskqsavpmejwpksp",gitBranch:"desenvolvimento",debugMode:!0,logLevel:"debug"},production:{name:"production",supabaseUrl:"https://wznycskqsavpmejwpksp.supabase.co",supabaseAnonKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Ind6bnljc2txc2F2cG1landwa3NwIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTY2MzA2NjUsImV4cCI6MjA3MjIwNjY2NX0.uYXbBwQDo1pLeBrmtZnBR2M3a3_TsYDa637pcKSVC_8",supabaseServiceRoleKey:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Imp0ZmR6am1yYXZrZXRwa3dqa3ZwIiwicm9sZSI6InNlcnZpY2Vfcm9sZSIsImlhdCI6MTc1ODM2MzU2MiwiZXhwIjoyMDczOTM5NTYyfQ.JhWvMLkw4Sp71PfMQzm37u2iHf_flIH8RDZUCkMRtq4",databaseName:"wznycskqsavpmejwpksp",gitBranch:"main",debugMode:!1,logLevel:"error"}};class o3{constructor(){dt(this,"currentConfig",null);dt(this,"lastValidation",null);dt(this,"initialized",!1);this.initializeEnvironmentSync()}initializeEnvironmentSync(){try{console.log("🔧 Inicializando gerenciador de ambiente...");const s=this.detectEnvironment();console.log(`🎯 Ambiente detectado: ${s}`),this.loadEnvironmentConfigSync(s),this.initialized=!0}catch(s){console.error("❌ Erro ao inicializar ambiente:",s),this.loadEnvironmentConfigSync("development"),this.initialized=!0}}detectEnvironment(){console.log("🔍 VITE_ENVIRONMENT: test"),console.log("🔍 VERCEL_ENV: undefined");const r="https://wznycskqsavpmejwpksp.supabase.co";return console.log(`🔍 VITE_SUPABASE_URL: ${r}`),r.includes("jtfdzjmravketpkwjkvp")?(console.log("🎯 URL de produção detectada → Ambiente: production"),"production"):(console.log("🌿 Branch Git detectada: test/vercel-aabb-test"),console.log("🎯 Ambiente padrão: development"),"development")}loadEnvironmentConfigSync(s){const a=n3[s];if(!a)throw new Error(`Configuração não encontrada para ambiente: ${s}`);const o=["supabaseUrl","supabaseAnonKey","supabaseServiceRoleKey"].filter(l=>!a[l]);o.length>0&&console.warn(`⚠️ Campos obrigatórios ausentes para ${s}:`,o),this.currentConfig=a,console.log(`✅ Configuração carregada para ambiente: ${s}`),console.log(`📊 Database: ${a.databaseName}`),console.log(`🔗 URL: ${a.supabaseUrl}`)}async loadEnvironmentConfig(s){this.loadEnvironmentConfigSync(s)}getCurrentEnvironment(){if((!this.initialized||!this.currentConfig)&&this.initializeEnvironmentSync(),!this.currentConfig)throw new Error("Ambiente não inicializado corretamente.");return this.currentConfig}async switchEnvironment(s){console.log(`🔄 Alternando para ambiente: ${s}`);try{await this.loadEnvironmentConfig(s),this.currentConfig&&(await this.validateConnection(this.currentConfig)||console.warn(`⚠️ Conectividade falhou para ambiente: ${s}`)),console.log(`✅ Ambiente alternado com sucesso: ${s}`)}catch(a){throw console.error(`❌ Erro ao alternar para ambiente ${s}:`,a),a}}async validateConnection(s){try{console.log(`🔍 Validando conectividade com ${s.name}...`);const{createClient:a}=await ha(async()=>{const{createClient:c}=await Promise.resolve().then(()=>r3);return{createClient:c}},void 0),r=a(s.supabaseUrl,s.supabaseAnonKey),{data:o,error:l}=await r.from("usuarios_empresa").select("count").limit(1);return l?(console.error(`❌ Erro de conectividade (${s.name}):`,l.message),!1):(this.lastValidation=new Date,console.log(`✅ Conectividade OK (${s.name})`),!0)}catch(a){return console.error(`❌ Erro inesperado na validação (${s.name}):`,a),!1}}async getEnvironmentInfo(){const s=this.getCurrentEnvironment(),a=await this.validateConnection(s);return{currentEnvironment:s.name,gitBranch:s.gitBranch,supabaseConnected:a,databaseName:s.databaseName,lastValidated:this.lastValidation||new Date}}}const pm=new o3;let vc=null,wc=null,rc=null;const iw=(t,s=!1)=>{const a=s?t.supabaseServiceRoleKey:t.supabaseAnonKey;return!(t.supabaseUrl&&t.supabaseUrl!=="https://your-project-dev.supabase.co"&&t.supabaseUrl!=="https://your-project-prod.supabase.co")||!(a&&a!=="your_development_anon_key_here"&&a!=="your_production_anon_key_here"&&a!=="your_development_service_role_key_here"&&a!=="your_production_service_role_key_here")?(console.warn(`⚠️ Configuração do Supabase não definida para ambiente ${t.name}. Usando cliente mock.`),Pi("https://mock.supabase.co","mock-key")):Pi(t.supabaseUrl,a,{auth:{autoRefreshToken:!s,persistSession:!s,detectSessionInUrl:!s,storageKey:`sb-${t.databaseName}-${s?"admin":"auth"}-token`}})},gm=()=>{try{const t=pm.getCurrentEnvironment();(!rc||rc.name!==t.name||rc.supabaseUrl!==t.supabaseUrl)&&(console.log(`🔧 Inicializando clientes Supabase para ambiente: ${t.name}`),vc=iw(t,!1),wc=iw(t,!0),rc=t,console.log(`✅ Clientes Supabase configurados para: ${t.databaseName}`))}catch(t){console.error("❌ Erro ao inicializar clientes Supabase:",t),vc=Pi("https://mock.supabase.co","mock-key"),wc=Pi("https://mock.supabase.co","mock-key")}};gm();const i3=()=>(vc||gm(),vc),l3=()=>(wc||gm(),wc),B=i3(),ut=l3(),c3=()=>{vc=null,wc=null,rc=null,gm()},Eu=()=>{try{const t=pm.getCurrentEnvironment(),s=t.supabaseUrl&&t.supabaseUrl!=="https://your-project-dev.supabase.co"&&t.supabaseUrl!=="https://your-project-prod.supabase.co"&&t.supabaseUrl!=="https://mock.supabase.co",a=t.supabaseAnonKey&&t.supabaseAnonKey!=="your_development_anon_key_here"&&t.supabaseAnonKey!=="your_production_anon_key_here"&&t.supabaseAnonKey!=="mock-anon-key";return!!(s&&a)}catch{return!1}},Ht=()=>{try{const t=pm.getCurrentEnvironment(),s=t.supabaseUrl&&t.supabaseUrl!=="https://your-project-dev.supabase.co"&&t.supabaseUrl!=="https://your-project-prod.supabase.co"&&t.supabaseUrl!=="https://mock.supabase.co",a=t.supabaseAnonKey&&t.supabaseAnonKey!=="your_development_anon_key_here"&&t.supabaseAnonKey!=="your_production_anon_key_here"&&t.supabaseAnonKey!=="mock-anon-key",r=t.supabaseServiceRoleKey&&t.supabaseServiceRoleKey!=="your_development_service_role_key_here"&&t.supabaseServiceRoleKey!=="your_production_service_role_key_here"&&t.supabaseServiceRoleKey!=="mock-service-role-key";return!!(s&&a&&r)}catch{return!1}},iu={DEMO_USER:{email:"demo@clubmanager.com",name:"Usuário Demo",role:"admin"}},I0=y.createContext({});function L0(t){const s=y.useRef(null);return s.current===null&&(s.current=t()),s.current}const U0=typeof window<"u",x1=U0?y.useLayoutEffect:y.useEffect,xm=y.createContext(null);function B0(t,s){t.indexOf(s)===-1&&t.push(s)}function V0(t,s){const a=t.indexOf(s);a>-1&&t.splice(a,1)}const Er=(t,s,a)=>a>s?s:a<t?t:a;let q0=()=>{};const Cr={},y1=t=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(t);function b1(t){return typeof t=="object"&&t!==null}const v1=t=>/^0[^.\s]+$/u.test(t);function F0(t){let s;return()=>(s===void 0&&(s=t()),s)}const ua=t=>t,d3=(t,s)=>a=>s(t(a)),Lc=(...t)=>t.reduce(d3),jc=(t,s,a)=>{const r=s-t;return r===0?1:(a-t)/r};class H0{constructor(){this.subscriptions=[]}add(s){return B0(this.subscriptions,s),()=>V0(this.subscriptions,s)}notify(s,a,r){const o=this.subscriptions.length;if(o)if(o===1)this.subscriptions[0](s,a,r);else for(let l=0;l<o;l++){const c=this.subscriptions[l];c&&c(s,a,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}const qa=t=>t*1e3,Fa=t=>t/1e3;function w1(t,s){return s?t*(1e3/s):0}const j1=(t,s,a)=>(((1-3*a+3*s)*t+(3*a-6*s))*t+3*s)*t,u3=1e-7,m3=12;function h3(t,s,a,r,o){let l,c,u=0;do c=s+(a-s)/2,l=j1(c,r,o)-t,l>0?a=c:s=c;while(Math.abs(l)>u3&&++u<m3);return c}function Uc(t,s,a,r){if(t===s&&a===r)return ua;const o=l=>h3(l,0,1,t,a);return l=>l===0||l===1?l:j1(o(l),s,r)}const _1=t=>s=>s<=.5?t(2*s)/2:(2-t(2*(1-s)))/2,N1=t=>s=>1-t(1-s),S1=Uc(.33,1.53,.69,.99),G0=N1(S1),E1=_1(G0),C1=t=>(t*=2)<1?.5*G0(t):.5*(2-Math.pow(2,-10*(t-1))),Z0=t=>1-Math.sin(Math.acos(t)),T1=N1(Z0),k1=_1(Z0),f3=Uc(.42,0,1,1),p3=Uc(0,0,.58,1),A1=Uc(.42,0,.58,1),g3=t=>Array.isArray(t)&&typeof t[0]!="number",M1=t=>Array.isArray(t)&&typeof t[0]=="number",x3={linear:ua,easeIn:f3,easeInOut:A1,easeOut:p3,circIn:Z0,circInOut:k1,circOut:T1,backIn:G0,backInOut:E1,backOut:S1,anticipate:C1},y3=t=>typeof t=="string",lw=t=>{if(M1(t)){q0(t.length===4);const[s,a,r,o]=t;return Uc(s,a,r,o)}else if(y3(t))return x3[t];return t},lu=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"];function b3(t,s){let a=new Set,r=new Set,o=!1,l=!1;const c=new WeakSet;let u={delta:0,timestamp:0,isProcessing:!1};function h(p){c.has(p)&&(f.schedule(p),t()),p(u)}const f={schedule:(p,g=!1,v=!1)=>{const _=v&&o?a:r;return g&&c.add(p),_.has(p)||_.add(p),p},cancel:p=>{r.delete(p),c.delete(p)},process:p=>{if(u=p,o){l=!0;return}o=!0,[a,r]=[r,a],a.forEach(h),a.clear(),o=!1,l&&(l=!1,f.process(p))}};return f}const v3=40;function R1(t,s){let a=!1,r=!0;const o={delta:0,timestamp:0,isProcessing:!1},l=()=>a=!0,c=lu.reduce((C,S)=>(C[S]=b3(l),C),{}),{setup:u,read:h,resolveKeyframes:f,preUpdate:p,update:g,preRender:v,render:b,postRender:_}=c,w=()=>{const C=Cr.useManualTiming?o.timestamp:performance.now();a=!1,Cr.useManualTiming||(o.delta=r?1e3/60:Math.max(Math.min(C-o.timestamp,v3),1)),o.timestamp=C,o.isProcessing=!0,u.process(o),h.process(o),f.process(o),p.process(o),g.process(o),v.process(o),b.process(o),_.process(o),o.isProcessing=!1,a&&s&&(r=!1,t(w))},E=()=>{a=!0,r=!0,o.isProcessing||t(w)};return{schedule:lu.reduce((C,S)=>{const T=c[S];return C[S]=(M,$=!1,A=!1)=>(a||E(),T.schedule(M,$,A)),C},{}),cancel:C=>{for(let S=0;S<lu.length;S++)c[lu[S]].cancel(C)},state:o,steps:c}}const{schedule:At,cancel:dn,state:ys,steps:rp}=R1(typeof requestAnimationFrame<"u"?requestAnimationFrame:ua,!0);let Cu;function w3(){Cu=void 0}const zs={now:()=>(Cu===void 0&&zs.set(ys.isProcessing||Cr.useManualTiming?ys.timestamp:performance.now()),Cu),set:t=>{Cu=t,queueMicrotask(w3)}},O1=t=>s=>typeof s=="string"&&s.startsWith(t),W0=O1("--"),j3=O1("var(--"),Y0=t=>j3(t)?_3.test(t.split("/*")[0].trim()):!1,_3=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,Hi={test:t=>typeof t=="number",parse:parseFloat,transform:t=>t},_c={...Hi,transform:t=>Er(0,1,t)},cu={...Hi,default:1},lc=t=>Math.round(t*1e5)/1e5,K0=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function N3(t){return t==null}const S3=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,X0=(t,s)=>a=>!!(typeof a=="string"&&S3.test(a)&&a.startsWith(t)||s&&!N3(a)&&Object.prototype.hasOwnProperty.call(a,s)),D1=(t,s,a)=>r=>{if(typeof r!="string")return r;const[o,l,c,u]=r.match(K0);return{[t]:parseFloat(o),[s]:parseFloat(l),[a]:parseFloat(c),alpha:u!==void 0?parseFloat(u):1}},E3=t=>Er(0,255,t),np={...Hi,transform:t=>Math.round(E3(t))},Qn={test:X0("rgb","red"),parse:D1("red","green","blue"),transform:({red:t,green:s,blue:a,alpha:r=1})=>"rgba("+np.transform(t)+", "+np.transform(s)+", "+np.transform(a)+", "+lc(_c.transform(r))+")"};function C3(t){let s="",a="",r="",o="";return t.length>5?(s=t.substring(1,3),a=t.substring(3,5),r=t.substring(5,7),o=t.substring(7,9)):(s=t.substring(1,2),a=t.substring(2,3),r=t.substring(3,4),o=t.substring(4,5),s+=s,a+=a,r+=r,o+=o),{red:parseInt(s,16),green:parseInt(a,16),blue:parseInt(r,16),alpha:o?parseInt(o,16)/255:1}}const Hp={test:X0("#"),parse:C3,transform:Qn.transform},Bc=t=>({test:s=>typeof s=="string"&&s.endsWith(t)&&s.split(" ").length===1,parse:parseFloat,transform:s=>`${s}${t}`}),nn=Bc("deg"),Ha=Bc("%"),We=Bc("px"),T3=Bc("vh"),k3=Bc("vw"),cw={...Ha,parse:t=>Ha.parse(t)/100,transform:t=>Ha.transform(t*100)},bi={test:X0("hsl","hue"),parse:D1("hue","saturation","lightness"),transform:({hue:t,saturation:s,lightness:a,alpha:r=1})=>"hsla("+Math.round(t)+", "+Ha.transform(lc(s))+", "+Ha.transform(lc(a))+", "+lc(_c.transform(r))+")"},es={test:t=>Qn.test(t)||Hp.test(t)||bi.test(t),parse:t=>Qn.test(t)?Qn.parse(t):bi.test(t)?bi.parse(t):Hp.parse(t),transform:t=>typeof t=="string"?t:t.hasOwnProperty("red")?Qn.transform(t):bi.transform(t),getAnimatableNone:t=>{const s=es.parse(t);return s.alpha=0,es.transform(s)}},A3=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function M3(t){var s,a;return isNaN(t)&&typeof t=="string"&&(((s=t.match(K0))==null?void 0:s.length)||0)+(((a=t.match(A3))==null?void 0:a.length)||0)>0}const P1="number",z1="color",R3="var",O3="var(",dw="${}",D3=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Nc(t){const s=t.toString(),a=[],r={color:[],number:[],var:[]},o=[];let l=0;const u=s.replace(D3,h=>(es.test(h)?(r.color.push(l),o.push(z1),a.push(es.parse(h))):h.startsWith(O3)?(r.var.push(l),o.push(R3),a.push(h)):(r.number.push(l),o.push(P1),a.push(parseFloat(h))),++l,dw)).split(dw);return{values:a,split:u,indexes:r,types:o}}function $1(t){return Nc(t).values}function I1(t){const{split:s,types:a}=Nc(t),r=s.length;return o=>{let l="";for(let c=0;c<r;c++)if(l+=s[c],o[c]!==void 0){const u=a[c];u===P1?l+=lc(o[c]):u===z1?l+=es.transform(o[c]):l+=o[c]}return l}}const P3=t=>typeof t=="number"?0:es.test(t)?es.getAnimatableNone(t):t;function z3(t){const s=$1(t);return I1(t)(s.map(P3))}const un={test:M3,parse:$1,createTransformer:I1,getAnimatableNone:z3};function op(t,s,a){return a<0&&(a+=1),a>1&&(a-=1),a<1/6?t+(s-t)*6*a:a<1/2?s:a<2/3?t+(s-t)*(2/3-a)*6:t}function $3({hue:t,saturation:s,lightness:a,alpha:r}){t/=360,s/=100,a/=100;let o=0,l=0,c=0;if(!s)o=l=c=a;else{const u=a<.5?a*(1+s):a+s-a*s,h=2*a-u;o=op(h,u,t+1/3),l=op(h,u,t),c=op(h,u,t-1/3)}return{red:Math.round(o*255),green:Math.round(l*255),blue:Math.round(c*255),alpha:r}}function Uu(t,s){return a=>a>0?s:t}const Pt=(t,s,a)=>t+(s-t)*a,ip=(t,s,a)=>{const r=t*t,o=a*(s*s-r)+r;return o<0?0:Math.sqrt(o)},I3=[Hp,Qn,bi],L3=t=>I3.find(s=>s.test(t));function uw(t){const s=L3(t);if(!s)return!1;let a=s.parse(t);return s===bi&&(a=$3(a)),a}const mw=(t,s)=>{const a=uw(t),r=uw(s);if(!a||!r)return Uu(t,s);const o={...a};return l=>(o.red=ip(a.red,r.red,l),o.green=ip(a.green,r.green,l),o.blue=ip(a.blue,r.blue,l),o.alpha=Pt(a.alpha,r.alpha,l),Qn.transform(o))},Gp=new Set(["none","hidden"]);function U3(t,s){return Gp.has(t)?a=>a<=0?t:s:a=>a>=1?s:t}function B3(t,s){return a=>Pt(t,s,a)}function Q0(t){return typeof t=="number"?B3:typeof t=="string"?Y0(t)?Uu:es.test(t)?mw:F3:Array.isArray(t)?L1:typeof t=="object"?es.test(t)?mw:V3:Uu}function L1(t,s){const a=[...t],r=a.length,o=t.map((l,c)=>Q0(l)(l,s[c]));return l=>{for(let c=0;c<r;c++)a[c]=o[c](l);return a}}function V3(t,s){const a={...t,...s},r={};for(const o in a)t[o]!==void 0&&s[o]!==void 0&&(r[o]=Q0(t[o])(t[o],s[o]));return o=>{for(const l in r)a[l]=r[l](o);return a}}function q3(t,s){const a=[],r={color:0,var:0,number:0};for(let o=0;o<s.values.length;o++){const l=s.types[o],c=t.indexes[l][r[l]],u=t.values[c]??0;a[o]=u,r[l]++}return a}const F3=(t,s)=>{const a=un.createTransformer(s),r=Nc(t),o=Nc(s);return r.indexes.var.length===o.indexes.var.length&&r.indexes.color.length===o.indexes.color.length&&r.indexes.number.length>=o.indexes.number.length?Gp.has(t)&&!o.values.length||Gp.has(s)&&!r.values.length?U3(t,s):Lc(L1(q3(r,o),o.values),a):Uu(t,s)};function U1(t,s,a){return typeof t=="number"&&typeof s=="number"&&typeof a=="number"?Pt(t,s,a):Q0(t)(t,s)}const H3=t=>{const s=({timestamp:a})=>t(a);return{start:(a=!0)=>At.update(s,a),stop:()=>dn(s),now:()=>ys.isProcessing?ys.timestamp:zs.now()}},B1=(t,s,a=10)=>{let r="";const o=Math.max(Math.round(s/a),2);for(let l=0;l<o;l++)r+=Math.round(t(l/(o-1))*1e4)/1e4+", ";return`linear(${r.substring(0,r.length-2)})`},Bu=2e4;function J0(t){let s=0;const a=50;let r=t.next(s);for(;!r.done&&s<Bu;)s+=a,r=t.next(s);return s>=Bu?1/0:s}function G3(t,s=100,a){const r=a({...t,keyframes:[0,s]}),o=Math.min(J0(r),Bu);return{type:"keyframes",ease:l=>r.next(o*l).value/s,duration:Fa(o)}}const Z3=5;function V1(t,s,a){const r=Math.max(s-Z3,0);return w1(a-t(r),s-r)}const Lt={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},lp=.001;function W3({duration:t=Lt.duration,bounce:s=Lt.bounce,velocity:a=Lt.velocity,mass:r=Lt.mass}){let o,l,c=1-s;c=Er(Lt.minDamping,Lt.maxDamping,c),t=Er(Lt.minDuration,Lt.maxDuration,Fa(t)),c<1?(o=f=>{const p=f*c,g=p*t,v=p-a,b=Zp(f,c),_=Math.exp(-g);return lp-v/b*_},l=f=>{const g=f*c*t,v=g*a+a,b=Math.pow(c,2)*Math.pow(f,2)*t,_=Math.exp(-g),w=Zp(Math.pow(f,2),c);return(-o(f)+lp>0?-1:1)*((v-b)*_)/w}):(o=f=>{const p=Math.exp(-f*t),g=(f-a)*t+1;return-lp+p*g},l=f=>{const p=Math.exp(-f*t),g=(a-f)*(t*t);return p*g});const u=5/t,h=K3(o,l,u);if(t=qa(t),isNaN(h))return{stiffness:Lt.stiffness,damping:Lt.damping,duration:t};{const f=Math.pow(h,2)*r;return{stiffness:f,damping:c*2*Math.sqrt(r*f),duration:t}}}const Y3=12;function K3(t,s,a){let r=a;for(let o=1;o<Y3;o++)r=r-t(r)/s(r);return r}function Zp(t,s){return t*Math.sqrt(1-s*s)}const X3=["duration","bounce"],Q3=["stiffness","damping","mass"];function hw(t,s){return s.some(a=>t[a]!==void 0)}function J3(t){let s={velocity:Lt.velocity,stiffness:Lt.stiffness,damping:Lt.damping,mass:Lt.mass,isResolvedFromDuration:!1,...t};if(!hw(t,Q3)&&hw(t,X3))if(t.visualDuration){const a=t.visualDuration,r=2*Math.PI/(a*1.2),o=r*r,l=2*Er(.05,1,1-(t.bounce||0))*Math.sqrt(o);s={...s,mass:Lt.mass,stiffness:o,damping:l}}else{const a=W3(t);s={...s,...a,mass:Lt.mass},s.isResolvedFromDuration=!0}return s}function Vu(t=Lt.visualDuration,s=Lt.bounce){const a=typeof t!="object"?{visualDuration:t,keyframes:[0,1],bounce:s}:t;let{restSpeed:r,restDelta:o}=a;const l=a.keyframes[0],c=a.keyframes[a.keyframes.length-1],u={done:!1,value:l},{stiffness:h,damping:f,mass:p,duration:g,velocity:v,isResolvedFromDuration:b}=J3({...a,velocity:-Fa(a.velocity||0)}),_=v||0,w=f/(2*Math.sqrt(h*p)),E=c-l,k=Fa(Math.sqrt(h/p)),N=Math.abs(E)<5;r||(r=N?Lt.restSpeed.granular:Lt.restSpeed.default),o||(o=N?Lt.restDelta.granular:Lt.restDelta.default);let C;if(w<1){const T=Zp(k,w);C=M=>{const $=Math.exp(-w*k*M);return c-$*((_+w*k*E)/T*Math.sin(T*M)+E*Math.cos(T*M))}}else if(w===1)C=T=>c-Math.exp(-k*T)*(E+(_+k*E)*T);else{const T=k*Math.sqrt(w*w-1);C=M=>{const $=Math.exp(-w*k*M),A=Math.min(T*M,300);return c-$*((_+w*k*E)*Math.sinh(A)+T*E*Math.cosh(A))/T}}const S={calculatedDuration:b&&g||null,next:T=>{const M=C(T);if(b)u.done=T>=g;else{let $=T===0?_:0;w<1&&($=T===0?qa(_):V1(C,T,M));const A=Math.abs($)<=r,z=Math.abs(c-M)<=o;u.done=A&&z}return u.value=u.done?c:M,u},toString:()=>{const T=Math.min(J0(S),Bu),M=B1($=>S.next(T*$).value,T,30);return T+"ms "+M},toTransition:()=>{}};return S}Vu.applyToOptions=t=>{const s=G3(t,100,Vu);return t.ease=s.ease,t.duration=qa(s.duration),t.type="keyframes",t};function Wp({keyframes:t,velocity:s=0,power:a=.8,timeConstant:r=325,bounceDamping:o=10,bounceStiffness:l=500,modifyTarget:c,min:u,max:h,restDelta:f=.5,restSpeed:p}){const g=t[0],v={done:!1,value:g},b=A=>u!==void 0&&A<u||h!==void 0&&A>h,_=A=>u===void 0?h:h===void 0||Math.abs(u-A)<Math.abs(h-A)?u:h;let w=a*s;const E=g+w,k=c===void 0?E:c(E);k!==E&&(w=k-g);const N=A=>-w*Math.exp(-A/r),C=A=>k+N(A),S=A=>{const z=N(A),R=C(A);v.done=Math.abs(z)<=f,v.value=v.done?k:R};let T,M;const $=A=>{b(v.value)&&(T=A,M=Vu({keyframes:[v.value,_(v.value)],velocity:V1(C,A,v.value),damping:o,stiffness:l,restDelta:f,restSpeed:p}))};return $(0),{calculatedDuration:null,next:A=>{let z=!1;return!M&&T===void 0&&(z=!0,S(A),$(A)),T!==void 0&&A>=T?M.next(A-T):(!z&&S(A),v)}}}function eT(t,s,a){const r=[],o=a||Cr.mix||U1,l=t.length-1;for(let c=0;c<l;c++){let u=o(t[c],t[c+1]);if(s){const h=Array.isArray(s)?s[c]||ua:s;u=Lc(h,u)}r.push(u)}return r}function tT(t,s,{clamp:a=!0,ease:r,mixer:o}={}){const l=t.length;if(q0(l===s.length),l===1)return()=>s[0];if(l===2&&s[0]===s[1])return()=>s[1];const c=t[0]===t[1];t[0]>t[l-1]&&(t=[...t].reverse(),s=[...s].reverse());const u=eT(s,r,o),h=u.length,f=p=>{if(c&&p<t[0])return s[0];let g=0;if(h>1)for(;g<t.length-2&&!(p<t[g+1]);g++);const v=jc(t[g],t[g+1],p);return u[g](v)};return a?p=>f(Er(t[0],t[l-1],p)):f}function sT(t,s){const a=t[t.length-1];for(let r=1;r<=s;r++){const o=jc(0,s,r);t.push(Pt(a,1,o))}}function aT(t){const s=[0];return sT(s,t.length-1),s}function rT(t,s){return t.map(a=>a*s)}function nT(t,s){return t.map(()=>s||A1).splice(0,t.length-1)}function cc({duration:t=300,keyframes:s,times:a,ease:r="easeInOut"}){const o=g3(r)?r.map(lw):lw(r),l={done:!1,value:s[0]},c=rT(a&&a.length===s.length?a:aT(s),t),u=tT(c,s,{ease:Array.isArray(o)?o:nT(s,o)});return{calculatedDuration:t,next:h=>(l.value=u(h),l.done=h>=t,l)}}const oT=t=>t!==null;function eg(t,{repeat:s,repeatType:a="loop"},r,o=1){const l=t.filter(oT),u=o<0||s&&a!=="loop"&&s%2===1?0:l.length-1;return!u||r===void 0?l[u]:r}const iT={decay:Wp,inertia:Wp,tween:cc,keyframes:cc,spring:Vu};function q1(t){typeof t.type=="string"&&(t.type=iT[t.type])}class tg{constructor(){this.updateFinished()}get finished(){return this._finished}updateFinished(){this._finished=new Promise(s=>{this.resolve=s})}notifyFinished(){this.resolve()}then(s,a){return this.finished.then(s,a)}}const lT=t=>t/100;class sg extends tg{constructor(s){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{var r,o;const{motionValue:a}=this.options;a&&a.updatedAt!==zs.now()&&this.tick(zs.now()),this.isStopped=!0,this.state!=="idle"&&(this.teardown(),(o=(r=this.options).onStop)==null||o.call(r))},this.options=s,this.initAnimation(),this.play(),s.autoplay===!1&&this.pause()}initAnimation(){const{options:s}=this;q1(s);const{type:a=cc,repeat:r=0,repeatDelay:o=0,repeatType:l,velocity:c=0}=s;let{keyframes:u}=s;const h=a||cc;h!==cc&&typeof u[0]!="number"&&(this.mixKeyframes=Lc(lT,U1(u[0],u[1])),u=[0,100]);const f=h({...s,keyframes:u});l==="mirror"&&(this.mirroredGenerator=h({...s,keyframes:[...u].reverse(),velocity:-c})),f.calculatedDuration===null&&(f.calculatedDuration=J0(f));const{calculatedDuration:p}=f;this.calculatedDuration=p,this.resolvedDuration=p+o,this.totalDuration=this.resolvedDuration*(r+1)-o,this.generator=f}updateTime(s){const a=Math.round(s-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=a}tick(s,a=!1){const{generator:r,totalDuration:o,mixKeyframes:l,mirroredGenerator:c,resolvedDuration:u,calculatedDuration:h}=this;if(this.startTime===null)return r.next(0);const{delay:f=0,keyframes:p,repeat:g,repeatType:v,repeatDelay:b,type:_,onUpdate:w,finalKeyframe:E}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,s):this.speed<0&&(this.startTime=Math.min(s-o/this.speed,this.startTime)),a?this.currentTime=s:this.updateTime(s);const k=this.currentTime-f*(this.playbackSpeed>=0?1:-1),N=this.playbackSpeed>=0?k<0:k>o;this.currentTime=Math.max(k,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=o);let C=this.currentTime,S=r;if(g){const A=Math.min(this.currentTime,o)/u;let z=Math.floor(A),R=A%1;!R&&A>=1&&(R=1),R===1&&z--,z=Math.min(z,g+1),!!(z%2)&&(v==="reverse"?(R=1-R,b&&(R-=b/u)):v==="mirror"&&(S=c)),C=Er(0,1,R)*u}const T=N?{done:!1,value:p[0]}:S.next(C);l&&(T.value=l(T.value));let{done:M}=T;!N&&h!==null&&(M=this.playbackSpeed>=0?this.currentTime>=o:this.currentTime<=0);const $=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&M);return $&&_!==Wp&&(T.value=eg(p,this.options,E,this.speed)),w&&w(T.value),$&&this.finish(),T}then(s,a){return this.finished.then(s,a)}get duration(){return Fa(this.calculatedDuration)}get time(){return Fa(this.currentTime)}set time(s){var a;s=qa(s),this.currentTime=s,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=s:this.driver&&(this.startTime=this.driver.now()-s/this.playbackSpeed),(a=this.driver)==null||a.start(!1)}get speed(){return this.playbackSpeed}set speed(s){this.updateTime(zs.now());const a=this.playbackSpeed!==s;this.playbackSpeed=s,a&&(this.time=Fa(this.currentTime))}play(){var o,l;if(this.isStopped)return;const{driver:s=H3,startTime:a}=this.options;this.driver||(this.driver=s(c=>this.tick(c))),(l=(o=this.options).onPlay)==null||l.call(o);const r=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=r):this.holdTime!==null?this.startTime=r-this.holdTime:this.startTime||(this.startTime=a??r),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(zs.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){var s,a;this.notifyFinished(),this.teardown(),this.state="finished",(a=(s=this.options).onComplete)==null||a.call(s)}cancel(){var s,a;this.holdTime=null,this.startTime=0,this.tick(0),this.teardown(),(a=(s=this.options).onCancel)==null||a.call(s)}teardown(){this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(s){return this.startTime=0,this.tick(s,!0)}attachTimeline(s){var a;return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),(a=this.driver)==null||a.stop(),s.observe(this)}}function cT(t){for(let s=1;s<t.length;s++)t[s]??(t[s]=t[s-1])}const Jn=t=>t*180/Math.PI,Yp=t=>{const s=Jn(Math.atan2(t[1],t[0]));return Kp(s)},dT={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:t=>(Math.abs(t[0])+Math.abs(t[3]))/2,rotate:Yp,rotateZ:Yp,skewX:t=>Jn(Math.atan(t[1])),skewY:t=>Jn(Math.atan(t[2])),skew:t=>(Math.abs(t[1])+Math.abs(t[2]))/2},Kp=t=>(t=t%360,t<0&&(t+=360),t),fw=Yp,pw=t=>Math.sqrt(t[0]*t[0]+t[1]*t[1]),gw=t=>Math.sqrt(t[4]*t[4]+t[5]*t[5]),uT={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:pw,scaleY:gw,scale:t=>(pw(t)+gw(t))/2,rotateX:t=>Kp(Jn(Math.atan2(t[6],t[5]))),rotateY:t=>Kp(Jn(Math.atan2(-t[2],t[0]))),rotateZ:fw,rotate:fw,skewX:t=>Jn(Math.atan(t[4])),skewY:t=>Jn(Math.atan(t[1])),skew:t=>(Math.abs(t[1])+Math.abs(t[4]))/2};function Xp(t){return t.includes("scale")?1:0}function Qp(t,s){if(!t||t==="none")return Xp(s);const a=t.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,o;if(a)r=uT,o=a;else{const u=t.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=dT,o=u}if(!o)return Xp(s);const l=r[s],c=o[1].split(",").map(hT);return typeof l=="function"?l(c):c[l]}const mT=(t,s)=>{const{transform:a="none"}=getComputedStyle(t);return Qp(a,s)};function hT(t){return parseFloat(t.trim())}const Gi=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Zi=new Set(Gi),xw=t=>t===Hi||t===We,fT=new Set(["x","y","z"]),pT=Gi.filter(t=>!fT.has(t));function gT(t){const s=[];return pT.forEach(a=>{const r=t.getValue(a);r!==void 0&&(s.push([a,r.get()]),r.set(a.startsWith("scale")?1:0))}),s}const so={width:({x:t},{paddingLeft:s="0",paddingRight:a="0"})=>t.max-t.min-parseFloat(s)-parseFloat(a),height:({y:t},{paddingTop:s="0",paddingBottom:a="0"})=>t.max-t.min-parseFloat(s)-parseFloat(a),top:(t,{top:s})=>parseFloat(s),left:(t,{left:s})=>parseFloat(s),bottom:({y:t},{top:s})=>parseFloat(s)+(t.max-t.min),right:({x:t},{left:s})=>parseFloat(s)+(t.max-t.min),x:(t,{transform:s})=>Qp(s,"x"),y:(t,{transform:s})=>Qp(s,"y")};so.translateX=so.x;so.translateY=so.y;const ao=new Set;let Jp=!1,e0=!1,t0=!1;function F1(){if(e0){const t=Array.from(ao).filter(r=>r.needsMeasurement),s=new Set(t.map(r=>r.element)),a=new Map;s.forEach(r=>{const o=gT(r);o.length&&(a.set(r,o),r.render())}),t.forEach(r=>r.measureInitialState()),s.forEach(r=>{r.render();const o=a.get(r);o&&o.forEach(([l,c])=>{var u;(u=r.getValue(l))==null||u.set(c)})}),t.forEach(r=>r.measureEndState()),t.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}e0=!1,Jp=!1,ao.forEach(t=>t.complete(t0)),ao.clear()}function H1(){ao.forEach(t=>{t.readKeyframes(),t.needsMeasurement&&(e0=!0)})}function xT(){t0=!0,H1(),F1(),t0=!1}class ag{constructor(s,a,r,o,l,c=!1){this.state="pending",this.isAsync=!1,this.needsMeasurement=!1,this.unresolvedKeyframes=[...s],this.onComplete=a,this.name=r,this.motionValue=o,this.element=l,this.isAsync=c}scheduleResolve(){this.state="scheduled",this.isAsync?(ao.add(this),Jp||(Jp=!0,At.read(H1),At.resolveKeyframes(F1))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:s,name:a,element:r,motionValue:o}=this;if(s[0]===null){const l=o==null?void 0:o.get(),c=s[s.length-1];if(l!==void 0)s[0]=l;else if(r&&a){const u=r.readValue(a,c);u!=null&&(s[0]=u)}s[0]===void 0&&(s[0]=c),o&&l===void 0&&o.set(s[0])}cT(s)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(s=!1){this.state="complete",this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,s),ao.delete(this)}cancel(){this.state==="scheduled"&&(ao.delete(this),this.state="pending")}resume(){this.state==="pending"&&this.scheduleResolve()}}const yT=t=>t.startsWith("--");function bT(t,s,a){yT(s)?t.style.setProperty(s,a):t.style[s]=a}const vT=F0(()=>window.ScrollTimeline!==void 0),wT={};function jT(t,s){const a=F0(t);return()=>wT[s]??a()}const G1=jT(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),nc=([t,s,a,r])=>`cubic-bezier(${t}, ${s}, ${a}, ${r})`,yw={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:nc([0,.65,.55,1]),circOut:nc([.55,0,1,.45]),backIn:nc([.31,.01,.66,-.59]),backOut:nc([.33,1.53,.69,.99])};function Z1(t,s){if(t)return typeof t=="function"?G1()?B1(t,s):"ease-out":M1(t)?nc(t):Array.isArray(t)?t.map(a=>Z1(a,s)||yw.easeOut):yw[t]}function _T(t,s,a,{delay:r=0,duration:o=300,repeat:l=0,repeatType:c="loop",ease:u="easeOut",times:h}={},f=void 0){const p={[s]:a};h&&(p.offset=h);const g=Z1(u,o);Array.isArray(g)&&(p.easing=g);const v={delay:r,duration:o,easing:Array.isArray(g)?"linear":g,fill:"both",iterations:l+1,direction:c==="reverse"?"alternate":"normal"};return f&&(v.pseudoElement=f),t.animate(p,v)}function W1(t){return typeof t=="function"&&"applyToOptions"in t}function NT({type:t,...s}){return W1(t)&&G1()?t.applyToOptions(s):(s.duration??(s.duration=300),s.ease??(s.ease="easeOut"),s)}class ST extends tg{constructor(s){if(super(),this.finishedTime=null,this.isStopped=!1,!s)return;const{element:a,name:r,keyframes:o,pseudoElement:l,allowFlatten:c=!1,finalKeyframe:u,onComplete:h}=s;this.isPseudoElement=!!l,this.allowFlatten=c,this.options=s,q0(typeof s.type!="string");const f=NT(s);this.animation=_T(a,r,o,f,l),f.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!l){const p=eg(o,this.options,u,this.speed);this.updateMotionValue?this.updateMotionValue(p):bT(a,r,p),this.animation.cancel()}h==null||h(),this.notifyFinished()}}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var s,a;(a=(s=this.animation).finish)==null||a.call(s)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:s}=this;s==="idle"||s==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var s,a;this.isPseudoElement||(a=(s=this.animation).commitStyles)==null||a.call(s)}get duration(){var a,r;const s=((r=(a=this.animation.effect)==null?void 0:a.getComputedTiming)==null?void 0:r.call(a).duration)||0;return Fa(Number(s))}get time(){return Fa(Number(this.animation.currentTime)||0)}set time(s){this.finishedTime=null,this.animation.currentTime=qa(s)}get speed(){return this.animation.playbackRate}set speed(s){s<0&&(this.finishedTime=null),this.animation.playbackRate=s}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(s){this.animation.startTime=s}attachTimeline({timeline:s,observe:a}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,s&&vT()?(this.animation.timeline=s,ua):a(this)}}const Y1={anticipate:C1,backInOut:E1,circInOut:k1};function ET(t){return t in Y1}function CT(t){typeof t.ease=="string"&&ET(t.ease)&&(t.ease=Y1[t.ease])}const bw=10;class TT extends ST{constructor(s){CT(s),q1(s),super(s),s.startTime&&(this.startTime=s.startTime),this.options=s}updateMotionValue(s){const{motionValue:a,onUpdate:r,onComplete:o,element:l,...c}=this.options;if(!a)return;if(s!==void 0){a.set(s);return}const u=new sg({...c,autoplay:!1}),h=qa(this.finishedTime??this.time);a.setWithVelocity(u.sample(h-bw).value,u.sample(h).value,bw),u.stop()}}const vw=(t,s)=>s==="zIndex"?!1:!!(typeof t=="number"||Array.isArray(t)||typeof t=="string"&&(un.test(t)||t==="0")&&!t.startsWith("url("));function kT(t){const s=t[0];if(t.length===1)return!0;for(let a=0;a<t.length;a++)if(t[a]!==s)return!0}function AT(t,s,a,r){const o=t[0];if(o===null)return!1;if(s==="display"||s==="visibility")return!0;const l=t[t.length-1],c=vw(o,s),u=vw(l,s);return!c||!u?!1:kT(t)||(a==="spring"||W1(a))&&r}function s0(t){t.duration=0,t.type}const MT=new Set(["opacity","clipPath","filter","transform"]),RT=F0(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function OT(t){var p;const{motionValue:s,name:a,repeatDelay:r,repeatType:o,damping:l,type:c}=t;if(!(((p=s==null?void 0:s.owner)==null?void 0:p.current)instanceof HTMLElement))return!1;const{onUpdate:h,transformTemplate:f}=s.owner.getProps();return RT()&&a&&MT.has(a)&&(a!=="transform"||!f)&&!h&&!r&&o!=="mirror"&&l!==0&&c!=="inertia"}const DT=40;class PT extends tg{constructor({autoplay:s=!0,delay:a=0,type:r="keyframes",repeat:o=0,repeatDelay:l=0,repeatType:c="loop",keyframes:u,name:h,motionValue:f,element:p,...g}){var _;super(),this.stop=()=>{var w,E;this._animation&&(this._animation.stop(),(w=this.stopTimeline)==null||w.call(this)),(E=this.keyframeResolver)==null||E.cancel()},this.createdAt=zs.now();const v={autoplay:s,delay:a,type:r,repeat:o,repeatDelay:l,repeatType:c,name:h,motionValue:f,element:p,...g},b=(p==null?void 0:p.KeyframeResolver)||ag;this.keyframeResolver=new b(u,(w,E,k)=>this.onKeyframesResolved(w,E,v,!k),h,f,p),(_=this.keyframeResolver)==null||_.scheduleResolve()}onKeyframesResolved(s,a,r,o){this.keyframeResolver=void 0;const{name:l,type:c,velocity:u,delay:h,isHandoff:f,onUpdate:p}=r;this.resolvedAt=zs.now(),AT(s,l,c,u)||((Cr.instantAnimations||!h)&&(p==null||p(eg(s,r,a))),s[0]=s[s.length-1],s0(r),r.repeat=0);const v={startTime:o?this.resolvedAt?this.resolvedAt-this.createdAt>DT?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:a,...r,keyframes:s},b=!f&&OT(v)?new TT({...v,element:v.motionValue.owner.current}):new sg(v);b.finished.then(()=>this.notifyFinished()).catch(ua),this.pendingTimeline&&(this.stopTimeline=b.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=b}get finished(){return this._animation?this.animation.finished:this._finished}then(s,a){return this.finished.finally(s).then(()=>{})}get animation(){var s;return this._animation||((s=this.keyframeResolver)==null||s.resume(),xT()),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(s){this.animation.time=s}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(s){this.animation.speed=s}get startTime(){return this.animation.startTime}attachTimeline(s){return this._animation?this.stopTimeline=this.animation.attachTimeline(s):this.pendingTimeline=s,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){var s;this._animation&&this.animation.cancel(),(s=this.keyframeResolver)==null||s.cancel()}}const zT=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function $T(t){const s=zT.exec(t);if(!s)return[,];const[,a,r,o]=s;return[`--${a??r}`,o]}function K1(t,s,a=1){const[r,o]=$T(t);if(!r)return;const l=window.getComputedStyle(s).getPropertyValue(r);if(l){const c=l.trim();return y1(c)?parseFloat(c):c}return Y0(o)?K1(o,s,a+1):o}function rg(t,s){return(t==null?void 0:t[s])??(t==null?void 0:t.default)??t}const X1=new Set(["width","height","top","left","right","bottom",...Gi]),IT={test:t=>t==="auto",parse:t=>t},Q1=t=>s=>s.test(t),J1=[Hi,We,Ha,nn,k3,T3,IT],ww=t=>J1.find(Q1(t));function LT(t){return typeof t=="number"?t===0:t!==null?t==="none"||t==="0"||v1(t):!0}const UT=new Set(["brightness","contrast","saturate","opacity"]);function BT(t){const[s,a]=t.slice(0,-1).split("(");if(s==="drop-shadow")return t;const[r]=a.match(K0)||[];if(!r)return t;const o=a.replace(r,"");let l=UT.has(s)?1:0;return r!==a&&(l*=100),s+"("+l+o+")"}const VT=/\b([a-z-]*)\(.*?\)/gu,a0={...un,getAnimatableNone:t=>{const s=t.match(VT);return s?s.map(BT).join(" "):t}},jw={...Hi,transform:Math.round},qT={rotate:nn,rotateX:nn,rotateY:nn,rotateZ:nn,scale:cu,scaleX:cu,scaleY:cu,scaleZ:cu,skew:nn,skewX:nn,skewY:nn,distance:We,translateX:We,translateY:We,translateZ:We,x:We,y:We,z:We,perspective:We,transformPerspective:We,opacity:_c,originX:cw,originY:cw,originZ:We},ng={borderWidth:We,borderTopWidth:We,borderRightWidth:We,borderBottomWidth:We,borderLeftWidth:We,borderRadius:We,radius:We,borderTopLeftRadius:We,borderTopRightRadius:We,borderBottomRightRadius:We,borderBottomLeftRadius:We,width:We,maxWidth:We,height:We,maxHeight:We,top:We,right:We,bottom:We,left:We,padding:We,paddingTop:We,paddingRight:We,paddingBottom:We,paddingLeft:We,margin:We,marginTop:We,marginRight:We,marginBottom:We,marginLeft:We,backgroundPositionX:We,backgroundPositionY:We,...qT,zIndex:jw,fillOpacity:_c,strokeOpacity:_c,numOctaves:jw},FT={...ng,color:es,backgroundColor:es,outlineColor:es,fill:es,stroke:es,borderColor:es,borderTopColor:es,borderRightColor:es,borderBottomColor:es,borderLeftColor:es,filter:a0,WebkitFilter:a0},eN=t=>FT[t];function tN(t,s){let a=eN(t);return a!==a0&&(a=un),a.getAnimatableNone?a.getAnimatableNone(s):void 0}const HT=new Set(["auto","none","0"]);function GT(t,s,a){let r=0,o;for(;r<t.length&&!o;){const l=t[r];typeof l=="string"&&!HT.has(l)&&Nc(l).values.length&&(o=t[r]),r++}if(o&&a)for(const l of s)t[l]=tN(a,o)}class ZT extends ag{constructor(s,a,r,o,l){super(s,a,r,o,l,!0)}readKeyframes(){const{unresolvedKeyframes:s,element:a,name:r}=this;if(!a||!a.current)return;super.readKeyframes();for(let h=0;h<s.length;h++){let f=s[h];if(typeof f=="string"&&(f=f.trim(),Y0(f))){const p=K1(f,a.current);p!==void 0&&(s[h]=p),h===s.length-1&&(this.finalKeyframe=f)}}if(this.resolveNoneKeyframes(),!X1.has(r)||s.length!==2)return;const[o,l]=s,c=ww(o),u=ww(l);if(c!==u)if(xw(c)&&xw(u))for(let h=0;h<s.length;h++){const f=s[h];typeof f=="string"&&(s[h]=parseFloat(f))}else so[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:s,name:a}=this,r=[];for(let o=0;o<s.length;o++)(s[o]===null||LT(s[o]))&&r.push(o);r.length&&GT(s,r,a)}measureInitialState(){const{element:s,unresolvedKeyframes:a,name:r}=this;if(!s||!s.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=so[r](s.measureViewportBox(),window.getComputedStyle(s.current)),a[0]=this.measuredOrigin;const o=a[a.length-1];o!==void 0&&s.getValue(r,o).jump(o,!1)}measureEndState(){var u;const{element:s,name:a,unresolvedKeyframes:r}=this;if(!s||!s.current)return;const o=s.getValue(a);o&&o.jump(this.measuredOrigin,!1);const l=r.length-1,c=r[l];r[l]=so[a](s.measureViewportBox(),window.getComputedStyle(s.current)),c!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=c),(u=this.removedTransforms)!=null&&u.length&&this.removedTransforms.forEach(([h,f])=>{s.getValue(h).set(f)}),this.resolveNoneKeyframes()}}function WT(t,s,a){if(t instanceof EventTarget)return[t];if(typeof t=="string"){let r=document;const o=(a==null?void 0:a[t])??r.querySelectorAll(t);return o?Array.from(o):[]}return Array.from(t)}const sN=(t,s)=>s&&typeof t=="number"?s.transform(t):t;function aN(t){return b1(t)&&"offsetHeight"in t}const _w=30,YT=t=>!isNaN(parseFloat(t));class KT{constructor(s,a={}){this.canTrackVelocity=null,this.events={},this.updateAndNotify=r=>{var l;const o=zs.now();if(this.updatedAt!==o&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((l=this.events.change)==null||l.notify(this.current),this.dependents))for(const c of this.dependents)c.dirty()},this.hasAnimated=!1,this.setCurrent(s),this.owner=a.owner}setCurrent(s){this.current=s,this.updatedAt=zs.now(),this.canTrackVelocity===null&&s!==void 0&&(this.canTrackVelocity=YT(this.current))}setPrevFrameValue(s=this.current){this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt}onChange(s){return this.on("change",s)}on(s,a){this.events[s]||(this.events[s]=new H0);const r=this.events[s].add(a);return s==="change"?()=>{r(),At.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const s in this.events)this.events[s].clear()}attach(s,a){this.passiveEffect=s,this.stopPassiveEffect=a}set(s){this.passiveEffect?this.passiveEffect(s,this.updateAndNotify):this.updateAndNotify(s)}setWithVelocity(s,a,r){this.set(a),this.prev=void 0,this.prevFrameValue=s,this.prevUpdatedAt=this.updatedAt-r}jump(s,a=!0){this.updateAndNotify(s),this.prev=s,this.prevUpdatedAt=this.prevFrameValue=void 0,a&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}dirty(){var s;(s=this.events.change)==null||s.notify(this.current)}addDependent(s){this.dependents||(this.dependents=new Set),this.dependents.add(s)}removeDependent(s){this.dependents&&this.dependents.delete(s)}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const s=zs.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||s-this.updatedAt>_w)return 0;const a=Math.min(this.updatedAt-this.prevUpdatedAt,_w);return w1(parseFloat(this.current)-parseFloat(this.prevFrameValue),a)}start(s){return this.stop(),new Promise(a=>{this.hasAnimated=!0,this.animation=s(a),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var s,a;(s=this.dependents)==null||s.clear(),(a=this.events.destroy)==null||a.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function zi(t,s){return new KT(t,s)}const{schedule:og}=R1(queueMicrotask,!1),va={x:!1,y:!1};function rN(){return va.x||va.y}function XT(t){return t==="x"||t==="y"?va[t]?null:(va[t]=!0,()=>{va[t]=!1}):va.x||va.y?null:(va.x=va.y=!0,()=>{va.x=va.y=!1})}function nN(t,s){const a=WT(t),r=new AbortController,o={passive:!0,...s,signal:r.signal};return[a,o,()=>r.abort()]}function Nw(t){return!(t.pointerType==="touch"||rN())}function QT(t,s,a={}){const[r,o,l]=nN(t,a),c=u=>{if(!Nw(u))return;const{target:h}=u,f=s(h,u);if(typeof f!="function"||!h)return;const p=g=>{Nw(g)&&(f(g),h.removeEventListener("pointerleave",p))};h.addEventListener("pointerleave",p,o)};return r.forEach(u=>{u.addEventListener("pointerenter",c,o)}),l}const oN=(t,s)=>s?t===s?!0:oN(t,s.parentElement):!1,ig=t=>t.pointerType==="mouse"?typeof t.button!="number"||t.button<=0:t.isPrimary!==!1,JT=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function ek(t){return JT.has(t.tagName)||t.tabIndex!==-1}const Tu=new WeakSet;function Sw(t){return s=>{s.key==="Enter"&&t(s)}}function cp(t,s){t.dispatchEvent(new PointerEvent("pointer"+s,{isPrimary:!0,bubbles:!0}))}const tk=(t,s)=>{const a=t.currentTarget;if(!a)return;const r=Sw(()=>{if(Tu.has(a))return;cp(a,"down");const o=Sw(()=>{cp(a,"up")}),l=()=>cp(a,"cancel");a.addEventListener("keyup",o,s),a.addEventListener("blur",l,s)});a.addEventListener("keydown",r,s),a.addEventListener("blur",()=>a.removeEventListener("keydown",r),s)};function Ew(t){return ig(t)&&!rN()}function sk(t,s,a={}){const[r,o,l]=nN(t,a),c=u=>{const h=u.currentTarget;if(!Ew(u))return;Tu.add(h);const f=s(h,u),p=(b,_)=>{window.removeEventListener("pointerup",g),window.removeEventListener("pointercancel",v),Tu.has(h)&&Tu.delete(h),Ew(b)&&typeof f=="function"&&f(b,{success:_})},g=b=>{p(b,h===window||h===document||a.useGlobalTarget||oN(h,b.target))},v=b=>{p(b,!1)};window.addEventListener("pointerup",g,o),window.addEventListener("pointercancel",v,o)};return r.forEach(u=>{(a.useGlobalTarget?window:u).addEventListener("pointerdown",c,o),aN(u)&&(u.addEventListener("focus",f=>tk(f,o)),!ek(u)&&!u.hasAttribute("tabindex")&&(u.tabIndex=0))}),l}function iN(t){return b1(t)&&"ownerSVGElement"in t}function ak(t){return iN(t)&&t.tagName==="svg"}const _s=t=>!!(t&&t.getVelocity),rk=[...J1,es,un],nk=t=>rk.find(Q1(t)),lg=y.createContext({transformPagePoint:t=>t,isStatic:!1,reducedMotion:"never"});class ok extends y.Component{getSnapshotBeforeUpdate(s){const a=this.props.childRef.current;if(a&&s.isPresent&&!this.props.isPresent){const r=a.offsetParent,o=aN(r)&&r.offsetWidth||0,l=this.props.sizeRef.current;l.height=a.offsetHeight||0,l.width=a.offsetWidth||0,l.top=a.offsetTop,l.left=a.offsetLeft,l.right=o-l.width-l.left}return null}componentDidUpdate(){}render(){return this.props.children}}function ik({children:t,isPresent:s,anchorX:a,root:r}){const o=y.useId(),l=y.useRef(null),c=y.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:u}=y.useContext(lg);return y.useInsertionEffect(()=>{const{width:h,height:f,top:p,left:g,right:v}=c.current;if(s||!l.current||!h||!f)return;const b=a==="left"?`left: ${g}`:`right: ${v}`;l.current.dataset.motionPopId=o;const _=document.createElement("style");u&&(_.nonce=u);const w=r??document.head;return w.appendChild(_),_.sheet&&_.sheet.insertRule(`
          [data-motion-pop-id="${o}"] {
            position: absolute !important;
            width: ${h}px !important;
            height: ${f}px !important;
            ${b}px !important;
            top: ${p}px !important;
          }
        `),()=>{w.contains(_)&&w.removeChild(_)}},[s]),e.jsx(ok,{isPresent:s,childRef:l,sizeRef:c,children:y.cloneElement(t,{ref:l})})}const lk=({children:t,initial:s,isPresent:a,onExitComplete:r,custom:o,presenceAffectsLayout:l,mode:c,anchorX:u,root:h})=>{const f=L0(ck),p=y.useId();let g=!0,v=y.useMemo(()=>(g=!1,{id:p,initial:s,isPresent:a,custom:o,onExitComplete:b=>{f.set(b,!0);for(const _ of f.values())if(!_)return;r&&r()},register:b=>(f.set(b,!1),()=>f.delete(b))}),[a,f,r]);return l&&g&&(v={...v}),y.useMemo(()=>{f.forEach((b,_)=>f.set(_,!1))},[a]),y.useEffect(()=>{!a&&!f.size&&r&&r()},[a]),c==="popLayout"&&(t=e.jsx(ik,{isPresent:a,anchorX:u,root:h,children:t})),e.jsx(xm.Provider,{value:v,children:t})};function ck(){return new Map}function lN(t=!0){const s=y.useContext(xm);if(s===null)return[!0,null];const{isPresent:a,onExitComplete:r,register:o}=s,l=y.useId();y.useEffect(()=>{if(t)return o(l)},[t]);const c=y.useCallback(()=>t&&r&&r(l),[l,r,t]);return!a&&r?[!1,c]:[!0]}const du=t=>t.key||"";function Cw(t){const s=[];return y.Children.forEach(t,a=>{y.isValidElement(a)&&s.push(a)}),s}const Ws=({children:t,custom:s,initial:a=!0,onExitComplete:r,presenceAffectsLayout:o=!0,mode:l="sync",propagate:c=!1,anchorX:u="left",root:h})=>{const[f,p]=lN(c),g=y.useMemo(()=>Cw(t),[t]),v=c&&!f?[]:g.map(du),b=y.useRef(!0),_=y.useRef(g),w=L0(()=>new Map),[E,k]=y.useState(g),[N,C]=y.useState(g);x1(()=>{b.current=!1,_.current=g;for(let M=0;M<N.length;M++){const $=du(N[M]);v.includes($)?w.delete($):w.get($)!==!0&&w.set($,!1)}},[N,v.length,v.join("-")]);const S=[];if(g!==E){let M=[...g];for(let $=0;$<N.length;$++){const A=N[$],z=du(A);v.includes(z)||(M.splice($,0,A),S.push(A))}return l==="wait"&&S.length&&(M=S),C(Cw(M)),k(g),null}const{forceRender:T}=y.useContext(I0);return e.jsx(e.Fragment,{children:N.map(M=>{const $=du(M),A=c&&!f?!1:g===N||v.includes($),z=()=>{if(w.has($))w.set($,!0);else return;let R=!0;w.forEach(L=>{L||(R=!1)}),R&&(T==null||T(),C(_.current),c&&(p==null||p()),r&&r())};return e.jsx(lk,{isPresent:A,initial:!b.current||a?void 0:!1,custom:s,presenceAffectsLayout:o,mode:l,root:h,onExitComplete:A?void 0:z,anchorX:u,children:M},$)})})},cN=y.createContext({strict:!1}),Tw={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},$i={};for(const t in Tw)$i[t]={isEnabled:s=>Tw[t].some(a=>!!s[a])};function dk(t){for(const s in t)$i[s]={...$i[s],...t[s]}}const uk=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function qu(t){return t.startsWith("while")||t.startsWith("drag")&&t!=="draggable"||t.startsWith("layout")||t.startsWith("onTap")||t.startsWith("onPan")||t.startsWith("onLayout")||uk.has(t)}let dN=t=>!qu(t);function mk(t){typeof t=="function"&&(dN=s=>s.startsWith("on")?!qu(s):t(s))}try{mk(require("@emotion/is-prop-valid").default)}catch{}function hk(t,s,a){const r={};for(const o in t)o==="values"&&typeof t.values=="object"||(dN(o)||a===!0&&qu(o)||!s&&!qu(o)||t.draggable&&o.startsWith("onDrag"))&&(r[o]=t[o]);return r}const ym=y.createContext({});function bm(t){return t!==null&&typeof t=="object"&&typeof t.start=="function"}function Sc(t){return typeof t=="string"||Array.isArray(t)}const cg=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],dg=["initial",...cg];function vm(t){return bm(t.animate)||dg.some(s=>Sc(t[s]))}function uN(t){return!!(vm(t)||t.variants)}function fk(t,s){if(vm(t)){const{initial:a,animate:r}=t;return{initial:a===!1||Sc(a)?a:void 0,animate:Sc(r)?r:void 0}}return t.inherit!==!1?s:{}}function pk(t){const{initial:s,animate:a}=fk(t,y.useContext(ym));return y.useMemo(()=>({initial:s,animate:a}),[kw(s),kw(a)])}function kw(t){return Array.isArray(t)?t.join(" "):t}const Ec={};function gk(t){for(const s in t)Ec[s]=t[s],W0(s)&&(Ec[s].isCSSVariable=!0)}function mN(t,{layout:s,layoutId:a}){return Zi.has(t)||t.startsWith("origin")||(s||a!==void 0)&&(!!Ec[t]||t==="opacity")}const xk={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},yk=Gi.length;function bk(t,s,a){let r="",o=!0;for(let l=0;l<yk;l++){const c=Gi[l],u=t[c];if(u===void 0)continue;let h=!0;if(typeof u=="number"?h=u===(c.startsWith("scale")?1:0):h=parseFloat(u)===0,!h||a){const f=sN(u,ng[c]);if(!h){o=!1;const p=xk[c]||c;r+=`${p}(${f}) `}a&&(s[c]=f)}}return r=r.trim(),a?r=a(s,o?"":r):o&&(r="none"),r}function ug(t,s,a){const{style:r,vars:o,transformOrigin:l}=t;let c=!1,u=!1;for(const h in s){const f=s[h];if(Zi.has(h)){c=!0;continue}else if(W0(h)){o[h]=f;continue}else{const p=sN(f,ng[h]);h.startsWith("origin")?(u=!0,l[h]=p):r[h]=p}}if(s.transform||(c||a?r.transform=bk(s,t.transform,a):r.transform&&(r.transform="none")),u){const{originX:h="50%",originY:f="50%",originZ:p=0}=l;r.transformOrigin=`${h} ${f} ${p}`}}const mg=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function hN(t,s,a){for(const r in s)!_s(s[r])&&!mN(r,a)&&(t[r]=s[r])}function vk({transformTemplate:t},s){return y.useMemo(()=>{const a=mg();return ug(a,s,t),Object.assign({},a.vars,a.style)},[s])}function wk(t,s){const a=t.style||{},r={};return hN(r,a,t),Object.assign(r,vk(t,s)),r}function jk(t,s){const a={},r=wk(t,s);return t.drag&&t.dragListener!==!1&&(a.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=t.drag===!0?"none":`pan-${t.drag==="x"?"y":"x"}`),t.tabIndex===void 0&&(t.onTap||t.onTapStart||t.whileTap)&&(a.tabIndex=0),a.style=r,a}const _k={offset:"stroke-dashoffset",array:"stroke-dasharray"},Nk={offset:"strokeDashoffset",array:"strokeDasharray"};function Sk(t,s,a=1,r=0,o=!0){t.pathLength=1;const l=o?_k:Nk;t[l.offset]=We.transform(-r);const c=We.transform(s),u=We.transform(a);t[l.array]=`${c} ${u}`}function fN(t,{attrX:s,attrY:a,attrScale:r,pathLength:o,pathSpacing:l=1,pathOffset:c=0,...u},h,f,p){if(ug(t,u,f),h){t.style.viewBox&&(t.attrs.viewBox=t.style.viewBox);return}t.attrs=t.style,t.style={};const{attrs:g,style:v}=t;g.transform&&(v.transform=g.transform,delete g.transform),(v.transform||g.transformOrigin)&&(v.transformOrigin=g.transformOrigin??"50% 50%",delete g.transformOrigin),v.transform&&(v.transformBox=(p==null?void 0:p.transformBox)??"fill-box",delete g.transformBox),s!==void 0&&(g.x=s),a!==void 0&&(g.y=a),r!==void 0&&(g.scale=r),o!==void 0&&Sk(g,o,l,c,!1)}const pN=()=>({...mg(),attrs:{}}),gN=t=>typeof t=="string"&&t.toLowerCase()==="svg";function Ek(t,s,a,r){const o=y.useMemo(()=>{const l=pN();return fN(l,s,gN(r),t.transformTemplate,t.style),{...l.attrs,style:{...l.style}}},[s]);if(t.style){const l={};hN(l,t.style,t),o.style={...l,...o.style}}return o}const Ck=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function hg(t){return typeof t!="string"||t.includes("-")?!1:!!(Ck.indexOf(t)>-1||/[A-Z]/u.test(t))}function Tk(t,s,a,{latestValues:r},o,l=!1){const u=(hg(t)?Ek:jk)(s,r,o,t),h=hk(s,typeof t=="string",l),f=t!==y.Fragment?{...h,...u,ref:a}:{},{children:p}=s,g=y.useMemo(()=>_s(p)?p.get():p,[p]);return y.createElement(t,{...f,children:g})}function Aw(t){const s=[{},{}];return t==null||t.values.forEach((a,r)=>{s[0][r]=a.get(),s[1][r]=a.getVelocity()}),s}function fg(t,s,a,r){if(typeof s=="function"){const[o,l]=Aw(r);s=s(a!==void 0?a:t.custom,o,l)}if(typeof s=="string"&&(s=t.variants&&t.variants[s]),typeof s=="function"){const[o,l]=Aw(r);s=s(a!==void 0?a:t.custom,o,l)}return s}function ku(t){return _s(t)?t.get():t}function kk({scrapeMotionValuesFromProps:t,createRenderState:s},a,r,o){return{latestValues:Ak(a,r,o,t),renderState:s()}}function Ak(t,s,a,r){const o={},l=r(t,{});for(const v in l)o[v]=ku(l[v]);let{initial:c,animate:u}=t;const h=vm(t),f=uN(t);s&&f&&!h&&t.inherit!==!1&&(c===void 0&&(c=s.initial),u===void 0&&(u=s.animate));let p=a?a.initial===!1:!1;p=p||c===!1;const g=p?u:c;if(g&&typeof g!="boolean"&&!bm(g)){const v=Array.isArray(g)?g:[g];for(let b=0;b<v.length;b++){const _=fg(t,v[b]);if(_){const{transitionEnd:w,transition:E,...k}=_;for(const N in k){let C=k[N];if(Array.isArray(C)){const S=p?C.length-1:0;C=C[S]}C!==null&&(o[N]=C)}for(const N in w)o[N]=w[N]}}}return o}const xN=t=>(s,a)=>{const r=y.useContext(ym),o=y.useContext(xm),l=()=>kk(t,s,r,o);return a?l():L0(l)};function pg(t,s,a){var l;const{style:r}=t,o={};for(const c in r)(_s(r[c])||s.style&&_s(s.style[c])||mN(c,t)||((l=a==null?void 0:a.getValue(c))==null?void 0:l.liveStyle)!==void 0)&&(o[c]=r[c]);return o}const Mk=xN({scrapeMotionValuesFromProps:pg,createRenderState:mg});function yN(t,s,a){const r=pg(t,s,a);for(const o in t)if(_s(t[o])||_s(s[o])){const l=Gi.indexOf(o)!==-1?"attr"+o.charAt(0).toUpperCase()+o.substring(1):o;r[l]=t[o]}return r}const Rk=xN({scrapeMotionValuesFromProps:yN,createRenderState:pN}),Ok=Symbol.for("motionComponentSymbol");function vi(t){return t&&typeof t=="object"&&Object.prototype.hasOwnProperty.call(t,"current")}function Dk(t,s,a){return y.useCallback(r=>{r&&t.onMount&&t.onMount(r),s&&(r?s.mount(r):s.unmount()),a&&(typeof a=="function"?a(r):vi(a)&&(a.current=r))},[s])}const gg=t=>t.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),Pk="framerAppearId",bN="data-"+gg(Pk),vN=y.createContext({});function zk(t,s,a,r,o){var w,E;const{visualElement:l}=y.useContext(ym),c=y.useContext(cN),u=y.useContext(xm),h=y.useContext(lg).reducedMotion,f=y.useRef(null);r=r||c.renderer,!f.current&&r&&(f.current=r(t,{visualState:s,parent:l,props:a,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:h}));const p=f.current,g=y.useContext(vN);p&&!p.projection&&o&&(p.type==="html"||p.type==="svg")&&$k(f.current,a,o,g);const v=y.useRef(!1);y.useInsertionEffect(()=>{p&&v.current&&p.update(a,u)});const b=a[bN],_=y.useRef(!!b&&!((w=window.MotionHandoffIsComplete)!=null&&w.call(window,b))&&((E=window.MotionHasOptimisedAnimation)==null?void 0:E.call(window,b)));return x1(()=>{p&&(v.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),p.scheduleRenderMicrotask(),_.current&&p.animationState&&p.animationState.animateChanges())}),y.useEffect(()=>{p&&(!_.current&&p.animationState&&p.animationState.animateChanges(),_.current&&(queueMicrotask(()=>{var k;(k=window.MotionHandoffMarkAsComplete)==null||k.call(window,b)}),_.current=!1),p.enteringChildren=void 0)}),p}function $k(t,s,a,r){const{layoutId:o,layout:l,drag:c,dragConstraints:u,layoutScroll:h,layoutRoot:f,layoutCrossfade:p}=s;t.projection=new a(t.latestValues,s["data-framer-portal-id"]?void 0:wN(t.parent)),t.projection.setOptions({layoutId:o,layout:l,alwaysMeasureLayout:!!c||u&&vi(u),visualElement:t,animationType:typeof l=="string"?l:"both",initialPromotionConfig:r,crossfade:p,layoutScroll:h,layoutRoot:f})}function wN(t){if(t)return t.options.allowProjection!==!1?t.projection:wN(t.parent)}function dp(t,{forwardMotionProps:s=!1}={},a,r){a&&dk(a);const o=hg(t)?Rk:Mk;function l(u,h){let f;const p={...y.useContext(lg),...u,layoutId:Ik(u)},{isStatic:g}=p,v=pk(u),b=o(u,g);if(!g&&U0){Lk();const _=Uk(p);f=_.MeasureLayout,v.visualElement=zk(t,b,p,r,_.ProjectionNode)}return e.jsxs(ym.Provider,{value:v,children:[f&&v.visualElement?e.jsx(f,{visualElement:v.visualElement,...p}):null,Tk(t,u,Dk(b,v.visualElement,h),b,g,s)]})}l.displayName=`motion.${typeof t=="string"?t:`create(${t.displayName??t.name??""})`}`;const c=y.forwardRef(l);return c[Ok]=t,c}function Ik({layoutId:t}){const s=y.useContext(I0).id;return s&&t!==void 0?s+"-"+t:t}function Lk(t,s){y.useContext(cN).strict}function Uk(t){const{drag:s,layout:a}=$i;if(!s&&!a)return{};const r={...s,...a};return{MeasureLayout:s!=null&&s.isEnabled(t)||a!=null&&a.isEnabled(t)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}function Bk(t,s){if(typeof Proxy>"u")return dp;const a=new Map,r=(l,c)=>dp(l,c,t,s),o=(l,c)=>r(l,c);return new Proxy(o,{get:(l,c)=>c==="create"?r:(a.has(c)||a.set(c,dp(c,void 0,t,s)),a.get(c))})}function jN({top:t,left:s,right:a,bottom:r}){return{x:{min:s,max:a},y:{min:t,max:r}}}function Vk({x:t,y:s}){return{top:s.min,right:t.max,bottom:s.max,left:t.min}}function qk(t,s){if(!s)return t;const a=s({x:t.left,y:t.top}),r=s({x:t.right,y:t.bottom});return{top:a.y,left:a.x,bottom:r.y,right:r.x}}function up(t){return t===void 0||t===1}function r0({scale:t,scaleX:s,scaleY:a}){return!up(t)||!up(s)||!up(a)}function Vn(t){return r0(t)||_N(t)||t.z||t.rotate||t.rotateX||t.rotateY||t.skewX||t.skewY}function _N(t){return Mw(t.x)||Mw(t.y)}function Mw(t){return t&&t!=="0%"}function Fu(t,s,a){const r=t-a,o=s*r;return a+o}function Rw(t,s,a,r,o){return o!==void 0&&(t=Fu(t,o,r)),Fu(t,a,r)+s}function n0(t,s=0,a=1,r,o){t.min=Rw(t.min,s,a,r,o),t.max=Rw(t.max,s,a,r,o)}function NN(t,{x:s,y:a}){n0(t.x,s.translate,s.scale,s.originPoint),n0(t.y,a.translate,a.scale,a.originPoint)}const Ow=.999999999999,Dw=1.0000000000001;function Fk(t,s,a,r=!1){const o=a.length;if(!o)return;s.x=s.y=1;let l,c;for(let u=0;u<o;u++){l=a[u],c=l.projectionDelta;const{visualElement:h}=l.options;h&&h.props.style&&h.props.style.display==="contents"||(r&&l.options.layoutScroll&&l.scroll&&l!==l.root&&ji(t,{x:-l.scroll.offset.x,y:-l.scroll.offset.y}),c&&(s.x*=c.x.scale,s.y*=c.y.scale,NN(t,c)),r&&Vn(l.latestValues)&&ji(t,l.latestValues))}s.x<Dw&&s.x>Ow&&(s.x=1),s.y<Dw&&s.y>Ow&&(s.y=1)}function wi(t,s){t.min=t.min+s,t.max=t.max+s}function Pw(t,s,a,r,o=.5){const l=Pt(t.min,t.max,o);n0(t,s,a,l,r)}function ji(t,s){Pw(t.x,s.x,s.scaleX,s.scale,s.originX),Pw(t.y,s.y,s.scaleY,s.scale,s.originY)}function SN(t,s){return jN(qk(t.getBoundingClientRect(),s))}function Hk(t,s,a){const r=SN(t,a),{scroll:o}=s;return o&&(wi(r.x,o.offset.x),wi(r.y,o.offset.y)),r}const zw=()=>({translate:0,scale:1,origin:0,originPoint:0}),_i=()=>({x:zw(),y:zw()}),$w=()=>({min:0,max:0}),Ft=()=>({x:$w(),y:$w()}),o0={current:null},EN={current:!1};function Gk(){if(EN.current=!0,!!U0)if(window.matchMedia){const t=window.matchMedia("(prefers-reduced-motion)"),s=()=>o0.current=t.matches;t.addEventListener("change",s),s()}else o0.current=!1}const Zk=new WeakMap;function Wk(t,s,a){for(const r in s){const o=s[r],l=a[r];if(_s(o))t.addValue(r,o);else if(_s(l))t.addValue(r,zi(o,{owner:t}));else if(l!==o)if(t.hasValue(r)){const c=t.getValue(r);c.liveStyle===!0?c.jump(o):c.hasAnimated||c.set(o)}else{const c=t.getStaticValue(r);t.addValue(r,zi(c!==void 0?c:o,{owner:t}))}}for(const r in a)s[r]===void 0&&t.removeValue(r);return s}const Iw=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class Yk{scrapeMotionValuesFromProps(s,a,r){return{}}constructor({parent:s,props:a,presenceContext:r,reducedMotionConfig:o,blockInitialAnimation:l,visualState:c},u={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=ag,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const v=zs.now();this.renderScheduledAt<v&&(this.renderScheduledAt=v,At.render(this.render,!1,!0))};const{latestValues:h,renderState:f}=c;this.latestValues=h,this.baseTarget={...h},this.initialValues=a.initial?{...h}:{},this.renderState=f,this.parent=s,this.props=a,this.presenceContext=r,this.depth=s?s.depth+1:0,this.reducedMotionConfig=o,this.options=u,this.blockInitialAnimation=!!l,this.isControllingVariants=vm(a),this.isVariantNode=uN(a),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(s&&s.current);const{willChange:p,...g}=this.scrapeMotionValuesFromProps(a,{},this);for(const v in g){const b=g[v];h[v]!==void 0&&_s(b)&&b.set(h[v])}}mount(s){var a;this.current=s,Zk.set(s,this),this.projection&&!this.projection.instance&&this.projection.mount(s),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((r,o)=>this.bindToMotionValue(o,r)),EN.current||Gk(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:o0.current,(a=this.parent)==null||a.addChild(this),this.update(this.props,this.presenceContext)}unmount(){var s;this.projection&&this.projection.unmount(),dn(this.notifyUpdate),dn(this.render),this.valueSubscriptions.forEach(a=>a()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),(s=this.parent)==null||s.removeChild(this);for(const a in this.events)this.events[a].clear();for(const a in this.features){const r=this.features[a];r&&(r.unmount(),r.isMounted=!1)}this.current=null}addChild(s){this.children.add(s),this.enteringChildren??(this.enteringChildren=new Set),this.enteringChildren.add(s)}removeChild(s){this.children.delete(s),this.enteringChildren&&this.enteringChildren.delete(s)}bindToMotionValue(s,a){this.valueSubscriptions.has(s)&&this.valueSubscriptions.get(s)();const r=Zi.has(s);r&&this.onBindTransform&&this.onBindTransform();const o=a.on("change",c=>{this.latestValues[s]=c,this.props.onUpdate&&At.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0),this.scheduleRender()});let l;window.MotionCheckAppearSync&&(l=window.MotionCheckAppearSync(this,s,a)),this.valueSubscriptions.set(s,()=>{o(),l&&l(),a.owner&&a.stop()})}sortNodePosition(s){return!this.current||!this.sortInstanceNodePosition||this.type!==s.type?0:this.sortInstanceNodePosition(this.current,s.current)}updateFeatures(){let s="animation";for(s in $i){const a=$i[s];if(!a)continue;const{isEnabled:r,Feature:o}=a;if(!this.features[s]&&o&&r(this.props)&&(this.features[s]=new o(this)),this.features[s]){const l=this.features[s];l.isMounted?l.update():(l.mount(),l.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):Ft()}getStaticValue(s){return this.latestValues[s]}setStaticValue(s,a){this.latestValues[s]=a}update(s,a){(s.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=s,this.prevPresenceContext=this.presenceContext,this.presenceContext=a;for(let r=0;r<Iw.length;r++){const o=Iw[r];this.propEventSubscriptions[o]&&(this.propEventSubscriptions[o](),delete this.propEventSubscriptions[o]);const l="on"+o,c=s[l];c&&(this.propEventSubscriptions[o]=this.on(o,c))}this.prevMotionValues=Wk(this,this.scrapeMotionValuesFromProps(s,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(s){return this.props.variants?this.props.variants[s]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(s){const a=this.getClosestVariantNode();if(a)return a.variantChildren&&a.variantChildren.add(s),()=>a.variantChildren.delete(s)}addValue(s,a){const r=this.values.get(s);a!==r&&(r&&this.removeValue(s),this.bindToMotionValue(s,a),this.values.set(s,a),this.latestValues[s]=a.get())}removeValue(s){this.values.delete(s);const a=this.valueSubscriptions.get(s);a&&(a(),this.valueSubscriptions.delete(s)),delete this.latestValues[s],this.removeValueFromRenderState(s,this.renderState)}hasValue(s){return this.values.has(s)}getValue(s,a){if(this.props.values&&this.props.values[s])return this.props.values[s];let r=this.values.get(s);return r===void 0&&a!==void 0&&(r=zi(a===null?void 0:a,{owner:this}),this.addValue(s,r)),r}readValue(s,a){let r=this.latestValues[s]!==void 0||!this.current?this.latestValues[s]:this.getBaseTargetFromProps(this.props,s)??this.readValueFromInstance(this.current,s,this.options);return r!=null&&(typeof r=="string"&&(y1(r)||v1(r))?r=parseFloat(r):!nk(r)&&un.test(a)&&(r=tN(s,a)),this.setBaseTarget(s,_s(r)?r.get():r)),_s(r)?r.get():r}setBaseTarget(s,a){this.baseTarget[s]=a}getBaseTarget(s){var l;const{initial:a}=this.props;let r;if(typeof a=="string"||typeof a=="object"){const c=fg(this.props,a,(l=this.presenceContext)==null?void 0:l.custom);c&&(r=c[s])}if(a&&r!==void 0)return r;const o=this.getBaseTargetFromProps(this.props,s);return o!==void 0&&!_s(o)?o:this.initialValues[s]!==void 0&&r===void 0?void 0:this.baseTarget[s]}on(s,a){return this.events[s]||(this.events[s]=new H0),this.events[s].add(a)}notify(s,...a){this.events[s]&&this.events[s].notify(...a)}scheduleRenderMicrotask(){og.render(this.render)}}class CN extends Yk{constructor(){super(...arguments),this.KeyframeResolver=ZT}sortInstanceNodePosition(s,a){return s.compareDocumentPosition(a)&2?1:-1}getBaseTargetFromProps(s,a){return s.style?s.style[a]:void 0}removeValueFromRenderState(s,{vars:a,style:r}){delete a[s],delete r[s]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:s}=this.props;_s(s)&&(this.childSubscription=s.on("change",a=>{this.current&&(this.current.textContent=`${a}`)}))}}function TN(t,{style:s,vars:a},r,o){const l=t.style;let c;for(c in s)l[c]=s[c];o==null||o.applyProjectionStyles(l,r);for(c in a)l.setProperty(c,a[c])}function Kk(t){return window.getComputedStyle(t)}class Xk extends CN{constructor(){super(...arguments),this.type="html",this.renderInstance=TN}readValueFromInstance(s,a){var r;if(Zi.has(a))return(r=this.projection)!=null&&r.isProjecting?Xp(a):mT(s,a);{const o=Kk(s),l=(W0(a)?o.getPropertyValue(a):o[a])||0;return typeof l=="string"?l.trim():l}}measureInstanceViewportBox(s,{transformPagePoint:a}){return SN(s,a)}build(s,a,r){ug(s,a,r.transformTemplate)}scrapeMotionValuesFromProps(s,a,r){return pg(s,a,r)}}const kN=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function Qk(t,s,a,r){TN(t,s,void 0,r);for(const o in s.attrs)t.setAttribute(kN.has(o)?o:gg(o),s.attrs[o])}class Jk extends CN{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=Ft}getBaseTargetFromProps(s,a){return s[a]}readValueFromInstance(s,a){if(Zi.has(a)){const r=eN(a);return r&&r.default||0}return a=kN.has(a)?a:gg(a),s.getAttribute(a)}scrapeMotionValuesFromProps(s,a,r){return yN(s,a,r)}build(s,a,r){fN(s,a,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(s,a,r,o){Qk(s,a,r,o)}mount(s){this.isSVGTag=gN(s.tagName),super.mount(s)}}const eA=(t,s)=>hg(t)?new Jk(s):new Xk(s,{allowProjection:t!==y.Fragment});function Ti(t,s,a){const r=t.getProps();return fg(r,s,a!==void 0?a:r.custom,t)}const i0=t=>Array.isArray(t);function tA(t,s,a){t.hasValue(s)?t.getValue(s).set(a):t.addValue(s,zi(a))}function sA(t){return i0(t)?t[t.length-1]||0:t}function aA(t,s){const a=Ti(t,s);let{transitionEnd:r={},transition:o={},...l}=a||{};l={...l,...r};for(const c in l){const u=sA(l[c]);tA(t,c,u)}}function rA(t){return!!(_s(t)&&t.add)}function l0(t,s){const a=t.getValue("willChange");if(rA(a))return a.add(s);if(!a&&Cr.WillChange){const r=new Cr.WillChange("auto");t.addValue("willChange",r),r.add(s)}}function AN(t){return t.props[bN]}const nA=t=>t!==null;function oA(t,{repeat:s,repeatType:a="loop"},r){const o=t.filter(nA),l=s&&a!=="loop"&&s%2===1?0:o.length-1;return o[l]}const iA={type:"spring",stiffness:500,damping:25,restSpeed:10},lA=t=>({type:"spring",stiffness:550,damping:t===0?2*Math.sqrt(550):30,restSpeed:10}),cA={type:"keyframes",duration:.8},dA={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},uA=(t,{keyframes:s})=>s.length>2?cA:Zi.has(t)?t.startsWith("scale")?lA(s[1]):iA:dA;function mA({when:t,delay:s,delayChildren:a,staggerChildren:r,staggerDirection:o,repeat:l,repeatType:c,repeatDelay:u,from:h,elapsed:f,...p}){return!!Object.keys(p).length}const xg=(t,s,a,r={},o,l)=>c=>{const u=rg(r,t)||{},h=u.delay||r.delay||0;let{elapsed:f=0}=r;f=f-qa(h);const p={keyframes:Array.isArray(a)?a:[null,a],ease:"easeOut",velocity:s.getVelocity(),...u,delay:-f,onUpdate:v=>{s.set(v),u.onUpdate&&u.onUpdate(v)},onComplete:()=>{c(),u.onComplete&&u.onComplete()},name:t,motionValue:s,element:l?void 0:o};mA(u)||Object.assign(p,uA(t,p)),p.duration&&(p.duration=qa(p.duration)),p.repeatDelay&&(p.repeatDelay=qa(p.repeatDelay)),p.from!==void 0&&(p.keyframes[0]=p.from);let g=!1;if((p.type===!1||p.duration===0&&!p.repeatDelay)&&(s0(p),p.delay===0&&(g=!0)),(Cr.instantAnimations||Cr.skipAnimations)&&(g=!0,s0(p),p.delay=0),p.allowFlatten=!u.type&&!u.ease,g&&!l&&s.get()!==void 0){const v=oA(p.keyframes,u);if(v!==void 0){At.update(()=>{p.onUpdate(v),p.onComplete()});return}}return u.isSync?new sg(p):new PT(p)};function hA({protectedKeys:t,needsAnimating:s},a){const r=t.hasOwnProperty(a)&&s[a]!==!0;return s[a]=!1,r}function MN(t,s,{delay:a=0,transitionOverride:r,type:o}={}){let{transition:l=t.getDefaultTransition(),transitionEnd:c,...u}=s;r&&(l=r);const h=[],f=o&&t.animationState&&t.animationState.getState()[o];for(const p in u){const g=t.getValue(p,t.latestValues[p]??null),v=u[p];if(v===void 0||f&&hA(f,p))continue;const b={delay:a,...rg(l||{},p)},_=g.get();if(_!==void 0&&!g.isAnimating&&!Array.isArray(v)&&v===_&&!b.velocity)continue;let w=!1;if(window.MotionHandoffAnimation){const k=AN(t);if(k){const N=window.MotionHandoffAnimation(k,p,At);N!==null&&(b.startTime=N,w=!0)}}l0(t,p),g.start(xg(p,g,v,t.shouldReduceMotion&&X1.has(p)?{type:!1}:b,t,w));const E=g.animation;E&&h.push(E)}return c&&Promise.all(h).then(()=>{At.update(()=>{c&&aA(t,c)})}),h}function RN(t,s,a,r=0,o=1){const l=Array.from(t).sort((f,p)=>f.sortNodePosition(p)).indexOf(s),c=t.size,u=(c-1)*r;return typeof a=="function"?a(l,c):o===1?l*r:u-l*r}function c0(t,s,a={}){var h;const r=Ti(t,s,a.type==="exit"?(h=t.presenceContext)==null?void 0:h.custom:void 0);let{transition:o=t.getDefaultTransition()||{}}=r||{};a.transitionOverride&&(o=a.transitionOverride);const l=r?()=>Promise.all(MN(t,r,a)):()=>Promise.resolve(),c=t.variantChildren&&t.variantChildren.size?(f=0)=>{const{delayChildren:p=0,staggerChildren:g,staggerDirection:v}=o;return fA(t,s,f,p,g,v,a)}:()=>Promise.resolve(),{when:u}=o;if(u){const[f,p]=u==="beforeChildren"?[l,c]:[c,l];return f().then(()=>p())}else return Promise.all([l(),c(a.delay)])}function fA(t,s,a=0,r=0,o=0,l=1,c){const u=[];for(const h of t.variantChildren)h.notify("AnimationStart",s),u.push(c0(h,s,{...c,delay:a+(typeof r=="function"?0:r)+RN(t.variantChildren,h,r,o,l)}).then(()=>h.notify("AnimationComplete",s)));return Promise.all(u)}function pA(t,s,a={}){t.notify("AnimationStart",s);let r;if(Array.isArray(s)){const o=s.map(l=>c0(t,l,a));r=Promise.all(o)}else if(typeof s=="string")r=c0(t,s,a);else{const o=typeof s=="function"?Ti(t,s,a.custom):s;r=Promise.all(MN(t,o,a))}return r.then(()=>{t.notify("AnimationComplete",s)})}function ON(t,s){if(!Array.isArray(s))return!1;const a=s.length;if(a!==t.length)return!1;for(let r=0;r<a;r++)if(s[r]!==t[r])return!1;return!0}const gA=dg.length;function DN(t){if(!t)return;if(!t.isControllingVariants){const a=t.parent?DN(t.parent)||{}:{};return t.props.initial!==void 0&&(a.initial=t.props.initial),a}const s={};for(let a=0;a<gA;a++){const r=dg[a],o=t.props[r];(Sc(o)||o===!1)&&(s[r]=o)}return s}const xA=[...cg].reverse(),yA=cg.length;function bA(t){return s=>Promise.all(s.map(({animation:a,options:r})=>pA(t,a,r)))}function vA(t){let s=bA(t),a=Lw(),r=!0;const o=h=>(f,p)=>{var v;const g=Ti(t,p,h==="exit"?(v=t.presenceContext)==null?void 0:v.custom:void 0);if(g){const{transition:b,transitionEnd:_,...w}=g;f={...f,...w,..._}}return f};function l(h){s=h(t)}function c(h){const{props:f}=t,p=DN(t.parent)||{},g=[],v=new Set;let b={},_=1/0;for(let E=0;E<yA;E++){const k=xA[E],N=a[k],C=f[k]!==void 0?f[k]:p[k],S=Sc(C),T=k===h?N.isActive:null;T===!1&&(_=E);let M=C===p[k]&&C!==f[k]&&S;if(M&&r&&t.manuallyAnimateOnMount&&(M=!1),N.protectedKeys={...b},!N.isActive&&T===null||!C&&!N.prevProp||bm(C)||typeof C=="boolean")continue;const $=wA(N.prevProp,C);let A=$||k===h&&N.isActive&&!M&&S||E>_&&S,z=!1;const R=Array.isArray(C)?C:[C];let L=R.reduce(o(k),{});T===!1&&(L={});const{prevResolvedValues:I={}}=N,X={...I,...L},ce=Y=>{A=!0,v.has(Y)&&(z=!0,v.delete(Y)),N.needsAnimating[Y]=!0;const ee=t.getValue(Y);ee&&(ee.liveStyle=!1)};for(const Y in X){const ee=L[Y],we=I[Y];if(b.hasOwnProperty(Y))continue;let D=!1;i0(ee)&&i0(we)?D=!ON(ee,we):D=ee!==we,D?ee!=null?ce(Y):v.add(Y):ee!==void 0&&v.has(Y)?ce(Y):N.protectedKeys[Y]=!0}N.prevProp=C,N.prevResolvedValues=L,N.isActive&&(b={...b,...L}),r&&t.blockInitialAnimation&&(A=!1);const J=M&&$;A&&(!J||z)&&g.push(...R.map(Y=>{const ee={type:k};if(typeof Y=="string"&&r&&!J&&t.manuallyAnimateOnMount&&t.parent){const{parent:we}=t,D=Ti(we,Y);if(we.enteringChildren&&D){const{delayChildren:H}=D.transition||{};ee.delay=RN(we.enteringChildren,t,H)}}return{animation:Y,options:ee}}))}if(v.size){const E={};if(typeof f.initial!="boolean"){const k=Ti(t,Array.isArray(f.initial)?f.initial[0]:f.initial);k&&k.transition&&(E.transition=k.transition)}v.forEach(k=>{const N=t.getBaseTarget(k),C=t.getValue(k);C&&(C.liveStyle=!0),E[k]=N??null}),g.push({animation:E})}let w=!!g.length;return r&&(f.initial===!1||f.initial===f.animate)&&!t.manuallyAnimateOnMount&&(w=!1),r=!1,w?s(g):Promise.resolve()}function u(h,f){var g;if(a[h].isActive===f)return Promise.resolve();(g=t.variantChildren)==null||g.forEach(v=>{var b;return(b=v.animationState)==null?void 0:b.setActive(h,f)}),a[h].isActive=f;const p=c(h);for(const v in a)a[v].protectedKeys={};return p}return{animateChanges:c,setActive:u,setAnimateFunction:l,getState:()=>a,reset:()=>{a=Lw(),r=!0}}}function wA(t,s){return typeof s=="string"?s!==t:Array.isArray(s)?!ON(s,t):!1}function In(t=!1){return{isActive:t,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function Lw(){return{animate:In(!0),whileInView:In(),whileHover:In(),whileTap:In(),whileDrag:In(),whileFocus:In(),exit:In()}}class pn{constructor(s){this.isMounted=!1,this.node=s}update(){}}class jA extends pn{constructor(s){super(s),s.animationState||(s.animationState=vA(s))}updateAnimationControlsSubscription(){const{animate:s}=this.node.getProps();bm(s)&&(this.unmountControls=s.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:s}=this.node.getProps(),{animate:a}=this.node.prevProps||{};s!==a&&this.updateAnimationControlsSubscription()}unmount(){var s;this.node.animationState.reset(),(s=this.unmountControls)==null||s.call(this)}}let _A=0;class NA extends pn{constructor(){super(...arguments),this.id=_A++}update(){if(!this.node.presenceContext)return;const{isPresent:s,onExitComplete:a}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||s===r)return;const o=this.node.animationState.setActive("exit",!s);a&&!s&&o.then(()=>{a(this.id)})}mount(){const{register:s,onExitComplete:a}=this.node.presenceContext||{};a&&a(this.id),s&&(this.unmount=s(this.id))}unmount(){}}const SA={animation:{Feature:jA},exit:{Feature:NA}};function Cc(t,s,a,r={passive:!0}){return t.addEventListener(s,a,r),()=>t.removeEventListener(s,a)}function Vc(t){return{point:{x:t.pageX,y:t.pageY}}}const EA=t=>s=>ig(s)&&t(s,Vc(s));function dc(t,s,a,r){return Cc(t,s,EA(a),r)}const PN=1e-4,CA=1-PN,TA=1+PN,zN=.01,kA=0-zN,AA=0+zN;function Ts(t){return t.max-t.min}function MA(t,s,a){return Math.abs(t-s)<=a}function Uw(t,s,a,r=.5){t.origin=r,t.originPoint=Pt(s.min,s.max,t.origin),t.scale=Ts(a)/Ts(s),t.translate=Pt(a.min,a.max,t.origin)-t.originPoint,(t.scale>=CA&&t.scale<=TA||isNaN(t.scale))&&(t.scale=1),(t.translate>=kA&&t.translate<=AA||isNaN(t.translate))&&(t.translate=0)}function uc(t,s,a,r){Uw(t.x,s.x,a.x,r?r.originX:void 0),Uw(t.y,s.y,a.y,r?r.originY:void 0)}function Bw(t,s,a){t.min=a.min+s.min,t.max=t.min+Ts(s)}function RA(t,s,a){Bw(t.x,s.x,a.x),Bw(t.y,s.y,a.y)}function Vw(t,s,a){t.min=s.min-a.min,t.max=t.min+Ts(s)}function mc(t,s,a){Vw(t.x,s.x,a.x),Vw(t.y,s.y,a.y)}function da(t){return[t("x"),t("y")]}const $N=({current:t})=>t?t.ownerDocument.defaultView:null,qw=(t,s)=>Math.abs(t-s);function OA(t,s){const a=qw(t.x,s.x),r=qw(t.y,s.y);return Math.sqrt(a**2+r**2)}class IN{constructor(s,a,{transformPagePoint:r,contextWindow:o=window,dragSnapToOrigin:l=!1,distanceThreshold:c=3}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=hp(this.lastMoveEventInfo,this.history),b=this.startEvent!==null,_=OA(v.offset,{x:0,y:0})>=this.distanceThreshold;if(!b&&!_)return;const{point:w}=v,{timestamp:E}=ys;this.history.push({...w,timestamp:E});const{onStart:k,onMove:N}=this.handlers;b||(k&&k(this.lastMoveEvent,v),this.startEvent=this.lastMoveEvent),N&&N(this.lastMoveEvent,v)},this.handlePointerMove=(v,b)=>{this.lastMoveEvent=v,this.lastMoveEventInfo=mp(b,this.transformPagePoint),At.update(this.updatePoint,!0)},this.handlePointerUp=(v,b)=>{this.end();const{onEnd:_,onSessionEnd:w,resumeAnimation:E}=this.handlers;if(this.dragSnapToOrigin&&E&&E(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const k=hp(v.type==="pointercancel"?this.lastMoveEventInfo:mp(b,this.transformPagePoint),this.history);this.startEvent&&_&&_(v,k),w&&w(v,k)},!ig(s))return;this.dragSnapToOrigin=l,this.handlers=a,this.transformPagePoint=r,this.distanceThreshold=c,this.contextWindow=o||window;const u=Vc(s),h=mp(u,this.transformPagePoint),{point:f}=h,{timestamp:p}=ys;this.history=[{...f,timestamp:p}];const{onSessionStart:g}=a;g&&g(s,hp(h,this.history)),this.removeListeners=Lc(dc(this.contextWindow,"pointermove",this.handlePointerMove),dc(this.contextWindow,"pointerup",this.handlePointerUp),dc(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(s){this.handlers=s}end(){this.removeListeners&&this.removeListeners(),dn(this.updatePoint)}}function mp(t,s){return s?{point:s(t.point)}:t}function Fw(t,s){return{x:t.x-s.x,y:t.y-s.y}}function hp({point:t},s){return{point:t,delta:Fw(t,LN(s)),offset:Fw(t,DA(s)),velocity:PA(s,.1)}}function DA(t){return t[0]}function LN(t){return t[t.length-1]}function PA(t,s){if(t.length<2)return{x:0,y:0};let a=t.length-1,r=null;const o=LN(t);for(;a>=0&&(r=t[a],!(o.timestamp-r.timestamp>qa(s)));)a--;if(!r)return{x:0,y:0};const l=Fa(o.timestamp-r.timestamp);if(l===0)return{x:0,y:0};const c={x:(o.x-r.x)/l,y:(o.y-r.y)/l};return c.x===1/0&&(c.x=0),c.y===1/0&&(c.y=0),c}function zA(t,{min:s,max:a},r){return s!==void 0&&t<s?t=r?Pt(s,t,r.min):Math.max(t,s):a!==void 0&&t>a&&(t=r?Pt(a,t,r.max):Math.min(t,a)),t}function Hw(t,s,a){return{min:s!==void 0?t.min+s:void 0,max:a!==void 0?t.max+a-(t.max-t.min):void 0}}function $A(t,{top:s,left:a,bottom:r,right:o}){return{x:Hw(t.x,a,o),y:Hw(t.y,s,r)}}function Gw(t,s){let a=s.min-t.min,r=s.max-t.max;return s.max-s.min<t.max-t.min&&([a,r]=[r,a]),{min:a,max:r}}function IA(t,s){return{x:Gw(t.x,s.x),y:Gw(t.y,s.y)}}function LA(t,s){let a=.5;const r=Ts(t),o=Ts(s);return o>r?a=jc(s.min,s.max-r,t.min):r>o&&(a=jc(t.min,t.max-o,s.min)),Er(0,1,a)}function UA(t,s){const a={};return s.min!==void 0&&(a.min=s.min-t.min),s.max!==void 0&&(a.max=s.max-t.min),a}const d0=.35;function BA(t=d0){return t===!1?t=0:t===!0&&(t=d0),{x:Zw(t,"left","right"),y:Zw(t,"top","bottom")}}function Zw(t,s,a){return{min:Ww(t,s),max:Ww(t,a)}}function Ww(t,s){return typeof t=="number"?t:t[s]||0}const VA=new WeakMap;class qA{constructor(s){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=Ft(),this.latestPointerEvent=null,this.latestPanInfo=null,this.visualElement=s}start(s,{snapToCursor:a=!1,distanceThreshold:r}={}){const{presenceContext:o}=this.visualElement;if(o&&o.isPresent===!1)return;const l=g=>{const{dragSnapToOrigin:v}=this.getProps();v?this.pauseAnimation():this.stopAnimation(),a&&this.snapToCursor(Vc(g).point)},c=(g,v)=>{const{drag:b,dragPropagation:_,onDragStart:w}=this.getProps();if(b&&!_&&(this.openDragLock&&this.openDragLock(),this.openDragLock=XT(b),!this.openDragLock))return;this.latestPointerEvent=g,this.latestPanInfo=v,this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),da(k=>{let N=this.getAxisMotionValue(k).get()||0;if(Ha.test(N)){const{projection:C}=this.visualElement;if(C&&C.layout){const S=C.layout.layoutBox[k];S&&(N=Ts(S)*(parseFloat(N)/100))}}this.originPoint[k]=N}),w&&At.postRender(()=>w(g,v)),l0(this.visualElement,"transform");const{animationState:E}=this.visualElement;E&&E.setActive("whileDrag",!0)},u=(g,v)=>{this.latestPointerEvent=g,this.latestPanInfo=v;const{dragPropagation:b,dragDirectionLock:_,onDirectionLock:w,onDrag:E}=this.getProps();if(!b&&!this.openDragLock)return;const{offset:k}=v;if(_&&this.currentDirection===null){this.currentDirection=FA(k),this.currentDirection!==null&&w&&w(this.currentDirection);return}this.updateAxis("x",v.point,k),this.updateAxis("y",v.point,k),this.visualElement.render(),E&&E(g,v)},h=(g,v)=>{this.latestPointerEvent=g,this.latestPanInfo=v,this.stop(g,v),this.latestPointerEvent=null,this.latestPanInfo=null},f=()=>da(g=>{var v;return this.getAnimationState(g)==="paused"&&((v=this.getAxisMotionValue(g).animation)==null?void 0:v.play())}),{dragSnapToOrigin:p}=this.getProps();this.panSession=new IN(s,{onSessionStart:l,onStart:c,onMove:u,onSessionEnd:h,resumeAnimation:f},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:p,distanceThreshold:r,contextWindow:$N(this.visualElement)})}stop(s,a){const r=s||this.latestPointerEvent,o=a||this.latestPanInfo,l=this.isDragging;if(this.cancel(),!l||!o||!r)return;const{velocity:c}=o;this.startAnimation(c);const{onDragEnd:u}=this.getProps();u&&At.postRender(()=>u(r,o))}cancel(){this.isDragging=!1;const{projection:s,animationState:a}=this.visualElement;s&&(s.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),a&&a.setActive("whileDrag",!1)}updateAxis(s,a,r){const{drag:o}=this.getProps();if(!r||!uu(s,o,this.currentDirection))return;const l=this.getAxisMotionValue(s);let c=this.originPoint[s]+r[s];this.constraints&&this.constraints[s]&&(c=zA(c,this.constraints[s],this.elastic[s])),l.set(c)}resolveConstraints(){var l;const{dragConstraints:s,dragElastic:a}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(l=this.visualElement.projection)==null?void 0:l.layout,o=this.constraints;s&&vi(s)?this.constraints||(this.constraints=this.resolveRefConstraints()):s&&r?this.constraints=$A(r.layoutBox,s):this.constraints=!1,this.elastic=BA(a),o!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&da(c=>{this.constraints!==!1&&this.getAxisMotionValue(c)&&(this.constraints[c]=UA(r.layoutBox[c],this.constraints[c]))})}resolveRefConstraints(){const{dragConstraints:s,onMeasureDragConstraints:a}=this.getProps();if(!s||!vi(s))return!1;const r=s.current,{projection:o}=this.visualElement;if(!o||!o.layout)return!1;const l=Hk(r,o.root,this.visualElement.getTransformPagePoint());let c=IA(o.layout.layoutBox,l);if(a){const u=a(Vk(c));this.hasMutatedConstraints=!!u,u&&(c=jN(u))}return c}startAnimation(s){const{drag:a,dragMomentum:r,dragElastic:o,dragTransition:l,dragSnapToOrigin:c,onDragTransitionEnd:u}=this.getProps(),h=this.constraints||{},f=da(p=>{if(!uu(p,a,this.currentDirection))return;let g=h&&h[p]||{};c&&(g={min:0,max:0});const v=o?200:1e6,b=o?40:1e7,_={type:"inertia",velocity:r?s[p]:0,bounceStiffness:v,bounceDamping:b,timeConstant:750,restDelta:1,restSpeed:10,...l,...g};return this.startAxisValueAnimation(p,_)});return Promise.all(f).then(u)}startAxisValueAnimation(s,a){const r=this.getAxisMotionValue(s);return l0(this.visualElement,s),r.start(xg(s,r,0,a,this.visualElement,!1))}stopAnimation(){da(s=>this.getAxisMotionValue(s).stop())}pauseAnimation(){da(s=>{var a;return(a=this.getAxisMotionValue(s).animation)==null?void 0:a.pause()})}getAnimationState(s){var a;return(a=this.getAxisMotionValue(s).animation)==null?void 0:a.state}getAxisMotionValue(s){const a=`_drag${s.toUpperCase()}`,r=this.visualElement.getProps(),o=r[a];return o||this.visualElement.getValue(s,(r.initial?r.initial[s]:void 0)||0)}snapToCursor(s){da(a=>{const{drag:r}=this.getProps();if(!uu(a,r,this.currentDirection))return;const{projection:o}=this.visualElement,l=this.getAxisMotionValue(a);if(o&&o.layout){const{min:c,max:u}=o.layout.layoutBox[a];l.set(s[a]-Pt(c,u,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:s,dragConstraints:a}=this.getProps(),{projection:r}=this.visualElement;if(!vi(a)||!r||!this.constraints)return;this.stopAnimation();const o={x:0,y:0};da(c=>{const u=this.getAxisMotionValue(c);if(u&&this.constraints!==!1){const h=u.get();o[c]=LA({min:h,max:h},this.constraints[c])}});const{transformTemplate:l}=this.visualElement.getProps();this.visualElement.current.style.transform=l?l({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),da(c=>{if(!uu(c,s,null))return;const u=this.getAxisMotionValue(c),{min:h,max:f}=this.constraints[c];u.set(Pt(h,f,o[c]))})}addListeners(){if(!this.visualElement.current)return;VA.set(this.visualElement,this);const s=this.visualElement.current,a=dc(s,"pointerdown",h=>{const{drag:f,dragListener:p=!0}=this.getProps();f&&p&&this.start(h)}),r=()=>{const{dragConstraints:h}=this.getProps();vi(h)&&h.current&&(this.constraints=this.resolveRefConstraints())},{projection:o}=this.visualElement,l=o.addEventListener("measure",r);o&&!o.layout&&(o.root&&o.root.updateScroll(),o.updateLayout()),At.read(r);const c=Cc(window,"resize",()=>this.scalePositionWithinConstraints()),u=o.addEventListener("didUpdate",({delta:h,hasLayoutChanged:f})=>{this.isDragging&&f&&(da(p=>{const g=this.getAxisMotionValue(p);g&&(this.originPoint[p]+=h[p].translate,g.set(g.get()+h[p].translate))}),this.visualElement.render())});return()=>{c(),a(),l(),u&&u()}}getProps(){const s=this.visualElement.getProps(),{drag:a=!1,dragDirectionLock:r=!1,dragPropagation:o=!1,dragConstraints:l=!1,dragElastic:c=d0,dragMomentum:u=!0}=s;return{...s,drag:a,dragDirectionLock:r,dragPropagation:o,dragConstraints:l,dragElastic:c,dragMomentum:u}}}function uu(t,s,a){return(s===!0||s===t)&&(a===null||a===t)}function FA(t,s=10){let a=null;return Math.abs(t.y)>s?a="y":Math.abs(t.x)>s&&(a="x"),a}class HA extends pn{constructor(s){super(s),this.removeGroupControls=ua,this.removeListeners=ua,this.controls=new qA(s)}mount(){const{dragControls:s}=this.node.getProps();s&&(this.removeGroupControls=s.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||ua}unmount(){this.removeGroupControls(),this.removeListeners()}}const Yw=t=>(s,a)=>{t&&At.postRender(()=>t(s,a))};class GA extends pn{constructor(){super(...arguments),this.removePointerDownListener=ua}onPointerDown(s){this.session=new IN(s,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:$N(this.node)})}createPanHandlers(){const{onPanSessionStart:s,onPanStart:a,onPan:r,onPanEnd:o}=this.node.getProps();return{onSessionStart:Yw(s),onStart:Yw(a),onMove:r,onEnd:(l,c)=>{delete this.session,o&&At.postRender(()=>o(l,c))}}}mount(){this.removePointerDownListener=dc(this.node.current,"pointerdown",s=>this.onPointerDown(s))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const Au={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function Kw(t,s){return s.max===s.min?0:t/(s.max-s.min)*100}const Xl={correct:(t,s)=>{if(!s.target)return t;if(typeof t=="string")if(We.test(t))t=parseFloat(t);else return t;const a=Kw(t,s.target.x),r=Kw(t,s.target.y);return`${a}% ${r}%`}},ZA={correct:(t,{treeScale:s,projectionDelta:a})=>{const r=t,o=un.parse(t);if(o.length>5)return r;const l=un.createTransformer(t),c=typeof o[0]!="number"?1:0,u=a.x.scale*s.x,h=a.y.scale*s.y;o[0+c]/=u,o[1+c]/=h;const f=Pt(u,h,.5);return typeof o[2+c]=="number"&&(o[2+c]/=f),typeof o[3+c]=="number"&&(o[3+c]/=f),l(o)}};let fp=!1;class WA extends y.Component{componentDidMount(){const{visualElement:s,layoutGroup:a,switchLayoutGroup:r,layoutId:o}=this.props,{projection:l}=s;gk(YA),l&&(a.group&&a.group.add(l),r&&r.register&&o&&r.register(l),fp&&l.root.didUpdate(),l.addEventListener("animationComplete",()=>{this.safeToRemove()}),l.setOptions({...l.options,onExitComplete:()=>this.safeToRemove()})),Au.hasEverUpdated=!0}getSnapshotBeforeUpdate(s){const{layoutDependency:a,visualElement:r,drag:o,isPresent:l}=this.props,{projection:c}=r;return c&&(c.isPresent=l,fp=!0,o||s.layoutDependency!==a||a===void 0||s.isPresent!==l?c.willUpdate():this.safeToRemove(),s.isPresent!==l&&(l?c.promote():c.relegate()||At.postRender(()=>{const u=c.getStack();(!u||!u.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:s}=this.props.visualElement;s&&(s.root.didUpdate(),og.postRender(()=>{!s.currentAnimation&&s.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:s,layoutGroup:a,switchLayoutGroup:r}=this.props,{projection:o}=s;fp=!0,o&&(o.scheduleCheckAfterUnmount(),a&&a.group&&a.group.remove(o),r&&r.deregister&&r.deregister(o))}safeToRemove(){const{safeToRemove:s}=this.props;s&&s()}render(){return null}}function UN(t){const[s,a]=lN(),r=y.useContext(I0);return e.jsx(WA,{...t,layoutGroup:r,switchLayoutGroup:y.useContext(vN),isPresent:s,safeToRemove:a})}const YA={borderRadius:{...Xl,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Xl,borderTopRightRadius:Xl,borderBottomLeftRadius:Xl,borderBottomRightRadius:Xl,boxShadow:ZA};function KA(t,s,a){const r=_s(t)?t:zi(t);return r.start(xg("",r,s,a)),r.animation}const XA=(t,s)=>t.depth-s.depth;class QA{constructor(){this.children=[],this.isDirty=!1}add(s){B0(this.children,s),this.isDirty=!0}remove(s){V0(this.children,s),this.isDirty=!0}forEach(s){this.isDirty&&this.children.sort(XA),this.isDirty=!1,this.children.forEach(s)}}function JA(t,s){const a=zs.now(),r=({timestamp:o})=>{const l=o-a;l>=s&&(dn(r),t(l-s))};return At.setup(r,!0),()=>dn(r)}const BN=["TopLeft","TopRight","BottomLeft","BottomRight"],eM=BN.length,Xw=t=>typeof t=="string"?parseFloat(t):t,Qw=t=>typeof t=="number"||We.test(t);function tM(t,s,a,r,o,l){o?(t.opacity=Pt(0,a.opacity??1,sM(r)),t.opacityExit=Pt(s.opacity??1,0,aM(r))):l&&(t.opacity=Pt(s.opacity??1,a.opacity??1,r));for(let c=0;c<eM;c++){const u=`border${BN[c]}Radius`;let h=Jw(s,u),f=Jw(a,u);if(h===void 0&&f===void 0)continue;h||(h=0),f||(f=0),h===0||f===0||Qw(h)===Qw(f)?(t[u]=Math.max(Pt(Xw(h),Xw(f),r),0),(Ha.test(f)||Ha.test(h))&&(t[u]+="%")):t[u]=f}(s.rotate||a.rotate)&&(t.rotate=Pt(s.rotate||0,a.rotate||0,r))}function Jw(t,s){return t[s]!==void 0?t[s]:t.borderRadius}const sM=VN(0,.5,T1),aM=VN(.5,.95,ua);function VN(t,s,a){return r=>r<t?0:r>s?1:a(jc(t,s,r))}function ej(t,s){t.min=s.min,t.max=s.max}function ia(t,s){ej(t.x,s.x),ej(t.y,s.y)}function tj(t,s){t.translate=s.translate,t.scale=s.scale,t.originPoint=s.originPoint,t.origin=s.origin}function sj(t,s,a,r,o){return t-=s,t=Fu(t,1/a,r),o!==void 0&&(t=Fu(t,1/o,r)),t}function rM(t,s=0,a=1,r=.5,o,l=t,c=t){if(Ha.test(s)&&(s=parseFloat(s),s=Pt(c.min,c.max,s/100)-c.min),typeof s!="number")return;let u=Pt(l.min,l.max,r);t===l&&(u-=s),t.min=sj(t.min,s,a,u,o),t.max=sj(t.max,s,a,u,o)}function aj(t,s,[a,r,o],l,c){rM(t,s[a],s[r],s[o],s.scale,l,c)}const nM=["x","scaleX","originX"],oM=["y","scaleY","originY"];function rj(t,s,a,r){aj(t.x,s,nM,a?a.x:void 0,r?r.x:void 0),aj(t.y,s,oM,a?a.y:void 0,r?r.y:void 0)}function nj(t){return t.translate===0&&t.scale===1}function qN(t){return nj(t.x)&&nj(t.y)}function oj(t,s){return t.min===s.min&&t.max===s.max}function iM(t,s){return oj(t.x,s.x)&&oj(t.y,s.y)}function ij(t,s){return Math.round(t.min)===Math.round(s.min)&&Math.round(t.max)===Math.round(s.max)}function FN(t,s){return ij(t.x,s.x)&&ij(t.y,s.y)}function lj(t){return Ts(t.x)/Ts(t.y)}function cj(t,s){return t.translate===s.translate&&t.scale===s.scale&&t.originPoint===s.originPoint}class lM{constructor(){this.members=[]}add(s){B0(this.members,s),s.scheduleRender()}remove(s){if(V0(this.members,s),s===this.prevLead&&(this.prevLead=void 0),s===this.lead){const a=this.members[this.members.length-1];a&&this.promote(a)}}relegate(s){const a=this.members.findIndex(o=>s===o);if(a===0)return!1;let r;for(let o=a;o>=0;o--){const l=this.members[o];if(l.isPresent!==!1){r=l;break}}return r?(this.promote(r),!0):!1}promote(s,a){const r=this.lead;if(s!==r&&(this.prevLead=r,this.lead=s,s.show(),r)){r.instance&&r.scheduleRender(),s.scheduleRender(),s.resumeFrom=r,a&&(s.resumeFrom.preserveOpacity=!0),r.snapshot&&(s.snapshot=r.snapshot,s.snapshot.latestValues=r.animationValues||r.latestValues),s.root&&s.root.isUpdating&&(s.isLayoutDirty=!0);const{crossfade:o}=s.options;o===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(s=>{const{options:a,resumingFrom:r}=s;a.onExitComplete&&a.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(s=>{s.instance&&s.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function cM(t,s,a){let r="";const o=t.x.translate/s.x,l=t.y.translate/s.y,c=(a==null?void 0:a.z)||0;if((o||l||c)&&(r=`translate3d(${o}px, ${l}px, ${c}px) `),(s.x!==1||s.y!==1)&&(r+=`scale(${1/s.x}, ${1/s.y}) `),a){const{transformPerspective:f,rotate:p,rotateX:g,rotateY:v,skewX:b,skewY:_}=a;f&&(r=`perspective(${f}px) ${r}`),p&&(r+=`rotate(${p}deg) `),g&&(r+=`rotateX(${g}deg) `),v&&(r+=`rotateY(${v}deg) `),b&&(r+=`skewX(${b}deg) `),_&&(r+=`skewY(${_}deg) `)}const u=t.x.scale*s.x,h=t.y.scale*s.y;return(u!==1||h!==1)&&(r+=`scale(${u}, ${h})`),r||"none"}const pp=["","X","Y","Z"],dM=1e3;let uM=0;function gp(t,s,a,r){const{latestValues:o}=s;o[t]&&(a[t]=o[t],s.setStaticValue(t,0),r&&(r[t]=0))}function HN(t){if(t.hasCheckedOptimisedAppear=!0,t.root===t)return;const{visualElement:s}=t.options;if(!s)return;const a=AN(s);if(window.MotionHasOptimisedAnimation(a,"transform")){const{layout:o,layoutId:l}=t.options;window.MotionCancelOptimisedAnimation(a,"transform",At,!(o||l))}const{parent:r}=t;r&&!r.hasCheckedOptimisedAppear&&HN(r)}function GN({attachResizeListener:t,defaultParent:s,measureScroll:a,checkIsScrollRoot:r,resetTransform:o}){return class{constructor(c={},u=s==null?void 0:s()){this.id=uM++,this.animationId=0,this.animationCommitId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(fM),this.nodes.forEach(yM),this.nodes.forEach(bM),this.nodes.forEach(pM)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=c,this.root=u?u.root||u:this,this.path=u?[...u.path,u]:[],this.parent=u,this.depth=u?u.depth+1:0;for(let h=0;h<this.path.length;h++)this.path[h].shouldResetTransform=!0;this.root===this&&(this.nodes=new QA)}addEventListener(c,u){return this.eventHandlers.has(c)||this.eventHandlers.set(c,new H0),this.eventHandlers.get(c).add(u)}notifyListeners(c,...u){const h=this.eventHandlers.get(c);h&&h.notify(...u)}hasListeners(c){return this.eventHandlers.has(c)}mount(c){if(this.instance)return;this.isSVG=iN(c)&&!ak(c),this.instance=c;const{layoutId:u,layout:h,visualElement:f}=this.options;if(f&&!f.current&&f.mount(c),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(h||u)&&(this.isLayoutDirty=!0),t){let p,g=0;const v=()=>this.root.updateBlockedByResize=!1;At.read(()=>{g=window.innerWidth}),t(c,()=>{const b=window.innerWidth;b!==g&&(g=b,this.root.updateBlockedByResize=!0,p&&p(),p=JA(v,250),Au.hasAnimatedSinceResize&&(Au.hasAnimatedSinceResize=!1,this.nodes.forEach(mj)))})}u&&this.root.registerSharedNode(u,this),this.options.animate!==!1&&f&&(u||h)&&this.addEventListener("didUpdate",({delta:p,hasLayoutChanged:g,hasRelativeLayoutChanged:v,layout:b})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const _=this.options.transition||f.getDefaultTransition()||NM,{onLayoutAnimationStart:w,onLayoutAnimationComplete:E}=f.getProps(),k=!this.targetLayout||!FN(this.targetLayout,b),N=!g&&v;if(this.options.layoutRoot||this.resumeFrom||N||g&&(k||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0);const C={...rg(_,"layout"),onPlay:w,onComplete:E};(f.shouldReduceMotion||this.options.layoutRoot)&&(C.delay=0,C.type=!1),this.startAnimation(C),this.setAnimationOrigin(p,N)}else g||mj(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=b})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const c=this.getStack();c&&c.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),dn(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(vM),this.animationId++)}getTransformTemplate(){const{visualElement:c}=this.options;return c&&c.getProps().transformTemplate}willUpdate(c=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&HN(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let p=0;p<this.path.length;p++){const g=this.path[p];g.shouldResetTransform=!0,g.updateScroll("snapshot"),g.options.layoutRoot&&g.willUpdate(!1)}const{layoutId:u,layout:h}=this.options;if(u===void 0&&!h)return;const f=this.getTransformTemplate();this.prevTransformTemplateValue=f?f(this.latestValues,""):void 0,this.updateSnapshot(),c&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(dj);return}if(this.animationId<=this.animationCommitId){this.nodes.forEach(uj);return}this.animationCommitId=this.animationId,this.isUpdating?(this.isUpdating=!1,this.nodes.forEach(xM),this.nodes.forEach(mM),this.nodes.forEach(hM)):this.nodes.forEach(uj),this.clearAllSnapshots();const u=zs.now();ys.delta=Er(0,1e3/60,u-ys.timestamp),ys.timestamp=u,ys.isProcessing=!0,rp.update.process(ys),rp.preRender.process(ys),rp.render.process(ys),ys.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,og.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(gM),this.sharedNodes.forEach(wM)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,At.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){At.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!Ts(this.snapshot.measuredBox.x)&&!Ts(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let h=0;h<this.path.length;h++)this.path[h].updateScroll();const c=this.layout;this.layout=this.measure(!1),this.layoutCorrected=Ft(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:u}=this.options;u&&u.notify("LayoutMeasure",this.layout.layoutBox,c?c.layoutBox:void 0)}updateScroll(c="measure"){let u=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===c&&(u=!1),u&&this.instance){const h=r(this.instance);this.scroll={animationId:this.root.animationId,phase:c,isRoot:h,offset:a(this.instance),wasRoot:this.scroll?this.scroll.isRoot:h}}}resetTransform(){if(!o)return;const c=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,u=this.projectionDelta&&!qN(this.projectionDelta),h=this.getTransformTemplate(),f=h?h(this.latestValues,""):void 0,p=f!==this.prevTransformTemplateValue;c&&this.instance&&(u||Vn(this.latestValues)||p)&&(o(this.instance,f),this.shouldResetTransform=!1,this.scheduleRender())}measure(c=!0){const u=this.measurePageBox();let h=this.removeElementScroll(u);return c&&(h=this.removeTransform(h)),SM(h),{animationId:this.root.animationId,measuredBox:u,layoutBox:h,latestValues:{},source:this.id}}measurePageBox(){var f;const{visualElement:c}=this.options;if(!c)return Ft();const u=c.measureViewportBox();if(!(((f=this.scroll)==null?void 0:f.wasRoot)||this.path.some(EM))){const{scroll:p}=this.root;p&&(wi(u.x,p.offset.x),wi(u.y,p.offset.y))}return u}removeElementScroll(c){var h;const u=Ft();if(ia(u,c),(h=this.scroll)!=null&&h.wasRoot)return u;for(let f=0;f<this.path.length;f++){const p=this.path[f],{scroll:g,options:v}=p;p!==this.root&&g&&v.layoutScroll&&(g.wasRoot&&ia(u,c),wi(u.x,g.offset.x),wi(u.y,g.offset.y))}return u}applyTransform(c,u=!1){const h=Ft();ia(h,c);for(let f=0;f<this.path.length;f++){const p=this.path[f];!u&&p.options.layoutScroll&&p.scroll&&p!==p.root&&ji(h,{x:-p.scroll.offset.x,y:-p.scroll.offset.y}),Vn(p.latestValues)&&ji(h,p.latestValues)}return Vn(this.latestValues)&&ji(h,this.latestValues),h}removeTransform(c){const u=Ft();ia(u,c);for(let h=0;h<this.path.length;h++){const f=this.path[h];if(!f.instance||!Vn(f.latestValues))continue;r0(f.latestValues)&&f.updateSnapshot();const p=Ft(),g=f.measurePageBox();ia(p,g),rj(u,f.latestValues,f.snapshot?f.snapshot.layoutBox:void 0,p)}return Vn(this.latestValues)&&rj(u,this.latestValues),u}setTargetDelta(c){this.targetDelta=c,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(c){this.options={...this.options,...c,crossfade:c.crossfade!==void 0?c.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==ys.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(c=!1){var v;const u=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=u.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=u.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=u.isSharedProjectionDirty);const h=!!this.resumingFrom||this!==u;if(!(c||h&&this.isSharedProjectionDirty||this.isProjectionDirty||(v=this.parent)!=null&&v.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:p,layoutId:g}=this.options;if(!(!this.layout||!(p||g))){if(this.resolvedRelativeTargetAt=ys.timestamp,!this.targetDelta&&!this.relativeTarget){const b=this.getClosestProjectingParent();b&&b.layout&&this.animationProgress!==1?(this.relativeParent=b,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ft(),this.relativeTargetOrigin=Ft(),mc(this.relativeTargetOrigin,this.layout.layoutBox,b.layout.layoutBox),ia(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=Ft(),this.targetWithTransforms=Ft()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),RA(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ia(this.target,this.layout.layoutBox),NN(this.target,this.targetDelta)):ia(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const b=this.getClosestProjectingParent();b&&!!b.resumingFrom==!!this.resumingFrom&&!b.options.layoutScroll&&b.target&&this.animationProgress!==1?(this.relativeParent=b,this.forceRelativeParentToResolveTarget(),this.relativeTarget=Ft(),this.relativeTargetOrigin=Ft(),mc(this.relativeTargetOrigin,this.target,b.target),ia(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||r0(this.parent.latestValues)||_N(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var _;const c=this.getLead(),u=!!this.resumingFrom||this!==c;let h=!0;if((this.isProjectionDirty||(_=this.parent)!=null&&_.isProjectionDirty)&&(h=!1),u&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(h=!1),this.resolvedRelativeTargetAt===ys.timestamp&&(h=!1),h)return;const{layout:f,layoutId:p}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(f||p))return;ia(this.layoutCorrected,this.layout.layoutBox);const g=this.treeScale.x,v=this.treeScale.y;Fk(this.layoutCorrected,this.treeScale,this.path,u),c.layout&&!c.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(c.target=c.layout.layoutBox,c.targetWithTransforms=Ft());const{target:b}=c;if(!b){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(tj(this.prevProjectionDelta.x,this.projectionDelta.x),tj(this.prevProjectionDelta.y,this.projectionDelta.y)),uc(this.projectionDelta,this.layoutCorrected,b,this.latestValues),(this.treeScale.x!==g||this.treeScale.y!==v||!cj(this.projectionDelta.x,this.prevProjectionDelta.x)||!cj(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",b))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(c=!0){var u;if((u=this.options.visualElement)==null||u.scheduleRender(),c){const h=this.getStack();h&&h.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=_i(),this.projectionDelta=_i(),this.projectionDeltaWithTransform=_i()}setAnimationOrigin(c,u=!1){const h=this.snapshot,f=h?h.latestValues:{},p={...this.latestValues},g=_i();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!u;const v=Ft(),b=h?h.source:void 0,_=this.layout?this.layout.source:void 0,w=b!==_,E=this.getStack(),k=!E||E.members.length<=1,N=!!(w&&!k&&this.options.crossfade===!0&&!this.path.some(_M));this.animationProgress=0;let C;this.mixTargetDelta=S=>{const T=S/1e3;hj(g.x,c.x,T),hj(g.y,c.y,T),this.setTargetDelta(g),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(mc(v,this.layout.layoutBox,this.relativeParent.layout.layoutBox),jM(this.relativeTarget,this.relativeTargetOrigin,v,T),C&&iM(this.relativeTarget,C)&&(this.isProjectionDirty=!1),C||(C=Ft()),ia(C,this.relativeTarget)),w&&(this.animationValues=p,tM(p,f,this.latestValues,T,N,k)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=T},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(c){var u,h,f;this.notifyListeners("animationStart"),(u=this.currentAnimation)==null||u.stop(),(f=(h=this.resumingFrom)==null?void 0:h.currentAnimation)==null||f.stop(),this.pendingAnimation&&(dn(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=At.update(()=>{Au.hasAnimatedSinceResize=!0,this.motionValue||(this.motionValue=zi(0)),this.currentAnimation=KA(this.motionValue,[0,1e3],{...c,velocity:0,isSync:!0,onUpdate:p=>{this.mixTargetDelta(p),c.onUpdate&&c.onUpdate(p)},onStop:()=>{},onComplete:()=>{c.onComplete&&c.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const c=this.getStack();c&&c.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(dM),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const c=this.getLead();let{targetWithTransforms:u,target:h,layout:f,latestValues:p}=c;if(!(!u||!h||!f)){if(this!==c&&this.layout&&f&&ZN(this.options.animationType,this.layout.layoutBox,f.layoutBox)){h=this.target||Ft();const g=Ts(this.layout.layoutBox.x);h.x.min=c.target.x.min,h.x.max=h.x.min+g;const v=Ts(this.layout.layoutBox.y);h.y.min=c.target.y.min,h.y.max=h.y.min+v}ia(u,h),ji(u,p),uc(this.projectionDeltaWithTransform,this.layoutCorrected,u,p)}}registerSharedNode(c,u){this.sharedNodes.has(c)||this.sharedNodes.set(c,new lM),this.sharedNodes.get(c).add(u);const f=u.options.initialPromotionConfig;u.promote({transition:f?f.transition:void 0,preserveFollowOpacity:f&&f.shouldPreserveFollowOpacity?f.shouldPreserveFollowOpacity(u):void 0})}isLead(){const c=this.getStack();return c?c.lead===this:!0}getLead(){var u;const{layoutId:c}=this.options;return c?((u=this.getStack())==null?void 0:u.lead)||this:this}getPrevLead(){var u;const{layoutId:c}=this.options;return c?(u=this.getStack())==null?void 0:u.prevLead:void 0}getStack(){const{layoutId:c}=this.options;if(c)return this.root.sharedNodes.get(c)}promote({needsReset:c,transition:u,preserveFollowOpacity:h}={}){const f=this.getStack();f&&f.promote(this,h),c&&(this.projectionDelta=void 0,this.needsReset=!0),u&&this.setOptions({transition:u})}relegate(){const c=this.getStack();return c?c.relegate(this):!1}resetSkewAndRotation(){const{visualElement:c}=this.options;if(!c)return;let u=!1;const{latestValues:h}=c;if((h.z||h.rotate||h.rotateX||h.rotateY||h.rotateZ||h.skewX||h.skewY)&&(u=!0),!u)return;const f={};h.z&&gp("z",c,f,this.animationValues);for(let p=0;p<pp.length;p++)gp(`rotate${pp[p]}`,c,f,this.animationValues),gp(`skew${pp[p]}`,c,f,this.animationValues);c.render();for(const p in f)c.setStaticValue(p,f[p]),this.animationValues&&(this.animationValues[p]=f[p]);c.scheduleRender()}applyProjectionStyles(c,u){if(!this.instance||this.isSVG)return;if(!this.isVisible){c.visibility="hidden";return}const h=this.getTransformTemplate();if(this.needsReset){this.needsReset=!1,c.visibility="",c.opacity="",c.pointerEvents=ku(u==null?void 0:u.pointerEvents)||"",c.transform=h?h(this.latestValues,""):"none";return}const f=this.getLead();if(!this.projectionDelta||!this.layout||!f.target){this.options.layoutId&&(c.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,c.pointerEvents=ku(u==null?void 0:u.pointerEvents)||""),this.hasProjected&&!Vn(this.latestValues)&&(c.transform=h?h({},""):"none",this.hasProjected=!1);return}c.visibility="";const p=f.animationValues||f.latestValues;this.applyTransformsToTarget();let g=cM(this.projectionDeltaWithTransform,this.treeScale,p);h&&(g=h(p,g)),c.transform=g;const{x:v,y:b}=this.projectionDelta;c.transformOrigin=`${v.origin*100}% ${b.origin*100}% 0`,f.animationValues?c.opacity=f===this?p.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:c.opacity=f===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const _ in Ec){if(p[_]===void 0)continue;const{correct:w,applyTo:E,isCSSVariable:k}=Ec[_],N=g==="none"?p[_]:w(p[_],f);if(E){const C=E.length;for(let S=0;S<C;S++)c[E[S]]=N}else k?this.options.visualElement.renderState.vars[_]=N:c[_]=N}this.options.layoutId&&(c.pointerEvents=f===this?ku(u==null?void 0:u.pointerEvents)||"":"none")}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(c=>{var u;return(u=c.currentAnimation)==null?void 0:u.stop()}),this.root.nodes.forEach(dj),this.root.sharedNodes.clear()}}}function mM(t){t.updateLayout()}function hM(t){var a;const s=((a=t.resumeFrom)==null?void 0:a.snapshot)||t.snapshot;if(t.isLead()&&t.layout&&s&&t.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:o}=t.layout,{animationType:l}=t.options,c=s.source!==t.layout.source;l==="size"?da(g=>{const v=c?s.measuredBox[g]:s.layoutBox[g],b=Ts(v);v.min=r[g].min,v.max=v.min+b}):ZN(l,s.layoutBox,r)&&da(g=>{const v=c?s.measuredBox[g]:s.layoutBox[g],b=Ts(r[g]);v.max=v.min+b,t.relativeTarget&&!t.currentAnimation&&(t.isProjectionDirty=!0,t.relativeTarget[g].max=t.relativeTarget[g].min+b)});const u=_i();uc(u,r,s.layoutBox);const h=_i();c?uc(h,t.applyTransform(o,!0),s.measuredBox):uc(h,r,s.layoutBox);const f=!qN(u);let p=!1;if(!t.resumeFrom){const g=t.getClosestProjectingParent();if(g&&!g.resumeFrom){const{snapshot:v,layout:b}=g;if(v&&b){const _=Ft();mc(_,s.layoutBox,v.layoutBox);const w=Ft();mc(w,r,b.layoutBox),FN(_,w)||(p=!0),g.options.layoutRoot&&(t.relativeTarget=w,t.relativeTargetOrigin=_,t.relativeParent=g)}}}t.notifyListeners("didUpdate",{layout:r,snapshot:s,delta:h,layoutDelta:u,hasLayoutChanged:f,hasRelativeLayoutChanged:p})}else if(t.isLead()){const{onExitComplete:r}=t.options;r&&r()}t.options.transition=void 0}function fM(t){t.parent&&(t.isProjecting()||(t.isProjectionDirty=t.parent.isProjectionDirty),t.isSharedProjectionDirty||(t.isSharedProjectionDirty=!!(t.isProjectionDirty||t.parent.isProjectionDirty||t.parent.isSharedProjectionDirty)),t.isTransformDirty||(t.isTransformDirty=t.parent.isTransformDirty))}function pM(t){t.isProjectionDirty=t.isSharedProjectionDirty=t.isTransformDirty=!1}function gM(t){t.clearSnapshot()}function dj(t){t.clearMeasurements()}function uj(t){t.isLayoutDirty=!1}function xM(t){const{visualElement:s}=t.options;s&&s.getProps().onBeforeLayoutMeasure&&s.notify("BeforeLayoutMeasure"),t.resetTransform()}function mj(t){t.finishAnimation(),t.targetDelta=t.relativeTarget=t.target=void 0,t.isProjectionDirty=!0}function yM(t){t.resolveTargetDelta()}function bM(t){t.calcProjection()}function vM(t){t.resetSkewAndRotation()}function wM(t){t.removeLeadSnapshot()}function hj(t,s,a){t.translate=Pt(s.translate,0,a),t.scale=Pt(s.scale,1,a),t.origin=s.origin,t.originPoint=s.originPoint}function fj(t,s,a,r){t.min=Pt(s.min,a.min,r),t.max=Pt(s.max,a.max,r)}function jM(t,s,a,r){fj(t.x,s.x,a.x,r),fj(t.y,s.y,a.y,r)}function _M(t){return t.animationValues&&t.animationValues.opacityExit!==void 0}const NM={duration:.45,ease:[.4,0,.1,1]},pj=t=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(t),gj=pj("applewebkit/")&&!pj("chrome/")?Math.round:ua;function xj(t){t.min=gj(t.min),t.max=gj(t.max)}function SM(t){xj(t.x),xj(t.y)}function ZN(t,s,a){return t==="position"||t==="preserve-aspect"&&!MA(lj(s),lj(a),.2)}function EM(t){var s;return t!==t.root&&((s=t.scroll)==null?void 0:s.wasRoot)}const CM=GN({attachResizeListener:(t,s)=>Cc(t,"resize",s),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),xp={current:void 0},WN=GN({measureScroll:t=>({x:t.scrollLeft,y:t.scrollTop}),defaultParent:()=>{if(!xp.current){const t=new CM({});t.mount(window),t.setOptions({layoutScroll:!0}),xp.current=t}return xp.current},resetTransform:(t,s)=>{t.style.transform=s!==void 0?s:"none"},checkIsScrollRoot:t=>window.getComputedStyle(t).position==="fixed"}),TM={pan:{Feature:GA},drag:{Feature:HA,ProjectionNode:WN,MeasureLayout:UN}};function yj(t,s,a){const{props:r}=t;t.animationState&&r.whileHover&&t.animationState.setActive("whileHover",a==="Start");const o="onHover"+a,l=r[o];l&&At.postRender(()=>l(s,Vc(s)))}class kM extends pn{mount(){const{current:s}=this.node;s&&(this.unmount=QT(s,(a,r)=>(yj(this.node,r,"Start"),o=>yj(this.node,o,"End"))))}unmount(){}}class AM extends pn{constructor(){super(...arguments),this.isActive=!1}onFocus(){let s=!1;try{s=this.node.current.matches(":focus-visible")}catch{s=!0}!s||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Lc(Cc(this.node.current,"focus",()=>this.onFocus()),Cc(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function bj(t,s,a){const{props:r}=t;if(t.current instanceof HTMLButtonElement&&t.current.disabled)return;t.animationState&&r.whileTap&&t.animationState.setActive("whileTap",a==="Start");const o="onTap"+(a==="End"?"":a),l=r[o];l&&At.postRender(()=>l(s,Vc(s)))}class MM extends pn{mount(){const{current:s}=this.node;s&&(this.unmount=sk(s,(a,r)=>(bj(this.node,r,"Start"),(o,{success:l})=>bj(this.node,o,l?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const u0=new WeakMap,yp=new WeakMap,RM=t=>{const s=u0.get(t.target);s&&s(t)},OM=t=>{t.forEach(RM)};function DM({root:t,...s}){const a=t||document;yp.has(a)||yp.set(a,{});const r=yp.get(a),o=JSON.stringify(s);return r[o]||(r[o]=new IntersectionObserver(OM,{root:t,...s})),r[o]}function PM(t,s,a){const r=DM(s);return u0.set(t,a),r.observe(t),()=>{u0.delete(t),r.unobserve(t)}}const zM={some:0,all:1};class $M extends pn{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:s={}}=this.node.getProps(),{root:a,margin:r,amount:o="some",once:l}=s,c={root:a?a.current:void 0,rootMargin:r,threshold:typeof o=="number"?o:zM[o]},u=h=>{const{isIntersecting:f}=h;if(this.isInView===f||(this.isInView=f,l&&!f&&this.hasEnteredView))return;f&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",f);const{onViewportEnter:p,onViewportLeave:g}=this.node.getProps(),v=f?p:g;v&&v(h)};return PM(this.node.current,c,u)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:s,prevProps:a}=this.node;["amount","margin","root"].some(IM(s,a))&&this.startObserver()}unmount(){}}function IM({viewport:t={}},{viewport:s={}}={}){return a=>t[a]!==s[a]}const LM={inView:{Feature:$M},tap:{Feature:MM},focus:{Feature:AM},hover:{Feature:kM}},UM={layout:{ProjectionNode:WN,MeasureLayout:UN}},BM={...SA,...LM,...TM,...UM},be=Bk(BM,eA);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VM=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),qM=t=>t.replace(/^([A-Z])|[\s-_]+(\w)/g,(s,a,r)=>r?r.toUpperCase():a.toLowerCase()),vj=t=>{const s=qM(t);return s.charAt(0).toUpperCase()+s.slice(1)},YN=(...t)=>t.filter((s,a,r)=>!!s&&s.trim()!==""&&r.indexOf(s)===a).join(" ").trim(),FM=t=>{for(const s in t)if(s.startsWith("aria-")||s==="role"||s==="title")return!0};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var HM={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GM=y.forwardRef(({color:t="currentColor",size:s=24,strokeWidth:a=2,absoluteStrokeWidth:r,className:o="",children:l,iconNode:c,...u},h)=>y.createElement("svg",{ref:h,...HM,width:s,height:s,stroke:t,strokeWidth:r?Number(a)*24/Number(s):a,className:YN("lucide",o),...!l&&!FM(u)&&{"aria-hidden":"true"},...u},[...c.map(([f,p])=>y.createElement(f,p)),...Array.isArray(l)?l:[l]]));/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ae=(t,s)=>{const a=y.forwardRef(({className:r,...o},l)=>y.createElement(GM,{ref:l,iconNode:s,className:YN(`lucide-${VM(vj(t))}`,`lucide-${t}`,r),...o}));return a.displayName=vj(t),a};/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZM=[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]],KN=Ae("activity",ZM);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WM=[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]],YM=Ae("arrow-down-right",WM);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KM=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],fo=Ae("arrow-left",KM);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XM=[["path",{d:"m16 3 4 4-4 4",key:"1x1c3m"}],["path",{d:"M20 7H4",key:"zbl0bi"}],["path",{d:"m8 21-4-4 4-4",key:"h9nckh"}],["path",{d:"M4 17h16",key:"g4d7ey"}]],Tc=Ae("arrow-right-left",XM);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QM=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],no=Ae("arrow-right",QM);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JM=[["path",{d:"m21 16-4 4-4-4",key:"f6ql7i"}],["path",{d:"M17 20V4",key:"1ejh1v"}],["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}]],eR=Ae("arrow-up-down",JM);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tR=[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]],sR=Ae("arrow-up-right",tR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aR=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],rR=Ae("arrow-up",aR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nR=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],oR=Ae("award",nR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iR=[["path",{d:"M3.85 8.62a4 4 0 0 1 4.78-4.77 4 4 0 0 1 6.74 0 4 4 0 0 1 4.78 4.78 4 4 0 0 1 0 6.74 4 4 0 0 1-4.77 4.78 4 4 0 0 1-6.75 0 4 4 0 0 1-4.78-4.77 4 4 0 0 1 0-6.76Z",key:"3c2336"}]],XN=Ae("badge",iR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lR=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}],["path",{d:"M6 12h.01M18 12h.01",key:"113zkx"}]],cR=Ae("banknote",lR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dR=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M22 8c0-2.3-.8-4.3-2-6",key:"5bb3ad"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}],["path",{d:"M4 2C2.8 3.7 2 5.7 2 8",key:"tap9e0"}]],uR=Ae("bell-ring",dR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mR=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],yg=Ae("bell",mR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hR=[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]],wj=Ae("building-2",hR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fR=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]],pR=Ae("building",fR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gR=[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]],jj=Ae("calculator",gR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xR=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Mr=Ae("calendar",xR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yR=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],bg=Ae("chart-column",yR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bR=[["path",{d:"M21 12c.552 0 1.005-.449.95-.998a10 10 0 0 0-8.953-8.951c-.55-.055-.998.398-.998.95v8a1 1 0 0 0 1 1z",key:"pzmjnu"}],["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}]],vR=Ae("chart-pie",bR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wR=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],Hu=Ae("check",wR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jR=[["path",{d:"M17 21a1 1 0 0 0 1-1v-5.35c0-.457.316-.844.727-1.041a4 4 0 0 0-2.134-7.589 5 5 0 0 0-9.186 0 4 4 0 0 0-2.134 7.588c.411.198.727.585.727 1.041V20a1 1 0 0 0 1 1Z",key:"1qvrer"}],["path",{d:"M6 17h12",key:"1jwigz"}]],kc=Ae("chef-hat",jR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _R=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],NR=Ae("chevron-down",_R);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SR=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],ER=Ae("chevron-right",SR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Ya=Ae("circle-alert",CR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 8v8",key:"napkw2"}],["path",{d:"m8 12 4 4 4-4",key:"k98ssh"}]],_j=Ae("circle-arrow-down",TR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m16 12-4-4-4 4",key:"177agl"}],["path",{d:"M12 16V8",key:"1sbj14"}]],Nj=Ae("circle-arrow-up",kR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AR=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],ts=Ae("circle-check-big",AR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],RR=Ae("circle-help",MR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],Ia=Ae("circle-x",OR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],Bt=Ae("clock",DR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PR=[["path",{d:"M10 2v2",key:"7u0qdc"}],["path",{d:"M14 2v2",key:"6buw04"}],["path",{d:"M16 8a1 1 0 0 1 1 1v8a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4V9a1 1 0 0 1 1-1h14a4 4 0 1 1 0 8h-1",key:"pwadti"}],["path",{d:"M6 2v2",key:"colzsn"}]],zR=Ae("coffee",PR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $R=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],La=Ae("copy",$R);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IR=[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]],Wi=Ae("credit-card",IR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LR=[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]],hc=Ae("database",LR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UR=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],Ut=Ae("dollar-sign",UR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BR=[["path",{d:"M12 15V3",key:"m9g1x1"}],["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["path",{d:"m7 10 5 5 5-5",key:"brsn70"}]],qc=Ae("download",BR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VR=[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]],qR=Ae("external-link",VR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FR=[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],mn=Ae("eye-off",FR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HR=[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Ys=Ae("eye",HR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GR=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],QN=Ae("file-text",GR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZR=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],vg=Ae("funnel",ZR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WR=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],YR=Ae("history",WR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KR=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],XR=Ae("house",KR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],JN=Ae("info",QR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JR=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],jr=Ae("key",JR);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eO=[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]],tO=Ae("layout-dashboard",eO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sO=[["path",{d:"M12 2v4",key:"3427ic"}],["path",{d:"m16.2 7.8 2.9-2.9",key:"r700ao"}],["path",{d:"M18 12h4",key:"wj9ykh"}],["path",{d:"m16.2 16.2 2.9 2.9",key:"1bxg5t"}],["path",{d:"M12 18v4",key:"jadmvz"}],["path",{d:"m4.9 19.1 2.9-2.9",key:"bwix9q"}],["path",{d:"M2 12h4",key:"j09sii"}],["path",{d:"m4.9 4.9 2.9 2.9",key:"giyufr"}]],aO=Ae("loader",sO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rO=[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]],Gu=Ae("lock",rO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nO=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],Sj=Ae("log-out",nO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oO=[["path",{d:"m22 7-8.991 5.727a2 2 0 0 1-2.009 0L2 7",key:"132q7q"}],["rect",{x:"2",y:"4",width:"20",height:"16",rx:"2",key:"izxlao"}]],ki=Ae("mail",oO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iO=[["path",{d:"M20 10c0 4.993-5.539 10.193-7.399 11.799a1 1 0 0 1-1.202 0C9.539 20.193 4 14.993 4 10a8 8 0 0 1 16 0",key:"1r0f0z"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]],Fc=Ae("map-pin",iO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lO=[["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 18h16",key:"19g7jn"}],["path",{d:"M4 6h16",key:"1o0s65"}]],cO=Ae("menu",lO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dO=[["path",{d:"M5 12h14",key:"1ays0h"}]],Ii=Ae("minus",dO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uO=[["path",{d:"M11 21.73a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16V8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73z",key:"1a0edw"}],["path",{d:"M12 22V12",key:"d0xqtd"}],["polyline",{points:"3.29 7 12 12 20.71 7",key:"ousv84"}],["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}]],Ka=Ae("package",uO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mO=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],hO=Ae("panel-left-close",mO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fO=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m14 9 3 3-3 3",key:"8010ee"}]],pO=Ae("panel-left-open",fO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gO=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],xO=Ae("pen",gO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yO=[["path",{d:"M13.832 16.568a1 1 0 0 0 1.213-.303l.355-.465A2 2 0 0 1 17 15h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2A18 18 0 0 1 2 4a2 2 0 0 1 2-2h3a2 2 0 0 1 2 2v3a2 2 0 0 1-.8 1.6l-.468.351a1 1 0 0 0-.292 1.233 14 14 0 0 0 6.392 6.384",key:"9njp5v"}]],Zu=Ae("phone",yO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bO=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],$s=Ae("plus",bO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vO=[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]],wO=Ae("printer",vO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jO=[["path",{d:"M4 2v20l2-1 2 1 2-1 2 1 2-1 2 1 2-1 2 1V2l-2 1-2-1-2 1-2-1-2 1-2-1-2 1Z",key:"q3az6g"}],["path",{d:"M16 8h-6a2 2 0 1 0 0 4h4a2 2 0 1 1 0 4H8",key:"1h4pet"}],["path",{d:"M12 17.5v-11",key:"1jc1ny"}]],_O=Ae("receipt",jO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NO=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],ma=Ae("refresh-cw",NO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SO=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],EO=Ae("rotate-ccw",SO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CO=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],oo=Ae("save",CO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TO=[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]],Xa=Ae("search",TO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kO=[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]],AO=Ae("send",kO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MO=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],io=Ae("settings",MO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RO=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],OO=Ae("share-2",RO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DO=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]],Ni=Ae("shield",DO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PO=[["path",{d:"M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z",key:"hou9p0"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M16 10a4 4 0 0 1-8 0",key:"1ltviw"}]],m0=Ae("shopping-bag",PO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zO=[["circle",{cx:"8",cy:"21",r:"1",key:"jimo8o"}],["circle",{cx:"19",cy:"21",r:"1",key:"13723u"}],["path",{d:"M2.05 2.05h2l2.66 12.42a2 2 0 0 0 2 1.58h9.78a2 2 0 0 0 1.95-1.57l1.65-7.43H5.12",key:"9zh506"}]],hn=Ae("shopping-cart",zO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $O=[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]],fn=Ae("smartphone",$O);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IO=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],lo=Ae("square-pen",IO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LO=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],h0=Ae("star",LO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UO=[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]],f0=Ae("tag",UO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BO=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]],e2=Ae("target",BO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VO=[["line",{x1:"10",x2:"14",y1:"2",y2:"2",key:"14vaq8"}],["line",{x1:"12",x2:"15",y1:"14",y2:"11",key:"17fdiu"}],["circle",{cx:"12",cy:"14",r:"8",key:"1e1u0o"}]],Ej=Ae("timer",VO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qO=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Yi=Ae("trash-2",qO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FO=[["path",{d:"M16 17h6v-6",key:"t6n2it"}],["path",{d:"m22 17-8.5-8.5-5 5L2 7",key:"x473p"}]],Wu=Ae("trending-down",FO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HO=[["path",{d:"M16 7h6v6",key:"box55l"}],["path",{d:"m22 7-8.5 8.5-5-5L2 17",key:"1t1m79"}]],Sa=Ae("trending-up",HO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GO=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],yt=Ae("triangle-alert",GO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZO=[["path",{d:"m16 11 2 2 4-4",key:"9rsbq5"}],["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],t2=Ae("user-check",ZO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const WO=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],Mu=Ae("user-plus",WO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const YO=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],Ks=Ae("user",YO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KO=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["path",{d:"M16 3.128a4 4 0 0 1 0 7.744",key:"16gr8j"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}]],Ns=Ae("users",KO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XO=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]],p0=Ae("wifi-off",XO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const QO=[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]],wg=Ae("wifi",QO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const JO=[["path",{d:"M8 22h8",key:"rmew8v"}],["path",{d:"M7 10h10",key:"1101jm"}],["path",{d:"M12 15v7",key:"t2xh3l"}],["path",{d:"M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5Z",key:"10ffi3"}]],Ac=Ae("wine",JO);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eD=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],nt=Ae("x",eD);/**
 * @license lucide-react v0.511.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tD=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],Tr=Ae("zap",tD),sD=({message:t="Carregando sessão...",showLogo:s=!0})=>e.jsxs("div",{className:"fixed inset-0 bg-gradient-to-br from-slate-900 via-blue-900 to-slate-900 flex items-center justify-center z-50",children:[e.jsx("div",{className:"absolute inset-0 opacity-10",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:`radial-gradient(circle at 25% 25%, rgba(59, 130, 246, 0.3) 0%, transparent 50%),
                           radial-gradient(circle at 75% 75%, rgba(139, 92, 246, 0.3) 0%, transparent 50%)`}})}),e.jsxs(be.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},transition:{duration:.5},className:"text-center relative z-10",children:[s&&e.jsxs(be.div,{initial:{y:-20,opacity:0},animate:{y:0,opacity:1},transition:{delay:.2},className:"mb-8",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-blue-500 to-purple-600 rounded-2xl flex items-center justify-center mx-auto mb-4 shadow-2xl",children:e.jsx(Ns,{className:"w-10 h-10 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"ClubManager Pro"}),e.jsx("p",{className:"text-blue-200",children:"Sistema de Gestão de Clubes"})]}),e.jsxs(be.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.4},className:"flex flex-col items-center space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(be.div,{animate:{rotate:360},transition:{duration:2,repeat:1/0,ease:"linear"},className:"w-12 h-12 border-4 border-blue-500/30 border-t-blue-500 rounded-full"}),e.jsx(be.div,{animate:{rotate:-360},transition:{duration:1.5,repeat:1/0,ease:"linear"},className:"absolute inset-2 w-8 h-8 border-2 border-purple-500/30 border-b-purple-500 rounded-full"})]}),e.jsx(be.p,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:.6},className:"text-white font-medium text-lg",children:t}),e.jsx(be.div,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.8},className:"flex space-x-1",children:[0,1,2].map(a=>e.jsx(be.div,{animate:{scale:[1,1.2,1],opacity:[.5,1,.5]},transition:{duration:1.5,repeat:1/0,delay:a*.2},className:"w-2 h-2 bg-blue-400 rounded-full"},a))})]}),e.jsx(be.div,{initial:{width:0},animate:{width:"100%"},transition:{duration:3,ease:"easeInOut"},className:"mt-8 h-1 bg-gradient-to-r from-blue-500 to-purple-500 rounded-full mx-auto max-w-xs"}),e.jsx(be.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"text-blue-200 text-sm mt-4 max-w-md",children:"Verificando credenciais e carregando configurações..."})]})]}),Cj={"admin@aabb.com":{password:"admin123",user:{id:"mock-admin-id",email:"admin@aabb.com",name:"Administrador",role:"admin",department:"Administração",avatar:"https://api.dicebear.com/8.x/initials/svg?seed=Admin"}},"gerente@aabb.com":{password:"gerente123",user:{id:"mock-manager-id",email:"gerente@aabb.com",name:"Gerente",role:"manager",department:"Operações",avatar:"https://api.dicebear.com/8.x/initials/svg?seed=Gerente"}},"funcionario@aabb.com":{password:"func123",user:{id:"mock-employee-id",email:"funcionario@aabb.com",name:"Funcionário",role:"employee",department:"Bar",avatar:"https://api.dicebear.com/8.x/initials/svg?seed=Funcionario"}},"demo@clubmanager.com":{password:"demo123",user:{id:"mock-demo-id",email:"demo@clubmanager.com",name:"Usuário Demo",role:"admin",department:"Demo",avatar:"https://api.dicebear.com/8.x/initials/svg?seed=Demo"}}},Gn=class Gn{constructor(){dt(this,"currentUser",null);dt(this,"sessionKey","mock-auth-session");this.restoreSession()}static getInstance(){return Gn.instance||(Gn.instance=new Gn),Gn.instance}async signInWithPassword(s,a){await new Promise(o=>setTimeout(o,500));const r=Cj[s.toLowerCase()];return!r||r.password!==a?{user:null,session:null,error:{message:"Credenciais inválidas"}}:(this.currentUser=r.user,this.saveSession(),console.log("🎭 Login mock realizado com sucesso:",r.user.name),{user:r.user,session:{access_token:"mock-access-token",refresh_token:"mock-refresh-token",user:r.user},error:null})}async signOut(){return this.currentUser=null,this.clearSession(),console.log("🎭 Logout mock realizado"),{error:null}}getCurrentUser(){return this.currentUser}getSession(){return this.currentUser?{data:{session:{access_token:"mock-access-token",refresh_token:"mock-refresh-token",user:this.currentUser}}}:{data:{session:null}}}onAuthStateChange(s){return setTimeout(()=>{this.currentUser?s("SIGNED_IN",{access_token:"mock-access-token",user:this.currentUser}):s("SIGNED_OUT",null)},100),{data:{subscription:{unsubscribe:()=>console.log("🎭 Mock auth listener removido")}}}}getAvailableUsers(){return Object.entries(Cj).map(([s,a])=>({email:s,password:a.password,name:a.user.name,role:a.user.role}))}saveSession(){this.currentUser&&localStorage.setItem(this.sessionKey,JSON.stringify(this.currentUser))}restoreSession(){var s;try{const a=localStorage.getItem(this.sessionKey);a&&(this.currentUser=JSON.parse(a),console.log("🎭 Sessão mock restaurada:",(s=this.currentUser)==null?void 0:s.name))}catch(a){console.warn("Erro ao restaurar sessão mock:",a),this.clearSession()}}clearSession(){localStorage.removeItem(this.sessionKey)}};dt(Gn,"instance");let g0=Gn;const x0=g0.getInstance(),s2=y.createContext(void 0),jt=()=>{const t=y.useContext(s2);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},aD=({children:t})=>{const[s,a]=y.useState(null),[r,o]=y.useState(!0),[l,c]=y.useState(!1),[u,h]=y.useState(null),f=async()=>{if(!u)return c(!1),!0;try{const w=await fetch("https://www.google.com/favicon.ico",{method:"HEAD",mode:"no-cors",cache:"no-cache"});return c(!1),!0}catch{return c(!0),!1}};y.useEffect(()=>{(async()=>{console.log("🚀 Inicializando autenticação simples...");const E=setTimeout(()=>{console.log("⏰ Safety timeout - forçando carregamento"),o(!1)},2e3);try{const k=await Eu();if(h(k),!k){console.log("🔧 Modo demo ativo - Supabase não configurado"),clearTimeout(E),o(!1);return}await B.auth.signOut(),console.log("✅ Sessão limpa, pronto para login"),clearTimeout(E),o(!1)}catch(k){console.log("⚠️ Erro na inicialização, continuando...",k),clearTimeout(E),o(!1)}})()},[]);const p=async(w,E)=>{var C,S;if(!await Eu()){console.log("🎭 Usando sistema de autenticação mock");try{const{user:T,error:M}=await x0.signInWithPassword(w,E);if(M)return{success:!1,error:M.message};if(T){const $={id:T.id,name:T.name,email:T.email,role:T.role,department:T.department,avatar:T.avatar};return a($),{success:!0,error:null}}}catch{return{success:!1,error:"Erro no sistema de autenticação mock"}}}try{const{data:T,error:M}=await B.auth.signInWithPassword({email:w,password:E});if(M)return{success:!1,error:M.message};if(T.user)try{const{data:$,error:A}=await B.from("profiles").select("*").eq("id",T.user.id).single();if(A){console.warn("Erro ao buscar perfil:",A);const z={id:T.user.id,name:((C=T.user.email)==null?void 0:C.split("@")[0])||"Usuário",email:T.user.email,role:"employee",avatar:`https://api.dicebear.com/8.x/initials/svg?seed=${T.user.email}`};a(z)}else if($){const z={id:$.id,name:$.name||T.user.email||"Usuário",email:T.user.email,role:$.role||"employee",avatar:$.avatar_url||`https://api.dicebear.com/8.x/initials/svg?seed=${$.name}`};a(z)}}catch($){console.error("Erro ao buscar perfil:",$);const A={id:T.user.id,name:((S=T.user.email)==null?void 0:S.split("@")[0])||"Usuário",email:T.user.email,role:"employee",avatar:`https://api.dicebear.com/8.x/initials/svg?seed=${T.user.email}`};a(A)}return{success:!0,error:null}}catch{return{success:!1,error:"Erro de conexão"}}},g=async(w,E,k)=>{if(!u)return{success:!1,error:"Registro não disponível no modo demo"};try{console.log("🔐 Registrando usuário:",E);const{data:N,error:C}=await B.auth.signUp({email:E,password:k,options:{data:{name:w,role:"admin"}}});if(C)return console.error("Erro no signup:",C),{success:!1,error:C.message};if(N.user){console.log("✅ Usuário registrado com sucesso"),await new Promise(S=>setTimeout(S,1e3));try{console.log("🔄 Iniciando criação da empresa..."),await v(N.user.id,w,E),console.log("✅ Empresa criada com sucesso")}catch(S){console.error("❌ Erro ao criar empresa:",S),console.error("Stack trace:",S),alert(`Usuário criado, mas houve erro ao criar empresa: ${S.message||S}`)}return{success:!0,error:null}}return{success:!1,error:"Erro desconhecido no registro"}}catch(N){return console.error("Erro no registro:",N),{success:!1,error:"Erro de conexão"}}},v=async(w,E,k)=>{try{console.log("🏢 Criando empresa para o usuário...",{userId:w,userName:E,userEmail:k});const N=Date.now(),C=String(N).slice(-14).padStart(14,"0");console.log("📋 CNPJ gerado:",C),console.log("🏭 Inserindo empresa na tabela...");const{data:S,error:T}=await B.from("empresas").insert([{nome:`Empresa de ${E}`,cnpj:C,email_admin:k,telefone:"",plano:"premium",status:"ativo"}]).select().single();if(T)throw console.error("❌ Erro ao criar empresa:",T),new Error(`Erro ao criar empresa: ${T.message}`);console.log("✅ Empresa criada:",S),console.log("👤 Criando registro na tabela usuarios_empresa...");const{data:M,error:$}=await B.from("usuarios_empresa").insert([{user_id:w,empresa_id:S.id,nome_completo:E,email:k,tipo_usuario:"administrador",papel:"SUPER_ADMIN",is_primeiro_usuario:!0,ativo:!0,tem_acesso_sistema:!0}]).select().single();if($)throw console.error("❌ Erro ao criar usuário empresa:",$),new Error(`Erro ao criar usuário empresa: ${$.message}`);console.log("✅ Usuário empresa criado:",M),console.log("🔐 Criando permissões básicas...");const A=[{modulo:"dashboard",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0}},{modulo:"configuracoes",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0}}],{error:z}=await B.from("permissoes_usuario").insert(A.map(R=>({usuario_empresa_id:M.id,modulo:R.modulo,permissoes:R.permissoes})));z?console.error("⚠️ Erro ao criar permissões:",z):console.log("✅ Permissões criadas com sucesso"),console.log("✅ Empresa e dados complementares criados com sucesso!")}catch(N){throw console.error("Erro ao criar empresa:",N),N}},b=async()=>{const w={id:"demo-user-id",name:iu.DEMO_USER.name,email:iu.DEMO_USER.email,role:iu.DEMO_USER.role,avatar:"https://api.dicebear.com/8.x/initials/svg?seed=Demo"};return a(w),{success:!0,error:null}},_=async()=>{!await Eu()?(console.log("🎭 Logout do sistema mock"),await x0.signOut()):await B.auth.signOut(),a(null)};return e.jsxs(s2.Provider,{value:{user:s,login:p,register:g,loginAsDemo:b,logout:_,isLoading:r,isOffline:l,checkOnlineStatus:f},children:[u===!1&&e.jsxs("div",{className:"fixed top-0 left-0 right-0 bg-yellow-500 text-black px-4 py-2 text-sm z-50",children:["⚠️ ",e.jsx("strong",{children:"Modo Desenvolvimento:"})," Supabase não configurado. Use: ",iu.DEMO_USER.email," / demo123456"]}),r?e.jsx(sD,{message:"Inicializando sistema..."}):t]})},a2=y.createContext(void 0),r2=()=>{const t=y.useContext(a2);if(t===void 0)throw new Error("useMultitenantAuth must be used within a MultitenantAuthProvider");return t},rD=({children:t})=>{const[s,a]=y.useState(null),[r,o]=y.useState(null),[l,c]=y.useState({}),[u,h]=y.useState(!1),[f,p]=y.useState(!1),g=async(k,N)=>(console.log("🔧 Modo simplificado - login mock"),{success:!1,error:"Use o login principal"}),v=async k=>{console.log("🔧 Modo simplificado - registrarEmpresa redirecionando para serviço principal");const{RegistroEmpresaService:N}=await ha(async()=>{const{RegistroEmpresaService:S}=await import("./registroEmpresaService-BP_bVxI0.js");return{RegistroEmpresaService:S}},[]),C=await N.registrarEmpresa(k);return C.success&&C.empresa&&C.usuario?{success:!0,data:{empresa:C.empresa,usuario:C.usuario}}:{success:!1,error:C.error||"Erro desconhecido no registro"}},b=async()=>{a(null),o(null),c({}),p(!1)},_=(k,N)=>!0,w=k=>({modulo:k,pode_ler:!0,pode_criar:!0,pode_editar:!0,pode_excluir:!0,pode_gerenciar:!0}),E=async()=>{console.log("🔧 Modo simplificado - refreshUserData mock")};return e.jsx(a2.Provider,{value:{user:s,empresa:r,permissoes:l,isLoading:u,isAuthenticated:f,login:g,registrarEmpresa:v,logout:b,hasPermission:_,getModulePermissions:w,refreshUserData:E},children:t})},Mc=async()=>{try{const{data:{session:t}}=await B.auth.getSession();return t!=null&&t.user?(console.log("✅ User already authenticated:",t.user.email),{success:!0,user:t.user}):(console.log("⚠️ No active session found. Using admin client for database operations."),{success:!0,user:null,useAdmin:!0})}catch(t){return console.error("❌ Authentication error:",t),{success:!1,error:"Authentication failed"}}},vt=async()=>{var t,s,a,r,o,l,c,u;try{const{data:{session:h}}=await B.auth.getSession();if(!(h!=null&&h.user))return console.warn("⚠️ No authenticated user found"),null;const f=h.user.id,p=h.user.email;console.log(`🔍 Buscando empresa_id para usuário: ${p} (${f})`);const{data:g,error:v}=await B.from("usuarios_empresa").select("empresa_id, nome_completo, cargo").eq("user_id",f).eq("ativo",!0).limit(1);if(v)console.error("❌ Error getting empresa_id from usuarios_empresa:",v.message);else if(g&&g.length>0){const k=(t=g[0])==null?void 0:t.empresa_id;return console.log(`✅ Empresa ID encontrado em usuarios_empresa: ${k}`),console.log(`👤 Dados do usuário: ${(s=g[0])==null?void 0:s.nome_completo} - ${(a=g[0])==null?void 0:a.cargo}`),k||null}console.warn("⚠️ Usuário não encontrado em usuarios_empresa, tentando via email_admin");const{data:b,error:_}=await B.from("empresas").select("id, nome").eq("email_admin",p).eq("status","ativo").limit(1);if(_)console.error("❌ Error getting empresa by email:",_.message);else if(b&&b.length>0){const k=(r=b[0])==null?void 0:r.id,N=(o=b[0])==null?void 0:o.nome;console.log(`✅ Empresa encontrada via email_admin: ${k} (${N})`);try{await B.from("usuarios_empresa").insert({user_id:f,empresa_id:k,nome_completo:((l=h.user.user_metadata)==null?void 0:l.name)||(p==null?void 0:p.split("@")[0])||"Usuário",email:p,tipo_usuario:"administrador",cargo:"Administrador",status:"ativo",ativo:!0,tem_acesso_sistema:!0}),console.log(`✅ Registro criado em usuarios_empresa para ${p}`)}catch(C){console.warn("⚠️ Não foi possível criar registro em usuarios_empresa:",C)}return k}console.warn("⚠️ FALLBACK DE EMERGÊNCIA: Buscando primeira empresa ativa"),console.warn(`⚠️ USUÁRIO SEM EMPRESA: ${p} não está associado a nenhuma empresa`);const{data:w,error:E}=await B.from("empresas").select("id, nome").eq("status","ativo").order("created_at",{ascending:!0}).limit(1);if(E)return console.error("❌ Error getting first empresa:",E.message),null;if(w&&w.length>0){const k=(c=w[0])==null?void 0:c.id,N=(u=w[0])==null?void 0:u.nome;return console.warn(`⚠️ USANDO FALLBACK DE EMERGÊNCIA: ${k} (${N})`),console.warn(`⚠️ AÇÃO REQUERIDA: Associar usuário ${p} à empresa correta`),k}return console.error("❌ ERRO CRÍTICO: Nenhuma empresa encontrada no sistema"),null}catch(h){return console.error("❌ Error in getCurrentUserEmpresaId:",h),null}},mu=t=>({id:t.id,name:t.name,categoryId:t.category_id||void 0,currentStock:t.current_stock,minStock:t.min_stock,unit:t.unit,lastUpdated:new Date(t.last_updated||t.created_at),supplier:t.supplier||void 0,cost:t.cost||0,availableForSale:t.available_for_sale||!1,image_url:t.image_url||void 0,salePrice:t.sale_price||void 0,marginPercentage:t.margin_percentage||void 0,pricingMethod:t.pricing_method||"margin"}),nD=t=>({id:t.id,name:t.name,description:t.description||void 0,color:t.color||"#6B7280",icon:t.icon||void 0,isActive:t.is_active||!0,createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at||t.created_at)}),bp=t=>({id:t.id,name:t.name,email:t.email,phone:t.phone||"",avatar:t.avatar_url||`https://api.dicebear.com/8.x/initials/svg?seed=${t.name}`,status:t.status,joinDate:new Date(t.join_date),membershipType:t.membership_type||"basic"}),vp=t=>{const s=t.item_type==="direct",a=t.inventory_items;return{id:t.id,name:s&&(a!=null&&a.name)?a.name:t.name,description:t.description||"",price:t.price,category:t.category,image_url:s&&(a!=null&&a.image_url)?a.image_url:t.image_url||void 0,available:t.available,preparation_time:t.preparation_time||void 0,item_type:t.item_type||"prepared",direct_inventory_item_id:t.direct_inventory_item_id||void 0,costPerServing:t.cost_per_serving||void 0,marginPercentage:t.margin_percentage||void 0,pricingMethod:t.pricing_method||"margin"}},Tj=t=>({id:t.id,tableNumber:t.table_number||void 0,items:t.order_items.map(s=>({id:s.id.toString(),menuItemId:s.menu_item_id,quantity:s.quantity,price:s.price,notes:s.notes||void 0})),status:t.status,total:t.total,createdAt:new Date(t.created_at),updatedAt:new Date(t.updated_at||t.created_at),employeeId:t.employee_id||"",notes:t.notes||void 0}),n2=y.createContext(void 0),Tt=()=>{const t=y.useContext(n2);if(t===void 0)throw new Error("useApp must be used within an AppProvider");return t},oD=({children:t})=>{console.log("🎯🎯🎯 AppProvider MONTADO 🎯🎯🎯");const{user:s}=jt(),[a,r]=y.useState([]),[o,l]=y.useState([]),[c,u]=y.useState([]),[h,f]=y.useState([]),[p,g]=y.useState([]),[v,b]=y.useState([]);y.useEffect(()=>{(async()=>{var Z;if(!s){console.log("AppContext: Usuário não autenticado, não carregando dados");return}try{const{data:re,error:oe}=await B.from("usuarios_empresa").select("empresa_id").eq("user_id",s.id).eq("ativo",!0).single();if(oe||!re){console.error("AppContext: Erro ao buscar empresa do usuário:",oe);return}const ae=re.empresa_id;console.log("AppContext: Carregando dados para empresa:",ae);const pe=await B.rpc("get_low_stock_items",{limit_count:10}),P=await B.from("inventory_categories").select("*").eq("empresa_id",ae).eq("is_active",!0).order("name");console.log("AppContext: Categorias carregadas:",((Z=P.data)==null?void 0:Z.length)||0),pe.data&&u(pe.data.map(mu)),P.data&&f(P.data.map(nD))}catch(re){console.error("AppContext: Erro ao carregar dados:",re)}})()},[s]),y.useEffect(()=>{const F=async oe=>{var P,q;const{data:ae,error:pe}=await B.from("orders").select("*, order_items(*)").order("created_at",{ascending:!1});if(pe)console.error("Error fetching orders after realtime event:",pe);else if(ae){const Q=ae.map(Tj);l(Q),oe.eventType!=="INSERT"&&A(`Pedido #${(q=(P=oe.new)==null?void 0:P.id)==null?void 0:q.slice(0,4)} atualizado para ${oe.new.status}`)}},Z=B.channel("realtime-orders").on("postgres_changes",{event:"*",schema:"public",table:"orders"},F).subscribe();return(async()=>{const{data:oe,error:ae}=await B.from("orders").select("*, order_items(*)").order("created_at",{ascending:!1});ae?console.error("Error fetching initial orders:",ae):oe&&l(oe.map(Tj))})(),()=>{B.removeChannel(Z)}},[]);const _=async F=>{console.log("=== addMenuItem INICIADO ==="),console.log("Dados recebidos:",F);const Z=await vt();if(!Z)throw new Error("Não foi possível identificar a empresa do usuário");const re={name:F.name,description:F.description||null,price:F.price,category:F.category,available:F.available,preparation_time:F.preparation_time||null,item_type:F.item_type||"prepared",direct_inventory_item_id:F.direct_inventory_item_id||null,image_url:F.image_url||null,empresa_id:Z};console.log("Dados formatados para Supabase:",re);const{data:oe,error:ae}=await B.from("menu_items").insert(re).select().single();if(console.log("Resposta do Supabase:"),console.log("- Data:",oe),console.log("- Error:",ae),ae)throw console.error("=== ERRO NO SUPABASE ==="),console.error("Código do erro:",ae.code),console.error("Mensagem do erro:",ae.message),console.error("Detalhes do erro:",ae.details),console.error("Hint do erro:",ae.hint),ae;oe&&(console.log("Item inserido com sucesso, atualizando estado..."),r(pe=>[vp(oe),...pe].sort((P,q)=>P.name.localeCompare(q.name))),A(`Novo prato "${oe.name}" adicionado ao cardápio!`),console.log("Estado atualizado com sucesso!")),console.log("=== addMenuItem FINALIZADO ===")},w=async F=>{const Z={name:F.name,description:F.description,price:F.price,category:F.category,available:F.available,preparation_time:F.preparation_time,item_type:F.item_type||"prepared",direct_inventory_item_id:F.direct_inventory_item_id||null,image_url:F.image_url||null},{data:re,error:oe}=await B.from("menu_items").update(Z).eq("id",F.id).select().single();if(oe){console.error(oe);return}re&&(r(ae=>ae.map(pe=>pe.id===re.id?vp(re):pe).sort((pe,P)=>pe.name.localeCompare(P.name))),A(`Prato "${re.name}" atualizado!`))},E=async F=>{const{error:Z}=await B.from("menu_items").delete().eq("id",F);if(Z){console.error(Z);return}r(re=>re.filter(oe=>oe.id!==F)),A("Prato removido do cardápio!")},k=async F=>{const{items:Z,tableNumber:re,employeeId:oe,notes:ae,status:pe}=F,P=Z.reduce((je,Re)=>je+Re.price*Re.quantity,0),q={table_number:re,employee_id:oe,notes:ae,status:pe,total:P},{data:Q,error:G}=await B.from("orders").insert(q).select().single();if(G||!Q){console.error("Error creating order:",G);return}const me=Z.map(je=>({order_id:Q.id,menu_item_id:je.menuItemId,quantity:je.quantity,price:je.price,notes:je.notes})),{error:Ne}=await B.from("order_items").insert(me);Ne?console.error("Error creating order items:",Ne):A(`Novo pedido #${Q.id.slice(0,4)} criado!`)},N=async(F,Z)=>{try{if(console.log("🔄 updateOrderStatus chamado:",{orderId:F,status:Z}),F.startsWith("comanda-")){console.log("🍽️ Processando comanda com CommandManager");try{const{CommandManager:re}=await ha(async()=>{const{CommandManager:P}=await import("./command-manager-QsR6bND0.js");return{CommandManager:P}},[]),oe=re.getInstance(),ae=F.replace("comanda-","").split("-").slice(0,5).join("-");console.log("📋 Buscando comanda:",ae);let pe=await oe.buscarComanda(ae);if(pe||(console.log("⚠️ Comanda não encontrada, criando uma de teste"),pe=await oe.criarComanda({funcionario_id:"user-demo",quantidade_pessoas:1,observacoes:`Comanda de teste para ${F}`}),await oe.adicionarItem(pe.id,{produto_id:"prod-001",nome_produto:"Hambúrguer Teste",quantidade:1,preco_unitario:25.9,observacoes:"Item de teste"}),pe=await oe.buscarComanda(pe.id)),pe!=null&&pe.itens){const P=pe.itens.filter(q=>q.status==="pendente"||q.status==="preparando");console.log(`🔄 Atualizando ${P.length} itens da comanda`);for(const q of P){let Q;switch(Z){case"pending":Q="pendente";break;case"preparing":Q="preparando";break;case"ready":Q="pronto";break;case"delivered":Q="entregue";break;default:Q=Z}await oe.atualizarStatusItem(pe.id,q.id,Q)}console.log("✅ Itens da comanda atualizados com sucesso!")}console.log("🔄 Atualizando também no Supabase para refletir na interface...");try{const{data:P,error:q}=await B.from("comanda_items").select("*").eq("comanda_id",ae).in("status",["pending","preparing","ready"]);if(q)console.warn("⚠️ Erro ao buscar itens no Supabase:",q);else if(P&&P.length>0){const{error:Q}=await B.from("comanda_items").update({status:Z}).eq("comanda_id",ae).in("status",["pending","preparing","ready"]);Q?console.warn("⚠️ Erro ao atualizar no Supabase:",Q):console.log("✅ Supabase também atualizado!")}else console.log("ℹ️ Nenhum item encontrado no Supabase para atualizar")}catch(P){console.warn("⚠️ Erro na sincronização com Supabase:",P)}console.log("🔄 Atualizando estado local para feedback imediato..."),l(P=>P.map(q=>q.id===F?{...q,status:Z,updatedAt:new Date}:q)),console.log("🔄 Recarregando pedidos do servidor..."),await we(),await ee(),console.log("✅ Processo completo finalizado!");return}catch(re){console.error("❌ Erro no CommandManager:",re),console.log("🔄 Continuando com lógica original...")}}if(F.startsWith("balcao-")){const re=F.replace("balcao-","");console.log("Atualizando pedido de balcão:",re);let oe;switch(Z){case"pending":oe="paid";break;case"preparing":oe="preparing";break;case"ready":oe="ready";break;default:oe=Z}const{error:ae}=await B.from("balcao_orders").update({status:oe,preparation_started_at:Z==="preparing"?new Date().toISOString():void 0,preparation_completed_at:Z==="ready"?new Date().toISOString():void 0}).eq("id",re);if(ae)throw ae;console.log("Pedido de balcão atualizado com sucesso")}else{console.log("🔄 Processando comanda com CommandManager");const{CommandManager:re}=await ha(async()=>{const{CommandManager:q}=await import("./command-manager-QsR6bND0.js");return{CommandManager:q}},[]),oe=re.getInstance();let ae,pe;if(F.startsWith("comanda-")){const q=F.replace("comanda-",""),Q=q.match(/^([0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12})-(.+)$/i);Q?(ae=Q[1],pe=Q[2]):(ae=q,pe="")}else{const q=F.split("-");ae=q.slice(0,5).join("-"),pe=q.slice(5).join("-")}if(console.log("Decomposição do ID:",{orderId:F,realComandaId:ae,timeKey:pe}),!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(ae))throw console.error("ID da comanda inválido:",ae),new Error(`ID da comanda inválido: ${ae}`);if(pe){const q=pe.split("-");console.log("Partes do timeKey:",q);const[Q,G,me,Ne,je]=q.map(Number);if(console.log("Valores parseados:",{year:Q,month:G,day:me,hour:Ne,minute:je}),isNaN(Q)||isNaN(G)||isNaN(me)||isNaN(Ne)||isNaN(je))throw console.error("❌ Valores de data inválidos:",{year:Q,month:G,day:me,hour:Ne,minute:je}),new Error(`Valores de data inválidos no timeKey: ${pe}`);const{data:Re,error:Ie}=await B.from("comanda_items").select("*").eq("comanda_id",ae).in("status",["pending","preparing","ready"]);if(Ie)throw console.error("Erro na busca dos itens da comanda:",Ie),Ie;const Ve=(Re==null?void 0:Re.filter(De=>{const Ue=new Date(De.added_at),W=`${Ue.getFullYear()}-${Ue.getMonth()}-${Ue.getDate()}-${Ue.getHours()}-${Ue.getMinutes()}`;return pe===W}))||[];if(console.log("Itens encontrados para atualizar:",Ve.length),Ve.length>0){const De=Ve.map(W=>W.id);console.log("Atualizando itens:",De,"para status:",Z);const{error:Ue}=await B.from("comanda_items").update({status:Z}).in("id",De);if(Ue)throw Ue;console.log("Atualização realizada com sucesso")}else console.log("Nenhum item encontrado para atualizar")}else{const{data:q,error:Q}=await B.from("comanda_items").select("*").eq("comanda_id",ae).in("status",["pending","preparing","ready"]).order("added_at",{ascending:!1});if(Q)throw console.error("Erro na busca dos itens da comanda:",Q),Q;if(q&&q.length>0){const G=q.map(Ne=>Ne.id);console.log("Atualizando todos os itens pendentes:",G,"para status:",Z);const{error:me}=await B.from("comanda_items").update({status:Z}).in("id",G);if(me)throw me;console.log("Atualização realizada com sucesso")}else console.log("Nenhum item encontrado para atualizar")}}await we(),await ee()}catch(re){console.error("Erro ao atualizar status do pedido:",re)}},C=async F=>{var G,me;if(console.log("📦 Adicionando item ao inventário:",F),!s){console.error("❌ Usuário não autenticado"),alert("Você precisa estar logado para adicionar itens");return}const{data:Z,error:re}=await B.from("usuarios_empresa").select("empresa_id").eq("user_id",s.id).eq("ativo",!0).single();if(re||!Z){console.error("❌ Erro ao buscar empresa do usuário:",re),alert("Erro: Não foi possível identificar sua empresa. Entre em contato com o suporte.");return}const oe=Z.empresa_id;if(console.log("🏢 Usando empresa do usuário logado:",oe),!F.name||!F.unit){console.error("❌ Dados obrigatórios faltando:",{name:F.name,unit:F.unit}),alert("Nome e unidade são obrigatórios!");return}const ae={name:F.name.trim(),category_id:F.categoryId||null,current_stock:Number(F.currentStock)||0,min_stock:Number(F.minStock)||0,unit:F.unit.trim(),cost:F.cost?Number(F.cost):null,supplier:((G=F.supplier)==null?void 0:G.trim())||null,available_for_sale:!!F.availableForSale,image_url:((me=F.image_url)==null?void 0:me.trim())||null,empresa_id:oe,sale_price:F.salePrice?Number(F.salePrice):null,margin_percentage:F.marginPercentage?Number(F.marginPercentage):null,pricing_method:F.pricingMethod||"margin"};console.log("📤 Dados para inserir (validados):",ae),console.log("🔍 Verificando se item já existe...");const{data:pe,error:P}=await B.from("inventory_items").select("id, name").eq("name",ae.name).eq("empresa_id",oe);if(P){console.error("❌ Erro ao verificar item existente:",P),alert("Erro ao verificar se o item já existe: "+P.message);return}if(pe&&pe.length>0){console.warn("⚠️ Item já existe:",pe[0]),alert("Já existe um item com este nome no inventário!");return}console.log("✅ Nome disponível, prosseguindo com inserção..."),console.log("🔄 Inserindo item...");const{data:q,error:Q}=await B.from("inventory_items").insert(ae).select().single();if(console.log("📝 Resultado da inserção:",{data:q,error:Q}),Q){console.error("❌ Erro ao inserir item:",Q),console.error("❌ Detalhes completos do erro:",{code:Q.code,message:Q.message,details:Q.details,hint:Q.hint,statusCode:Q.statusCode,statusText:Q.statusText}),alert("Erro ao salvar produto: "+Q.message+" (Código: "+Q.code+")");return}q&&(console.log("✅ Item inserido com sucesso!"),u(Ne=>[mu(q),...Ne].sort((je,Re)=>je.name.localeCompare(Re.name))))},S=async F=>{if(console.log("🔄 Atualizando item do inventário:",F),!s){console.error("❌ Usuário não autenticado"),alert("Você precisa estar logado para atualizar itens");return}const{data:Z,error:re}=await B.from("usuarios_empresa").select("empresa_id").eq("user_id",s.id).eq("ativo",!0).single();if(re||!Z){console.error("❌ Erro ao buscar empresa do usuário:",re),alert("Erro: Não foi possível identificar sua empresa. Entre em contato com o suporte.");return}const oe=Z.empresa_id,{data:ae}=await B.from("inventory_items").select("current_stock, cost").eq("id",F.id).single(),pe=(ae==null?void 0:ae.current_stock)||0,P=F.currentStock,q=P-pe;console.log("📊 Análise da atualização:",{estoqueAnterior:pe,estoqueNovo:P,diferencaEstoque:q,formula:`${P} - ${pe} = ${q}`});const Q={name:F.name,category_id:F.categoryId,min_stock:F.minStock,unit:F.unit,cost:F.cost,supplier:F.supplier,available_for_sale:F.availableForSale||!1,image_url:F.image_url||null,last_updated:new Date().toISOString(),empresa_id:oe,sale_price:F.salePrice?Number(F.salePrice):null,margin_percentage:F.marginPercentage?Number(F.marginPercentage):null,pricing_method:F.pricingMethod||"margin"};console.log("📤 Dados para atualizar:",Q);const{data:G,error:me}=await B.from("inventory_items").update(Q).eq("id",F.id).select().single();if(console.log("📝 Resultado da atualização:",{data:G,error:me}),me){console.error("❌ Erro ao atualizar item:",me),alert("Erro ao atualizar produto: "+me.message);return}if(G){if(console.log("✅ Item atualizado com sucesso!"),q!==0){console.log("📊 Registrando movimentação:",{diferenca:q,anterior:pe,novo:P,tipo:q>0?"entrada":"saída"});const Ne=q>0?"entrada_ajuste":"saida_ajuste",je=Math.abs(q),Re=ae==null?void 0:ae.cost,Ie=F.cost;let Ve="Ajuste manual de estoque via edição de item";Re&&Ie&&Re!==Ie&&(Ve+=` | Custo alterado: R$ ${Number(Re).toFixed(2)} → R$ ${Number(Ie).toFixed(2)}`),console.log("📝 Processando como ajuste normal");try{const{error:De}=await B.rpc("register_inventory_movement",{p_inventory_item_id:F.id,p_movement_type:Ne,p_quantity:je,p_unit_cost:F.cost||null,p_notes:Ve,p_reference_document:null,p_created_by:s.id});De?console.error("❌ Erro ao registrar movimentação:",De):console.log("✅ Movimentação registrada com sucesso!")}catch(De){console.error("❌ Erro ao registrar movimentação:",De)}}u(Ne=>Ne.map(je=>je.id===G.id?mu(G):je).sort((je,Re)=>je.name.localeCompare(Re.name))),G.available_for_sale&&(console.log("🔄 Recarregando menu items devido à atualização de precificação..."),await R(!0))}},T=async F=>{const{error:Z}=await B.from("inventory_items").delete().eq("id",F);if(Z){console.error(Z);return}u(re=>re.filter(oe=>oe.id!==F))},M=async F=>{const Z={name:F.name,email:F.email,phone:F.phone,avatar_url:F.avatar,status:F.status,membership_type:F.membershipType},{data:re,error:oe}=await B.from("members").insert(Z).select().single();if(oe){console.error(oe);return}re&&g(ae=>[bp(re),...ae].sort((pe,P)=>pe.name.localeCompare(P.name)))},$=async F=>{const Z={name:F.name,email:F.email,phone:F.phone,avatar_url:F.avatar,status:F.status,membership_type:F.membershipType},{data:re,error:oe}=await B.from("members").update(Z).eq("id",F.id).select().single();if(oe){console.error(oe);return}re&&g(ae=>ae.map(pe=>pe.id===re.id?bp(re):pe).sort((pe,P)=>pe.name.localeCompare(P.name)))},A=F=>{b(Z=>[F,...Z].slice(0,10))},z=()=>b([]),R=y.useCallback(async(F=!1)=>{if(console.log("📋 Carregando menu items...",F?"(FORÇADO)":""),!s){console.log("⚠️ Usuário não autenticado, não carregando menu");return}const{data:Z,error:re}=await B.from("usuarios_empresa").select("empresa_id").eq("user_id",s.id).eq("status","ativo").single();if(re||!Z){console.error("❌ Erro ao buscar empresa do usuário:",re);return}const oe=Z.empresa_id;console.log("🏢 Carregando menu items para empresa_id:",oe);const{data:ae,error:pe}=await B.from("menu_items").select(`
      *,
      inventory_items!left(name, image_url, current_stock, available_for_sale)
    `).eq("empresa_id",oe).eq("available",!0).order("category").order("name");if(pe){console.error("Erro ao carregar menu items:",pe);return}console.log("📋 Menu items carregados:",(ae==null?void 0:ae.length)||0),ae&&(r(ae.map(vp)),console.log("💰 Preços atualizados dos menu items:",ae.map(P=>({name:P.name,price:P.price}))))},[s]),L=async()=>{if(p.length>0)return;const{data:F,error:Z}=await B.from("members").select("*").order("name");if(Z){console.error("Erro ao carregar members:",Z);return}F&&g(F.map(bp))},I=y.useCallback(async()=>{if(console.log("📦 Carregando inventário completo..."),!s){console.log("⚠️ Usuário não autenticado, não carregando inventário");return}const{data:F,error:Z}=await B.from("usuarios_empresa").select("empresa_id").eq("user_id",s.id).eq("ativo",!0).single();if(Z||!F){console.error("❌ Erro ao buscar empresa do usuário:",Z);return}const re=F.empresa_id;console.log("🏢 Carregando inventário para empresa do usuário:",re);const{data:oe,error:ae}=await B.from("inventory_items").select("*").eq("empresa_id",re).order("name");if(ae){console.error("❌ Erro ao carregar inventory completo:",ae);return}console.log("✅ Inventário carregado:",(oe==null?void 0:oe.length)||0,"itens"),oe&&u(oe.map(mu))},[s]),X=y.useCallback(async()=>{if(console.log("🔄 Sincronizando produtos do inventário com o menu..."),!s){console.log("⚠️ Usuário não autenticado, não sincronizando");return}try{const{data:F,error:Z}=await B.from("usuarios_empresa").select("empresa_id").eq("user_id",s.id).eq("ativo",!0).single();if(Z||!F){console.error("❌ Erro ao buscar empresa do usuário:",Z);return}const re=F.empresa_id,{data:oe,error:ae}=await B.from("inventory_items").select("*").eq("empresa_id",re).eq("available_for_sale",!0);if(ae){console.error("❌ Erro ao buscar produtos do inventário:",ae);return}if(!oe||oe.length===0){console.log("📦 Nenhum produto marcado para venda encontrado");return}console.log("📦 Produtos marcados para venda:",oe.length);const{data:pe,error:P}=await B.from("menu_items").select("direct_inventory_item_id").eq("empresa_id",re).eq("item_type","direct");console.log("🔍 Itens do menu existentes:",pe,"Erro:",P),P&&console.error("❌ Erro ao buscar itens do menu:",P);const q=new Set((pe==null?void 0:pe.map(je=>je.direct_inventory_item_id).filter(Boolean))||[]);console.log("🔍 IDs de inventário já no menu:",Array.from(q));const Q=oe.filter(je=>!q.has(je.id));if(console.log("🆕 Produtos para criar no menu:",Q.length,Q.map(je=>je.name)),Q.length===0){console.log("✅ Todos os produtos já estão sincronizados com o menu");return}console.log("🆕 Criando",Q.length,"novos itens no menu");const G=Q.map(je=>({name:je.name,description:`Produto do estoque: ${je.name}`,price:je.sale_price||je.cost*1.5,category:"Produtos do Estoque",available:!0,item_type:"direct",direct_inventory_item_id:je.id,empresa_id:re,image_url:je.image_url,preparation_time:0}));console.log("📝 Tentando criar itens:",G);const{data:me,error:Ne}=await B.from("menu_items").insert(G).select();if(Ne){console.error("❌ Erro ao criar itens do menu:",Ne),console.error("📋 Dados que tentamos inserir:",G);for(const je of G){console.log("🔄 Tentando criar item individual:",je.name);const{data:Re,error:Ie}=await B.from("menu_items").insert([je]).select();Ie?console.error(`❌ Erro ao criar ${je.name}:`,Ie):console.log(`✅ Criado ${je.name}:`,Re)}return}console.log("✅ Criados",(me==null?void 0:me.length)||0,"novos itens no menu:",me),await R()}catch(F){console.error("❌ Erro na sincronização:",F)}},[s]),[ce,J]=y.useState([]),[V,Y]=y.useState([]),ee=async()=>{console.log("🍺 Buscando pedidos do bar...");try{const{data:F,error:Z}=await B.from("comanda_items").select(`
          *,
          comanda:comandas(
            id,
            table_id,
            customer_name,
            opened_at,
            status,
            table:bar_tables(number)
          ),
          menu_item:menu_items(
            *,
            inventory_items!left(name, image_url)
          )
        `).in("status",["pending","preparing","ready"]).order("added_at",{ascending:!0});if(Z)throw Z;const{data:re,error:oe}=await B.from("balcao_orders").select("id").in("status",["paid","preparing","ready"]);if(oe)throw console.error("❌ Erro ao buscar pedidos de balcão:",oe),oe;const ae=(re==null?void 0:re.map(G=>G.id))||[];console.log(`📦 ${ae.length} pedidos de balcão com status válido`);let pe=null,P=null;if(ae.length>0){const G=await B.from("balcao_order_items").select(`
            *,
            balcao_order:balcao_orders(
              id,
              order_number,
              customer_name,
              status,
              created_at
            ),
            menu_item:menu_items(
              *,
              inventory_items!left(name, image_url)
            )
          `).in("balcao_order_id",ae).order("created_at",{ascending:!0});pe=G.data,P=G.error}if(P)throw console.error("❌ Erro ao buscar itens de balcão:",P),P;console.log(`📦 ${(pe==null?void 0:pe.length)||0} itens de balcão encontrados`);const q=new Map;F==null||F.forEach(G=>{var Ve,De,Ue,W,se,ue,Ce;const me=(Ve=G.comanda)==null?void 0:Ve.id;if(!me)return;const Ne=new Date(G.added_at),je=`${Ne.getUTCFullYear()}-${Ne.getUTCMonth()}-${Ne.getUTCDate()}-${Ne.getUTCHours()}-${Ne.getUTCMinutes()}`,Re=`comanda-${me}-${je}`;q.has(Re)||q.set(Re,{id:Re,tableNumber:(Ue=(De=G.comanda)==null?void 0:De.table)==null?void 0:Ue.number,items:[],status:G.status,total:0,createdAt:new Date(G.added_at),updatedAt:new Date(G.created_at),employeeId:"",notes:`Mesa ${(se=(W=G.comanda)==null?void 0:W.table)==null?void 0:se.number} - ${((ue=G.comanda)==null?void 0:ue.customer_name)||"Cliente"}`});const Ie=q.get(Re);Ie.items.push({id:G.id,menuItemId:G.menu_item_id,quantity:G.quantity,price:G.price,notes:G.notes,menuItem:G.menu_item?{id:G.menu_item.id,name:G.menu_item.item_type==="direct"&&((Ce=G.menu_item.inventory_items)!=null&&Ce.name)?G.menu_item.inventory_items.name:G.menu_item.name,category:G.menu_item.category,preparationTime:G.menu_item.preparation_time,item_type:G.menu_item.item_type}:void 0}),Ie.total+=G.price*G.quantity}),pe==null||pe.forEach(G=>{var Re,Ie;const me=(Re=G.balcao_order)==null?void 0:Re.id;if(!me)return;const Ne=`balcao-${me}`;q.has(Ne)||q.set(Ne,{id:Ne,tableNumber:"Balcão",items:[],status:G.balcao_order.status==="paid"?"pending":G.balcao_order.status==="preparing"?"preparing":"ready",total:0,createdAt:new Date(G.balcao_order.created_at),updatedAt:new Date(G.created_at),employeeId:"",notes:`Pedido Balcão #${G.balcao_order.order_number}${G.balcao_order.customer_name?` - ${G.balcao_order.customer_name}`:""}`});const je=q.get(Ne);je.items.push({id:G.id,menuItemId:G.menu_item_id,quantity:G.quantity,price:G.unit_price,notes:G.notes,menuItem:G.menu_item?{id:G.menu_item.id,name:G.menu_item.item_type==="direct"&&((Ie=G.menu_item.inventory_items)!=null&&Ie.name)?G.menu_item.inventory_items.name:G.menu_item.name,category:G.menu_item.category,preparationTime:G.menu_item.preparation_time,item_type:G.menu_item.item_type}:void 0}),je.total+=G.unit_price*G.quantity});const Q=Array.from(q.values());console.log(`✅ ${Q.length} pedidos do bar carregados`),Y(Q)}catch(F){console.error("❌ Erro ao buscar pedidos do bar:",F)}},we=async()=>{console.log("👨‍🍳 Buscando pedidos da cozinha...");try{const{data:F,error:Z}=await B.from("comanda_items").select(`
          *,
          comanda:comandas(
            id,
            table_id,
            customer_name,
            opened_at,
            status,
            table:bar_tables(number)
          ),
          menu_item:menu_items!inner(*)
        `).in("status",["pending","preparing"]).neq("menu_item.item_type","direct").order("added_at",{ascending:!0});if(Z)throw Z;const{data:re,error:oe}=await B.from("balcao_orders").select("id").in("status",["paid","preparing"]);if(oe)throw console.error("❌ Erro ao buscar pedidos de balcão (cozinha):",oe),oe;const ae=(re==null?void 0:re.map(G=>G.id))||[];console.log(`📦 ${ae.length} pedidos de balcão para cozinha`);let pe=null,P=null;if(ae.length>0){const G=await B.from("balcao_order_items").select(`
            *,
            balcao_order:balcao_orders(
              id,
              order_number,
              customer_name,
              status,
              created_at
            ),
            menu_item:menu_items!inner(*)
          `).in("balcao_order_id",ae).neq("menu_item.item_type","direct").order("created_at",{ascending:!0});pe=G.data,P=G.error}if(P)throw console.error("❌ Erro ao buscar itens de balcão (cozinha):",P),P;console.log(`📦 ${(pe==null?void 0:pe.length)||0} itens de balcão para cozinha`);const q=new Map;F==null||F.forEach(G=>{var Ve,De,Ue,W,se,ue;const me=(Ve=G.comanda)==null?void 0:Ve.id;if(!me)return;const Ne=new Date(G.added_at),je=`${Ne.getUTCFullYear()}-${Ne.getUTCMonth()}-${Ne.getUTCDate()}-${Ne.getUTCHours()}-${Ne.getUTCMinutes()}`,Re=`comanda-${me}-${je}`;q.has(Re)||q.set(Re,{id:Re,tableNumber:(Ue=(De=G.comanda)==null?void 0:De.table)==null?void 0:Ue.number,items:[],status:G.status,total:0,createdAt:new Date(G.added_at),updatedAt:new Date(G.created_at),employeeId:"",notes:`Mesa ${(se=(W=G.comanda)==null?void 0:W.table)==null?void 0:se.number} - ${((ue=G.comanda)==null?void 0:ue.customer_name)||"Cliente"}`});const Ie=q.get(Re);Ie.items.push({id:G.id,menuItemId:G.menu_item_id,quantity:G.quantity,price:G.price,notes:G.notes,menuItem:G.menu_item?{id:G.menu_item.id,name:G.menu_item.name,category:G.menu_item.category,preparationTime:G.menu_item.preparation_time}:void 0}),Ie.total+=G.price*G.quantity}),pe==null||pe.forEach(G=>{var Re;const me=(Re=G.balcao_order)==null?void 0:Re.id;if(!me)return;const Ne=`balcao-${me}`;q.has(Ne)||q.set(Ne,{id:Ne,tableNumber:"Balcão",items:[],status:G.balcao_order.status==="paid"?"pending":"preparing",total:0,createdAt:new Date(G.balcao_order.created_at),updatedAt:new Date(G.created_at),employeeId:"",notes:`Pedido Balcão #${G.balcao_order.order_number}${G.balcao_order.customer_name?` - ${G.balcao_order.customer_name}`:""}`});const je=q.get(Ne);je.items.push({id:G.id,menuItemId:G.menu_item_id,quantity:G.quantity,price:G.unit_price,notes:G.notes,menuItem:G.menu_item?{id:G.menu_item.id,name:G.menu_item.name,category:G.menu_item.category,preparationTime:G.menu_item.preparation_time}:void 0}),je.total+=G.unit_price*G.quantity});const Q=Array.from(q.values());console.log(`✅ ${Q.length} pedidos da cozinha carregados`),J(Q)}catch(F){console.error("❌ Erro ao buscar pedidos da cozinha:",F)}};y.useEffect(()=>{console.log("🚀🚀🚀 INICIANDO SUBSCRIPTIONS DE REALTIME 🚀🚀🚀"),we(),ee();const F=B.channel("kitchen-orders-realtime").on("postgres_changes",{event:"*",schema:"public",table:"comanda_items"},Z=>{console.log("🔥 REALTIME - comanda_items:",Z.eventType),we(),ee()}).on("postgres_changes",{event:"*",schema:"public",table:"comandas"},Z=>{console.log("🔥 REALTIME - comandas:",Z.eventType),we(),ee()}).on("postgres_changes",{event:"*",schema:"public",table:"balcao_orders"},Z=>{var re,oe,ae,pe;console.log("🔥🔥🔥 REALTIME - balcao_orders:",Z.eventType,"🔥🔥🔥"),console.log("📦 Status:",(re=Z.old)==null?void 0:re.status,"→",(oe=Z.new)==null?void 0:oe.status),Z.eventType==="UPDATE"&&((ae=Z.old)==null?void 0:ae.status)==="pending_payment"&&((pe=Z.new)==null?void 0:pe.status)==="paid"&&console.log("💰💰💰 PEDIDO PAGO! Atualizando monitores... 💰💰💰"),we(),ee()}).on("postgres_changes",{event:"*",schema:"public",table:"balcao_order_items"},Z=>{console.log("🔥 REALTIME - balcao_order_items:",Z.eventType),we(),ee()}).subscribe(Z=>{console.log("📡 Status da subscription kitchen-orders:",Z),Z==="SUBSCRIBED"?console.log("✅ Subscription ativa e funcionando!"):Z==="CHANNEL_ERROR"&&console.error("❌ Erro na subscription!")});return()=>{console.log("🔌 Desconectando subscription kitchen-orders"),F.unsubscribe()}},[]),y.useEffect(()=>{s&&(console.log("👤 Usuário autenticado, carregando inventário..."),I(),L())},[s,I]);const D=ce.filter(F=>F.items.length>0),H=V.filter(F=>F.items.length>0);return e.jsx(n2.Provider,{value:{menuItems:a,addMenuItem:_,updateMenuItem:w,removeMenuItem:E,loadMenuItems:R,orders:o,addOrder:k,updateOrderStatus:N,kitchenOrders:D,barOrders:H,refreshKitchenOrders:we,refreshBarOrders:ee,inventory:c,inventoryCategories:h,addInventoryItem:C,updateInventoryItem:S,removeInventoryItem:T,loadFullInventory:I,syncInventoryToMenu:X,members:p,addMember:M,updateMember:$,loadMembers:L,notifications:v,addNotification:A,clearNotifications:z},children:t})},iD=({children:t})=>{const{user:s,isLoading:a}=r2(),r=Xs(),o=kr(),[l,c]=y.useState(!0),[u,h]=y.useState(!1),f=["/alterar-senha-provisoria","/login","/logout","/registro-empresa"];return y.useEffect(()=>{(async()=>{if(!a){if(!(s!=null&&s.user_id)){c(!1);return}if(f.some(g=>o.pathname.startsWith(g))){c(!1);return}try{console.log("🔍 [SenhaProvisionariaGuard] Verificando senha provisória para user_id:",s.user_id);const{data:g,error:v}=await B.from("usuarios_empresa").select("senha_provisoria, status, nome_completo, email").eq("user_id",s.user_id).single();if(console.log("📊 [SenhaProvisionariaGuard] Resultado da consulta:",{usuarioEmpresa:g,error:v}),v){console.error("❌ [SenhaProvisionariaGuard] Erro ao verificar senha provisória:",v),c(!1);return}if(console.log("🔍 [SenhaProvisionariaGuard] senha_provisoria:",g==null?void 0:g.senha_provisoria),(g==null?void 0:g.senha_provisoria)===!0){console.log("🚨 [SenhaProvisionariaGuard] SENHA PROVISÓRIA DETECTADA! Redirecionando..."),h(!0),await B.rpc("registrar_log_auditoria",{p_empresa_id:s.empresa_id,p_usuario_id:s.user_id,p_acao:"ACCESS_ATTEMPT_TEMP_PASSWORD",p_recurso:"sistema",p_detalhes:{rota_tentativa:o.pathname,timestamp:new Date().toISOString(),user_agent:navigator.userAgent}}),r("/alterar-senha-provisoria",{replace:!0,state:{from:o.pathname}});return}(g==null?void 0:g.status)!=="ativo"&&console.warn("Usuário não está ativo:",g==null?void 0:g.status),h(!1)}catch(g){console.error("Erro ao verificar senha provisória:",g)}finally{c(!1)}}})()},[s,a,o.pathname,r]),a||l?e.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}),e.jsx("h2",{className:"mt-6 text-center text-lg font-medium text-gray-900",children:"Verificando credenciais..."}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Aguarde enquanto validamos suas informações de acesso"})]})}):u?e.jsx("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 bg-yellow-500 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-2.5L13.732 4c-.77-.833-1.964-.833-2.732 0L4.082 16.5c-.77.833.192 2.5 1.732 2.5z"})})})}),e.jsx("h2",{className:"mt-6 text-center text-lg font-medium text-gray-900",children:"Redirecionando..."}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Você será redirecionado para alterar sua senha provisória"})]})}):e.jsx(e.Fragment,{children:t})},wp={"bob@teste.com":"atendente_caixa","maria@teste.com":"operador_caixa","charles@teste.com":"operador_caixa","tony@teste.com":"operador_caixa","lulu@teste.com":"operador_caixa","lulusantos@teste.com":"operador_caixa","lulu.santos@teste.com":"operador_caixa"},qn=(t,s,a)=>{console.log("🚨 CHAMADA addUserRoleMapping:",{email:t,role:s,createdBy:a}),console.trace("📍 Stack trace da chamada:");const r={email:t,role:s,createdAt:new Date().toISOString(),createdBy:a};console.log(`📝 Adicionando mapeamento de usuário: ${t} → ${s}`),localStorage.setItem(`userRole_${t}`,JSON.stringify(r))},lD=t=>{if(console.log(`🔍 getUserRole chamada para: ${t}`),wp[t])return console.log(`📋 Role encontrado no mapeamento base: ${wp[t]}`),wp[t];try{const s=localStorage.getItem(`userRole_${t}`);if(s){const a=JSON.parse(s);return console.log(`💾 Role encontrado no localStorage: ${a.role}`),a.role}else console.log(`❌ Nenhum mapeamento encontrado no localStorage para: ${t}`)}catch(s){console.warn("Erro ao buscar role do localStorage:",s)}return console.log(`🚫 Nenhum role encontrado para: ${t}`),null},cD=t=>{console.log(`🔄 Mapeando role: "${t}"`);const a={waiter:"garcom",cook:"cozinheiro",cashier:"operador_caixa",caixa:"operador_caixa",atendente:"operador_caixa",supervisor:"atendente",barman:"atendente",manager:"gerente",gerente:"gerente",admin:"administrador"}[t]||"funcionario";return console.log(`🎯 Role "${t}" mapeado para: "${a}"`),a};async function dD(){var t;try{const{data:{user:s},error:a}=await B.auth.getUser();if(a||!s)return console.log("Usuário não autenticado"),null;console.log("👤 Usuário autenticado:",s.email),console.log("🔄 Usando fallback direto para evitar erros de RLS");let r=lD(s.email||"");if(console.log(`🔍 Buscando role para ${s.email}: ${r||"não encontrado"}`),s.email==="riltons@gmail.com"&&(r="administrador",console.log(`👑 Superusuário detectado: ${s.email}`)),["arnaldo@teste.com","martinho@teste.com","tony@teste.com","charles@teste.com","nando@teste.com","mariza@teste.com","lulu@teste.com","lulusantos@teste.com","lulu.santos@teste.com"].includes(s.email||"")&&(r="operador_caixa",console.log(`🎯 CORREÇÃO FORÇADA: ${s.email} → operador_caixa`)),!r)try{const{data:b}=await B.from("usuarios_empresa").select("cargo, tipo_usuario, papel, is_primeiro_usuario").eq("user_id",s.id).eq("status","ativo").maybeSingle();if(b)if(b.papel==="SUPER_ADMIN")r="administrador",console.log(`👑 SUPER_ADMIN detectado: ${s.email} → administrador`),qn(s.email||"",r,"papel_detection");else if(b.papel==="ADMIN")r="administrador",console.log(`🎯 ADMIN detectado: ${s.email} → administrador`),qn(s.email||"",r,"papel_detection");else if(b.papel==="MANAGER")r="gerente",console.log(`🎯 MANAGER detectado: ${s.email} → gerente`),qn(s.email||"",r,"papel_detection");else{const _=((t=b.cargo)==null?void 0:t.toLowerCase())||"";_.includes("caixa")||_.includes("cashier")||_.includes("atendente")?(r="operador_caixa",console.log(`🎯 Role detectado pelo cargo: "${b.cargo}" → operador_caixa`),qn(s.email||"",r,"cargo_detection")):_.includes("gerente")||_.includes("manager")?(r="gerente",console.log(`🎯 Role detectado pelo cargo: "${b.cargo}" → gerente`),qn(s.email||"",r,"cargo_detection")):(r="funcionario",console.log(`🔍 Cargo "${b.cargo}" → funcionario padrão`))}else{const _=(s.email||"").toLowerCase();_.includes("caixa")||_.includes("cashier")||_.includes("tony")||_.includes("charles")||_.includes("nando")||_.includes("arnaldo")||_.includes("mariza")||_.includes("martinho")||_.includes("nandoc")?(r="operador_caixa",console.log("🎯 Detecção inteligente por email: usuário identificado como operador de caixa"),qn(s.email||"",r,"smart_detection")):(r="funcionario",console.log(`🔍 Usuário não encontrado, usando role padrão: ${r}`))}}catch{console.log("⚠️ Erro ao buscar role do banco, usando fallback")}r=r||"funcionario",console.log(`🎯 Role final determinado: ${r}`);const l=r==="administrador";let c;if(l)try{c=await vt()||crypto.randomUUID(),console.log("👑 Superusuário - empresa_id obtida dinamicamente:",c)}catch(b){console.warn("⚠️ Erro ao obter empresa_id para superusuário, usando UUID aleatório:",b),c=crypto.randomUUID()}else c=crypto.randomUUID();const u=!0,h={id:crypto.randomUUID(),user_id:s.id,empresa_id:c,tipo_usuario:l?"administrador":"funcionario",status:"ativo",cargo:r,tem_acesso_sistema:!0};l?console.log("👑 Superusuário detectado - usando empresa AABB Garanhuns"):r!=="funcionario"&&console.log(`👤 Usuário com role específico detectado: ${r}`),console.log("✅ Dados do usuário carregados (fallback direto)");let f=[];console.log("🔍 Buscando permissões específicas do usuário...");try{const{data:b}=await B.from("usuarios_empresa").select("id, cargo, tipo_usuario").eq("user_id",s.id).eq("status","ativo").maybeSingle();if(b){console.log(`👤 Usuario empresa encontrado: ${b.cargo}`);const{data:_}=await B.from("permissoes_usuario").select("modulo, permissoes").eq("usuario_empresa_id",b.id);if(_&&_.length>0?(f=_,console.log(`✅ ${f.length} permissões específicas carregadas:`,f.map(w=>w.modulo))):console.log("⚠️ Nenhuma permissão específica encontrada na tabela permissoes_usuario"),b.cargo){const w=b.cargo.toLowerCase();(w.includes("caixa")||w.includes("cashier"))&&(r="operador_caixa",console.log(`🎯 Role atualizado baseado no cargo do banco: ${b.cargo} → operador_caixa`))}}else console.log("⚠️ Usuario empresa não encontrado, usando role mapeado")}catch(b){console.log("⚠️ Erro ao carregar permissões específicas:",b)}const p=null;console.log("✅ Pulando consulta bar_employees para evitar erros");const g=(p==null?void 0:p.bar_role)||h.cargo||"funcionario",v=uD(g,f);return{userId:s.id,empresaId:h.empresa_id,role:g,permissions:v,isActive:h.status==="ativo"&&(p==null?void 0:p.is_active)!==!1,hasSystemAccess:h.tem_acesso_sistema!==!1}}catch(s){return console.error("❌ Erro fatal ao carregar permissões:",s),null}}function uD(t,s=[]){const a={gerente:{dashboard:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},monitor_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},atendimento_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},monitor_cozinha:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},clientes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},funcionarios:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},relatorios:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},configuracoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0}},administrador:{dashboard:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},monitor_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},atendimento_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},monitor_cozinha:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},clientes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},funcionarios:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},relatorios:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},configuracoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0}},funcionario:{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},atendimento_bar:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}},atendente:{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},monitor_bar:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},atendimento_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1},gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1},clientes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},atendente_caixa:{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1},atendimento_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1},clientes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},operador_caixa:{gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}},cozinheiro:{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},monitor_cozinha:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1},atendimento_bar:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}},garcom:{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},monitor_bar:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},atendimento_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1},clientes:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}}},r={dashboard:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},monitor_bar:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},atendimento_bar:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},monitor_cozinha:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},gestao_caixa:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},clientes:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},funcionarios:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},relatorios:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},configuracoes:{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1}};if(s.length>0){console.log(`🎯 Usando APENAS permissões específicas do usuário (${s.length} módulos)`);const c={...r};return s.forEach(u=>{c[u.modulo]&&(c[u.modulo]={visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1,...u.permissoes},console.log(`📋 Módulo '${u.modulo}' configurado:`,u.permissoes))}),console.log("🔐 Permissões específicas aplicadas para usuário:",c),c}console.log(`📋 Usando permissões padrão do role '${t}'`);const o={...r},l=a[t]||a.funcionario;return Object.keys(l).forEach(c=>{o[c]&&(o[c]={...o[c],...l[c]})}),console.log(`🔐 Permissões padrão construídas para role '${t}':`,o),o}const o2=(t,s,a="visualizar")=>{if(!t||!t.isActive||!t.hasSystemAccess)return!1;const r=t.permissions[s];return r?r[a]:!1},i2=async()=>await dD(),mD=()=>e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Verificando permissões..."})]})}),hD=({module:t,action:s})=>e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-red-100 mb-4",children:e.jsx(Gu,{className:"h-8 w-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Acesso Negado"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Você não tem permissão para acessar este módulo."}),e.jsxs("div",{className:"bg-gray-100 rounded-lg p-4 mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Módulo:"})," ",t]}),e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Ação:"})," ",s]})]}),e.jsx("p",{className:"text-sm text-gray-500",children:"Entre em contato com o administrador para solicitar as permissões necessárias."}),e.jsx("button",{onClick:()=>window.history.back(),className:"mt-4 px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Voltar"})]})}),fD=({error:t})=>e.jsx("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:e.jsxs("div",{className:"text-center max-w-md mx-auto p-8",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-yellow-100 mb-4",children:e.jsx(Ya,{className:"h-8 w-8 text-yellow-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Erro de Verificação"}),e.jsx("p",{className:"text-gray-600 mb-4",children:t}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Tentar Novamente"})]})}),Dt=({children:t,module:s,action:a="visualizar",fallback:r,loadingComponent:o,redirectTo:l="/"})=>{const[c,u]=y.useState({loading:!0,hasPermission:!1,permissions:null,error:null});y.useEffect(()=>{h()},[s,a]);const h=async()=>{try{u(g=>({...g,loading:!0,error:null}));const f=await i2();if(!f){u({loading:!1,hasPermission:!1,permissions:null,error:"Usuário não autenticado"});return}if(!f.isActive){u({loading:!1,hasPermission:!1,permissions:f,error:"Usuário inativo"});return}if(!f.hasSystemAccess){u({loading:!1,hasPermission:!1,permissions:f,error:"Usuário sem acesso ao sistema"});return}const p=o2(f,s,a);u({loading:!1,hasPermission:p,permissions:f,error:null})}catch(f){u({loading:!1,hasPermission:!1,permissions:null,error:f instanceof Error?f.message:"Erro de verificação de permissões"})}};return c.loading?o||e.jsx(mD,{}):c.error?c.error==="Usuário não autenticado"?e.jsx(Ri,{to:"/login",replace:!0}):e.jsx(fD,{error:c.error}):c.hasPermission?e.jsx(e.Fragment,{children:t}):r?e.jsx(e.Fragment,{children:r}):["dashboard"].includes(s)?e.jsx(Ri,{to:l,replace:!0}):e.jsx(hD,{module:s,action:a})},pD=()=>{const{user:t,empresa:s,logout:a}=r2(),r=Xs(),[o,l]=y.useState(""),[c,u]=y.useState(""),[h,f]=y.useState(!1),[p,g]=y.useState(""),[v,b]=y.useState(!1),[_,w]=y.useState(!1),[E,k]=y.useState({senha_minima_caracteres:8,senha_exigir_maiuscula:!0,senha_exigir_numero:!0,senha_exigir_simbolo:!1}),[N,C]=y.useState({tamanhoMinimo:!1,temMaiuscula:!1,temMinuscula:!1,temNumero:!1,temSimbolo:!1,senhasIguais:!1});y.useEffect(()=>{(async()=>{if(s!=null&&s.id)try{const{data:A,error:z}=await B.from("configuracoes_empresa").select("configuracoes").eq("empresa_id",s.id).eq("categoria","seguranca").single();if(z){console.error("Erro ao carregar configurações:",z);return}A!=null&&A.configuracoes&&k({senha_minima_caracteres:A.configuracoes.senha_minima_caracteres||8,senha_exigir_maiuscula:A.configuracoes.senha_exigir_maiuscula||!0,senha_exigir_numero:A.configuracoes.senha_exigir_numero||!0,senha_exigir_simbolo:A.configuracoes.senha_exigir_simbolo||!1})}catch(A){console.error("Erro ao carregar configurações:",A)}})()},[s==null?void 0:s.id]),y.useEffect(()=>{(()=>{const A={tamanhoMinimo:o.length>=E.senha_minima_caracteres,temMaiuscula:E.senha_exigir_maiuscula?/[A-Z]/.test(o):!0,temMinuscula:/[a-z]/.test(o),temNumero:E.senha_exigir_numero?/[0-9]/.test(o):!0,temSimbolo:E.senha_exigir_simbolo?/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(o):!0,senhasIguais:o===c&&o.length>0};C(A)})()},[o,c,E]);const S=Object.values(N).every($=>$===!0),T=async $=>{if($.preventDefault(),!S){g("Por favor, atenda a todos os requisitos de senha.");return}f(!0),g("");try{const{error:A}=await B.auth.updateUser({password:o});if(A)throw new Error(A.message);const{error:z}=await B.from("usuarios_empresa").update({senha_provisoria:!1,updated_at:new Date().toISOString()}).eq("user_id",t==null?void 0:t.user_id);if(z)throw new Error(z.message);await B.rpc("registrar_log_auditoria",{p_empresa_id:s==null?void 0:s.id,p_usuario_id:t==null?void 0:t.user_id,p_acao:"PASSWORD_CHANGE",p_recurso:"usuarios_empresa",p_detalhes:{tipo:"senha_provisoria_alterada",timestamp:new Date().toISOString()}}),alert("Senha alterada com sucesso! Você será redirecionado para o dashboard."),setTimeout(()=>{r("/dashboard")},1e3)}catch(A){console.error("Erro ao alterar senha:",A),g(A instanceof Error?A.message:"Erro ao alterar senha")}finally{f(!1)}},M=async()=>{window.confirm("Tem certeza que deseja sair? Você precisará alterar sua senha provisória na próxima vez que fizer login.")&&(await a(),r("/login"))};return e.jsxs("div",{className:"min-h-screen bg-gray-50 flex flex-col justify-center py-12 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"sm:mx-auto sm:w-full sm:max-w-md",children:[e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-8 h-8 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})})}),e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Alterar Senha Provisória"}),e.jsx("p",{className:"mt-2 text-center text-sm text-gray-600",children:"Por segurança, você deve alterar sua senha provisória antes de continuar"})]}),e.jsx("div",{className:"mt-8 sm:mx-auto sm:w-full sm:max-w-md",children:e.jsxs("div",{className:"bg-white py-8 px-4 shadow sm:rounded-lg sm:px-10",children:[e.jsx("div",{className:"mb-6 p-4 bg-blue-50 rounded-md",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-blue-400",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{className:"ml-3",children:[e.jsxs("h3",{className:"text-sm font-medium text-blue-800",children:["Bem-vindo à ",s==null?void 0:s.nome]}),e.jsxs("div",{className:"mt-2 text-sm text-blue-700",children:[e.jsxs("p",{children:["Usuário: ",t==null?void 0:t.nome_completo]}),e.jsxs("p",{children:["Email: ",t==null?void 0:t.email]})]})]})]})}),e.jsxs("form",{className:"space-y-6",onSubmit:T,children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"nova-senha",className:"block text-sm font-medium text-gray-700",children:"Nova Senha"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("input",{id:"nova-senha",name:"nova-senha",type:v?"text":"password",autoComplete:"new-password",required:!0,value:o,onChange:$=>l($.target.value),className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Digite sua nova senha"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>b(!v),children:v?e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):e.jsxs("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"confirmar-senha",className:"block text-sm font-medium text-gray-700",children:"Confirmar Nova Senha"}),e.jsxs("div",{className:"mt-1 relative",children:[e.jsx("input",{id:"confirmar-senha",name:"confirmar-senha",type:_?"text":"password",autoComplete:"new-password",required:!0,value:c,onChange:$=>u($.target.value),className:"appearance-none block w-full px-3 py-2 border border-gray-300 rounded-md placeholder-gray-400 focus:outline-none focus:ring-blue-500 focus:border-blue-500 sm:text-sm",placeholder:"Confirme sua nova senha"}),e.jsx("button",{type:"button",className:"absolute inset-y-0 right-0 pr-3 flex items-center",onClick:()=>w(!_),children:_?e.jsx("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13.875 18.825A10.05 10.05 0 0112 19c-4.478 0-8.268-2.943-9.543-7a9.97 9.97 0 011.563-3.029m5.858.908a3 3 0 114.243 4.243M9.878 9.878l4.242 4.242M9.878 9.878L3 3m6.878 6.878L21 21"})}):e.jsxs("svg",{className:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})})]})]}),e.jsxs("div",{className:"bg-gray-50 rounded-md p-4",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Requisitos da Senha:"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:`flex items-center text-sm ${N.tamanhoMinimo?"text-green-600":"text-gray-500"}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${N.tamanhoMinimo?"text-green-500":"text-gray-400"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Mínimo de ",E.senha_minima_caracteres," caracteres"]}),E.senha_exigir_maiuscula&&e.jsxs("div",{className:`flex items-center text-sm ${N.temMaiuscula?"text-green-600":"text-gray-500"}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${N.temMaiuscula?"text-green-500":"text-gray-400"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Pelo menos uma letra maiúscula"]}),e.jsxs("div",{className:`flex items-center text-sm ${N.temMinuscula?"text-green-600":"text-gray-500"}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${N.temMinuscula?"text-green-500":"text-gray-400"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Pelo menos uma letra minúscula"]}),E.senha_exigir_numero&&e.jsxs("div",{className:`flex items-center text-sm ${N.temNumero?"text-green-600":"text-gray-500"}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${N.temNumero?"text-green-500":"text-gray-400"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Pelo menos um número"]}),E.senha_exigir_simbolo&&e.jsxs("div",{className:`flex items-center text-sm ${N.temSimbolo?"text-green-600":"text-gray-500"}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${N.temSimbolo?"text-green-500":"text-gray-400"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"Pelo menos um símbolo (!@#$%^&*)"]}),e.jsxs("div",{className:`flex items-center text-sm ${N.senhasIguais?"text-green-600":"text-gray-500"}`,children:[e.jsx("svg",{className:`h-4 w-4 mr-2 ${N.senhasIguais?"text-green-500":"text-gray-400"}`,fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z",clipRule:"evenodd"})}),"As senhas devem ser iguais"]})]})]}),p&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("h3",{className:"text-sm font-medium text-red-800",children:p})})]})}),e.jsxs("div",{className:"flex flex-col space-y-3",children:[e.jsx("button",{type:"submit",disabled:!S||h,className:`w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 ${S&&!h?"bg-blue-600 hover:bg-blue-700":"bg-gray-400 cursor-not-allowed"}`,children:h?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Alterando senha..."]}):"Alterar Senha"}),e.jsx("button",{type:"button",onClick:M,className:"w-full flex justify-center py-2 px-4 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500",children:"Sair do Sistema"})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"Informações de Segurança"})})]}),e.jsx("div",{className:"mt-4 text-sm text-gray-600",children:e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• Sua senha será criptografada e armazenada com segurança"}),e.jsx("li",{children:"• Você receberá uma confirmação por email após a alteração"}),e.jsx("li",{children:"• Esta alteração será registrada nos logs de auditoria"}),e.jsx("li",{children:"• Em caso de problemas, contate o administrador do sistema"})]})})]})]})})]})},gD={"Failed to fetch":{code:"NETWORK_ERROR",message:"Falha na conexão com o servidor",userMessage:"Problema de conexão. Verifique sua internet e tente novamente.",retryable:!0,action:"retry"},"Invalid login credentials":{code:"INVALID_CREDENTIALS",message:"Credenciais inválidas",userMessage:"Email ou senha incorretos. Verifique seus dados e tente novamente.",retryable:!1},"Email not confirmed":{code:"EMAIL_NOT_CONFIRMED",message:"Email não confirmado",userMessage:"Confirme seu email antes de fazer login. Verifique sua caixa de entrada.",retryable:!1},"Too many requests":{code:"RATE_LIMIT",message:"Muitas tentativas",userMessage:"Muitas tentativas de login. Aguarde alguns minutos antes de tentar novamente.",retryable:!0},"User not found":{code:"USER_NOT_FOUND",message:"Usuário não encontrado",userMessage:"Conta não encontrada. Verifique o email ou crie uma nova conta.",retryable:!1},"Invalid Refresh Token":{code:"INVALID_REFRESH_TOKEN",message:"Token de sessão inválido",userMessage:"Sua sessão expirou. Faça login novamente.",retryable:!1,action:"redirect"},"Profile not found":{code:"PROFILE_NOT_FOUND",message:"Perfil não encontrado",userMessage:"Erro na configuração da conta. Entre em contato com o suporte.",retryable:!1,action:"contact_support"},"Insufficient permissions":{code:"INSUFFICIENT_PERMISSIONS",message:"Permissões insuficientes",userMessage:"Você não tem permissão para acessar este recurso.",retryable:!1}};function xD(t){const s=(t==null?void 0:t.message)||(t==null?void 0:t.error_description)||String(t);for(const[a,r]of Object.entries(gD))if(s.includes(a))return r;return{code:"UNKNOWN_ERROR",message:s,userMessage:"Ocorreu um erro inesperado. Tente novamente ou entre em contato com o suporte.",retryable:!0,action:"retry"}}const yD=({error:t,onRetry:s,onDismiss:a,context:r="auth"})=>{if(!t)return null;const o=xD(t),l=()=>{switch(o.code){case"NETWORK_ERROR":return e.jsx(ma,{className:"w-5 h-5"});case"EMAIL_NOT_CONFIRMED":return e.jsx(ki,{className:"w-5 h-5"});case"PROFILE_NOT_FOUND":case"UNKNOWN_ERROR":return e.jsx(RR,{className:"w-5 h-5"});default:return e.jsx(Ya,{className:"w-5 h-5"})}},u=(()=>{switch(o.code){case"NETWORK_ERROR":return{container:"bg-yellow-50 border-yellow-200",icon:"text-yellow-600",text:"text-yellow-800",button:"bg-yellow-600 hover:bg-yellow-700"};case"RATE_LIMIT":return{container:"bg-orange-50 border-orange-200",icon:"text-orange-600",text:"text-orange-800",button:"bg-orange-600 hover:bg-orange-700"};default:return{container:"bg-red-50 border-red-200",icon:"text-red-600",text:"text-red-800",button:"bg-red-600 hover:bg-red-700"}}})();return e.jsx(Ws,{children:e.jsx(be.div,{initial:{opacity:0,y:-10,scale:.95},animate:{opacity:1,y:0,scale:1},exit:{opacity:0,y:-10,scale:.95},className:`rounded-lg border p-4 ${u.container}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx("div",{className:`flex-shrink-0 ${u.icon}`,children:l()}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("h3",{className:`text-sm font-medium ${u.text}`,children:[o.code==="NETWORK_ERROR"&&"Problema de Conexão",o.code==="INVALID_CREDENTIALS"&&"Credenciais Inválidas",o.code==="EMAIL_NOT_CONFIRMED"&&"Email Não Confirmado",o.code==="RATE_LIMIT"&&"Muitas Tentativas",o.code==="USER_NOT_FOUND"&&"Usuário Não Encontrado",o.code==="INVALID_REFRESH_TOKEN"&&"Sessão Expirada",o.code==="PROFILE_NOT_FOUND"&&"Erro de Configuração",o.code==="INSUFFICIENT_PERMISSIONS"&&"Acesso Negado",o.code==="UNKNOWN_ERROR"&&"Erro Inesperado"]}),e.jsx("p",{className:`mt-1 text-sm ${u.text}`,children:o.userMessage}),e.jsxs("div",{className:"mt-3 flex items-center space-x-3",children:[o.retryable&&s&&e.jsxs("button",{onClick:s,className:`inline-flex items-center px-3 py-1.5 text-xs font-medium text-white rounded-md ${u.button} transition-colors`,children:[e.jsx(ma,{className:"w-3 h-3 mr-1"}),"Tentar Novamente"]}),o.action==="contact_support"&&e.jsxs("a",{href:"mailto:suporte@clubmanager.com",className:`inline-flex items-center px-3 py-1.5 text-xs font-medium text-white rounded-md ${u.button} transition-colors`,children:[e.jsx(ki,{className:"w-3 h-3 mr-1"}),"Contatar Suporte"]}),o.code==="EMAIL_NOT_CONFIRMED"&&e.jsxs("button",{onClick:()=>{console.log("Reenviar email de confirmação")},className:`inline-flex items-center px-3 py-1.5 text-xs font-medium text-white rounded-md ${u.button} transition-colors`,children:[e.jsx(ki,{className:"w-3 h-3 mr-1"}),"Reenviar Email"]})]})]}),a&&e.jsx("button",{onClick:a,className:`flex-shrink-0 ${u.icon} hover:opacity-70 transition-opacity`,children:e.jsx(nt,{className:"w-4 h-4"})})]})})})},bD=({onCredentialSelect:t})=>{const[s,a]=y.useState(!1),[r,o]=y.useState(null),l=x0.getAvailableUsers(),c=async(h,f)=>{try{await navigator.clipboard.writeText(h),o(f),setTimeout(()=>o(null),2e3)}catch(p){console.error("Erro ao copiar:",p)}},u=(h,f)=>{t&&t(h,f)};return e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(JN,{className:"text-blue-600 mt-0.5",size:20}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-blue-800 font-medium mb-2",children:"Modo Demonstração Ativo"}),e.jsx("p",{className:"text-blue-700 text-sm mb-3",children:"O sistema está funcionando em modo mock. Use uma das credenciais abaixo para testar:"}),e.jsxs("button",{onClick:()=>a(!s),className:"flex items-center space-x-2 text-blue-700 hover:text-blue-800 text-sm font-medium mb-3",children:[s?e.jsx(mn,{size:16}):e.jsx(Ys,{size:16}),e.jsxs("span",{children:[s?"Ocultar":"Ver"," credenciais disponíveis"]})]}),s&&e.jsxs("div",{className:"space-y-3",children:[l.map((h,f)=>e.jsxs("div",{className:"bg-white rounded border p-3 hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ns,{size:16,className:"text-gray-500"}),e.jsx("span",{className:"font-medium text-gray-900",children:h.name}),e.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:h.role})]}),t&&e.jsx("button",{onClick:()=>u(h.email,h.password),className:"text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded hover:bg-blue-200",children:"Usar"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-600 min-w-[60px]",children:"Email:"}),e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded flex-1 font-mono text-xs",children:h.email}),e.jsx("button",{onClick:()=>c(h.email,`email-${f}`),className:"text-gray-400 hover:text-gray-600",title:"Copiar email",children:r===`email-${f}`?e.jsx(Hu,{size:14,className:"text-green-500"}):e.jsx(La,{size:14})})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-gray-600 min-w-[60px]",children:"Senha:"}),e.jsx("code",{className:"bg-gray-100 px-2 py-1 rounded flex-1 font-mono text-xs",children:h.password}),e.jsx("button",{onClick:()=>c(h.password,`password-${f}`),className:"text-gray-400 hover:text-gray-600",title:"Copiar senha",children:r===`password-${f}`?e.jsx(Hu,{size:14,className:"text-green-500"}):e.jsx(La,{size:14})})]})]})]},h.email)),e.jsxs("div",{className:"text-xs text-blue-600 bg-blue-100 p-2 rounded",children:["💡 ",e.jsx("strong",{children:"Dica:"})," Configure suas credenciais reais do Supabase nos arquivos .env para sair do modo mock"]})]})]})]})})},vD=()=>{const[t,s]=y.useState(""),[a,r]=y.useState(""),[o,l]=y.useState(!1),[c,u]=y.useState(""),[h,f]=y.useState(!1),{login:p,loginAsDemo:g,isLoading:v}=jt();y.useEffect(()=>{(async()=>{const k=await Eu();f(!k)})()},[]);const b=async E=>{if(E.preventDefault(),u(""),!t||!a){u("Por favor, preencha todos os campos");return}const k=await p(t,a);k.success||u(k.error||"Erro ao fazer login. Tente novamente.")},_=()=>{u(""),b({preventDefault:()=>{}})},w=()=>{g()};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-slate-800 to-slate-900 flex items-center justify-center p-4",children:e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ns,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"ClubManager Pro"}),e.jsx("p",{className:"text-gray-600",children:"Sistema de Gestão de Clubes"})]}),e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:w,className:"w-full bg-gradient-to-r from-green-500 to-green-600 text-white py-4 rounded-lg font-semibold text-lg hover:from-green-600 hover:to-green-700 transition-all duration-300 flex items-center justify-center space-x-2 mb-6 shadow-lg",children:[e.jsx(Tr,{className:"w-5 h-5"}),e.jsx("span",{children:"🚀 Entrar como Demo"})]}),h&&e.jsx(bD,{onCredentialSelect:(E,k)=>{s(E),r(k)}}),e.jsxs("div",{className:"relative mb-6",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-2 bg-white text-gray-500",children:"ou faça login tradicional"})})]}),e.jsxs("form",{onSubmit:b,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(ki,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"email",value:t,onChange:E=>s(E.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Digite seu email"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(Gu,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:o?"text":"password",value:a,onChange:E=>r(E.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Digite sua senha"}),e.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:o?e.jsx(mn,{size:20}):e.jsx(Ys,{size:20})})]})]}),e.jsx(yD,{error:c,onRetry:_,onDismiss:()=>u(""),context:"login"}),e.jsx(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:v,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:v?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Entrando..."})]}):"Entrar"})]}),e.jsxs("div",{className:"mt-8 p-4 bg-gradient-to-r from-blue-50 to-green-50 rounded-lg border border-blue-100",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2 text-center",children:"🎯 Acesso Demo Rápido"}),e.jsxs("div",{className:"text-sm text-gray-600 space-y-1",children:[e.jsxs("p",{children:["✅ ",e.jsx("strong",{children:"Módulo Bar:"})," Pedidos, comandas e vendas"]}),e.jsxs("p",{children:["✅ ",e.jsx("strong",{children:"Módulo Cozinha:"})," Gestão de cardápio e pedidos"]}),e.jsxs("p",{children:["✅ ",e.jsx("strong",{children:"Dashboard:"})," Métricas e relatórios"]}),e.jsxs("p",{children:["✅ ",e.jsx("strong",{children:"Estoque:"})," Controle de inventário"]})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-blue-200",children:e.jsxs("p",{className:"text-xs text-gray-500 text-center",children:["💡 ",e.jsx("strong",{children:"Dica:"})," Use o botão verde acima para acesso instantâneo!"]})})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-sm text-gray-600",children:["Não tem uma conta?"," ",e.jsx(fs,{to:"/register",className:"text-blue-600 hover:text-blue-700 font-medium transition-colors",children:"Cadastre-se aqui"})]})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-xs text-gray-500",children:"ClubManager Pro v1.0 - Sistema Demonstração"})})]})})},wD=()=>{const t=Xs(),{register:s}=jt(),[a,r]=y.useState({name:"",email:"",password:"",confirmPassword:""}),[o,l]=y.useState(!1),[c,u]=y.useState(!1),[h,f]=y.useState(""),[p,g]=y.useState(""),[v,b]=y.useState(!1),_=(k,N)=>{r(C=>({...C,[k]:N})),f("")},w=()=>a.name.trim()?a.email.trim()?a.password.length<6?(f("Senha deve ter pelo menos 6 caracteres"),!1):a.password!==a.confirmPassword?(f("Senhas não coincidem"),!1):!0:(f("Email é obrigatório"),!1):(f("Nome é obrigatório"),!1),E=async k=>{if(k.preventDefault(),f(""),g(""),!w())return;b(!0);const N=await s(a.name,a.email,a.password);N.success?(g("🎉 Cadastro realizado com sucesso! Você foi registrado como ADMINISTRADOR PRINCIPAL com todos os poderes do sistema. Faça login para acessar."),r({name:"",email:"",password:"",confirmPassword:""}),setTimeout(()=>{t("/login")},3e3)):f(N.error||"Erro no cadastro. Tente novamente."),b(!1)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-900 via-slate-800 to-slate-900 flex items-center justify-center p-4",children:e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"bg-white rounded-2xl shadow-2xl p-8 w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(Ns,{className:"w-8 h-8 text-white"})}),e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Criar Conta"}),e.jsx("p",{className:"text-gray-600",children:"ClubManager Pro"}),e.jsx("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"🔐 Primeiro Usuário:"})," Será automaticamente o administrador principal com todos os poderes do sistema."]})})]}),e.jsxs("form",{onSubmit:E,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome Completo"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ks,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:a.name,onChange:k=>_("name",k.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Digite seu nome completo",disabled:v})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsxs("div",{className:"relative",children:[e.jsx(ki,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"email",value:a.email,onChange:k=>_("email",k.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Digite seu email",disabled:v})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(Gu,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:o?"text":"password",value:a.password,onChange:k=>_("password",k.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Digite sua senha",disabled:v}),e.jsx("button",{type:"button",onClick:()=>l(!o),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:v,children:o?e.jsx(mn,{size:20}):e.jsx(Ys,{size:20})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirmar Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx(Gu,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:c?"text":"password",value:a.confirmPassword,onChange:k=>_("confirmPassword",k.target.value),className:"w-full pl-10 pr-12 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-colors",placeholder:"Confirme sua senha",disabled:v}),e.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",disabled:v,children:c?e.jsx(mn,{size:20}):e.jsx(Ys,{size:20})})]})]}),h&&e.jsx(be.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-red-600 text-sm text-center bg-red-50 p-3 rounded-lg border border-red-200",children:h}),p&&e.jsx(be.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"text-green-600 text-sm text-center bg-green-50 p-3 rounded-lg border border-green-200",children:p}),e.jsx(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},type:"submit",disabled:v,className:"w-full bg-blue-600 text-white py-3 rounded-lg font-medium hover:bg-blue-700 focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:v?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Criando conta..."})]}):"Criar Conta"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs(fs,{to:"/login",className:"inline-flex items-center space-x-2 text-blue-600 hover:text-blue-700 font-medium transition-colors",children:[e.jsx(fo,{size:16}),e.jsx("span",{children:"Voltar para o Login"})]})}),e.jsx("div",{className:"mt-4 text-center",children:e.jsx("p",{className:"text-xs text-gray-500",children:"ClubManager Pro v1.0 - Sistema Demonstração"})})]})})},jD=({isOpen:t,onClose:s,isDesktopOpen:a})=>{const{user:r,logout:o}=jt(),[l,c]=y.useState(null),[u,h]=y.useState(!0);y.useEffect(()=>{r&&(async()=>{try{const w=await i2();c(w)}catch(w){console.error("Erro ao carregar permissões:",w)}finally{h(!1)}})()},[r]);const p=[{name:"Dashboard",icon:tO,path:"/",module:"dashboard"},{name:"Monitor Bar",icon:Ac,path:"/bar",module:"monitor_bar"},{name:"Atendimento Bar",icon:zR,path:"/bar/attendance",module:"atendimento_bar"},{name:"Monitor Cozinha",icon:kc,path:"/kitchen",module:"monitor_cozinha"},{name:"Gestão de Caixa",icon:Ut,path:"/cash",module:"gestao_caixa"},{name:"Clientes",icon:Ns,path:"/bar-customers",module:"clientes"},{name:"Funcionários",icon:t2,path:"/bar-employees",module:"funcionarios"},{name:"Estoque",icon:Ka,path:"/inventory",module:"funcionarios"},{name:"Sócios",icon:Ns,path:"/members",module:"clientes"},{name:"Configurações",icon:io,path:"/settings",module:"configuracoes"},{name:"Ambiente",icon:hc,path:"/environment",module:"configuracoes"}].filter(_=>u||!l?!1:o2(l,_.module,"visualizar")),g=(r==null?void 0:r.email)==="demo@clubmanager.com",v=()=>e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6 sm:mb-8",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-blue-400",children:"ClubManager"}),e.jsx("p",{className:"text-slate-400 text-xs sm:text-sm",children:"Sistema de Gestão"}),g&&e.jsxs("div",{className:"mt-2 flex items-center space-x-1 text-xs text-green-400",children:[e.jsx(Tr,{size:12}),e.jsx("span",{children:"Modo Demo"})]})]}),r&&e.jsxs("div",{className:`mb-4 sm:mb-6 p-2 sm:p-3 rounded-lg ${g?"bg-green-800 border border-green-600":"bg-slate-800"}`,children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-3",children:[e.jsx("img",{src:r.avatar||`https://api.dicebear.com/8.x/initials/svg?seed=${r.name}`,alt:r.name,className:"w-8 h-8 sm:w-10 sm:h-10 rounded-full flex-shrink-0"}),e.jsxs("div",{className:"min-w-0 flex-1",children:[e.jsx("p",{className:"font-medium text-xs sm:text-sm truncate",children:r.name}),e.jsx("p",{className:"text-slate-400 text-xs capitalize truncate",children:r.role}),r.department&&e.jsx("p",{className:"text-slate-300 text-xs truncate",children:r.department})]})]}),g&&e.jsx("div",{className:"mt-2 text-xs text-green-300",children:"🚀 Explorando funcionalidades"})]}),e.jsx("nav",{className:"flex-1 overflow-y-auto scrollbar-hide",children:u?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-400"})}):e.jsx("ul",{className:"space-y-2",children:p.length>0?p.map(_=>e.jsx("li",{children:e.jsxs(Ap,{to:_.path,onClick:()=>s(),className:({isActive:w})=>`flex items-center space-x-2 sm:space-x-3 p-2 sm:p-3 rounded-lg transition-colors ${w?"bg-blue-600 text-white":"text-slate-300 hover:bg-slate-800 hover:text-white"}`,children:[e.jsx(_.icon,{size:18,className:"flex-shrink-0"}),e.jsx("span",{className:"text-sm sm:text-base truncate",children:_.name})]})},_.name)):e.jsx("li",{className:"p-3 text-slate-400 text-sm text-center",children:"Sem permissões de acesso"})})}),g&&e.jsxs("div",{className:"mb-3 sm:mb-4 p-2 sm:p-3 bg-blue-900 rounded-lg border border-blue-700",children:[e.jsx("h4",{className:"text-xs sm:text-sm font-semibold text-blue-200 mb-1 sm:mb-2",children:"🎯 Teste Agora:"}),e.jsxs("ul",{className:"text-xs text-blue-300 space-y-1",children:[e.jsx("li",{children:"• Criar pedidos no Bar"}),e.jsx("li",{children:"• Sistema de Atendimento"}),e.jsx("li",{children:"• Gerenciar cozinha"}),e.jsx("li",{children:"• Ver métricas em tempo real"}),e.jsx("li",{children:"• Controlar estoque"})]})]}),e.jsxs("button",{onClick:()=>{o(),s()},className:"flex items-center space-x-2 sm:space-x-3 p-2 sm:p-3 rounded-lg text-slate-300 hover:bg-slate-800 hover:text-white transition-colors mt-3 sm:mt-4",children:[e.jsx(Sj,{size:18,className:"flex-shrink-0"}),e.jsx("span",{className:"text-sm sm:text-base",children:g?"Sair do Demo":"Sair"})]})]}),b=()=>e.jsxs(e.Fragment,{children:[r&&e.jsx("div",{className:"mb-6 flex justify-center",children:e.jsx("img",{src:r.avatar||`https://api.dicebear.com/8.x/initials/svg?seed=${r.name}`,alt:r.name,className:"w-10 h-10 rounded-full",title:r.name})}),e.jsx("nav",{className:"flex-1 overflow-y-auto scrollbar-hide",children:u?e.jsx("div",{className:"flex items-center justify-center p-4",children:e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-400"})}):e.jsx("ul",{className:"space-y-2",children:p.length>0?p.map(_=>e.jsx("li",{children:e.jsxs(Ap,{to:_.path,className:({isActive:w})=>`flex items-center justify-center p-3 rounded-lg transition-colors group relative ${w?"bg-blue-600 text-white":"text-slate-300 hover:bg-slate-800 hover:text-white"}`,title:_.name,children:[e.jsx(_.icon,{size:20,className:"flex-shrink-0"}),e.jsx("span",{className:"absolute left-full ml-2 px-2 py-1 bg-slate-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none z-50",children:_.name})]})},_.name)):null})}),e.jsxs("button",{onClick:()=>{o(),s()},className:"flex items-center justify-center p-3 rounded-lg text-slate-300 hover:bg-slate-800 hover:text-white transition-colors mt-4 group relative",title:g?"Sair do Demo":"Sair",children:[e.jsx(Sj,{size:20,className:"flex-shrink-0"}),e.jsx("span",{className:"absolute left-full ml-2 px-2 py-1 bg-slate-800 text-white text-sm rounded opacity-0 group-hover:opacity-100 transition-opacity whitespace-nowrap pointer-events-none z-50",children:g?"Sair do Demo":"Sair"})]})]});return e.jsxs(e.Fragment,{children:[e.jsx(be.aside,{initial:!1,animate:{width:a?256:72},transition:{duration:.3,ease:"easeInOut"},className:"hidden lg:flex bg-slate-900 text-white h-full p-4 flex-col overflow-y-auto scrollbar-hide",style:{overscrollBehavior:"contain"},children:a?e.jsx(v,{}):e.jsx(b,{})}),e.jsx(Ws,{children:t&&e.jsxs(be.aside,{initial:{x:-280},animate:{x:0},exit:{x:-280},transition:{duration:.3,ease:"easeInOut"},className:"lg:hidden fixed inset-y-0 left-0 bg-slate-900 text-white w-64 p-4 flex flex-col overflow-y-auto scrollbar-hide z-30",style:{overscrollBehavior:"contain"},children:[e.jsx("button",{onClick:s,className:"absolute top-4 right-4 p-2 text-slate-400 hover:text-white hover:bg-slate-800 rounded-lg transition-colors",children:e.jsx(nt,{size:20})}),e.jsx(v,{})]})})]})};class fc{constructor(s){dt(this,"supabaseClient");dt(this,"config");this.config=s,this.supabaseClient=Pi(s.supabaseUrl,s.supabaseAnonKey)}async validateConnection(){const s=Date.now();try{const{data:a,error:r}=await this.supabaseClient.from("information_schema.tables").select("table_name").limit(1),o=Date.now()-s;return r?{isConnected:!1,responseTime:o,error:r.message}:{isConnected:!0,responseTime:o,databaseInfo:{version:"PostgreSQL",name:this.config.databaseName}}}catch(a){return{isConnected:!1,responseTime:Date.now()-s,error:a instanceof Error?a.message:"Erro desconhecido"}}}async performHealthCheck(){const s=await Promise.allSettled([this.checkDatabase(),this.checkAuth(),this.checkStorage(),this.checkRealtime()]),[a,r,o,l]=s.map(p=>p.status==="fulfilled"?p.value:{isConnected:!1,responseTime:0,error:"Falha na verificação"}),c=[a,r,o,l],h=c.filter(p=>p.isConnected).length/c.length*100;let f;return h===100?f="healthy":h>=50?f="degraded":f="unhealthy",{database:a,auth:r,storage:o,realtime:l,overall:{status:f,score:h}}}async checkDatabase(){return this.validateConnection()}async checkAuth(){const s=Date.now();try{const{data:a,error:r}=await this.supabaseClient.auth.getSession(),o=Date.now()-s;return r&&r.message!=="No session found"?{isConnected:!1,responseTime:o,error:r.message}:{isConnected:!0,responseTime:o}}catch(a){return{isConnected:!1,responseTime:Date.now()-s,error:a instanceof Error?a.message:"Erro no serviço de auth"}}}async checkStorage(){const s=Date.now();try{const{data:a,error:r}=await this.supabaseClient.storage.listBuckets(),o=Date.now()-s;return r?{isConnected:!1,responseTime:o,error:r.message}:{isConnected:!0,responseTime:o}}catch(a){return{isConnected:!1,responseTime:Date.now()-s,error:a instanceof Error?a.message:"Erro no serviço de storage"}}}async checkRealtime(){const s=Date.now();try{const a=this.supabaseClient.channel("health-check");return new Promise(r=>{const o=setTimeout(()=>{a.unsubscribe(),r({isConnected:!1,responseTime:Date.now()-s,error:"Timeout na conexão realtime"})},5e3);a.on("presence",{event:"sync"},()=>{clearTimeout(o),a.unsubscribe(),r({isConnected:!0,responseTime:Date.now()-s})}).subscribe(l=>{l==="SUBSCRIBED"&&(clearTimeout(o),a.unsubscribe(),r({isConnected:!0,responseTime:Date.now()-s}))})})}catch(a){return{isConnected:!1,responseTime:Date.now()-s,error:a instanceof Error?a.message:"Erro no serviço de realtime"}}}static async testConfiguration(s){return new fc(s).validateConnection()}static async compareEnvironments(s,a){const[r,o]=await Promise.all([fc.testConfiguration(s),fc.testConfiguration(a)]);return{development:r,production:o,comparison:{bothConnected:r.isConnected&&o.isConnected,performanceDiff:o.responseTime-r.responseTime}}}}const Zn=class Zn{constructor(){dt(this,"environmentManager");dt(this,"connectivityValidator",null);dt(this,"isInitialized",!1);dt(this,"initializationPromise",null);this.environmentManager=pm}static getInstance(){return Zn.instance||(Zn.instance=new Zn),Zn.instance}async initialize(){if(this.initializationPromise)return this.initializationPromise;if(this.isInitialized){const s=await this.environmentManager.getCurrentEnvironment(),a=this.connectivityValidator?await this.connectivityValidator.validateConnection():{isConnected:!1};return{config:s,connectivity:a.isConnected,environment:s.name}}this.initializationPromise=this.performInitialization();try{const s=await this.initializationPromise;return this.isInitialized=!0,s}finally{this.initializationPromise=null}}async performInitialization(){try{console.log("🔧 Inicializando sistema de ambientes...");const s=await this.environmentManager.getCurrentEnvironment();console.log(`📍 Ambiente detectado: ${s.name}`),console.log(`🗄️ Banco de dados: ${s.databaseName}`);const a=s.supabaseUrl&&s.supabaseUrl!=="https://your-project-dev.supabase.co"&&s.supabaseUrl!=="https://your-project-prod.supabase.co"&&s.supabaseAnonKey&&s.supabaseAnonKey!=="your_development_anon_key_here"&&s.supabaseAnonKey!=="your_production_anon_key_here";let r={isConnected:!1,responseTime:0,error:"Configuração não definida"};if(a?(this.connectivityValidator=new fc(s),console.log("🔍 Validando conectividade..."),r=await this.connectivityValidator.validateConnection(),r.isConnected?console.log(`✅ Conectado ao Supabase (${r.responseTime}ms)`):console.warn(`❌ Falha na conectividade: ${r.error}`)):console.warn("⚠️ Configurações do Supabase não definidas. Configure os arquivos .env para conectividade completa."),s.debugMode){const o=await this.environmentManager.getEnvironmentInfo();console.log("🐛 Informações de debug:",o)}return{config:s,connectivity:r.isConnected,environment:s.name}}catch(s){throw console.error("❌ Erro na inicialização do sistema de ambientes:",s),s}}async getConfig(){return this.isInitialized||await this.initialize(),this.environmentManager.getCurrentEnvironment()}async performHealthCheck(){if(!this.connectivityValidator)throw new Error("Sistema não inicializado. Chame initialize() primeiro.");return this.connectivityValidator.performHealthCheck()}switchEnvironment(s){this.environmentManager.switchEnvironment(s),this.connectivityValidator=null,this.isInitialized=!1}async getSystemInfo(){const s=await this.getConfig(),a=await this.environmentManager.getEnvironmentInfo(),r=await this.performHealthCheck();return{environment:s.name,branch:a.branch,database:s.databaseName,connectivity:r,initialized:this.isInitialized}}};dt(Zn,"instance");let y0=Zn;const br=y0.getInstance(),b0=[],v0=t=>{b0.push(t)},_D=async t=>{console.log(`🔄 Executando ${b0.length} callbacks de mudança de ambiente`);for(const s of b0)try{await s(t)}catch(a){console.error("Erro ao executar callback de mudança de ambiente:",a)}},ND={initialize:async()=>{console.log("🔧 Inicializando middleware de ambiente..."),v0(async t=>{console.log(`🔄 Reinicializando Supabase para ambiente: ${t}`),await c3()}),v0(async t=>{console.log(`📝 Ambiente alterado para: ${t}`)}),console.log("✅ Middleware de ambiente inicializado")},switchEnvironment:async t=>{try{console.log(`🔄 Iniciando troca para ambiente: ${t}`),br.switchEnvironment(t),await _D(t),await br.initialize(),console.log(`✅ Troca de ambiente concluída: ${t}`)}catch(s){throw console.error("❌ Erro na troca de ambiente:",s),s}},getCurrentEnvironment:async()=>{try{const t=await br.getConfig();return{name:t.name,databaseName:t.databaseName,debugMode:t.debugMode,isConnected:!0}}catch(t){return console.error("Erro ao obter ambiente atual:",t),null}},performHealthCheck:async()=>{try{return await br.performHealthCheck()}catch(t){throw console.error("Erro no health check:",t),t}}};v0(async t=>{t==="development"?(console.log("🛠️ Modo desenvolvimento ativado"),typeof window<"u"&&(window.__ENVIRONMENT__="development")):(console.log("🚀 Modo produção ativado"),typeof window<"u"&&(window.__ENVIRONMENT__="production"))});const l2=y.createContext(void 0),SD=({children:t})=>{const[s,a]=y.useState(null),[r,o]=y.useState(!0),[l,c]=y.useState(null),[u,h]=y.useState(!1),[f,p]=y.useState(null),[g,v]=y.useState(null),b=async()=>{try{o(!0),c(null),console.log("🚀 Inicializando sistema de ambientes...");const N=await br.initialize();if(a(N.config),h(N.connectivity),v(N.environment),N.connectivity)try{const C=await br.performHealthCheck();p(C)}catch(C){console.warn("Health check inicial falhou:",C)}console.log(`✅ Sistema de ambientes inicializado: ${N.environment}`)}catch(N){const C=N instanceof Error?N.message:"Erro desconhecido na inicialização";console.error("❌ Erro na inicialização do sistema de ambientes:",N),c(C),h(!1)}finally{o(!1)}},_=async N=>{try{o(!0),c(null),await ND.switchEnvironment(N);const C=await br.getConfig();a(C),v(C.name)}catch(C){const S=C instanceof Error?C.message:"Erro na troca de ambiente";console.error("❌ Erro na troca de ambiente:",C),c(S)}finally{o(!1)}},w=async()=>{try{console.log("🔍 Executando health check...");const N=await br.performHealthCheck();p(N),h(N.overall.status!=="unhealthy"),console.log(`✅ Health check concluído: ${N.overall.status} (${N.overall.score}%)`)}catch(N){const C=N instanceof Error?N.message:"Erro no health check";console.error("❌ Erro no health check:",N),c(C),h(!1),p(null)}},E=async()=>{try{return await br.getSystemInfo()}catch(N){throw console.error("❌ Erro ao obter informações do sistema:",N),N}};y.useEffect(()=>{b()},[]);const k={config:s,isLoading:r,error:l,isConnected:u,healthStatus:f,environment:g,initialize:b,switchEnvironment:_,performHealthCheck:w,getSystemInfo:E};return e.jsx(l2.Provider,{value:k,children:t})},jg=()=>{const t=y.useContext(l2);if(t===void 0)throw new Error("useEnvironmentContext deve ser usado dentro de um EnvironmentProvider");return t},ED=({onMenuClick:t,onDesktopMenuToggle:s,isDesktopSidebarOpen:a})=>{const{notifications:r,clearNotifications:o}=Tt(),{environment:l,isConnected:c,config:u}=jg(),[h,f]=Ye.useState(!1),[p,g]=Ye.useState(!1);return e.jsx("header",{className:"bg-white border-b border-gray-200 px-3 sm:px-4 md:px-6 py-3 md:py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[e.jsx("button",{onClick:t,className:"lg:hidden p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors","aria-label":"Abrir menu",children:e.jsx(cO,{size:24})}),e.jsx("button",{onClick:s,className:"hidden lg:block p-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors","aria-label":a?"Esconder menu":"Mostrar menu",title:a?"Esconder menu lateral":"Mostrar menu lateral",children:a?e.jsx(hO,{size:24}):e.jsx(pO,{size:24})}),e.jsxs("h2",{className:"text-sm sm:text-base md:text-xl font-semibold text-gray-800 truncate",children:[e.jsx("span",{className:"hidden md:inline",children:new Date().toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})}),e.jsx("span",{className:"md:hidden",children:new Date().toLocaleDateString("pt-BR",{day:"numeric",month:"short"})})]})]}),e.jsxs("div",{className:"flex items-center space-x-2 sm:space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>g(!p),className:`flex items-center space-x-1 sm:space-x-2 px-2 sm:px-3 py-1 rounded-full text-xs font-medium transition-colors ${l==="production"?"bg-red-100 text-red-700 hover:bg-red-200":"bg-green-100 text-green-700 hover:bg-green-200"}`,children:[e.jsx(hc,{size:12}),e.jsx("span",{className:"hidden sm:inline",children:l==="production"?"PRODUÇÃO":"DESENVOLVIMENTO"}),e.jsx("span",{className:"sm:hidden",children:l==="production"?"PROD":"DEV"}),e.jsx("div",{className:`w-2 h-2 rounded-full ${c?"bg-green-500":"bg-red-500"}`})]}),e.jsx(Ws,{children:p&&e.jsx(be.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:e.jsxs("div",{className:"p-4",children:[e.jsx("h3",{className:"font-semibold text-gray-800 mb-2",children:"Informações do Ambiente"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Ambiente:"}),e.jsx("span",{className:"font-medium",children:l})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Status:"}),e.jsx("span",{className:`font-medium ${c?"text-green-600":"text-red-600"}`,children:c?"Conectado":"Desconectado"})]}),u&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Banco:"}),e.jsx("span",{className:"font-mono text-xs",children:u.databaseName})]})]})]})})})]}),e.jsxs("div",{className:"relative hidden md:block",children:[e.jsx(Xa,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar...",className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent w-32 lg:w-auto"})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("button",{onClick:()=>f(!h),className:"relative p-2 text-gray-600 hover:text-gray-800 transition-colors",children:[e.jsx(yg,{size:20}),r.length>0&&e.jsx("span",{className:"absolute -top-1 -right-1 bg-red-500 text-white text-xs rounded-full w-5 h-5 flex items-center justify-center",children:r.length})]}),e.jsx(Ws,{children:h&&e.jsxs(be.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"absolute right-0 mt-2 w-72 sm:w-80 bg-white rounded-lg shadow-lg border border-gray-200 z-50",children:[e.jsxs("div",{className:"p-4 border-b border-gray-200 flex justify-between items-center",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:"Notificações"}),r.length>0&&e.jsx("button",{onClick:o,className:"text-sm text-blue-600 hover:text-blue-800",children:"Limpar todas"})]}),e.jsx("div",{className:"max-h-64 overflow-y-auto",children:r.length===0?e.jsx("p",{className:"p-4 text-gray-500 text-center",children:"Nenhuma notificação"}):r.map((v,b)=>e.jsx("div",{className:"p-3 border-b border-gray-100 last:border-b-0",children:e.jsx("p",{className:"text-sm text-gray-700",children:v})},b))})]})})]})]})]})})},CD=()=>{const[t,s]=y.useState(!1),[a,r]=y.useState(()=>{const l=localStorage.getItem("desktopSidebarOpen");return l!==null?JSON.parse(l):!0}),o=()=>{r(l=>{const c=!l;return localStorage.setItem("desktopSidebarOpen",JSON.stringify(c)),c})};return e.jsxs("div",{className:"flex h-screen bg-gray-50 overflow-hidden",children:[t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-20 lg:hidden",onClick:()=>s(!1)}),e.jsx(jD,{isOpen:t,onClose:()=>s(!1),isDesktopOpen:a}),e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx(ED,{onMenuClick:()=>s(!0),onDesktopMenuToggle:o,isDesktopSidebarOpen:a}),e.jsx("main",{className:"flex-1 overflow-y-auto p-3 sm:p-4 md:p-6",style:{overscrollBehavior:"none"},children:e.jsx(P4,{})})]})]})},c2=6048e5,TD=864e5,kj=Symbol.for("constructDateFrom");function Ea(t,s){return typeof t=="function"?t(s):t&&typeof t=="object"&&kj in t?t[kj](s):t instanceof Date?new t.constructor(s):new Date(s)}function ls(t,s){return Ea(s||t,t)}function kD(t,s,a){const r=ls(t,a==null?void 0:a.in);return isNaN(s)?Ea(t,NaN):(s&&r.setDate(r.getDate()+s),r)}function AD(t,s,a){const r=ls(t,a==null?void 0:a.in);if(isNaN(s))return Ea(t,NaN);const o=r.getDate(),l=Ea(t,r.getTime());l.setMonth(r.getMonth()+s+1,0);const c=l.getDate();return o>=c?l:(r.setFullYear(l.getFullYear(),l.getMonth(),o),r)}let MD={};function wm(){return MD}function Rc(t,s){var u,h,f,p;const a=wm(),r=(s==null?void 0:s.weekStartsOn)??((h=(u=s==null?void 0:s.locale)==null?void 0:u.options)==null?void 0:h.weekStartsOn)??a.weekStartsOn??((p=(f=a.locale)==null?void 0:f.options)==null?void 0:p.weekStartsOn)??0,o=ls(t,s==null?void 0:s.in),l=o.getDay(),c=(l<r?7:0)+l-r;return o.setDate(o.getDate()-c),o.setHours(0,0,0,0),o}function Yu(t,s){return Rc(t,{...s,weekStartsOn:1})}function d2(t,s){const a=ls(t,s==null?void 0:s.in),r=a.getFullYear(),o=Ea(a,0);o.setFullYear(r+1,0,4),o.setHours(0,0,0,0);const l=Yu(o),c=Ea(a,0);c.setFullYear(r,0,4),c.setHours(0,0,0,0);const u=Yu(c);return a.getTime()>=l.getTime()?r+1:a.getTime()>=u.getTime()?r:r-1}function Aj(t){const s=ls(t),a=new Date(Date.UTC(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));return a.setUTCFullYear(s.getFullYear()),+t-+a}function RD(t,...s){const a=Ea.bind(null,s.find(r=>typeof r=="object"));return s.map(a)}function Li(t,s){const a=ls(t,s==null?void 0:s.in);return a.setHours(0,0,0,0),a}function OD(t,s,a){const[r,o]=RD(a==null?void 0:a.in,t,s),l=Li(r),c=Li(o),u=+l-Aj(l),h=+c-Aj(c);return Math.round((u-h)/TD)}function DD(t,s){const a=d2(t,s),r=Ea(t,0);return r.setFullYear(a,0,4),r.setHours(0,0,0,0),Yu(r)}function PD(t){return t instanceof Date||typeof t=="object"&&Object.prototype.toString.call(t)==="[object Date]"}function zD(t){return!(!PD(t)&&typeof t!="number"||isNaN(+ls(t)))}function Ku(t,s){const a=ls(t,s==null?void 0:s.in);return a.setHours(23,59,59,999),a}function $D(t,s){const a=ls(t,s==null?void 0:s.in);return a.setFullYear(a.getFullYear(),0,1),a.setHours(0,0,0,0),a}const ID={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},LD=(t,s,a)=>{let r;const o=ID[t];return typeof o=="string"?r=o:s===1?r=o.one:r=o.other.replace("{{count}}",s.toString()),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"in "+r:r+" ago":r};function Ai(t){return(s={})=>{const a=s.width?String(s.width):t.defaultWidth;return t.formats[a]||t.formats[t.defaultWidth]}}const UD={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},BD={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},VD={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},qD={date:Ai({formats:UD,defaultWidth:"full"}),time:Ai({formats:BD,defaultWidth:"full"}),dateTime:Ai({formats:VD,defaultWidth:"full"})},FD={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},HD=(t,s,a,r)=>FD[t];function Ua(t){return(s,a)=>{const r=a!=null&&a.context?String(a.context):"standalone";let o;if(r==="formatting"&&t.formattingValues){const c=t.defaultFormattingWidth||t.defaultWidth,u=a!=null&&a.width?String(a.width):c;o=t.formattingValues[u]||t.formattingValues[c]}else{const c=t.defaultWidth,u=a!=null&&a.width?String(a.width):t.defaultWidth;o=t.values[u]||t.values[c]}const l=t.argumentCallback?t.argumentCallback(s):s;return o[l]}}const GD={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},ZD={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},WD={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},YD={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},KD={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},XD={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},QD=(t,s)=>{const a=Number(t),r=a%100;if(r>20||r<10)switch(r%10){case 1:return a+"st";case 2:return a+"nd";case 3:return a+"rd"}return a+"th"},JD={ordinalNumber:QD,era:Ua({values:GD,defaultWidth:"wide"}),quarter:Ua({values:ZD,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ua({values:WD,defaultWidth:"wide"}),day:Ua({values:YD,defaultWidth:"wide"}),dayPeriod:Ua({values:KD,defaultWidth:"wide",formattingValues:XD,defaultFormattingWidth:"wide"})};function Ba(t){return(s,a={})=>{const r=a.width,o=r&&t.matchPatterns[r]||t.matchPatterns[t.defaultMatchWidth],l=s.match(o);if(!l)return null;const c=l[0],u=r&&t.parsePatterns[r]||t.parsePatterns[t.defaultParseWidth],h=Array.isArray(u)?tP(u,g=>g.test(c)):eP(u,g=>g.test(c));let f;f=t.valueCallback?t.valueCallback(h):h,f=a.valueCallback?a.valueCallback(f):f;const p=s.slice(c.length);return{value:f,rest:p}}}function eP(t,s){for(const a in t)if(Object.prototype.hasOwnProperty.call(t,a)&&s(t[a]))return a}function tP(t,s){for(let a=0;a<t.length;a++)if(s(t[a]))return a}function u2(t){return(s,a={})=>{const r=s.match(t.matchPattern);if(!r)return null;const o=r[0],l=s.match(t.parsePattern);if(!l)return null;let c=t.valueCallback?t.valueCallback(l[0]):l[0];c=a.valueCallback?a.valueCallback(c):c;const u=s.slice(o.length);return{value:c,rest:u}}}const sP=/^(\d+)(th|st|nd|rd)?/i,aP=/\d+/i,rP={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},nP={any:[/^b/i,/^(a|c)/i]},oP={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},iP={any:[/1/i,/2/i,/3/i,/4/i]},lP={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},cP={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},dP={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},uP={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},mP={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},hP={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},fP={ordinalNumber:u2({matchPattern:sP,parsePattern:aP,valueCallback:t=>parseInt(t,10)}),era:Ba({matchPatterns:rP,defaultMatchWidth:"wide",parsePatterns:nP,defaultParseWidth:"any"}),quarter:Ba({matchPatterns:oP,defaultMatchWidth:"wide",parsePatterns:iP,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ba({matchPatterns:lP,defaultMatchWidth:"wide",parsePatterns:cP,defaultParseWidth:"any"}),day:Ba({matchPatterns:dP,defaultMatchWidth:"wide",parsePatterns:uP,defaultParseWidth:"any"}),dayPeriod:Ba({matchPatterns:mP,defaultMatchWidth:"any",parsePatterns:hP,defaultParseWidth:"any"})},pP={code:"en-US",formatDistance:LD,formatLong:qD,formatRelative:HD,localize:JD,match:fP,options:{weekStartsOn:0,firstWeekContainsDate:1}};function gP(t,s){const a=ls(t,s==null?void 0:s.in);return OD(a,$D(a))+1}function xP(t,s){const a=ls(t,s==null?void 0:s.in),r=+Yu(a)-+DD(a);return Math.round(r/c2)+1}function m2(t,s){var p,g,v,b;const a=ls(t,s==null?void 0:s.in),r=a.getFullYear(),o=wm(),l=(s==null?void 0:s.firstWeekContainsDate)??((g=(p=s==null?void 0:s.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??o.firstWeekContainsDate??((b=(v=o.locale)==null?void 0:v.options)==null?void 0:b.firstWeekContainsDate)??1,c=Ea((s==null?void 0:s.in)||t,0);c.setFullYear(r+1,0,l),c.setHours(0,0,0,0);const u=Rc(c,s),h=Ea((s==null?void 0:s.in)||t,0);h.setFullYear(r,0,l),h.setHours(0,0,0,0);const f=Rc(h,s);return+a>=+u?r+1:+a>=+f?r:r-1}function yP(t,s){var u,h,f,p;const a=wm(),r=(s==null?void 0:s.firstWeekContainsDate)??((h=(u=s==null?void 0:s.locale)==null?void 0:u.options)==null?void 0:h.firstWeekContainsDate)??a.firstWeekContainsDate??((p=(f=a.locale)==null?void 0:f.options)==null?void 0:p.firstWeekContainsDate)??1,o=m2(t,s),l=Ea((s==null?void 0:s.in)||t,0);return l.setFullYear(o,0,r),l.setHours(0,0,0,0),Rc(l,s)}function bP(t,s){const a=ls(t,s==null?void 0:s.in),r=+Rc(a,s)-+yP(a,s);return Math.round(r/c2)+1}function ft(t,s){const a=t<0?"-":"",r=Math.abs(t).toString().padStart(s,"0");return a+r}const rn={y(t,s){const a=t.getFullYear(),r=a>0?a:1-a;return ft(s==="yy"?r%100:r,s.length)},M(t,s){const a=t.getMonth();return s==="M"?String(a+1):ft(a+1,2)},d(t,s){return ft(t.getDate(),s.length)},a(t,s){const a=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.toUpperCase();case"aaa":return a;case"aaaaa":return a[0];case"aaaa":default:return a==="am"?"a.m.":"p.m."}},h(t,s){return ft(t.getHours()%12||12,s.length)},H(t,s){return ft(t.getHours(),s.length)},m(t,s){return ft(t.getMinutes(),s.length)},s(t,s){return ft(t.getSeconds(),s.length)},S(t,s){const a=s.length,r=t.getMilliseconds(),o=Math.trunc(r*Math.pow(10,a-3));return ft(o,s.length)}},ui={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Mj={G:function(t,s,a){const r=t.getFullYear()>0?1:0;switch(s){case"G":case"GG":case"GGG":return a.era(r,{width:"abbreviated"});case"GGGGG":return a.era(r,{width:"narrow"});case"GGGG":default:return a.era(r,{width:"wide"})}},y:function(t,s,a){if(s==="yo"){const r=t.getFullYear(),o=r>0?r:1-r;return a.ordinalNumber(o,{unit:"year"})}return rn.y(t,s)},Y:function(t,s,a,r){const o=m2(t,r),l=o>0?o:1-o;if(s==="YY"){const c=l%100;return ft(c,2)}return s==="Yo"?a.ordinalNumber(l,{unit:"year"}):ft(l,s.length)},R:function(t,s){const a=d2(t);return ft(a,s.length)},u:function(t,s){const a=t.getFullYear();return ft(a,s.length)},Q:function(t,s,a){const r=Math.ceil((t.getMonth()+1)/3);switch(s){case"Q":return String(r);case"QQ":return ft(r,2);case"Qo":return a.ordinalNumber(r,{unit:"quarter"});case"QQQ":return a.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return a.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return a.quarter(r,{width:"wide",context:"formatting"})}},q:function(t,s,a){const r=Math.ceil((t.getMonth()+1)/3);switch(s){case"q":return String(r);case"qq":return ft(r,2);case"qo":return a.ordinalNumber(r,{unit:"quarter"});case"qqq":return a.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return a.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return a.quarter(r,{width:"wide",context:"standalone"})}},M:function(t,s,a){const r=t.getMonth();switch(s){case"M":case"MM":return rn.M(t,s);case"Mo":return a.ordinalNumber(r+1,{unit:"month"});case"MMM":return a.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return a.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return a.month(r,{width:"wide",context:"formatting"})}},L:function(t,s,a){const r=t.getMonth();switch(s){case"L":return String(r+1);case"LL":return ft(r+1,2);case"Lo":return a.ordinalNumber(r+1,{unit:"month"});case"LLL":return a.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return a.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return a.month(r,{width:"wide",context:"standalone"})}},w:function(t,s,a,r){const o=bP(t,r);return s==="wo"?a.ordinalNumber(o,{unit:"week"}):ft(o,s.length)},I:function(t,s,a){const r=xP(t);return s==="Io"?a.ordinalNumber(r,{unit:"week"}):ft(r,s.length)},d:function(t,s,a){return s==="do"?a.ordinalNumber(t.getDate(),{unit:"date"}):rn.d(t,s)},D:function(t,s,a){const r=gP(t);return s==="Do"?a.ordinalNumber(r,{unit:"dayOfYear"}):ft(r,s.length)},E:function(t,s,a){const r=t.getDay();switch(s){case"E":case"EE":case"EEE":return a.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return a.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return a.day(r,{width:"short",context:"formatting"});case"EEEE":default:return a.day(r,{width:"wide",context:"formatting"})}},e:function(t,s,a,r){const o=t.getDay(),l=(o-r.weekStartsOn+8)%7||7;switch(s){case"e":return String(l);case"ee":return ft(l,2);case"eo":return a.ordinalNumber(l,{unit:"day"});case"eee":return a.day(o,{width:"abbreviated",context:"formatting"});case"eeeee":return a.day(o,{width:"narrow",context:"formatting"});case"eeeeee":return a.day(o,{width:"short",context:"formatting"});case"eeee":default:return a.day(o,{width:"wide",context:"formatting"})}},c:function(t,s,a,r){const o=t.getDay(),l=(o-r.weekStartsOn+8)%7||7;switch(s){case"c":return String(l);case"cc":return ft(l,s.length);case"co":return a.ordinalNumber(l,{unit:"day"});case"ccc":return a.day(o,{width:"abbreviated",context:"standalone"});case"ccccc":return a.day(o,{width:"narrow",context:"standalone"});case"cccccc":return a.day(o,{width:"short",context:"standalone"});case"cccc":default:return a.day(o,{width:"wide",context:"standalone"})}},i:function(t,s,a){const r=t.getDay(),o=r===0?7:r;switch(s){case"i":return String(o);case"ii":return ft(o,s.length);case"io":return a.ordinalNumber(o,{unit:"day"});case"iii":return a.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return a.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return a.day(r,{width:"short",context:"formatting"});case"iiii":default:return a.day(r,{width:"wide",context:"formatting"})}},a:function(t,s,a){const o=t.getHours()/12>=1?"pm":"am";switch(s){case"a":case"aa":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"aaa":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return a.dayPeriod(o,{width:"narrow",context:"formatting"});case"aaaa":default:return a.dayPeriod(o,{width:"wide",context:"formatting"})}},b:function(t,s,a){const r=t.getHours();let o;switch(r===12?o=ui.noon:r===0?o=ui.midnight:o=r/12>=1?"pm":"am",s){case"b":case"bb":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"bbb":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return a.dayPeriod(o,{width:"narrow",context:"formatting"});case"bbbb":default:return a.dayPeriod(o,{width:"wide",context:"formatting"})}},B:function(t,s,a){const r=t.getHours();let o;switch(r>=17?o=ui.evening:r>=12?o=ui.afternoon:r>=4?o=ui.morning:o=ui.night,s){case"B":case"BB":case"BBB":return a.dayPeriod(o,{width:"abbreviated",context:"formatting"});case"BBBBB":return a.dayPeriod(o,{width:"narrow",context:"formatting"});case"BBBB":default:return a.dayPeriod(o,{width:"wide",context:"formatting"})}},h:function(t,s,a){if(s==="ho"){let r=t.getHours()%12;return r===0&&(r=12),a.ordinalNumber(r,{unit:"hour"})}return rn.h(t,s)},H:function(t,s,a){return s==="Ho"?a.ordinalNumber(t.getHours(),{unit:"hour"}):rn.H(t,s)},K:function(t,s,a){const r=t.getHours()%12;return s==="Ko"?a.ordinalNumber(r,{unit:"hour"}):ft(r,s.length)},k:function(t,s,a){let r=t.getHours();return r===0&&(r=24),s==="ko"?a.ordinalNumber(r,{unit:"hour"}):ft(r,s.length)},m:function(t,s,a){return s==="mo"?a.ordinalNumber(t.getMinutes(),{unit:"minute"}):rn.m(t,s)},s:function(t,s,a){return s==="so"?a.ordinalNumber(t.getSeconds(),{unit:"second"}):rn.s(t,s)},S:function(t,s){return rn.S(t,s)},X:function(t,s,a){const r=t.getTimezoneOffset();if(r===0)return"Z";switch(s){case"X":return Oj(r);case"XXXX":case"XX":return Fn(r);case"XXXXX":case"XXX":default:return Fn(r,":")}},x:function(t,s,a){const r=t.getTimezoneOffset();switch(s){case"x":return Oj(r);case"xxxx":case"xx":return Fn(r);case"xxxxx":case"xxx":default:return Fn(r,":")}},O:function(t,s,a){const r=t.getTimezoneOffset();switch(s){case"O":case"OO":case"OOO":return"GMT"+Rj(r,":");case"OOOO":default:return"GMT"+Fn(r,":")}},z:function(t,s,a){const r=t.getTimezoneOffset();switch(s){case"z":case"zz":case"zzz":return"GMT"+Rj(r,":");case"zzzz":default:return"GMT"+Fn(r,":")}},t:function(t,s,a){const r=Math.trunc(+t/1e3);return ft(r,s.length)},T:function(t,s,a){return ft(+t,s.length)}};function Rj(t,s=""){const a=t>0?"-":"+",r=Math.abs(t),o=Math.trunc(r/60),l=r%60;return l===0?a+String(o):a+String(o)+s+ft(l,2)}function Oj(t,s){return t%60===0?(t>0?"-":"+")+ft(Math.abs(t)/60,2):Fn(t,s)}function Fn(t,s=""){const a=t>0?"-":"+",r=Math.abs(t),o=ft(Math.trunc(r/60),2),l=ft(r%60,2);return a+o+s+l}const Dj=(t,s)=>{switch(t){case"P":return s.date({width:"short"});case"PP":return s.date({width:"medium"});case"PPP":return s.date({width:"long"});case"PPPP":default:return s.date({width:"full"})}},h2=(t,s)=>{switch(t){case"p":return s.time({width:"short"});case"pp":return s.time({width:"medium"});case"ppp":return s.time({width:"long"});case"pppp":default:return s.time({width:"full"})}},vP=(t,s)=>{const a=t.match(/(P+)(p+)?/)||[],r=a[1],o=a[2];if(!o)return Dj(t,s);let l;switch(r){case"P":l=s.dateTime({width:"short"});break;case"PP":l=s.dateTime({width:"medium"});break;case"PPP":l=s.dateTime({width:"long"});break;case"PPPP":default:l=s.dateTime({width:"full"});break}return l.replace("{{date}}",Dj(r,s)).replace("{{time}}",h2(o,s))},wP={p:h2,P:vP},jP=/^D+$/,_P=/^Y+$/,NP=["D","DD","YY","YYYY"];function SP(t){return jP.test(t)}function EP(t){return _P.test(t)}function CP(t,s,a){const r=TP(t,s,a);if(console.warn(r),NP.includes(t))throw new RangeError(r)}function TP(t,s,a){const r=t[0]==="Y"?"years":"days of the month";return`Use \`${t.toLowerCase()}\` instead of \`${t}\` (in \`${s}\`) for formatting ${r} to the input \`${a}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const kP=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,AP=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,MP=/^'([^]*?)'?$/,RP=/''/g,OP=/[a-zA-Z]/;function wt(t,s,a){var p,g,v,b,_,w,E,k;const r=wm(),o=(a==null?void 0:a.locale)??r.locale??pP,l=(a==null?void 0:a.firstWeekContainsDate)??((g=(p=a==null?void 0:a.locale)==null?void 0:p.options)==null?void 0:g.firstWeekContainsDate)??r.firstWeekContainsDate??((b=(v=r.locale)==null?void 0:v.options)==null?void 0:b.firstWeekContainsDate)??1,c=(a==null?void 0:a.weekStartsOn)??((w=(_=a==null?void 0:a.locale)==null?void 0:_.options)==null?void 0:w.weekStartsOn)??r.weekStartsOn??((k=(E=r.locale)==null?void 0:E.options)==null?void 0:k.weekStartsOn)??0,u=ls(t,a==null?void 0:a.in);if(!zD(u))throw new RangeError("Invalid time value");let h=s.match(AP).map(N=>{const C=N[0];if(C==="p"||C==="P"){const S=wP[C];return S(N,o.formatLong)}return N}).join("").match(kP).map(N=>{if(N==="''")return{isToken:!1,value:"'"};const C=N[0];if(C==="'")return{isToken:!1,value:DP(N)};if(Mj[C])return{isToken:!0,value:N};if(C.match(OP))throw new RangeError("Format string contains an unescaped latin alphabet character `"+C+"`");return{isToken:!1,value:N}});o.localize.preprocessor&&(h=o.localize.preprocessor(u,h));const f={firstWeekContainsDate:l,weekStartsOn:c,locale:o};return h.map(N=>{if(!N.isToken)return N.value;const C=N.value;(!(a!=null&&a.useAdditionalWeekYearTokens)&&EP(C)||!(a!=null&&a.useAdditionalDayOfYearTokens)&&SP(C))&&CP(C,s,String(t));const S=Mj[C[0]];return S(u,C,o.localize,f)}).join("")}function DP(t){const s=t.match(MP);return s?s[1].replace(RP,"'"):t}function PP(t,s){return+ls(t)>+ls(s)}function Xu(t,s,a){const r=+ls(t,a==null?void 0:a.in),[o,l]=[+ls(s.start,a==null?void 0:a.in),+ls(s.end,a==null?void 0:a.in)].sort((c,u)=>c-u);return r>=o&&r<=l}function eo(t,s,a){return kD(t,-s,a)}function zP(t,s,a){return AD(t,-1,a)}const $P={lessThanXSeconds:{one:"menos de um segundo",other:"menos de {{count}} segundos"},xSeconds:{one:"1 segundo",other:"{{count}} segundos"},halfAMinute:"meio minuto",lessThanXMinutes:{one:"menos de um minuto",other:"menos de {{count}} minutos"},xMinutes:{one:"1 minuto",other:"{{count}} minutos"},aboutXHours:{one:"cerca de 1 hora",other:"cerca de {{count}} horas"},xHours:{one:"1 hora",other:"{{count}} horas"},xDays:{one:"1 dia",other:"{{count}} dias"},aboutXWeeks:{one:"cerca de 1 semana",other:"cerca de {{count}} semanas"},xWeeks:{one:"1 semana",other:"{{count}} semanas"},aboutXMonths:{one:"cerca de 1 mês",other:"cerca de {{count}} meses"},xMonths:{one:"1 mês",other:"{{count}} meses"},aboutXYears:{one:"cerca de 1 ano",other:"cerca de {{count}} anos"},xYears:{one:"1 ano",other:"{{count}} anos"},overXYears:{one:"mais de 1 ano",other:"mais de {{count}} anos"},almostXYears:{one:"quase 1 ano",other:"quase {{count}} anos"}},IP=(t,s,a)=>{let r;const o=$P[t];return typeof o=="string"?r=o:s===1?r=o.one:r=o.other.replace("{{count}}",String(s)),a!=null&&a.addSuffix?a.comparison&&a.comparison>0?"em "+r:"há "+r:r},LP={full:"EEEE, d 'de' MMMM 'de' y",long:"d 'de' MMMM 'de' y",medium:"d MMM y",short:"dd/MM/yyyy"},UP={full:"HH:mm:ss zzzz",long:"HH:mm:ss z",medium:"HH:mm:ss",short:"HH:mm"},BP={full:"{{date}} 'às' {{time}}",long:"{{date}} 'às' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},VP={date:Ai({formats:LP,defaultWidth:"full"}),time:Ai({formats:UP,defaultWidth:"full"}),dateTime:Ai({formats:BP,defaultWidth:"full"})},qP={lastWeek:t=>{const s=t.getDay();return"'"+(s===0||s===6?"último":"última")+"' eeee 'às' p"},yesterday:"'ontem às' p",today:"'hoje às' p",tomorrow:"'amanhã às' p",nextWeek:"eeee 'às' p",other:"P"},FP=(t,s,a,r)=>{const o=qP[t];return typeof o=="function"?o(s):o},HP={narrow:["AC","DC"],abbreviated:["AC","DC"],wide:["antes de cristo","depois de cristo"]},GP={narrow:["1","2","3","4"],abbreviated:["T1","T2","T3","T4"],wide:["1º trimestre","2º trimestre","3º trimestre","4º trimestre"]},ZP={narrow:["j","f","m","a","m","j","j","a","s","o","n","d"],abbreviated:["jan","fev","mar","abr","mai","jun","jul","ago","set","out","nov","dez"],wide:["janeiro","fevereiro","março","abril","maio","junho","julho","agosto","setembro","outubro","novembro","dezembro"]},WP={narrow:["D","S","T","Q","Q","S","S"],short:["dom","seg","ter","qua","qui","sex","sab"],abbreviated:["domingo","segunda","terça","quarta","quinta","sexta","sábado"],wide:["domingo","segunda-feira","terça-feira","quarta-feira","quinta-feira","sexta-feira","sábado"]},YP={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"manhã",afternoon:"tarde",evening:"tarde",night:"noite"}},KP={narrow:{am:"a",pm:"p",midnight:"mn",noon:"md",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"},abbreviated:{am:"AM",pm:"PM",midnight:"meia-noite",noon:"meio-dia",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"},wide:{am:"a.m.",pm:"p.m.",midnight:"meia-noite",noon:"meio-dia",morning:"da manhã",afternoon:"da tarde",evening:"da tarde",night:"da noite"}},XP=(t,s)=>{const a=Number(t);return(s==null?void 0:s.unit)==="week"?a+"ª":a+"º"},QP={ordinalNumber:XP,era:Ua({values:HP,defaultWidth:"wide"}),quarter:Ua({values:GP,defaultWidth:"wide",argumentCallback:t=>t-1}),month:Ua({values:ZP,defaultWidth:"wide"}),day:Ua({values:WP,defaultWidth:"wide"}),dayPeriod:Ua({values:YP,defaultWidth:"wide",formattingValues:KP,defaultFormattingWidth:"wide"})},JP=/^(\d+)[ºªo]?/i,e8=/\d+/i,t8={narrow:/^(ac|dc|a|d)/i,abbreviated:/^(a\.?\s?c\.?|d\.?\s?c\.?)/i,wide:/^(antes de cristo|depois de cristo)/i},s8={any:[/^ac/i,/^dc/i],wide:[/^antes de cristo/i,/^depois de cristo/i]},a8={narrow:/^[1234]/i,abbreviated:/^T[1234]/i,wide:/^[1234](º)? trimestre/i},r8={any:[/1/i,/2/i,/3/i,/4/i]},n8={narrow:/^[jfmajsond]/i,abbreviated:/^(jan|fev|mar|abr|mai|jun|jul|ago|set|out|nov|dez)/i,wide:/^(janeiro|fevereiro|março|abril|maio|junho|julho|agosto|setembro|outubro|novembro|dezembro)/i},o8={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^fev/i,/^mar/i,/^abr/i,/^mai/i,/^jun/i,/^jul/i,/^ago/i,/^set/i,/^out/i,/^nov/i,/^dez/i]},i8={narrow:/^(dom|[23456]ª?|s[aá]b)/i,short:/^(dom|[23456]ª?|s[aá]b)/i,abbreviated:/^(dom|seg|ter|qua|qui|sex|s[aá]b)/i,wide:/^(domingo|(segunda|ter[cç]a|quarta|quinta|sexta)([- ]feira)?|s[aá]bado)/i},l8={short:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[aá]/i],narrow:[/^d/i,/^2/i,/^3/i,/^4/i,/^5/i,/^6/i,/^s[aá]/i],any:[/^d/i,/^seg/i,/^t/i,/^qua/i,/^qui/i,/^sex/i,/^s[aá]b/i]},c8={narrow:/^(a|p|mn|md|(da) (manhã|tarde|noite))/i,any:/^([ap]\.?\s?m\.?|meia[-\s]noite|meio[-\s]dia|(da) (manhã|tarde|noite))/i},d8={any:{am:/^a/i,pm:/^p/i,midnight:/^mn|^meia[-\s]noite/i,noon:/^md|^meio[-\s]dia/i,morning:/manhã/i,afternoon:/tarde/i,evening:/tarde/i,night:/noite/i}},u8={ordinalNumber:u2({matchPattern:JP,parsePattern:e8,valueCallback:t=>parseInt(t,10)}),era:Ba({matchPatterns:t8,defaultMatchWidth:"wide",parsePatterns:s8,defaultParseWidth:"any"}),quarter:Ba({matchPatterns:a8,defaultMatchWidth:"wide",parsePatterns:r8,defaultParseWidth:"any",valueCallback:t=>t+1}),month:Ba({matchPatterns:n8,defaultMatchWidth:"wide",parsePatterns:o8,defaultParseWidth:"any"}),day:Ba({matchPatterns:i8,defaultMatchWidth:"wide",parsePatterns:l8,defaultParseWidth:"any"}),dayPeriod:Ba({matchPatterns:c8,defaultMatchWidth:"any",parsePatterns:d8,defaultParseWidth:"any"})},Wt={code:"pt-BR",formatDistance:IP,formatLong:VP,formatRelative:FP,localize:QP,match:u8,options:{weekStartsOn:0,firstWeekContainsDate:1}},m8=()=>{const t=Xs(),{orders:s,inventory:a,notifications:r}=Tt(),{user:o}=jt(),l=s.filter(g=>g.status==="delivered"&&wt(g.updatedAt,"yyyy-MM-dd")===wt(new Date,"yyyy-MM-dd")),c=l.reduce((g,v)=>g+v.total,0),u=s.filter(g=>g.status==="pending").length,h=a.filter(g=>g.currentStock<=g.minStock).length,f=(o==null?void 0:o.email)==="demo@clubmanager.com",p=[{title:"Faturamento Hoje",value:`R$ ${c.toFixed(2)}`,icon:Ut,color:"text-green-600",bgColor:"bg-green-100"},{title:"Pedidos Pendentes",value:u,icon:Bt,color:"text-orange-600",bgColor:"bg-orange-100"},{title:"Vendas Hoje",value:l.length,icon:hn,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Estoque Baixo",value:h,icon:yt,color:"text-red-600",bgColor:"bg-red-100"}];return e.jsxs("div",{className:"space-y-6",children:[e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:["Dashboard Executivo",f&&e.jsx("span",{className:"ml-3 text-lg text-green-600 font-normal",children:"🚀 Modo Demo Ativo"})]}),e.jsx("p",{className:"text-gray-600",children:"Visão geral das operações do clube"})]}),f&&e.jsxs(be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.3},className:"bg-gradient-to-r from-green-500 to-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2",children:[e.jsx(Tr,{size:16}),e.jsx("span",{className:"text-sm font-medium",children:"Teste todas as funcionalidades!"})]})]})}),f&&e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},className:"bg-gradient-to-r from-blue-50 to-green-50 border border-blue-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"p-3 bg-blue-600 rounded-full",children:e.jsx(Tr,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"🎯 Bem-vindo ao ClubManager Demo!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Explore todos os módulos e funcionalidades do sistema. Você pode criar pedidos, gerenciar a cozinha, controlar estoque e muito mais!"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(fs,{to:"/bar",className:"flex items-center justify-between p-3 bg-white rounded-lg border border-blue-200 hover:border-blue-400 transition-colors group",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ac,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"font-medium text-gray-800",children:"Testar Módulo Bar"})]}),e.jsx(no,{className:"w-4 h-4 text-gray-400 group-hover:text-blue-600 transition-colors"})]}),e.jsxs(fs,{to:"/kitchen",className:"flex items-center justify-between p-3 bg-white rounded-lg border border-green-200 hover:border-green-400 transition-colors group",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(kc,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-medium text-gray-800",children:"Testar Módulo Cozinha"})]}),e.jsx(no,{className:"w-4 h-4 text-gray-400 group-hover:text-green-600 transition-colors"})]})]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:p.map((g,v)=>{const b=g.title==="Estoque Baixo";return e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:v*.1},className:`bg-white rounded-lg shadow-md p-6 ${b?"cursor-pointer hover:shadow-lg transition-shadow":""}`,onClick:b?()=>t("/inventory/estoque-baixo"):void 0,whileHover:b?{scale:1.02}:{},whileTap:b?{scale:.98}:{},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:g.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:g.value})]}),e.jsx("div",{className:`p-3 rounded-full ${g.bgColor}`,children:e.jsx(g.icon,{className:`w-6 h-6 ${g.color}`})})]})},g.title)})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(be.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.2},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Pedidos Recentes"}),e.jsxs("div",{className:"space-y-3",children:[s.slice(0,5).map(g=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:g.tableNumber?`Mesa ${g.tableNumber}`:"Balcão"}),e.jsx("p",{className:"text-sm text-gray-600",children:wt(g.createdAt,"HH:mm",{locale:Wt})})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium text-gray-800",children:["R$ ",g.total.toFixed(2)]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${g.status==="pending"?"bg-yellow-100 text-yellow-800":g.status==="preparing"?"bg-blue-100 text-blue-800":g.status==="ready"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:g.status==="pending"?"Pendente":g.status==="preparing"?"Preparando":g.status==="ready"?"Pronto":"Entregue"})]})]},g.id)),s.length===0&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-500 mb-2",children:"Nenhum pedido ainda"}),f&&e.jsx(fs,{to:"/bar",className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Criar primeiro pedido →"})]})]})]}),e.jsxs(be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.5,delay:.3},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Alertas de Estoque"}),e.jsxs("div",{className:"space-y-3",children:[a.filter(g=>g.currentStock<=g.minStock).slice(0,5).map(g=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg border border-red-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:g.name}),e.jsx("p",{className:"text-sm text-gray-600",children:g.category})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium text-red-600",children:[g.currentStock," ",g.unit]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Mín: ",g.minStock]})]})]},g.id)),a.filter(g=>g.currentStock<=g.minStock).length===0&&e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Todos os itens com estoque adequado"})]})]})]}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.4},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Módulos Disponíveis"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs(fs,{to:"/bar",className:"p-4 border border-gray-200 rounded-lg hover:border-blue-300 transition-colors cursor-pointer group",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ac,{className:"w-5 h-5 text-blue-600"}),e.jsx("h4",{className:"font-medium text-gray-800 group-hover:text-blue-600 transition-colors",children:"Módulo Bar"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Gestão completa de pedidos, comandas e vendas do bar"})]}),e.jsxs(fs,{to:"/cash",className:"p-4 border border-gray-200 rounded-lg hover:border-green-300 transition-colors cursor-pointer group",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ut,{className:"w-5 h-5 text-green-600"}),e.jsx("h4",{className:"font-medium text-gray-800 group-hover:text-green-600 transition-colors",children:"Gestão de Caixa"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Controle financeiro, fechamento de caixa e relatórios"})]}),e.jsxs(fs,{to:"/kitchen",className:"p-4 border border-gray-200 rounded-lg hover:border-orange-300 transition-colors cursor-pointer group",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(kc,{className:"w-5 h-5 text-orange-600"}),e.jsx("h4",{className:"font-medium text-gray-800 group-hover:text-orange-600 transition-colors",children:"Módulo Cozinha"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Controle de cardápio, pedidos e gestão da cozinha"})]}),e.jsxs(fs,{to:"/admin/funcionarios",className:"p-4 border border-gray-200 rounded-lg hover:border-purple-300 transition-colors cursor-pointer group",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ns,{className:"w-5 h-5 text-purple-600"}),e.jsx("h4",{className:"font-medium text-gray-800 group-hover:text-purple-600 transition-colors",children:"Gestão de Funcionários"})]}),e.jsx("p",{className:"text-sm text-gray-600",children:"Cadastro e credenciais de funcionários"})]})]})]})]})},h8=y.memo(({stat:t,index:s,onClick:a})=>{const r=!!a;return e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:s*.05},className:`bg-white rounded-lg shadow-md p-6 ${r?"cursor-pointer hover:shadow-lg transition-shadow":""}`,onClick:a,whileHover:r?{scale:1.02}:{},whileTap:r?{scale:.98}:{},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:t.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:t.value})]}),e.jsx("div",{className:`p-3 rounded-full ${t.bgColor}`,children:e.jsx(t.icon,{className:`w-6 h-6 ${t.color}`})})]})})}),f8=y.memo(({order:t})=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:t.tableNumber?`Mesa ${t.tableNumber}`:"Balcão"}),e.jsx("p",{className:"text-sm text-gray-600",children:wt(t.createdAt,"HH:mm",{locale:Wt})})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium text-gray-800",children:["R$ ",t.total.toFixed(2)]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${t.status==="pending"?"bg-yellow-100 text-yellow-800":t.status==="preparing"?"bg-blue-100 text-blue-800":t.status==="ready"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:t.status==="pending"?"Pendente":t.status==="preparing"?"Preparando":t.status==="ready"?"Pronto":"Entregue"})]})]})),p8=y.memo(({item:t})=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg border border-red-200",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:t.name}),e.jsx("p",{className:"text-sm text-gray-600",children:t.category||"Sem categoria"})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-medium text-red-600",children:[t.currentStock," ",t.unit]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Mín: ",t.minStock]})]})]})),g8=y.memo(({module:t})=>e.jsxs(fs,{to:t.path,className:"p-4 border border-gray-200 rounded-lg hover:border-blue-300 transition-colors cursor-pointer group",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(t.icon,{className:`w-5 h-5 ${t.color}`}),e.jsx("h4",{className:`font-medium text-gray-800 group-hover:${t.hoverColor} transition-colors`,children:t.name})]}),e.jsx("p",{className:"text-sm text-gray-600",children:t.description})]})),x8=()=>{const t=Xs(),{orders:s,inventory:a,notifications:r}=Tt(),o=y.useMemo(()=>{const g=new Date().toISOString().split("T")[0],v=s.filter(b=>b.status==="delivered"&&b.updatedAt.toISOString().split("T")[0]===g);return{todayRevenue:v.reduce((b,_)=>b+_.total,0),pendingOrders:s.filter(b=>b.status==="pending").length,todaySales:v.length,lowStockItems:a.filter(b=>b.currentStock<=b.minStock).length}},[s,a]),{user:l}=jt(),c=(l==null?void 0:l.email)==="demo@clubmanager.com",u=y.useMemo(()=>[{title:"Faturamento Hoje",value:`R$ ${o.todayRevenue.toFixed(2)}`,icon:Ut,color:"text-green-600",bgColor:"bg-green-100"},{title:"Pedidos Pendentes",value:o.pendingOrders,icon:Bt,color:"text-orange-600",bgColor:"bg-orange-100"},{title:"Vendas Hoje",value:o.todaySales,icon:hn,color:"text-blue-600",bgColor:"bg-blue-100"},{title:"Estoque Baixo",value:o.lowStockItems,icon:yt,color:"text-red-600",bgColor:"bg-red-100"}],[o]),h=y.useMemo(()=>s.slice(0,5),[s]),f=y.useMemo(()=>a.filter(g=>g.currentStock<=g.minStock).slice(0,5),[a]),p=y.useMemo(()=>[{name:"Módulo Bar",description:"Gestão completa de pedidos, comandas e vendas do bar",icon:Ac,color:"text-blue-600",hoverColor:"text-blue-600",path:"/bar"},{name:"Gestão de Caixa",description:"Controle financeiro, fechamento de caixa e relatórios",icon:Ut,color:"text-green-600",hoverColor:"text-green-600",path:"/cash"},{name:"Módulo Cozinha",description:"Controle de cardápio, pedidos e gestão da cozinha",icon:kc,color:"text-orange-600",hoverColor:"text-orange-600",path:"/kitchen"},{name:"Módulos Futuros",description:"Quadras, Piscina, Eventos, RH e mais",icon:Ka,color:"text-gray-400",hoverColor:"text-gray-500",path:"#"}],[]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:["Dashboard Executivo",c&&e.jsx("span",{className:"ml-3 text-lg text-green-600 font-normal",children:"🚀 Modo Demo Ativo"})]}),e.jsx("p",{className:"text-gray-600",children:"Visão geral das operações do clube"})]}),c&&e.jsxs(be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{delay:.2},className:"bg-gradient-to-r from-green-500 to-blue-600 text-white px-4 py-2 rounded-lg flex items-center space-x-2",children:[e.jsx(Tr,{size:16}),e.jsx("span",{className:"text-sm font-medium",children:"Teste todas as funcionalidades!"})]})]})}),c&&e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.1},className:"bg-gradient-to-r from-blue-50 to-green-50 border border-blue-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"p-3 bg-blue-600 rounded-full",children:e.jsx(Tr,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"🎯 Bem-vindo ao ClubManager Demo!"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Explore todos os módulos e funcionalidades do sistema. Você pode criar pedidos, gerenciar a cozinha, controlar estoque e muito mais!"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs(fs,{to:"/bar",className:"flex items-center justify-between p-3 bg-white rounded-lg border border-blue-200 hover:border-blue-400 transition-colors group",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ac,{className:"w-5 h-5 text-blue-600"}),e.jsx("span",{className:"font-medium text-gray-800",children:"Testar Módulo Bar"})]}),e.jsx(no,{className:"w-4 h-4 text-gray-400 group-hover:text-blue-600 transition-colors"})]}),e.jsxs(fs,{to:"/kitchen",className:"flex items-center justify-between p-3 bg-white rounded-lg border border-green-200 hover:border-green-400 transition-colors group",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(kc,{className:"w-5 h-5 text-green-600"}),e.jsx("span",{className:"font-medium text-gray-800",children:"Testar Módulo Cozinha"})]}),e.jsx(no,{className:"w-4 h-4 text-gray-400 group-hover:text-green-600 transition-colors"})]})]})]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:u.map((g,v)=>e.jsx(h8,{stat:g,index:v,onClick:g.title==="Estoque Baixo"?()=>t("/inventory/estoque-baixo"):void 0},g.title))}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(be.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.2},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Pedidos Recentes"}),e.jsxs("div",{className:"space-y-3",children:[h.map(g=>e.jsx(f8,{order:g},g.id)),h.length===0&&e.jsxs("div",{className:"text-center py-4",children:[e.jsx("p",{className:"text-gray-500 mb-2",children:"Nenhum pedido ainda"}),c&&e.jsx(fs,{to:"/bar",className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Criar primeiro pedido →"})]})]})]}),e.jsxs(be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},transition:{duration:.3,delay:.3},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Alertas de Estoque"}),e.jsxs("div",{className:"space-y-3",children:[f.map(g=>e.jsx(p8,{item:g},g.id)),f.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Todos os itens com estoque adequado"})]})]})]}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:.4},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Módulos Disponíveis"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:p.map(g=>e.jsx(g8,{module:g},g.name))})]})]})},y8=y.memo(x8),b8=()=>{var w,E;const{orders:t,inventory:s}=Tt(),[a,r]=y.useState(7),[o,l]=y.useState([]),[c,u]=y.useState([]),[h,f]=y.useState(!0),[p,g]=y.useState(null),v=[{label:"Hoje",days:1},{label:"7 dias",days:7},{label:"30 dias",days:30},{label:"90 dias",days:90}];y.useEffect(()=>{(async()=>{try{f(!0);const{data:N}=await B.from("comandas").select("*").order("created_at",{ascending:!1}),{data:C}=await B.from("balcao_orders").select("*").order("created_at",{ascending:!1});console.log("Comandas:",N),console.log("Balcão:",C);const S=[...(N||[]).map(A=>({id:A.id,tableNumber:A.table_number,total:parseFloat(A.total)||0,status:A.status,createdAt:new Date(A.created_at),updatedAt:new Date(A.updated_at||A.created_at),items:Array.isArray(A.items)?A.items:[]})),...(C||[]).map(A=>({id:A.id,tableNumber:null,total:parseFloat(A.total)||0,status:A.status,createdAt:new Date(A.created_at),updatedAt:new Date(A.updated_at||A.created_at),items:Array.isArray(A.items)?A.items:[]}))];console.log("Total de pedidos:",S.length),console.log("Pedidos transformados:",S);const{data:T}=await B.from("inventory").select("*"),M=(T||[]).map(A=>({id:A.id,name:A.name,category:A.category,currentStock:A.current_stock||0,minStock:A.min_stock||0,unit:A.unit||"un",price:parseFloat(A.price)||0}));console.log("Inventário:",M);const{data:$}=await B.from("cash_registers").select(`
            *,
            employee:employees(name, full_name)
          `).eq("status","open").order("opened_at",{ascending:!1}).limit(1).single();console.log("Caixa aberto:",$),g($),l(S),u(M)}catch(N){console.error("Erro ao buscar dados do dashboard:",N),l(t),u(s)}finally{f(!1)}})()},[t,s]);const b=y.useMemo(()=>{const k=new Date,N=Li(eo(k,a)),C=Ku(k),S=Li(eo(N,a)),T=Ku(eo(k,a)),M=o.filter(pe=>Xu(pe.createdAt,{start:N,end:C})),$=o.filter(pe=>Xu(pe.createdAt,{start:S,end:T})),A=["closed","paid","delivered","completed","finalizado"],z=M.filter(pe=>{var P;return A.includes((P=pe.status)==null?void 0:P.toLowerCase())}),R=$.filter(pe=>{var P;return A.includes((P=pe.status)==null?void 0:P.toLowerCase())});console.log("Pedidos finalizados:",z),console.log("Total de pedidos finalizados:",z.length);const L=z.reduce((pe,P)=>pe+(parseFloat(P.total)||0),0);console.log("Faturamento calculado:",L);const I=R.reduce((pe,P)=>pe+P.total,0),X=I>0?(L-I)/I*100:0,ce=z.length>0?L/z.length:0,J=R.length>0?I/R.length:0,V=J>0?(ce-J)/J*100:0,Y=z.length,ee=R.length,we=ee>0?(Y-ee)/ee*100:0,D=o.filter(pe=>pe.status==="pending").length,H=c.filter(pe=>pe.currentStock<=pe.minStock).length,F=c.reduce((pe,P)=>pe+P.currentStock*(P.price||0),0),Z=new Map;z.forEach(pe=>{pe.items.forEach(P=>{const q=Z.get(P.name)||{name:P.name,quantity:0,revenue:0};Z.set(P.name,{name:P.name,quantity:q.quantity+P.quantity,revenue:q.revenue+P.price*P.quantity})})});const re=Array.from(Z.values()).sort((pe,P)=>P.revenue-pe.revenue).slice(0,5),oe=new Map;z.forEach(pe=>{const P=wt(pe.createdAt,"dd/MM");oe.set(P,(oe.get(P)||0)+pe.total)});const ae=z.length>0?z.reduce((pe,P)=>{const q=P.updatedAt.getTime()-P.createdAt.getTime();return pe+q/1e3/60},0)/z.length:0;return{revenue:L,revenueChange:X,avgTicket:ce,avgTicketChange:V,totalSales:Y,salesChange:we,pendingOrders:D,lowStockItems:H,totalStockValue:F,topProducts:re,salesByDay:Array.from(oe.entries()).slice(-7),avgServiceTime:ae,completedOrders:z}},[o,c,a]),_=({title:k,value:N,change:C,icon:S,color:T,bgColor:M,trend:$})=>e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:`p-3 rounded-lg ${M}`,children:e.jsx(S,{className:`w-6 h-6 ${T}`})}),C!==void 0&&e.jsxs("div",{className:`flex items-center space-x-1 text-sm font-medium ${C>0?"text-green-600":C<0?"text-red-600":"text-gray-600"}`,children:[C>0?e.jsx(sR,{className:"w-4 h-4"}):C<0?e.jsx(YM,{className:"w-4 h-4"}):null,e.jsxs("span",{children:[Math.abs(C).toFixed(1),"%"]})]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:k}),e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:N})]})]});return h?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Carregando dashboard..."})]})}):e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Dashboard de Gestão"}),e.jsx("p",{className:"text-gray-600",children:"Análise completa do desempenho do negócio"})]}),e.jsx("div",{className:"flex items-center space-x-2 bg-white rounded-lg shadow-md p-1",children:v.map(k=>e.jsx("button",{onClick:()=>r(k.days),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${a===k.days?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:k.label},k.days))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(_,{title:"Faturamento",value:`R$ ${b.revenue.toFixed(2)}`,change:b.revenueChange,icon:Ut,color:"text-green-600",bgColor:"bg-green-100"}),e.jsx(_,{title:"Ticket Médio",value:`R$ ${b.avgTicket.toFixed(2)}`,change:b.avgTicketChange,icon:e2,color:"text-blue-600",bgColor:"bg-blue-100"}),e.jsx(_,{title:"Total de Vendas",value:b.totalSales,change:b.salesChange,icon:hn,color:"text-purple-600",bgColor:"bg-purple-100"}),e.jsx(_,{title:"Tempo Médio",value:`${b.avgServiceTime.toFixed(0)} min`,icon:Bt,color:"text-orange-600",bgColor:"bg-orange-100"})]}),p&&e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-green-50 to-emerald-50 border-2 border-green-300 rounded-lg shadow-lg p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"p-3 bg-green-500 rounded-full",children:e.jsx(Ut,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:"💰 Caixa Aberto"}),e.jsxs("p",{className:"text-gray-600",children:["Operador: ",e.jsx("span",{className:"font-medium text-gray-800",children:((w=p.employee)==null?void 0:w.full_name)||((E=p.employee)==null?void 0:E.name)||"Não identificado"})]}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Aberto em: ",wt(new Date(p.opened_at),"dd/MM/yyyy 'às' HH:mm",{locale:Wt})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Saldo Inicial"}),e.jsxs("p",{className:"text-2xl font-bold text-green-600",children:["R$ ",parseFloat(p.opening_balance||0).toFixed(2)]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(_,{title:"Pedidos Pendentes",value:b.pendingOrders,icon:KN,color:"text-yellow-600",bgColor:"bg-yellow-100"}),e.jsx(_,{title:"Itens em Estoque Baixo",value:b.lowStockItems,icon:yt,color:"text-red-600",bgColor:"bg-red-100"}),e.jsx(_,{title:"Valor em Estoque",value:`R$ ${b.totalStockValue.toFixed(2)}`,icon:Ka,color:"text-indigo-600",bgColor:"bg-indigo-100"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(be.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Vendas por Dia"}),e.jsx(bg,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("div",{className:"space-y-3",children:b.salesByDay.length>0?b.salesByDay.map(([k,N])=>{const C=Math.max(...b.salesByDay.map(([,T])=>T)),S=N/C*100;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:k}),e.jsxs("span",{className:"text-sm font-bold text-gray-800",children:["R$ ",N.toFixed(2)]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx(be.div,{initial:{width:0},animate:{width:`${S}%`},transition:{duration:.5,delay:.1},className:"bg-blue-600 h-2 rounded-full"})})]},k)}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Sem dados para o período"})})]}),e.jsxs(be.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Top 5 Produtos"}),e.jsx(oR,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("div",{className:"space-y-4",children:b.topProducts.length>0?b.topProducts.map((k,N)=>e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center font-bold text-sm ${N===0?"bg-yellow-100 text-yellow-700":N===1?"bg-gray-100 text-gray-700":N===2?"bg-orange-100 text-orange-700":"bg-blue-100 text-blue-700"}`,children:N+1}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:k.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[k.quantity," unidades"]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("p",{className:"text-sm font-bold text-gray-800",children:["R$ ",k.revenue.toFixed(2)]})})]},k.name)):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Sem vendas no período"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Últimos Pedidos"}),e.jsx(fs,{to:"/orders",className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Ver todos"})]}),e.jsxs("div",{className:"space-y-3",children:[b.completedOrders.slice(0,5).map(k=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:k.tableNumber?`Mesa ${k.tableNumber}`:"Balcão"}),e.jsx("p",{className:"text-sm text-gray-600",children:wt(k.createdAt,"dd/MM/yyyy HH:mm",{locale:Wt})})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-gray-800",children:["R$ ",k.total.toFixed(2)]}),e.jsxs("p",{className:"text-xs text-gray-500",children:[k.items.length," itens"]})]})]},k.id)),b.completedOrders.length===0&&e.jsx("p",{className:"text-gray-500 text-center py-8",children:"Nenhum pedido finalizado"})]})]}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Alertas de Estoque"}),e.jsx(fs,{to:"/inventory",className:"text-sm text-blue-600 hover:text-blue-800 font-medium",children:"Gerenciar"})]}),e.jsxs("div",{className:"space-y-3",children:[c.filter(k=>k.currentStock<=k.minStock).slice(0,5).map(k=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-red-50 rounded-lg border border-red-200",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(yt,{className:"w-5 h-5 text-red-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-800",children:k.name}),e.jsx("p",{className:"text-sm text-gray-600",children:k.category||"Sem categoria"})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-bold text-red-600",children:[k.currentStock," ",k.unit]}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Mín: ",k.minStock]})]})]},k.id)),c.filter(k=>k.currentStock<=k.minStock).length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 bg-green-100 rounded-full mb-3",children:e.jsx(Tr,{className:"w-6 h-6 text-green-600"})}),e.jsx("p",{className:"text-gray-600",children:"Todos os itens com estoque adequado!"})]})]})]})]}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-lg shadow-md p-6 border border-blue-200",children:e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx("div",{className:"p-3 bg-blue-600 rounded-full",children:e.jsx(Sa,{className:"w-6 h-6 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-3",children:"Insights do Período"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Crescimento"}),e.jsxs("p",{className:`text-xl font-bold ${b.revenueChange>0?"text-green-600":b.revenueChange<0?"text-red-600":"text-gray-600"}`,children:[b.revenueChange>0?"+":"",b.revenueChange.toFixed(1),"%"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"vs período anterior"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Eficiência"}),e.jsxs("p",{className:"text-xl font-bold text-blue-600",children:[b.avgServiceTime.toFixed(0)," min"]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"tempo médio de atendimento"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:"Produtos Ativos"}),e.jsx("p",{className:"text-xl font-bold text-purple-600",children:b.topProducts.length}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"produtos vendidos"})]})]})]})]})})]})},v8=({data:t,title:s,color:a="blue"})=>{if(t.length===0)return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:s}),e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Sem dados disponíveis"})]});const r=Math.max(...t.map(_=>_.value)),o=Math.min(...t.map(_=>_.value)),l=t.reduce((_,w)=>_+w.value,0)/t.length,c=t.slice(0,Math.floor(t.length/2)),u=t.slice(Math.floor(t.length/2)),h=c.reduce((_,w)=>_+w.value,0)/c.length,f=u.reduce((_,w)=>_+w.value,0)/u.length,p=f>h?"up":f<h?"down":"neutral",g=h>0?(f-h)/h*100:0,v={blue:{bar:"bg-blue-600",gradient:"from-blue-500 to-blue-600",text:"text-blue-600"},green:{bar:"bg-green-600",gradient:"from-green-500 to-green-600",text:"text-green-600"},purple:{bar:"bg-purple-600",gradient:"from-purple-500 to-purple-600",text:"text-purple-600"}},b=v[a]||v.blue;return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:s}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Média: R$ ",l.toFixed(2)]})]}),e.jsxs("div",{className:`flex items-center space-x-2 ${p==="up"?"text-green-600":p==="down"?"text-red-600":"text-gray-600"}`,children:[p==="up"?e.jsx(Sa,{className:"w-5 h-5"}):p==="down"?e.jsx(Wu,{className:"w-5 h-5"}):null,e.jsxs("span",{className:"text-sm font-medium",children:[p==="up"?"+":"",g.toFixed(1),"%"]})]})]}),e.jsx("div",{className:"space-y-3",children:t.map((_,w)=>{const E=r>0?_.value/r*100:0;return e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:_.date}),e.jsxs("span",{className:"text-sm font-bold text-gray-800",children:["R$ ",_.value.toFixed(2)]})]}),e.jsx("div",{className:"relative w-full bg-gray-200 rounded-full h-3 overflow-hidden",children:e.jsx(be.div,{initial:{width:0},animate:{width:`${E}%`},transition:{duration:.5,delay:w*.05},className:`h-full rounded-full bg-gradient-to-r ${b.gradient}`})})]},w)})}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-6 pt-6 border-t border-gray-200",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Máximo"}),e.jsxs("p",{className:"text-sm font-bold text-gray-800",children:["R$ ",r.toFixed(2)]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Média"}),e.jsxs("p",{className:"text-sm font-bold text-gray-800",children:["R$ ",l.toFixed(2)]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-xs text-gray-500 mb-1",children:"Mínimo"}),e.jsxs("p",{className:"text-sm font-bold text-gray-800",children:["R$ ",o.toFixed(2)]})]})]})]})},hu=[{bg:"bg-blue-500",text:"text-blue-500",light:"bg-blue-100"},{bg:"bg-green-500",text:"text-green-500",light:"bg-green-100"},{bg:"bg-purple-500",text:"text-purple-500",light:"bg-purple-100"},{bg:"bg-orange-500",text:"text-orange-500",light:"bg-orange-100"},{bg:"bg-pink-500",text:"text-pink-500",light:"bg-pink-100"},{bg:"bg-indigo-500",text:"text-indigo-500",light:"bg-indigo-100"},{bg:"bg-yellow-500",text:"text-yellow-500",light:"bg-yellow-100"},{bg:"bg-red-500",text:"text-red-500",light:"bg-red-100"}],w8=({data:t,title:s})=>{if(t.length===0)return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:s}),e.jsx("div",{className:"text-center py-12 text-gray-500",children:"Sem dados disponíveis"})]});const a=t.reduce((r,o)=>r+o.value,0);return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:s}),e.jsx(vR,{className:"w-5 h-5 text-gray-400"})]}),e.jsx("div",{className:"mb-6",children:e.jsx("div",{className:"flex h-4 rounded-full overflow-hidden",children:t.map((r,o)=>{const l=hu[o%hu.length];return e.jsx(be.div,{initial:{width:0},animate:{width:`${r.percentage}%`},transition:{duration:.5,delay:o*.1},className:l.bg,title:`${r.name}: ${r.percentage.toFixed(1)}%`},r.name)})})}),e.jsx("div",{className:"space-y-3",children:t.map((r,o)=>{const l=hu[o%hu.length];return e.jsxs(be.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{duration:.3,delay:o*.05},className:"flex items-center justify-between p-3 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3 flex-1",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${l.bg}`}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-800 truncate",children:r.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[r.percentage.toFixed(1),"% do total"]})]})]}),e.jsx("div",{className:"text-right ml-4",children:e.jsxs("p",{className:"text-sm font-bold text-gray-800",children:["R$ ",r.value.toFixed(2)]})})]},r.name)})}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Total"}),e.jsxs("span",{className:"text-lg font-bold text-gray-800",children:["R$ ",a.toFixed(2)]})]})})]})},j8=({avgServiceTime:t,orderCompletionRate:s,customerSatisfaction:a=0,employeeEfficiency:r=0})=>{const o=[{label:"Tempo Médio de Atendimento",value:`${t.toFixed(0)} min`,target:"< 15 min",icon:Bt,color:"text-blue-600",bgColor:"bg-blue-100",status:t<15?"good":t<25?"warning":"critical"},{label:"Taxa de Conclusão",value:`${s.toFixed(1)}%`,target:"> 95%",icon:ts,color:"text-green-600",bgColor:"bg-green-100",status:s>95?"good":s>85?"warning":"critical"},{label:"Satisfação do Cliente",value:a>0?`${a.toFixed(1)}%`:"N/A",target:"> 90%",icon:Ns,color:"text-purple-600",bgColor:"bg-purple-100",status:a>90?"good":a>75?"warning":"critical"},{label:"Eficiência Operacional",value:r>0?`${r.toFixed(1)}%`:"N/A",target:"> 85%",icon:Tr,color:"text-orange-600",bgColor:"bg-orange-100",status:r>85?"good":r>70?"warning":"critical"}],l=u=>{switch(u){case"good":return"border-green-500 bg-green-50";case"warning":return"border-yellow-500 bg-yellow-50";case"critical":return"border-red-500 bg-red-50";default:return"border-gray-300 bg-white"}},c=u=>{switch(u){case"good":return e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Excelente"});case"warning":return e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Atenção"});case"critical":return e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-red-100 text-red-800",children:"Crítico"});default:return null}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Métricas de Performance"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Indicadores operacionais em tempo real"})]}),e.jsx(e2,{className:"w-6 h-6 text-gray-400"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:o.map((u,h)=>e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.3,delay:h*.1},className:`border-2 rounded-lg p-4 ${l(u.status)}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("div",{className:`p-2 rounded-lg ${u.bgColor}`,children:e.jsx(u.icon,{className:`w-5 h-5 ${u.color}`})}),c(u.status)]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600 mb-1",children:u.label}),e.jsxs("div",{className:"flex items-baseline space-x-2",children:[e.jsx("p",{className:"text-2xl font-bold text-gray-800",children:u.value}),u.target&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Meta: ",u.target]})]})]}),u.status&&e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx(be.div,{initial:{width:0},animate:{width:u.status==="good"?"100%":u.status==="warning"?"70%":"40%"},transition:{duration:.5,delay:h*.1},className:`h-2 rounded-full ${u.status==="good"?"bg-green-500":u.status==="warning"?"bg-yellow-500":"bg-red-500"}`})})})]},u.label))}),e.jsx("div",{className:"mt-6 pt-6 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Performance Geral"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Baseado em ",o.length," indicadores principais"]})]}),e.jsx("div",{className:"text-right",children:o.filter(u=>u.status==="good").length>=3?e.jsxs("div",{className:"flex items-center space-x-2 text-green-600",children:[e.jsx(Sa,{className:"w-5 h-5"}),e.jsx("span",{className:"text-lg font-bold",children:"Ótimo"})]}):o.filter(u=>u.status==="critical").length>=2?e.jsxs("div",{className:"flex items-center space-x-2 text-red-600",children:[e.jsx(yt,{className:"w-5 h-5"}),e.jsx("span",{className:"text-lg font-bold",children:"Requer Atenção"})]}):e.jsxs("div",{className:"flex items-center space-x-2 text-yellow-600",children:[e.jsx(KN,{className:"w-5 h-5"}),e.jsx("span",{className:"text-lg font-bold",children:"Bom"})]})})]})})]})},_8=()=>{const{orders:t,inventory:s}=Tt(),[a,r]=y.useState(7),[o,l]=y.useState(!1),c=[{label:"Hoje",days:1},{label:"7 dias",days:7},{label:"30 dias",days:30},{label:"90 dias",days:90}],u=y.useMemo(()=>{const p=new Date,g=Li(eo(p,a)),v=Ku(p),b=Li(eo(g,a)),_=Ku(eo(p,a)),w=t.filter(Y=>Xu(Y.createdAt,{start:g,end:v})),E=t.filter(Y=>Xu(Y.createdAt,{start:b,end:_})),k=w.filter(Y=>Y.status==="delivered"),N=E.filter(Y=>Y.status==="delivered"),C=k.reduce((Y,ee)=>Y+ee.total,0),S=N.reduce((Y,ee)=>Y+ee.total,0),T=S>0?(C-S)/S*100:0,M=k.length>0?C/k.length:0,$=k.length,A=new Map;for(let Y=a-1;Y>=0;Y--){const ee=eo(p,Y),we=wt(ee,"dd/MM");A.set(we,0)}k.forEach(Y=>{const ee=wt(Y.createdAt,"dd/MM");A.has(ee)&&A.set(ee,(A.get(ee)||0)+Y.total)});const z=Array.from(A.entries()).map(([Y,ee])=>({date:Y,value:ee})),R=new Map;k.forEach(Y=>{Y.items.forEach(ee=>{const we=ee.category||"Outros";R.set(we,(R.get(we)||0)+ee.price*ee.quantity)})});const L=Array.from(R.values()).reduce((Y,ee)=>Y+ee,0),I=Array.from(R.entries()).map(([Y,ee])=>({name:Y,value:ee,percentage:L>0?ee/L*100:0})).sort((Y,ee)=>ee.value-Y.value),X=k.length>0?k.reduce((Y,ee)=>{const we=ee.updatedAt.getTime()-ee.createdAt.getTime();return Y+we/1e3/60},0)/k.length:0,ce=w.length>0?k.length/w.length*100:0,J=s.filter(Y=>Y.currentStock<=Y.minStock),V=s.reduce((Y,ee)=>Y+ee.currentStock*(ee.price||0),0);return{revenue:C,revenueChange:T,avgTicket:M,totalSales:$,salesChartData:z,categoryData:I,avgServiceTime:X,orderCompletionRate:ce,lowStockItems:J,totalStockValue:V,pendingOrders:t.filter(Y=>Y.status==="pending").length}},[t,s,a]),h=()=>{l(!0),setTimeout(()=>l(!1),1e3)},f=()=>{var _;const p={periodo:(_=c.find(w=>w.days===a))==null?void 0:_.label,faturamento:u.revenue,vendas:u.totalSales,ticketMedio:u.avgTicket,geradoEm:new Date().toISOString()},g=new Blob([JSON.stringify(p,null,2)],{type:"application/json"}),v=URL.createObjectURL(g),b=document.createElement("a");b.href=v,b.download=`dashboard-${wt(new Date,"yyyy-MM-dd")}.json`,b.click()};return e.jsxs("div",{className:"space-y-6 pb-8",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col lg:flex-row lg:items-center lg:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Dashboard Completo"}),e.jsx("p",{className:"text-gray-600",children:"Gestão completa e análise de indicadores do negócio"})]}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsx("div",{className:"flex items-center space-x-2 bg-white rounded-lg shadow-md p-1",children:c.map(p=>e.jsx("button",{onClick:()=>r(p.days),className:`px-4 py-2 rounded-md text-sm font-medium transition-colors ${a===p.days?"bg-blue-600 text-white":"text-gray-600 hover:bg-gray-100"}`,children:p.label},p.days))}),e.jsx("button",{onClick:h,disabled:o,className:"p-2 bg-white rounded-lg shadow-md hover:bg-gray-50 transition-colors disabled:opacity-50",title:"Atualizar dados",children:e.jsx(ma,{className:`w-5 h-5 text-gray-600 ${o?"animate-spin":""}`})}),e.jsx("button",{onClick:f,className:"p-2 bg-white rounded-lg shadow-md hover:bg-gray-50 transition-colors",title:"Exportar dados",children:e.jsx(qc,{className:"w-5 h-5 text-gray-600"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-gradient-to-br from-green-500 to-green-600 rounded-lg shadow-lg p-6 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx(Ut,{className:"w-8 h-8 opacity-80"}),e.jsxs("div",{className:`text-sm font-medium px-2 py-1 rounded ${u.revenueChange>0?"bg-green-400":"bg-green-700"}`,children:[u.revenueChange>0?"+":"",u.revenueChange.toFixed(1),"%"]})]}),e.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Faturamento"}),e.jsxs("p",{className:"text-3xl font-bold",children:["R$ ",u.revenue.toFixed(2)]})]}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-gradient-to-br from-blue-500 to-blue-600 rounded-lg shadow-lg p-6 text-white",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx(hn,{className:"w-8 h-8 opacity-80"})}),e.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Total de Vendas"}),e.jsx("p",{className:"text-3xl font-bold",children:u.totalSales})]}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-gradient-to-br from-purple-500 to-purple-600 rounded-lg shadow-lg p-6 text-white",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx(Sa,{className:"w-8 h-8 opacity-80"})}),e.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Ticket Médio"}),e.jsxs("p",{className:"text-3xl font-bold",children:["R$ ",u.avgTicket.toFixed(2)]})]}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-gradient-to-br from-orange-500 to-orange-600 rounded-lg shadow-lg p-6 text-white",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsx(Bt,{className:"w-8 h-8 opacity-80"})}),e.jsx("p",{className:"text-sm opacity-90 mb-1",children:"Tempo Médio"}),e.jsxs("p",{className:"text-3xl font-bold",children:[u.avgServiceTime.toFixed(0)," min"]})]})]}),(u.pendingOrders>0||u.lowStockItems.length>0)&&e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(yt,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-semibold text-yellow-800 mb-1",children:"Atenção Necessária"}),e.jsxs("ul",{className:"text-sm text-yellow-700 space-y-1",children:[u.pendingOrders>0&&e.jsxs("li",{children:["• ",u.pendingOrders," pedido(s) pendente(s) aguardando processamento"]}),u.lowStockItems.length>0&&e.jsxs("li",{children:["• ",u.lowStockItems.length," item(ns) com estoque baixo"]})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(v8,{data:u.salesChartData,title:"Evolução de Vendas",color:"blue"}),e.jsx(w8,{data:u.categoryData,title:"Vendas por Categoria"})]}),e.jsx(j8,{avgServiceTime:u.avgServiceTime,orderCompletionRate:u.orderCompletionRate,customerSatisfaction:0,employeeEfficiency:0}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Resumo de Estoque"}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:"Valor total e itens críticos"})]}),e.jsx(Ka,{className:"w-6 h-6 text-gray-400"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Valor Total em Estoque"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["R$ ",u.totalStockValue.toFixed(2)]})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Itens em Estoque"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:s.length})]}),e.jsxs("div",{className:"text-center p-4 bg-red-50 rounded-lg",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Itens em Estoque Baixo"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:u.lowStockItems.length})]})]}),u.lowStockItems.length>0&&e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Itens Críticos"}),e.jsx("div",{className:"space-y-2",children:u.lowStockItems.slice(0,3).map(p=>e.jsxs("div",{className:"flex items-center justify-between p-2 bg-red-50 rounded",children:[e.jsx("span",{className:"text-sm text-gray-800",children:p.name}),e.jsxs("span",{className:"text-sm font-medium text-red-600",children:[p.currentStock," ",p.unit]})]},p.id))})]})]})]})};class N8 extends y.Component{constructor(a){super(a);dt(this,"handleRetry",()=>{this.setState({hasError:!1,error:null,errorInfo:null})});dt(this,"handleGoHome",()=>{window.location.href="/"});this.state={hasError:!1,error:null,errorInfo:null}}static getDerivedStateFromError(a){return{hasError:!0,error:a,errorInfo:null}}componentDidCatch(a,r){this.setState({error:a,errorInfo:r}),console.error("ErrorBoundary capturou um erro:",a,r),this.props.onError&&this.props.onError(a,r),console.error("Erro em produção:",{error:a.message,stack:a.stack,componentStack:r.componentStack})}render(){return this.state.hasError?this.props.fallback?this.props.fallback:e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-white rounded-lg shadow-lg p-6 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-3 bg-red-100 rounded-full",children:e.jsx(yt,{className:"w-8 h-8 text-red-600"})})}),e.jsx("h1",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Oops! Algo deu errado"}),e.jsx("p",{className:"text-gray-600 mb-6",children:"Ocorreu um erro inesperado. Tente recarregar a página ou volte ao início."}),!1,e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsxs("button",{onClick:this.handleRetry,className:"flex-1 inline-flex items-center justify-center px-4 py-2 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[e.jsx(ma,{className:"w-4 h-4 mr-2"}),"Tentar Novamente"]}),e.jsxs("button",{onClick:this.handleGoHome,className:"flex-1 inline-flex items-center justify-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 transition-colors",children:[e.jsx(XR,{className:"w-4 h-4 mr-2"}),"Ir ao Início"]})]})]})}):this.props.children}}const f2="America/Sao_Paulo",S8=()=>new Date(new Date().toLocaleString("en-US",{timeZone:f2})),pc=()=>{const t=new Date,s=new Date(t.toLocaleString("en-US",{timeZone:f2})),a=s.getFullYear(),r=String(s.getMonth()+1).padStart(2,"0"),o=String(s.getDate()).padStart(2,"0"),l=`${a}-${r}-${o}`;return console.log("📅 getTodayString:",{utcNow:t.toISOString(),brasiliaDate:s.toLocaleString("pt-BR"),result:l}),l},fu=t=>{const[s,a,r]=t.split("-").map(Number),o=new Date(s,a-1,r,0,0,0,0),l=new Date(s,a-1,r,23,59,59,999),c=new Date(o.getTime()-6*60*60*1e3),u=new Date(l.getTime()+6*60*60*1e3),h={start:c.toISOString(),end:u.toISOString()};return console.log("🕐 getDateRangeForQuery:",{input:t,startLocal:o.toLocaleString("pt-BR"),endLocal:l.toLocaleString("pt-BR"),startUTC:h.start,endUTC:h.end}),h},E8=()=>{const t=S8();return t.setHours(0,0,0,0),t},C8=()=>{const[t,s]=y.useState({totalRevenue:0,ordersToday:0,pendingOrders:0,deliveredOrders:0,loading:!0,error:null}),a=async()=>{try{s(b=>({...b,loading:!0,error:null}));const r=E8().toISOString(),{data:o,error:l}=await B.from("balcao_orders").select("status, final_amount, created_at").gte("created_at",r);if(l)throw l;const{data:c,error:u}=await B.from("comandas").select("status, total, created_at").gte("created_at",r);if(u)throw u;const h=pc();let f=0,p=0,g=0,v=0;o==null||o.forEach(b=>{new Date(b.created_at).toISOString().split("T")[0]===h&&p++,b.status==="delivered"?(f+=Number(b.final_amount||0),v++):(b.status==="pending_payment"||b.status==="paid"||b.status==="preparing")&&g++}),c==null||c.forEach(b=>{new Date(b.created_at).toISOString().split("T")[0]===h&&p++,b.status==="closed"?(f+=Number(b.total||0),v++):(b.status==="open"||b.status==="pending_payment")&&g++}),s({totalRevenue:f,ordersToday:p,pendingOrders:g,deliveredOrders:v,loading:!1,error:null})}catch(r){console.error("Erro ao buscar estatísticas do bar:",r),s(o=>({...o,loading:!1,error:r instanceof Error?r.message:"Erro ao carregar estatísticas"}))}};return y.useEffect(()=>{a();const r=B.channel("balcao_orders_stats").on("postgres_changes",{event:"*",schema:"public",table:"balcao_orders"},()=>{console.log("📊 Atualizando estatísticas do bar (balcão)..."),a()}).subscribe(),o=B.channel("comandas_stats").on("postgres_changes",{event:"*",schema:"public",table:"comandas"},()=>{console.log("📊 Atualizando estatísticas do bar (comandas)..."),a()}).subscribe();return()=>{r.unsubscribe(),o.unsubscribe()}},[]),{...t,refetch:a}},T8=({onOrderUpdate:t,empresaId:s})=>{const a=y.useCallback(r=>{console.log("🍺 REALTIME MONITOR BAR:",r.eventType,r.table),(r.eventType==="INSERT"||r.eventType==="UPDATE")&&(console.log("🔄 Atualizando Monitor Bar..."),t())},[t]);y.useEffect(()=>{console.log("🔌 Conectando realtime do Monitor Bar...");const r=B.channel("bar-monitor-realtime").on("postgres_changes",{event:"*",schema:"public",table:"balcao_orders",filter:s?`empresa_id=eq.${s}`:void 0},o=>{var l,c;console.log("🔥 REALTIME BAR - balcao_orders:",o.eventType),o.eventType==="UPDATE"&&((l=o.old)==null?void 0:l.status)==="pending_payment"&&((c=o.new)==null?void 0:c.status)==="paid"&&console.log("💰 PEDIDO PAGO! Atualizando Monitor Bar..."),a(o)}).on("postgres_changes",{event:"*",schema:"public",table:"balcao_order_items"},o=>{console.log("🔥 REALTIME BAR - balcao_order_items:",o.eventType),a(o)}).on("postgres_changes",{event:"*",schema:"public",table:"comandas"},o=>{console.log("🔥 REALTIME BAR - comandas:",o.eventType),a(o)}).on("postgres_changes",{event:"*",schema:"public",table:"comanda_items"},o=>{console.log("🔥 REALTIME BAR - comanda_items:",o.eventType),a(o)}).subscribe(o=>{o==="SUBSCRIBED"?console.log("✅ Realtime do Monitor Bar ativo!"):o==="CHANNEL_ERROR"&&console.error("❌ Erro no realtime do Monitor Bar")});return()=>{console.log("🔌 Desconectando realtime do Monitor Bar"),r.unsubscribe()}},[a,s])},p2=({onCustomerSelected:t,onClose:s})=>{const[a,r]=y.useState({phone:"",name:"",email:""}),[o,l]=y.useState(null),[c,u]=y.useState(!1),[h,f]=y.useState(!1),[p,g]=y.useState(null),v=async N=>{if(!(N.length<10)){f(!0),g(null);try{const{data:C,error:S}=await B.rpc("get_bar_customer_by_phone",{customer_phone:N});if(S)throw S;if(C&&C.length>0){const T=C[0];l(T),r({phone:T.phone,name:T.name,email:T.email||""})}else l(null),r(T=>({...T,name:"",email:""}))}catch(C){console.error("Erro ao buscar cliente:",C),g("Erro ao buscar cliente")}finally{f(!1)}}},b=N=>{const C=N.replace(/\D/g,"");return C.length<=11?C.replace(/(\d{2})(\d{5})(\d{4})/,"($1) $2-$3"):N},_=N=>{const C=N.target.value,S=b(C);r(M=>({...M,phone:S}));const T=C.replace(/\D/g,"");T.length===11?v(T):l(null)},w=async()=>{u(!0),g(null);try{const N=a.phone.replace(/\D/g,""),{data:C,error:S}=await B.from("bar_customers").insert({phone:N,name:a.name,email:a.email||null,status:"active",is_vip:!1,loyalty_points:0,credit_limit:0,current_balance:0}).select().single();if(S)throw S;t(C)}catch(N){console.error("Erro ao criar cliente:",N),g("Erro ao criar cliente")}finally{u(!1)}},E=()=>{o&&t(o)},k=N=>{if(N.preventDefault(),!a.phone||!a.name){g("Telefone e nome são obrigatórios");return}o?E():w()};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:o?"Cliente Encontrado":"Cadastro de Cliente"}),e.jsx("button",{onClick:s,className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),p&&e.jsx("div",{className:"mb-4 p-3 bg-red-100 border border-red-400 text-red-700 rounded",children:p}),e.jsxs("form",{onSubmit:k,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:a.phone,onChange:_,placeholder:"(11) 99999-9999",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",maxLength:15,required:!0}),h&&e.jsx("div",{className:"absolute right-3 top-2.5",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-500"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome *"}),e.jsx("input",{type:"text",value:a.name,onChange:N=>r(C=>({...C,name:N.target.value})),placeholder:"Nome completo",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:!!o})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email (opcional)"}),e.jsx("input",{type:"email",value:a.email,onChange:N=>r(C=>({...C,email:N.target.value})),placeholder:"email@exemplo.com",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!!o})]}),o&&e.jsx("div",{className:"p-3 bg-green-100 border border-green-400 rounded",children:e.jsxs("p",{className:"text-green-700 text-sm",children:[e.jsx("strong",{children:"Cliente encontrado!"}),e.jsx("br",{}),"Última visita: ",o.last_visit?new Date(o.last_visit).toLocaleDateString("pt-BR"):"Primeira visita",e.jsx("br",{}),"Pontos de fidelidade: ",o.loyalty_points,o.is_vip&&e.jsx("span",{className:"ml-2 text-yellow-600",children:"⭐ VIP"})]})}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:c||!a.phone||!a.name,className:"flex-1 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:c?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Processando..."]}):o?"Selecionar Cliente":"Cadastrar Cliente"})]})]})]})})},k8=({isOpen:t,onClose:s,menuItems:a})=>{const{addOrder:r}=Tt(),{user:o}=jt(),[l,c]=y.useState([]),[u,h]=y.useState(""),[f,p]=y.useState(""),[g,v]=y.useState(!1),[b,_]=y.useState(null),[w,E]=y.useState(!1),k=$=>{if(l.find(z=>z.menuItemId===$.id))c(z=>z.map(R=>R.menuItemId===$.id?{...R,quantity:R.quantity+1}:R));else{const z={id:`item-${Date.now()}`,menuItemId:$.id,quantity:1,price:$.price};c(R=>[...R,z])}},N=$=>{c(A=>A.filter(z=>z.menuItemId!==$))},C=($,A)=>{if(A<=0){N($);return}c(z=>z.map(R=>R.menuItemId===$?{...R,quantity:A}:R))},S=l.reduce(($,A)=>$+A.price*A.quantity,0),T=$=>{_($),E(!1)},M=async $=>{if($.preventDefault(),!(l.length===0||g)){if(!b){alert("Por favor, selecione um cliente antes de finalizar o pedido.");return}v(!0);try{await r({tableNumber:u||void 0,items:l.map(({id:A,...z})=>z),status:"pending",employeeId:o.id,customerId:b.id,notes:f||void 0}),c([]),h(""),p(""),_(null),s()}catch(A){console.error("Falha ao criar o pedido:",A)}finally{v(!1)}}};return e.jsx(Ws,{children:t&&e.jsxs("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:[e.jsxs(be.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:"Novo Pedido"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(nt,{size:24})})]}),e.jsxs("div",{className:"flex h-[70vh]",children:[e.jsxs("div",{className:"flex-1 p-6 overflow-y-auto",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Cardápio"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:a.map($=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("h4",{className:"font-medium text-gray-800",children:$.name}),e.jsxs("span",{className:"text-lg font-bold text-green-600",children:["R$ ",$.price.toFixed(2)]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-3",children:$.description}),e.jsx("button",{onClick:()=>k($),disabled:!$.available||g,className:"w-full bg-blue-600 text-white py-2 rounded-lg font-medium hover:bg-blue-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:$.available?"Adicionar":"Indisponível"})]},$.id))})]}),e.jsxs("div",{className:"w-1/3 bg-gray-50 border-l border-gray-200 flex flex-col",children:[e.jsx("div",{className:"p-6 pb-4",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Pedido"})}),e.jsxs("form",{onSubmit:M,className:"flex flex-col h-full",children:[e.jsxs("div",{className:"px-6 space-y-4 flex-shrink-0",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cliente *"}),b?e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-green-800",children:b.name}),e.jsx("p",{className:"text-sm text-green-600",children:b.phone}),b.is_vip&&e.jsx("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800 mt-1",children:"⭐ VIP"})]}),e.jsx("button",{type:"button",onClick:()=>_(null),className:"text-green-600 hover:text-green-800",disabled:g,children:e.jsx(nt,{size:16})})]})}):e.jsxs("button",{type:"button",onClick:()=>E(!0),className:"w-full flex items-center justify-center px-3 py-2 border-2 border-dashed border-gray-300 rounded-lg text-gray-600 hover:border-blue-400 hover:text-blue-600 transition-colors",disabled:g,children:[e.jsx(Ks,{size:20,className:"mr-2"}),"Selecionar Cliente"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Número da Mesa"}),e.jsx("input",{type:"text",value:u,onChange:$=>h($.target.value),placeholder:"Ex: 5",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:g})]})]}),e.jsx("div",{className:"px-6 flex-1 min-h-0",children:e.jsxs("div",{className:"space-y-2",children:[l.map($=>{const A=a.find(z=>z.id===$.menuItemId);return e.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded-lg shadow-sm",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"font-medium text-gray-800 truncate",children:A==null?void 0:A.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["R$ ",$.price.toFixed(2)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 ml-2",children:[e.jsx("button",{type:"button",onClick:()=>C($.menuItemId,$.quantity-1),className:"text-gray-400 hover:text-gray-600 p-1",disabled:g,children:e.jsx(Ii,{size:16})}),e.jsx("span",{className:"w-8 text-center font-medium",children:$.quantity}),e.jsx("button",{type:"button",onClick:()=>C($.menuItemId,$.quantity+1),className:"text-gray-400 hover:text-gray-600 p-1",disabled:g,children:e.jsx($s,{size:16})})]})]},$.id)}),l.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx("p",{children:"Nenhum item selecionado"}),e.jsx("p",{className:"text-sm",children:"Adicione itens do cardápio"})]})]})}),e.jsxs("div",{className:"px-6 pb-6 space-y-4 flex-shrink-0 border-t border-gray-200 pt-4 mt-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações"}),e.jsx("textarea",{value:f,onChange:$=>p($.target.value),placeholder:"Observações especiais...",rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",disabled:g})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-800",children:"Total:"}),e.jsxs("span",{className:"text-xl font-bold text-green-600",children:["R$ ",S.toFixed(2)]})]}),e.jsx("button",{type:"submit",disabled:l.length===0||g||!b,className:"w-full bg-green-600 text-white py-3 rounded-lg font-medium hover:bg-green-700 disabled:bg-green-400 disabled:cursor-not-allowed transition-colors",children:g?"Confirmando...":"Confirmar Pedido"})]})]})]})]})]})]}),w&&e.jsx(p2,{onCustomerSelected:T,onClose:()=>E(!1)})]})})},g2=({order:t,menuItems:s,hasMultipleOrders:a=!1,orderNumber:r})=>{const{updateOrderStatus:o}=Tt();console.log("OrderCard - Order:",t.id,{items:t.items,menuItemsCount:s.length,firstMenuItem:s[0]});const l=v=>{switch(v){case"pending":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"preparing":return"bg-blue-100 text-blue-800 border-blue-200";case"ready":return"bg-green-100 text-green-800 border-green-200";case"delivered":return"bg-gray-100 text-gray-800 border-gray-200";case"cancelled":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},c=v=>{switch(v){case"pending":return"Pendente";case"preparing":return"Preparando";case"ready":return"Pronto";case"delivered":return"Entregue";case"cancelled":return"Cancelado";default:return v}},h=(v=>{switch(v){case"pending":return"preparing";case"preparing":return"ready";case"ready":return"delivered";default:return null}})(t.status),f=v=>v.id.startsWith("balcao-"),p=v=>v.id.startsWith("comanda-"),g=()=>{const v=window.open("","_blank");if(!v)return;const b=t.items.map(w=>{var N;const E=s.find(C=>C.id===w.menuItemId),k=(E==null?void 0:E.name)||((N=w.menuItem)==null?void 0:N.name)||`Item ${w.menuItemId.slice(-4)}`;return`
        <tr>
          <td style="padding: 8px; border-bottom: 1px solid #ddd;">${w.quantity}x</td>
          <td style="padding: 8px; border-bottom: 1px solid #ddd;">${k}</td>
          <td style="padding: 8px; border-bottom: 1px solid #ddd; text-align: right;">R$ ${(w.price*w.quantity).toFixed(2)}</td>
        </tr>
      `}).join(""),_=`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Pedido ${r||t.id.slice(-6)}</title>
          <style>
            body {
              font-family: Arial, sans-serif;
              padding: 20px;
              max-width: 800px;
              margin: 0 auto;
            }
            h1 {
              text-align: center;
              color: #333;
              margin-bottom: 20px;
            }
            .header {
              margin-bottom: 20px;
              padding-bottom: 10px;
              border-bottom: 2px solid #333;
            }
            .info {
              display: flex;
              justify-content: space-between;
              margin-bottom: 10px;
            }
            table {
              width: 100%;
              border-collapse: collapse;
              margin: 20px 0;
            }
            th {
              background-color: #f0f0f0;
              padding: 10px;
              text-align: left;
              border-bottom: 2px solid #333;
            }
            .total {
              text-align: right;
              font-size: 18px;
              font-weight: bold;
              margin-top: 20px;
              padding-top: 10px;
              border-top: 2px solid #333;
            }
            .notes {
              background-color: #fff9e6;
              padding: 10px;
              margin: 20px 0;
              border-left: 4px solid #ffc107;
            }
            .status {
              display: inline-block;
              padding: 5px 15px;
              border-radius: 20px;
              font-weight: bold;
            }
            .status-pending { background-color: #fff3cd; color: #856404; }
            .status-preparing { background-color: #cfe2ff; color: #084298; }
            .status-ready { background-color: #d1e7dd; color: #0f5132; }
            .status-delivered { background-color: #e2e3e5; color: #41464b; }
            @media print {
              body { padding: 0; }
            }
          </style>
        </head>
        <body>
          <h1>ClubManager - Pedido</h1>
          <div class="header">
            <div class="info">
              <strong>${t.tableNumber?`Mesa ${t.tableNumber}`:"Balcão"}</strong>
              <span>Pedido #${r||t.id.slice(-6)}</span>
            </div>
            <div class="info">
              <span>Data: ${wt(t.createdAt,"dd/MM/yyyy 'às' HH:mm",{locale:Wt})}</span>
              <span class="status status-${t.status}">${c(t.status)}</span>
            </div>
            ${f(t)?'<div style="color: green; font-weight: bold;">✓ PAGO</div>':""}
            ${p(t)?'<div style="color: orange; font-weight: bold;">AGUARDANDO PAGAMENTO</div>':""}
          </div>
          
          <table>
            <thead>
              <tr>
                <th>Qtd</th>
                <th>Item</th>
                <th style="text-align: right;">Valor</th>
              </tr>
            </thead>
            <tbody>
              ${b}
            </tbody>
          </table>
          
          ${t.notes?`<div class="notes"><strong>Observações:</strong><br>${t.notes}</div>`:""}
          
          <div class="total">
            Total: R$ ${t.total.toFixed(2)}
          </div>
          
          <script>
            window.onload = function() {
              window.print();
            }
          <\/script>
        </body>
      </html>
    `;v.document.write(_),v.document.close()};return e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow ${a?"ring-2 ring-orange-300 ring-offset-2":""} ${f(t)?"border-green-400 bg-green-50 shadow-lg":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fc,{size:16,className:"text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-800",children:t.tableNumber?`Mesa ${t.tableNumber}`:"Balcão"}),r&&e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:["#",r]}),f(t)&&e.jsx("span",{className:"bg-green-600 text-white px-2 py-1 rounded-full text-xs font-bold animate-pulse",children:"✓ PAGO"}),p(t)&&e.jsx("span",{className:"bg-yellow-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:"AGUARDA PAGTO"})]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium border ${l(t.status)}`,children:c(t.status)})]}),e.jsx("div",{className:"space-y-2 mb-4",children:t.items.map(v=>{var w;const b=s.find(E=>E.id===v.menuItemId),_=(b==null?void 0:b.name)||((w=v.menuItem)==null?void 0:w.name)||`Item ${v.menuItemId.slice(-4)}`;return e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:[v.quantity,"x ",_]}),e.jsxs("span",{className:"text-gray-800",children:["R$ ",(v.price*v.quantity).toFixed(2)]})]},v.id)})}),t.notes&&e.jsx("div",{className:"mb-4 p-2 bg-yellow-50 rounded border border-yellow-200",children:e.jsx("p",{className:"text-xs text-yellow-800",children:t.notes})}),e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-500 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Bt,{size:12}),e.jsx("span",{children:wt(t.createdAt,"HH:mm",{locale:Wt})})]}),e.jsxs("span",{className:"font-medium text-gray-800",children:["R$ ",t.total.toFixed(2)]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("button",{onClick:g,className:"w-full py-2 rounded-lg text-sm font-medium transition-colors bg-gray-600 text-white hover:bg-gray-700 flex items-center justify-center gap-2",children:[e.jsx(wO,{size:16}),"Imprimir Pedido"]}),h&&e.jsxs("button",{onClick:()=>o(t.id,h),className:`w-full py-2 rounded-lg text-sm font-medium transition-colors ${f(t)?t.status==="pending"?"bg-green-600 text-white hover:bg-green-700":t.status==="preparing"?"bg-green-700 text-white hover:bg-green-800":"bg-green-800 text-white hover:bg-green-900":p(t)?t.status==="pending"?"bg-yellow-600 text-white hover:bg-yellow-700":t.status==="preparing"?"bg-yellow-700 text-white hover:bg-yellow-800":"bg-yellow-800 text-white hover:bg-yellow-900":t.status==="pending"?"bg-blue-600 text-white hover:bg-blue-700":t.status==="preparing"?"bg-blue-700 text-white hover:bg-blue-800":"bg-blue-800 text-white hover:bg-blue-900"}`,children:[h==="preparing"&&"Iniciar Preparo",h==="ready"&&"Marcar como Pronto",h==="delivered"&&"Marcar como Entregue"]})]})]})},A8=()=>{const t=Xs(),{barOrders:s,menuItems:a,loadMenuItems:r,refreshBarOrders:o}=Tt(),{totalRevenue:l,ordersToday:c,pendingOrders:u,deliveredOrders:h,loading:f}=C8();T8({onOrderUpdate:()=>{console.log("🔔 Atualização detectada! Recarregando Monitor Bar..."),o()}}),Ye.useEffect(()=>{console.log("🚀 Monitor Bar montado - carregando dados iniciais..."),r(),o()},[]);const[p,g]=y.useState(!1),[v,b]=y.useState("all"),[_,w]=y.useState(""),[E,k]=y.useState("all"),N=a,S=(()=>{const A=new Map;return s.forEach(z=>{const R=z.tableNumber||"Balcão";A.has(R)||A.set(R,[]),A.get(R).push(z)}),A})(),T=A=>(S.get(A)||[]).length>1,M=A=>A.id.slice(-4).toUpperCase(),$=s.filter(A=>{var I,X;const z=v==="all"||A.status===v,R=E==="all"||(A.tableNumber||"Balcão")===E,L=((I=A.tableNumber)==null?void 0:I.toLowerCase().includes(_.toLowerCase()))||A.id.toLowerCase().includes(_.toLowerCase())||((X=A.notes)==null?void 0:X.toLowerCase().includes(_.toLowerCase()));return z&&R&&L});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Módulo Bar"}),e.jsx("p",{className:"text-gray-600",children:"Gestão completa de pedidos e vendas"})]}),e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>g(!0),className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx($s,{size:20}),e.jsx("span",{children:"Novo Pedido"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Receita Total"}),f?e.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"Carregando..."}):e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["R$ ",l.toFixed(2)]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Pedidos Hoje"}),f?e.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"Carregando..."}):e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:c})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Pedidos Pendentes"}),f?e.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"Carregando..."}):e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:u})]}),e.jsxs(be.div,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>t("/bar/pedidos-entregues"),className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg shadow-md p-6 cursor-pointer hover:shadow-lg transition-all border-2 border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800",children:"Pedidos Entregues"}),e.jsx(ts,{className:"text-green-600",size:24})]}),f?e.jsx("p",{className:"text-2xl font-bold text-gray-400",children:"Carregando..."}):e.jsxs("div",{children:[e.jsx("p",{className:"text-3xl font-bold text-green-600",children:h}),e.jsx("p",{className:"text-sm text-green-700 mt-2",children:"Clique para ver histórico"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Pedidos"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[Array.from(S.entries()).filter(([A,z])=>z.length>1).length>0&&e.jsxs("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium",children:[Array.from(S.entries()).filter(([A,z])=>z.length>1).length," mesa(s) com múltiplos pedidos"]}),E!=="all"&&e.jsxs("button",{onClick:()=>k("all"),className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium hover:bg-blue-200 transition-colors flex items-center space-x-1",children:[e.jsxs("span",{children:["Filtro: ",E]}),e.jsx("span",{className:"text-blue-600",children:"✕"})]})]})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Xa,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar pedidos...",value:_,onChange:A=>w(A.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:v,onChange:A=>b(A.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"pending",children:"Pendente"}),e.jsx("option",{value:"preparing",children:"Preparando"}),e.jsx("option",{value:"ready",children:"Pronto"})]})]})]}),Array.from(S.entries()).filter(([A,z])=>z.length>1).length>0&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-orange-800 mb-2",children:"⚠️ Mesas com Múltiplos Pedidos:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from(S.entries()).filter(([A,z])=>z.length>1).map(([A,z])=>e.jsxs("button",{onClick:()=>k(A),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors hover:shadow-md transform hover:scale-105 ${E===A?"bg-orange-400 text-white":"bg-orange-200 text-orange-800 hover:bg-orange-300"}`,title:`Filtrar pedidos da ${A}`,children:["Mesa ",A,": ",z.length," pedidos"]},A))})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:$.map(A=>e.jsx(g2,{order:A,menuItems:a,hasMultipleOrders:T(A.tableNumber||"Balcão"),orderNumber:M(A)},A.id))}),$.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhum pedido encontrado"})})]}),p&&e.jsx(k8,{isOpen:p,onClose:()=>g(!1),menuItems:N})]})},M8=()=>{const[t,s]=y.useState([]),[a,r]=y.useState(!0),[o,l]=y.useState(null),c=async()=>{try{r(!0),l(null);const{data:u,error:h}=await B.from("comanda_items").select(`
          *,
          comanda:comandas(
            id,
            table_id,
            customer_name,
            opened_at,
            status,
            table:bar_tables(number)
          ),
          menu_item:menu_items(
            *,
            inventory_items!left(name, image_url)
          )
        `).gte("added_at",new Date(new Date().setHours(0,0,0,0)).toISOString()).order("added_at",{ascending:!1});if(h)throw h;const{data:f,error:p}=await B.from("balcao_order_items").select(`
          *,
          balcao_order:balcao_orders!inner(
            id,
            order_number,
            customer_name,
            status,
            created_at
          ),
          menu_item:menu_items(
            *,
            inventory_items!left(name, image_url)
          )
        `).gte("created_at",new Date(new Date().setHours(0,0,0,0)).toISOString()).order("created_at",{ascending:!1});if(p)throw p;const g=new Map;u==null||u.forEach(v=>{var N,C,S,T,M,$,A;const b=(N=v.comanda)==null?void 0:N.id;if(!b)return;const _=new Date(v.added_at),w=`${_.getUTCFullYear()}-${_.getUTCMonth()}-${_.getUTCDate()}-${_.getUTCHours()}-${_.getUTCMinutes()}`,E=`comanda-${b}-${w}`;g.has(E)||g.set(E,{id:E,tableNumber:(S=(C=v.comanda)==null?void 0:C.table)==null?void 0:S.number,items:[],status:v.status,total:0,createdAt:new Date(v.added_at),updatedAt:new Date(v.created_at),employeeId:"",notes:`Mesa ${(M=(T=v.comanda)==null?void 0:T.table)==null?void 0:M.number} - ${(($=v.comanda)==null?void 0:$.customer_name)||"Cliente"}`});const k=g.get(E);k.items.push({id:v.id,menuItemId:v.menu_item_id,quantity:v.quantity,price:v.price,notes:v.notes,menuItem:v.menu_item?{id:v.menu_item.id,name:v.menu_item.item_type==="direct"&&((A=v.menu_item.inventory_items)!=null&&A.name)?v.menu_item.inventory_items.name:v.menu_item.name,category:v.menu_item.category,preparationTime:v.menu_item.preparation_time,item_type:v.menu_item.item_type}:void 0}),k.total+=v.price*v.quantity}),f==null||f.forEach(v=>{var E,k;const b=(E=v.balcao_order)==null?void 0:E.id;if(!b)return;const _=`balcao-${b}`;if(!g.has(_)){let N="pending";v.balcao_order.status==="preparing"?N="preparing":v.balcao_order.status==="ready"?N="ready":v.balcao_order.status==="delivered"&&(N="delivered"),g.set(_,{id:_,tableNumber:"Balcão",items:[],status:N,total:0,createdAt:new Date(v.balcao_order.created_at),updatedAt:new Date(v.created_at),employeeId:"",notes:`Pedido Balcão #${v.balcao_order.order_number}${v.balcao_order.customer_name?` - ${v.balcao_order.customer_name}`:""}`})}const w=g.get(_);w.items.push({id:v.id,menuItemId:v.menu_item_id,quantity:v.quantity,price:v.unit_price,notes:v.notes,menuItem:v.menu_item?{id:v.menu_item.id,name:v.menu_item.item_type==="direct"&&((k=v.menu_item.inventory_items)!=null&&k.name)?v.menu_item.inventory_items.name:v.menu_item.name,category:v.menu_item.category,preparationTime:v.menu_item.preparation_time,item_type:v.menu_item.item_type}:void 0}),w.total+=v.unit_price*v.quantity}),s(Array.from(g.values())),r(!1)}catch(u){console.error("Erro ao buscar pedidos do bar:",u),l(u instanceof Error?u.message:"Erro ao carregar pedidos"),r(!1)}};return y.useEffect(()=>{c();const u=B.channel("comanda_items_all").on("postgres_changes",{event:"*",schema:"public",table:"comanda_items"},()=>{console.log("📦 Atualizando pedidos do bar (comanda_items)..."),c()}).subscribe(),h=B.channel("balcao_order_items_all").on("postgres_changes",{event:"*",schema:"public",table:"balcao_order_items"},()=>{console.log("📦 Atualizando pedidos do bar (balcao_order_items)..."),c()}).subscribe(),f=B.channel("balcao_orders_all").on("postgres_changes",{event:"UPDATE",schema:"public",table:"balcao_orders"},()=>{console.log("📦 Atualizando pedidos do bar (balcao_orders)..."),c()}).subscribe();return()=>{u.unsubscribe(),h.unsubscribe(),f.unsubscribe()}},[]),{orders:t,loading:a,error:o,refetch:c}},R8=()=>{const t=Xs(),{menuItems:s}=Tt(),{orders:a,loading:r}=M8(),[o,l]=y.useState(""),[c,u]=y.useState(pc()),h=a.filter(b=>b.status==="delivered"),f=h.filter(b=>{var k,N;const w=new Date(b.createdAt).toISOString().split("T")[0]===c,E=((k=b.tableNumber)==null?void 0:k.toLowerCase().includes(o.toLowerCase()))||b.id.toLowerCase().includes(o.toLowerCase())||((N=b.notes)==null?void 0:N.toLowerCase().includes(o.toLowerCase()));return w&&E}),p=f.reduce((b,_)=>b+_.total,0),g=f.length,v=b=>b.id.slice(-4).toUpperCase();return e.jsxs("div",{className:"space-y-6",children:[e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/bar"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(fo,{size:24,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Pedidos Entregues"}),e.jsx("p",{className:"text-gray-600",children:"Histórico de pedidos finalizados"})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Receita do Dia"}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["R$ ",p.toFixed(2)]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Pedidos Entregues"}),e.jsx("p",{className:"text-3xl font-bold text-blue-600",children:g})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-2",children:"Ticket Médio"}),e.jsxs("p",{className:"text-3xl font-bold text-purple-600",children:["R$ ",g>0?(p/g).toFixed(2):"0.00"]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 space-y-4 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx(Mr,{size:20,className:"text-gray-600"}),e.jsx("input",{type:"date",value:c,onChange:b=>u(b.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Xa,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar pedidos...",value:o,onChange:b=>l(b.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("button",{onClick:()=>{alert("Funcionalidade de exportação em desenvolvimento")},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx(qc,{size:20}),e.jsx("span",{children:"Exportar"})]})]})]}),r?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Carregando pedidos..."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:f.map(b=>e.jsx(g2,{order:b,menuItems:s,hasMultipleOrders:!1,orderNumber:v(b)},b.id))}),f.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:h.length===0?"Nenhum pedido entregue encontrado":"Nenhum pedido entregue nesta data"})})]})]})]})},O8=()=>{const[t,s]=y.useState([]),[a,r]=y.useState(!0),[o,l]=y.useState(""),[c,u]=y.useState("all"),[h,f]=y.useState(!1),[p,g]=y.useState(null),[v,b]=y.useState(!1),_=async()=>{r(!0);try{const{data:T,error:M}=await B.from("bar_customers").select("*").order("created_at",{ascending:!1});if(M)throw M;s(T||[])}catch(T){console.error("Erro ao carregar clientes:",T)}finally{r(!1)}};y.useEffect(()=>{_()},[]);const w=t.filter(T=>{const M=T.name.toLowerCase().includes(o.toLowerCase())||T.phone.includes(o)||T.email&&T.email.toLowerCase().includes(o.toLowerCase()),$=c==="all"||T.status===c;return M&&$}),E={total:t.length,active:t.filter(T=>T.status==="active").length,vip:t.filter(T=>T.is_vip).length,totalLoyaltyPoints:t.reduce((T,M)=>T+M.loyalty_points,0)},k=T=>{s(M=>[T,...M]),f(!1)},N=T=>{g(T),b(!0)},C=T=>{const M=T.replace(/\D/g,"");return M.length===11?`(${M.slice(0,2)}) ${M.slice(2,7)}-${M.slice(7)}`:T},S=T=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(T);return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Clientes do Bar"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gerencie os clientes e suas informações"})]}),e.jsxs("button",{onClick:()=>f(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx($s,{size:20}),e.jsx("span",{children:"Novo Cliente"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total de Clientes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:E.total})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(Zu,{className:"h-6 w-6 text-blue-600"})})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Clientes Ativos"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:E.active})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(Mr,{className:"h-6 w-6 text-green-600"})})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Clientes VIP"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:E.vip})]}),e.jsx("div",{className:"p-3 bg-yellow-100 rounded-full",children:e.jsx(h0,{className:"h-6 w-6 text-yellow-600"})})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Pontos Totais"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:E.totalLoyaltyPoints.toLocaleString()})]}),e.jsx("div",{className:"p-3 bg-purple-100 rounded-full",children:e.jsx(Ut,{className:"h-6 w-6 text-purple-600"})})]})})]}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Buscar por nome, telefone ou email...",value:o,onChange:T=>l(T.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsx("div",{className:"flex space-x-4",children:e.jsxs("select",{value:c,onChange:T=>u(T.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"active",children:"Ativo"}),e.jsx("option",{value:"inactive",children:"Inativo"}),e.jsx("option",{value:"blocked",children:"Bloqueado"})]})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:a?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Carregando clientes..."})]}):w.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Zu,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Nenhum cliente encontrado"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contato"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Pontos"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Última Visita"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.map(T=>e.jsxs(be.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-blue-600",children:T.name.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"ml-4",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:T.name}),T.is_vip&&e.jsx(h0,{className:"ml-2 h-4 w-4 text-yellow-500 fill-current"})]}),e.jsx("div",{className:"text-sm text-gray-500",children:T.cpf||"CPF não informado"})]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:C(T.phone)}),e.jsx("div",{className:"text-sm text-gray-500",children:T.email||"Email não informado"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${T.status==="active"?"bg-green-100 text-green-800":T.status==="inactive"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:T.status==="active"?"Ativo":T.status==="inactive"?"Inativo":"Bloqueado"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:[T.loyalty_points.toLocaleString()," pts"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:T.last_visit?new Date(T.last_visit).toLocaleDateString("pt-BR"):"Nunca"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>N(T),className:"text-blue-600 hover:text-blue-900",children:e.jsx(Ys,{size:16})}),e.jsx("button",{className:"text-gray-600 hover:text-gray-900",children:e.jsx(lo,{size:16})}),e.jsx("button",{className:"text-red-600 hover:text-red-900",children:e.jsx(Yi,{size:16})})]})})]},T.id))})]})})}),h&&e.jsx(p2,{onCustomerSelected:k,onClose:()=>f(!1)}),v&&p&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Detalhes do Cliente"}),e.jsx("button",{onClick:()=>b(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nome"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Telefone"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:C(p.phone)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.email||"Não informado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CPF"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.cpf||"Não informado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsxs("p",{className:"mt-1",children:[e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${p.status==="active"?"bg-green-100 text-green-800":p.status==="inactive"?"bg-gray-100 text-gray-800":"bg-red-100 text-red-800"}`,children:p.status==="active"?"Ativo":p.status==="inactive"?"Inativo":"Bloqueado"}),p.is_vip&&e.jsx("span",{className:"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"⭐ VIP"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Pontos de Fidelidade"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-900",children:[p.loyalty_points.toLocaleString()," pontos"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Limite de Crédito"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:S(p.credit_limit)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Saldo Atual"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:S(p.current_balance)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Última Visita"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.last_visit?new Date(p.last_visit).toLocaleDateString("pt-BR"):"Nunca"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cadastrado em"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(p.created_at).toLocaleDateString("pt-BR")})]})]}),p.notes&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Observações"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:p.notes})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>b(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"Fechar"})})]})})]})};class D8{constructor(){dt(this,"cache",new Map)}set(s,a,r=3e5){this.cache.set(s,{data:a,timestamp:Date.now(),ttl:r})}get(s){const a=this.cache.get(s);return a?Date.now()-a.timestamp>a.ttl?(this.cache.delete(s),null):a.data:null}clear(){this.cache.clear()}has(s){return this.get(s)!==null}}const jp=new D8,P8=async(t,s={})=>{const{maxAttempts:a=3,delay:r=1e3,backoff:o="exponential",retryCondition:l=h=>!I8(h)}=s;let c,u=0;for(let h=0;h<a;h++){u++;try{return{success:!0,data:await t(),attempts:u,usedFallback:!1,fromCache:!1}}catch(f){if(c=f instanceof Error?f:new Error(String(f)),h===a-1||!l(c))break;const p=o==="exponential"?r*Math.pow(2,h):r*(h+1);console.warn(`Attempt ${h+1} failed, retrying in ${p}ms:`,c.message),await L8(p)}}return{success:!1,error:c,attempts:u,usedFallback:!1,fromCache:!1}},z8=async(t,s={})=>{const{fallbackFn:a,useCache:r=!0,cacheKey:o,offlineMode:l=!1,...c}=s;if(l&&r&&o){const h=jp.get(o);if(h)return{success:!0,data:h,attempts:0,usedFallback:!1,fromCache:!0}}const u=await P8(t,c);if(u.success)return r&&o&&u.data&&jp.set(o,u.data),u;if(a)try{return{success:!0,data:await a(),attempts:u.attempts,usedFallback:!0,fromCache:!1}}catch(h){console.error("Fallback also failed:",h)}if(r&&o){const h=jp.get(o);if(h)return{success:!0,data:h,attempts:u.attempts,usedFallback:!0,fromCache:!0}}return u},$8=async()=>{const t={synced:0,failed:0,errors:[]},s=Object.keys(localStorage).filter(a=>a.startsWith("pending_save_")||a.startsWith("pending_delete_"));for(const a of s)try{const r=JSON.parse(localStorage.getItem(a)||"{}");r.type==="employee_save"?(console.log("Syncing pending employee save:",r.data),localStorage.removeItem(a),t.synced++):r.type==="employee_delete"&&(console.log("Syncing pending employee delete:",r.employeeId),localStorage.removeItem(a),t.synced++)}catch(r){t.failed++,t.errors.push(`Failed to sync ${a}: ${r}`)}return t},I8=t=>{var r;const s=["auth","permission","unauthorized","forbidden","not found","404","401","403","validation"],a=((r=t.message)==null?void 0:r.toLowerCase())||"";return s.some(o=>a.includes(o))},L8=t=>new Promise(s=>setTimeout(s,t)),U8=()=>navigator.onLine,B8=t=>{const s=()=>t(!0),a=()=>t(!1);return window.addEventListener("online",s),window.addEventListener("offline",a),()=>{window.removeEventListener("online",s),window.removeEventListener("offline",a)}},w0=t=>{if(!t)return"Erro desconhecido";const s=t.message||t.toString(),a={"network error":"Problema de conexão. Verifique sua internet.",timeout:"A operação demorou muito para responder. Tente novamente.","server error":"Erro no servidor. Tente novamente em alguns minutos.",auth:"Erro de autenticação. Faça login novamente.",permission:"Você não tem permissão para esta operação.",validation:"Dados inválidos. Verifique as informações.","not found":"Registro não encontrado.",duplicate:"Este registro já existe.",connection:"Problema de conexão com o servidor."};for(const[r,o]of Object.entries(a))if(s.toLowerCase().includes(r))return o;return"Ocorreu um erro inesperado. Tente novamente."},V8=t=>t.success?t.fromCache?"Dados carregados do cache local (sem conexão)":t.usedFallback?"Operação realizada com método alternativo":t.attempts>1?`Operação realizada após ${t.attempts} tentativas`:"Operação realizada com sucesso":w0(t.error),q8=(t={})=>{const{autoSync:s=!0,showNotifications:a=!0}=t,[r,o]=y.useState({isOnline:U8(),isRetrying:!1,pendingOperations:0,lastError:null,lastRecovery:null});y.useEffect(()=>B8(_=>{o(w=>({...w,isOnline:_})),_&&s&&l()}),[s]),y.useEffect(()=>{const b=()=>{const w=Object.keys(localStorage).filter(E=>E.startsWith("pending_save_")||E.startsWith("pending_delete_"));o(E=>({...E,pendingOperations:w.length}))};b();const _=setInterval(b,5e3);return()=>clearInterval(_)},[]);const l=y.useCallback(async()=>{if(r.pendingOperations!==0)try{o(_=>({..._,isRetrying:!0}));const b=await $8();b.synced>0&&o(_=>({..._,lastRecovery:`${b.synced} operações sincronizadas`,pendingOperations:_.pendingOperations-b.synced})),b.failed>0&&o(_=>({..._,lastError:`${b.failed} operações falharam na sincronização`}))}catch(b){o(_=>({..._,lastError:w0(b)}))}finally{o(b=>({...b,isRetrying:!1}))}},[r.pendingOperations]),c=y.useCallback(async(b,_={})=>{const{maxAttempts:w=3,fallback:E,cacheKey:k,operationType:N="operation"}=_;o(C=>({...C,isRetrying:!0,lastError:null}));try{const C=await z8(b,{maxAttempts:w,delay:1e3,backoff:"exponential",fallbackFn:E,useCache:!!k,cacheKey:k,offlineMode:!r.isOnline}),S=V8(C);return o(T=>({...T,isRetrying:!1,lastRecovery:C.success?S:null,lastError:C.success?null:S})),C}catch(C){const S=w0(C);return o(T=>({...T,isRetrying:!1,lastError:S})),{success:!1,error:C instanceof Error?C:new Error(S),attempts:w,usedFallback:!1,fromCache:!1}}},[r.isOnline]),u=y.useCallback(()=>{o(b=>({...b,lastError:null}))},[]),h=y.useCallback(()=>{o(b=>({...b,lastRecovery:null}))},[]),f=y.useCallback(async()=>{await l()},[l]),p=y.useCallback(async(b,_)=>c(b,{maxAttempts:3,cacheKey:_,operationType:"load"}),[c]),g=y.useCallback(async(b,_,w)=>c(b,{maxAttempts:5,fallback:w?async()=>(localStorage.setItem(w,JSON.stringify({type:"pending_save",data:_,timestamp:Date.now()})),{..._,pending:!0}):void 0,operationType:"save"}),[c]),v=y.useCallback(async(b,_)=>c(b,{maxAttempts:3,fallback:async()=>{localStorage.setItem(`pending_delete_${_}`,JSON.stringify({type:"pending_delete",itemId:_,timestamp:Date.now()}))},operationType:"delete"}),[c]);return{...r,executeWithRecovery:c,clearError:u,clearRecovery:h,manualSync:f,loadWithRecovery:p,saveWithRecovery:g,deleteWithRecovery:v}};class F8{constructor(){dt(this,"context",{})}setContext(s,a){this.context={userId:s,userEmail:a}}async log(s,a,r,o={},l=!0,c){const u={action:s,resource_type:a,resource_id:r,user_id:this.context.userId,details:this.sanitizeDetails(o),timestamp:new Date().toISOString(),success:l,error_message:c};try{await this.saveToDB(u)}catch(h){console.error("Failed to save audit log:",h),this.saveToLocalStorage(u)}}async logEmployeeCreated(s,a){await this.log("employee_created","employee",s,{employee_name:a.nome_completo||a.name,employee_role:a.bar_role,has_system_access:a.tem_acesso_sistema})}async logEmployeeUpdated(s,a){await this.log("employee_updated","employee",s,{changes:this.sanitizeDetails(a),fields_changed:Object.keys(a)})}async logEmployeeDeactivated(s,a){await this.log("employee_deactivated","employee",s,{reason:a,deactivation_date:new Date().toISOString()})}async logLoginAttempt(s,a,r){await this.log(a?"login_success":"login_failure","session","login",{email:s},a,r)}async saveToDB(s){const{error:a}=await B.from("audit_logs").insert([s]);if(a)throw a}saveToLocalStorage(s){try{const a=JSON.parse(localStorage.getItem("audit_logs_pending")||"[]");a.push(s),localStorage.setItem("audit_logs_pending",JSON.stringify(a.slice(-100)))}catch(a){console.error("Failed to save to localStorage:",a)}}sanitizeDetails(s){const a={...s};return["password","senha","token","secret"].forEach(o=>{a[o]&&(a[o]="[REDACTED]")}),a}async syncPendingLogs(){try{const s=JSON.parse(localStorage.getItem("audit_logs_pending")||"[]");return s.length===0?{synced:0,failed:0}:(await this.saveToDB(s),localStorage.removeItem("audit_logs_pending"),{synced:s.length,failed:0})}catch{return{synced:0,failed:1}}}}const la=new F8,H8=()=>{const{user:t,permissions:s}=jt();return y.useEffect(()=>{t&&s&&la.setContext(t.id,t.email)},[t,s]),y.useEffect(()=>{const a=async()=>{navigator.onLine&&await la.syncPendingLogs()};a();const r=()=>a();return window.addEventListener("online",r),()=>window.removeEventListener("online",r)},[]),{logEmployeeCreated:la.logEmployeeCreated.bind(la),logEmployeeUpdated:la.logEmployeeUpdated.bind(la),logEmployeeDeactivated:la.logEmployeeDeactivated.bind(la),logLoginAttempt:la.logLoginAttempt.bind(la),syncPendingLogs:la.syncPendingLogs.bind(la)}};class G8{constructor(){dt(this,"memoryCache",new Map);dt(this,"defaultTTL",5*60*1e3);dt(this,"maxSize",100)}set(s,a,r={}){const{ttl:o=this.defaultTTL,persistent:l=!1,maxSize:c=this.maxSize}=r,u={data:a,timestamp:Date.now(),ttl:o,key:s};this.memoryCache.set(s,u),this.memoryCache.size>c&&this.evictOldest(),l&&this.saveToLocalStorage(s,u)}get(s){let a=this.memoryCache.get(s);return a||(a=this.loadFromLocalStorage(s),a&&this.memoryCache.set(s,a)),a?this.isExpired(a)?(this.delete(s),null):a.data:null}has(s){return this.get(s)!==null}delete(s){this.memoryCache.delete(s),this.removeFromLocalStorage(s)}clear(){this.memoryCache.clear(),this.clearLocalStorage()}invalidatePattern(s){const a=new RegExp(s);for(const r of this.memoryCache.keys())a.test(r)&&this.memoryCache.delete(r);this.invalidateLocalStoragePattern(s)}invalidateByPrefix(s){this.invalidatePattern(`^${s}`)}isExpired(s){return Date.now()-s.timestamp>s.ttl}evictOldest(){let s="",a=Date.now();for(const[r,o]of this.memoryCache.entries())o.timestamp<a&&(a=o.timestamp,s=r);s&&this.memoryCache.delete(s)}saveToLocalStorage(s,a){try{const r=`cache_${s}`;localStorage.setItem(r,JSON.stringify(a))}catch(r){console.warn("Failed to save to localStorage:",r)}}loadFromLocalStorage(s){try{const a=`cache_${s}`,r=localStorage.getItem(a);return r?JSON.parse(r):null}catch(a){return console.warn("Failed to load from localStorage:",a),null}}removeFromLocalStorage(s){try{const a=`cache_${s}`;localStorage.removeItem(a)}catch(a){console.warn("Failed to remove from localStorage:",a)}}clearLocalStorage(){try{Object.keys(localStorage).forEach(a=>{a.startsWith("cache_")&&localStorage.removeItem(a)})}catch(s){console.warn("Failed to clear localStorage cache:",s)}}invalidateLocalStoragePattern(s){try{const a=new RegExp(s);Object.keys(localStorage).forEach(o=>{if(o.startsWith("cache_")){const l=o.replace("cache_","");a.test(l)&&localStorage.removeItem(o)}})}catch(a){console.warn("Failed to invalidate localStorage pattern:",a)}}getStats(){const s=this.memoryCache.size,a=Object.keys(localStorage).filter(r=>r.startsWith("cache_")).length;return{memorySize:s,localStorageSize:a,totalSize:s+a}}startAutoCleanup(s=6e4){const r=setInterval(()=>{for(const[o,l]of this.memoryCache.entries())this.isExpired(l)&&this.memoryCache.delete(o);try{Object.keys(localStorage).forEach(l=>{if(l.startsWith("cache_")){const c=localStorage.getItem(l);if(c){const u=JSON.parse(c);this.isExpired(u)&&localStorage.removeItem(l)}}})}catch(o){console.warn("Auto cleanup failed:",o)}},s);return()=>clearInterval(r)}}const hr=new G8,pu={getList:()=>hr.get("employees_list"),setList:t=>hr.set("employees_list",t,{ttl:2*60*1e3,persistent:!0}),getEmployee:t=>hr.get(`employee_${t}`),setEmployee:(t,s)=>hr.set(`employee_${t}`,s,{ttl:5*60*1e3,persistent:!0}),getStats:()=>hr.get("employee_stats"),setStats:t=>hr.set("employee_stats",t,{ttl:1*60*1e3}),invalidateAll:()=>hr.invalidateByPrefix("employee"),invalidateList:()=>hr.delete("employees_list"),invalidateEmployee:t=>hr.delete(`employee_${t}`)};class Z8{constructor(){dt(this,"events",[]);dt(this,"metrics",new Map);this.loadFromStorage()}trackEmployeeCreation(s){this.addEvent({type:"employee_creation",timestamp:new Date().toISOString(),data:s})}trackValidationError(s){this.addEvent({type:"validation_error",timestamp:new Date().toISOString(),data:s})}trackSystemAccess(s){this.addEvent({type:"system_access",timestamp:new Date().toISOString(),data:s})}trackPerformance(s){this.addEvent({type:"performance",timestamp:new Date().toISOString(),data:s})}addEvent(s){this.events.push(s),this.events.length>1e4&&(this.events=this.events.slice(-1e4)),this.saveToStorage()}generateCreationMetrics(s="week"){const a=this.getEventsByType("employee_creation"),r=this.getEventsByType("validation_error"),o=a.length,l=a.filter(u=>u.data.success).length,c=o-l;return{totalCreated:o,successRate:o>0?l/o*100:0,failureRate:o>0?c/o*100:0,averageCreationTime:this.calculateAverageCreationTime(a),creationsByPeriod:this.groupByPeriod(a,s),creationsByRole:this.groupByRole(a),creationsBySource:this.groupBySource(a),validationErrors:this.analyzeValidationErrors(r)}}generatePerformanceMetrics(){const s=this.getEventsByType("performance");return{averageResponseTime:this.calculateAverageResponseTime(s),slowestOperations:this.findSlowestOperations(s),errorsByType:this.groupErrorsByType(s),retryAttempts:this.analyzeRetryAttempts(s),cacheHitRate:this.calculateCacheHitRate(s)}}generateUsageMetrics(){const s=this.getEventsByType("system_access");return{activeUsers:this.countActiveUsers(s),systemAccessRate:this.calculateSystemAccessRate(s),moduleUsage:this.analyzeModuleUsage(s),peakUsageHours:this.findPeakUsageHours(s),sessionDuration:this.calculateAverageSessionDuration(s)}}generateDistributionMetrics(){const s=this.getEventsByType("employee_creation");return{roleDistribution:this.analyzeRoleDistribution(s),shiftDistribution:this.analyzeShiftDistribution(s),departmentDistribution:this.analyzeDepartmentDistribution(s),tenureDistribution:this.analyzeTenureDistribution(s)}}generateCompleteAnalytics(){return{creationMetrics:this.generateCreationMetrics(),performanceMetrics:this.generatePerformanceMetrics(),usageMetrics:this.generateUsageMetrics(),distributionMetrics:this.generateDistributionMetrics()}}calculateAverageCreationTime(s){return s.length===0?0:s.reduce((r,o)=>r+(o.data.duration||0),0)/s.length}groupByPeriod(s,a){const r=new Map;return s.forEach(o=>{const l=new Date(o.timestamp);let c;switch(a){case"day":c=l.toISOString().split("T")[0];break;case"week":const u=new Date(l);u.setDate(l.getDate()-l.getDay()),c=u.toISOString().split("T")[0];break;case"month":c=`${l.getFullYear()}-${String(l.getMonth()+1).padStart(2,"0")}`;break;default:c=l.toISOString().split("T")[0]}r.set(c,(r.get(c)||0)+1)}),Array.from(r.entries()).map(([o,l])=>({period:o,count:l,timestamp:new Date().toISOString()}))}groupByRole(s){const a=new Map;s.forEach(o=>{const l=o.data.role;l&&a.set(l,(a.get(l)||0)+1)});const r=s.length;return Array.from(a.entries()).map(([o,l])=>({role:o,count:l,percentage:r>0?l/r*100:0}))}groupBySource(s){const a=new Map;return s.forEach(r=>{const o=r.data.source;if(o){const l=a.get(o)||{total:0,successful:0};l.total++,r.data.success&&l.successful++,a.set(o,l)}}),Array.from(a.entries()).map(([r,o])=>({source:r,count:o.total,successRate:o.total>0?o.successful/o.total*100:0}))}analyzeValidationErrors(s){const a=new Map;s.forEach(l=>{const c=l.data.field,u=l.data.errorType;a.has(c)||a.set(c,new Map);const h=a.get(c);h.set(u,(h.get(u)||0)+1)});const r=[],o=s.length;return a.forEach((l,c)=>{l.forEach((u,h)=>{r.push({field:c,errorType:h,count:u,percentage:o>0?u/o*100:0})})}),r.sort((l,c)=>c.count-l.count)}calculateAverageResponseTime(s){return s.length===0?0:s.reduce((r,o)=>r+(o.data.duration||0),0)/s.length}findSlowestOperations(s){const a=new Map;return s.forEach(r=>{const o=r.data.operation,l=r.data.duration||0;a.has(o)||a.set(o,{times:[],count:0});const c=a.get(o);c.times.push(l),c.count++}),Array.from(a.entries()).map(([r,o])=>({operation:r,averageTime:o.times.reduce((l,c)=>l+c,0)/o.times.length,maxTime:Math.max(...o.times),count:o.count})).sort((r,o)=>o.averageTime-r.averageTime).slice(0,10)}groupErrorsByType(s){const a=new Map;s.filter(o=>!o.data.success).forEach(o=>{const l=o.data.errorType||"unknown",c=a.get(l)||{count:0,lastOccurrence:""};c.count++,c.lastOccurrence=o.timestamp,a.set(l,c)});const r=Array.from(a.values()).reduce((o,l)=>o+l.count,0);return Array.from(a.entries()).map(([o,l])=>({type:o,count:l.count,percentage:r>0?l.count/r*100:0,lastOccurrence:l.lastOccurrence}))}analyzeRetryAttempts(s){const a=new Map;return s.forEach(r=>{const o=r.data.operation,l=r.data.retryCount||0;if(l>0){a.has(o)||a.set(o,{attempts:[],successes:0});const c=a.get(o);c.attempts.push(l),r.data.success&&c.successes++}}),Array.from(a.entries()).map(([r,o])=>({operation:r,attempts:o.attempts.reduce((l,c)=>l+c,0)/o.attempts.length,successRate:o.attempts.length>0?o.successes/o.attempts.length*100:0}))}calculateCacheHitRate(s){const a=s.filter(o=>o.data.cacheHit!==void 0);return a.length===0?0:a.filter(o=>o.data.cacheHit).length/a.length*100}countActiveUsers(s){const a=new Set,r=new Date(Date.now()-24*60*60*1e3);return s.filter(o=>new Date(o.timestamp)>r).forEach(o=>a.add(o.data.userId)),a.size}calculateSystemAccessRate(s){const a=s.length,r=s.filter(o=>o.data.success).length;return a>0?r/a*100:0}analyzeModuleUsage(s){const a=new Map;return s.forEach(r=>{const o=r.data.module,l=r.data.userId,c=r.data.duration||0;a.has(o)||a.set(o,{accessCount:0,users:new Set,totalDuration:0});const u=a.get(o);u.accessCount++,u.users.add(l),u.totalDuration+=c}),Array.from(a.entries()).map(([r,o])=>({module:r,accessCount:o.accessCount,uniqueUsers:o.users.size,averageSessionTime:o.accessCount>0?o.totalDuration/o.accessCount:0}))}findPeakUsageHours(s){const a=new Map;return s.forEach(r=>{const o=new Date(r.timestamp).getHours(),l=r.data.userId;a.has(o)||a.set(o,{usage:0,users:new Set});const c=a.get(o);c.usage++,c.users.add(l)}),Array.from(a.entries()).map(([r,o])=>({hour:r,usage:o.usage,activeUsers:o.users.size})).sort((r,o)=>o.usage-r.usage)}calculateAverageSessionDuration(s){const a=s.map(r=>r.data.duration).filter(r=>r!==void 0&&r>0);return a.length===0?0:a.reduce((r,o)=>r+o,0)/a.length}analyzeRoleDistribution(s){const a=new Map;s.forEach(o=>{const l=o.data.role;l&&a.set(l,(a.get(l)||0)+1)});const r=s.length;return Array.from(a.entries()).map(([o,l])=>({role:o,count:l,percentage:r>0?l/r*100:0,trend:"stable"}))}analyzeShiftDistribution(s){return[{shift:"manha",count:0,percentage:0,efficiency:85},{shift:"tarde",count:0,percentage:0,efficiency:90},{shift:"noite",count:0,percentage:0,efficiency:80}]}analyzeDepartmentDistribution(s){return[{department:"Atendimento",employeeCount:0,averageTenure:12,turnoverRate:15},{department:"Cozinha",employeeCount:0,averageTenure:18,turnoverRate:10},{department:"Bar",employeeCount:0,averageTenure:15,turnoverRate:12}]}analyzeTenureDistribution(s){return[{range:"0-6 meses",count:0,percentage:0},{range:"6-12 meses",count:0,percentage:0},{range:"1-2 anos",count:0,percentage:0},{range:"2+ anos",count:0,percentage:0}]}getEventsByType(s){return this.events.filter(a=>a.type===s)}saveToStorage(){try{localStorage.setItem("employee_analytics",JSON.stringify(this.events.slice(-1e3)))}catch(s){console.warn("Failed to save analytics to storage:",s)}}loadFromStorage(){try{const s=localStorage.getItem("employee_analytics");s&&(this.events=JSON.parse(s))}catch(s){console.warn("Failed to load analytics from storage:",s)}}}const W8=new Z8,Pj=t=>W8.trackEmployeeCreation(t),Y8=()=>{const[t,s]=y.useState([]),[a,r]=y.useState(!0),[o,l]=y.useState(null),{loadWithRecovery:c,saveWithRecovery:u}=q8();H8();const h=y.useCallback(async()=>{var N,C,S;try{r(!0),l(null),pu.invalidateAll(),console.log("🔄 DEBUG - Cache limpo, buscando dados frescos do banco");const T=await c(async()=>{const M=await Mc();let $=B;M.success?M.useAdmin&&(console.log("🔧 Using admin client for fetch operations"),$=ut):console.warn("⚠️ Authentication failed, but continuing with fetch:",M.error);const A=await vt();if(!A)throw new Error("Empresa não encontrada para o usuário atual");const{data:z,error:R}=await $.from("employees").select(`
            id, name, email, phone, cpf, status, employee_code,
            tem_acesso_sistema, auth_user_id, created_at, updated_at,
            position_id, department_id,
            bar_employees!inner(
              bar_role, shift_preference, specialties, commission_rate,
              is_active, start_date, end_date, notes
            )
          `).eq("empresa_id",A).eq("status","active").order("created_at",{ascending:!1});if(R)throw console.error("Erro na consulta employees:",R),new Error(`Erro ao consultar banco de dados: ${R.message}`);return z||[]},"employees_list");if(T.success){const M=T.data,$=(T.data||[]).map(A=>{var R;const z=((R=A.bar_employees)==null?void 0:R[0])||{};return{id:A.id,employee_id:A.id,bar_role:z.bar_role||"atendente",shift_preference:z.shift_preference||"qualquer",specialties:z.specialties||[],commission_rate:z.commission_rate||0,status:A.status,start_date:z.start_date||A.created_at,end_date:z.end_date||null,notes:z.notes||`Código: ${A.employee_code}`,created_at:A.created_at,updated_at:A.updated_at,is_active:z.is_active!==void 0?z.is_active:A.status==="active",employee:{id:A.id,name:A.name||"Nome não informado",cpf:A.cpf,email:A.email,phone:A.phone,hire_date:A.created_at,status:A.status},usuario_empresa:{id:A.id,nome_completo:A.name,email:A.email,telefone:A.phone,status:A.status,tem_acesso_sistema:A.tem_acesso_sistema,auth_user_id:A.auth_user_id}}});console.log("✅ Funcionários carregados:",$.length),$.length>0&&console.log("🔍 Primeiro funcionário:",(C=(N=$[0])==null?void 0:N.employee)==null?void 0:C.name),s($),pu.setList($)}else console.error("Erro ao buscar funcionários:",T.error),l(((S=T.error)==null?void 0:S.message)||"Erro ao buscar funcionários")}catch(T){console.error("Erro ao buscar funcionários:",T),l(T instanceof Error?T.message:"Erro ao buscar funcionários")}finally{r(!1)}},[c]),f=y.useCallback(async N=>{const C=performance.now();try{l(null);const S=await u(async()=>{const T=await Mc();if(!T.success)throw new Error(`Authentication failed: ${T.error}`);let M=B,$="00000000-0000-0000-0000-000000000001";if(T.useAdmin)console.log("🔧 Using admin client for database operations"),M=ut;else{const J=await vt();J&&($=J)}console.log("✅ Creating employee for empresa:",$),console.log("📝 Criando registro na tabela employees...");const A=`EMP-${Date.now()}`,{data:z,error:R}=await M.from("employees").insert([{employee_code:A,name:N.name,email:N.email||null,phone:N.phone||null,cpf:N.cpf||null,empresa_id:$,status:"active",tem_acesso_sistema:!1}]).select().single();if(R)throw console.error("❌ Erro ao criar employee:",R),R;console.log("✅ Employee criado:",z.id);const L=[];N.notes&&L.push(N.notes);const I=L.join(", ");console.log("📝 Criando registro na tabela bar_employees...");const{data:X,error:ce}=await M.from("bar_employees").insert([{employee_id:z.id,bar_role:N.bar_role,shift_preference:N.shift_preference||"qualquer",specialties:N.specialties||[],commission_rate:N.commission_rate||0,is_active:!0,start_date:new Date().toISOString().split("T")[0],notes:I,empresa_id:$}]).select().single();if(ce)throw console.error("❌ Erro ao criar bar_employee:",ce),await M.from("employees").delete().eq("id",z.id),ce;return console.log("✅ Bar employee criado:",X.id),console.log("✅ Funcionário completo criado com sucesso!"),X},N,`pending_save_employee_${Date.now()}`);if(S.success)return Pj({employeeId:S.data.id,role:N.bar_role,source:"manual",duration:performance.now()-C,success:!0}),await h(),S.data.id;throw S.error||new Error("Erro ao criar funcionário")}catch(S){console.error("Erro ao criar funcionário:",S);const T=S instanceof Error?S.message:"Erro ao criar funcionário";throw Pj({employeeId:"failed",role:N.bar_role,source:"manual",duration:performance.now()-C,success:!1,errors:[T]}),l(T),new Error(T)}},[h,u]),p=y.useCallback(async(N,C)=>{try{l(null);const{data:S,error:T}=await B.from("bar_employees").select("notes").eq("id",N).single();if(T)throw T;const M=(S==null?void 0:S.notes)||"",$=F=>{const Z=M.match(F);return Z?Z[1]:""},A=$(/Nome: ([^,]+)/),z=$(/CPF: ([^,]+)/),R=$(/Email: ([^,]+)/),L=$(/Telefone: ([^,]+)/),I=$(/Observações: (.+)$/),X=C.name!==void 0?C.name:A,ce=C.cpf!==void 0?C.cpf:z,J=C.email!==void 0?C.email:R,V=C.phone!==void 0?C.phone:L,Y=C.notes!==void 0?C.notes:I,ee=[];X&&ee.push(`Nome: ${X}`),ce&&ee.push(`CPF: ${ce}`),J&&ee.push(`Email: ${J}`),V&&ee.push(`Telefone: ${V}`),Y&&ee.push(`Observações: ${Y}`);const we=ee.join(", "),D={updated_at:new Date().toISOString(),notes:we};C.bar_role!==void 0&&(D.bar_role=C.bar_role),C.shift_preference!==void 0&&(D.shift_preference=C.shift_preference),C.specialties!==void 0&&(D.specialties=C.specialties),C.commission_rate!==void 0&&(D.commission_rate=C.commission_rate),C.is_active!==void 0&&(D.is_active=C.is_active);const{error:H}=await B.from("bar_employees").update(D).eq("id",N);if(H)throw H;await h()}catch(S){console.error("Erro ao atualizar funcionário:",S);const T=S instanceof Error?S.message:"Erro ao atualizar funcionário";throw l(T),new Error(T)}},[h]),g=y.useCallback(async N=>{try{await p(N,{is_active:!1})}catch(C){throw console.error("Erro ao desativar funcionário:",C),C}},[p]),v=y.useCallback(async N=>{try{await p(N,{is_active:!0})}catch(C){throw console.error("Erro ao reativar funcionário:",C),C}},[p]),b=y.useCallback(async N=>{try{r(!0),l(null);const{data:C,error:S}=await B.from("bar_employees").select(`
          id,
          employees!inner(
            email,
            name,
            profile_id
          )
        `).eq("id",N).single();if(S||!C)throw new Error("Funcionário não encontrado");const T=C.employees.email,M=_(),{data:$,error:A}=await B.rpc("reset_employee_password",{user_email:T,new_password:M});if(A)throw new Error(`Erro ao resetar senha: ${A.message}`);return{success:!0,newPassword:M}}catch(C){const S=C instanceof Error?C.message:"Erro ao resetar senha";return l(S),console.error("Erro ao resetar senha:",C),{success:!1,error:S}}finally{r(!1)}},[]),_=()=>{const N="abcdefghijkmnpqrstuvwxyz23456789";let C="";for(let S=0;S<8;S++)C+=N.charAt(Math.floor(Math.random()*N.length));return C},w=y.useCallback(async N=>{try{const{data:C,error:S}=await B.from("bar_employees").select("*").eq("id",N).single();if(S)throw S;if(!C)return null;const T=C.notes||"",M=T.match(/Nome: ([^,]+)/),$=T.match(/CPF: ([^,]+)/),A=T.match(/Email: ([^,]+)/),z=T.match(/Telefone: ([^,]+)/);return{id:C.id,employee_id:C.employee_id||"",bar_role:C.bar_role,shift_preference:C.shift_preference,specialties:C.specialties||[],commission_rate:C.commission_rate||0,status:C.is_active?"active":"inactive",start_date:C.start_date||"",end_date:C.end_date||void 0,notes:C.notes||void 0,created_at:C.created_at||"",updated_at:C.updated_at||"",employee:{id:C.id,name:M?M[1]:"Nome não informado",cpf:$?$[1]:void 0,email:A?A[1]:void 0,phone:z?z[1]:void 0,hire_date:C.start_date||void 0,status:C.is_active?"active":"inactive"}}}catch(C){return console.error("Erro ao buscar funcionário:",C),null}},[]),E=y.useCallback((N="",C="all",S="all")=>t.filter(T=>{var R,L,I;const M=T.employee;if(!M)return!1;const $=M.name.toLowerCase().includes(N.toLowerCase())||((R=M.phone)==null?void 0:R.includes(N))||((L=M.email)==null?void 0:L.toLowerCase().includes(N.toLowerCase()))||((I=M.cpf)==null?void 0:I.includes(N)),A=C==="all"||T.bar_role===C,z=S==="all"||T.status===S;return $&&A&&z}),[t]),k=y.useCallback(()=>{const N=pu.getStats();if(N)return N;const C=new Date,S=new Date(C.getTime()-30*24*60*60*1e3),T=t.filter(z=>z.start_date?new Date(z.start_date)>=S:!1).length,M=t.length>0?t.reduce((z,R)=>{if(!R.start_date)return z;const L=new Date(R.start_date),I=Math.max(0,Math.floor((C.getTime()-L.getTime())/(30*24*60*60*1e3)));return z+I},0)/t.length:0,$={manha:t.filter(z=>z.shift_preference==="manha").length,tarde:t.filter(z=>z.shift_preference==="tarde").length,noite:t.filter(z=>z.shift_preference==="noite").length,qualquer:t.filter(z=>z.shift_preference==="qualquer"||!z.shift_preference).length},A={total:t.length,active:t.filter(z=>z.status==="active").length,inactive:t.filter(z=>z.status==="inactive").length,byRole:{atendente:t.filter(z=>z.bar_role==="atendente").length,garcom:t.filter(z=>z.bar_role==="garcom").length,cozinheiro:t.filter(z=>z.bar_role==="cozinheiro").length,barman:t.filter(z=>z.bar_role==="barman").length,gerente:t.filter(z=>z.bar_role==="gerente").length},byShift:$,recentHires:T,avgTenure:Math.round(M),topPerformers:Math.floor(t.filter(z=>z.status==="active").length*.2),needsAttention:Math.floor(t.length*.1)};return pu.setStats(A),A},[t]);return y.useEffect(()=>{h()},[h]),{employees:t,loading:a,error:o,createEmployee:f,updateEmployee:p,deactivateEmployee:g,reactivateEmployee:v,resetEmployeePassword:b,getEmployeeById:w,filterEmployees:E,getStats:k,refetch:h}};var x2=(t=>(t.CREATE_EMPLOYEE="create_employee",t.UPDATE_PASSWORD="update_password",t.DEACTIVATE_EMPLOYEE="deactivate_employee",t.REACTIVATE_EMPLOYEE="reactivate_employee",t.UPDATE_PERMISSIONS="update_permissions",t.LIST_EMPLOYEES="list_employees",t.CHECK_EMAIL="check_email",t.GENERATE_CREDENTIALS="generate_credentials",t))(x2||{});const Wn=class Wn{constructor(){dt(this,"logConfig");dt(this,"logs",[]);this.logConfig={level:"info",enableConsole:!0,enablePersistence:!1}}static getInstance(){return Wn.instance||(Wn.instance=new Wn),Wn.instance}configureLogging(s){this.logConfig={...this.logConfig,...s},this.log("info","create_employee","Logging configurado",{config:this.logConfig})}log(s,a,r,o,l){const c={timestamp:new Date().toISOString(),level:s,operation:a,message:r,data:o,error:l};if(this.logConfig.enablePersistence&&(this.logs.push(c),this.logs.length>1e3&&(this.logs=this.logs.slice(-1e3))),this.logConfig.enableConsole&&this.shouldLog(s)){const h=`${this.getLogEmoji(s)} [${a}]`;switch(s){case"debug":console.debug(h,r,o||"");break;case"info":console.log(h,r,o||"");break;case"warn":console.warn(h,r,o||"");break;case"error":console.error(h,r,o||"",l||"");break}}}shouldLog(s){const a=["debug","info","warn","error"],r=a.indexOf(this.logConfig.level);return a.indexOf(s)>=r}getLogEmoji(s){switch(s){case"debug":return"🔍";case"info":return"ℹ️";case"warn":return"⚠️";case"error":return"❌";default:return"📝"}}getLogs(s,a){let r=[...this.logs];return s&&(r=r.filter(o=>o.operation===s)),a&&(r=r.filter(o=>o.level===a)),r}clearLogs(){this.logs=[],this.log("info","create_employee","Logs limpos")}validateEmployeeData(s){var r,o,l;const a=[];return(r=s.nome_completo)!=null&&r.trim()||a.push("Nome completo é obrigatório"),(o=s.email)!=null&&o.trim()?this.isValidEmail(s.email)||a.push("Email deve ter formato válido"):a.push("Email é obrigatório"),s.bar_role||a.push("Função no bar é obrigatória"),(l=s.cargo)!=null&&l.trim()||a.push("Cargo é obrigatório"),s.cpf&&!this.isValidCPF(s.cpf)&&a.push("CPF deve ter formato válido"),s.telefone&&!this.isValidPhone(s.telefone)&&a.push("Telefone deve ter formato válido"),s.commission_rate&&(s.commission_rate<0||s.commission_rate>100)&&a.push("Taxa de comissão deve estar entre 0 e 100"),(!s.permissoes_modulos||Object.keys(s.permissoes_modulos).length===0)&&a.push("Permissões de módulos são obrigatórias"),{valid:a.length===0,errors:a}}isValidEmail(s){return/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(s)}isValidCPF(s){const a=s.replace(/\D/g,"");if(a.length!==11||/^(\d)\1{10}$/.test(a))return!1;let r=0;for(let l=0;l<9;l++)r+=parseInt(a.charAt(l))*(10-l);let o=11-r%11;if((o===10||o===11)&&(o=0),o!==parseInt(a.charAt(9)))return!1;r=0;for(let l=0;l<10;l++)r+=parseInt(a.charAt(l))*(11-l);return o=11-r%11,(o===10||o===11)&&(o=0),o===parseInt(a.charAt(10))}isValidPhone(s){const a=s.replace(/\D/g,"");return a.length>=10&&a.length<=11}createServiceError(s,a,r){const o=new Error(`[${s}] ${a}`);return o.type=s,o.originalError=r,o}handleError(s,a,r){let o="internal_error",l="Erro interno do serviço";a instanceof Error&&(l=a.message,a.message.includes("validation")||a.message.includes("invalid")?o="validation_error":a.message.includes("auth")||a.message.includes("authentication")?o="auth_error":a.message.includes("database")||a.message.includes("Database")?o="database_error":a.message.includes("permission")||a.message.includes("unauthorized")?o="permission_error":(a.message.includes("network")||a.message.includes("fetch"))&&(o="network_error"));const c=r?`${r}: ${l}`:l;return this.log("error",s,c,{errorType:o,context:r},a),{success:!1,error:c}}async executeWithErrorHandling(s,a,r){try{const o=Date.now();this.log("debug",s,`Iniciando operação${r?`: ${r}`:""}`);const l=await a(),c=Date.now()-o;return this.log("debug",s,`Operação concluída em ${c}ms`),l}catch(o){return this.handleError(s,o,r)}}async createCompleteEmployee(s,a){var c,u,h,f,p,g,v,b,_,w;const r=Date.now(),o="create_employee",l={bar_employee_created:!1,auth_user_created:!1,profile_created:!1,usuario_empresa_created:!1,permissions_created:!1,warnings:[]};this.log("info",o,`Iniciando criação do funcionário: ${s.nome_completo}`,{email:s.email,bar_role:s.bar_role,tem_acesso_sistema:s.tem_acesso_sistema,empresa_id:a});try{this.log("debug",o,"Validando dados de entrada");const E=this.validateEmployeeData(s);if(!E.valid){const I=`Dados inválidos: ${E.errors.join(", ")}`;return this.log("error",o,I,{errors:E.errors}),{success:!1,error:I,details:l}}if(this.log("debug",o,"Verificando se email já existe"),await this.checkEmailExists(s.email)){const I=`Email ${s.email} já está em uso no sistema`;return this.log("warn",o,I),{success:!1,error:I,details:l}}let N;s.tem_acesso_sistema&&(this.log("debug",o,"Gerando credenciais de acesso"),N=this.generateCredentials(s.nome_completo,s.email),this.log("info",o,"Credenciais geradas com sucesso",{email:N.email}));let C=null;if(s.tem_acesso_sistema&&N){this.log("info",o,"Criando usuário no Supabase Auth");const I=await this.createAuthUserWithFallback(s,N.senha_temporaria);if(I.success&&I.userId){C=I.userId,l.auth_user_created=!0,this.log("info",o,"Usuário criado no Auth com sucesso",{userId:C});const X=await this.createUserProfileSafely(C,s);X.success?(l.profile_created=!0,this.log("info",o,"Perfil de usuário criado")):((c=l.warnings)==null||c.push(`Erro ao criar perfil: ${X.error}`),this.log("warn",o,"Falha ao criar perfil",{error:X.error}))}else(u=l.warnings)==null||u.push(`Falha na criação do Auth: ${I.error}`),this.log("warn",o,"Auth falhou, continuando sem credenciais",{error:I.error})}else this.log("info",o,"Usuário sem acesso ao sistema - pulando criação no Auth");let S=null;this.log("info",o,"Criando registro na tabela employees");const T=await this.createEmployeeSafely(s,a,C);T.success&&((h=T.data)!=null&&h.employeeId)?(S=T.data.employeeId,l.bar_employee_created=!0,this.log("info",o,"Funcionário criado na tabela employees",{employeeId:S})):((f=l.warnings)==null||f.push(`Erro ao criar employee: ${T.error}`),this.log("warn",o,"Falha ao criar employee",{error:T.error})),this.log("info",o,"Criando registro na tabela bar_employees");const M=await this.createBarEmployeeSafely(s,a,S);if(!M.success){C&&await this.cleanupAuthUserSafely(C);const I=`Erro crítico ao criar funcionário: ${M.error}`;return this.log("error",o,I),{success:!1,error:I,details:l}}l.bar_employee_created=!0;const $=(p=M.data)==null?void 0:p.employeeId;this.log("info",o,"Funcionário criado na tabela bar_employees",{employeeId:$}),this.log("info",o,"Criando registro na tabela usuarios_empresa");const A=await this.createUsuarioEmpresaSafely(s,a,C);let z;if(A.success){l.usuario_empresa_created=!0,z=(g=A.data)==null?void 0:g.usuarioEmpresaId,this.log("info",o,"Registro criado na tabela usuarios_empresa",{usuarioEmpresaId:z}),this.log("info",o,"Configurando permissões do usuário");let I=s.permissoes_modulos;(!I||Object.keys(I).length===0)&&(s.bar_role==="caixa"||(v=s.cargo)!=null&&v.toLowerCase().includes("caixa"))&&(this.log("info",o,"Criando permissões padrão para usuário de caixa"),I={gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}});const X=await this.createUserPermissionsSafely(z,I);X.success?(l.permissions_created=!0,this.log("info",o,"Permissões configuradas com sucesso")):((b=l.warnings)==null||b.push(`Erro ao criar permissões: ${X.error}`),this.log("warn",o,"Falha ao criar permissões",{error:X.error}))}else(_=l.warnings)==null||_.push(`Erro ao criar usuario_empresa: ${A.error}`),this.log("warn",o,"Falha ao criar usuario_empresa",{error:A.error});const R=Date.now()-r;l.execution_time_ms=R;const L={success:!0,employee_id:$,user_id:C||void 0,usuario_empresa_id:z,credentials:s.tem_acesso_sistema&&l.auth_user_created&&N?{email:N.email,senha_temporaria:N.senha_temporaria,deve_alterar_senha:!0}:void 0,details:l};if(l.warnings&&l.warnings.length>0&&this.log("warn",o,"Funcionário criado com avisos",{warnings:l.warnings}),this.log("info",o,`Funcionário criado com sucesso em ${R}ms`,{employee_id:$,has_credentials:!!L.credentials,warnings_count:((w=l.warnings)==null?void 0:w.length)||0}),this.log("info",o,"Verificando dados para mapeamento",{hasEmail:!!s.email,hasBarRole:!!s.bar_role,email:s.email,barRole:s.bar_role}),s.email&&s.bar_role)try{const I=cD(s.bar_role);qn(s.email,I,"system"),this.log("info",o,"✅ Mapeamento de role adicionado com sucesso",{email:s.email,barRole:s.bar_role,middlewareRole:I})}catch(I){this.log("warn",o,"❌ Erro ao adicionar mapeamento de role",{error:I})}else this.log("warn",o,"⚠️ Dados insuficientes para mapeamento de role",{email:s.email,barRole:s.bar_role});return L}catch(E){const k=Date.now()-r;l.execution_time_ms=k;const N=E instanceof Error?E.message:"Erro desconhecido";return this.log("error",o,`Erro geral na criação do funcionário: ${N}`,{executionTime:k},E),{success:!1,error:`Erro interno: ${N}`,details:l}}}generateCredentials(s,a,r){const o="generate_credentials";this.log("debug",o,"Gerando credenciais com senha genérica simples",{email:a,barRole:r});try{const l="123456",c={email:a.toLowerCase().trim(),senha_temporaria:l,deve_alterar_senha:!0};return this.log("info",o,"Credenciais geradas com senha genérica",{email:c.email,senha:l,deve_alterar:!0}),c}catch(l){return this.log("error",o,"Erro ao gerar credenciais",{},l),this.log("warn",o,"Usando fallback com senha genérica"),{email:a.toLowerCase().trim(),senha_temporaria:"123456",deve_alterar_senha:!0}}}generateSecurePasswordFallback(s=6){return"123456"}generateSecurePasswordFallbackOld(s=12){const a="ABCDEFGHJKMNPQRSTUVWXYZ",r="abcdefghijkmnpqrstuvwxyz",o="23456789",l="@#$%&*",c=a+r+o+l;let u="";u+=a[Math.floor(Math.random()*a.length)],u+=r[Math.floor(Math.random()*r.length)],u+=o[Math.floor(Math.random()*o.length)],u+=l[Math.floor(Math.random()*l.length)];for(let h=4;h<s;h++)u+=c[Math.floor(Math.random()*c.length)];return u.split("").sort(()=>Math.random()-.5).join("")}async createAuthUserWithFallback(s,a){const r="create_employee";this.log("info",r,"Iniciando criação no Supabase Auth",{email:s.email});try{this.log("debug",r,"Tentativa 1: criação com metadata completa");let o=await this.tryCreateAuthUser(s,a,!1);if(o.success)return this.log("info",r,"Usuário criado com sucesso na primeira tentativa"),(await this.checkAndConfirmEmail(o.userId)).confirmed&&this.log("info",r,"Email confirmado com sucesso"),o;if(this.log("warn",r,"Primeira tentativa falhou",{error:o.error}),this.isDatabaseRelatedError(o.error)){if(this.log("info",r,"Erro de banco detectado, tentando fallback sem metadata"),o=await this.tryCreateAuthUser(s,a,!0),o.success)return this.log("info",r,"Fallback bem-sucedido - problema era no trigger/função do banco"),(await this.checkAndConfirmEmail(o.userId)).confirmed&&this.log("info",r,"Email confirmado no fallback"),o;this.log("error",r,"Fallback também falhou",{error:o.error})}else this.log("info",r,"Erro não é relacionado ao banco, não tentando fallback");return o}catch(o){const l=o instanceof Error?o.message:"Erro desconhecido";return this.log("error",r,"Erro geral na criação do Auth",{},o),{success:!1,error:l}}}async checkAndConfirmEmail(s){try{if(!Ht)return this.log("warn","create_employee","Admin não configurado - não pode confirmar email automaticamente"),{confirmed:!1,error:"Admin não configurado para confirmação de email"};const{data:a,error:r}=await ut.auth.admin.getUserById(s);if(r||!a.user)return this.log("error","create_employee","Erro ao buscar dados do usuário para confirmação de email",{userId:s},r),{confirmed:!1,error:"Erro ao buscar usuário"};if(a.user.email_confirmed_at)return this.log("debug","create_employee","Email já estava confirmado",{userId:s}),{confirmed:!0};this.log("info","create_employee","Tentando confirmar email automaticamente",{userId:s});const{error:o}=await ut.auth.admin.updateUserById(s,{email_confirm:!0});return o?(this.log("error","create_employee","Erro ao confirmar email",{userId:s},o),{confirmed:!1,error:o.message}):(this.log("info","create_employee","Email confirmado com sucesso",{userId:s}),{confirmed:!0})}catch(a){return this.log("error","create_employee","Erro geral na confirmação de email",{userId:s},a),{confirmed:!1,error:a instanceof Error?a.message:"Erro desconhecido na confirmação de email"}}}isDatabaseRelatedError(s){return s?["Database error","database","trigger","function","relation","column","constraint","foreign key","unique violation"].some(r=>s.toLowerCase().includes(r.toLowerCase())):!1}async tryCreateAuthUser(s,a,r=!1){try{this.log("debug","create_employee",`Tentando criar usuário ${r?"SEM":"COM"} metadata`);const o=r?{}:{name:s.nome_completo,role:s.tipo_usuario||"funcionario",cargo:s.cargo,temporary_password:!0,created_by:"system"};if(Ht){this.log("debug","create_employee","Usando cliente admin (service role) - PREFERRED");const l={email:s.email,password:a,email_confirm:!0};r||(l.user_metadata=o);const{data:c,error:u}=await ut.auth.admin.createUser(l);return u?(this.log("warn","create_employee",`Admin createUser falhou: ${u.message}`),{success:!1,error:`Erro admin: ${u.message}`}):c.user?(this.log("info","create_employee","Usuário criado via admin com email confirmado"),{success:!0,userId:c.user.id}):{success:!1,error:"Usuário não foi criado via admin"}}else{this.log("debug","create_employee","Admin não configurado - usando cliente normal");const l={email:s.email,password:a};r||(l.options={data:{name:s.nome_completo,role:"employee"}});const{data:c,error:u}=await B.auth.signUp(l);return u?(this.log("error","create_employee",`SignUp falhou: ${u.message}`),u.message.includes("Database error")&&!r?(this.log("warn","create_employee","Tentando novamente sem metadata devido ao erro de database"),this.tryCreateAuthUser(s,a,!0)):{success:!1,error:u.message}):c.user?(c.user.email_confirmed_at||this.log("warn","create_employee","Email não foi confirmado automaticamente - usuário pode não conseguir fazer login"),{success:!0,userId:c.user.id}):{success:!1,error:"Usuário não foi criado"}}}catch(o){return this.log("error","create_employee","Erro geral em tryCreateAuthUser",{},o),{success:!1,error:o instanceof Error?o.message:"Erro desconhecido"}}}async createUserProfileSafely(s,a){return this.executeWithErrorHandling("create_employee",async()=>{const{data:r}=await B.from("profiles").select("id").eq("id",s).single();if(r)return this.log("info","create_employee","Perfil já existe - pulando criação"),{success:!0};const o="employee",{error:l}=await B.from("profiles").insert([{id:s,name:a.nome_completo,role:o,avatar_url:`https://api.dicebear.com/8.x/initials/svg?seed=${encodeURIComponent(a.nome_completo)}`,updated_at:new Date().toISOString()}]);if(l){if(l.code==="PGRST116"||l.message.includes("does not exist"))return this.log("warn","create_employee","Tabela profiles não existe - pulando criação de perfil"),{success:!0};if(l.code==="23505"||l.message.includes("duplicate key"))return this.log("info","create_employee","Perfil já existe (constraint duplicada) - continuando"),{success:!0};throw new Error(l.message)}return{success:!0}},"Criação de perfil de usuário")}async createEmployeeSafely(s,a,r){return this.executeWithErrorHandling("create_employee",async()=>{var p,g;let o=null,l=null;try{const{data:v}=await B.from("departments").select("id").eq("is_active",!0).limit(1);o=(p=v==null?void 0:v[0])==null?void 0:p.id;const{data:b}=await B.from("positions").select("id").eq("is_active",!0).limit(1);l=(g=b==null?void 0:b[0])==null?void 0:g.id,this.log("info","create_employee","Department e Position encontrados",{departmentId:o,positionId:l})}catch(v){this.log("warn","create_employee","Erro ao buscar departamento e posição",{},v)}(!o||!l)&&this.log("warn","create_employee","Criando employee sem department/position devido a erros");const c=Ht?ut:B,u={employee_code:`EMP-${Date.now()}`,name:s.nome_completo,email:s.email,hire_date:new Date().toISOString().split("T")[0],status:"active",empresa_id:a};o&&(u.department_id=o),l&&(u.position_id=l),r&&(u.profile_id=r);const{data:h,error:f}=await c.from("employees").insert(u).select("id").single();if(f)throw new Error(f.message);return{success:!0,data:{employeeId:h==null?void 0:h.id}}},"Criação de registro employees")}async createBarEmployeeSafely(s,a,r){return this.executeWithErrorHandling("create_employee",async()=>{const o=[];o.push(`Nome: ${s.nome_completo}`),s.cpf&&o.push(`CPF: ${s.cpf}`),o.push(`Email: ${s.email}`),s.telefone&&o.push(`Telefone: ${s.telefone}`),s.observacoes&&o.push(`Observações: ${s.observacoes}`);const l=o.join(", ");if(!r)throw new Error("Employee ID é obrigatório para criar registro na tabela bar_employees");const c=Ht?ut:B,{data:u,error:h}=await c.from("bar_employees").insert([{employee_id:r,bar_role:s.bar_role,shift_preference:s.shift_preference||"qualquer",specialties:s.specialties||[],commission_rate:s.commission_rate||0,is_active:!0,start_date:new Date().toISOString().split("T")[0],notes:l,empresa_id:a}]).select("id").single();if(h)throw new Error(h.message);return{success:!0,data:{employeeId:u==null?void 0:u.id}}},"Criação de registro bar_employees")}async createUsuarioEmpresaSafely(s,a,r){return this.executeWithErrorHandling("create_employee",async()=>{const o=Ht?ut:B,{data:l,error:c}=await o.from("usuarios_empresa").insert([{user_id:r,empresa_id:a,nome_completo:s.nome_completo,email:s.email,telefone:s.telefone,cargo:s.cargo,tipo_usuario:s.tipo_usuario||"funcionario",status:"ativo",senha_provisoria:!0,ativo:!0,tem_acesso_sistema:s.tem_acesso_sistema,papel:s.papel||"USER",is_primeiro_usuario:!1,tentativas_login_falhadas:0,total_logins:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select("id").single();if(c)throw new Error(c.message);return{success:!0,data:{usuarioEmpresaId:l==null?void 0:l.id}}},"Criação de registro usuarios_empresa")}async createUserPermissionsSafely(s,a){return this.executeWithErrorHandling("create_employee",async()=>{this.log("info","create_employee","Dados de permissões recebidos",{usuarioEmpresaId:s,permissoesModulos:a,modulosCount:Object.keys(a||{}).length}),(!a||Object.keys(a).length===0)&&(this.log("warn","create_employee","Nenhuma permissão fornecida - criando permissões padrão para caixa"),a={gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}});const r=Object.entries(a).map(([c,u])=>({usuario_empresa_id:s,modulo:c,permissoes:u,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}));this.log("info","create_employee","Inserindo permissões",{permissionsCount:r.length,permissions:r});const o=Ht?ut:B,{error:l}=await o.from("permissoes_usuario").insert(r);if(l)throw this.log("error","create_employee","Erro ao inserir permissões",{error:l}),new Error(l.message);return this.log("info","create_employee","Permissões inseridas com sucesso"),{success:!0}},"Criação de permissões de usuário")}async cleanupAuthUserSafely(s){try{Ht&&(await ut.auth.admin.deleteUser(s),this.log("info","create_employee","Usuário removido do Auth após erro",{userId:s}))}catch(a){this.log("error","create_employee","Erro ao limpar usuário do Auth",{userId:s},a)}}async createUserProfile(s,a){try{const{error:r}=await B.from("profiles").insert({id:s,name:a.nome_completo,role:a.tipo_usuario||"employee",avatar_url:`https://api.dicebear.com/8.x/initials/svg?seed=${encodeURIComponent(a.nome_completo)}`,updated_at:new Date().toISOString()});return r?r.code==="PGRST116"||r.message.includes("does not exist")?(console.warn("⚠️ Tabela profiles não existe - pulando criação de perfil"),{success:!0}):{success:!1,error:r.message}:{success:!0}}catch(r){return console.warn("⚠️ Erro ao criar perfil (não crítico):",r),{success:!0}}}async createBarEmployee(s,a,r){try{const o=[];o.push(`Nome: ${s.nome_completo}`),s.cpf&&o.push(`CPF: ${s.cpf}`),o.push(`Email: ${s.email}`),s.telefone&&o.push(`Telefone: ${s.telefone}`),s.observacoes&&o.push(`Observações: ${s.observacoes}`);const l=o.join(", "),c=Ht?ut:B,{data:u,error:h}=await c.from("bar_employees").insert([{employee_id:r,bar_role:s.bar_role,shift_preference:s.shift_preference||"qualquer",specialties:s.specialties||[],commission_rate:s.commission_rate||0,is_active:!0,start_date:new Date().toISOString().split("T")[0],notes:l,empresa_id:a}]).select("id").single();return h?{success:!1,error:h.message}:{success:!0,employeeId:u==null?void 0:u.id}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Erro desconhecido"}}}async createUsuarioEmpresa(s,a,r){try{const o=Ht?ut:B,{data:l,error:c}=await o.from("usuarios_empresa").insert([{user_id:r,empresa_id:a,nome_completo:s.nome_completo,email:s.email,telefone:s.telefone,cargo:s.cargo,tipo_usuario:s.tipo_usuario||"funcionario",status:"ativo",senha_provisoria:!0,ativo:!0,tem_acesso_sistema:s.tem_acesso_sistema,papel:s.papel||"USER",is_primeiro_usuario:!1,tentativas_login_falhadas:0,total_logins:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select("id").single();return c?{success:!1,error:c.message}:{success:!0,usuarioEmpresaId:l==null?void 0:l.id}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Erro desconhecido"}}}async createPermissoesUsuario(s,a){try{const r=Object.entries(a).map(([c,u])=>({usuario_empresa_id:s,modulo:c,permissoes:u,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),o=Ht?ut:B,{error:l}=await o.from("permissoes_usuario").insert(r);return l?{success:!1,error:l.message}:{success:!0}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Erro desconhecido"}}}async createUserAuth(s,a,r){try{const{data:o,error:l}=await B.auth.signUp({email:s,password:a,options:{data:{name:r.nome_completo,role:"funcionario"}}});return l?{success:!1,error:l.message}:o.user?{success:!0,userId:o.user.id}:{success:!1,error:"Usuário não foi criado"}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Erro desconhecido"}}}async createUserProfile(s,a){const r=new Date().toISOString();try{const{error:o}=await B.from("profiles").insert([{id:s,name:a.name,role:"employee",avatar_url:`https://api.dicebear.com/8.x/initials/svg?seed=${encodeURIComponent(a.name)}`,updated_at:r}]);return o?{success:!1,error:o.message}:{success:!0}}catch(o){return{success:!1,error:o instanceof Error?o.message:"Erro desconhecido"}}}async createBarEmployee(s,a,r,o,l,c,u){try{const{data:h,error:f}=await B.from("bar_employees").insert([{employee_id:s,bar_role:a,shift_preference:r,specialties:o,commission_rate:l,is_active:!0,start_date:new Date().toISOString().split("T")[0],notes:c,empresa_id:u}]).select("id").single();return f?{success:!1,error:f.message}:{success:!0,employeeId:h==null?void 0:h.id}}catch(h){return{success:!1,error:h instanceof Error?h.message:"Erro desconhecido"}}}async createUsuarioEmpresaSafely(s,a,r){return this.executeWithErrorHandling("create_employee",async()=>{const o=Ht?ut:B,{data:l,error:c}=await o.from("usuarios_empresa").insert([{user_id:r,empresa_id:a,nome_completo:s.nome_completo,email:s.email,telefone:s.telefone,cargo:s.cargo,tipo_usuario:s.tipo_usuario||"funcionario",status:"ativo",senha_provisoria:!0,ativo:!0,tem_acesso_sistema:s.tem_acesso_sistema,papel:s.papel||"USER",is_primeiro_usuario:!1,tentativas_login_falhadas:0,total_logins:0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}]).select("id").single();if(c)throw new Error(c.message);return{success:!0,data:{usuarioEmpresaId:l==null?void 0:l.id}}},"Criação de registro usuarios_empresa")}async createUserPermissions(s,a){try{const r=Object.entries(a).map(([c,u])=>({usuario_empresa_id:s,modulo:c,permissoes:u,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),o=Ht?ut:B,{error:l}=await o.from("permissoes_usuario").insert(r);return l?{success:!1,error:l.message}:{success:!0}}catch(r){return{success:!1,error:r instanceof Error?r.message:"Erro desconhecido"}}}async checkEmailExists(s){const a="check_email";try{this.log("debug",a,"Verificando se email já existe",{email:s});const{data:r,error:o}=await B.from("usuarios_empresa").select("id").eq("email",s.toLowerCase().trim()).limit(1);if(o)return this.log("error",a,"Erro ao consultar banco de dados",{email:s},o),!1;const l=r&&r.length>0;return this.log("debug",a,`Email ${l?"já existe":"não existe"} no sistema`,{email:s,exists:l}),l}catch(r){return this.log("error",a,"Erro geral ao verificar email",{email:s},r),!1}}async cleanupAuthUser(s){try{Ht&&(await ut.auth.admin.deleteUser(s),console.log("🗑️ Usuário removido do Auth após erro:",s))}catch(a){console.error("❌ Erro ao limpar usuário do Auth:",a)}}static async generateDefaultPermissions(s){try{const{permissionPresetManager:a}=await ha(async()=>{const{permissionPresetManager:c}=await Promise.resolve().then(()=>hz);return{permissionPresetManager:c}},void 0);if(!["atendente","garcom","cozinheiro","barman","gerente"].includes(s))return console.warn(`Função inválida: ${s}. Usando permissões básicas.`),{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}};const o=a.getDefaultPermissions(s),l={};for(const[c,u]of Object.entries(o))l[c]={visualizar:u.visualizar,criar:u.criar,editar:u.editar,excluir:u.excluir,administrar:u.administrar};return l}catch(a){return console.error("Erro ao gerar permissões padrão:",a),{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}}}}async updateEmployeePassword(s,a,r=!1){const o="update_password";return this.log("info",o,"Iniciando atualização de senha",{userId:s,isTemporary:r}),this.executeWithErrorHandling(o,async()=>{if(!Ht)throw this.createServiceError("permission_error","Configuração admin não disponível para atualização de senha");if(!a||a.length<6)throw this.createServiceError("validation_error","Nova senha deve ter pelo menos 6 caracteres");this.log("debug",o,"Atualizando senha no Supabase Auth");const{error:l}=await ut.auth.admin.updateUserById(s,{password:a});if(l)throw this.createServiceError("auth_error",l.message);this.log("debug",o,"Atualizando flag de senha provisória");const{error:c}=await ut.from("usuarios_empresa").update({senha_provisoria:r,updated_at:new Date().toISOString()}).eq("user_id",s);return c&&this.log("warn",o,"Erro ao atualizar flag senha_provisoria",{},c),this.log("info",o,"Senha atualizada com sucesso"),{success:!0}},"Atualização de senha de funcionário")}async deactivateEmployee(s){const a="deactivate_employee";return this.log("info",a,"Iniciando desativação de funcionário",{employeeId:s}),this.executeWithErrorHandling(a,async()=>{if(!(s!=null&&s.trim()))throw this.createServiceError("validation_error","ID do funcionário é obrigatório");this.log("debug",a,"Desativando na tabela bar_employees");const{error:r}=await ut.from("bar_employees").update({is_active:!1,end_date:new Date().toISOString().split("T")[0],updated_at:new Date().toISOString()}).eq("id",s);if(r)throw this.createServiceError("database_error",r.message);this.log("debug",a,"Buscando user_id do funcionário");const{data:o,error:l}=await ut.from("bar_employees").select("employee_id").eq("id",s).single();if(l||!(o!=null&&o.employee_id))return this.log("warn",a,"Não foi possível encontrar user_id para desativar na usuarios_empresa"),{success:!0};this.log("debug",a,"Desativando na tabela usuarios_empresa");const{error:c}=await ut.from("usuarios_empresa").update({ativo:!1,status:"inativo",updated_at:new Date().toISOString()}).eq("user_id",o.employee_id);return c&&this.log("warn",a,"Erro ao desativar na usuarios_empresa",{},c),this.log("info",a,"Funcionário desativado com sucesso"),{success:!0}},"Desativação de funcionário")}async reactivateEmployee(s){const a="reactivate_employee";return this.log("info",a,"Iniciando reativação de funcionário",{employeeId:s}),this.executeWithErrorHandling(a,async()=>{if(!(s!=null&&s.trim()))throw this.createServiceError("validation_error","ID do funcionário é obrigatório");this.log("debug",a,"Reativando na tabela bar_employees");const{error:r}=await ut.from("bar_employees").update({is_active:!0,end_date:null,updated_at:new Date().toISOString()}).eq("id",s);if(r)throw this.createServiceError("database_error",r.message);this.log("debug",a,"Buscando user_id do funcionário");const{data:o,error:l}=await ut.from("bar_employees").select("employee_id").eq("id",s).single();if(l||!(o!=null&&o.employee_id))return this.log("warn",a,"Não foi possível encontrar user_id para reativar na usuarios_empresa"),{success:!0};this.log("debug",a,"Reativando na tabela usuarios_empresa");const{error:c}=await ut.from("usuarios_empresa").update({ativo:!0,status:"ativo",updated_at:new Date().toISOString()}).eq("user_id",o.employee_id);return c&&this.log("warn",a,"Erro ao reativar na usuarios_empresa",{},c),this.log("info",a,"Funcionário reativado com sucesso"),{success:!0}},"Reativação de funcionário")}async updateEmployeePermissions(s,a){const r="update_permissions";return this.log("info",r,"Iniciando atualização de permissões",{usuarioEmpresaId:s,modulesCount:Object.keys(a).length}),this.executeWithErrorHandling(r,async()=>{if(!(s!=null&&s.trim()))throw this.createServiceError("validation_error","ID do usuário empresa é obrigatório");if(!a||Object.keys(a).length===0)throw this.createServiceError("validation_error","Novas permissões são obrigatórias");this.log("debug",r,"Removendo permissões existentes");const{error:o}=await ut.from("permissoes_usuario").delete().eq("usuario_empresa_id",s);if(o)throw this.createServiceError("database_error",o.message);this.log("debug",r,"Inserindo novas permissões");const l=Object.entries(a).map(([u,h])=>({usuario_empresa_id:s,modulo:u,permissoes:h,created_at:new Date().toISOString(),updated_at:new Date().toISOString()})),{error:c}=await ut.from("permissoes_usuario").insert(l);if(c)throw this.createServiceError("database_error",c.message);return this.log("info",r,"Permissões atualizadas com sucesso"),{success:!0}},"Atualização de permissões de funcionário")}async resetEmployeePassword(s,a){const r=x2.UPDATE_EMPLOYEE;return this.executeWithErrorHandling(r,async()=>{const{data:o,error:l}=await B.from("bar_employees").select(`
            employee_id,
            employees!inner(
              profile_id,
              name,
              email
            )
          `).eq("id",s).eq("empresa_id",a).single();if(l||!o)throw new Error("Funcionário não encontrado");const c=o.employees.email;o.employees.name;const u=this.generateCredentials(c);try{const{error:h}=await B.auth.admin.updateUserById(o.employees.profile_id,{password:u.senha_temporaria});if(h)throw new Error(`Erro ao resetar senha: ${h.message}`);return this.log("info",r,"Senha resetada com sucesso",{employeeId:s,email:c}),{success:!0,credentials:{email:c,senha_temporaria:u.senha_temporaria}}}catch(h){throw new Error(`Falha ao resetar senha: ${h.message}`)}},"Reset de senha do funcionário")}async listEmployees(s,a=!1){const r="list_employees";return this.log("info",r,"Iniciando listagem de funcionários",{empresaId:s,includeInactive:a}),this.executeWithErrorHandling(r,async()=>{if(!(s!=null&&s.trim()))throw this.createServiceError("validation_error","ID da empresa é obrigatório");let o=B.from("bar_employees").select(`
            id,
            employee_id,
            bar_role,
            shift_preference,
            specialties,
            commission_rate,
            is_active,
            start_date,
            end_date,
            notes,
            created_at,
            updated_at,
            usuarios_empresa:employee_id (
              nome_completo,
              email,
              telefone,
              cargo,
              status,
              senha_provisoria
            )
          `).eq("empresa_id",s);a||(o=o.eq("is_active",!0)),this.log("debug",r,"Executando consulta no banco de dados");const{data:l,error:c}=await o.order("created_at",{ascending:!1});if(c)throw this.createServiceError("database_error",c.message);const u=l||[];return this.log("info",r,`Listagem concluída: ${u.length} funcionários encontrados`),{success:!0,employees:u,total:u.length}},"Listagem de funcionários")}};dt(Wn,"instance");let $a=Wn;$a.getInstance();const K8=()=>{const[t,s]=y.useState(!1),[a,r]=y.useState(null),o=y.useCallback(async g=>{try{s(!0),r(null);const v=await Mc();if(!v.success)throw new Error(`Falha na autenticação: ${v.error}`);const b=await vt();if(!b)throw new Error("Não foi possível obter o ID da empresa do usuário atual. Verifique se você está logado corretamente.");const _=b,E=await $a.getInstance().createCompleteEmployee(g,_);return E.success||r(E.error||"Erro ao criar funcionário"),E}catch(v){const b=v instanceof Error?v.message:"Erro ao criar funcionário";return r(b),{success:!1,error:b}}finally{s(!1)}},[]),l=y.useCallback(async g=>{const v={gerente:"Gerente de Bar",atendente:"Atendente de Caixa",garcom:"Garçom",cozinheiro:"Cozinheiro",barman:"Barman"},b={gerente:"administrador",atendente:"funcionario",garcom:"funcionario",cozinheiro:"funcionario",barman:"funcionario"},_={gerente:"MANAGER",atendente:"USER",garcom:"USER",cozinheiro:"USER",barman:"USER"},w={...g,cargo:v[g.bar_role]||"Funcionário",tipo_usuario:b[g.bar_role]||"funcionario",papel:_[g.bar_role]||"USER",permissoes_modulos:await $a.generateDefaultPermissions(g.bar_role)};return await o(w)},[o]),c=y.useCallback(async(g,v,b=!1)=>{try{s(!0),r(null);const w=await $a.getInstance().updateEmployeePassword(g,v,b);return w.success||r(w.error||"Erro ao atualizar senha"),w}catch(_){const w=_ instanceof Error?_.message:"Erro ao atualizar senha";return r(w),{success:!1,error:w}}finally{s(!1)}},[]),u=y.useCallback(async g=>{try{s(!0),r(null);const b=await $a.getInstance().deactivateEmployee(g);return b.success||r(b.error||"Erro ao desativar funcionário"),b}catch(v){const b=v instanceof Error?v.message:"Erro ao desativar funcionário";return r(b),{success:!1,error:b}}finally{s(!1)}},[]),h=y.useCallback(async g=>{try{s(!0),r(null);const b=await $a.getInstance().reactivateEmployee(g);return b.success||r(b.error||"Erro ao reativar funcionário"),b}catch(v){const b=v instanceof Error?v.message:"Erro ao reativar funcionário";return r(b),{success:!1,error:b}}finally{s(!1)}},[]),f=y.useCallback(async(g,v)=>{try{s(!0),r(null);const _=await $a.getInstance().updateEmployeePermissions(g,v);return _.success||r(_.error||"Erro ao atualizar permissões"),_}catch(b){const _=b instanceof Error?b.message:"Erro ao atualizar permissões";return r(_),{success:!1,error:_}}finally{s(!1)}},[]),p=y.useCallback(async(g=!1)=>{try{s(!0),r(null);let v="00000000-0000-0000-0000-000000000001";const b=await Mc();if(b.success&&!b.useAdmin){const E=await vt();E&&(v=E)}const w=await $a.getInstance().listEmployees(v,g);return w.success||r(w.error||"Erro ao listar funcionários"),w}catch(v){const b=v instanceof Error?v.message:"Erro ao listar funcionários";return r(b),{success:!1,error:b}}finally{s(!1)}},[]);return{loading:t,error:a,createEmployee:o,createEmployeeWithDefaultPermissions:l,updatePassword:c,deactivateEmployee:u,reactivateEmployee:h,updatePermissions:f,listEmployees:p,setError:r}},X8=[{feature:"tables",level:"full"},{feature:"orders",level:"full"},{feature:"menu",level:"read"},{feature:"customers",level:"write"},{feature:"payments",level:"read"}],co={waiter:{role:"waiter",description:"Garçom - Atendimento e pedidos",permissions:[{id:"bar-view",module:"bar",action:"view"},{id:"bar-create-orders",module:"bar",action:"create",resource:"orders"},{id:"bar-edit-own-orders",module:"bar",action:"edit",resource:"own_orders"},{id:"customers-view",module:"customers",action:"view"},{id:"customers-create",module:"customers",action:"create"},{id:"app-garcom-access",module:"app-garcom",action:"access"},{id:"app-garcom-tables",module:"app-garcom",action:"manage",resource:"tables"},{id:"app-garcom-orders",module:"app-garcom",action:"manage",resource:"orders"}]},cook:{role:"cook",description:"Cozinheiro - Preparo e cozinha",permissions:[{id:"kitchen-view",module:"kitchen",action:"view"},{id:"kitchen-edit-status",module:"kitchen",action:"edit",resource:"order_status"},{id:"inventory-view",module:"inventory",action:"view"},{id:"bar-view-orders",module:"bar",action:"view",resource:"orders"}]},cashier:{role:"cashier",description:"Caixa - Pagamentos e fechamento",permissions:[{id:"cashier-view",module:"cashier",action:"view"},{id:"cashier-manage",module:"cashier",action:"manage"},{id:"bar-view-orders",module:"bar",action:"view",resource:"orders"},{id:"reports-view-daily",module:"reports",action:"view",resource:"daily_sales"}]},supervisor:{role:"supervisor",description:"Supervisor - Supervisão operacional",permissions:[{id:"bar-manage",module:"bar",action:"manage"},{id:"kitchen-manage",module:"kitchen",action:"manage"},{id:"cashier-view",module:"cashier",action:"view"},{id:"reports-view",module:"reports",action:"view"},{id:"inventory-view",module:"inventory",action:"view"},{id:"customers-manage",module:"customers",action:"manage"}]},manager:{role:"manager",description:"Gerente - Gestão completa",permissions:[{id:"bar-manage",module:"bar",action:"manage"},{id:"kitchen-manage",module:"kitchen",action:"manage"},{id:"cashier-manage",module:"cashier",action:"manage"},{id:"reports-manage",module:"reports",action:"manage"},{id:"inventory-manage",module:"inventory",action:"manage"},{id:"customers-manage",module:"customers",action:"manage"},{id:"settings-view",module:"settings",action:"view"}]},admin:{role:"admin",description:"Administrador - Acesso total",permissions:[{id:"bar-manage",module:"bar",action:"manage"},{id:"kitchen-manage",module:"kitchen",action:"manage"},{id:"cashier-manage",module:"cashier",action:"manage"},{id:"reports-manage",module:"reports",action:"manage"},{id:"inventory-manage",module:"inventory",action:"manage"},{id:"customers-manage",module:"customers",action:"manage"},{id:"settings-manage",module:"settings",action:"manage"}]}},Q8=t=>({waiter:"Garçom",cook:"Cozinheiro",cashier:"Caixa",supervisor:"Supervisor",manager:"Gerente",admin:"Administrador"})[t],J8=t=>({bar:"Bar/Atendimento",kitchen:"Cozinha",cashier:"Caixa",reports:"Relatórios",inventory:"Estoque",customers:"Clientes",settings:"Configurações","app-garcom":"App Garçom"})[t]||t,ez=t=>({view:"Visualizar",create:"Criar",edit:"Editar",delete:"Excluir",manage:"Gerenciar",access:"Acessar"})[t]||t,tz=t=>{const s=t.replace(/\D/g,"");if(s.length!==11||/^(\d)\1{10}$/.test(s))return!1;let a=0;for(let o=0;o<9;o++)a+=parseInt(s.charAt(o))*(10-o);let r=a*10%11;if((r===10||r===11)&&(r=0),r!==parseInt(s.charAt(9)))return!1;a=0;for(let o=0;o<10;o++)a+=parseInt(s.charAt(o))*(11-o);return r=a*10%11,(r===10||r===11)&&(r=0),r===parseInt(s.charAt(10))},sz=t=>/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t),az=t=>{const s=t.replace(/\D/g,"");return s.length===10||s.length===11},rz=t=>t.replace(/\D/g,"").replace(/(\d{3})(\d{3})(\d{3})(\d{2})/,"$1.$2.$3-$4"),nz=t=>{const s=t.replace(/\D/g,"");return s.length===11?s.replace(/(\d{2})(\d{5})(\d{4})/,"($1) $2-$3"):s.length===10?s.replace(/(\d{2})(\d{4})(\d{4})/,"($1) $2-$3"):t},zj=t=>{var a,r,o;const s=[];return(a=t.name)!=null&&a.trim()?t.name.trim().length<2&&s.push({field:"name",message:"Nome deve ter pelo menos 2 caracteres",type:"format"}):s.push({field:"name",message:"Nome é obrigatório",type:"required"}),(r=t.cpf)!=null&&r.trim()?tz(t.cpf)||s.push({field:"cpf",message:"CPF inválido",type:"format"}):s.push({field:"cpf",message:"CPF é obrigatório",type:"required"}),(o=t.email)!=null&&o.trim()?sz(t.email)||s.push({field:"email",message:"Email inválido",type:"format"}):s.push({field:"email",message:"Email é obrigatório",type:"required"}),t.phone&&!az(t.phone)&&s.push({field:"phone",message:"Telefone inválido",type:"format"}),t.role||s.push({field:"role",message:"Função é obrigatória",type:"required"}),t.hire_date?t.hire_date>new Date&&s.push({field:"hire_date",message:"Data de contratação não pode ser futura",type:"format"}):s.push({field:"hire_date",message:"Data de contratação é obrigatória",type:"required"}),s},oz=()=>{const[t,s]=y.useState({fields:[]}),a=y.useCallback(h=>{const f=zj(h);return s({fields:f,general:f.length>0?"Por favor, corrija os erros antes de continuar":void 0}),f.length===0},[]),r=y.useCallback((h,f,p)=>{const g={...p,[h]:f},b=zj(g).find(_=>_.field===h);return s(_=>({..._,fields:[..._.fields.filter(w=>w.field!==h),...b?[b]:[]]})),b||null},[]),o=y.useCallback(()=>{s({fields:[]})},[]),l=y.useCallback(h=>{s(f=>({...f,fields:f.fields.filter(p=>p.field!==h)}))},[]),c=y.useCallback(h=>t.fields.find(f=>f.field===h),[t.fields]),u=t.fields.length>0||!!t.general;return{errors:t,validateForm:a,validateField:r,clearErrors:o,clearFieldError:l,getFieldError:c,hasErrors:u}},iz=()=>{const[t,s]=y.useState([]);return y.useEffect(()=>{const l=localStorage.getItem("offline_employees");if(l)try{const c=JSON.parse(l);s(c)}catch(c){console.error("Erro ao carregar dados offline:",c)}},[]),{offlineEmployees:t,saveOffline:l=>{const c={...l,id:`offline_${Date.now()}`,_offline:!0,_timestamp:Date.now()},u=[...t,c];return s(u),localStorage.setItem("offline_employees",JSON.stringify(u)),c},syncOfflineData:async l=>{const c=[...t];for(const u of c)try{const{_offline:h,_timestamp:f,...p}=u;await l(p);const g=t.filter(v=>v.id!==u.id);s(g),localStorage.setItem("offline_employees",JSON.stringify(g)),console.log(`✅ Funcionário ${u.name} sincronizado`)}catch(h){console.error(`❌ Erro ao sincronizar ${u.name}:`,h)}},clearOfflineData:()=>{s([]),localStorage.removeItem("offline_employees")},hasOfflineData:t.length>0}},_g=()=>{const[t,s]=y.useState(navigator.onLine),[a,r]=y.useState(!1);return y.useEffect(()=>{const o=()=>{s(!0),a&&console.log("🌐 Conexão restaurada")},l=()=>{s(!1),r(!0),console.log("🔌 Conexão perdida")};return window.addEventListener("online",o),window.addEventListener("offline",l),()=>{window.removeEventListener("online",o),window.removeEventListener("offline",l)}},[a]),{isOnline:t,wasOffline:a}},lz=()=>{const[t,s]=y.useState(0),[a,r]=y.useState(!1),o=y.useCallback(async(c,u={maxRetries:2,retryDelay:3e3,timeoutDuration:45e3})=>{const{maxRetries:h,retryDelay:f,timeoutDuration:p}=u;for(let g=0;g<=h;g++)try{s(g),g>0&&(r(!0),await new Promise(_=>setTimeout(_,f)));const v=new Promise((_,w)=>setTimeout(()=>w(new Error(`Timeout na tentativa ${g+1}`)),p)),b=await Promise.race([c(),v]);return s(0),r(!1),b}catch(v){if(console.log(`Tentativa ${g+1} falhou:`,v),g===h||v instanceof Error&&!v.message.includes("Timeout"))throw s(0),r(!1),v}throw new Error("Todas as tentativas falharam")},[]),l=y.useCallback(()=>{s(0),r(!1)},[]);return{executeWithRetry:o,retryCount:t,isRetrying:a,reset:l}},Ng=()=>{const[t,s]=y.useState(!1),[a,r]=y.useState(null),o=y.useCallback(async f=>{try{r(null),console.log("🔍 Buscando permissões para employeeId:",f);const{data:p,error:g}=await B.from("employees").select("id, name, profile_id, tem_acesso_sistema").eq("id",f).single();if(g||!p)return console.error("❌ Erro ao buscar employee:",g),[];if(!p.profile_id||!p.tem_acesso_sistema)return console.log("⚠️ Employee sem credenciais, sem permissões específicas"),[];const{data:v,error:b}=await B.from("usuarios_empresa").select("id, user_id, nome_completo, tem_acesso_sistema, status").eq("user_id",p.profile_id).single();if(b||!v)return console.error("❌ Erro ao buscar usuario_empresa:",b),[];console.log("👤 Usuário encontrado:",v.nome_completo);const{data:_,error:w}=await B.from("permissoes_usuario").select("id, modulo, permissoes").eq("usuario_empresa_id",v.id);if(w)throw console.error("❌ Erro ao buscar permissões:",w),new Error(`Erro ao buscar permissões: ${w.message}`);return console.log(`✅ ${(_==null?void 0:_.length)||0} permissões específicas encontradas`),(_||[]).map(E=>({...E,usuario_empresa_id:v.id}))}catch(p){const g=p instanceof Error?p.message:"Erro ao buscar permissões";return r(g),console.error("Erro ao buscar permissões:",p),[]}},[]),l=y.useCallback(async(f,p)=>{try{s(!0),r(null),console.log("💾 Salvando permissões para funcionário:",f),console.log("📋 Permissões:",p),console.log("🔍 Buscando employee e suas credenciais...");const{data:g,error:v}=await B.from("employees").select("id, name, email, profile_id, tem_acesso_sistema").eq("id",f).single();if(v||!g)throw console.error("❌ Erro ao buscar employee:",v),new Error("Funcionário não encontrado.");if(console.log("👤 Employee encontrado:",g),!g.profile_id||!g.tem_acesso_sistema)throw console.error("❌ Employee sem credenciais:",{profile_id:g.profile_id,tem_acesso_sistema:g.tem_acesso_sistema}),new Error("Funcionário não tem credenciais de sistema. Crie credenciais primeiro.");const{data:b,error:_}=await B.from("usuarios_empresa").select("id, user_id, nome_completo, tem_acesso_sistema, status").eq("user_id",g.profile_id).single();if(_||!b)throw console.error("❌ Erro ao buscar usuario_empresa:",_),new Error("Vínculo do usuário não encontrado.");if(console.log("👤 Usuário encontrado:",b),!b.user_id||!b.tem_acesso_sistema)throw console.error("❌ Usuário sem credenciais válidas:",{user_id:b.user_id,tem_acesso_sistema:b.tem_acesso_sistema}),new Error("Usuário não tem credenciais de sistema. Crie credenciais primeiro.");if(b.status!=="ativo")throw console.error("❌ Usuário não está ativo:",b.status),new Error("Usuário não está ativo no sistema.");console.log("✅ Usuário válido para salvar permissões"),console.log("🗑️ Removendo permissões existentes...");const{error:w}=await B.from("permissoes_usuario").delete().eq("usuario_empresa_id",b.id);if(w)throw console.error("❌ Erro ao deletar permissões existentes:",w),new Error(`Erro ao limpar permissões existentes: ${w.message}`);if(console.log("✅ Permissões existentes removidas"),p.length>0){console.log(`💾 Inserindo ${p.length} novas permissões...`);const E=p.map(N=>({usuario_empresa_id:b.id,modulo:N.modulo,permissoes:N.permissoes}));console.log("📋 Dados para inserir:",E);const{error:k}=await B.from("permissoes_usuario").insert(E);if(k)throw console.error("❌ Erro ao inserir permissões:",k),new Error(`Erro ao salvar permissões: ${k.message}`);console.log(`✅ ${p.length} permissões salvas com sucesso`)}else console.log("✅ Permissões removidas (usuário usará padrões do role)");return{success:!0}}catch(g){const v=g instanceof Error?g.message:"Erro ao salvar permissões";return r(v),console.error("Erro ao salvar permissões:",g),{success:!1,error:v}}finally{s(!1)}},[]),c=y.useCallback(async f=>await l(f,[]),[l]),u=y.useCallback(async f=>(await o(f)).length>0,[o]),h=y.useCallback(async(f,p)=>{const v={operador_caixa:[{usuario_empresa_id:"",modulo:"gestao_caixa",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}}],atendente_bar:[{usuario_empresa_id:"",modulo:"atendimento_bar",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},{usuario_empresa_id:"",modulo:"monitor_bar",permissoes:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}}],cozinheiro:[{usuario_empresa_id:"",modulo:"monitor_cozinha",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}}],gerente:[{usuario_empresa_id:"",modulo:"dashboard",permissoes:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}},{usuario_empresa_id:"",modulo:"gestao_caixa",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}},{usuario_empresa_id:"",modulo:"atendimento_bar",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}},{usuario_empresa_id:"",modulo:"monitor_bar",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},{usuario_empresa_id:"",modulo:"monitor_cozinha",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},{usuario_empresa_id:"",modulo:"clientes",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}},{usuario_empresa_id:"",modulo:"funcionarios",permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},{usuario_empresa_id:"",modulo:"relatorios",permissoes:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}}]}[p];return await l(f,v)},[l]);return{loading:t,error:a,getEmployeePermissions:o,saveEmployeePermissions:l,clearEmployeePermissions:c,hasCustomPermissions:u,applyPermissionPreset:h,clearError:()=>r(null)}},Yn=class Yn{constructor(){dt(this,"storageKey","local_employee_credentials")}static getInstance(){return Yn.instance||(Yn.instance=new Yn),Yn.instance}async saveEmployeeCredentials(s,a){try{const r=this.getStoredCredentials();if(r.some(h=>h.email===a.email))return{success:!1,error:`Email ${a.email} já está em uso`};if(r.some(h=>h.username===a.username))return{success:!1,error:`Nome de usuário ${a.username} já está em uso`};const c={employeeId:s.id||`temp_${Date.now()}`,email:a.email,username:a.username,password:a.password,temporaryPassword:a.temporaryPassword,createdAt:new Date().toISOString()},u=[...r,c];return localStorage.setItem(this.storageKey,JSON.stringify(u)),console.log("💾 Credenciais salvas localmente:",{email:a.email,username:a.username}),{success:!0,userId:c.employeeId,needsPasswordChange:a.temporaryPassword}}catch(r){return console.error("❌ Erro ao salvar credenciais localmente:",r),{success:!1,error:`Erro interno: ${r instanceof Error?r.message:"Erro desconhecido"}`}}}async checkEmailExists(s){return this.getStoredCredentials().some(r=>r.email===s)}async checkUsernameExists(s){return this.getStoredCredentials().some(r=>r.username===s)}async validateLogin(s,a){return this.getStoredCredentials().find(l=>(l.email===s||l.username===s)&&l.password===a)||null}listAllCredentials(){return this.getStoredCredentials()}async removeEmployeeCredentials(s){try{const r=this.getStoredCredentials().filter(o=>o.employeeId!==s);return localStorage.setItem(this.storageKey,JSON.stringify(r)),console.log("🗑️ Credenciais removidas localmente:",s),!0}catch(a){return console.error("❌ Erro ao remover credenciais:",a),!1}}async updatePassword(s,a,r=!1){try{const o=this.getStoredCredentials(),l=o.findIndex(c=>c.employeeId===s);return l===-1?!1:(o[l].password=a,o[l].temporaryPassword=r,localStorage.setItem(this.storageKey,JSON.stringify(o)),console.log("🔑 Senha atualizada localmente:",s),!0)}catch(o){return console.error("❌ Erro ao atualizar senha:",o),!1}}clearAllCredentials(){localStorage.removeItem(this.storageKey),console.log("🧹 Todas as credenciais locais foram removidas")}exportCredentials(){const s=this.getStoredCredentials();return JSON.stringify(s,null,2)}importCredentials(s){try{const a=JSON.parse(s);if(!Array.isArray(a))throw new Error("Formato inválido");return localStorage.setItem(this.storageKey,JSON.stringify(a)),console.log("📥 Credenciais importadas com sucesso"),!0}catch(a){return console.error("❌ Erro ao importar credenciais:",a),!1}}getStoredCredentials(){try{const s=localStorage.getItem(this.storageKey);return s?JSON.parse(s):[]}catch(s){return console.error("❌ Erro ao ler credenciais locais:",s),[]}}generateReport(){const s=this.getStoredCredentials();return`
📊 RELATÓRIO DE CREDENCIAIS LOCAIS
================================

Total de funcionários: ${s.length}

Funcionários cadastrados:
${s.map((r,o)=>`
${o+1}. ${r.username} (${r.email})
   - ID: ${r.employeeId}
   - Senha temporária: ${r.temporaryPassword?"Sim":"Não"}
   - Criado em: ${new Date(r.createdAt).toLocaleString("pt-BR")}
`).join("")}

⚠️ IMPORTANTE: Estas credenciais são apenas para desenvolvimento local.
Em produção, use o Supabase Auth configurando a VITE_SUPABASE_SERVICE_ROLE_KEY.
    `.trim()}};dt(Yn,"instance");let gc=Yn;const Kn=class Kn{static getInstance(){return Kn.instance||(Kn.instance=new Kn),Kn.instance}async createEmployeeUser(s,a){try{if(console.log("🔐 Criando usuário para funcionário:",{email:a.email,username:a.username}),!Ht){console.warn("⚠️ Service Role Key não configurada. Usando armazenamento local para desenvolvimento.");const h=await gc.getInstance().saveEmployeeCredentials(s,a);return h.success&&console.log("💾 Credenciais salvas localmente com sucesso"),h}const{data:r,error:o}=await ut.auth.admin.createUser({email:a.email,password:a.password,email_confirm:!0,user_metadata:{username:a.username,employee_id:s.id,role:s.role,temporary_password:a.temporaryPassword,created_by:"system",created_at:new Date().toISOString()}});if(o)return console.error("❌ Erro ao criar usuário no Auth:",o),{success:!1,error:`Erro ao criar usuário: ${o.message}`};if(!r.user)return{success:!1,error:"Usuário não foi criado corretamente"};console.log("✅ Usuário criado no Auth:",r.user.id);const l=await this.createUserProfile(r.user.id,s,a);return l.success?((await this.createUserPermissions(r.user.id,s)).success||console.warn("⚠️ Erro ao criar permissões, mas usuário foi criado"),{success:!0,userId:r.user.id,needsPasswordChange:a.temporaryPassword}):(Ht&&await this.deleteAuthUser(r.user.id),l)}catch(r){return console.error("❌ Erro geral ao criar usuário:",r),{success:!1,error:`Erro interno: ${r instanceof Error?r.message:"Erro desconhecido"}`}}}async createUserProfile(s,a,r){try{const{error:o}=await B.from("profiles").insert({id:s,email:r.email,username:r.username,full_name:a.name,employee_id:a.id,role:a.role,status:a.status,temporary_password:r.temporaryPassword,password_expires_at:r.temporaryPassword?new Date(Date.now()+6048e5).toISOString():null,created_at:new Date().toISOString(),updated_at:new Date().toISOString()});return o?(console.error("❌ Erro ao criar perfil:",o),{success:!1,error:`Erro ao criar perfil: ${o.message}`}):(console.log("✅ Perfil criado com sucesso"),{success:!0})}catch(o){return console.error("❌ Erro ao criar perfil:",o),{success:!1,error:`Erro interno ao criar perfil: ${o instanceof Error?o.message:"Erro desconhecido"}`}}}async createUserPermissions(s,a){try{if(!a.permissions||a.permissions.length===0)return console.log("ℹ️ Nenhuma permissão para criar"),{success:!0};const r=a.permissions.map(l=>({user_id:s,employee_id:a.id,module:l.module,action:l.action,resource:l.resource,granted_at:new Date().toISOString(),granted_by:"system"})),{error:o}=await B.from("user_permissions").insert(r);return o?(console.error("❌ Erro ao criar permissões:",o),{success:!1,error:`Erro ao criar permissões: ${o.message}`}):(console.log("✅ Permissões criadas com sucesso"),{success:!0})}catch(r){return console.error("❌ Erro ao criar permissões:",r),{success:!1,error:`Erro interno ao criar permissões: ${r instanceof Error?r.message:"Erro desconhecido"}`}}}async deleteAuthUser(s){try{Ht&&(await ut.auth.admin.deleteUser(s),console.log("🗑️ Usuário removido do Auth após erro"))}catch(a){console.error("❌ Erro ao remover usuário do Auth:",a)}}async updateEmployeeCredentials(s,a){try{const{data:r,error:o}=await B.from("profiles").select("id, email").eq("employee_id",s).single();if(o||!r)return{success:!1,error:"Usuário não encontrado"};if(a.email||a.password){const u={};a.email&&(u.email=a.email),a.password&&(u.password=a.password);const{error:h}=await ut.auth.admin.updateUserById(r.id,u);if(h)return{success:!1,error:`Erro ao atualizar credenciais: ${h.message}`}}const l={updated_at:new Date().toISOString()};a.email&&(l.email=a.email),a.username&&(l.username=a.username),a.temporaryPassword!==void 0&&(l.temporary_password=a.temporaryPassword,l.password_expires_at=a.temporaryPassword?new Date(Date.now()+7*24*60*60*1e3).toISOString():null);const{error:c}=await B.from("profiles").update(l).eq("id",r.id);return c?{success:!1,error:`Erro ao atualizar perfil: ${c.message}`}:{success:!0}}catch(r){return console.error("❌ Erro ao atualizar credenciais:",r),{success:!1,error:`Erro interno: ${r instanceof Error?r.message:"Erro desconhecido"}`}}}async checkEmailExists(s){try{if(!Ht)return await gc.getInstance().checkEmailExists(s);const{data:a,error:r}=await B.from("profiles").select("id").eq("email",s).limit(1);return r?(console.error("Erro ao verificar email:",r),!1):a&&a.length>0}catch(a){return console.error("Erro ao verificar email:",a),!1}}async checkUsernameExists(s){try{if(!Ht)return await gc.getInstance().checkUsernameExists(s);const{data:a,error:r}=await B.from("profiles").select("id").eq("username",s).limit(1);return r?(console.error("Erro ao verificar username:",r),!1):a&&a.length>0}catch(a){return console.error("Erro ao verificar username:",a),!1}}async forcePasswordChange(s){try{const{error:a}=await B.from("profiles").update({temporary_password:!0,password_expires_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("employee_id",s);return a?{success:!1,error:`Erro ao forçar alteração de senha: ${a.message}`}:{success:!0}}catch(a){return{success:!1,error:`Erro interno: ${a instanceof Error?a.message:"Erro desconhecido"}`}}}};dt(Kn,"instance");let Qu=Kn;const cz=Object.freeze(Object.defineProperty({__proto__:null,EmployeeAuthService:Qu},Symbol.toStringTag,{value:"Module"})),y2=({initialEmployee:t,onSave:s,onClose:a})=>{const{validateForm:r,errors:o,clearErrors:l}=oz(),{saveOffline:c}=iz(),{isOnline:u}=_g(),{executeWithRetry:h}=lz(),{saveCustomPermissions:f,getEmployeePermissions:p}=Ng(),[g,v]=y.useState(null),[b,_]=y.useState({loading:!1,saving:!1,errors:{fields:[]},isDirty:!1,isValid:!1}),[w,E]=y.useState(()=>{const R={name:"",email:"",cpf:"",phone:"",role:"waiter",permissions:[],status:"active",hire_date:new Date,observations:""};return t?{...R,...t}:R});y.useEffect(()=>{_(R=>({...R,errors:o,isValid:!o.fields.length&&!o.general}))},[o]),y.useEffect(()=>{if(t){const R=t.permissions||[],L=t.id?p(t.id,R):R;E({name:"",email:"",cpf:"",phone:"",role:"waiter",status:"active",hire_date:new Date,observations:"",...t,permissions:L})}},[t,p]),y.useEffect(()=>{if(w.role&&!t&&(!w.permissions||w.permissions.length===0)){const R=co[w.role];R&&E(L=>({...L,permissions:[...R.permissions]}))}},[w.role,t]);const k=y.useCallback(R=>{E(L=>({...L,...R})),_(L=>({...L,isDirty:!0}))},[]),N=y.useCallback((R,L)=>{k({[R]:L})},[k]),C=y.useCallback(R=>{E(L=>{const I=L.permissions||[],X=I.some(J=>J.id===R);let ce;if(X)ce=I.filter(J=>J.id!==R);else{const J=co[L.role],V=J==null?void 0:J.permissions.find(Y=>Y.id===R);V?ce=[...I,V]:ce=I}return{...L,permissions:ce}}),_(L=>({...L,isDirty:!0}))},[]),S=async(R,L,I)=>{console.log("Configurando acesso mobile:",{employeeId:R,appName:L,permissions:I})},T=async(R,L)=>{if(!L||!L.system)return console.log("ℹ️ Nenhuma credencial fornecida, pulando criação de usuário Auth"),{success:!0};const I=Qu.getInstance();console.log("🔐 Criando usuário de autenticação para funcionário:",R.name);const X=await I.createEmployeeUser(R,{email:L.system.email,password:L.system.password,username:L.system.username,temporaryPassword:L.system.temporaryPassword});if(!X.success)throw new Error(`Erro ao criar usuário de autenticação: ${X.error}`);return console.log("✅ Usuário de autenticação criado com sucesso"),X},M=y.useCallback(async()=>{if(r(w)){_(R=>({...R,saving:!0}));try{const R=w;if(!u){const I=c(R);_(X=>({...X,isDirty:!1})),l(),_(X=>({...X,errors:{general:`✅ Funcionário ${R.name} salvo offline. Será sincronizado quando a conexão for restaurada.`,fields:[]}})),setTimeout(()=>{a()},2e3);return}if(await h(()=>s(R,g),{maxRetries:1,retryDelay:2e3,timeoutDuration:t?2e4:15e3}),!t&&g)try{await T(R,g)}catch(I){console.error("Erro ao criar usuário de autenticação:",I),_(X=>({...X,errors:{general:`Funcionário cadastrado, mas houve erro ao criar usuário de login: ${I instanceof Error?I.message:"Erro desconhecido"}`,fields:[]}}))}if(t&&R.id&&R.permissions&&f(R.id,R.permissions),w.role==="waiter"&&R.id)try{await S(R.id,"app-garcom",X8)}catch(I){console.warn("Erro ao configurar acesso mobile (não crítico):",I)}_(I=>({...I,isDirty:!1})),l(),a()}catch(R){console.error("Erro ao salvar funcionário:",R);let L="Erro ao salvar funcionário. Tente novamente.";if(R instanceof TypeError&&R.message.includes("fetch"))L="Erro de conexão. Os dados foram salvos offline e serão sincronizados quando a conexão for restaurada.",c(w),setTimeout(()=>{a()},3e3);else if(R instanceof Error&&R.message.includes("Timeout")){const I=!!t;L=`Operação demorou mais que ${I?"20s":"15s"}. ${I?"A edição":"O cadastro"} pode ter sido processada mesmo assim. Verifique a lista de funcionários e tente novamente se necessário.`,I&&(c(w),L+=" Os dados foram salvos offline como backup.")}else R instanceof Error&&R.message.includes("NetworkError")&&(L="Erro de rede. Os dados foram salvos offline.",c(w),setTimeout(()=>{a()},3e3));_(I=>({...I,errors:{general:L,fields:[]}}))}finally{_(R=>({...R,saving:!1}))}}},[w,r,s,a,l,u,c]),$=y.useCallback(()=>{b.isDirty&&!window.confirm("Há alterações não salvas. Deseja realmente cancelar?")||(l(),a())},[b.isDirty,l,a]),A=y.useCallback(()=>{E({name:"",email:"",cpf:"",phone:"",role:"waiter",permissions:[],status:"active",hire_date:new Date,observations:""}),_({loading:!1,saving:!1,errors:{fields:[]},isDirty:!1,isValid:!1}),l()},[l]),z=y.useCallback(R=>{v(R)},[]);return{employee:w,state:b,updateEmployee:k,updateField:N,togglePermission:C,handleSave:M,handleCancel:$,resetForm:A,setEmployeeCredentials:z}},b2=async t=>{if(!t)return{isValid:!1,message:"Email é obrigatório",severity:"error"};if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(t))return{isValid:!1,message:"Formato de email inválido",severity:"error"};try{return await new Promise(a=>setTimeout(a,500)),t.endsWith("test.com")?{isValid:!1,message:"Este email já está em uso",severity:"error"}:{isValid:!0,message:"Email disponível",severity:"success"}}catch{return{isValid:!1,message:"Erro ao verificar email",severity:"warning"}}},v2=t=>{if(!t)return{isValid:!0};const s=t.replace(/\D/g,"");if(s.length!==11)return{isValid:!1,message:"CPF deve ter 11 dígitos",severity:"error"};if(/^(\d)\1{10}$/.test(s))return{isValid:!1,message:"CPF inválido",severity:"error"};let a=0;for(let o=0;o<9;o++)a+=parseInt(s.charAt(o))*(10-o);let r=11-a%11;if((r===10||r===11)&&(r=0),r!==parseInt(s.charAt(9)))return{isValid:!1,message:"CPF inválido",severity:"error"};a=0;for(let o=0;o<10;o++)a+=parseInt(s.charAt(o))*(11-o);return r=11-a%11,(r===10||r===11)&&(r=0),r!==parseInt(s.charAt(10))?{isValid:!1,message:"CPF inválido",severity:"error"}:{isValid:!0,message:"CPF válido",severity:"success"}},w2=t=>{if(!t)return{isValid:!0};const s=t.replace(/\D/g,"");return s.length<10||s.length>11?{isValid:!1,message:"Telefone deve ter 10 ou 11 dígitos",severity:"error"}:s.length===11&&!["2","3","4","5","6","7","8","9"].includes(s[2])?{isValid:!1,message:"Número de celular inválido",severity:"error"}:{isValid:!0,message:"Telefone válido",severity:"success"}},j2=t=>!t||!t.trim()?{isValid:!1,message:"Nome é obrigatório",severity:"error"}:t.trim().length<2?{isValid:!1,message:"Nome deve ter pelo menos 2 caracteres",severity:"error"}:t.trim().length>100?{isValid:!1,message:"Nome muito longo (máximo 100 caracteres)",severity:"error"}:t.trim().split(" ").filter(a=>a.length>0).length<2?{isValid:!1,message:"Informe nome e sobrenome",severity:"warning"}:{isValid:!0,message:"Nome válido",severity:"success"},dz=(t,s)=>t?s.permissions&&s.permissions.length>0?{isValid:!0,message:"Função selecionada com permissões configuradas",severity:"success"}:{isValid:!0,message:"Função selecionada",severity:"info"}:{isValid:!1,message:"Selecione uma função",severity:"error"},uz=[{field:"name",validator:j2,debounceMs:300},{field:"email",validator:b2,debounceMs:800},{field:"cpf",validator:v2,debounceMs:500},{field:"phone",validator:w2,debounceMs:500},{field:"role",validator:dz,debounceMs:100}],mz=(t,s=uz)=>{const[a,r]=y.useState({});return{validationResults:a,handleValidationChange:(h,f)=>{r(p=>({...p,[h]:f}))},isFieldValid:h=>{const f=a[h];return(f==null?void 0:f.isValid)!==!1},getFieldError:h=>{const f=a[h];return(f==null?void 0:f.isValid)===!1?f.message:null},isFormValid:()=>Object.values(a).every(h=>h.isValid!==!1),rules:s}},_2=({employee:t,onUpdate:s,errors:a})=>{var _,w,E,k,N;const[r,o]=y.useState({}),{getFieldError:l}=mz(),c=C=>{const S=l(C);return S?{message:S}:a.fields.find(T=>T.field===C)},u=(C,S,T,M=500)=>{const $=C;o(z=>({...z,[$]:{...z[$],isValidating:!0}}));const A=setTimeout(async()=>{try{const z=await Promise.resolve(T(S,t));o(R=>({...R,[$]:{isValidating:!1,isValid:z.isValid,message:z.message||null,severity:z.severity||null}}))}catch{o(R=>({...R,[$]:{isValidating:!1,isValid:!1,message:"Erro na validação",severity:"error"}}))}},M);return()=>clearTimeout(A)},h=C=>{const S=C.replace(/\D/g,"").slice(0,11);s("cpf",S),u("cpf",S,v2,300)},f=C=>{const S=C.replace(/\D/g,"").slice(0,11);s("phone",S),u("phone",S,w2,300)},p=C=>{s("name",C),u("name",C,j2,400)},g=C=>{s("email",C),u("email",C,b2,800)},v=({field:C})=>{const S=r[C];if(!S)return null;if(S.isValidating)return e.jsxs("div",{className:"flex items-center space-x-1 text-blue-600 mt-1",children:[e.jsx(aO,{className:"h-3 w-3 animate-spin"}),e.jsx("span",{className:"text-xs",children:"Validando..."})]});if(S.isValid===null)return null;const T=()=>{switch(S.severity){case"success":return e.jsx(ts,{className:"h-3 w-3 text-green-600"});case"error":return e.jsx(Ia,{className:"h-3 w-3 text-red-600"});case"warning":return e.jsx(Ya,{className:"h-3 w-3 text-yellow-600"});default:return null}},M=()=>{switch(S.severity){case"success":return"text-green-600";case"error":return"text-red-600";case"warning":return"text-yellow-600";default:return"text-gray-600"}};return e.jsxs("div",{className:`flex items-center space-x-1 mt-1 ${M()}`,children:[T(),S.message&&e.jsx("span",{className:"text-xs",children:S.message})]})},b=(C,S)=>{const T=r[C];return c(C)||T&&T.isValid===!1?`${S} border-red-500 focus:ring-red-500`:T&&T.isValid===!0?`${S} border-green-500 focus:ring-green-500`:`${S} border-gray-300 focus:ring-blue-500`};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Ks,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Dados Pessoais"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"name",className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo *"}),e.jsx("input",{id:"name",type:"text",value:t.name||"",onChange:C=>p(C.target.value),className:b("name","w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2"),placeholder:"Digite o nome completo"}),e.jsx(v,{field:"name"}),c("name")&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:(_=c("name"))==null?void 0:_.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"cpf",className:"block text-sm font-medium text-gray-700 mb-1",children:"CPF *"}),e.jsx("input",{id:"cpf",type:"text",value:t.cpf?rz(t.cpf):"",onChange:C=>h(C.target.value),className:b("cpf","w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2"),placeholder:"000.000.000-00",maxLength:14}),e.jsx(v,{field:"cpf"}),c("cpf")&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:(w=c("cpf"))==null?void 0:w.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"phone",className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone"}),e.jsx("input",{id:"phone",type:"text",value:t.phone?nz(t.phone):"",onChange:C=>f(C.target.value),className:b("phone","w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2"),placeholder:"(11) 99999-9999",maxLength:15}),e.jsx(v,{field:"phone"}),c("phone")&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:(E=c("phone"))==null?void 0:E.message})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{id:"email",type:"email",value:t.email||"",onChange:C=>g(C.target.value),className:b("email","w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2"),placeholder:"email@exemplo.com"}),e.jsx(v,{field:"email"}),c("email")&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:(k=c("email"))==null?void 0:k.message})]}),e.jsxs("div",{children:[e.jsxs("label",{htmlFor:"hire_date",className:"block text-sm font-medium text-gray-700 mb-1",children:[e.jsx(Mr,{className:"inline h-4 w-4 mr-1"}),"Data de Contratação *"]}),e.jsx("input",{id:"hire_date",type:"date",value:t.hire_date?t.hire_date.toISOString().split("T")[0]:"",onChange:C=>s("hire_date",new Date(C.target.value)),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${c("hire_date")?"border-red-500":"border-gray-300"}`}),c("hire_date")&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:(N=c("hire_date"))==null?void 0:N.message})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{htmlFor:"observations",className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações"}),e.jsx("textarea",{id:"observations",value:t.observations||"",onChange:C=>s("observations",C.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Observações adicionais sobre o funcionário (opcional)"})]})]})]})},fr={visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},pr={visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1},ya={visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},gu={visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1},N2={dashboard:{name:"Dashboard",description:"Painel principal com visão geral do estabelecimento",category:"operacional",requiredForRole:["atendente","garcom","cozinheiro","barman","gerente"],icon:"dashboard"},monitor_bar:{name:"Monitor do Bar",description:"Monitoramento de pedidos e preparação de bebidas",category:"operacional",requiredForRole:["barman","gerente"],icon:"local_bar"},atendimento_bar:{name:"Atendimento do Bar",description:"Gestão de pedidos e atendimento aos clientes",category:"operacional",requiredForRole:["garcom","atendente","gerente"],icon:"restaurant_menu"},monitor_cozinha:{name:"Monitor da Cozinha",description:"Acompanhamento de pedidos e preparação de pratos",category:"operacional",requiredForRole:["cozinheiro","gerente"],icon:"restaurant"},gestao_caixa:{name:"Gestão de Caixa",description:"Controle de vendas, pagamentos e fechamento de caixa",category:"financeiro",requiredForRole:["atendente","gerente"],icon:"point_of_sale"},clientes:{name:"Gestão de Clientes",description:"Cadastro e acompanhamento de clientes",category:"operacional",requiredForRole:["atendente","garcom","gerente"],icon:"people"},funcionarios:{name:"Gestão de Funcionários",description:"Cadastro e gerenciamento da equipe",category:"administrativo",requiredForRole:["gerente"],icon:"badge"},relatorios:{name:"Relatórios",description:"Relatórios de vendas, performance e análises",category:"relatorios",requiredForRole:["gerente"],icon:"analytics"},configuracoes:{name:"Configurações",description:"Configurações do sistema e estabelecimento",category:"administrativo",requiredForRole:["gerente"],icon:"settings"},estoque:{name:"Controle de Estoque",description:"Gestão de produtos e ingredientes",category:"operacional",requiredForRole:["cozinheiro","barman","gerente"],icon:"inventory"},cardapio:{name:"Gestão de Cardápio",description:"Criação e edição de pratos e bebidas",category:"operacional",requiredForRole:["cozinheiro","barman","gerente"],icon:"menu_book"},promocoes:{name:"Promoções",description:"Criação e gestão de promoções e descontos",category:"administrativo",requiredForRole:["gerente"],icon:"local_offer"},financeiro:{name:"Financeiro",description:"Controle financeiro e contabilidade",category:"financeiro",requiredForRole:["gerente"],icon:"account_balance"}},ca={atendente:{role:"atendente",displayName:"Atendente de Caixa",description:"Responsável pelo atendimento ao cliente e operação do caixa",accessLevel:"USER",userType:"funcionario",hierarchy:2,permissions:{dashboard:fr,gestao_caixa:gu,clientes:pr,atendimento_bar:fr,promocoes:fr}},garcom:{role:"garcom",displayName:"Garçom",description:"Responsável pelo atendimento às mesas e pedidos",accessLevel:"USER",userType:"funcionario",hierarchy:2,permissions:{dashboard:fr,atendimento_bar:gu,clientes:pr,cardapio:fr,promocoes:fr}},cozinheiro:{role:"cozinheiro",displayName:"Cozinheiro",description:"Responsável pela preparação de pratos e controle da cozinha",accessLevel:"USER",userType:"funcionario",hierarchy:2,permissions:{dashboard:fr,monitor_cozinha:gu,estoque:pr,cardapio:pr}},barman:{role:"barman",displayName:"Barman",description:"Responsável pela preparação de bebidas e gestão do bar",accessLevel:"USER",userType:"funcionario",hierarchy:3,permissions:{dashboard:fr,monitor_bar:gu,atendimento_bar:pr,estoque:pr,cardapio:pr,clientes:fr}},gerente:{role:"gerente",displayName:"Gerente",description:"Responsável pela gestão geral do estabelecimento",accessLevel:"MANAGER",userType:"administrador",hierarchy:5,canManageRoles:["atendente","garcom","cozinheiro","barman"],permissions:{dashboard:ya,monitor_bar:ya,atendimento_bar:ya,monitor_cozinha:ya,gestao_caixa:ya,clientes:ya,funcionarios:ya,relatorios:ya,configuracoes:pr,estoque:ya,cardapio:ya,promocoes:ya,financeiro:pr}}},Xn=class Xn{constructor(){dt(this,"customPresets",new Map)}static getInstance(){return Xn.instance||(Xn.instance=new Xn),Xn.instance}getDefaultPermissions(s){const a=ca[s];if(!a)throw new Error(`Função não encontrada: ${s}`);return{...a.permissions}}getRoleConfig(s){const a=ca[s];if(!a)throw new Error(`Configuração não encontrada para a função: ${s}`);return{...a}}getAllRoleConfigs(){return{...ca}}getPresetById(s){if(this.customPresets.has(s))return this.customPresets.get(s);const a=s;return ca[a]?this.createPresetFromRole(a):null}getAllPresets(){const s=Object.keys(ca).map(r=>this.createPresetFromRole(r)),a=Array.from(this.customPresets.values());return[...s,...a]}canManageRole(s,a){const r=ca[s],o=ca[a];return!r||!o||r.hierarchy<=o.hierarchy?!1:r.canManageRoles?r.canManageRoles.includes(a):!0}validatePermission(s,a,r){const o=ca[s];if(!o)return{isValid:!1,hasAccess:!1,missingPermissions:[],warnings:[],errors:[`Função não encontrada: ${s}`]};const l=o.permissions[a];if(!l)return{isValid:!0,hasAccess:!1,missingPermissions:[{module:a,action:r,required:!0,current:!1}],warnings:[`Módulo ${a} não configurado para a função ${s}`],errors:[]};const c=l[r];return{isValid:!0,hasAccess:c,missingPermissions:c?[]:[{module:a,action:r,required:!0,current:!1}],warnings:[],errors:[]}}createUserPermissionContext(s,a,r){const o=this.getDefaultPermissions(a),l=r||o;return{userId:s,role:a,permissions:o,effectivePermissions:l,canAccess:(c,u)=>{const h=l[c];return h?h[u]:!1},canManage:c=>this.canManageRole(a,c)}}createCustomPreset(s,a,r,o){const l=this.getDefaultPermissions(r),c=this.mergePermissions(l,o),u={id:`custom_${Date.now()}_${Math.random().toString(36).substr(2,9)}`,name:s,description:a,role:r,permissions:c,isDefault:!1,isCustomizable:!0,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()};return this.customPresets.set(u.id,u),u}updateCustomPreset(s,a){const r=this.customPresets.get(s);if(!r||!r.isCustomizable)return null;const o={...r,...a,updatedAt:new Date().toISOString()};return this.customPresets.set(s,o),o}deleteCustomPreset(s){const a=this.customPresets.get(s);return!a||!a.isCustomizable?!1:this.customPresets.delete(s)}mergePermissions(s,a){const r={...s};for(const[o,l]of Object.entries(a))l&&(r[o]={...r[o],...l});return r}createPresetFromRole(s){const a=ca[s];return{id:s,name:a.displayName,description:a.description,role:s,permissions:a.permissions,isDefault:!0,isCustomizable:!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}getRequiredModulesForRole(s){return Object.entries(N2).filter(([a,r])=>{var o;return(o=r.requiredForRole)==null?void 0:o.includes(s)}).map(([a,r])=>a)}getRoleHierarchy(s){var a;return((a=ca[s])==null?void 0:a.hierarchy)||0}getManageableRoles(s){const a=ca[s];return(a==null?void 0:a.canManageRoles)||[]}};dt(Xn,"instance");let Ju=Xn;const oc=Ju.getInstance(),hz=Object.freeze(Object.defineProperty({__proto__:null,MODULE_DESCRIPTIONS:N2,PermissionPresetManager:Ju,ROLE_PERMISSION_CONFIGS:ca,permissionPresetManager:oc},Symbol.toStringTag,{value:"Module"})),S2=({employee:t,onUpdate:s,errors:a})=>{var v;const r=b=>a.fields.find(_=>_.field===b),[o,l]=y.useState(t.role||null),[c,u]=y.useState(null),h=b=>({waiter:"garcom",cook:"cozinheiro",cashier:"caixa",supervisor:"barman",manager:"gerente",admin:"gerente"})[b]||"garcom",f=b=>{l(b),s("role",b);try{const _=h(b),w=oc.getDefaultPermissions(_),E=Object.entries(w).map(([k,N])=>({id:k,name:k,granted:N.visualizar||N.criar||N.editar||N.excluir||N.administrar,level:N.administrar?"admin":N.excluir?"full":N.editar?"edit":N.criar?"create":"view"}));s("permissions",E),u({role:_,config:oc.getRoleConfig(_),permissions:w})}catch(_){console.error("Erro ao aplicar preset de permissões:",_);const w=co[b];w&&s("permissions",[...w.permissions])}};y.useEffect(()=>{if(o)try{const b=h(o),_=oc.getRoleConfig(b),w=oc.getDefaultPermissions(b);u({role:b,config:_,permissions:w})}catch(b){console.error("Erro ao carregar preview de permissões:",b)}},[o]);const p=b=>({waiter:"🍽️",cook:"👨‍🍳",cashier:"💰",supervisor:"👥",manager:"👔",admin:"⚙️"})[b],g=b=>({waiter:"bg-green-100 text-green-800 border-green-200",cook:"bg-orange-100 text-orange-800 border-orange-200",cashier:"bg-blue-100 text-blue-800 border-blue-200",supervisor:"bg-purple-100 text-purple-800 border-purple-200",manager:"bg-red-100 text-red-800 border-red-200",admin:"bg-gray-100 text-gray-800 border-gray-200"})[b];return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(XN,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Função e Cargo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Selecione a Função *"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:Object.entries(co).map(([b,_])=>{const w=b,E=t.role===w;return e.jsxs("div",{onClick:()=>f(w),className:`
                  relative cursor-pointer rounded-lg border-2 p-4 transition-all duration-200
                  ${E?`${g(w)} border-current shadow-md`:"border-gray-200 hover:border-gray-300 hover:shadow-sm"}
                `,children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-2xl",children:p(w)}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:Q8(w)}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:_.description})]}),E&&e.jsx("div",{className:"absolute top-2 right-2",children:e.jsx("div",{className:"w-3 h-3 bg-current rounded-full"})})]}),w==="waiter"&&e.jsx("div",{className:"mt-3 pt-3 border-t border-current border-opacity-20",children:e.jsxs("div",{className:"flex items-center space-x-1 text-xs",children:[e.jsx(JN,{className:"h-3 w-3"}),e.jsx("span",{children:"Inclui acesso ao App Garçom"})]})})]},w)})}),r("role")&&e.jsx("p",{className:"mt-2 text-sm text-red-600",children:(v=r("role"))==null?void 0:v.message})]}),c&&e.jsx("div",{className:"bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Ni,{className:"h-6 w-6 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h4",{className:"font-medium text-blue-900 mb-2",children:["Permissões para ",c.config.displayName]}),e.jsx("p",{className:"text-sm text-blue-700 mb-3",children:c.config.description}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsxs("span",{className:"text-xs text-gray-700",children:[Object.keys(c.permissions).length," módulos"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),e.jsxs("span",{className:"text-xs text-gray-700",children:["Nível ",c.config.hierarchy,"/5"]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-700",children:c.config.accessLevel})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full"}),e.jsx("span",{className:"text-xs text-gray-700",children:c.config.userType})]})]}),e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-2",children:"Módulos com acesso:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:Object.entries(c.permissions).map(([b,_])=>{if(!_.visualizar)return null;const w=C=>({dashboard:"📊",monitor_bar:"🍺",atendimento_bar:"🍽️",monitor_cozinha:"👨‍🍳",gestao_caixa:"💰",clientes:"👥",funcionarios:"👔",relatorios:"📈",configuracoes:"⚙️",estoque:"📦",cardapio:"📋"})[C]||"📄",E=C=>C.administrar?"Admin":C.excluir?"Full":C.editar?"Edit":C.criar?"Create":"View",k=C=>({Admin:"bg-red-100 text-red-700",Full:"bg-orange-100 text-orange-700",Edit:"bg-yellow-100 text-yellow-700",Create:"bg-blue-100 text-blue-700",View:"bg-gray-100 text-gray-700"})[C]||"bg-gray-100 text-gray-700",N=E(_);return e.jsxs("div",{className:`inline-flex items-center space-x-1 px-2 py-1 rounded-full text-xs ${k(N)}`,title:`${b}: ${N}`,children:[e.jsx("span",{children:w(b)}),e.jsx("span",{className:"capitalize",children:b.replace("_"," ")}),e.jsxs("span",{className:"font-medium",children:["(",N,")"]})]},b)})})]}),c.config.canManageRoles&&e.jsxs("div",{className:"mb-2",children:[e.jsx("p",{className:"text-xs font-medium text-gray-700 mb-1",children:"Pode gerenciar:"}),e.jsx("div",{className:"flex flex-wrap gap-1",children:c.config.canManageRoles.map(b=>e.jsxs("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-100 text-green-700",children:[e.jsx(Ns,{className:"h-3 w-3 mr-1"}),b]},b))})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-blue-600 mt-3",children:[e.jsx(Tr,{className:"h-3 w-3"}),e.jsx("span",{children:"Permissões aplicadas automaticamente. Personalize na próxima seção se necessário."})]})]})]})}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"status",className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{id:"status",value:t.status||"active",onChange:b=>s("status",b.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"active",children:"Ativo"}),e.jsx("option",{value:"inactive",children:"Inativo"}),e.jsx("option",{value:"suspended",children:"Suspenso"})]})]})]})},E2=({employee:t,onTogglePermission:s,mode:a="create"})=>{const[r,o]=y.useState(new Set(["app-garcom"])),{hasCustomPermissions:l,resetToDefaultPermissions:c}=Ng(),u=k=>{const N=new Set(r);N.has(k)?N.delete(k):N.add(k),o(N)},h=k=>{var N;return((N=t.permissions)==null?void 0:N.some(C=>C.id===k))||!1},f=()=>{var k;return t.role?((k=co[t.role])==null?void 0:k.permissions)||[]:[]},p=k=>{const N={};return k.forEach(C=>{N[C.module]||(N[C.module]=[]),N[C.module].push(C)}),N},g=f(),v=p(g),b=a==="edit"&&t.id&&l(t.id),_=()=>{t.id&&t.role&&confirm("Tem certeza que deseja resetar as permissões para o padrão da função?")&&(c(t.id),co[t.role]&&alert("Permissões resetadas! Feche e abra o modal novamente para ver as mudanças."))},w=k=>({bar:"🍺",kitchen:"🍳",cashier:"💰",reports:"📊",inventory:"📦",customers:"👥",settings:"⚙️","app-garcom":"📱"})[k]||"📋",E=k=>({bar:"bg-amber-50 border-amber-200",kitchen:"bg-orange-50 border-orange-200",cashier:"bg-green-50 border-green-200",reports:"bg-blue-50 border-blue-200",inventory:"bg-purple-50 border-purple-200",customers:"bg-pink-50 border-pink-200",settings:"bg-gray-50 border-gray-200","app-garcom":"bg-indigo-50 border-indigo-200"})[k]||"bg-gray-50 border-gray-200";return t.role?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ni,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Permissões"}),b&&e.jsxs("div",{className:"flex items-center space-x-1 bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs",children:[e.jsx(io,{className:"h-3 w-3"}),e.jsx("span",{children:"Customizado"})]})]}),b&&e.jsxs("button",{onClick:_,className:"flex items-center space-x-1 text-sm text-gray-600 hover:text-gray-800 bg-gray-100 hover:bg-gray-200 px-3 py-1 rounded-md transition-colors",children:[e.jsx(EO,{className:"h-3 w-3"}),e.jsx("span",{children:"Resetar"})]})]}),e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx("div",{className:"text-yellow-600",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-yellow-900",children:"Permissões Personalizáveis"}),e.jsx("p",{className:"text-sm text-yellow-700 mt-1",children:"As permissões abaixo foram aplicadas automaticamente baseadas na função selecionada. Você pode personalizar marcando/desmarcando as opções conforme necessário."})]})]})}),e.jsx("div",{className:"space-y-4",children:Object.entries(v).map(([k,N])=>{const C=r.has(k),S=N.filter($=>h($.id)),T=N.length,M=S.length;return e.jsxs("div",{className:`border rounded-lg ${E(k)}`,children:[e.jsxs("div",{onClick:()=>u(k),className:"flex items-center justify-between p-4 cursor-pointer hover:bg-opacity-80 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-xl",children:w(k)}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:J8(k)}),e.jsxs("p",{className:"text-sm text-gray-600",children:[M," de ",T," permissões ativas"]})]}),k==="app-garcom"&&t.role==="waiter"&&e.jsxs("div",{className:"flex items-center space-x-1 bg-indigo-100 text-indigo-800 px-2 py-1 rounded-full text-xs",children:[e.jsx(fn,{className:"h-3 w-3"}),e.jsx("span",{children:"App Mobile"})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:[Math.round(M/T*100),"%"]}),C?e.jsx(NR,{className:"h-5 w-5 text-gray-400"}):e.jsx(ER,{className:"h-5 w-5 text-gray-400"})]})]}),C&&e.jsxs("div",{className:"border-t border-current border-opacity-20 p-4 bg-white bg-opacity-50",children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-3",children:N.map($=>{const A=h($.id);return e.jsxs("div",{onClick:()=>s($.id),className:`
                            flex items-center space-x-3 p-3 rounded-lg cursor-pointer transition-all
                            ${A?"bg-white border-2 border-blue-200 shadow-sm":"bg-gray-50 border border-gray-200 hover:bg-gray-100"}
                          `,children:[e.jsx("div",{className:`
                            flex items-center justify-center w-5 h-5 rounded border-2 transition-colors
                            ${A?"bg-blue-600 border-blue-600":"border-gray-300"}
                          `,children:A&&e.jsx(Hu,{className:"h-3 w-3 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"font-medium text-gray-900",children:ez($.action)}),$.resource&&e.jsx("div",{className:"text-sm text-gray-600",children:$.resource.replace(/_/g," ")})]})]},$.id)})}),k==="app-garcom"&&t.role==="waiter"&&e.jsx("div",{className:"mt-4 p-3 bg-indigo-100 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(fn,{className:"h-5 w-5 text-indigo-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-indigo-900",children:"Acesso ao App Garçom"}),e.jsx("p",{className:"text-sm text-indigo-700 mt-1",children:"Este funcionário terá acesso ao aplicativo mobile para garçons, permitindo gerenciar mesas, pedidos e atendimento diretamente pelo celular."}),e.jsxs("div",{className:"mt-2 text-xs text-indigo-600",children:["• Limite de 2 dispositivos simultâneos",e.jsx("br",{}),"• Sincronização automática com o sistema principal",e.jsx("br",{}),"• Acesso offline limitado para consultas"]})]})]})})]})]},k)})}),g.length===0&&e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ni,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"Nenhuma permissão disponível para esta função"})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(Ni,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Permissões"})]}),e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Ni,{className:"h-12 w-12 mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"Selecione uma função para configurar as permissões"})]})]})},$j=(t,s)=>{const r=t.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z\s]/g,"").trim().split(" ").filter(c=>c.length>0);if(r.length===0)return s?`user${s.slice(-4)}`:`user${Date.now()}`;let o="";r.length===1?o=r[0]:r.length===2?o=`${r[0]}.${r[1]}`:o=`${r[0]}.${r[r.length-1]}`;const l=Date.now().toString().slice(-3);return o.length>15&&(o=o.substring(0,12)+l),o},fz=()=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ",s="abcdefghijklmnopqrstuvwxyz",a="0123456789",r="!@#$%&*";let o="";o+=t[Math.floor(Math.random()*t.length)],o+=s[Math.floor(Math.random()*s.length)],o+=a[Math.floor(Math.random()*a.length)],o+=r[Math.floor(Math.random()*r.length)];const l=t+s+a+r;for(let c=4;c<8;c++)o+=l[Math.floor(Math.random()*l.length)];return o.split("").sort(()=>Math.random()-.5).join("")},C2=async t=>{let s=$j(t.name,t.cpf);const a=fz(),{EmployeeAuthService:r}=await ha(async()=>{const{EmployeeAuthService:h}=await Promise.resolve().then(()=>cz);return{EmployeeAuthService:h}},void 0),o=r.getInstance();let l=0;const c=5;for(;l<c&&await o.checkUsernameExists(s);){l++;const f=l.toString().padStart(2,"0");s=`${$j(t.name,t.cpf)}${f}`}if(await o.checkEmailExists(t.email))throw new Error(`Email ${t.email} já está em uso por outro funcionário`);return{username:s,password:a,email:t.email,temporaryPassword:!0}},Ij=t=>t.length<3?{valid:!1,message:"Nome de usuário deve ter pelo menos 3 caracteres"}:t.length>20?{valid:!1,message:"Nome de usuário deve ter no máximo 20 caracteres"}:/^[a-z0-9._-]+$/.test(t)?t.startsWith(".")||t.endsWith(".")?{valid:!1,message:"Nome de usuário não pode começar ou terminar com ponto"}:{valid:!0}:{valid:!1,message:"Nome de usuário pode conter apenas letras minúsculas, números, pontos, hífens e underscores"},Lj=t=>{const s=[];let a=0;t.length>=8?a+=2:t.length>=6?a+=1:s.push("Use pelo menos 8 caracteres"),/[A-Z]/.test(t)?a+=1:s.push("Adicione letras maiúsculas"),/[a-z]/.test(t)?a+=1:s.push("Adicione letras minúsculas"),/\d/.test(t)?a+=1:s.push("Adicione números"),/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]/.test(t)?a+=1:s.push("Adicione símbolos especiais"),new Set(t).size>=t.length*.7?a+=1:s.push("Use caracteres mais variados");let r;return a>=6?r="strong":a>=4?r="medium":r="weak",{strength:r,score:a,feedback:s}},pz=t=>`
📧 Email: ${t.email}
👤 Usuário: ${t.username}
🔑 Senha: ${t.password}

⚠️ Esta é uma senha temporária. O funcionário deve alterá-la no primeiro acesso.
  `.trim(),gz=async t=>{const s=await C2(t);return{system:s,mobile:t.role==="waiter"?{...s,appId:`garcom_${s.username}`,deviceLimit:2}:null,firstAccessToken:xz(),passwordExpiry:new Date(Date.now()+7*24*60*60*1e3)}},xz=()=>{const t="ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789";let s="";for(let a=0;a<8;a++)s+=t[Math.floor(Math.random()*t.length)];return s},yz=({employee:t,onCredentialsGenerated:s,mode:a,showCredentialsStep:r=!1})=>{const[o,l]=y.useState(null),[c,u]=y.useState(!1),[h,f]=y.useState(""),[p,g]=y.useState(""),[v,b]=y.useState(!1),[_,w]=y.useState(!1),[E,k]=y.useState(!0),N=async()=>{if(!t.name){alert("Preencha o nome do funcionário primeiro");return}try{const M=await C2(t);l(M);const $=await gz(t);s($)}catch(M){console.error("Erro ao gerar credenciais:",M),alert(`Erro ao gerar credenciais: ${M instanceof Error?M.message:"Erro desconhecido"}`)}},C=()=>{if(!h||!p){alert("Preencha usuário e senha personalizados");return}const M=Ij(h);if(!M.valid){alert(M.message);return}const $=Lj(p);if($.strength==="weak"&&!window.confirm(`Senha fraca detectada. Sugestões:
`+$.feedback.join(`
`)+`

Deseja continuar mesmo assim?`))return;const A={username:h,password:p,email:t.email||"",temporaryPassword:!1};l(A),s({system:A,mobile:t.role==="waiter"?{...A,appId:`garcom_${h}`,deviceLimit:2}:null,passwordExpiry:null})},S=async()=>{if(!o)return;const M=pz(o);try{await navigator.clipboard.writeText(M),w(!0),setTimeout(()=>w(!1),2e3)}catch{const A=document.createElement("textarea");A.value=M,document.body.appendChild(A),A.select(),document.execCommand("copy"),document.body.removeChild(A),w(!0),setTimeout(()=>w(!1),2e3)}},T=p?Lj(p):null;return r?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[e.jsx(jr,{className:"h-5 w-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Credenciais de Acesso"})]}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ks,{className:"h-5 w-5 text-gray-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Acesso ao Sistema"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Permitir que este funcionário faça login no sistema"})]})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:E,onChange:M=>{k(M.target.checked),M.target.checked||(l(null),s(null))},className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"})]})]}),!E&&e.jsx("div",{className:"mt-3 p-3 bg-yellow-50 border border-yellow-200 rounded",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(yt,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-yellow-900",children:"Sem Acesso ao Sistema"}),e.jsx("p",{className:"text-yellow-700",children:"Este funcionário será cadastrado apenas para controle interno, sem capacidade de fazer login no sistema."})]})]})})]}),E&&a==="create"&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(jr,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-blue-900",children:"Geração de Credenciais"}),e.jsxs("p",{className:"text-sm text-blue-700 mt-1",children:["Gere automaticamente usuário e senha para o funcionário acessar o sistema.",t.role==="waiter"&&e.jsxs("span",{className:"block mt-1",children:[e.jsx(fn,{className:"inline h-4 w-4 mr-1"}),"Como garçom, também receberá acesso ao app mobile."]})]})]})]})}),E&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",checked:!v,onChange:()=>b(!1),className:"text-blue-600"}),e.jsx("span",{children:"Gerar automaticamente"})]}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"radio",checked:v,onChange:()=>b(!0),className:"text-blue-600"}),e.jsx("span",{children:"Definir manualmente"})]})]}),v?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome de Usuário"}),e.jsx("input",{type:"text",value:h,onChange:M=>f(M.target.value.toLowerCase()),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"usuario.exemplo"}),h&&(()=>{const M=Ij(h);return M.valid?e.jsx("p",{className:"mt-1 text-sm text-green-600",children:"✓ Nome de usuário válido"}):e.jsx("p",{className:"mt-1 text-sm text-red-600",children:M.message})})()]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Senha"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:c?"text":"password",value:p,onChange:M=>g(M.target.value),className:"w-full px-3 py-2 pr-10 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Digite uma senha segura"}),e.jsx("button",{type:"button",onClick:()=>u(!c),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:c?e.jsx(mn,{className:"h-4 w-4"}):e.jsx(Ys,{className:"h-4 w-4"})})]}),T&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("div",{className:`text-sm font-medium ${T.strength==="strong"?"text-green-600":T.strength==="medium"?"text-yellow-600":"text-red-600"}`,children:["Força: ",T.strength==="strong"?"Forte":T.strength==="medium"?"Média":"Fraca"]}),e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all ${T.strength==="strong"?"bg-green-500":T.strength==="medium"?"bg-yellow-500":"bg-red-500"}`,style:{width:`${T.score/7*100}%`}})})]}),T.feedback.length>0&&e.jsxs("div",{className:"mt-1",children:[e.jsx("p",{className:"text-xs text-gray-600",children:"Sugestões:"}),e.jsx("ul",{className:"text-xs text-gray-600 list-disc list-inside",children:T.feedback.map((M,$)=>e.jsx("li",{children:M},$))})]})]})]}),e.jsxs("button",{onClick:C,disabled:!h||!p,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(jr,{className:"h-4 w-4"}),e.jsx("span",{children:"Definir Credenciais"})]})]}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("button",{onClick:N,disabled:!t.name,className:"flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(ma,{className:"h-4 w-4"}),e.jsx("span",{children:"Gerar Credenciais"})]}),!t.name&&e.jsx("p",{className:"text-sm text-gray-500",children:"Preencha o nome do funcionário para gerar credenciais"})]})]}),E&&o&&e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Credenciais Geradas"}),e.jsxs("button",{onClick:S,className:`flex items-center space-x-1 px-3 py-1 rounded text-sm transition-colors ${_?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(La,{className:"h-3 w-3"}),e.jsx("span",{children:_?"Copiado!":"Copiar"})]})]}),e.jsxs("div",{className:"space-y-2 font-mono text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Email:"}),e.jsx("span",{className:"ml-2 font-semibold",children:o.email})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Usuário:"}),e.jsx("span",{className:"ml-2 font-semibold",children:o.username})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-gray-600",children:"Senha:"}),e.jsx("span",{className:"ml-2 font-semibold",children:c?o.password:"••••••••"}),e.jsx("button",{onClick:()=>u(!c),className:"ml-2 text-gray-400 hover:text-gray-600",children:c?e.jsx(mn,{className:"h-3 w-3"}):e.jsx(Ys,{className:"h-3 w-3"})})]})]}),o.temporaryPassword&&e.jsx("div",{className:"mt-3 p-2 bg-yellow-50 border border-yellow-200 rounded",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(yt,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-yellow-900",children:"Senha Temporária"}),e.jsx("p",{className:"text-yellow-700",children:"O funcionário deve alterar esta senha no primeiro acesso. A senha expira em 7 dias."})]})]})}),t.role==="waiter"&&e.jsx("div",{className:"mt-3 p-2 bg-indigo-50 border border-indigo-200 rounded",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(fn,{className:"h-4 w-4 text-indigo-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-indigo-900",children:"Acesso ao App Garçom"}),e.jsx("p",{className:"text-indigo-700",children:"Estas credenciais também funcionam no aplicativo mobile. Limite: 2 dispositivos simultâneos."})]})]})})]})]}):null},bz=({isVisible:t,mode:s,isOnline:a,retryCount:r=0,isRetrying:o=!1})=>{const[l,c]=y.useState(0);if(y.useEffect(()=>{if(!t){c(0);return}const g=Date.now(),v=setInterval(()=>{c(Math.floor((Date.now()-g)/1e3))},1e3);return()=>clearInterval(v)},[t]),!t)return null;const u=s==="edit"?60:45,h=Math.min(l/u*100,100),f=()=>o?`Tentativa ${r+1} - Tentando novamente...`:r>0?`Tentativa ${r+1} em andamento...`:l<5?s==="edit"?"Salvando alterações...":"Cadastrando funcionário...":l<15?"Processando dados...":l<30?"Aguarde, operação em andamento...":l<u?"Operação está demorando mais que o esperado...":"Timeout em breve. Verifique sua conexão.",p=()=>l<15?"bg-blue-500":l<30?"bg-yellow-500":"bg-red-500";return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg p-6 max-w-sm w-full mx-4 shadow-xl",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:f()}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2 mb-4",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-1000 ${p()}`,style:{width:`${h}%`}})}),e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Bt,{className:"h-4 w-4"}),e.jsxs("span",{children:[l,"s / ",u,"s"]})]}),e.jsxs("div",{className:`flex items-center space-x-1 ${a?"text-green-600":"text-red-600"}`,children:[e.jsx(wg,{className:"h-4 w-4"}),e.jsx("span",{children:a?"Online":"Offline"})]})]}),l>20&&e.jsx("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsx("p",{className:"text-sm text-yellow-800",children:"⚠️ A operação está demorando mais que o normal. Isso pode indicar lentidão na conexão ou no servidor."})}),l>u-10&&e.jsx("div",{className:"mt-4 p-3 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-red-800",children:["🚨 Timeout em ",u-l," segundos. A operação pode ter sido processada mesmo assim."]})})]})})})},vz=({isOpen:t,onClose:s,onSave:a,employee:r,mode:o})=>{const{employee:l,state:c,updateField:u,togglePermission:h,handleSave:f,handleCancel:p,resetForm:g}=y2({initialEmployee:r,onSave:a,onClose:s}),{isOnline:v}=_g();return y.useEffect(()=>{t&&o==="create"&&!r&&g()},[t,o,r,g]),y.useEffect(()=>{if(!t)return;const b=_=>{_.key==="Escape"&&p()};return document.addEventListener("keydown",b),()=>document.removeEventListener("keydown",b)},[t,p]),y.useEffect(()=>{if(!t)return;const b=document.getElementById("employee-modal");if(b){const _=b.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),w=_[0],E=_[_.length-1],k=N=>{N.key==="Tab"&&(N.shiftKey?document.activeElement===w&&(E.focus(),N.preventDefault()):document.activeElement===E&&(w.focus(),N.preventDefault()))};return document.addEventListener("keydown",k),w==null||w.focus(),()=>document.removeEventListener("keydown",k)}},[t]),t?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:p}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{id:"employee-modal",role:"dialog","aria-modal":"true","aria-labelledby":"employee-modal-title","aria-describedby":"employee-modal-description",className:"relative w-full max-w-4xl bg-white rounded-lg shadow-xl",style:{maxHeight:"90vh"},children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 px-6 py-4 rounded-t-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{id:"employee-modal-title",className:"text-xl font-bold text-gray-900",children:o==="create"?"Novo Funcionário":"Editar Funcionário"}),e.jsx("p",{id:"employee-modal-description",className:"text-sm text-gray-600 mt-1",children:o==="create"?"Cadastre um novo funcionário e configure suas permissões":"Edite as informações e permissões do funcionário"})]}),e.jsx("button",{onClick:p,className:"text-gray-400 hover:text-gray-600 transition-colors","aria-label":"Fechar modal",children:e.jsx(nt,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex items-center justify-between mt-2",children:[c.isDirty&&e.jsxs("div",{className:"text-xs text-amber-600 flex items-center space-x-1",children:[e.jsx(Ya,{className:"h-3 w-3"}),e.jsx("span",{children:"Há alterações não salvas"})]}),e.jsx("div",{className:`text-xs flex items-center space-x-1 ${v?"text-green-600":"text-red-600"}`,children:v?e.jsxs(e.Fragment,{children:[e.jsx(wg,{className:"h-3 w-3"}),e.jsx("span",{children:"Online"})]}):e.jsxs(e.Fragment,{children:[e.jsx(p0,{className:"h-3 w-3"}),e.jsx("span",{children:"Sem conexão"})]})})]})]}),e.jsxs("div",{className:"overflow-y-auto px-6 py-6 space-y-8",style:{maxHeight:"calc(90vh - 140px)"},"data-testid":"modal-body",children:[!v&&e.jsx("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(p0,{className:"h-5 w-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-orange-800 font-medium",children:"Sem conexão com a internet"}),e.jsx("p",{className:"text-orange-700 text-sm",children:"Verifique sua conexão antes de tentar salvar o funcionário."})]})]})}),c.errors.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ya,{className:"h-5 w-5 text-red-600"}),e.jsx("p",{className:"text-red-800",children:c.errors.general})]})}),e.jsx(_2,{employee:l,onUpdate:u,errors:c.errors}),e.jsx(S2,{employee:l,onUpdate:u,errors:c.errors}),e.jsx(E2,{employee:l,onTogglePermission:h,mode:o}),!1]}),e.jsx("div",{className:"sticky bottom-0 z-10 bg-white border-t border-gray-200 px-6 py-4 rounded-b-lg",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:c.errors.fields.length>0&&e.jsxs("span",{className:"text-red-600",children:[c.errors.fields.length," erro(s) encontrado(s)"]})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:p,disabled:c.saving,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors disabled:opacity-50",children:"Cancelar"}),e.jsx("button",{onClick:f,disabled:c.saving||!c.isValid||c.errors.fields.length>0,className:`px-6 py-2 rounded-md transition-colors disabled:opacity-50 flex items-center space-x-2 ${v?"bg-blue-600 hover:bg-blue-700 text-white":"bg-orange-600 hover:bg-orange-700 text-white"}`,title:v?"":"Salvará offline e sincronizará quando a conexão for restaurada",children:c.saving?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),e.jsx("span",{children:o==="edit"?"Salvando alterações...":"Cadastrando funcionário..."})]}):v?e.jsxs(e.Fragment,{children:[e.jsx(oo,{className:"h-4 w-4"}),e.jsx("span",{children:o==="create"?"Cadastrar":"Salvar"})]}):e.jsxs(e.Fragment,{children:[e.jsx(oo,{className:"h-4 w-4"}),e.jsx("span",{children:"Salvar Offline"})]})})]})]})})]})}),e.jsx(bz,{isVisible:c.saving,mode:o,isOnline:v})]}):null},wz=({isOpen:t,onClose:s,onSave:a,mode:r})=>{const[o,l]=y.useState("employee"),[c,u]=y.useState(null),[h,f]=y.useState(null),{employee:p,state:g,updateField:v,togglePermission:b,resetForm:_}=y2({initialEmployee:void 0,onSave:async S=>{u(S),l("credentials")},onClose:s}),w=async()=>{!g.isValid||g.errors.fields.length>0||(u(p),l("credentials"))},E=async()=>{if(c)try{await a(c,h),N()}catch(S){console.error("Erro ao salvar funcionário:",S),alert("Erro ao salvar funcionário. Tente novamente.")}},k=async()=>{if(c)try{await a(c,null),N()}catch(S){console.error("Erro ao salvar funcionário:",S),alert("Erro ao salvar funcionário. Tente novamente.")}},N=()=>{l("employee"),u(null),f(null),_(),s()},C=()=>{l("employee")};return t?e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 transition-opacity",onClick:N}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{className:"relative w-full max-w-4xl bg-white rounded-lg shadow-xl",style:{maxHeight:"90vh"},children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white border-b border-gray-200 px-6 py-4 rounded-t-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900",children:o==="employee"?"Novo Funcionário":"Configurar Credenciais"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:o==="employee"?"Cadastre os dados básicos do funcionário":"Configure as credenciais de acesso (opcional)"})]}),e.jsx("button",{onClick:N,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(nt,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-4",children:[e.jsxs("div",{className:`flex items-center space-x-2 ${o==="employee"?"text-blue-600":"text-green-600"}`,children:[o==="employee"?e.jsx(Ks,{className:"h-5 w-5"}):e.jsx(ts,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-medium",children:"1. Dados do Funcionário"})]}),e.jsx(no,{className:"h-4 w-4 text-gray-400"}),e.jsxs("div",{className:`flex items-center space-x-2 ${o==="credentials"?"text-blue-600":"text-gray-400"}`,children:[e.jsx(jr,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-medium",children:"2. Credenciais (Opcional)"})]})]})]}),e.jsx("div",{className:"overflow-y-auto px-6 py-6 space-y-8",style:{maxHeight:"calc(90vh - 140px)"},children:o==="employee"?e.jsxs(e.Fragment,{children:[g.errors.general&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-800",children:g.errors.general})}),e.jsx(_2,{employee:p,onUpdate:v,errors:g.errors}),e.jsx(S2,{employee:p,onUpdate:v,errors:g.errors}),e.jsx(E2,{employee:p,onTogglePermission:b,mode:r})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ts,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-green-900",children:"Funcionário Configurado"}),e.jsxs("p",{className:"text-green-700 text-sm",children:[c==null?void 0:c.name," - ",c==null?void 0:c.role]})]})]})}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Sobre as Credenciais"}),e.jsx("p",{className:"text-blue-700 text-sm",children:"Você pode criar credenciais de acesso agora ou fazer isso mais tarde. Se pular esta etapa, o funcionário será cadastrado apenas para controle interno, sem capacidade de fazer login no sistema."})]}),e.jsx(yz,{employee:c||{},onCredentialsGenerated:f,mode:"create",showCredentialsStep:!0})]})}),e.jsx("div",{className:"sticky bottom-0 z-10 bg-white border-t border-gray-200 px-6 py-4 rounded-b-lg",children:o==="employee"?e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"text-sm text-gray-500",children:g.errors.fields.length>0&&e.jsxs("span",{className:"text-red-600",children:[g.errors.fields.length," erro(s) encontrado(s)"]})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:N,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Cancelar"}),e.jsxs("button",{onClick:w,disabled:!g.isValid||g.errors.fields.length>0,className:"px-6 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-md transition-colors disabled:opacity-50 flex items-center space-x-2",children:[e.jsx("span",{children:"Próximo"}),e.jsx(no,{className:"h-4 w-4"})]})]})]}):e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("button",{onClick:C,className:"flex items-center space-x-2 px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:[e.jsx(fo,{className:"h-4 w-4"}),e.jsx("span",{children:"Voltar"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:k,className:"px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-md transition-colors",children:"Pular Credenciais"}),e.jsxs("button",{onClick:E,disabled:!h,className:"px-6 py-2 bg-green-600 hover:bg-green-700 text-white rounded-md transition-colors disabled:opacity-50 flex items-center space-x-2",children:[e.jsx(oo,{className:"h-4 w-4"}),e.jsx("span",{children:"Finalizar Cadastro"})]})]})]})})]})})]}):null},jz=({isOpen:t,onClose:s,onSave:a})=>{const[r,o]=y.useState({nome_completo:"",email:"",telefone:"",cpf:"",bar_role:"atendente",cargo:"Atendente de Caixa",observacoes:""}),[l,c]=y.useState(!1),[u,h]=y.useState({}),f=[{value:"atendente",label:"Atendente de Caixa",cargo:"Atendente de Caixa"},{value:"garcom",label:"Garçom",cargo:"Garçom"},{value:"cozinheiro",label:"Cozinheiro",cargo:"Cozinheiro"},{value:"barman",label:"Barman",cargo:"Barman"},{value:"gerente",label:"Gerente",cargo:"Gerente"}],p=_=>{const w=f.find(E=>E.value===_);w&&o(E=>({...E,bar_role:_,cargo:w.cargo}))},g=()=>{const _={};return r.nome_completo.trim()||(_.nome_completo="Nome completo é obrigatório"),r.email.trim()?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(r.email)||(_.email="Email inválido"):_.email="Email é obrigatório",r.bar_role||(_.bar_role="Função é obrigatória"),h(_),Object.keys(_).length===0},v=async()=>{if(g()){console.log("📤 DADOS ENVIADOS do modal:"),console.log("  - nome_completo:",r.nome_completo),console.log("  - email:",r.email),console.log("  - telefone:",r.telefone),console.log("  - cpf:",r.cpf),console.log("  - bar_role:",r.bar_role),console.log("  - cargo:",r.cargo),c(!0);try{await a(r),b()}catch(_){console.error("Erro ao salvar funcionário:",_)}finally{c(!1)}}},b=()=>{o({nome_completo:"",email:"",telefone:"",cpf:"",bar_role:"atendente",cargo:"Atendente de Caixa",observacoes:""}),h({}),s()};return t?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:b}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-lg sm:w-full",children:[e.jsxs("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ks,{className:"h-6 w-6 text-blue-600"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Novo Funcionário"})]}),e.jsx("button",{onClick:b,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(nt,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3 mb-4",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Etapa 1:"})," Cadastro básico do funcionário. As credenciais de acesso serão criadas posteriormente através da edição."]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo *"}),e.jsx("input",{type:"text",value:r.nome_completo,onChange:_=>o(w=>({...w,nome_completo:_.target.value})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${u.nome_completo?"border-red-300":"border-gray-300"}`,placeholder:"Digite o nome completo"}),u.nome_completo&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.nome_completo})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",value:r.email,onChange:_=>o(w=>({...w,email:_.target.value})),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${u.email?"border-red-300":"border-gray-300"}`,placeholder:"Digite o email"}),u.email&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.email})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone"}),e.jsx("input",{type:"tel",value:r.telefone,onChange:_=>o(w=>({...w,telefone:_.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"(00) 00000-0000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CPF"}),e.jsx("input",{type:"text",value:r.cpf,onChange:_=>o(w=>({...w,cpf:_.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"000.000.000-00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Função *"}),e.jsx("select",{value:r.bar_role,onChange:_=>p(_.target.value),className:`w-full px-3 py-2 border rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 ${u.bar_role?"border-red-300":"border-gray-300"}`,children:f.map(_=>e.jsx("option",{value:_.value,children:_.label},_.value))}),u.bar_role&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:u.bar_role})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cargo"}),e.jsx("input",{type:"text",value:r.cargo,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-600"})]})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsxs("button",{onClick:v,disabled:l,className:"w-full inline-flex justify-center items-center space-x-2 rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(oo,{className:"h-4 w-4"}),e.jsx("span",{children:l?"Salvando...":"Salvar Funcionário"})]}),e.jsx("button",{onClick:b,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancelar"})]})]})]})}):null},_z=({isOpen:t,onClose:s,onSave:a,employeeName:r,employeeRole:o})=>{const[l,c]=y.useState(!1),[u,h]=y.useState({tem_acesso_sistema:!0,permissoes_modulos:{}}),f=k=>({atendente:{gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}},garcom:{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},atendimento_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1},clientes:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}},cozinheiro:{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1},monitor_cozinha:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},gerente:{dashboard:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},monitor_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},atendimento_bar:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},monitor_cozinha:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},gestao_caixa:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},clientes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},funcionarios:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0},relatorios:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!0}}})[k]||{dashboard:{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1}};Ye.useEffect(()=>{if(t){const k=f(o);h({tem_acesso_sistema:!0,permissoes_modulos:k})}},[t,o]);const p=[{key:"dashboard",name:"Dashboard",icon:"📊"},{key:"monitor_bar",name:"Monitor Bar",icon:"🍺"},{key:"atendimento_bar",name:"Atendimento Bar",icon:"🍽️"},{key:"monitor_cozinha",name:"Monitor Cozinha",icon:"👨‍🍳"},{key:"gestao_caixa",name:"Gestão de Caixa",icon:"💰"},{key:"clientes",name:"Clientes",icon:"👥"},{key:"funcionarios",name:"Funcionários",icon:"👔"},{key:"relatorios",name:"Relatórios",icon:"📈"},{key:"configuracoes",name:"Configurações",icon:"⚙️"}],g=["visualizar","criar","editar","excluir","administrar"],v={visualizar:"Ver",criar:"Criar",editar:"Editar",excluir:"Excluir",administrar:"Admin"},b=(k,N,C)=>{h(S=>({...S,permissoes_modulos:{...S.permissoes_modulos,[k]:{...S.permissoes_modulos[k],[N]:C}}}))},_=(k,N)=>{if(N){const C=f(o)[k]||{visualizar:!0,criar:!1,editar:!1,excluir:!1,administrar:!1};h(S=>({...S,permissoes_modulos:{...S.permissoes_modulos,[k]:C}}))}else{const C={...u.permissoes_modulos};delete C[k],h(S=>({...S,permissoes_modulos:C}))}},w=async()=>{c(!0);try{await a(u),E()}catch(k){console.error("Erro ao salvar credenciais:",k)}finally{c(!1)}},E=()=>{h({tem_acesso_sistema:!0,permissoes_modulos:{}}),s()};return t?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:E}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[e.jsxs("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(jr,{className:"h-6 w-6 text-green-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Criar Credenciais de Acesso"}),e.jsxs("p",{className:"text-sm text-gray-600",children:[r," - ",o]})]})]}),e.jsx("button",{onClick:E,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(nt,{className:"h-6 w-6"})})]}),e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 mb-4",children:e.jsxs("p",{className:"text-sm text-green-800",children:[e.jsx("strong",{children:"Etapa 2:"})," Definir credenciais e permissões de acesso ao sistema. As permissões foram pré-configuradas baseadas na função do funcionário."]})}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Ni,{className:"h-5 w-5 text-blue-600"}),e.jsxs("label",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",checked:u.tem_acesso_sistema,onChange:k=>h(N=>({...N,tem_acesso_sistema:k.target.checked})),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Permitir acesso ao sistema"})]})]})}),u.tem_acesso_sistema&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Permissões por Módulo"}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:p.map(k=>{const N=u.permissoes_modulos[k.key];return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("span",{className:"text-lg",children:k.icon}),e.jsx("span",{className:"font-medium text-gray-900",children:k.name})]}),e.jsx("label",{className:"flex items-center",children:e.jsx("input",{type:"checkbox",checked:!!N,onChange:C=>_(k.key,C.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})})]}),N&&e.jsx("div",{className:"grid grid-cols-5 gap-2 ml-8",children:g.map(C=>e.jsxs("label",{className:"flex items-center space-x-1",children:[e.jsx("input",{type:"checkbox",checked:N[C]||!1,onChange:S=>b(k.key,C,S.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500 text-xs"}),e.jsx("span",{className:"text-xs text-gray-600",children:v[C]})]},C))})]},k.key)})})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsxs("button",{onClick:w,disabled:l,className:"w-full inline-flex justify-center items-center space-x-2 rounded-md border border-transparent shadow-sm px-4 py-2 bg-green-600 text-base font-medium text-white hover:bg-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(oo,{className:"h-4 w-4"}),e.jsx("span",{children:l?"Criando...":"Criar Credenciais"})]}),e.jsx("button",{onClick:E,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancelar"})]})]})]})}):null},Nz=()=>{const{isOnline:t,wasOffline:s}=_g(),[a,r]=y.useState(!1);return y.useEffect(()=>{if(t&&s){r(!0);const o=setTimeout(()=>{r(!1)},5e3);return()=>clearTimeout(o)}},[t,s]),a?e.jsx("div",{className:"fixed top-4 right-4 z-50 bg-green-50 border border-green-200 rounded-lg p-4 shadow-lg max-w-sm",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(wg,{className:"h-5 w-5 text-green-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-green-900",children:"Conexão Restaurada"}),e.jsx("p",{className:"text-sm text-green-700 mt-1",children:"Você está online novamente. Pode continuar salvando dados."})]}),e.jsx("button",{onClick:()=>r(!1),className:"text-green-400 hover:text-green-600",children:e.jsx(nt,{className:"h-4 w-4"})})]})}):t?null:e.jsx("div",{className:"fixed top-4 right-4 z-50 bg-red-50 border border-red-200 rounded-lg p-4 shadow-lg max-w-sm",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(p0,{className:"h-5 w-5 text-red-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-red-900",children:"Sem Conexão"}),e.jsx("p",{className:"text-sm text-red-700 mt-1",children:"Verifique sua internet. Algumas funcionalidades podem não funcionar."})]})]})})},T2=({isOpen:t,onClose:s,credentials:a,employeeName:r})=>{const[o,l]=y.useState(!1),[c,u]=y.useState(null);if(!t)return null;const h=async(p,g)=>{try{await navigator.clipboard.writeText(p),u(g),setTimeout(()=>u(null),2e3)}catch(v){console.error("Erro ao copiar:",v)}},f=()=>`
CREDENCIAIS DE ACESSO - ${r.toUpperCase()}

📧 Email: ${a.system.email}
👤 Usuário: ${a.system.username}
🔑 Senha: ${a.system.password}

${a.system.temporaryPassword?"⚠️ IMPORTANTE: Esta é uma senha temporária que deve ser alterada no primeiro acesso.":""}
${a.mobile?`
📱 APP GARÇOM:
- Mesmo usuário e senha
- Limite: ${a.mobile.deviceLimit} dispositivos`:""}
${a.firstAccessToken?`
🎫 Token de primeiro acesso: ${a.firstAccessToken}`:""}
${a.passwordExpiry?`
⏰ Senha expira em: ${a.passwordExpiry.toLocaleDateString("pt-BR")}`:""}

---
Entregue estas informações ao funcionário de forma segura.
    `.trim();return e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:s}),e.jsx("div",{className:"flex min-h-full items-center justify-center p-4",children:e.jsxs("div",{className:"relative w-full max-w-md bg-white rounded-lg shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"Credenciais Geradas"}),e.jsx("p",{className:"text-sm text-gray-600",children:r})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx(nt,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ts,{className:"h-5 w-5 text-green-600"}),e.jsx("p",{className:"text-green-800 font-medium",children:"Funcionário cadastrado com sucesso!"})]})}),e.jsxs("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Ks,{className:"h-4 w-4 text-gray-600"}),e.jsx("h3",{className:"font-medium text-gray-900",children:"Acesso ao Sistema"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Email:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-mono text-sm",children:a.system.email}),e.jsx("button",{onClick:()=>h(a.system.email,"email"),className:"text-gray-400 hover:text-gray-600",children:e.jsx(La,{className:"h-3 w-3"})})]})]}),a.system.username&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Usuário:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-mono text-sm",children:a.system.username}),e.jsx("button",{onClick:()=>h(a.system.username,"username"),className:"text-gray-400 hover:text-gray-600",children:e.jsx(La,{className:"h-3 w-3"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Senha:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-mono text-sm",children:o?a.system.password:"••••••••"}),e.jsx("button",{onClick:()=>l(!o),className:"text-gray-400 hover:text-gray-600",children:o?e.jsx(mn,{className:"h-3 w-3"}):e.jsx(Ys,{className:"h-3 w-3"})}),e.jsx("button",{onClick:()=>h(a.system.password,"password"),className:"text-gray-400 hover:text-gray-600",children:e.jsx(La,{className:"h-3 w-3"})})]})]})]})]}),a.mobile&&e.jsxs("div",{className:"bg-indigo-50 border border-indigo-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(fn,{className:"h-4 w-4 text-indigo-600"}),e.jsx("h3",{className:"font-medium text-indigo-900",children:"App Garçom"})]}),e.jsxs("div",{className:"text-sm text-indigo-700",children:[e.jsx("p",{children:"✓ Mesmo usuário e senha funcionam no app mobile"}),e.jsxs("p",{children:["✓ Limite: ",a.mobile.deviceLimit," dispositivos simultâneos"]}),e.jsx("p",{children:"✓ Sincronização automática com o sistema"})]})]}),a.system.temporaryPassword!==!1&&e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-2",children:[e.jsx(yt,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-yellow-900",children:"Senha Temporária"}),e.jsxs("p",{className:"text-yellow-700",children:["O funcionário deve alterar esta senha no primeiro acesso.",a.passwordExpiry&&e.jsxs("span",{className:"block mt-1",children:["Expira em: ",a.passwordExpiry.toLocaleDateString("pt-BR")]})]})]})]})}),a.firstAccessToken&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:"Token de Primeiro Acesso"}),e.jsx("p",{className:"text-sm text-blue-700",children:"Para validação adicional"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-mono text-lg font-bold text-blue-900",children:a.firstAccessToken}),e.jsx("button",{onClick:()=>h(a.firstAccessToken,"token"),className:"text-blue-400 hover:text-blue-600",children:e.jsx(La,{className:"h-3 w-3"})})]})]})})]}),e.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200",children:[e.jsxs("button",{onClick:()=>h(f(),"all"),className:`flex items-center space-x-2 px-4 py-2 rounded-md transition-colors ${c==="all"?"bg-green-100 text-green-700":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(La,{className:"h-4 w-4"}),e.jsx("span",{children:c==="all"?"Copiado!":"Copiar Tudo"})]}),e.jsx("button",{onClick:s,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Fechar"})]})]})})]})},Sz=()=>{const[t,s]=y.useState(!1),[a,r]=y.useState(null),o=y.useCallback(async c=>{console.log("📥 DADOS RECEBIDOS no hook:"),console.log("  - nome_completo:",c.nome_completo),console.log("  - email:",c.email),console.log("  - telefone:",c.telefone),console.log("  - cpf:",c.cpf),console.log("  - bar_role:",c.bar_role),console.log("  - cargo:",c.cargo);try{s(!0),r(null),console.log("🔐 Verificando autenticação...");const u=await Mc();if(!u.success)throw console.error("❌ Falha na autenticação:",u.error),new Error(`Falha na autenticação: ${u.error}`);console.log("✅ Autenticação OK"),console.log("🔍 Tentando obter empresa_id...");let h;try{const S=await vt();if(!S)throw new Error("Usuário não está associado a nenhuma empresa");h=S,console.log("🏢 Empresa ID obtido:",h)}catch(S){throw console.error("❌ Erro ao obter empresa_id:",S),new Error("Não foi possível obter o ID da empresa do usuário logado")}if(!h)throw new Error("Não foi possível obter o ID da empresa");console.log("🔍 Buscando department e position...");const{data:f,error:p}=await B.from("departments").select("id").eq("is_active",!0).limit(1).single();if(p||!f)throw new Error("Nenhum departamento ativo encontrado. Configure um departamento antes de criar funcionários.");const g=f.id;console.log("✅ Department encontrado:",g);const{data:v,error:b}=await B.from("positions").select("id").eq("is_active",!0).limit(1).single();if(b||!v)throw new Error("Nenhum cargo ativo encontrado. Configure um cargo antes de criar funcionários.");const _=v.id;console.log("✅ Position encontrado:",_),console.log("📋 Department/Position:",{departmentId:g,positionId:_});const w={employee_code:`EMP-${Date.now()}`,name:c.nome_completo,hire_date:new Date().toISOString().split("T")[0],status:"active",empresa_id:h,position_id:_,department_id:g};c.email&&(w.email=c.email),c.telefone&&(w.phone=c.telefone),c.cpf&&(w.cpf=c.cpf),console.log("💾 Criando employee:",{code:w.employee_code,name:w.name,email:w.email,position_id:_,department_id:g});const{data:E,error:k}=await B.from("employees").insert(w).select("id").single();if(k)throw console.error("❌ Erro ao criar employee:",k),new Error(`Erro ao criar funcionário: ${k.message}`);if(!E)throw new Error("Funcionário criado mas ID não retornado");console.log("✅ Employee criado:",E.id),console.log("� Criaando bar_employee...");const N={employee_id:E.id,bar_role:c.bar_role,shift_preference:"qualquer",is_active:!0,start_date:new Date().toISOString().split("T")[0],notes:c.observacoes||"",empresa_id:h},{error:C}=await B.from("bar_employees").insert(N);if(C)throw console.error("❌ Erro ao criar bar_employee:",C),await B.from("employees").delete().eq("id",E.id),new Error(`Erro ao criar registro do bar: ${C.message}`);return console.log("✅ Funcionário criado:",{id:E.id,nome:c.nome_completo,role:c.bar_role}),{success:!0,employeeId:E.id,message:"Funcionário criado com sucesso!"}}catch(u){const h=u instanceof Error?u.message:"Erro ao criar funcionário";return r(h),console.error("❌ ERRO COMPLETO ao criar funcionário básico:",{error:u,message:h,stack:u instanceof Error?u.stack:"No stack"}),{success:!1,error:h}}finally{s(!1)}},[]),l=y.useCallback(async(c,u,h)=>{var f;try{if(s(!0),r(null),!h.tem_acesso_sistema)return{success:!0,message:"Funcionário configurado sem acesso ao sistema"};const p=await vt();if(!p)throw new Error("Não foi possível obter o ID da empresa");const{data:g,error:v}=await B.from("employees").select("name, email").eq("id",c).single();if(v||!g)throw new Error("Funcionário não encontrado");const{data:{session:b}}=await B.auth.getSession();console.log("🔍 Verificando se usuário já existe:",u);const _="123456";let w;const{data:E,error:k}=await B.auth.signUp({email:u,password:_,options:{emailRedirectTo:void 0}});if(k)if(k.message.includes("User already registered")||k.message.includes("already registered")){console.log("⚠️ Usuário já existe no Auth"),console.log("🔍 Buscando user_id no Auth para:",u);const{data:L,error:I}=await B.rpc("get_auth_user_id_by_email",{p_email:u});if(I)throw console.error("❌ Erro ao buscar user_id:",I),new Error(`Erro ao buscar usuário existente: ${I.message}`);if(L)w=L,console.log("✅ User ID encontrado no Auth:",w);else throw new Error(`Usuário ${u} já existe mas não foi possível obter o ID. Entre em contato com o suporte.`)}else throw new Error(`Erro ao criar usuário no Auth: ${k.message}`);else{if(!((f=E.user)!=null&&f.id))throw new Error("Falha ao obter ID do usuário criado");w=E.user.id,console.log("✅ Novo usuário criado no Auth:",w)}b&&(await B.auth.setSession({access_token:b.access_token,refresh_token:b.refresh_token}),console.log("✅ Sessão original restaurada")),console.log("📝 Atualizando profile_id no employee...");const{data:N,error:C}=await B.from("employees").update({profile_id:w,tem_acesso_sistema:!0}).eq("id",c).select("id, profile_id");if(C)throw console.error("❌ ERRO ao atualizar profile_id:",C),new Error(`Falha ao vincular usuário ao funcionário: ${C.message}`);if(!N||N.length===0){console.error("❌ Nenhuma linha atualizada. Verificando se o employee existe...");const{data:L}=await B.from("employees").select("id, empresa_id").eq("id",c).single();throw L?L.empresa_id!==p?new Error("Funcionário pertence a outra empresa"):new Error("Falha ao atualizar profile_id - verifique as permissões RLS"):new Error("Funcionário não encontrado")}console.log("✅ Profile_id atualizado:",N[0].profile_id),console.log("🔍 Verificando se usuario_empresa já existe...");const{data:S}=await B.from("usuarios_empresa").select("id, status").eq("user_id",w).eq("empresa_id",p).maybeSingle();let T;if(S)if(console.log("✅ Usuario empresa já existe, usando existente:",S.id),S.status!=="ativo"){const{data:L,error:I}=await B.from("usuarios_empresa").update({status:"ativo",ativo:!0,tem_acesso_sistema:!0,nome_completo:g.name,email:g.email}).eq("id",S.id).select("id").single();if(I)throw new Error(`Erro ao reativar usuario_empresa: ${I.message}`);T=L}else T=S;else{console.log("📝 Criando novo usuario_empresa...");const L={user_id:w,empresa_id:p,nome_completo:g.name,email:g.email,tipo_usuario:"funcionario",cargo:"Funcionário",status:"ativo",ativo:!0,tem_acesso_sistema:!0};console.log("📋 Dados do usuario_empresa:",L);const{data:I,error:X}=await B.from("usuarios_empresa").insert(L).select("id, user_id, tem_acesso_sistema").single();if(X)throw console.error("❌ ERRO ao criar usuario_empresa:",X),new Error(`Erro ao criar usuario_empresa: ${X.message}`);if(!I||!I.id)throw new Error("Usuario_empresa criado mas ID não retornado");console.log("✅ Usuario_empresa criado com sucesso:",I),T=I}console.log("🔍 Verificando vínculo completo...");const{data:M,error:$}=await B.from("usuarios_empresa").select("id, user_id, tem_acesso_sistema").eq("id",T.id).single();if($||!M)throw console.error("❌ Falha na verificação do vínculo:",$),new Error("Vínculo criado mas não pode ser verificado");console.log("✅ Vínculo verificado:",M),console.log("🔍 Verificando permissões existentes...");const{data:A}=await B.from("permissoes_usuario").select("modulo").eq("usuario_empresa_id",T.id),z=(A==null?void 0:A.map(L=>L.modulo))||[],R=Object.entries(h.permissoes_modulos).filter(([L])=>!z.includes(L)).map(([L,I])=>({usuario_empresa_id:T.id,modulo:L,permissoes:I}));if(R.length>0){console.log(`📝 Criando ${R.length} novas permissões...`);const{error:L}=await B.from("permissoes_usuario").insert(R);if(L)throw new Error(`Erro ao criar permissões: ${L.message}`)}else console.log("✅ Todas as permissões já existem");return console.log("✅ Credenciais criadas com sucesso:",{userId:w,email:u,permissionsCount:R.length}),console.log("🎯 VERIFICAÇÃO FINAL COMPLETA:"),console.log("  ✅ Employee ID:",c),console.log("  ✅ Profile ID:",w),console.log("  ✅ Usuario Empresa ID:",T.id),console.log("  ✅ Tem Acesso Sistema:",!0),console.log("  ✅ Permissões:",R.length+z.length),{success:!0,credentials:{email:u,senha_temporaria:_,deve_alterar_senha:!0},message:"Credenciais criadas com sucesso!",details:{employeeId:c,userId:w,usuarioEmpresaId:T.id}}}catch(p){const g=p instanceof Error?p.message:"Erro ao criar credenciais";return r(g),console.error("❌ Erro ao criar credenciais:",p),{success:!1,error:g}}finally{s(!1)}},[]);return{createBasicEmployee:o,addCredentialsToEmployee:l,loading:t,error:a,clearError:()=>r(null)}},Ez=({isOpen:t,onClose:s,employeeName:a,onCreateCredentials:r})=>t?e.jsx("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:s}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-md sm:w-full",children:[e.jsx("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:e.jsxs("div",{className:"sm:flex sm:items-start",children:[e.jsx("div",{className:"mx-auto flex-shrink-0 flex items-center justify-center h-12 w-12 rounded-full bg-yellow-100 sm:mx-0 sm:h-10 sm:w-10",children:e.jsx(yt,{className:"h-6 w-6 text-yellow-600"})}),e.jsxs("div",{className:"mt-3 text-center sm:mt-0 sm:ml-4 sm:text-left",children:[e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900",children:"Funcionário sem credenciais"}),e.jsxs("div",{className:"mt-2",children:[e.jsxs("p",{className:"text-sm text-gray-500",children:["O funcionário ",e.jsx("strong",{children:a})," não possui credenciais de acesso ao sistema."]}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Para configurar permissões específicas, é necessário primeiro criar as credenciais de acesso."})]})]})]})}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsxs("button",{onClick:r,className:"w-full inline-flex justify-center items-center space-x-2 rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm",children:[e.jsx(jr,{className:"h-4 w-4"}),e.jsx("span",{children:"Criar Credenciais"})]}),e.jsx("button",{onClick:s,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancelar"})]})]})]})}):null,xu=[{id:"dashboard",nome:"Dashboard",descricao:"Visão geral do sistema",categoria:"Principal",icone:"📊"},{id:"gestao_caixa",nome:"Gestão de Caixa",descricao:"Operações de caixa e pagamentos",categoria:"Financeiro",icone:"💰"},{id:"atendimento_bar",nome:"Atendimento Bar",descricao:"Atendimento e pedidos do bar",categoria:"Operacional",icone:"🍺"},{id:"monitor_bar",nome:"Monitor Bar",descricao:"Monitoramento do bar",categoria:"Operacional",icone:"📺"},{id:"monitor_cozinha",nome:"Monitor Cozinha",descricao:"Monitoramento da cozinha",categoria:"Operacional",icone:"👨‍🍳"},{id:"clientes",nome:"Clientes",descricao:"Gestão de clientes",categoria:"Gestão",icone:"👥"},{id:"funcionarios",nome:"Funcionários",descricao:"Gestão de funcionários",categoria:"Gestão",icone:"👤"},{id:"relatorios",nome:"Relatórios",descricao:"Relatórios e análises",categoria:"Análise",icone:"📈"},{id:"configuracoes",nome:"Configurações",descricao:"Configurações do sistema",categoria:"Sistema",icone:"⚙️"}],Uj={operador_caixa:{nome:"Operador de Caixa",descricao:"Apenas gestão de caixa",modulos:["gestao_caixa"],permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},atendente_bar:{nome:"Atendente de Bar",descricao:"Atendimento e monitoramento do bar",modulos:["atendimento_bar","monitor_bar"],permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},cozinheiro:{nome:"Cozinheiro",descricao:"Monitoramento da cozinha",modulos:["monitor_cozinha"],permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!1,administrar:!1}},gerente:{nome:"Gerente",descricao:"Acesso completo exceto configurações",modulos:["dashboard","gestao_caixa","atendimento_bar","monitor_bar","monitor_cozinha","clientes","funcionarios","relatorios"],permissoes:{visualizar:!0,criar:!0,editar:!0,excluir:!0,administrar:!1}}},Cz=({isOpen:t,onClose:s,employeeId:a,employeeName:r,onSave:o,onCreateCredentials:l})=>{const[c,u]=y.useState({}),[h,f]=y.useState(!1),[p,g]=y.useState(!1),[v,b]=y.useState(null),[_,w]=y.useState(!1),[E,k]=y.useState(!0);y.useEffect(()=>{t&&a&&N()},[t,a]);const N=async()=>{var z;try{g(!0),console.log("🔍 Carregando permissões para employeeId:",a),console.log("🔍 Buscando employee e suas credenciais...");const{data:R,error:L}=await B.from("employees").select("id, name, email, profile_id, tem_acesso_sistema").eq("id",a).single();if(L||!R){console.error("❌ Erro ao buscar employee:",L),k(!1),w(!0);return}if(console.log("👤 Employee encontrado:",R),!R.profile_id||!R.tem_acesso_sistema){console.log("❌ Employee sem credenciais:",{profile_id:R.profile_id,tem_acesso_sistema:R.tem_acesso_sistema}),k(!1),w(!0);return}const{data:I,error:X}=await B.from("usuarios_empresa").select("id, user_id, nome_completo, tem_acesso_sistema, status, email").eq("user_id",R.profile_id).maybeSingle();if(console.log("🔍 DEBUG - Resultado da query:",{employeeId:a,data:I,error:X,bypass_usado:a==="95886a5e-893c-4889-85a0-8989d48d19fd"}),console.log("📊 DEBUG - Dados recebidos:",I),X){if(console.error("❌ Erro ao buscar usuario_empresa:",X),console.error("❌ Detalhes do erro:",{message:X.message,code:X.code,details:X.details,hint:X.hint}),X.code==="42501"||(z=X.message)!=null&&z.includes("406")){console.error("🔒 Erro de RLS detectado - usuário pode não ter permissão para ver este registro"),k(!1),w(!0);return}return}if(console.log("🧪 DEBUG - Verificando existência:",!!I),!I){console.warn("⚠️ DEBUG - Usuario empresa não encontrado para ID:",a),console.warn("💡 DEBUG - Isso pode indicar que o usuário não tem permissão para ver este registro devido ao RLS"),k(!1),w(!0);return}if(console.log("👤 Usuario empresa encontrado:",I),console.log("🧪 DEBUG - Verificando status:",I==null?void 0:I.status),I.status!=="ativo"){console.log("❌ DEBUG - Usuário não está ativo:",I.status),k(!1),w(!0);return}if(console.log("🧪 DEBUG - Verificando credenciais:",{user_id:I==null?void 0:I.user_id,tem_acesso_sistema:I==null?void 0:I.tem_acesso_sistema,user_id_exists:!!(I!=null&&I.user_id),tem_acesso_true:(I==null?void 0:I.tem_acesso_sistema)===!0}),!I.user_id||!I.tem_acesso_sistema){console.log("❌ DEBUG - Usuário sem credenciais - DETALHES:",{user_id:I.user_id,user_id_type:typeof I.user_id,user_id_null:I.user_id===null,user_id_undefined:I.user_id===void 0,tem_acesso_sistema:I.tem_acesso_sistema,tem_acesso_type:typeof I.tem_acesso_sistema,tem_acesso_false:I.tem_acesso_sistema===!1,condition1:!I.user_id,condition2:!I.tem_acesso_sistema,final_condition:!I.user_id||!I.tem_acesso_sistema}),k(!1),w(!0);return}console.log("✅ Usuário tem credenciais válidas"),k(!0),b(I.id);const{data:ce,error:J}=await B.from("permissoes_usuario").select("modulo, permissoes").eq("usuario_empresa_id",I.id);if(J){console.warn("Erro ao buscar permissões:",J);return}const V={};ce&&ce.forEach(Y=>{V[Y.modulo]=Y.permissoes}),u(V),console.log("✅ Permissões carregadas:",V)}catch(R){console.error("Erro ao carregar permissões:",R)}finally{g(!1)}},C=(z,R,L)=>{u(I=>({...I,[z]:{...I[z]||{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},[R]:L}}))},S=z=>{const R=Uj[z],L={};xu.forEach(I=>{L[I.id]={visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1}}),R.modulos.forEach(I=>{L[I]={...R.permissoes}}),u(L)},T=()=>{const z={};xu.forEach(R=>{z[R.id]={visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1}}),u(z)},M=async()=>{if(!v){alert("Erro: Usuario empresa não encontrado");return}try{f(!0);const z=[];Object.entries(c).forEach(([R,L])=>{(L.visualizar||L.criar||L.editar||L.excluir||L.administrar)&&z.push({usuario_empresa_id:v,modulo:R,permissoes:L})}),console.log("💾 Salvando permissões:",z),await o(z),s()}catch(z){console.error("Erro ao salvar permissões:",z),alert("Erro ao salvar permissões. Tente novamente.")}finally{f(!1)}},$=()=>{u({}),b(null),s()};if(!t)return null;const A=Object.entries(c).filter(([z,R])=>R.visualizar||R.criar||R.editar||R.excluir||R.administrar).length;return e.jsxs("div",{className:"fixed inset-0 z-50 overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-center min-h-screen pt-4 px-4 pb-20 text-center sm:block sm:p-0",children:[e.jsx("div",{className:"fixed inset-0 bg-gray-500 bg-opacity-75 transition-opacity",onClick:$}),e.jsxs("div",{className:"inline-block align-bottom bg-white rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:my-8 sm:align-middle sm:max-w-4xl sm:w-full",children:[e.jsxs("div",{className:"bg-white px-4 pt-5 pb-4 sm:p-6 sm:pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(io,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Gerenciar Permissões"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Funcionário: ",r]})]})]}),e.jsx("button",{onClick:$,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(nt,{className:"h-6 w-6"})})]}),p?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(ma,{className:"h-6 w-6 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Carregando permissões..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:"Presets Rápidos:"}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[Object.entries(Uj).map(([z,R])=>e.jsx("button",{onClick:()=>S(z),className:"px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded-full hover:bg-blue-200 transition-colors",children:R.nome},z)),e.jsx("button",{onClick:T,className:"px-3 py-1 text-xs bg-red-100 text-red-700 rounded-full hover:bg-red-200 transition-colors",children:"Limpar Tudo"})]})]}),e.jsxs("div",{className:"mb-4 p-3 bg-blue-50 rounded-lg",children:[e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Módulos configurados:"})," ",A," de ",xu.length]}),e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"O usuário verá apenas os módulos com pelo menos uma permissão marcada"})]}),e.jsx("div",{className:"space-y-4 max-h-96 overflow-y-auto",children:xu.map(z=>{const R=c[z.id]||{visualizar:!1,criar:!1,editar:!1,excluir:!1,administrar:!1},L=Object.values(R).some(I=>I);return e.jsxs("div",{className:`border rounded-lg p-4 ${L?"border-blue-200 bg-blue-50":"border-gray-200"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-lg",children:z.icone}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-medium text-gray-900",children:z.nome}),e.jsx("p",{className:"text-xs text-gray-500",children:z.descricao})]})]}),e.jsx("span",{className:"text-xs px-2 py-1 bg-gray-100 text-gray-600 rounded",children:z.categoria})]}),e.jsx("div",{className:"grid grid-cols-5 gap-3",children:[{key:"visualizar",label:"Ver",icon:Ys},{key:"criar",label:"Criar",icon:null},{key:"editar",label:"Editar",icon:null},{key:"excluir",label:"Excluir",icon:null},{key:"administrar",label:"Admin",icon:io}].map(({key:I,label:X,icon:ce})=>e.jsxs("label",{className:"flex items-center space-x-1 text-xs",children:[e.jsx("input",{type:"checkbox",checked:R[I],onChange:J=>C(z.id,I,J.target.checked),className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"}),ce&&e.jsx(ce,{className:"h-3 w-3"}),e.jsx("span",{children:X})]},I))})]},z.id)})})]})]}),e.jsxs("div",{className:"bg-gray-50 px-4 py-3 sm:px-6 sm:flex sm:flex-row-reverse",children:[e.jsxs("button",{onClick:M,disabled:h||p,className:"w-full inline-flex justify-center items-center space-x-2 rounded-md border border-transparent shadow-sm px-4 py-2 bg-blue-600 text-base font-medium text-white hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 sm:ml-3 sm:w-auto sm:text-sm disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(oo,{className:"h-4 w-4"}),e.jsx("span",{children:h?"Salvando...":"Salvar Permissões"})]}),e.jsx("button",{onClick:$,className:"mt-3 w-full inline-flex justify-center rounded-md border border-gray-300 shadow-sm px-4 py-2 bg-white text-base font-medium text-gray-700 hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-indigo-500 sm:mt-0 sm:ml-3 sm:w-auto sm:text-sm",children:"Cancelar"})]})]})]}),e.jsx(Ez,{isOpen:_,onClose:()=>{w(!1),s()},employeeName:r,onCreateCredentials:()=>{w(!1),s(),l&&l()}})]})},Tz=()=>{var Ge,Qe,xe,Te;const{loading:t,error:s,updateEmployee:a,deactivateEmployee:r,reactivateEmployee:o,filterEmployees:l,getStats:c,refetch:u}=Y8(),{createEmployeeWithDefaultPermissions:h}=K8(),{createBasicEmployee:f,addCredentialsToEmployee:p}=Sz(),{saveEmployeePermissions:g}=Ng(),[v,b]=y.useState(""),[_,w]=y.useState("all"),[E,k]=y.useState("all"),[N,C]=y.useState(null),[S,T]=y.useState(!1),[M,$]=y.useState(!1),[A,z]=y.useState(!1),[R,L]=y.useState(!1),[I,X]=y.useState(!1),[ce,J]=y.useState(!1),[V,Y]=y.useState(!1),[ee,we]=y.useState(null),[D,H]=y.useState(""),[F,Z]=y.useState(null),[re,oe]=y.useState(!1),[ae,pe]=y.useState(null),P=l(v,_,E),q=c(),Q=he=>{const le={waiter:"garcom",cook:"cozinheiro",cashier:"atendente",supervisor:"gerente",manager:"gerente",admin:"gerente"};return{name:he.name,cpf:he.cpf,email:he.email,phone:he.phone,bar_role:le[he.role]||"atendente",shift_preference:"qualquer",specialties:[],commission_rate:0,notes:he.observations||""}},G=he=>{var Oe,tt,bs,Ls,ka,Or;const le={garcom:"waiter",cozinheiro:"cook",atendente:"cashier",barman:"cashier",gerente:"manager"};return{id:he.id,name:((Oe=he.employee)==null?void 0:Oe.name)||"",email:((tt=he.employee)==null?void 0:tt.email)||"",cpf:((bs=he.employee)==null?void 0:bs.cpf)||"",phone:((Ls=he.employee)==null?void 0:Ls.phone)||"",role:le[he.bar_role]||"waiter",permissions:((ka=co[le[he.bar_role]||"waiter"])==null?void 0:ka.permissions)||[],status:he.status==="active"?"active":"inactive",hire_date:(Or=he.employee)!=null&&Or.hire_date?new Date(he.employee.hire_date):new Date,observations:he.notes||""}},me=he=>({waiter:"garcom",cook:"cozinheiro",cashier:"atendente",supervisor:"barman",manager:"gerente",admin:"gerente"})[he]||"garcom",Ne=async he=>{console.log("🚀 Iniciando criação de funcionário básico:",he);try{const le=await f(he);if(console.log("📋 Resultado da criação:",le),le.success)console.log("✅ Funcionário criado com sucesso:",le),console.log("✅ Processo concluído, recarregando lista"),setTimeout(()=>{alert("Funcionário criado com sucesso! Agora você pode criar as credenciais de acesso."),u()},500);else throw console.error("❌ Erro na criação:",le.error),new Error(le.error)}catch(le){console.error("❌ Erro ao criar funcionário básico:",le),setTimeout(()=>{alert(`Erro ao criar funcionário: ${le instanceof Error?le.message:"Erro desconhecido"}`)},100)}},je=he=>{Z(he),L(!0)},Re=he=>{pe(he),oe(!0)},Ie=async he=>{if(F!=null&&F.employee)try{const le=await p(F.id,F.employee.email||"",he);if(le.success&&le.credentials)we({system:{email:le.credentials.email,password:le.credentials.senha_temporaria,temporaryPassword:le.credentials.deve_alterar_senha,username:le.credentials.email.split("@")[0]}}),H(F.employee.name),Y(!0),setTimeout(()=>u(),2e3);else throw new Error(le.error)}catch(le){console.error("Erro ao criar credenciais:",le),alert("Erro ao criar credenciais. Tente novamente.")}},Ve=async he=>{var le;if((le=ae==null?void 0:ae.employee)!=null&&le.id)try{const Oe=await g(ae.employee.id,he);if(Oe.success)alert("Permissões salvas com sucesso!"),oe(!1),pe(null),u();else throw new Error(Oe.error)}catch(Oe){console.error("Erro ao salvar permissões:",Oe),alert("Erro ao salvar permissões. Tente novamente.")}},De=async(he,le)=>{J(!0);try{console.log("🚀 Criando funcionário com fluxo completo:",he.name);const Oe=await h({nome_completo:he.name,email:he.email,telefone:he.phone,cpf:he.cpf,bar_role:me(he.role),shift_preference:"qualquer",specialties:[],commission_rate:0,observacoes:he.observations,tem_acesso_sistema:!!le});if(Oe.success)console.log("✅ Funcionário criado com sucesso:",Oe),Oe.credentials?(we({system:{email:Oe.credentials.email,password:Oe.credentials.senha_temporaria,temporaryPassword:Oe.credentials.deve_alterar_senha,username:Oe.credentials.email.split("@")[0]}}),H(he.name),Y(!0),console.log("🔑 Credenciais geradas:",{email:Oe.credentials.email,senha:"[OCULTA]",temporaria:Oe.credentials.deve_alterar_senha})):alert("Funcionário cadastrado com sucesso!"),setTimeout(()=>{u()},1e3);else throw new Error(Oe.error||"Erro ao criar funcionário")}catch(Oe){throw console.error("❌ Erro ao criar funcionário:",Oe),Oe}finally{J(!1)}},Ue=he=>{C(he),X(!0)},W=async(he,le)=>{if(!N)return;const Oe=Q(he);J(!0);try{await a(N.id,Oe),C(null),alert("Funcionário atualizado com sucesso!")}catch(tt){throw console.error("Erro ao atualizar funcionário:",tt),tt}finally{J(!1)}},se=async he=>{var Oe;if(confirm(`Tem certeza que deseja desativar o funcionário ${(Oe=he.employee)==null?void 0:Oe.name}?`))try{await r(he.id),alert("Funcionário desativado com sucesso!")}catch(tt){console.error("Erro ao desativar funcionário:",tt),alert("Erro ao desativar funcionário. Tente novamente.")}},ue=async he=>{var Oe;if(confirm(`Tem certeza que deseja reativar o funcionário ${(Oe=he.employee)==null?void 0:Oe.name}?`))try{await o(he.id),alert("Funcionário reativado com sucesso!")}catch(tt){console.error("Erro ao reativar funcionário:",tt),alert("Erro ao reativar funcionário. Tente novamente.")}},Ce=he=>{C(he),T(!0)},ke=he=>{if(!he)return"Não informado";const le=he.replace(/\D/g,"");return le.length===11?`(${le.slice(0,2)}) ${le.slice(2,7)}-${le.slice(7)}`:he},ye=he=>{switch(he){case"atendente":return"👥";case"garcom":return"🍽️";case"cozinheiro":return"👨‍🍳";case"barman":return"🍹";case"gerente":return"👔";default:return"👤"}},Me=he=>{switch(he){case"atendente":return"bg-blue-100 text-blue-800";case"garcom":return"bg-green-100 text-green-800";case"cozinheiro":return"bg-orange-100 text-orange-800";case"barman":return"bg-purple-100 text-purple-800";case"gerente":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},Pe=he=>{switch(he){case"atendente":return"Atendente";case"garcom":return"Garçom";case"cozinheiro":return"Cozinheiro";case"barman":return"Barman";case"gerente":return"Gerente";default:return he}};return e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsx(Nz,{}),s&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"text-red-600",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("p",{className:"text-red-800",children:s})]})}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Funcionários do Bar"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Gerencie a equipe do bar e suas funções"})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>z(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx($s,{size:20}),e.jsx("span",{children:"Novo Funcionário"})]}),e.jsxs("button",{onClick:()=>$(!0),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center space-x-2 text-sm",children:[e.jsx($s,{size:16}),e.jsx("span",{children:"Fluxo Antigo"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:q.total}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total"})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:q.active}),e.jsx("div",{className:"text-sm text-gray-600",children:"Ativos"})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-blue-600",children:["👥 ",q.byRole.atendente]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Atendentes"})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-green-600",children:["🍽️ ",q.byRole.garcom]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Garçons"})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.4},className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-orange-600",children:["👨‍🍳 ",q.byRole.cozinheiro]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Cozinheiros"})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.5},className:"bg-white p-4 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-xl font-bold text-purple-600",children:["🍹 ",q.byRole.barman]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Barmans"})]})})]}),e.jsx("div",{className:"bg-white p-6 rounded-lg shadow-sm border border-gray-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(Xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Buscar por nome, telefone ou email...",value:v,onChange:he=>b(he.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("select",{value:_,onChange:he=>w(he.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todas as Funções"}),e.jsx("option",{value:"atendente",children:"Atendente"}),e.jsx("option",{value:"garcom",children:"Garçom"}),e.jsx("option",{value:"cozinheiro",children:"Cozinheiro"}),e.jsx("option",{value:"barman",children:"Barman"}),e.jsx("option",{value:"gerente",children:"Gerente"})]}),e.jsxs("select",{value:E,onChange:he=>k(he.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"active",children:"Ativo"}),e.jsx("option",{value:"inactive",children:"Inativo"})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 overflow-hidden",children:t?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Carregando funcionários..."})]}):P.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Ks,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"Nenhum funcionário encontrado"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Funcionário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Função no Bar"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Contato"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data de Contratação"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:P.map(he=>{var Oe;const le=he.employee;return le?e.jsxs(be.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10",children:e.jsx("div",{className:"h-10 w-10 rounded-full bg-blue-100 flex items-center justify-center",children:e.jsx("span",{className:"text-sm font-medium text-blue-600",children:le.name.charAt(0).toUpperCase()})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:le.name}),e.jsx("div",{className:"text-sm text-gray-500",children:le.cpf||((Oe=he.employee)==null?void 0:Oe.cpf)||"CPF não informado"})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Me(he.bar_role)}`,children:[e.jsx("span",{className:"mr-1",children:ye(he.bar_role)}),Pe(he.bar_role)]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:ke(le.phone||null)}),e.jsx("div",{className:"text-sm text-gray-500",children:le.email||"Email não informado"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${he.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:he.status==="active"?"Ativo":"Inativo"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:le.hire_date?new Date(le.hire_date).toLocaleDateString("pt-BR"):"Não informado"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>Ce(he),className:"text-blue-600 hover:text-blue-900",title:"Ver detalhes",children:e.jsx(Ys,{size:16})}),e.jsx("button",{onClick:()=>Ue(he),className:"text-gray-600 hover:text-gray-900",title:"Editar funcionário",children:e.jsx(lo,{size:16})}),e.jsx("button",{onClick:()=>je(he),className:"text-green-600 hover:text-green-900",title:"Criar credenciais de acesso",children:e.jsx(XN,{size:16})}),e.jsx("button",{onClick:()=>Re(he),className:"text-purple-600 hover:text-purple-900",title:"Gerenciar permissões",children:e.jsx(io,{size:16})}),he.status==="active"?e.jsx("button",{onClick:()=>se(he),className:"text-red-600 hover:text-red-900",title:"Desativar funcionário",children:e.jsx(Yi,{size:16})}):e.jsx("button",{onClick:()=>ue(he),className:"text-green-600 hover:text-green-900",title:"Reativar funcionário",children:e.jsx(Ks,{size:16})})]})})]},he.id):null})})]})})}),S&&N&&N.employee&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800",children:"Detalhes do Funcionário"}),e.jsx("button",{onClick:()=>T(!1),className:"text-gray-500 hover:text-gray-700",children:"✕"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Nome"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:N.employee.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Função no Bar"}),e.jsx("p",{className:"mt-1",children:e.jsxs("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${Me(N.bar_role)}`,children:[e.jsx("span",{className:"mr-1",children:ye(N.bar_role)}),Pe(N.bar_role)]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Telefone"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:ke(((Ge=N.employee)==null?void 0:Ge.phone)||null)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:N.employee.email||"Não informado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"CPF"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:N.employee.cpf||"Não informado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Status"}),e.jsx("p",{className:"mt-1",children:e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${N.status==="active"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:N.status==="active"?"Ativo":"Inativo"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Data de Contratação"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:N.employee.hire_date?new Date(N.employee.hire_date).toLocaleDateString("pt-BR"):"Não informado"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Cadastrado no Bar em"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:new Date(N.created_at).toLocaleDateString("pt-BR")})]})]}),N.notes&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Observações"}),e.jsx("p",{className:"mt-1 text-sm text-gray-900",children:N.notes})]})]}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsx("button",{onClick:()=>T(!1),className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"Fechar"})})]})}),e.jsx(wz,{isOpen:M,onClose:()=>$(!1),onSave:De,mode:"create"}),e.jsx(vz,{isOpen:I,onClose:()=>X(!1),onSave:he=>W(he),employee:N?G(N):void 0,mode:"edit"}),ee&&e.jsx(T2,{isOpen:V,onClose:()=>{Y(!1),we(null),H("")},credentials:ee,employeeName:D}),e.jsx(jz,{isOpen:A,onClose:()=>z(!1),onSave:Ne}),e.jsx(_z,{isOpen:R,onClose:()=>{L(!1),Z(null)},onSave:Ie,employeeName:((Qe=F==null?void 0:F.employee)==null?void 0:Qe.name)||"",employeeRole:(F==null?void 0:F.bar_role)||""}),e.jsx(Cz,{isOpen:re,onClose:()=>{oe(!1),pe(null)},employeeId:((xe=ae==null?void 0:ae.employee)==null?void 0:xe.id)||"",employeeName:((Te=ae==null?void 0:ae.employee)==null?void 0:Te.name)||"",onSave:Ve,onCreateCredentials:()=>{oe(!1),Z(ae),pe(null),L(!0)}})]})},kz=({onOrderUpdate:t,empresaId:s})=>{const a=y.useCallback(r=>{console.log("👨‍🍳 REALTIME MONITOR COZINHA:",r.eventType,r.table),(r.eventType==="INSERT"||r.eventType==="UPDATE")&&(console.log("🔄 Atualizando Monitor Cozinha..."),t())},[t]);y.useEffect(()=>{console.log("🔌 Conectando realtime do Monitor Cozinha...");const r=B.channel("kitchen-monitor-realtime").on("postgres_changes",{event:"*",schema:"public",table:"balcao_orders",filter:s?`empresa_id=eq.${s}`:void 0},o=>{var l,c;console.log("🔥 REALTIME COZINHA - balcao_orders:",o.eventType),o.eventType==="UPDATE"&&((l=o.old)==null?void 0:l.status)==="pending_payment"&&((c=o.new)==null?void 0:c.status)==="paid"&&console.log("💰 PEDIDO PAGO! Atualizando Monitor Cozinha..."),a(o)}).on("postgres_changes",{event:"*",schema:"public",table:"balcao_order_items"},o=>{console.log("🔥 REALTIME COZINHA - balcao_order_items:",o.eventType),a(o)}).on("postgres_changes",{event:"*",schema:"public",table:"comandas"},o=>{console.log("🔥 REALTIME COZINHA - comandas:",o.eventType),a(o)}).on("postgres_changes",{event:"*",schema:"public",table:"comanda_items"},o=>{console.log("🔥 REALTIME COZINHA - comanda_items:",o.eventType),a(o)}).subscribe(o=>{o==="SUBSCRIBED"?console.log("✅ Realtime do Monitor Cozinha ativo!"):o==="CHANNEL_ERROR"&&console.error("❌ Erro no realtime do Monitor Cozinha")});return()=>{console.log("🔌 Desconectando realtime do Monitor Cozinha"),r.unsubscribe()}},[a,s])};var Hc=t=>t.type==="checkbox",to=t=>t instanceof Date,Cs=t=>t==null;const k2=t=>typeof t=="object";var Yt=t=>!Cs(t)&&!Array.isArray(t)&&k2(t)&&!to(t),A2=t=>Yt(t)&&t.target?Hc(t.target)?t.target.checked:t.target.value:t,Az=t=>t.substring(0,t.search(/\.\d+(\.|$)/))||t,M2=(t,s)=>t.has(Az(s)),Mz=t=>{const s=t.constructor&&t.constructor.prototype;return Yt(s)&&s.hasOwnProperty("isPrototypeOf")},Sg=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function os(t){let s;const a=Array.isArray(t),r=typeof FileList<"u"?t instanceof FileList:!1;if(t instanceof Date)s=new Date(t);else if(!(Sg&&(t instanceof Blob||r))&&(a||Yt(t)))if(s=a?[]:Object.create(Object.getPrototypeOf(t)),!a&&!Mz(t))s=t;else for(const o in t)t.hasOwnProperty(o)&&(s[o]=os(t[o]));else return t;return s}var jm=t=>/^\w*$/.test(t),Gt=t=>t===void 0,Eg=t=>Array.isArray(t)?t.filter(Boolean):[],Cg=t=>Eg(t.replace(/["|']|\]/g,"").split(/\.|\[/)),ze=(t,s,a)=>{if(!s||!Yt(t))return a;const r=(jm(s)?[s]:Cg(s)).reduce((o,l)=>Cs(o)?o:o[l],t);return Gt(r)||r===t?Gt(t[s])?a:t[s]:r},Zs=t=>typeof t=="boolean",St=(t,s,a)=>{let r=-1;const o=jm(s)?[s]:Cg(s),l=o.length,c=l-1;for(;++r<l;){const u=o[r];let h=a;if(r!==c){const f=t[u];h=Yt(f)||Array.isArray(f)?f:isNaN(+o[r+1])?{}:[]}if(u==="__proto__"||u==="constructor"||u==="prototype")return;t[u]=h,t=t[u]}};const em={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},ja={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},gr={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},R2=Ye.createContext(null);R2.displayName="HookFormContext";const Tg=()=>Ye.useContext(R2);var O2=(t,s,a,r=!0)=>{const o={defaultValues:s._defaultValues};for(const l in t)Object.defineProperty(o,l,{get:()=>{const c=l;return s._proxyFormState[c]!==ja.all&&(s._proxyFormState[c]=!r||ja.all),a&&(a[c]=!0),t[c]}});return o};const kg=typeof window<"u"?Ye.useLayoutEffect:Ye.useEffect;function Rz(t){const s=Tg(),{control:a=s.control,disabled:r,name:o,exact:l}=t||{},[c,u]=Ye.useState(a._formState),h=Ye.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,validatingFields:!1,isValidating:!1,isValid:!1,errors:!1});return kg(()=>a._subscribe({name:o,formState:h.current,exact:l,callback:f=>{!r&&u({...a._formState,...f})}}),[o,r,l]),Ye.useEffect(()=>{h.current.isValid&&a._setValid(!0)},[a]),Ye.useMemo(()=>O2(c,a,h.current,!1),[c,a])}var Va=t=>typeof t=="string",D2=(t,s,a,r,o)=>Va(t)?(r&&s.watch.add(t),ze(a,t,o)):Array.isArray(t)?t.map(l=>(r&&s.watch.add(l),ze(a,l))):(r&&(s.watchAll=!0),a),j0=t=>Cs(t)||!k2(t);function vr(t,s,a=new WeakSet){if(j0(t)||j0(s))return t===s;if(to(t)&&to(s))return t.getTime()===s.getTime();const r=Object.keys(t),o=Object.keys(s);if(r.length!==o.length)return!1;if(a.has(t)||a.has(s))return!0;a.add(t),a.add(s);for(const l of r){const c=t[l];if(!o.includes(l))return!1;if(l!=="ref"){const u=s[l];if(to(c)&&to(u)||Yt(c)&&Yt(u)||Array.isArray(c)&&Array.isArray(u)?!vr(c,u,a):c!==u)return!1}}return!0}function Oz(t){const s=Tg(),{control:a=s.control,name:r,defaultValue:o,disabled:l,exact:c,compute:u}=t||{},h=Ye.useRef(o),f=Ye.useRef(u),p=Ye.useRef(void 0);f.current=u;const g=Ye.useMemo(()=>a._getWatch(r,h.current),[a,r]),[v,b]=Ye.useState(f.current?f.current(g):g);return kg(()=>a._subscribe({name:r,formState:{values:!0},exact:c,callback:_=>{if(!l){const w=D2(r,a._names,_.values||a._formValues,!1,h.current);if(f.current){const E=f.current(w);vr(E,p.current)||(b(E),p.current=E)}else b(w)}}}),[a,l,r,c]),Ye.useEffect(()=>a._removeUnmounted()),v}function Dz(t){const s=Tg(),{name:a,disabled:r,control:o=s.control,shouldUnregister:l,defaultValue:c}=t,u=M2(o._names.array,a),h=Ye.useMemo(()=>ze(o._formValues,a,ze(o._defaultValues,a,c)),[o,a,c]),f=Oz({control:o,name:a,defaultValue:h,exact:!0}),p=Rz({control:o,name:a,exact:!0}),g=Ye.useRef(t),v=Ye.useRef(o.register(a,{...t.rules,value:f,...Zs(t.disabled)?{disabled:t.disabled}:{}}));g.current=t;const b=Ye.useMemo(()=>Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!ze(p.errors,a)},isDirty:{enumerable:!0,get:()=>!!ze(p.dirtyFields,a)},isTouched:{enumerable:!0,get:()=>!!ze(p.touchedFields,a)},isValidating:{enumerable:!0,get:()=>!!ze(p.validatingFields,a)},error:{enumerable:!0,get:()=>ze(p.errors,a)}}),[p,a]),_=Ye.useCallback(N=>v.current.onChange({target:{value:A2(N),name:a},type:em.CHANGE}),[a]),w=Ye.useCallback(()=>v.current.onBlur({target:{value:ze(o._formValues,a),name:a},type:em.BLUR}),[a,o._formValues]),E=Ye.useCallback(N=>{const C=ze(o._fields,a);C&&N&&(C._f.ref={focus:()=>N.focus&&N.focus(),select:()=>N.select&&N.select(),setCustomValidity:S=>N.setCustomValidity(S),reportValidity:()=>N.reportValidity()})},[o._fields,a]),k=Ye.useMemo(()=>({name:a,value:f,...Zs(r)||p.disabled?{disabled:p.disabled||r}:{},onChange:_,onBlur:w,ref:E}),[a,r,p.disabled,_,w,E,f]);return Ye.useEffect(()=>{const N=o._options.shouldUnregister||l;o.register(a,{...g.current.rules,...Zs(g.current.disabled)?{disabled:g.current.disabled}:{}});const C=(S,T)=>{const M=ze(o._fields,S);M&&M._f&&(M._f.mount=T)};if(C(a,!0),N){const S=os(ze(o._options.defaultValues,a));St(o._defaultValues,a,S),Gt(ze(o._formValues,a))&&St(o._formValues,a,S)}return!u&&o.register(a),()=>{(u?N&&!o._state.action:N)?o.unregister(a):C(a,!1)}},[a,o,u,l]),Ye.useEffect(()=>{o._setDisabledField({disabled:r,name:a})},[r,a,o]),Ye.useMemo(()=>({field:k,formState:p,fieldState:b}),[k,p,b])}const ro=t=>t.render(Dz(t));var Pz=(t,s,a,r,o)=>s?{...a[t],types:{...a[t]&&a[t].types?a[t].types:{},[r]:o||!0}}:{},xc=t=>Array.isArray(t)?t:[t],Bj=()=>{let t=[];return{get observers(){return t},next:o=>{for(const l of t)l.next&&l.next(o)},subscribe:o=>(t.push(o),{unsubscribe:()=>{t=t.filter(l=>l!==o)}}),unsubscribe:()=>{t=[]}}},Ds=t=>Yt(t)&&!Object.keys(t).length,Ag=t=>t.type==="file",_a=t=>typeof t=="function",tm=t=>{if(!Sg)return!1;const s=t?t.ownerDocument:0;return t instanceof(s&&s.defaultView?s.defaultView.HTMLElement:HTMLElement)},P2=t=>t.type==="select-multiple",Mg=t=>t.type==="radio",zz=t=>Mg(t)||Hc(t),_p=t=>tm(t)&&t.isConnected;function $z(t,s){const a=s.slice(0,-1).length;let r=0;for(;r<a;)t=Gt(t)?r++:t[s[r++]];return t}function Iz(t){for(const s in t)if(t.hasOwnProperty(s)&&!Gt(t[s]))return!1;return!0}function Jt(t,s){const a=Array.isArray(s)?s:jm(s)?[s]:Cg(s),r=a.length===1?t:$z(t,a),o=a.length-1,l=a[o];return r&&delete r[l],o!==0&&(Yt(r)&&Ds(r)||Array.isArray(r)&&Iz(r))&&Jt(t,a.slice(0,-1)),t}var z2=t=>{for(const s in t)if(_a(t[s]))return!0;return!1};function sm(t,s={}){const a=Array.isArray(t);if(Yt(t)||a)for(const r in t)Array.isArray(t[r])||Yt(t[r])&&!z2(t[r])?(s[r]=Array.isArray(t[r])?[]:{},sm(t[r],s[r])):Cs(t[r])||(s[r]=!0);return s}function $2(t,s,a){const r=Array.isArray(t);if(Yt(t)||r)for(const o in t)Array.isArray(t[o])||Yt(t[o])&&!z2(t[o])?Gt(s)||j0(a[o])?a[o]=Array.isArray(t[o])?sm(t[o],[]):{...sm(t[o])}:$2(t[o],Cs(s)?{}:s[o],a[o]):a[o]=!vr(t[o],s[o]);return a}var Ql=(t,s)=>$2(t,s,sm(s));const Vj={value:!1,isValid:!1},qj={value:!0,isValid:!0};var I2=t=>{if(Array.isArray(t)){if(t.length>1){const s=t.filter(a=>a&&a.checked&&!a.disabled).map(a=>a.value);return{value:s,isValid:!!s.length}}return t[0].checked&&!t[0].disabled?t[0].attributes&&!Gt(t[0].attributes.value)?Gt(t[0].value)||t[0].value===""?qj:{value:t[0].value,isValid:!0}:qj:Vj}return Vj},L2=(t,{valueAsNumber:s,valueAsDate:a,setValueAs:r})=>Gt(t)?t:s?t===""?NaN:t&&+t:a&&Va(t)?new Date(t):r?r(t):t;const Fj={isValid:!1,value:null};var U2=t=>Array.isArray(t)?t.reduce((s,a)=>a&&a.checked&&!a.disabled?{isValid:!0,value:a.value}:s,Fj):Fj;function Hj(t){const s=t.ref;return Ag(s)?s.files:Mg(s)?U2(t.refs).value:P2(s)?[...s.selectedOptions].map(({value:a})=>a):Hc(s)?I2(t.refs).value:L2(Gt(s.value)?t.ref.value:s.value,t)}var Lz=(t,s,a,r)=>{const o={};for(const l of t){const c=ze(s,l);c&&St(o,l,c._f)}return{criteriaMode:a,names:[...t],fields:o,shouldUseNativeValidation:r}},am=t=>t instanceof RegExp,Jl=t=>Gt(t)?t:am(t)?t.source:Yt(t)?am(t.value)?t.value.source:t.value:t,Gj=t=>({isOnSubmit:!t||t===ja.onSubmit,isOnBlur:t===ja.onBlur,isOnChange:t===ja.onChange,isOnAll:t===ja.all,isOnTouch:t===ja.onTouched});const Zj="AsyncFunction";var Uz=t=>!!t&&!!t.validate&&!!(_a(t.validate)&&t.validate.constructor.name===Zj||Yt(t.validate)&&Object.values(t.validate).find(s=>s.constructor.name===Zj)),Bz=t=>t.mount&&(t.required||t.min||t.max||t.maxLength||t.minLength||t.pattern||t.validate),Wj=(t,s,a)=>!a&&(s.watchAll||s.watch.has(t)||[...s.watch].some(r=>t.startsWith(r)&&/^\.\w+/.test(t.slice(r.length))));const yc=(t,s,a,r)=>{for(const o of a||Object.keys(t)){const l=ze(t,o);if(l){const{_f:c,...u}=l;if(c){if(c.refs&&c.refs[0]&&s(c.refs[0],o)&&!r)return!0;if(c.ref&&s(c.ref,c.name)&&!r)return!0;if(yc(u,s))break}else if(Yt(u)&&yc(u,s))break}}};function Yj(t,s,a){const r=ze(t,a);if(r||jm(a))return{error:r,name:a};const o=a.split(".");for(;o.length;){const l=o.join("."),c=ze(s,l),u=ze(t,l);if(c&&!Array.isArray(c)&&a!==l)return{name:a};if(u&&u.type)return{name:l,error:u};if(u&&u.root&&u.root.type)return{name:`${l}.root`,error:u.root};o.pop()}return{name:a}}var Vz=(t,s,a,r)=>{a(t);const{name:o,...l}=t;return Ds(l)||Object.keys(l).length>=Object.keys(s).length||Object.keys(l).find(c=>s[c]===(!r||ja.all))},qz=(t,s,a)=>!t||!s||t===s||xc(t).some(r=>r&&(a?r===s:r.startsWith(s)||s.startsWith(r))),Fz=(t,s,a,r,o)=>o.isOnAll?!1:!a&&o.isOnTouch?!(s||t):(a?r.isOnBlur:o.isOnBlur)?!t:(a?r.isOnChange:o.isOnChange)?t:!0,Hz=(t,s)=>!Eg(ze(t,s)).length&&Jt(t,s),Gz=(t,s,a)=>{const r=xc(ze(t,a));return St(r,"root",s[a]),St(t,a,r),t},Ru=t=>Va(t);function Kj(t,s,a="validate"){if(Ru(t)||Array.isArray(t)&&t.every(Ru)||Zs(t)&&!t)return{type:a,message:Ru(t)?t:"",ref:s}}var mi=t=>Yt(t)&&!am(t)?t:{value:t,message:""},Xj=async(t,s,a,r,o,l)=>{const{ref:c,refs:u,required:h,maxLength:f,minLength:p,min:g,max:v,pattern:b,validate:_,name:w,valueAsNumber:E,mount:k}=t._f,N=ze(a,w);if(!k||s.has(w))return{};const C=u?u[0]:c,S=I=>{o&&C.reportValidity&&(C.setCustomValidity(Zs(I)?"":I||""),C.reportValidity())},T={},M=Mg(c),$=Hc(c),A=M||$,z=(E||Ag(c))&&Gt(c.value)&&Gt(N)||tm(c)&&c.value===""||N===""||Array.isArray(N)&&!N.length,R=Pz.bind(null,w,r,T),L=(I,X,ce,J=gr.maxLength,V=gr.minLength)=>{const Y=I?X:ce;T[w]={type:I?J:V,message:Y,ref:c,...R(I?J:V,Y)}};if(l?!Array.isArray(N)||!N.length:h&&(!A&&(z||Cs(N))||Zs(N)&&!N||$&&!I2(u).isValid||M&&!U2(u).isValid)){const{value:I,message:X}=Ru(h)?{value:!!h,message:h}:mi(h);if(I&&(T[w]={type:gr.required,message:X,ref:C,...R(gr.required,X)},!r))return S(X),T}if(!z&&(!Cs(g)||!Cs(v))){let I,X;const ce=mi(v),J=mi(g);if(!Cs(N)&&!isNaN(N)){const V=c.valueAsNumber||N&&+N;Cs(ce.value)||(I=V>ce.value),Cs(J.value)||(X=V<J.value)}else{const V=c.valueAsDate||new Date(N),Y=D=>new Date(new Date().toDateString()+" "+D),ee=c.type=="time",we=c.type=="week";Va(ce.value)&&N&&(I=ee?Y(N)>Y(ce.value):we?N>ce.value:V>new Date(ce.value)),Va(J.value)&&N&&(X=ee?Y(N)<Y(J.value):we?N<J.value:V<new Date(J.value))}if((I||X)&&(L(!!I,ce.message,J.message,gr.max,gr.min),!r))return S(T[w].message),T}if((f||p)&&!z&&(Va(N)||l&&Array.isArray(N))){const I=mi(f),X=mi(p),ce=!Cs(I.value)&&N.length>+I.value,J=!Cs(X.value)&&N.length<+X.value;if((ce||J)&&(L(ce,I.message,X.message),!r))return S(T[w].message),T}if(b&&!z&&Va(N)){const{value:I,message:X}=mi(b);if(am(I)&&!N.match(I)&&(T[w]={type:gr.pattern,message:X,ref:c,...R(gr.pattern,X)},!r))return S(X),T}if(_){if(_a(_)){const I=await _(N,a),X=Kj(I,C);if(X&&(T[w]={...X,...R(gr.validate,X.message)},!r))return S(X.message),T}else if(Yt(_)){let I={};for(const X in _){if(!Ds(I)&&!r)break;const ce=Kj(await _[X](N,a),C,X);ce&&(I={...ce,...R(X,ce.message)},S(ce.message),r&&(T[w]=I))}if(!Ds(I)&&(T[w]={ref:C,...I},!r))return T}}return S(!0),T};const Zz={mode:ja.onSubmit,reValidateMode:ja.onChange,shouldFocusError:!0};function Wz(t={}){let s={...Zz,...t},a={submitCount:0,isDirty:!1,isReady:!1,isLoading:_a(s.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1},r={},o=Yt(s.defaultValues)||Yt(s.values)?os(s.defaultValues||s.values)||{}:{},l=s.shouldUnregister?{}:os(o),c={action:!1,mount:!1,watch:!1},u={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},h,f=0;const p={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1};let g={...p};const v={array:Bj(),state:Bj()},b=s.criteriaMode===ja.all,_=W=>se=>{clearTimeout(f),f=setTimeout(W,se)},w=async W=>{if(!s.disabled&&(p.isValid||g.isValid||W)){const se=s.resolver?Ds((await $()).errors):await z(r,!0);se!==a.isValid&&v.state.next({isValid:se})}},E=(W,se)=>{!s.disabled&&(p.isValidating||p.validatingFields||g.isValidating||g.validatingFields)&&((W||Array.from(u.mount)).forEach(ue=>{ue&&(se?St(a.validatingFields,ue,se):Jt(a.validatingFields,ue))}),v.state.next({validatingFields:a.validatingFields,isValidating:!Ds(a.validatingFields)}))},k=(W,se=[],ue,Ce,ke=!0,ye=!0)=>{if(Ce&&ue&&!s.disabled){if(c.action=!0,ye&&Array.isArray(ze(r,W))){const Me=ue(ze(r,W),Ce.argA,Ce.argB);ke&&St(r,W,Me)}if(ye&&Array.isArray(ze(a.errors,W))){const Me=ue(ze(a.errors,W),Ce.argA,Ce.argB);ke&&St(a.errors,W,Me),Hz(a.errors,W)}if((p.touchedFields||g.touchedFields)&&ye&&Array.isArray(ze(a.touchedFields,W))){const Me=ue(ze(a.touchedFields,W),Ce.argA,Ce.argB);ke&&St(a.touchedFields,W,Me)}(p.dirtyFields||g.dirtyFields)&&(a.dirtyFields=Ql(o,l)),v.state.next({name:W,isDirty:L(W,se),dirtyFields:a.dirtyFields,errors:a.errors,isValid:a.isValid})}else St(l,W,se)},N=(W,se)=>{St(a.errors,W,se),v.state.next({errors:a.errors})},C=W=>{a.errors=W,v.state.next({errors:a.errors,isValid:!1})},S=(W,se,ue,Ce)=>{const ke=ze(r,W);if(ke){const ye=ze(l,W,Gt(ue)?ze(o,W):ue);Gt(ye)||Ce&&Ce.defaultChecked||se?St(l,W,se?ye:Hj(ke._f)):ce(W,ye),c.mount&&w()}},T=(W,se,ue,Ce,ke)=>{let ye=!1,Me=!1;const Pe={name:W};if(!s.disabled){if(!ue||Ce){(p.isDirty||g.isDirty)&&(Me=a.isDirty,a.isDirty=Pe.isDirty=L(),ye=Me!==Pe.isDirty);const Ge=vr(ze(o,W),se);Me=!!ze(a.dirtyFields,W),Ge?Jt(a.dirtyFields,W):St(a.dirtyFields,W,!0),Pe.dirtyFields=a.dirtyFields,ye=ye||(p.dirtyFields||g.dirtyFields)&&Me!==!Ge}if(ue){const Ge=ze(a.touchedFields,W);Ge||(St(a.touchedFields,W,ue),Pe.touchedFields=a.touchedFields,ye=ye||(p.touchedFields||g.touchedFields)&&Ge!==ue)}ye&&ke&&v.state.next(Pe)}return ye?Pe:{}},M=(W,se,ue,Ce)=>{const ke=ze(a.errors,W),ye=(p.isValid||g.isValid)&&Zs(se)&&a.isValid!==se;if(s.delayError&&ue?(h=_(()=>N(W,ue)),h(s.delayError)):(clearTimeout(f),h=null,ue?St(a.errors,W,ue):Jt(a.errors,W)),(ue?!vr(ke,ue):ke)||!Ds(Ce)||ye){const Me={...Ce,...ye&&Zs(se)?{isValid:se}:{},errors:a.errors,name:W};a={...a,...Me},v.state.next(Me)}},$=async W=>{E(W,!0);const se=await s.resolver(l,s.context,Lz(W||u.mount,r,s.criteriaMode,s.shouldUseNativeValidation));return E(W),se},A=async W=>{const{errors:se}=await $(W);if(W)for(const ue of W){const Ce=ze(se,ue);Ce?St(a.errors,ue,Ce):Jt(a.errors,ue)}else a.errors=se;return se},z=async(W,se,ue={valid:!0})=>{for(const Ce in W){const ke=W[Ce];if(ke){const{_f:ye,...Me}=ke;if(ye){const Pe=u.array.has(ye.name),Ge=ke._f&&Uz(ke._f);Ge&&p.validatingFields&&E([Ce],!0);const Qe=await Xj(ke,u.disabled,l,b,s.shouldUseNativeValidation&&!se,Pe);if(Ge&&p.validatingFields&&E([Ce]),Qe[ye.name]&&(ue.valid=!1,se))break;!se&&(ze(Qe,ye.name)?Pe?Gz(a.errors,Qe,ye.name):St(a.errors,ye.name,Qe[ye.name]):Jt(a.errors,ye.name))}!Ds(Me)&&await z(Me,se,ue)}}return ue.valid},R=()=>{for(const W of u.unMount){const se=ze(r,W);se&&(se._f.refs?se._f.refs.every(ue=>!_p(ue)):!_p(se._f.ref))&&pe(W)}u.unMount=new Set},L=(W,se)=>!s.disabled&&(W&&se&&St(l,W,se),!vr(D(),o)),I=(W,se,ue)=>D2(W,u,{...c.mount?l:Gt(se)?o:Va(W)?{[W]:se}:se},ue,se),X=W=>Eg(ze(c.mount?l:o,W,s.shouldUnregister?ze(o,W,[]):[])),ce=(W,se,ue={})=>{const Ce=ze(r,W);let ke=se;if(Ce){const ye=Ce._f;ye&&(!ye.disabled&&St(l,W,L2(se,ye)),ke=tm(ye.ref)&&Cs(se)?"":se,P2(ye.ref)?[...ye.ref.options].forEach(Me=>Me.selected=ke.includes(Me.value)):ye.refs?Hc(ye.ref)?ye.refs.forEach(Me=>{(!Me.defaultChecked||!Me.disabled)&&(Array.isArray(ke)?Me.checked=!!ke.find(Pe=>Pe===Me.value):Me.checked=ke===Me.value||!!ke)}):ye.refs.forEach(Me=>Me.checked=Me.value===ke):Ag(ye.ref)?ye.ref.value="":(ye.ref.value=ke,ye.ref.type||v.state.next({name:W,values:os(l)})))}(ue.shouldDirty||ue.shouldTouch)&&T(W,ke,ue.shouldTouch,ue.shouldDirty,!0),ue.shouldValidate&&we(W)},J=(W,se,ue)=>{for(const Ce in se){if(!se.hasOwnProperty(Ce))return;const ke=se[Ce],ye=W+"."+Ce,Me=ze(r,ye);(u.array.has(W)||Yt(ke)||Me&&!Me._f)&&!to(ke)?J(ye,ke,ue):ce(ye,ke,ue)}},V=(W,se,ue={})=>{const Ce=ze(r,W),ke=u.array.has(W),ye=os(se);St(l,W,ye),ke?(v.array.next({name:W,values:os(l)}),(p.isDirty||p.dirtyFields||g.isDirty||g.dirtyFields)&&ue.shouldDirty&&v.state.next({name:W,dirtyFields:Ql(o,l),isDirty:L(W,ye)})):Ce&&!Ce._f&&!Cs(ye)?J(W,ye,ue):ce(W,ye,ue),Wj(W,u)&&v.state.next({...a,name:W}),v.state.next({name:c.mount?W:void 0,values:os(l)})},Y=async W=>{c.mount=!0;const se=W.target;let ue=se.name,Ce=!0;const ke=ze(r,ue),ye=Ge=>{Ce=Number.isNaN(Ge)||to(Ge)&&isNaN(Ge.getTime())||vr(Ge,ze(l,ue,Ge))},Me=Gj(s.mode),Pe=Gj(s.reValidateMode);if(ke){let Ge,Qe;const xe=se.type?Hj(ke._f):A2(W),Te=W.type===em.BLUR||W.type===em.FOCUS_OUT,he=!Bz(ke._f)&&!s.resolver&&!ze(a.errors,ue)&&!ke._f.deps||Fz(Te,ze(a.touchedFields,ue),a.isSubmitted,Pe,Me),le=Wj(ue,u,Te);St(l,ue,xe),Te?(!se||!se.readOnly)&&(ke._f.onBlur&&ke._f.onBlur(W),h&&h(0)):ke._f.onChange&&ke._f.onChange(W);const Oe=T(ue,xe,Te),tt=!Ds(Oe)||le;if(!Te&&v.state.next({name:ue,type:W.type,values:os(l)}),he)return(p.isValid||g.isValid)&&(s.mode==="onBlur"?Te&&w():Te||w()),tt&&v.state.next({name:ue,...le?{}:Oe});if(!Te&&le&&v.state.next({...a}),s.resolver){const{errors:bs}=await $([ue]);if(ye(xe),Ce){const Ls=Yj(a.errors,r,ue),ka=Yj(bs,r,Ls.name||ue);Ge=ka.error,ue=ka.name,Qe=Ds(bs)}}else E([ue],!0),Ge=(await Xj(ke,u.disabled,l,b,s.shouldUseNativeValidation))[ue],E([ue]),ye(xe),Ce&&(Ge?Qe=!1:(p.isValid||g.isValid)&&(Qe=await z(r,!0)));Ce&&(ke._f.deps&&we(ke._f.deps),M(ue,Qe,Ge,Oe))}},ee=(W,se)=>{if(ze(a.errors,se)&&W.focus)return W.focus(),1},we=async(W,se={})=>{let ue,Ce;const ke=xc(W);if(s.resolver){const ye=await A(Gt(W)?W:ke);ue=Ds(ye),Ce=W?!ke.some(Me=>ze(ye,Me)):ue}else W?(Ce=(await Promise.all(ke.map(async ye=>{const Me=ze(r,ye);return await z(Me&&Me._f?{[ye]:Me}:Me)}))).every(Boolean),!(!Ce&&!a.isValid)&&w()):Ce=ue=await z(r);return v.state.next({...!Va(W)||(p.isValid||g.isValid)&&ue!==a.isValid?{}:{name:W},...s.resolver||!W?{isValid:ue}:{},errors:a.errors}),se.shouldFocus&&!Ce&&yc(r,ee,W?ke:u.mount),Ce},D=W=>{const se={...c.mount?l:o};return Gt(W)?se:Va(W)?ze(se,W):W.map(ue=>ze(se,ue))},H=(W,se)=>({invalid:!!ze((se||a).errors,W),isDirty:!!ze((se||a).dirtyFields,W),error:ze((se||a).errors,W),isValidating:!!ze(a.validatingFields,W),isTouched:!!ze((se||a).touchedFields,W)}),F=W=>{W&&xc(W).forEach(se=>Jt(a.errors,se)),v.state.next({errors:W?a.errors:{}})},Z=(W,se,ue)=>{const Ce=(ze(r,W,{_f:{}})._f||{}).ref,ke=ze(a.errors,W)||{},{ref:ye,message:Me,type:Pe,...Ge}=ke;St(a.errors,W,{...Ge,...se,ref:Ce}),v.state.next({name:W,errors:a.errors,isValid:!1}),ue&&ue.shouldFocus&&Ce&&Ce.focus&&Ce.focus()},re=(W,se)=>_a(W)?v.state.subscribe({next:ue=>"values"in ue&&W(I(void 0,se),ue)}):I(W,se,!0),oe=W=>v.state.subscribe({next:se=>{qz(W.name,se.name,W.exact)&&Vz(se,W.formState||p,Ve,W.reRenderRoot)&&W.callback({values:{...l},...a,...se,defaultValues:o})}}).unsubscribe,ae=W=>(c.mount=!0,g={...g,...W.formState},oe({...W,formState:g})),pe=(W,se={})=>{for(const ue of W?xc(W):u.mount)u.mount.delete(ue),u.array.delete(ue),se.keepValue||(Jt(r,ue),Jt(l,ue)),!se.keepError&&Jt(a.errors,ue),!se.keepDirty&&Jt(a.dirtyFields,ue),!se.keepTouched&&Jt(a.touchedFields,ue),!se.keepIsValidating&&Jt(a.validatingFields,ue),!s.shouldUnregister&&!se.keepDefaultValue&&Jt(o,ue);v.state.next({values:os(l)}),v.state.next({...a,...se.keepDirty?{isDirty:L()}:{}}),!se.keepIsValid&&w()},P=({disabled:W,name:se})=>{(Zs(W)&&c.mount||W||u.disabled.has(se))&&(W?u.disabled.add(se):u.disabled.delete(se))},q=(W,se={})=>{let ue=ze(r,W);const Ce=Zs(se.disabled)||Zs(s.disabled);return St(r,W,{...ue||{},_f:{...ue&&ue._f?ue._f:{ref:{name:W}},name:W,mount:!0,...se}}),u.mount.add(W),ue?P({disabled:Zs(se.disabled)?se.disabled:s.disabled,name:W}):S(W,!0,se.value),{...Ce?{disabled:se.disabled||s.disabled}:{},...s.progressive?{required:!!se.required,min:Jl(se.min),max:Jl(se.max),minLength:Jl(se.minLength),maxLength:Jl(se.maxLength),pattern:Jl(se.pattern)}:{},name:W,onChange:Y,onBlur:Y,ref:ke=>{if(ke){q(W,se),ue=ze(r,W);const ye=Gt(ke.value)&&ke.querySelectorAll&&ke.querySelectorAll("input,select,textarea")[0]||ke,Me=zz(ye),Pe=ue._f.refs||[];if(Me?Pe.find(Ge=>Ge===ye):ye===ue._f.ref)return;St(r,W,{_f:{...ue._f,...Me?{refs:[...Pe.filter(_p),ye,...Array.isArray(ze(o,W))?[{}]:[]],ref:{type:ye.type,name:W}}:{ref:ye}}}),S(W,!1,void 0,ye)}else ue=ze(r,W,{}),ue._f&&(ue._f.mount=!1),(s.shouldUnregister||se.shouldUnregister)&&!(M2(u.array,W)&&c.action)&&u.unMount.add(W)}}},Q=()=>s.shouldFocusError&&yc(r,ee,u.mount),G=W=>{Zs(W)&&(v.state.next({disabled:W}),yc(r,(se,ue)=>{const Ce=ze(r,ue);Ce&&(se.disabled=Ce._f.disabled||W,Array.isArray(Ce._f.refs)&&Ce._f.refs.forEach(ke=>{ke.disabled=Ce._f.disabled||W}))},0,!1))},me=(W,se)=>async ue=>{let Ce;ue&&(ue.preventDefault&&ue.preventDefault(),ue.persist&&ue.persist());let ke=os(l);if(v.state.next({isSubmitting:!0}),s.resolver){const{errors:ye,values:Me}=await $();a.errors=ye,ke=os(Me)}else await z(r);if(u.disabled.size)for(const ye of u.disabled)Jt(ke,ye);if(Jt(a.errors,"root"),Ds(a.errors)){v.state.next({errors:{}});try{await W(ke,ue)}catch(ye){Ce=ye}}else se&&await se({...a.errors},ue),Q(),setTimeout(Q);if(v.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Ds(a.errors)&&!Ce,submitCount:a.submitCount+1,errors:a.errors}),Ce)throw Ce},Ne=(W,se={})=>{ze(r,W)&&(Gt(se.defaultValue)?V(W,os(ze(o,W))):(V(W,se.defaultValue),St(o,W,os(se.defaultValue))),se.keepTouched||Jt(a.touchedFields,W),se.keepDirty||(Jt(a.dirtyFields,W),a.isDirty=se.defaultValue?L(W,os(ze(o,W))):L()),se.keepError||(Jt(a.errors,W),p.isValid&&w()),v.state.next({...a}))},je=(W,se={})=>{const ue=W?os(W):o,Ce=os(ue),ke=Ds(W),ye=ke?o:Ce;if(se.keepDefaultValues||(o=ue),!se.keepValues){if(se.keepDirtyValues){const Me=new Set([...u.mount,...Object.keys(Ql(o,l))]);for(const Pe of Array.from(Me))ze(a.dirtyFields,Pe)?St(ye,Pe,ze(l,Pe)):V(Pe,ze(ye,Pe))}else{if(Sg&&Gt(W))for(const Me of u.mount){const Pe=ze(r,Me);if(Pe&&Pe._f){const Ge=Array.isArray(Pe._f.refs)?Pe._f.refs[0]:Pe._f.ref;if(tm(Ge)){const Qe=Ge.closest("form");if(Qe){Qe.reset();break}}}}if(se.keepFieldsRef)for(const Me of u.mount)V(Me,ze(ye,Me));else r={}}l=s.shouldUnregister?se.keepDefaultValues?os(o):{}:os(ye),v.array.next({values:{...ye}}),v.state.next({values:{...ye}})}u={mount:se.keepDirtyValues?u.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},c.mount=!p.isValid||!!se.keepIsValid||!!se.keepDirtyValues,c.watch=!!s.shouldUnregister,v.state.next({submitCount:se.keepSubmitCount?a.submitCount:0,isDirty:ke?!1:se.keepDirty?a.isDirty:!!(se.keepDefaultValues&&!vr(W,o)),isSubmitted:se.keepIsSubmitted?a.isSubmitted:!1,dirtyFields:ke?{}:se.keepDirtyValues?se.keepDefaultValues&&l?Ql(o,l):a.dirtyFields:se.keepDefaultValues&&W?Ql(o,W):se.keepDirty?a.dirtyFields:{},touchedFields:se.keepTouched?a.touchedFields:{},errors:se.keepErrors?a.errors:{},isSubmitSuccessful:se.keepIsSubmitSuccessful?a.isSubmitSuccessful:!1,isSubmitting:!1,defaultValues:o})},Re=(W,se)=>je(_a(W)?W(l):W,se),Ie=(W,se={})=>{const ue=ze(r,W),Ce=ue&&ue._f;if(Ce){const ke=Ce.refs?Ce.refs[0]:Ce.ref;ke.focus&&(ke.focus(),se.shouldSelect&&_a(ke.select)&&ke.select())}},Ve=W=>{a={...a,...W}},Ue={control:{register:q,unregister:pe,getFieldState:H,handleSubmit:me,setError:Z,_subscribe:oe,_runSchema:$,_focusError:Q,_getWatch:I,_getDirty:L,_setValid:w,_setFieldArray:k,_setDisabledField:P,_setErrors:C,_getFieldArray:X,_reset:je,_resetDefaultValues:()=>_a(s.defaultValues)&&s.defaultValues().then(W=>{Re(W,s.resetOptions),v.state.next({isLoading:!1})}),_removeUnmounted:R,_disableForm:G,_subjects:v,_proxyFormState:p,get _fields(){return r},get _formValues(){return l},get _state(){return c},set _state(W){c=W},get _defaultValues(){return o},get _names(){return u},set _names(W){u=W},get _formState(){return a},get _options(){return s},set _options(W){s={...s,...W}}},subscribe:ae,trigger:we,register:q,handleSubmit:me,watch:re,setValue:V,getValues:D,reset:Re,resetField:Ne,clearErrors:F,unregister:pe,setError:Z,setFocus:Ie,getFieldState:H};return{...Ue,formControl:Ue}}function Rg(t={}){const s=Ye.useRef(void 0),a=Ye.useRef(void 0),[r,o]=Ye.useState({isDirty:!1,isValidating:!1,isLoading:_a(t.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:t.errors||{},disabled:t.disabled||!1,isReady:!1,defaultValues:_a(t.defaultValues)?void 0:t.defaultValues});if(!s.current)if(t.formControl)s.current={...t.formControl,formState:r},t.defaultValues&&!_a(t.defaultValues)&&t.formControl.reset(t.defaultValues,t.resetOptions);else{const{formControl:c,...u}=Wz(t);s.current={...u,formState:r}}const l=s.current.control;return l._options=t,kg(()=>{const c=l._subscribe({formState:l._proxyFormState,callback:()=>o({...l._formState}),reRenderRoot:!0});return o(u=>({...u,isReady:!0})),l._formState.isReady=!0,c},[l]),Ye.useEffect(()=>l._disableForm(t.disabled),[l,t.disabled]),Ye.useEffect(()=>{t.mode&&(l._options.mode=t.mode),t.reValidateMode&&(l._options.reValidateMode=t.reValidateMode)},[l,t.mode,t.reValidateMode]),Ye.useEffect(()=>{t.errors&&(l._setErrors(t.errors),l._focusError())},[l,t.errors]),Ye.useEffect(()=>{t.shouldUnregister&&l._subjects.state.next({values:l._getWatch()})},[l,t.shouldUnregister]),Ye.useEffect(()=>{if(l._proxyFormState.isDirty){const c=l._getDirty();c!==r.isDirty&&l._subjects.state.next({isDirty:c})}},[l,r.isDirty]),Ye.useEffect(()=>{t.values&&!vr(t.values,a.current)?(l._reset(t.values,{keepFieldsRef:!0,...l._options.resetOptions}),a.current=t.values,o(c=>({...c}))):l._resetDefaultValues()},[l,t.values]),Ye.useEffect(()=>{l._state.mount||(l._setValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),s.current.formState=O2(r,l),s.current}const Yz=({isOpen:t,onClose:s,item:a})=>{const{addMenuItem:r,updateMenuItem:o}=Tt(),{register:l,handleSubmit:c,control:u,reset:h,formState:{errors:f}}=Rg(),[p,g]=y.useState(!1);y.useEffect(()=>{h(a?{name:a.name,description:a.description||"",price:a.price,category:a.category,preparationTime:a.preparation_time||0,available:a.available,image_url:a.image_url||""}:{name:"",description:"",price:"",category:"food",preparationTime:"",available:!0,image_url:""})},[a,h]);const v=async _=>{console.log("=== INÍCIO DO SUBMIT ==="),console.log("Dados recebidos do formulário:",_),g(!0);try{const w={..._,description:_.description||"",preparationTime:_.preparationTime||void 0};console.log("Dados processados para envio:",w),a?(console.log("Modo: Edição de item existente"),await o({...a,...w})):(console.log("Modo: Criação de novo item"),await r(w)),console.log("Item salvo com sucesso!"),a||h({name:"",description:"",price:"",category:"food",preparationTime:"",available:!0,image_url:""}),s()}catch(w){console.error("=== ERRO DETALHADO ==="),console.error("Tipo do erro:",typeof w),console.error("Erro completo:",w),console.error("Stack trace:",w instanceof Error?w.stack:"N/A"),w&&typeof w=="object"&&"message"in w&&console.error("Mensagem do erro:",w.message),alert(`Erro ao salvar o prato: ${w instanceof Error?w.message:"Erro desconhecido"}`)}finally{g(!1),console.log("=== FIM DO SUBMIT ===")}},b=[{value:"food",label:"Pratos Principais"},{value:"snacks",label:"Petiscos"},{value:"drinks",label:"Bebidas"}];return e.jsx(Ws,{children:t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:e.jsxs(be.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100 bg-gray-50 rounded-t-xl",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:a?"Editar Prato":"Novo Prato"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a?"Atualize as informações do prato":"Adicione um novo prato ao cardápio"})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 hover:bg-gray-200 p-2 rounded-lg transition-colors duration-200",disabled:p,title:"Fechar modal","aria-label":"Fechar modal",children:e.jsx(nt,{size:24})})]}),e.jsxs("form",{onSubmit:c(v),className:"p-6 space-y-6",children:[e.jsx(hi,{label:"Nome do Prato",error:f.name,children:e.jsx("input",{...l("name",{required:"Nome é obrigatório"}),className:"form-input",placeholder:"Digite o nome do prato",disabled:p})}),e.jsx(hi,{label:"Descrição",error:f.description,children:e.jsx("textarea",{...l("description"),className:"form-input min-h-[80px] resize-none",placeholder:"Descreva o prato...",disabled:p})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(hi,{label:"Categoria",error:f.category,children:e.jsx(ro,{name:"category",control:u,rules:{required:"Categoria é obrigatória"},render:({field:_})=>e.jsx("select",{..._,className:"form-select",disabled:p,children:b.map(w=>e.jsx("option",{value:w.value,children:w.label},w.value))})})}),e.jsx(hi,{label:"Preço (R$)",error:f.price,children:e.jsx("input",{type:"number",step:"0.01",...l("price",{required:"Preço é obrigatório",valueAsNumber:!0,min:{value:.01,message:"Valor deve ser maior que 0"}}),className:"form-input",placeholder:"Digite o preço",disabled:p})})]}),e.jsxs(hi,{label:"URL da Imagem (opcional)",error:f.image_url,children:[e.jsx("input",{...l("image_url"),className:"form-input",placeholder:"https://exemplo.com/imagem.jpg",disabled:p}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Cole aqui o link da imagem do prato. Recomendamos imagens com proporção 1:1 (quadrada)."})]}),e.jsx(hi,{label:"Tempo de Preparo (min)",error:f.preparationTime,children:e.jsx("input",{type:"number",...l("preparationTime",{setValueAs:_=>_===""||_===null?void 0:Number(_),min:{value:0,message:"Valor deve ser maior ou igual a 0"}}),className:"form-input",placeholder:"Digite o tempo em minutos",disabled:p})}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(ro,{name:"available",control:u,render:({field:_})=>e.jsx("input",{type:"checkbox",onChange:_.onChange,onBlur:_.onBlur,name:_.name,ref:_.ref,checked:_.value,className:"w-4 h-4 text-green-600 bg-gray-100 border-gray-300 rounded focus:ring-green-500 focus:ring-2",disabled:p,title:"Marcar como disponível","aria-label":"Marcar prato como disponível para pedidos"})}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Prato disponível para pedidos"})]}),e.jsxs("div",{className:"pt-6 flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:s,className:"btn-secondary",disabled:p,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn-primary flex items-center justify-center space-x-2",disabled:p,children:p?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Salvando..."})]}):e.jsx("span",{children:a?"Salvar Alterações":"Adicionar Prato"})})]})]})]})})})},hi=({label:t,children:s,error:a})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:t}),s,a&&e.jsxs("p",{className:"text-red-500 text-sm flex items-center space-x-1",children:[e.jsx("span",{className:"w-4 h-4 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"})}),e.jsx("span",{children:a.message})]})]}),Kz=({menuItems:t})=>{const{removeMenuItem:s}=Tt(),[a,r]=y.useState(""),[o,l]=y.useState(!1),[c,u]=y.useState(null),h=t.filter(b=>{const _=b.name.toLowerCase().includes(a.toLowerCase()),w=b.item_type!=="direct";return _&&w}),f=()=>{u(null),l(!0)},p=b=>{u(b),l(!0)},g=()=>{l(!1),u(null)},v=async b=>{window.confirm(`Tem certeza que deseja remover "${b.name}" do cardápio?`)&&await s(b.id)};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-2",children:"Gestão de Cardápio"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Gerencie apenas pratos que precisam de preparo na cozinha.",e.jsx("br",{}),e.jsx("span",{className:"text-blue-600 font-medium",children:'Produtos prontos do estoque aparecem automaticamente no balcão quando marcados como "Disponível para venda" no módulo Estoque.'})]})]}),e.jsx("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3",children:e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:f,className:"bg-green-600 text-white px-4 py-2 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center space-x-2",children:[e.jsx($s,{size:20}),e.jsx("span",{children:"Novo Prato"})]})})]}),e.jsx("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-4 sm:space-y-0 sm:space-x-4 mb-6",children:e.jsx("input",{type:"text",placeholder:"Buscar pratos...",value:a,onChange:b=>r(b.target.value),className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:h.map(b=>e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white border border-gray-200 rounded-lg overflow-hidden hover:shadow-md transition-shadow",children:[b.image_url&&e.jsx("div",{className:"aspect-video w-full bg-gray-100 overflow-hidden",children:e.jsx("img",{src:b.image_url,alt:b.name,className:"w-full h-full object-cover hover:scale-105 transition-transform duration-300",onError:_=>{_.currentTarget.style.display="none"}})}),e.jsxs("div",{className:"p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:b.name}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>p(b),className:"text-gray-400 hover:text-blue-600 transition-colors",title:"Editar prato","aria-label":"Editar prato",children:e.jsx(lo,{size:16})}),e.jsx("button",{onClick:()=>v(b),className:"text-gray-400 hover:text-red-600 transition-colors",title:"Excluir prato","aria-label":"Excluir prato",children:e.jsx(Yi,{size:16})})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:b.description}),e.jsxs("div",{className:"flex items-center justify-between text-sm mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-1 text-gray-600",children:[e.jsx(Bt,{size:14}),e.jsxs("span",{children:[b.preparation_time||0,"min"]})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-green-600",children:[e.jsx(Ut,{size:14}),e.jsxs("span",{className:"font-semibold",children:["R$ ",b.price.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${b.available?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:b.available?"Disponível":"Indisponível"}),e.jsx("span",{className:"text-xs text-gray-500 capitalize",children:b.category==="Prato Principal"?"Prato Principal":b.category==="Petiscos"?"Petiscos":"Bebidas"})]})]})]},b.id))}),h.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhum prato encontrado"})}),e.jsx(Yz,{isOpen:o,onClose:g,item:c})]})},_m=t=>{if(!t)return"000";if(t.includes("-")){const s=t.split("-"),a=s[s.length-1];if(/^\d+$/.test(a))return a.padStart(3,"0");for(const r of s.reverse())if(/^\d+$/.test(r)&&r.length>=3)return r}return t.length>10?t.slice(-6).toUpperCase():t.toUpperCase()},Og=t=>t?`Mesa ${t}`:"Balcão",B2=t=>{let s=t.match(/Pedido Balcão #(\d+)/);if(s)return`#${s[1]}`;if(s=t.match(/Pedido de balcão #([a-f0-9-]+)/),s){const r=s[1].replace(/-/g,"").slice(-4);return`#${(parseInt(r,16)%1e4).toString().padStart(4,"0")}`}return null},Xz=({orders:t,menuItems:s})=>{const{updateOrderStatus:a}=Tt(),[r,o]=y.useState(new Set),[l,c]=y.useState("all"),h=(()=>{const N=new Map;return t.forEach(C=>{const S=C.tableNumber||"Balcão";N.has(S)||N.set(S,[]),N.get(S).push(C)}),N})(),f=N=>N.items.reduce((C,S)=>{const T=s.find($=>$.id===S.menuItemId)||S.menuItem,M=(T==null?void 0:T.preparation_time)||(T==null?void 0:T.preparationTime)||0;return C+M},0),p=N=>{const C=(new Date().getTime()-N.createdAt.getTime())/6e4;return C>20?"high":C>10?"medium":"low"},g=N=>{switch(N){case"high":return"border-red-400 bg-red-50";case"medium":return"border-yellow-400 bg-yellow-50";case"low":return"border-green-400 bg-green-50";default:return"border-gray-200 bg-white"}},v=N=>N.id.slice(-4).toUpperCase(),b=N=>N.id.startsWith("balcao-"),_=N=>N.id.startsWith("comanda-"),w=async(N,C)=>{console.log("🍳 Cozinha - Atualizando status:",{orderId:N,newStatus:C,isComandaOrder:_({id:N})}),o(S=>new Set([...S,N]));try{await a(N,C),console.log(`✅ Status do pedido ${N} atualizado para ${C}`)}catch(S){console.error("❌ Erro ao atualizar status:",S)}finally{setTimeout(()=>{o(S=>{const T=new Set(S);return T.delete(N),T})},1e3)}},E=N=>(h.get(N)||[]).length>1,k=t.filter(N=>l==="all"?!0:(N.tableNumber||"Balcão")===l);return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Pedidos da Cozinha"}),e.jsxs("div",{className:"flex items-center space-x-2 mt-2",children:[Array.from(h.entries()).filter(([N,C])=>C.length>1).length>0&&e.jsxs("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium",children:[Array.from(h.entries()).filter(([N,C])=>C.length>1).length," mesa(s) com múltiplos pedidos"]}),l!=="all"&&e.jsxs("button",{onClick:()=>c("all"),className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium hover:bg-blue-200 transition-colors flex items-center space-x-1",children:[e.jsxs("span",{children:["Filtro: ",l]}),e.jsx("span",{className:"text-blue-600",children:"✕"})]})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[k.length," de ",t.length," pedidos"]})]}),Array.from(h.entries()).filter(([N,C])=>C.length>1).length>0&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-orange-800 mb-2",children:"⚠️ Mesas com Múltiplos Pedidos:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from(h.entries()).filter(([N,C])=>C.length>1).map(([N,C])=>e.jsxs("button",{onClick:()=>c(N),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors hover:shadow-md transform hover:scale-105 ${l===N?"bg-orange-400 text-white":"bg-orange-200 text-orange-800 hover:bg-orange-300"}`,title:`Filtrar pedidos da ${N}`,children:["Mesa ",N,": ",C.length," pedidos"]},N))})]}),k.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:l!=="all"?`Nenhum pedido encontrado para ${l}`:"Nenhum pedido pendente na cozinha"})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:k.map(N=>{const C=p(N),S=f(N),T=N.items.filter($=>{const A=s.find(z=>z.id===$.menuItemId)||$.menuItem;return A&&A.item_type!=="direct"}),M=E(N.tableNumber||"Balcão");return e.jsxs(be.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:`border-2 rounded-lg p-4 ${g(C)} ${M?"ring-2 ring-orange-300 ring-offset-2":""} ${b(N)?"border-green-400 bg-green-50 shadow-lg":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fc,{size:16,className:"text-gray-500"}),e.jsx("span",{className:"font-bold text-lg",children:Og(N.tableNumber)}),e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:["#",v(N)]}),b(N)&&e.jsx("span",{className:"bg-green-600 text-white px-2 py-1 rounded-full text-xs font-bold animate-pulse",children:"✓ PAGO"}),_(N)&&e.jsx("span",{className:"bg-yellow-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:"AGUARDA PAGTO"})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(Bt,{size:14}),e.jsx("span",{children:wt(N.createdAt,"HH:mm",{locale:Wt})})]})]}),e.jsx("div",{className:"space-y-2 mb-4",children:T.map($=>{const A=s.find(z=>z.id===$.menuItemId)||$.menuItem;return e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-medium",children:[$.quantity,"x ",(A==null?void 0:A.name)||"Item não encontrado"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[(A==null?void 0:A.preparation_time)||(A==null?void 0:A.preparationTime)||0,"min"]})]},$.id)})}),N.notes&&e.jsx("div",{className:"mb-4 p-2 bg-yellow-100 rounded border",children:e.jsx("p",{className:"text-sm text-yellow-800",children:N.notes})}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Tempo estimado: ",S,"min"]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${C==="high"?"bg-red-200 text-red-800":C==="medium"?"bg-yellow-200 text-yellow-800":"bg-green-200 text-green-800"}`,children:C==="high"?"Urgente":C==="medium"?"Médio":"Normal"})]}),e.jsxs("div",{className:"space-y-2",children:[N.status==="pending"&&e.jsx("button",{onClick:()=>w(N.id,"preparing"),disabled:r.has(N.id),className:`w-full py-2 rounded-lg font-medium transition-all duration-300 ${r.has(N.id)?"bg-blue-300 text-blue-700 cursor-not-allowed animate-pulse scale-95":"bg-blue-600 text-white hover:bg-blue-700 hover:shadow-lg transform hover:scale-105 active:scale-95"}`,children:r.has(N.id)?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-700 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Iniciando..."})]}):"Iniciar Preparo"}),N.status==="preparing"&&e.jsx("button",{onClick:()=>w(N.id,"ready"),disabled:r.has(N.id),className:`w-full py-2 rounded-lg font-medium transition-all duration-300 ${r.has(N.id)?"bg-green-300 text-green-700 cursor-not-allowed animate-pulse scale-95":"bg-green-600 text-white hover:bg-green-700 hover:shadow-lg transform hover:scale-105 active:scale-95"}`,children:r.has(N.id)?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-green-700 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Finalizando..."})]}):"Marcar como Pronto"}),N.status==="ready"&&e.jsx("div",{className:"w-full py-2 rounded-lg font-medium bg-green-100 text-green-800 border-2 border-green-300 text-center animate-pulse",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-5 h-5 bg-green-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"✓"})}),e.jsx("span",{children:"Pronto para Entrega"})]})})]})]},N.id)})})]})},Qz=()=>{const{kitchenOrders:t,menuItems:s,refreshKitchenOrders:a}=Tt(),[r,o]=y.useState("orders");kz({onOrderUpdate:()=>{console.log("🔔 Atualização detectada! Recarregando Monitor Cozinha..."),a()}}),Ye.useEffect(()=>{console.log("🚀 Monitor Cozinha montado - carregando dados iniciais..."),a()},[]);const l=t.filter(h=>h.status==="pending"||h.status==="preparing"),c=s.filter(h=>h.item_type!=="direct"),u=c.filter(h=>h.preparationTime).reduce((h,f)=>h+(f.preparationTime||0),0)/c.filter(h=>h.preparationTime).length||0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Módulo Cozinha"}),e.jsx("p",{className:"text-gray-600",children:"Gestão completa da cozinha e cardápio"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>o("orders"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${r==="orders"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Pedidos"}),e.jsx("button",{onClick:()=>o("menu"),className:`px-4 py-2 rounded-lg font-medium transition-colors ${r==="menu"?"bg-blue-600 text-white":"bg-gray-200 text-gray-700 hover:bg-gray-300"}`,children:"Cardápio"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:"Pedidos Pendentes"}),e.jsx("p",{className:"text-3xl font-bold text-orange-600",children:l.length})]}),e.jsx("div",{className:"p-3 bg-orange-100 rounded-full",children:e.jsx(Bt,{className:"w-6 h-6 text-orange-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:"Tempo Médio"}),e.jsxs("p",{className:"text-3xl font-bold text-blue-600",children:[u.toFixed(0),"min"]})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-full",children:e.jsx(Bt,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:"Pratos Disponíveis"}),e.jsx("p",{className:"text-3xl font-bold text-green-600",children:c.filter(h=>h.available).length})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-full",children:e.jsx(Ya,{className:"w-6 h-6 text-green-600"})})]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md",children:r==="orders"?e.jsx(Xz,{orders:l,menuItems:c}):e.jsx(Kz,{menuItems:c})})]})},Jz=()=>{const{user:t}=jt(),[s,a]=y.useState([]),[r,o]=y.useState(!0),[l,c]=y.useState(null),u=async()=>{if(!t){console.log("useInventoryCategories: Usuário não autenticado"),o(!1);return}try{o(!0),c(null),console.log("📋 Carregando categorias para usuário:",t.id);const{data:g,error:v}=await B.from("usuarios_empresa").select("empresa_id").eq("user_id",t.id).eq("ativo",!0).single();if(v||!g){console.error("useInventoryCategories: Erro ao buscar empresa:",v),c("Erro ao identificar empresa do usuário");return}const b=g.empresa_id;console.log("📋 Carregando categorias para empresa:",b);const{data:_,error:w}=await B.from("inventory_categories").select("*").eq("empresa_id",b).eq("is_active",!0).order("name");if(w){console.error("useInventoryCategories: Erro ao carregar categorias:",w),c(w.message);return}console.log("✅ Categorias carregadas:",(_==null?void 0:_.length)||0),a(_||[])}catch(g){console.error("❌ Erro ao carregar categorias:",g),c(g instanceof Error?g.message:"Erro desconhecido")}finally{o(!1)}},h=async g=>{if(!t)throw new Error("Usuário não autenticado");try{console.log("➕ Criando categoria:",g);const{data:v,error:b}=await B.from("usuarios_empresa").select("empresa_id").eq("user_id",t.id).eq("ativo",!0).single();if(b||!v)throw new Error("Erro ao identificar empresa do usuário");const{data:_,error:w}=await B.from("inventory_categories").insert({name:g.name,description:g.description||"",color:g.color,icon:g.icon||"tag",is_active:!0,empresa_id:v.empresa_id}).select().single();if(w)throw new Error(w.message);return console.log("✅ Categoria criada:",_),await u(),_}catch(v){throw console.error("❌ Erro ao criar categoria:",v),v}},f=async(g,v)=>{try{console.log("✏️ Atualizando categoria:",g,v);const{data:b,error:_}=await B.from("inventory_categories").update({name:v.name,description:v.description,color:v.color,icon:v.icon,is_active:v.is_active,updated_at:new Date().toISOString()}).eq("id",g).select().single();if(_)throw new Error(_.message);return console.log("✅ Categoria atualizada:",b),await u(),b}catch(b){throw console.error("❌ Erro ao atualizar categoria:",b),b}},p=async g=>{try{console.log("🗑️ Deletando categoria:",g);const{error:v}=await B.from("inventory_categories").delete().eq("id",g);if(v)throw new Error(v.message);console.log("✅ Categoria deletada"),await u()}catch(v){throw console.error("❌ Erro ao deletar categoria:",v),v}};return y.useEffect(()=>{t&&u()},[t]),{categories:s,loading:r,error:l,loadCategories:u,createCategory:h,updateCategory:f,deleteCategory:p}},e$=({isOpen:t,onClose:s,category:a,onSave:r})=>{const[o,l]=y.useState({name:"",description:"",color:"#3B82F6",icon:"tag"}),[c,u]=y.useState(!1);y.useEffect(()=>{l(a?{name:a.name,description:a.description||"",color:a.color,icon:a.icon||"tag"}:{name:"",description:"",color:"#3B82F6",icon:"tag"})},[a]);const h=async()=>{u(!0);try{await r(o),s()}catch(f){console.error("Erro ao salvar categoria:",f),alert("Erro ao salvar categoria. Tente novamente.")}finally{u(!1)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:a?"Editar Categoria":"Nova Categoria"}),e.jsx("button",{onClick:s,className:"text-gray-500 hover:text-gray-700",children:e.jsx(nt,{size:24})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome da Categoria *"}),e.jsx("input",{type:"text",value:o.name,onChange:f=>l({...o,name:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,placeholder:"Digite o nome da categoria"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Descrição"}),e.jsx("textarea",{value:o.description,onChange:f=>l({...o,description:f.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:3,placeholder:"Descrição opcional da categoria"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Cor"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"color",value:o.color,onChange:f=>l({...o,color:f.target.value}),className:"w-12 h-10 border border-gray-300 rounded cursor-pointer"}),e.jsx("input",{type:"text",value:o.color,onChange:f=>l({...o,color:f.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"#3B82F6"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-md hover:bg-gray-50",disabled:c,children:"Cancelar"}),e.jsx("button",{type:"button",onClick:h,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",disabled:c,children:c?"Salvando...":a?"Atualizar":"Criar"})]})]})]})}):null},t$=()=>{const{categories:t,loading:s,createCategory:a,updateCategory:r,deleteCategory:o,refresh:l}=Jz(),[c,u]=y.useState(!1),[h,f]=y.useState(null);console.log("🔍 CategoryManager - Estado atual:",{categoriesCount:t.length,loading:s,categories:t.map(_=>({id:_.id,name:_.name}))});const p=_=>{f(_),u(!0)},g=async _=>{if(confirm("Tem certeza que deseja excluir esta categoria?"))try{await o(_)}catch(w){console.error("Erro ao excluir categoria:",w),alert("Erro ao excluir categoria. Tente novamente.")}},v=async _=>{try{h?await r(h.id,_):await a(_)}catch(w){throw w}},b=()=>{u(!1),f(null)};return s?e.jsx("div",{className:"flex items-center justify-center p-8",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Categorias de Produtos"}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>{console.log("🔄 Forçando refresh das categorias..."),l()},className:"flex items-center space-x-2 bg-gray-600 text-white px-3 py-2 rounded-md hover:bg-gray-700 text-sm",children:e.jsx("span",{children:"🔄 Refresh"})}),e.jsxs("button",{onClick:()=>u(!0),className:"flex items-center space-x-2 bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:[e.jsx($s,{size:20}),e.jsx("span",{children:"Nova Categoria"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(_=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"w-4 h-4 rounded-full",style:{backgroundColor:_.color}}),e.jsx(f0,{size:20,className:"text-gray-500"})]}),e.jsxs("div",{className:"flex space-x-1",children:[e.jsx("button",{onClick:()=>p(_),className:"p-1 text-gray-500 hover:text-blue-600",children:e.jsx(xO,{size:16})}),e.jsx("button",{onClick:()=>g(_.id),className:"p-1 text-gray-500 hover:text-red-600",children:e.jsx(Yi,{size:16})})]})]}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:_.name}),_.description&&e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:_.description}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Criado em ",new Date(_.created_at).toLocaleDateString("pt-BR")]})]},_.id))}),t.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(f0,{size:48,className:"mx-auto text-gray-400 mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma categoria encontrada"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Comece criando sua primeira categoria de produtos."}),e.jsx("button",{onClick:()=>u(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Criar Primeira Categoria"})]}),e.jsx(e$,{isOpen:c,onClose:b,category:h,onSave:v})]})},s$=({className:t="",variant:s="primary",size:a="md"})=>{const[r,o]=y.useState(!1),l=()=>{const u="inline-flex items-center justify-center font-medium rounded-md transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2",h={sm:"px-3 py-1.5 text-sm",md:"px-4 py-2 text-sm",lg:"px-6 py-3 text-base"},f={primary:"bg-blue-600 text-white hover:bg-blue-700 focus:ring-blue-500",secondary:"bg-gray-600 text-white hover:bg-gray-700 focus:ring-gray-500",outline:"border border-gray-300 bg-white text-gray-700 hover:bg-gray-50 focus:ring-blue-500"};return`${u} ${h[a]} ${f[s]} ${t}`},c=()=>{switch(a){case"sm":return 16;case"lg":return 24;default:return 20}};return e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>o(!0),className:l(),title:"Gerenciar Categorias de Produtos",children:[e.jsx(f0,{size:c(),className:"mr-2"}),"Categorias"]}),r&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-6xl mx-4 max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex justify-between items-center p-4 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Gerenciar Categorias"}),e.jsx("button",{onClick:()=>o(!1),className:"text-gray-500 hover:text-gray-700 text-2xl",children:"×"})]}),e.jsx("div",{className:"overflow-y-auto max-h-[calc(90vh-80px)]",children:e.jsx(t$,{})})]})})]})},a$=({isOpen:t,onClose:s,item:a})=>{const{addInventoryItem:r,updateInventoryItem:o,inventoryCategories:l}=Tt(),{register:c,handleSubmit:u,control:h,reset:f,formState:{errors:p},watch:g}=Rg(),[v,b]=y.useState(!1),[_,w]=y.useState([]),[E,k]=y.useState(!0),[N,C]=y.useState({salePrice:a==null?void 0:a.salePrice,marginPercentage:(a==null?void 0:a.marginPercentage)||50,pricingMethod:(a==null?void 0:a.pricingMethod)||"margin"}),S=Ye.useRef(N);Ye.useEffect(()=>{S.current=N,console.log("🔄 Ref de precificação atualizada:",N)},[N]);const T=g("cost",(a==null?void 0:a.cost)||0);Ye.useEffect(()=>{if(T!==void 0){const z=Number(T)||0;if(N.pricingMethod==="margin"){const R=z*(1+(N.marginPercentage||50)/100),L={...S.current,salePrice:R};C(L),S.current=L,console.log(`💰 CUSTO ALTERADO (useEffect) - Novo custo: R$ ${z}, Novo preço: R$ ${R.toFixed(2)}`)}else if(N.pricingMethod==="fixed_price"&&N.salePrice){const R=z>0?((N.salePrice||0)-z)/z*100:0,L={...S.current,marginPercentage:R};C(L),S.current=L,console.log(`💰 CUSTO ALTERADO (useEffect) - Novo custo: R$ ${z}, Nova margem: ${R.toFixed(1)}%`)}}},[T,N.pricingMethod]);const M=async()=>{try{console.log("🔍 Carregando categorias do inventory_categories...");const{data:z,error:R}=await B.from("inventory_categories").select("*").eq("is_active",!0).order("name");if(R)throw R;console.log("✅ Categorias carregadas:",(z==null?void 0:z.length)||0),w(z||[])}catch(z){console.error("❌ Erro ao carregar categorias:",z);try{console.log("🔄 Tentando fallback para product_categories...");const{data:R,error:L}=await B.from("product_categories").select("*").eq("is_active",!0).order("name");if(L)throw L;console.log("✅ Categorias do fallback carregadas:",(R==null?void 0:R.length)||0),w(R||[])}catch(R){console.error("❌ Erro no fallback também:",R)}}finally{k(!1)}};y.useEffect(()=>{t&&M()},[t]),y.useEffect(()=>{if(a){f({name:a.name,categoryId:a.categoryId,currentStock:a.currentStock,minStock:a.minStock,unit:a.unit,cost:a.cost,supplier:a.supplier,availableForSale:a.availableForSale,image_url:a.image_url});const z={salePrice:a.salePrice,marginPercentage:a.marginPercentage||50,pricingMethod:a.pricingMethod||"margin"};C(z),S.current=z,console.log("📝 Carregando dados de precificação do item:",z)}else f({name:"",categoryId:"",currentStock:void 0,minStock:void 0,unit:"unidades",cost:void 0,supplier:"",availableForSale:!1,image_url:""})},[a,f]);const $=async z=>{b(!0);try{const R=S.current;console.log("💾 Salvando item com dados:",z),console.log("💰 Dados de precificação:",R),console.log("🔄 Modo:",a?"EDITANDO":"CRIANDO NOVO");const L={...z,salePrice:R.salePrice,marginPercentage:R.marginPercentage,pricingMethod:R.pricingMethod};console.log("📦 Dados finais para salvar:",L),a?(console.log("✏️ EDITANDO item existente:",a.id),console.log("📊 Margem anterior:",a.marginPercentage),console.log("📊 Margem nova:",R.marginPercentage),await o({...a,...L})):(console.log("➕ CRIANDO novo item"),await r(L)),s()}catch(R){console.error("Falha ao salvar o item:",R)}finally{b(!1)}},A=["unidades","kg","litros","garrafas"];return e.jsx(Ws,{children:t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:e.jsxs(be.div,{initial:{opacity:0,scale:.95,y:20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:20},transition:{duration:.2},className:"bg-white rounded-xl shadow-2xl w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-100",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:a?"Editar Item":"Novo Item no Estoque"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a?"Atualize as informações do item":"Adicione um novo item ao inventário"})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 hover:bg-gray-200 p-2 rounded-lg transition-colors duration-200",disabled:v,children:e.jsx(nt,{size:24})})]}),e.jsxs("form",{onSubmit:u($),className:"p-6 space-y-6",children:[e.jsxs("div",{style:{backgroundColor:"#f0f9ff",border:"2px solid #3b82f6",borderRadius:"8px",padding:"20px",margin:"15px 0"},children:[e.jsx("h3",{style:{color:"#1e40af",fontSize:"18px",fontWeight:"bold",marginBottom:"15px",display:"flex",alignItems:"center",gap:"8px"},children:"💰 Sistema de Precificação - VERSÃO ATUALIZADA ✅"}),e.jsxs("div",{style:{marginBottom:"15px"},children:[e.jsx("label",{style:{display:"block",marginBottom:"8px",fontWeight:"600"},children:"Método de Precificação:"}),e.jsxs("div",{style:{display:"flex",gap:"20px"},children:[e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx("input",{type:"radio",name:"pricingMethod",value:"margin",defaultChecked:!0,onChange:()=>{console.log("Método selecionado: Margem");const z={...S.current,pricingMethod:"margin"};C(z),S.current=z}}),"📈 Por Margem de Lucro"]}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"5px"},children:[e.jsx("input",{type:"radio",name:"pricingMethod",value:"fixed_price",onChange:()=>{console.log("Método selecionado: Preço Fixo");const z={...S.current,pricingMethod:"fixed_price"};C(z),S.current=z}}),"💵 Preço Fixo"]})]})]}),e.jsxs("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(200px, 1fr))",gap:"15px"},children:[e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"600"},children:"Custo Base:"}),e.jsxs("div",{style:{padding:"10px",backgroundColor:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:"6px",fontWeight:"bold"},children:["R$ ",(T||0).toFixed(2)]}),e.jsx("p",{style:{fontSize:"12px",color:"#6b7280",marginTop:"4px"},children:'💡 Edite o custo no campo "Custo por Unidade" abaixo'})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"600"},children:"Margem de Lucro (%):"}),N.pricingMethod==="margin"?e.jsx("input",{type:"number",value:N.marginPercentage||50,min:"0",step:"1",style:{width:"100%",padding:"10px",border:"1px solid #d1d5db",borderRadius:"6px",fontSize:"16px"},onChange:z=>{const R=Number(z.target.value),L=T||0,I=L*(1+R/100);console.log(`💰 EDITANDO MARGEM - Margem: ${R}%, Custo: R$ ${L}, Preço: R$ ${I.toFixed(2)}`);const X={...S.current,marginPercentage:R,salePrice:I,pricingMethod:"margin"};C(X),S.current=X,console.log("📊 EDITANDO MARGEM - Dados atualizados:",X)}},`margin-${(a==null?void 0:a.id)||"new"}-${N.marginPercentage}`):e.jsxs("div",{style:{padding:"10px",backgroundColor:"#f3f4f6",border:"1px solid #d1d5db",borderRadius:"6px",fontWeight:"bold",color:"#6b7280"},children:[(N.marginPercentage||0).toFixed(1),"%"]})]}),e.jsxs("div",{children:[e.jsx("label",{style:{display:"block",marginBottom:"5px",fontWeight:"600"},children:"Preço de Venda:"}),N.pricingMethod==="fixed_price"?e.jsx("input",{type:"number",value:N.salePrice||0,min:"0",step:"0.01",style:{width:"100%",padding:"10px",border:"1px solid #16a34a",borderRadius:"6px",fontSize:"16px",backgroundColor:"#dcfce7",fontWeight:"bold",color:"#15803d"},onChange:z=>{const R=Number(z.target.value),L=T||0,I=L>0?(R-L)/L*100:0;console.log(`💰 EDITANDO PREÇO FIXO - Preço: R$ ${R}, Custo: R$ ${L}, Margem: ${I.toFixed(1)}%`);const X={...S.current,salePrice:R,marginPercentage:I,pricingMethod:"fixed_price"};C(X),S.current=X,console.log("📊 EDITANDO PREÇO FIXO - Dados atualizados:",X)}},`price-${(a==null?void 0:a.id)||"new"}-${N.salePrice}`):e.jsxs("div",{style:{padding:"10px",backgroundColor:"#dcfce7",border:"1px solid #16a34a",borderRadius:"6px",fontWeight:"bold",color:"#15803d"},children:["R$ ",(N.salePrice||(T||0)*(1+(N.marginPercentage||50)/100)).toFixed(2)]})]})]})]}),e.jsx(Ln,{label:"Nome do Item",error:p.name,children:e.jsx("input",{...c("name",{required:"Nome é obrigatório"}),className:"form-input",placeholder:"Digite o nome do item",disabled:v})}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:"Categoria"}),e.jsx(s$,{variant:"outline",size:"sm",className:"text-xs"})]}),e.jsx(ro,{name:"categoryId",control:h,rules:{required:"Categoria é obrigatória"},render:({field:z})=>e.jsxs("select",{...z,className:"form-select",disabled:v||E,children:[e.jsx("option",{value:"",children:E?"Carregando categorias...":"Selecione uma categoria"}),_.map(R=>e.jsx("option",{value:R.id,children:R.name},R.id))]})}),p.categoryId&&e.jsxs("p",{className:"text-red-500 text-sm flex items-center space-x-1",children:[e.jsx("span",{className:"w-4 h-4 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"})}),e.jsx("span",{children:p.categoryId.message})]}),e.jsxs("button",{type:"button",onClick:M,className:"text-xs text-blue-600 hover:text-blue-800 flex items-center space-x-1",disabled:E,children:[e.jsx(io,{size:12}),e.jsx("span",{children:"Atualizar categorias"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(Ln,{label:"Estoque Atual",error:p.currentStock,children:e.jsx("input",{type:"number",...c("currentStock",{required:"Estoque atual é obrigatório",valueAsNumber:!0,min:{value:0,message:"Valor deve ser maior ou igual a 0"}}),className:"form-input",placeholder:"0",disabled:v})}),e.jsx(Ln,{label:"Estoque Mínimo",error:p.minStock,children:e.jsx("input",{type:"number",...c("minStock",{required:"Estoque mínimo é obrigatório",valueAsNumber:!0,min:{value:0,message:"Valor deve ser maior ou igual a 0"}}),className:"form-input",placeholder:"0",disabled:v})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(Ln,{label:"Unidade",error:p.unit,children:e.jsx(ro,{name:"unit",control:h,rules:{required:"Unidade é obrigatória"},render:({field:z})=>e.jsx("select",{...z,className:"form-select",disabled:v,children:A.map(R=>e.jsx("option",{value:R,children:R},R))})})}),e.jsx(Ln,{label:"Custo por Unidade (R$)",error:p.cost,children:e.jsx("input",{type:"number",step:"0.01",...c("cost",{required:"Custo é obrigatório",valueAsNumber:!0,min:{value:0,message:"Valor deve ser maior ou igual a 0"}}),className:"form-input",placeholder:"0,00",disabled:v})})]}),e.jsx(Ln,{label:"Fornecedor (Opcional)",error:p.supplier,children:e.jsx("input",{...c("supplier"),className:"form-input",placeholder:"Nome do fornecedor",disabled:v})}),e.jsxs(Ln,{label:"URL da Imagem (Opcional)",error:p.image_url,children:[e.jsx("input",{...c("image_url"),className:"form-input",placeholder:"https://exemplo.com/imagem.jpg",disabled:v}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Cole aqui o link de uma imagem para representar este item do estoque"})]}),e.jsxs("div",{className:"flex items-center space-x-3 p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx(ro,{name:"availableForSale",control:h,render:({field:z})=>e.jsx("input",{type:"checkbox",checked:z.value||!1,onChange:R=>z.onChange(R.target.checked),onBlur:z.onBlur,name:z.name,ref:z.ref,className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded",disabled:v})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"text-sm font-medium text-gray-900",children:"Disponível para Venda"}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:"Marque esta opção para que o produto apareça automaticamente no balcão e comandas quando houver estoque"})]})]}),e.jsxs("div",{className:"pt-6 flex flex-col sm:flex-row justify-end space-y-3 sm:space-y-0 sm:space-x-3 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:s,className:"btn-secondary",disabled:v,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"btn-primary flex items-center justify-center space-x-2",disabled:v,children:v?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Salvando..."})]}):e.jsx("span",{children:a?"Salvar Alterações":"Adicionar Item"})})]})]})]})})})},Ln=({label:t,children:s,error:a})=>e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-semibold text-gray-700",children:t}),s,a&&e.jsxs("p",{className:"text-red-500 text-sm flex items-center space-x-1",children:[e.jsx("span",{className:"w-4 h-4 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("span",{className:"w-2 h-2 bg-red-500 rounded-full"})}),e.jsx("span",{children:a.message})]})]}),r$=({item:t,categories:s,onEdit:a,onDelete:r})=>{const o=t.currentStock<=t.minStock,l=t.availableForSale||!1,c=s.find(u=>u.id===t.categoryId);return e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`bg-white border rounded-lg p-4 hover:shadow-lg transition-shadow relative ${o?"border-red-300":l?"border-green-300":"border-gray-200"}`,children:[t.image_url&&e.jsx("div",{className:"w-full h-32 mb-3 bg-gray-100 rounded-lg overflow-hidden flex items-center justify-center",children:e.jsx("img",{src:t.image_url,alt:t.name,className:"max-w-full max-h-full object-contain hover:scale-105 transition-transform duration-300",onError:u=>{u.currentTarget.style.display="none"}})}),e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"pr-4 flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-800",children:t.name}),e.jsx("p",{className:"text-sm text-gray-500",children:(c==null?void 0:c.name)||"Sem categoria"})]}),e.jsxs("div",{className:"flex space-x-2 ml-2",children:[e.jsx("button",{onClick:()=>a(t),className:"text-gray-400 hover:text-blue-600 transition-colors p-1 rounded hover:bg-gray-100",title:"Editar item","aria-label":`Editar ${t.name}`,children:e.jsx(lo,{size:16})}),e.jsx("button",{onClick:()=>r(t.id),className:"text-gray-400 hover:text-red-600 transition-colors p-1 rounded hover:bg-gray-100",title:"Excluir item","aria-label":`Excluir ${t.name}`,children:e.jsx(Yi,{size:16})})]})]}),e.jsx("div",{className:"mb-3",children:l?e.jsxs("div",{className:"flex items-center space-x-1 bg-green-100 text-green-700 px-2 py-1 rounded-full text-xs font-medium w-fit",children:[e.jsx(hn,{size:12}),e.jsx("span",{children:"Disponível para venda"})]}):e.jsxs("div",{className:"flex items-center space-x-1 bg-gray-100 text-gray-600 px-2 py-1 rounded-full text-xs font-medium w-fit",children:[e.jsx(Ia,{size:12}),e.jsx("span",{children:"Não disponível para venda"})]})}),e.jsxs("div",{className:"flex justify-between items-baseline mb-3",children:[e.jsx("span",{className:"text-2xl font-bold text-gray-800",children:t.currentStock}),e.jsxs("span",{className:"text-sm text-gray-600",children:["/ ",t.minStock," ",t.unit]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2.5",children:e.jsx("div",{className:`h-2.5 rounded-full ${o?"bg-red-500":"bg-blue-500"}`,style:{width:`${Math.min(t.currentStock/(t.minStock*2)*100,100)}%`}})}),(o||!l)&&e.jsxs("div",{className:"flex flex-col space-y-1 mt-2",children:[o&&e.jsxs("div",{className:"flex items-center space-x-1 text-red-600 text-xs",children:[e.jsx(yt,{size:14}),e.jsx("span",{children:"Estoque baixo"})]}),!l&&e.jsxs("div",{className:"flex items-center space-x-1 text-orange-600 text-xs",children:[e.jsx(Ia,{size:14}),e.jsx("span",{children:"Produto não liberado para venda no balcão"})]})]}),e.jsxs("div",{className:"text-xs text-gray-500 mt-3 space-y-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:["Custo: R$ ",t.cost.toFixed(2)]}),e.jsxs("span",{children:["Fornecedor: ",t.supplier||"N/A"]})]}),t.salePrice&&e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"text-green-600 font-medium",children:["Preço de Venda: R$ ",t.salePrice.toFixed(2)]}),t.marginPercentage&&e.jsxs("span",{className:"text-blue-600",children:["Margem: ",t.marginPercentage.toFixed(1),"%"]})]})]})]})},n$=()=>{const t=Xs(),{inventory:s,inventoryCategories:a,removeInventoryItem:r,loadFullInventory:o}=Tt(),[l,c]=y.useState(!1),[u,h]=y.useState(null),[f,p]=y.useState("");Ye.useEffect(()=>{o()},[]);const g=E=>{h(E),c(!0)},v=()=>{h(null),c(!0)},b=()=>{c(!1),h(null)},_=y.useMemo(()=>s.filter(E=>E.name.toLowerCase().includes(f.toLowerCase())),[s,f]),w=y.useMemo(()=>{const E=s.reduce((N,C)=>N+C.cost*C.currentStock,0),k=s.filter(N=>N.currentStock<=N.minStock).length;return{totalValue:E,lowStockCount:k,totalItems:s.length}},[s]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Módulo Estoque"}),e.jsx("p",{className:"text-gray-600",children:"Controle e gestão de inventário"})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-3 mt-4 sm:mt-0",children:[e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>t("/inventory/movements"),className:"bg-purple-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-purple-700 transition-colors flex items-center space-x-2",children:[e.jsx(YR,{size:20}),e.jsx("span",{children:"Movimentações"})]}),e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:()=>t("/inventory/atualizacao-massiva"),className:"bg-green-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center space-x-2",children:[e.jsx(Ka,{size:20}),e.jsx("span",{children:"Atualização Massiva"})]}),e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:v,className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx($s,{size:20}),e.jsx("span",{children:"Novo Item"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(Np,{icon:Ut,title:"Valor Total do Estoque",value:`R$ ${w.totalValue.toFixed(2)}`,color:"green"}),e.jsx(Np,{icon:Ka,title:"Itens Totais",value:w.totalItems,color:"blue"}),e.jsx(Np,{icon:yt,title:"Itens com Estoque Baixo",value:w.lowStockCount,color:"orange",onClick:()=>t("/inventory/estoque-baixo"),clickable:!0})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Itens do Inventário"}),e.jsxs("div",{className:"relative",children:[e.jsx(Xa,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar itens...",value:f,onChange:E=>p(E.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:_.map(E=>e.jsx(r$,{item:E,categories:a,onEdit:g,onDelete:r},E.id))}),_.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhum item encontrado"})})]}),l&&e.jsx(a$,{isOpen:l,onClose:b,item:u})]})},Np=({icon:t,title:s,value:a,color:r,onClick:o,clickable:l=!1})=>{const c={green:"bg-green-100 text-green-600",blue:"bg-blue-100 text-blue-600",orange:"bg-orange-100 text-orange-600"},u="bg-white rounded-lg shadow-md p-6",h=l?"cursor-pointer hover:shadow-lg transition-shadow":"";return e.jsx(be.div,{className:`${u} ${h}`,onClick:o,whileHover:l?{scale:1.02}:{},whileTap:l?{scale:.98}:{},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:s}),e.jsx("p",{className:`text-3xl font-bold text-${r}-600`,children:a})]}),e.jsx("div",{className:`p-3 rounded-full ${c[r]}`,children:e.jsx(t,{className:"w-6 h-6"})})]})})},o$=({isOpen:t,onClose:s,itens:a,categorias:r})=>{const[o,l]=y.useState(""),[c,u]=y.useState(""),[h,f]=y.useState(""),[p,g]=y.useState("telefone"),v=M=>{const $=M.replace(/\D/g,"");return $.length<=2?$:$.length<=7?`(${$.slice(0,2)}) ${$.slice(2)}`:`(${$.slice(0,2)}) ${$.slice(2,7)}-${$.slice(7,11)}`},b=M=>{const $=M.replace(/\D/g,"");return $.length===11&&$.startsWith("11",0)||$.length===11},_=(M,$)=>Math.max($*2-M,$),w=()=>{const M=new Date,$=M.toLocaleDateString("pt-BR"),A=M.toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),z=a.reduce((L,I)=>{var ce;const X=((ce=r.find(J=>J.id===I.categoryId))==null?void 0:ce.name)||"Sem Categoria";return L[X]||(L[X]=[]),L[X].push(I),L},{});let R=`🏪 *AABB - Lista de Compras*
`;return R+=`📅 ${$} às ${A}

`,R+=`📋 *ITENS PARA REPOSIÇÃO:*

`,Object.entries(z).forEach(([L,I])=>{R+=`🔸 *${L.toUpperCase()}*
`,I.forEach(X=>{const ce=_(X.currentStock,X.minStock),J=X.currentStock===0?"🔴 ESGOTADO":"🟡 BAIXO";R+=`• ${X.name}
`,R+=`  ${J} - Atual: ${X.currentStock} ${X.unit}
`,R+=`  Mínimo: ${X.minStock} ${X.unit}
`,R+=`  *Sugestão: ${ce} ${X.unit}*
`,X.supplier&&(R+=`  Fornecedor: ${X.supplier}
`),X.cost&&(R+=`  Custo: R$ ${X.cost.toFixed(2)}
`),R+=`
`}),R+=`
`}),R+=`💡 *Observações:*
`,R+=`- Quantidades baseadas no estoque mínimo
`,R+=`- Verificar disponibilidade com fornecedores
`,R+=`- Priorizar itens esgotados

`,R+=`👤 Solicitado pelo Sistema AABB
`,R+=`📞 Contato: (11) 99999-9999

`,R+=`---
`,R+="Sistema AABB - Gestão de Estoque",R},E=M=>{const $=v(M.target.value);l($),c&&u("")},k=()=>{if(!b(o)){u("Número de telefone inválido. Use o formato (XX) XXXXX-XXXX");return}const M=w();f(M),g("mensagem")},N=()=>{const $=`55${o.replace(/\D/g,"")}`,A=encodeURIComponent(h),z=`https://web.whatsapp.com/send?phone=${$}&text=${A}`;if(!window.open(z,"_blank")){const L=`whatsapp://send?phone=${$}&text=${A}`;window.location.href=L}s()},C=async()=>{try{await navigator.clipboard.writeText(h),alert("Mensagem copiada para a área de transferência!")}catch(M){console.error("Erro ao copiar mensagem:",M),alert("Erro ao copiar mensagem. Tente selecionar e copiar manualmente.")}},S=()=>{g("telefone"),f("")},T=()=>{l(""),u(""),f(""),g("telefone"),s()};return e.jsx(Ws,{children:t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(be.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-lg shadow-xl w-full max-w-2xl max-h-[90vh] overflow-hidden",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:p==="telefone"?"Compartilhar no WhatsApp":"Confirmar Envio"}),e.jsx("button",{onClick:T,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(nt,{size:20,className:"text-gray-500"})})]}),e.jsx("div",{className:"p-6",children:p==="telefone"?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Insira o número de telefone para enviar a lista de compras via WhatsApp."}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Número de Telefone"}),e.jsxs("div",{className:"relative",children:[e.jsx(Zu,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",value:o,onChange:E,placeholder:"(11) 99999-9999",className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-green-500 focus:border-transparent ${c?"border-red-300":"border-gray-300"}`,maxLength:15})]}),c&&e.jsx("p",{className:"text-red-600 text-sm",children:c})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-blue-800 mb-2",children:"Resumo da Lista"}),e.jsxs("p",{className:"text-blue-700 text-sm",children:[a.length," ",a.length===1?"item":"itens"," com estoque baixo serão incluídos na mensagem."]})]})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"text-gray-600 mb-4",children:["Mensagem que será enviada para ",e.jsx("strong",{children:o}),":"]}),e.jsx("div",{className:"bg-gray-50 border rounded-lg p-4 max-h-96 overflow-y-auto",children:e.jsx("pre",{className:"text-sm text-gray-800 whitespace-pre-wrap font-mono",children:h})})]}),e.jsx("div",{className:"flex space-x-3",children:e.jsxs("button",{onClick:C,className:"flex-1 bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(La,{size:16}),e.jsx("span",{children:"Copiar Mensagem"})]})})]})}),e.jsx("div",{className:"flex justify-between p-6 border-t bg-gray-50",children:p==="telefone"?e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:T,className:"px-6 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:k,disabled:!o,className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center space-x-2",children:e.jsx("span",{children:"Gerar Mensagem"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:S,className:"px-6 py-2 text-gray-600 hover:text-gray-800 transition-colors",children:"Voltar"}),e.jsxs("button",{onClick:N,className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center space-x-2",children:[e.jsx(AO,{size:16}),e.jsx("span",{children:"Enviar WhatsApp"})]})]})})]})})})},i$=()=>{const t=Xs(),{inventory:s,inventoryCategories:a}=Tt(),[r,o]=y.useState(!1),l=y.useMemo(()=>s.filter(f=>f.currentStock<=f.minStock),[s]),c=y.useMemo(()=>{const f=l.reduce((p,g)=>{var b;const v=((b=a.find(_=>_.id===g.categoryId))==null?void 0:b.name)||"Sem Categoria";return p[v]||(p[v]=[]),p[v].push(g),p},{});return Object.entries(f).sort(([p],[g])=>p.localeCompare(g))},[l,a]),u=(f,p)=>Math.max(p*2-f,p),h=()=>{o(!0)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/inventory"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(fo,{size:20,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Itens com Estoque Baixo"}),e.jsxs("p",{className:"text-gray-600",children:[l.length," ",l.length===1?"item precisa":"itens precisam"," de reposição"]})]})]}),l.length>0&&e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:h,className:"bg-green-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-green-700 transition-colors flex items-center space-x-2",children:[e.jsx(OO,{size:20}),e.jsx("span",{children:"Compartilhar no WhatsApp"})]})]}),l.length===0?e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-green-50 border border-green-200 rounded-lg p-8 text-center",children:[e.jsx("div",{className:"flex justify-center mb-4",children:e.jsx("div",{className:"p-4 bg-green-100 rounded-full",children:e.jsx(Ka,{className:"w-8 h-8 text-green-600"})})}),e.jsx("h3",{className:"text-xl font-semibold text-green-800 mb-2",children:"Parabéns! Todos os itens estão com estoque adequado"}),e.jsx("p",{className:"text-green-600",children:"Não há itens que precisam de reposição no momento."})]}):e.jsx("div",{className:"space-y-6",children:c.map(([f,p],g)=>e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:g*.1},className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-800 mb-4 flex items-center space-x-2",children:[e.jsx(yt,{className:"w-5 h-5 text-orange-500"}),e.jsx("span",{children:f}),e.jsxs("span",{className:"text-sm text-gray-500 font-normal",children:["(",p.length," itens)"]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:p.map(v=>{const b=u(v.currentStock,v.minStock),_=v.currentStock===0;return e.jsxs("div",{className:`p-4 rounded-lg border-2 ${_?"border-red-300 bg-red-50":"border-orange-300 bg-orange-50"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsx("h4",{className:"font-semibold text-gray-800 text-sm",children:v.name}),_&&e.jsx("span",{className:"text-xs bg-red-100 text-red-800 px-2 py-1 rounded-full",children:"ESGOTADO"})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Estoque Atual:"}),e.jsxs("span",{className:`font-medium ${_?"text-red-600":"text-orange-600"}`,children:[v.currentStock," ",v.unit]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Estoque Mínimo:"}),e.jsxs("span",{className:"font-medium text-gray-800",children:[v.minStock," ",v.unit]})]}),e.jsxs("div",{className:"flex justify-between border-t pt-2",children:[e.jsx("span",{className:"text-gray-600",children:"Sugestão de Compra:"}),e.jsxs("span",{className:"font-bold text-blue-600",children:[b," ",v.unit]})]}),v.supplier&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Fornecedor:"}),e.jsx("span",{className:"font-medium text-gray-800 text-xs",children:v.supplier})]}),v.cost&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Custo Unit.:"}),e.jsxs("span",{className:"font-medium text-gray-800",children:["R$ ",v.cost.toFixed(2)]})]})]})]},v.id)})})]},f))}),e.jsx(o$,{isOpen:r,onClose:()=>o(!1),itens:l,categorias:a})]})},l$=()=>{const t=Xs(),{inventory:s,inventoryCategories:a,loadFullInventory:r}=Tt(),[o,l]=y.useState(""),[c,u]=y.useState(""),[h,f]=y.useState({}),[p,g]=y.useState(!1),v=y.useMemo(()=>s.filter(S=>{const T=S.name.toLowerCase().includes(o.toLowerCase()),M=!c||S.categoryId===c;return T&&M}),[s,o,c]),b=y.useMemo(()=>Object.values(h).filter(S=>S.selecionado),[h]),_=y.useMemo(()=>b.reduce((S,T)=>S+T.valorTotal,0),[b]),w=(S,T)=>{f(M=>{var $,A,z;return{...M,[S]:{...M[S],id:S,selecionado:T,quantidadeComprada:(($=M[S])==null?void 0:$.quantidadeComprada)||1,valorUnitario:((A=M[S])==null?void 0:A.valorUnitario)||0,valorTotal:((z=M[S])==null?void 0:z.valorTotal)||0}}})},E=(S,T)=>{T<0||f(M=>{const $=M[S]||{id:S,selecionado:!1,quantidadeComprada:0,valorUnitario:0,valorTotal:0},A=T*$.valorUnitario;return{...M,[S]:{...$,quantidadeComprada:T,valorTotal:A}}})},k=(S,T)=>{T<0||f(M=>{const $=M[S]||{id:S,selecionado:!1,quantidadeComprada:0,valorUnitario:0,valorTotal:0},A=$.quantidadeComprada*T;return{...M,[S]:{...$,valorUnitario:T,valorTotal:A}}})},N=async()=>{var S;g(!0);try{console.log("🚀 Iniciando atualização massiva..."),console.log("📋 Itens selecionados:",b);const{data:{user:T}}=await B.auth.getUser();if(!T){alert("Você precisa estar logado para atualizar o estoque."),g(!1);return}const{data:M,error:$}=await B.from("inventory_items").select("*").in("id",b.map(L=>L.id));if($){console.error("❌ Erro ao buscar itens atuais:",$),alert("Erro ao buscar dados atualizados. Tente novamente."),g(!1);return}console.log("✅ Itens do banco:",M);const A=(S=M==null?void 0:M[0])==null?void 0:S.empresa_id;if(!A){alert("Erro ao identificar a empresa dos itens."),g(!1);return}const z=b.map(async L=>{const I=M==null?void 0:M.find(Y=>Y.id===L.id);if(!I){console.error("❌ Item não encontrado no banco:",L.id);return}const X=I.current_stock,ce=X+L.quantidadeComprada,J=L.valorUnitario>0?L.valorUnitario:I.cost;console.log(`📦 Atualizando ${I.name}:`,{estoqueAtual:X,quantidadeComprada:L.quantidadeComprada,novoEstoque:ce,formula:`${X} + ${L.quantidadeComprada} = ${ce}`});const{error:V}=await B.from("inventory_items").update({current_stock:ce,cost:J,last_updated:new Date().toISOString()}).eq("id",I.id);if(V)throw console.error(`❌ Erro ao atualizar ${I.name}:`,V),V;console.log(`✅ ${I.name} atualizado com sucesso!`)});await Promise.all(z),console.log("✅ Todos os itens foram atualizados com sucesso!"),console.log("📝 Registrando movimentações no histórico...");const R=b.map(async L=>{const I=M==null?void 0:M.find(J=>J.id===L.id);if(!I)return;const X=I.current_stock,ce=X+L.quantidadeComprada;try{const{error:J}=await B.from("inventory_movements").insert({inventory_item_id:L.id,movement_type:"entrada_compra",quantity:L.quantidadeComprada,unit_cost:L.valorUnitario>0?L.valorUnitario:I.cost||0,stock_before:X,stock_after:ce,notes:`Atualização massiva - Compra de ${L.quantidadeComprada} ${I.unit}`,created_by:T.id,empresa_id:A,created_at:new Date().toISOString()});J?console.error("⚠️ Erro ao registrar movimentação:",J):console.log(`✅ Movimentação registrada para ${I.name}`)}catch(J){console.error("⚠️ Erro ao registrar movimentação:",J)}});await Promise.all(R),f({}),await r(),alert(`${b.length} itens atualizados com sucesso!`)}catch(T){console.error("Erro ao atualizar estoque:",T),alert("Erro ao atualizar estoque. Tente novamente.")}finally{g(!1)}},C=S=>h[S]||{id:S,selecionado:!1,quantidadeComprada:1,valorUnitario:0,valorTotal:0};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("button",{onClick:()=>t("/inventory"),className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(fo,{size:20,className:"text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Atualização Massiva de Estoque"}),e.jsx("p",{className:"text-gray-600",children:"Selecione os itens comprados e atualize o estoque em lote"})]})]}),b.length>0&&e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:N,disabled:p,className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2 disabled:opacity-50",children:[e.jsx(oo,{size:20}),e.jsx("span",{children:p?"Salvando...":`Salvar ${b.length} Itens`})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Xa,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar produtos...",value:o,onChange:S=>l(S.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:c,onChange:S=>u(S.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todas as categorias"}),a.map(S=>e.jsx("option",{value:S.id,children:S.name},S.id))]}),e.jsxs("button",{onClick:()=>{const S=v.filter(M=>M.currentStock<=M.minStock),T={...h};S.forEach(M=>{const $=Math.max(M.minStock*2-M.currentStock,M.minStock);T[M.id]={id:M.id,selecionado:!0,quantidadeComprada:$,valorUnitario:M.cost||0,valorTotal:$*(M.cost||0)}}),f(T)},className:"bg-orange-600 text-white px-4 py-2 rounded-lg hover:bg-orange-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(Ka,{size:16}),e.jsx("span",{children:"Selecionar Estoque Baixo"})]}),e.jsxs("button",{onClick:()=>f({}),className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(nt,{size:16}),e.jsx("span",{children:"Limpar Seleção"})]})]})}),b.length>0&&e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:b.length}),e.jsx("p",{className:"text-blue-800 text-sm",children:"Itens Selecionados"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:b.reduce((S,T)=>S+T.quantidadeComprada,0)}),e.jsx("p",{className:"text-blue-800 text-sm",children:"Quantidade Total"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("p",{className:"text-2xl font-bold text-blue-600",children:["R$ ",_.toFixed(2)]}),e.jsx("p",{className:"text-blue-800 text-sm",children:"Valor Total"})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md overflow-hidden",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-800",children:["Produtos Disponíveis (",v.length,")"]})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Selecionar"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Produto"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Estoque Atual"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Quantidade Comprada"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor Unitário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Novo Estoque"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:v.map(S=>{const T=C(S.id),M=a.find(A=>A.id===S.categoryId),$=S.currentStock+(T.selecionado?T.quantidadeComprada:0);return e.jsxs("tr",{className:T.selecionado?"bg-blue-50":"",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("input",{type:"checkbox",checked:T.selecionado,onChange:A=>w(S.id,A.target.checked),className:"h-4 w-4 text-blue-600 focus:ring-blue-500 border-gray-300 rounded"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:S.name}),e.jsx("div",{className:"text-sm text-gray-500",children:M==null?void 0:M.name})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("span",{className:`text-sm font-medium ${S.currentStock<=S.minStock?"text-red-600":"text-gray-900"}`,children:[S.currentStock," ",S.unit]}),S.currentStock<=S.minStock&&e.jsx("div",{className:"text-xs text-red-500",children:"Estoque baixo"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:T.selecionado?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>E(S.id,T.quantidadeComprada-1),className:"p-1 hover:bg-gray-200 rounded",children:e.jsx(Ii,{size:16})}),e.jsx("input",{type:"number",min:"0",value:T.quantidadeComprada,onChange:A=>E(S.id,parseInt(A.target.value)||0),className:"w-20 px-2 py-1 text-center border border-gray-300 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("button",{onClick:()=>E(S.id,T.quantidadeComprada+1),className:"p-1 hover:bg-gray-200 rounded",children:e.jsx($s,{size:16})}),e.jsx("span",{className:"text-sm text-gray-500",children:S.unit})]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:T.selecionado?e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm",children:"R$"}),e.jsx("input",{type:"number",min:"0",step:"0.01",value:T.valorUnitario,onChange:A=>k(S.id,parseFloat(A.target.value)||0),className:"w-24 px-2 py-1 border border-gray-300 rounded focus:ring-2 focus:ring-blue-500",placeholder:"0,00"})]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:T.selecionado?e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["R$ ",T.valorTotal.toFixed(2)]}):e.jsx("span",{className:"text-gray-400",children:"-"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsxs("span",{className:`text-sm font-medium ${T.selecionado?"text-green-600":"text-gray-500"}`,children:[$," ",S.unit]}),T.selecionado&&T.quantidadeComprada>0&&e.jsxs("div",{className:"text-xs text-green-500",children:["+",T.quantidadeComprada," ",S.unit]})]})]},S.id)})})]})}),v.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Ka,{className:"mx-auto h-12 w-12 text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhum produto encontrado"})]})]})]})},c$={entrada_compra:"Compra",entrada_ajuste:"Ajuste de Entrada",entrada_devolucao:"Devolução",saida_venda:"Venda",saida_perda:"Perda/Quebra",saida_ajuste:"Ajuste de Saída",saida_transferencia:"Transferência"};function d$(){const[t,s]=y.useState([]),[a,r]=y.useState(!0),[o,l]=y.useState("all"),[c,u]=y.useState(""),[h,f]=y.useState(""),[p,g]=y.useState("");y.useEffect(()=>{v()},[o,c,h,p]);const v=async()=>{r(!0);try{console.log("🔍 Carregando movimentações...");let w=B.from("inventory_movements").select(`
          *,
          inventory_item:inventory_items(name, unit)
        `).order("created_at",{ascending:!1}).limit(100);if(o!=="all"&&(o==="entrada"?w=w.like("movement_type","entrada_%"):o==="saida"&&(w=w.like("movement_type","saida_%"))),h&&(w=w.gte("created_at",new Date(h).toISOString())),p){const N=new Date(p);N.setHours(23,59,59),w=w.lte("created_at",N.toISOString())}const{data:E,error:k}=await w;if(console.log("📊 Resultado da query:",{data:E,error:k,count:E==null?void 0:E.length}),k)throw console.error("❌ Erro na query:",k),k;s(E||[]),console.log("✅ Movimentações carregadas:",(E==null?void 0:E.length)||0)}catch(w){console.error("❌ Erro ao carregar movimentações:",w)}finally{r(!1)}},b={totalEntradas:t.filter(w=>w.movement_type.startsWith("entrada_")).length,totalSaidas:t.filter(w=>w.movement_type.startsWith("saida_")).length,quantidadeEntrada:t.filter(w=>w.movement_type.startsWith("entrada_")).reduce((w,E)=>w+Number(E.quantity),0),quantidadeSaida:t.filter(w=>w.movement_type.startsWith("saida_")).reduce((w,E)=>w+Number(E.quantity),0)},_=w=>w.startsWith("entrada_");return e.jsx("div",{className:"min-h-screen bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Movimentações de Estoque"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Histórico completo de entradas e saídas"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Entradas"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:b.totalEntradas})]}),e.jsx(Sa,{className:"h-8 w-8 text-green-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Saídas"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:b.totalSaidas})]}),e.jsx(Wu,{className:"h-8 w-8 text-red-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Qtd. Entrada"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:b.quantidadeEntrada.toFixed(2)})]}),e.jsx(Nj,{className:"h-8 w-8 text-green-600"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Qtd. Saída"}),e.jsx("p",{className:"text-2xl font-bold text-red-600",children:b.quantidadeSaida.toFixed(2)})]}),e.jsx(_j,{className:"h-8 w-8 text-red-600"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(vg,{className:"h-5 w-5 text-gray-500"}),e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Filtros"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tipo"}),e.jsxs("select",{value:o,onChange:w=>l(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"all",children:"Todos"}),e.jsx("option",{value:"entrada",children:"Entradas"}),e.jsx("option",{value:"saida",children:"Saídas"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Inicial"}),e.jsx("input",{type:"date",value:h,onChange:w=>f(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data Final"}),e.jsx("input",{type:"date",value:p,onChange:w=>g(w.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>{l("all"),u(""),f(""),g("")},className:"w-full px-4 py-2 text-gray-700 bg-gray-100 hover:bg-gray-200 rounded-lg transition-colors",children:"Limpar Filtros"})})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-4 border-b border-gray-200",children:e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Movimentações (",t.length,")"]})}),a?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):t.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Ka,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhuma movimentação encontrada"})]}):e.jsx("div",{className:"divide-y divide-gray-200",children:t.map(w=>{var k,N;const E=_(w.movement_type);return e.jsx("div",{className:"p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"flex-shrink-0 mt-1",children:E?e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(Nj,{className:"h-6 w-6 text-green-600"})}):e.jsx("div",{className:"p-2 bg-red-100 rounded-lg",children:e.jsx(_j,{className:"h-6 w-6 text-red-600"})})}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${E?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:c$[w.movement_type]||w.movement_type}),e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:((k=w.inventory_item)==null?void 0:k.name)||"Item não encontrado"})]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 mt-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Quantidade:"}),e.jsxs("span",{className:"ml-2 font-medium text-gray-900",children:[w.quantity," ",((N=w.inventory_item)==null?void 0:N.unit)||""]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Estoque:"}),e.jsxs("span",{className:"ml-2 font-medium text-gray-900",children:[w.stock_before," → ",w.stock_after]})]}),w.unit_cost&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Custo Unit.:"}),e.jsxs("span",{className:"ml-2 font-medium text-gray-900",children:["R$ ",Number(w.unit_cost).toFixed(2)]})]}),w.total_cost&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Custo Total:"}),e.jsxs("span",{className:"ml-2 font-medium text-gray-900",children:["R$ ",Number(w.total_cost).toFixed(2)]})]})]}),(w.reference_document||w.notes)&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600 space-y-1",children:[w.reference_document&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Referência:"})," ",w.reference_document]}),w.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Obs:"})," ",w.notes]})]})]}),e.jsxs("div",{className:"flex-shrink-0 text-right",children:[e.jsx("div",{className:"text-sm text-gray-500",children:wt(new Date(w.created_at),"dd/MM/yyyy",{locale:Wt})}),e.jsx("div",{className:"text-xs text-gray-400",children:wt(new Date(w.created_at),"HH:mm",{locale:Wt})})]})]})})]})},w.id)})})]})]})})}const u$=({isOpen:t,onClose:s,member:a})=>{const{addMember:r,updateMember:o}=Tt(),{register:l,handleSubmit:c,control:u,reset:h,formState:{errors:f}}=Rg(),[p,g]=y.useState(!1);y.useEffect(()=>{h(a||{name:"",email:"",phone:"",avatar:`https://api.dicebear.com/8.x/initials/svg?seed=${name||"user"}`,status:"active",membershipType:"individual"})},[a,h]);const v=async w=>{g(!0);try{a?await o({...a,...w}):await r(w),s()}catch(E){console.error("Falha ao salvar o sócio:",E)}finally{g(!1)}},b=["active","inactive","pending"],_=["individual","family","vip"];return e.jsx(Ws,{children:t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs(be.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"bg-white rounded-lg shadow-xl w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800",children:a?"Editar Sócio":"Novo Sócio"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx(nt,{size:24})})]}),e.jsxs("form",{onSubmit:c(v),className:"p-6 space-y-4",children:[e.jsx(fi,{label:"Nome Completo",error:f.name,children:e.jsx("input",{...l("name",{required:"Nome é obrigatório"}),className:"form-input",disabled:p})}),e.jsx(fi,{label:"Email",error:f.email,children:e.jsx("input",{type:"email",...l("email",{required:"Email é obrigatório",pattern:{value:/^\S+@\S+$/i,message:"Email inválido"}}),className:"form-input",disabled:p})}),e.jsx(fi,{label:"Telefone",error:f.phone,children:e.jsx("input",{...l("phone",{required:"Telefone é obrigatório"}),className:"form-input",disabled:p})}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsx(fi,{label:"Status",error:f.status,children:e.jsx(ro,{name:"status",control:u,render:({field:w})=>e.jsx("select",{...w,className:"form-input",disabled:p,children:b.map(E=>e.jsx("option",{value:E,className:"capitalize",children:E},E))})})}),e.jsx(fi,{label:"Tipo de Plano",error:f.membershipType,children:e.jsx(ro,{name:"membershipType",control:u,render:({field:w})=>e.jsx("select",{...w,className:"form-input",disabled:p,children:_.map(E=>e.jsx("option",{value:E,className:"capitalize",children:E},E))})})})]}),e.jsx(fi,{label:"URL do Avatar",error:f.avatar,children:e.jsx("input",{...l("avatar"),className:"form-input",disabled:p})}),e.jsxs("div",{className:"pt-4 flex justify-end space-x-3",children:[e.jsx("button",{type:"button",onClick:s,className:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300",disabled:p,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:bg-blue-400 disabled:cursor-wait",disabled:p,children:p?"Salvando...":a?"Salvar Alterações":"Adicionar Sócio"})]})]})]})})})},fi=({label:t,children:s,error:a})=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:t}),s,a&&e.jsx("p",{className:"text-red-500 text-xs mt-1",children:a.message})]}),m$=({member:t,onEdit:s})=>{const a={active:"bg-green-100 text-green-800",inactive:"bg-red-100 text-red-800",pending:"bg-yellow-100 text-yellow-800"},r={active:"Ativo",inactive:"Inativo",pending:"Pendente"};return e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-white border border-gray-200 rounded-lg p-4 text-center hover:shadow-xl transition-shadow flex flex-col",children:[e.jsxs("div",{className:"relative self-center",children:[e.jsx("img",{src:t.avatar,alt:t.name,className:"w-24 h-24 rounded-full mx-auto mb-4 object-cover"}),e.jsx("span",{className:`absolute bottom-1 right-1 block h-4 w-4 rounded-full border-2 border-white ${t.status==="active"?"bg-green-500":t.status==="inactive"?"bg-red-500":"bg-yellow-500"}`})]}),e.jsx("h3",{className:"font-bold text-lg text-gray-800",children:t.name}),e.jsx("p",{className:`text-xs font-medium px-2 py-0.5 rounded-full self-center my-2 ${a[t.status]}`,children:r[t.status]}),e.jsx("div",{className:"text-sm text-gray-600 capitalize mb-4",children:t.membershipType}),e.jsxs("div",{className:"text-left space-y-2 text-xs text-gray-500 border-t pt-3 mt-auto",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ki,{size:14}),e.jsx("span",{children:t.email})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Zu,{size:14}),e.jsx("span",{children:t.phone})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Mr,{size:14}),e.jsxs("span",{children:["Sócio desde ",wt(t.joinDate,"MMM yyyy",{locale:Wt})]})]})]}),e.jsxs("button",{onClick:()=>s(t),className:"mt-4 w-full bg-gray-100 text-gray-700 py-2 rounded-lg text-sm font-medium hover:bg-gray-200 transition-colors flex items-center justify-center space-x-2",children:[e.jsx(lo,{size:14}),e.jsx("span",{children:"Editar Perfil"})]})]})},h$=()=>{const{members:t}=Tt(),[s,a]=y.useState(!1),[r,o]=y.useState(null),[l,c]=y.useState(""),[u,h]=y.useState("all"),f=_=>{o(_),a(!0)},p=()=>{o(null),a(!0)},g=()=>{a(!1),o(null)},v=y.useMemo(()=>t.filter(_=>{const w=_.name.toLowerCase().includes(l.toLowerCase()),E=u==="all"||_.status===u;return w&&E}),[t,l,u]),b=y.useMemo(()=>{const _=zP(new Date);return{total:t.length,active:t.filter(w=>w.status==="active").length,newThisMonth:t.filter(w=>PP(w.joinDate,_)).length}},[t]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"flex flex-col sm:flex-row sm:items-center sm:justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800 mb-2",children:"Sócios do Clube"}),e.jsx("p",{className:"text-gray-600",children:"Gestão completa de sócios do clube"})]}),e.jsxs(be.button,{whileHover:{scale:1.02},whileTap:{scale:.98},onClick:p,className:"bg-blue-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-blue-700 transition-colors flex items-center space-x-2 mt-4 sm:mt-0",children:[e.jsx($s,{size:20}),e.jsx("span",{children:"Novo Sócio"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(Sp,{icon:Ns,title:"Total de Sócios",value:b.total,color:"blue"}),e.jsx(Sp,{icon:t2,title:"Sócios Ativos",value:b.active,color:"green"}),e.jsx(Sp,{icon:Mu,title:"Novos (Último Mês)",value:b.newThisMonth,color:"purple"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-md p-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800 mb-4 sm:mb-0",children:"Lista de Sócios"}),e.jsxs("div",{className:"flex flex-col sm:flex-row space-y-2 sm:space-y-0 sm:space-x-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(Xa,{size:20,className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar sócios...",value:l,onChange:_=>c(_.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:u,onChange:_=>h(_.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"active",children:"Ativo"}),e.jsx("option",{value:"inactive",children:"Inativo"}),e.jsx("option",{value:"pending",children:"Pendente"})]})]})]}),e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-6",children:v.map(_=>e.jsx(m$,{member:_,onEdit:f},_.id))}),v.length===0&&e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhum sócio encontrado"})})]}),s&&e.jsx(u$,{isOpen:s,onClose:g,member:r})]})},Sp=({icon:t,title:s,value:a,color:r})=>{const o={green:"bg-green-100 text-green-600",blue:"bg-blue-100 text-blue-600",purple:"bg-purple-100 text-purple-600"};return e.jsx("div",{className:"bg-white rounded-lg shadow-md p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-800 mb-1",children:s}),e.jsx("p",{className:`text-3xl font-bold text-${r}-600`,children:a})]}),e.jsx("div",{className:`p-3 rounded-full ${o[r]}`,children:e.jsx(t,{className:"w-6 h-6"})})]})})},Ki=()=>{const[t,s]=y.useState([]),[a,r]=y.useState(!0),[o,l]=y.useState(null),c=async()=>{try{r(!0),console.log("useComandas - Fetching comandas...");const{data:R,error:L}=await B.from("comandas").select(`
          *,
          bar_tables (
            id,
            number,
            capacity
          ),
          comanda_items (
            *,
            menu_items (
              name,
              price,
              category
            )
          )
        `).order("created_at",{ascending:!1});if(console.log("useComandas - Query result:",{data:R,error:L}),L)throw L;s(R||[]),console.log("useComandas - Comandas set:",R||[])}catch(R){console.error("useComandas - Error:",R),l(R instanceof Error?R.message:"Erro ao carregar comandas")}finally{r(!1)}},u=async R=>{try{console.log("🔄 createComanda chamada com dados:",R);const{data:{user:L}}=await B.auth.getUser();if(!L)throw new Error("Usuário não autenticado");const{data:I,error:X}=await B.from("usuarios_empresa").select("empresa_id").eq("user_id",L.id).eq("status","ativo").single();if(X||!I)throw new Error("Empresa do usuário não encontrada");const ce={...R,status:"open",opened_at:new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString(),empresa_id:I.empresa_id};console.log("📝 Dados que serão inseridos:",ce);const{data:J,error:V}=await B.from("comandas").insert(ce).select().single();if(V)throw V;return s(Y=>[J,...Y]),J}catch(L){throw new Error(L instanceof Error?L.message:"Erro ao criar comanda")}},h=async(R,L)=>{try{const{data:I,error:X}=await B.from("comandas").update({...L,updated_at:new Date().toISOString()}).eq("id",R).select().single();if(X)throw X;return s(ce=>ce.map(J=>J.id===R?I:J)),I}catch(I){throw new Error(I instanceof Error?I.message:"Erro ao atualizar comanda")}},f=async(R,L)=>{try{const{data:I,error:X}=await B.from("comandas").update({status:"closed",closed_at:new Date().toISOString(),payment_method:L,updated_at:new Date().toISOString()}).eq("id",R).select().single();if(X)throw X;return s(ce=>ce.map(J=>J.id===R?I:J)),I}catch(I){throw new Error(I instanceof Error?I.message:"Erro ao fechar comanda")}},p=async(R,L)=>{try{const I=R.map(V=>B.from("comandas").update({status:"closed",closed_at:new Date().toISOString(),payment_method:L,updated_at:new Date().toISOString()}).eq("id",V).select().single()),X=await Promise.all(I),ce=X.filter(V=>V.error);if(ce.length>0)throw new Error(`Erro ao finalizar ${ce.length} comandas`);const J=X.map(V=>V.data).filter(Boolean);return s(V=>V.map(Y=>J.find(we=>(we==null?void 0:we.id)===Y.id)||Y)),J}catch(I){throw new Error(I instanceof Error?I.message:"Erro ao finalizar comandas pagas")}},g=async R=>{try{const{error:L}=await B.from("comandas").delete().eq("id",R);if(L)throw L;s(I=>I.filter(X=>X.id!==R))}catch(L){throw new Error(L instanceof Error?L.message:"Erro ao excluir comanda")}},v=R=>t.filter(L=>L.table_id===R),b=R=>t.filter(L=>L.table_id===R&&L.status==="open"),_=R=>t.filter(L=>L.table_id===R&&L.status==="pending_payment"),w=async(R,L,I,X)=>u({table_id:R,employee_id:L,customer_name:I,people_count:X}),E=async(R,L)=>h(R,{table_id:L}),k=async(R,L)=>{try{console.warn("Função mergeComandas temporariamente desabilitada devido a limitações de tipo"),await g(R)}catch(I){throw new Error(I instanceof Error?I.message:"Erro ao mesclar comandas")}},N=async R=>{try{return console.warn("Função recalculateComandaTotal temporariamente simplificada devido a limitações de tipo"),h(R,{total:0})}catch(L){throw new Error(L instanceof Error?L.message:"Erro ao recalcular total")}},C=R=>t.find(L=>L.id===R),S=()=>t.filter(R=>R.status==="open"),T=R=>t.filter(L=>L.status===R),M=R=>t.filter(L=>L.employee_id===R),$=R=>t.filter(L=>{var I;return(I=L.customer_name)==null?void 0:I.toLowerCase().includes(R.toLowerCase())}),A=()=>t.filter(R=>R.status==="closed").reduce((R,L)=>R+(L.total||0),0),z=()=>{const R=t.filter(I=>I.status==="closed");return R.length===0?0:R.reduce((I,X)=>I+(X.total||0),0)/R.length};return y.useEffect(()=>{c();const R=B.channel("comandas_changes").on("postgres_changes",{event:"*",schema:"public",table:"comandas"},L=>{console.log("Mudança em comandas:",L),L.eventType==="INSERT"?s(I=>[L.new,...I]):L.eventType==="UPDATE"?s(I=>I.map(X=>X.id===L.new.id?L.new:X)):L.eventType==="DELETE"&&s(I=>I.filter(X=>X.id!==L.old.id))}).subscribe();return()=>{R.unsubscribe()}},[]),{comandas:t,loading:a,error:o,refetch:c,createComanda:u,updateComanda:h,closeComanda:f,deleteComanda:g,finalizarComandasPagas:p,getComandasByTableId:v,getOpenComandasByTableId:b,getPendingPaymentComandasByTableId:_,createComandaForTable:w,transferComandaToTable:E,mergeComandas:k,recalculateComandaTotal:N,getComandaById:C,getOpenComandas:S,getComandasByStatus:T,getComandasByEmployee:M,getComandasByCustomer:$,getTotalSales:A,getAverageComandaValue:z}},f$=({mode:t,onModeChange:s,user:a})=>{const r={balcao:"Balcão",mesas:"Mesas",comandas:"Comandas",fila:"Fila",pedidos:"Preparo"},o={balcao:"Balcão",mesas:"Mesas",comandas:"Comandas",fila:"Fila de Pedidos",pedidos:"Pedidos Bar"},l={balcao:"🍺",mesas:"🪑",comandas:"📋",fila:"⏱️",pedidos:"🥃"};return e.jsx("header",{className:"bg-white shadow-sm border-b border-gray-200 sticky top-0 z-10",children:e.jsx("div",{className:"px-2 sm:px-4 lg:px-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row lg:justify-between lg:items-center py-3 space-y-3 lg:space-y-0 min-h-16",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:space-x-4 min-w-0 flex-1",children:[e.jsxs("h1",{className:"text-base sm:text-lg lg:text-xl font-semibold text-gray-900 truncate",children:[e.jsx("span",{className:"hidden sm:inline",children:"Sistema de Atendimento - "}),"Bar"]}),a&&e.jsxs("span",{className:"text-xs sm:text-sm text-gray-500 mt-1 sm:mt-0 truncate",children:[e.jsx("span",{className:"hidden sm:inline",children:"Atendente: "}),a.full_name||a.name||"Usuário"]})]}),e.jsx("nav",{className:"flex flex-wrap gap-1 sm:gap-2",children:Object.keys(r).map(c=>e.jsxs("button",{onClick:()=>s(c),className:`
                  flex items-center space-x-1 sm:space-x-2 px-2 sm:px-3 py-2 rounded-lg font-medium transition-colors text-xs sm:text-sm
                  ${t===c?"bg-blue-100 text-blue-700 border border-blue-200":"text-gray-600 hover:text-gray-900 hover:bg-gray-100"}
                `,children:[e.jsx("span",{className:"text-sm sm:text-lg",children:l[c]}),e.jsx("span",{className:"hidden sm:inline",children:o[c]}),e.jsx("span",{className:"sm:hidden",children:r[c]})]},c))})]})})})};function p$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.023 9.348h4.992v-.001M2.985 19.644v-4.992m0 0h4.992m-4.993 0 3.181 3.183a8.25 8.25 0 0 0 13.803-3.7M4.031 9.865a8.25 8.25 0 0 1 13.803-3.7l3.181 3.182m0-4.991v4.99"}))}const Qj=y.forwardRef(p$);function g$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.75 3.75v4.5m0-4.5h4.5m-4.5 0L9 9M3.75 20.25v-4.5m0 4.5h4.5m-4.5 0L9 15M20.25 3.75h-4.5m4.5 0v4.5m0-4.5L15 9m5.25 11.25h-4.5m4.5 0v-4.5m0 4.5L15 15"}))}const Jj=y.forwardRef(g$);function x$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3 13.125C3 12.504 3.504 12 4.125 12h2.25c.621 0 1.125.504 1.125 1.125v6.75C7.5 20.496 6.996 21 6.375 21h-2.25A1.125 1.125 0 0 1 3 19.875v-6.75ZM9.75 8.625c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125v11.25c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V8.625ZM16.5 4.125c0-.621.504-1.125 1.125-1.125h2.25C20.496 3 21 3.504 21 4.125v15.75c0 .621-.504 1.125-1.125 1.125h-2.25a1.125 1.125 0 0 1-1.125-1.125V4.125Z"}))}const V2=y.forwardRef(x$);function y$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 12.76c0 1.6 1.123 2.994 2.707 3.227 1.087.16 2.185.283 3.293.369V21l4.076-4.076a1.526 1.526 0 0 1 1.037-.443 48.282 48.282 0 0 0 5.68-.494c1.584-.233 2.707-1.626 2.707-3.228V6.741c0-1.602-1.123-2.995-2.707-3.228A48.394 48.394 0 0 0 12 3c-2.392 0-4.744.175-7.043.513C3.373 3.746 2.25 5.14 2.25 6.741v6.018Z"}))}const b$=y.forwardRef(y$);function v$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9 12.75 11.25 15 15 9.75M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Ga=y.forwardRef(v$);function w$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m4.5 12.75 6 6 9-13.5"}))}const j$=y.forwardRef(w$);function _$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v6h4.5m4.5 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const Za=y.forwardRef(_$);function N$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.325.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 0 1 1.37.49l1.296 2.247a1.125 1.125 0 0 1-.26 1.431l-1.003.827c-.293.241-.438.613-.43.992a7.723 7.723 0 0 1 0 .255c-.008.378.137.75.43.991l1.004.827c.424.35.534.955.26 1.43l-1.298 2.247a1.125 1.125 0 0 1-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.47 6.47 0 0 1-.22.128c-.331.183-.581.495-.644.869l-.213 1.281c-.09.543-.56.94-1.11.94h-2.594c-.55 0-1.019-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 0 1-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 0 1-1.369-.49l-1.297-2.247a1.125 1.125 0 0 1 .26-1.431l1.004-.827c.292-.24.437-.613.43-.991a6.932 6.932 0 0 1 0-.255c.007-.38-.138-.751-.43-.992l-1.004-.827a1.125 1.125 0 0 1-.26-1.43l1.297-2.247a1.125 1.125 0 0 1 1.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.086.22-.128.332-.183.582-.495.644-.869l.214-1.28Z"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const e_=y.forwardRef(N$);function S$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 6v12m-3-2.818.879.659c1.171.879 3.07.879 4.242 0 1.172-.879 1.172-2.303 0-3.182C13.536 12.219 12.768 12 12 12c-.725 0-1.45-.22-2.003-.659-1.106-.879-1.106-2.303 0-3.182s2.9-.879 4.006 0l.415.33M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const q2=y.forwardRef(S$);function E$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19.5 14.25v-2.625a3.375 3.375 0 0 0-3.375-3.375h-1.5A1.125 1.125 0 0 1 13.5 7.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 0 0-9-9Z"}))}const ln=y.forwardRef(E$);function C$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M21.75 6.75v10.5a2.25 2.25 0 0 1-2.25 2.25h-15a2.25 2.25 0 0 1-2.25-2.25V6.75m19.5 0A2.25 2.25 0 0 0 19.5 4.5h-15a2.25 2.25 0 0 0-2.25 2.25m19.5 0v.243a2.25 2.25 0 0 1-1.07 1.916l-7.5 4.615a2.25 2.25 0 0 1-2.36 0L3.32 8.91a2.25 2.25 0 0 1-1.07-1.916V6.75"}))}const T$=y.forwardRef(C$);function k$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v3.75m-9.303 3.376c-.866 1.5.217 3.374 1.948 3.374h14.71c1.73 0 2.813-1.874 1.948-3.374L13.949 3.378c-.866-1.5-3.032-1.5-3.898 0L2.697 16.126ZM12 15.75h.007v.008H12v-.008Z"}))}const _r=y.forwardRef(k$);function A$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.98 8.223A10.477 10.477 0 0 0 1.934 12C3.226 16.338 7.244 19.5 12 19.5c.993 0 1.953-.138 2.863-.395M6.228 6.228A10.451 10.451 0 0 1 12 4.5c4.756 0 8.773 3.162 10.065 7.498a10.522 10.522 0 0 1-4.293 5.774M6.228 6.228 3 3m3.228 3.228 3.65 3.65m7.894 7.894L21 21m-3.228-3.228-3.65-3.65m0 0a3 3 0 1 0-4.243-4.243m4.242 4.242L9.88 9.88"}))}const M$=y.forwardRef(A$);function R$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.036 12.322a1.012 1.012 0 0 1 0-.639C3.423 7.51 7.36 4.5 12 4.5c4.638 0 8.573 3.007 9.963 7.178.07.207.07.431 0 .639C20.577 16.49 16.64 19.5 12 19.5c-4.638 0-8.573-3.007-9.963-7.178Z"}),y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15 12a3 3 0 1 1-6 0 3 3 0 0 1 6 0Z"}))}const O$=y.forwardRef(R$);function D$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0ZM3.75 12h.007v.008H3.75V12Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Zm-.375 5.25h.007v.008H3.75v-.008Zm.375 0a.375.375 0 1 1-.75 0 .375.375 0 0 1 .75 0Z"}))}const P$=y.forwardRef(D$);function z$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m21 21-5.197-5.197m0 0A7.5 7.5 0 1 0 5.196 5.196a7.5 7.5 0 0 0 10.607 10.607Z"}))}const rm=y.forwardRef(z$);function $$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 12h14"}))}const I$=y.forwardRef($$);function L$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L6.832 19.82a4.5 4.5 0 0 1-1.897 1.13l-2.685.8.8-2.685a4.5 4.5 0 0 1 1.13-1.897L16.863 4.487Zm0 0L19.5 7.125"}))}const Nm=y.forwardRef(L$);function U$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M2.25 6.75c0 8.284 6.716 15 15 15h2.25a2.25 2.25 0 0 0 2.25-2.25v-1.372c0-.516-.351-.966-.852-1.091l-4.423-1.106c-.44-.11-.902.055-1.173.417l-.97 1.293c-.282.376-.769.542-1.21.38a12.035 12.035 0 0 1-7.143-7.143c-.162-.441.004-.928.38-1.21l1.293-.97c.363-.271.527-.734.417-1.173L6.963 3.102a1.125 1.125 0 0 0-1.091-.852H4.5A2.25 2.25 0 0 0 2.25 4.5v2.25Z"}))}const _0=y.forwardRef(U$);function B$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 4.5v15m7.5-7.5h-15"}))}const Ui=y.forwardRef(B$);function V$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6.72 13.829c-.24.03-.48.062-.72.096m.72-.096a42.415 42.415 0 0 1 10.56 0m-10.56 0L6.34 18m10.94-4.171c.24.03.48.062.72.096m-.72-.096L17.66 18m0 0 .229 2.523a1.125 1.125 0 0 1-1.12 1.227H7.231c-.662 0-1.18-.568-1.12-1.227L6.34 18m11.318 0h1.091A2.25 2.25 0 0 0 21 15.75V9.456c0-1.081-.768-2.015-1.837-2.175a48.055 48.055 0 0 0-1.913-.247M6.34 18H5.25A2.25 2.25 0 0 1 3 15.75V9.456c0-1.081.768-2.015 1.837-2.175a48.041 48.041 0 0 1 1.913-.247m10.5 0a48.536 48.536 0 0 0-10.5 0m10.5 0V3.375c0-.621-.504-1.125-1.125-1.125h-8.25c-.621 0-1.125.504-1.125 1.125v3.659M18 10.5h.008v.008H18V10.5Zm-3 0h.008v.008H15V10.5Z"}))}const q$=y.forwardRef(V$);function F$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M9.813 15.904 9 18.75l-.813-2.846a4.5 4.5 0 0 0-3.09-3.09L2.25 12l2.846-.813a4.5 4.5 0 0 0 3.09-3.09L9 5.25l.813 2.846a4.5 4.5 0 0 0 3.09 3.09L15.75 12l-2.846.813a4.5 4.5 0 0 0-3.09 3.09ZM18.259 8.715 18 9.75l-.259-1.035a3.375 3.375 0 0 0-2.455-2.456L14.25 6l1.036-.259a3.375 3.375 0 0 0 2.455-2.456L18 2.25l.259 1.035a3.375 3.375 0 0 0 2.456 2.456L21.75 6l-1.035.259a3.375 3.375 0 0 0-2.456 2.456ZM16.894 20.567 16.5 21.75l-.394-1.183a2.25 2.25 0 0 0-1.423-1.423L13.5 18.75l1.183-.394a2.25 2.25 0 0 0 1.423-1.423l.394-1.183.394 1.183a2.25 2.25 0 0 0 1.423 1.423l1.183.394-1.183.394a2.25 2.25 0 0 0-1.423 1.423Z"}))}const H$=y.forwardRef(F$);function G$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.48 3.499a.562.562 0 0 1 1.04 0l2.125 5.111a.563.563 0 0 0 .475.345l5.518.442c.499.04.701.663.321.988l-4.204 3.602a.563.563 0 0 0-.182.557l1.285 5.385a.562.562 0 0 1-.84.61l-4.725-2.885a.562.562 0 0 0-.586 0L6.982 20.54a.562.562 0 0 1-.84-.61l1.285-5.386a.562.562 0 0 0-.182-.557l-4.204-3.602a.562.562 0 0 1 .321-.988l5.518-.442a.563.563 0 0 0 .475-.345L11.48 3.5Z"}))}const Z$=y.forwardRef(G$);function W$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M3.375 19.5h17.25m-17.25 0a1.125 1.125 0 0 1-1.125-1.125M3.375 19.5h7.5c.621 0 1.125-.504 1.125-1.125m-9.75 0V5.625m0 12.75v-1.5c0-.621.504-1.125 1.125-1.125m18.375 2.625V5.625m0 12.75c0 .621-.504 1.125-1.125 1.125m1.125-1.125v-1.5c0-.621-.504-1.125-1.125-1.125m0 3.75h-7.5A1.125 1.125 0 0 1 12 18.375m9.75-12.75c0-.621-.504-1.125-1.125-1.125H3.375c-.621 0-1.125.504-1.125 1.125m19.5 0v1.5c0 .621-.504 1.125-1.125 1.125M2.25 5.625v1.5c0 .621.504 1.125 1.125 1.125m0 0h17.25m-17.25 0h7.5c.621 0 1.125.504 1.125 1.125M3.375 8.25c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125m17.25-3.75h-7.5c-.621 0-1.125.504-1.125 1.125m8.625-1.125c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125v1.5c0 .621.504 1.125 1.125 1.125M12 10.875v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 10.875c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125M13.125 12h7.5m-7.5 0c-.621 0-1.125.504-1.125 1.125M20.625 12c.621 0 1.125.504 1.125 1.125v1.5c0 .621-.504 1.125-1.125 1.125m-17.25 0h7.5M12 14.625v-1.5m0 1.5c0 .621-.504 1.125-1.125 1.125M12 14.625c0 .621.504 1.125 1.125 1.125m-2.25 0c.621 0 1.125.504 1.125 1.125m0 1.5v-1.5m0 0c0-.621.504-1.125 1.125-1.125m0 0h7.5"}))}const Y$=y.forwardRef(W$);function K$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m14.74 9-.346 9m-4.788 0L9.26 9m9.968-3.21c.342.052.682.107 1.022.166m-1.022-.165L18.16 19.673a2.25 2.25 0 0 1-2.244 2.077H8.084a2.25 2.25 0 0 1-2.244-2.077L4.772 5.79m14.456 0a48.108 48.108 0 0 0-3.478-.397m-12 .562c.34-.059.68-.114 1.022-.165m0 0a48.11 48.11 0 0 1 3.478-.397m7.5 0v-.916c0-1.18-.91-2.164-2.09-2.201a51.964 51.964 0 0 0-3.32 0c-1.18.037-2.09 1.022-2.09 2.201v.916m7.5 0a48.667 48.667 0 0 0-7.5 0"}))}const Sm=y.forwardRef(K$);function X$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18 18.72a9.094 9.094 0 0 0 3.741-.479 3 3 0 0 0-4.682-2.72m.94 3.198.001.031c0 .225-.012.447-.037.666A11.944 11.944 0 0 1 12 21c-2.17 0-4.207-.576-5.963-1.584A6.062 6.062 0 0 1 6 18.719m12 0a5.971 5.971 0 0 0-.941-3.197m0 0A5.995 5.995 0 0 0 12 12.75a5.995 5.995 0 0 0-5.058 2.772m0 0a3 3 0 0 0-4.681 2.72 8.986 8.986 0 0 0 3.74.477m.94-3.197a5.971 5.971 0 0 0-.94 3.197M15 6.75a3 3 0 1 1-6 0 3 3 0 0 1 6 0Zm6 3a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Zm-13.5 0a2.25 2.25 0 1 1-4.5 0 2.25 2.25 0 0 1 4.5 0Z"}))}const Wa=y.forwardRef(X$);function Q$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M15.75 6a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0ZM4.501 20.118a7.5 7.5 0 0 1 14.998 0A17.933 17.933 0 0 1 12 21.75c-2.676 0-5.216-.584-7.499-1.632Z"}))}const nm=y.forwardRef(Q$);function J$({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M11.42 15.17 17.25 21A2.652 2.652 0 0 0 21 17.25l-5.877-5.877M11.42 15.17l2.496-3.03c.317-.384.74-.626 1.208-.766M11.42 15.17l-4.655 5.653a2.548 2.548 0 1 1-3.586-3.586l6.837-5.63m5.108-.233c.55-.164 1.163-.188 1.743-.14a4.5 4.5 0 0 0 4.486-6.336l-3.276 3.277a3.004 3.004 0 0 1-2.25-2.25l3.276-3.276a4.5 4.5 0 0 0-6.336 4.486c.091 1.076-.071 2.264-.904 2.95l-.102.085m-1.745 1.437L5.909 7.5H4.5L2.25 3.75l1.5-1.5L7.5 4.5v1.409l4.26 4.26m-1.745 1.437 1.745-1.437m6.615 8.206L15.75 15.75M4.867 19.125h.008v.008h-.008v-.008Z"}))}const e7=y.forwardRef(J$);function t7({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"m9.75 9.75 4.5 4.5m0-4.5-4.5 4.5M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const s7=y.forwardRef(t7);function a7({title:t,titleId:s,...a},r){return y.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:r,"aria-labelledby":s},a),t?y.createElement("title",{id:s},t):null,y.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M6 18 18 6M6 6l12 12"}))}const Xi=y.forwardRef(a7),F2=(t=!1)=>{const[s,a]=y.useState([]),[r,o]=y.useState(!0),[l,c]=y.useState(null),u=async()=>{try{o(!0),console.log("Fetching menu items...");try{const{data:S,error:T}=await B.from("menu_items").select("count").limit(1);if(T&&T.message.includes("JWT"))throw new Error("Supabase não configurado")}catch(S){console.error("Supabase não configurado. Criando dados mock...",S);const T=[{id:"mock-1",name:"Cerveja Pilsen",description:"Cerveja gelada 350ml",price:8.5,category:"Bebidas",image_url:void 0,available:!0,preparation_time:0,item_type:"prepared",direct_inventory_item_id:void 0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"mock-2",name:"Refrigerante",description:"Coca-Cola 350ml",price:5,category:"Bebidas",image_url:void 0,available:!0,preparation_time:0,item_type:"prepared",direct_inventory_item_id:void 0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()},{id:"mock-3",name:"Porção de Batata",description:"Batata frita crocante",price:15,category:"Petiscos",image_url:void 0,available:!0,preparation_time:15,item_type:"prepared",direct_inventory_item_id:void 0,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}];a(T),c("Dados de exemplo sendo exibidos. Configure o Supabase para usar dados reais.");return}const{data:p,error:g}=await B.from("menu_items").select("*");console.log("All menu items:",p,"Error:",g);const{data:v}=await B.auth.getUser();if(!v.user)throw new Error("Usuário não autenticado");const{data:b,error:_}=await B.from("usuarios_empresa").select("empresa_id").eq("user_id",v.user.id).eq("status","ativo").single();if(_||!b)throw new Error("Usuário não vinculado a nenhuma empresa");const w=b.empresa_id;console.log("🏢 Carregando menu items para empresa_id:",w),console.log("🔍 Parâmetros de busca:",{includeDirectItems:t,empresaId:w});let E=B.from("menu_items").select(`
          *,
          inventory_items!left(
            name,
            image_url,
            current_stock,
            min_stock,
            unit,
            available_for_sale
          )
        `).eq("empresa_id",w).order("category",{ascending:!0}).order("name",{ascending:!0});console.log("🔐 Filtro empresa_id aplicado:",w),t?console.log("✅ Incluindo itens diretos"):(console.log("🚫 Excluindo itens diretos"),E=E.neq("item_type","direct")),E=E.eq("available",!0),console.log("🔍 Buscando apenas itens disponíveis da empresa...");const{data:k,error:N}=await E;if(console.log("🔐 Menu items da empresa:",(k==null?void 0:k.length)||0,"Error:",N),console.log("🔍 Query executada com filtros:",{empresa_id:w,includeDirectItems:t,available:!0,totalFound:(k==null?void 0:k.length)||0}),k&&k.length>0)console.log("📋 Itens encontrados na consulta filtrada:"),k.forEach((S,T)=>{console.log(`${T+1}. ${S.name}:`,{id:S.id,available:S.available,item_type:S.item_type,empresa_id:S.empresa_id,direct_inventory_item_id:S.direct_inventory_item_id})});else{console.log("❌ Nenhum item encontrado na consulta filtrada"),console.log("🔍 Fazendo consulta simples para debug...");const{data:S,error:T}=await B.from("menu_items").select("*").eq("empresa_id",w);console.log("🔍 Consulta simples resultado:",S,"Error:",T)}if(N)throw N;if(!k||k.length===0){console.log("❌ Nenhum menu item encontrado para empresa_id:",w),console.log("🔒 Isolamento multitenant ativo - não exibindo dados de outras empresas"),a([]),c("Nenhum item encontrado no menu para esta empresa. Entre em contato com o administrador.");return}const C=(k||[]).map(S=>{const T=S.inventory_items,M=S.item_type==="direct";return{id:S.id,name:M&&(T!=null&&T.name)?T.name:S.name,description:S.description||"",price:typeof S.price=="string"?parseFloat(S.price):S.price||0,category:S.category||"",image_url:M&&(T!=null&&T.image_url)?T.image_url:S.image_url||void 0,available:S.available||!1,preparation_time:S.preparation_time||0,item_type:S.item_type||"prepared",direct_inventory_item_id:S.direct_inventory_item_id||void 0,created_at:S.created_at||void 0,updated_at:S.updated_at||void 0,inventory_items:T?{id:"",name:T.name||"",currentStock:T.current_stock||0,minStock:T.min_stock||0,unit:T.unit||"unidades",lastUpdated:new Date,cost:0,availableForSale:T.available_for_sale||!1,image_url:T.image_url||void 0}:void 0}});console.log("Mapped items:",C),a(C)}catch(p){console.error("Error in fetchMenuItems:",p),c(p instanceof Error?p.message:"Erro ao carregar itens do menu")}finally{o(!1)}},h=p=>s.filter(g=>g.category===p),f=()=>s.filter(p=>p.available);return y.useEffect(()=>{u()},[t]),{menuItems:s,loading:r,error:l,refetch:u,getItemsByCategory:h,getAvailableItems:f}},Em=()=>{const{user:t}=jt(),{refreshKitchenOrders:s,refreshBarOrders:a}=Tt(),[r,o]=y.useState({orders:[],metrics:null,loading:!0,error:null}),l=y.useCallback(T=>{o(M=>({...M,...T}))},[]),c=y.useCallback((T,M)=>{console.error(`Erro em ${M}:`,T),l({error:`Erro em ${M}: ${T.message||"Erro desconhecido"}`,loading:!1})},[l]),u=y.useCallback(async()=>{if(t)try{console.log("🔄 loadOrders: Iniciando carregamento de pedidos..."),l({loading:!0,error:null});const{data:T,error:M}=await B.from("balcao_orders_with_details").select("*").order("created_at",{ascending:!1}).limit(50);if(M)throw M;const $=await Promise.all((T||[]).map(async A=>{const{data:z,error:R}=await B.from("balcao_order_items").select(`
              *,
              menu_items:menu_item_id (
                id,
                name,
                category,
                price,
                preparation_time,
                item_type
              )
            `).eq("balcao_order_id",A.id);return R&&console.warn(`Erro ao carregar itens do pedido ${A.id}:`,R),{...A,items:(z==null?void 0:z.map(L=>({...L,menu_item:Array.isArray(L.menu_items)?L.menu_items[0]:L.menu_items})))||[]}}));console.log("✅ loadOrders: Pedidos carregados:",$.length),console.log("📊 loadOrders: Status dos pedidos:",$.map(A=>({id:A.id.slice(-4),status:A.status}))),l({orders:$,loading:!1})}catch(T){c(T,"carregamento de pedidos")}},[t,l,c]),h=y.useCallback(async T=>{if(!t)throw new Error("Usuário não autenticado");try{l({loading:!0,error:null});const M="df96edf7-f7d8-457a-a490-dd485855fc7d",$=T.items.reduce((ce,J)=>ce+J.unit_price*J.quantity,0),A=T.discount_amount||0,z=$-A,{data:R,error:L}=await B.from("balcao_orders").insert({employee_id:t.id,customer_name:T.customer_name,customer_phone:T.customer_phone,total_amount:$,discount_amount:A,final_amount:z,notes:T.notes,customer_notes:T.customer_notes,status:"pending_payment",empresa_id:M}).select().single();if(L)throw L;const I=T.items.map(ce=>({balcao_order_id:R.id,menu_item_id:ce.menu_item_id,quantity:ce.quantity,unit_price:ce.unit_price,total_price:ce.unit_price*ce.quantity,notes:ce.notes,status:"pending"})),{error:X}=await B.from("balcao_order_items").insert(I);if(X)throw X;return await u(),R.id}catch(M){throw c(M,"criação de pedido"),M}},[t,l,c,u]),f=y.useCallback(async(T,M)=>{try{l({loading:!0,error:null});const $={status:M.status,updated_at:new Date().toISOString()};M.status==="paid"?($.payment_method=M.payment_method,$.cash_session_id=M.cash_session_id,$.paid_at=new Date().toISOString()):M.status==="preparing"?$.preparation_started_at=new Date().toISOString():M.status==="ready"?$.preparation_completed_at=new Date().toISOString():M.status==="delivered"&&($.delivered_at=new Date().toISOString(),$.delivered_by=M.delivered_by||(t==null?void 0:t.id)),M.notes&&($.notes=M.notes);const{error:A}=await B.from("balcao_orders").update($).eq("id",T);if(A)throw A;await u()}catch($){throw c($,"atualização de status do pedido"),$}},[l,c,u,t]),p=y.useCallback(async T=>{try{console.log("💳 Iniciando processamento de pagamento:",T.order_id);const{data:M,error:$}=await B.from("balcao_orders").select("order_number, customer_name").eq("id",T.order_id).single();if($)throw console.error("❌ Erro ao buscar dados do pedido:",$),$;await f(T.order_id,{status:"paid",payment_method:T.payment_method,cash_session_id:T.cash_session_id,notes:T.notes}),console.log("💰 Registrando transação no caixa..."),console.log("📊 Dados do pedido:",M);const A=M.order_number.toString().padStart(4,"0"),z=M.customer_name?` - ${M.customer_name}`:"",R=`Pedido Balcão #${A}${z}`;console.log("📝 Nota que será salva:",R);const L=await vt();if(!L)throw new Error("Não foi possível identificar a empresa do usuário");const I={cash_session_id:T.cash_session_id,transaction_type:"sale",payment_method:T.payment_method,amount:T.amount_paid,processed_by:t.id,notes:R,empresa_id:L};console.log("📋 Dados da transação de balcão:",I);const{data:X,error:ce}=await B.from("cash_transactions").insert(I).select().single();if(ce)throw console.error("❌ Erro ao inserir transação de balcão:",ce),ce;if(console.log("✅ Transação de balcão inserida:",X),ce)throw ce;console.log("✅ Pagamento processado com sucesso!"),console.log("🔄 Forçando atualização dos monitores em múltiplas camadas..."),setTimeout(async()=>{await Promise.all([s(),a()]),console.log("🚀 Primeira atualização dos monitores concluída!")},500),setTimeout(async()=>{await Promise.all([s(),a(),u()]),console.log("🎉 Atualização backup dos monitores concluída!")},1500)}catch(M){throw c(M,"processamento de pagamento"),M}},[f,c,t,s,a,u]),g=y.useCallback(async(T,M)=>{try{const $={status:M,updated_at:new Date().toISOString()};M==="preparing"?$.preparation_started_at=new Date().toISOString():M==="ready"&&($.preparation_completed_at=new Date().toISOString());const{error:A}=await B.from("balcao_order_items").update($).eq("id",T);if(A)throw A;await u()}catch($){throw c($,"atualização de status do item"),$}},[c,u]),v=y.useCallback(async(T,M)=>{try{await f(T,{status:"cancelled",notes:M?`Cancelado: ${M}`:"Pedido cancelado"})}catch($){throw c($,"cancelamento de pedido"),$}},[f,c]),b=y.useCallback(async T=>{try{let M=B.from("balcao_orders_with_details").select("*");T.status&&T.status.length>0&&(M=M.in("status",T.status)),T.employee_id&&(M=M.eq("employee_id",T.employee_id)),T.start_date&&(M=M.gte("created_at",T.start_date)),T.end_date&&(M=M.lte("created_at",T.end_date)),T.customer_name&&(M=M.ilike("customer_name",`%${T.customer_name}%`)),T.order_number&&(M=M.eq("order_number",T.order_number)),T.payment_method&&(M=M.eq("payment_method",T.payment_method));const{data:$,error:A}=await M.order("created_at",{ascending:!1}).limit(100);if(A)throw A;return $||[]}catch(M){return c(M,"busca de pedidos"),[]}},[c]),_=y.useCallback(async()=>{try{const T=new Date().toISOString().split("T")[0],{data:M,error:$}=await B.from("balcao_orders").select("status, final_amount, payment_method").gte("created_at",`${T}T00:00:00.000Z`).lt("created_at",`${T}T23:59:59.999Z`);if($)throw $;const A=M||[],z={today:{total_orders:A.length,total_revenue:A.reduce((R,L)=>R+(L.final_amount||0),0),avg_order_value:A.length>0?A.reduce((R,L)=>R+(L.final_amount||0),0)/A.length:0,pending_payment:A.filter(R=>R.status==="pending_payment").length,preparing:A.filter(R=>R.status==="preparing").length,ready_for_delivery:A.filter(R=>R.status==="ready").length},by_status:[],by_payment_method:[],hourly_breakdown:[]};l({metrics:z})}catch(T){c(T,"carregamento de métricas")}},[l,c]),w=y.useCallback(async()=>{await Promise.all([u(),_()])},[u,_]),E=y.useCallback(T=>r.orders.filter(M=>M.status===T),[r.orders]),k=y.useCallback(T=>r.orders.find(M=>M.id===T),[r.orders]),N=E("pending_payment"),C=E("preparing"),S=E("ready");return y.useEffect(()=>{t&&w()},[t,w]),y.useEffect(()=>{if(!t)return;const T=B.channel("balcao_orders_changes").on("postgres_changes",{event:"*",schema:"public",table:"balcao_orders"},()=>{u()}).on("postgres_changes",{event:"*",schema:"public",table:"balcao_order_items"},()=>{u()}).subscribe();return()=>{T.unsubscribe()}},[t,u]),{orders:r.orders,pendingOrders:N,preparingOrders:C,readyOrders:S,metrics:r.metrics,loading:r.loading,error:r.error,createOrder:h,updateOrderStatus:f,updateItemStatus:g,cancelOrder:v,processPayment:p,searchOrders:b,getOrdersByStatus:E,refreshData:w,getOrderById:k,loadMetrics:_}},H2=()=>{const{user:t}=jt(),[s,a]=y.useState({currentSession:null,pendingComandas:[],todaysTransactions:[],todaysSessions:[],todaysSummary:{session_date:new Date().toISOString().split("T")[0],total_sessions:0,total_sales:0,total_transactions:0,by_payment_method:[],by_employee:[],discrepancies:[],avg_ticket:0,peak_hours:[]},loading:!0,error:null}),r=y.useCallback(h=>{a(f=>({...f,...h}))},[]),o=y.useCallback((h,f)=>{console.error(`Erro em ${f}:`,h),r({error:`Erro em ${f}: ${h.message||"Erro desconhecido"}`,loading:!1})},[r]),l=y.useCallback(async()=>{if(t)try{r({loading:!0,error:null});const{data:h,error:f}=await B.from("cash_sessions").select("*").eq("employee_id",t.id).eq("status","open").maybeSingle();if(f&&f.code!=="PGRST116")throw f;const p=h?{...h,employee:{id:t.id,name:t.name||"Usuário",role:"employee"}}:null;r({currentSession:p,pendingComandas:[],todaysTransactions:[],todaysSessions:[],loading:!1})}catch(h){o(h,"carregamento inicial")}},[t,r,o]),c=y.useCallback(async h=>{if(!t)throw new Error("Usuário não autenticado");try{r({loading:!0,error:null});const f={employee_id:t.id,opening_amount:h.opening_amount,opening_notes:h.opening_notes,supervisor_approval_id:h.supervisor_approval_id,status:"open"},{data:p,error:g}=await B.from("cash_sessions").insert(f).select("*").single();if(g)throw g;await l()}catch(f){throw o(f,"abertura de caixa"),f}},[t,r,o,l]),u=y.useCallback(async h=>{if(!s.currentSession)throw new Error("Nenhuma sessão aberta");try{r({loading:!0,error:null});const f=h.closing_amount-s.currentSession.expected_amount,{error:p}=await B.from("cash_sessions").update({status:"closed",closed_at:new Date().toISOString(),closing_amount:h.closing_amount,cash_discrepancy:f,closing_notes:h.closing_notes}).eq("id",s.currentSession.id);if(p)throw p;const g=h.reconciliation.map(b=>({cash_session_id:s.currentSession.id,payment_method:b.payment_method,expected_amount:b.expected_amount,actual_amount:b.actual_amount,transaction_count:b.transaction_count,reconciled_by:t.id,notes:b.notes})),{error:v}=await B.from("payment_reconciliation").insert(g);if(v)throw v;await l()}catch(f){throw o(f,"fechamento de caixa"),f}},[s.currentSession,t,r,o,l]);return y.useEffect(()=>{l()},[l]),{currentSession:s.currentSession,pendingComandas:s.pendingComandas,todaysTransactions:s.todaysTransactions,todaysSessions:s.todaysSessions,todaysSummary:s.todaysSummary,loading:s.loading,error:s.error,openCashSession:c,closeCashSession:u,getCurrentSession:()=>s.currentSession,processComandaPayment:async()=>{throw new Error("Não implementado ainda")},processRefund:async()=>{throw new Error("Não implementado ainda")},processAdjustment:async()=>{throw new Error("Não implementado ainda")},generateDailySummary:async()=>s.todaysSummary,generateMonthlySummary:async()=>({month:new Date().toISOString().slice(0,7),total_sessions:0,total_sales:0,total_transactions:0,employees_performance:[],top_payment_methods:[],daily_breakdown:[],avg_discrepancy:0,peak_days:[]}),getTransactionsByFilters:async()=>[],getSessionsByFilters:async()=>[],validateCashAmount:async()=>({isValid:!0,errors:[]}),validateSession:async()=>({isValid:!0,errors:[]}),reloadData:l}},$e=t=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(t),Oc={dinheiro:"Dinheiro",cartao_debito:"Cartão de Débito",cartao_credito:"Cartão de Crédito",pix:"PIX",transferencia:"Transferência"},G2={sale:"Venda",refund:"Estorno",adjustment:"Ajuste",tip:"Gorjeta",cash_withdrawal:"Saída de Dinheiro",treasury_transfer:"Transferência para Tesouraria"},Ct={MAX_CASH_IN_REGISTER:1e3,AUTO_SANGRIA_THRESHOLD:1500,SUPERVISOR_APPROVAL_THRESHOLD:500,MAX_WITHDRAWAL_WITHOUT_APPROVAL:300,MAX_SUPPLY_WITHOUT_APPROVAL:500,MIN_CASH_BALANCE:50,MAX_DISCREPANCY_AUTO_ACCEPT:5,MAX_DISCREPANCY_WITHOUT_APPROVAL:50,MAX_DISCREPANCY_PERCENTAGE:2},r7=({isOpen:t,onClose:s,onSelectCustomer:a})=>{const[r,o]=y.useState(""),[l,c]=y.useState([]),[u,h]=y.useState(!1),[f,p]=y.useState("phone");y.useEffect(()=>{t&&(o(""),c([]))},[t]);const g=async()=>{if(r.trim()){h(!0);try{let _=B.from("bar_customers").select("*");f==="phone"?_=_.ilike("phone",`%${r}%`):_=_.ilike("name",`%${r}%`);const{data:w,error:E}=await _.eq("status","active").order("name").limit(10);if(E)throw E;if(!w||w.length===0){const k=[{id:"mock-1",phone:r.includes("11")?r:"(11) 99999-1234",name:"João Silva",email:"joao@exemplo.com",credit_limit:1e3,current_balance:0,status:"active",is_vip:!0,loyalty_points:250,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),last_visit:"2024-08-30"},{id:"mock-2",phone:"(11) 88888-5678",name:"Maria Santos",email:"maria@exemplo.com",credit_limit:500,current_balance:0,status:"active",is_vip:!1,loyalty_points:120,created_at:new Date().toISOString(),updated_at:new Date().toISOString(),last_visit:"2024-08-28"}];c(f==="phone"?k.filter(N=>N.phone.includes(r)||r.includes("11")):k.filter(N=>N.name.toLowerCase().includes(r.toLowerCase())))}else c(w)}catch(_){console.error("Erro ao buscar clientes:",_),c([])}finally{h(!1)}}},v=_=>{_.key==="Enter"&&g()},b=_=>{a(_),s()};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg w-full max-w-2xl max-h-[80vh] flex flex-col",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Identificar Membro"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx(Xi,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"p-6 border-b",children:[e.jsx("div",{className:"flex space-x-4 mb-4",children:e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:()=>p("phone"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${f==="phone"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(_0,{className:"h-4 w-4 inline mr-1"}),"Telefone"]}),e.jsxs("button",{onClick:()=>p("name"),className:`px-3 py-1 rounded-full text-sm font-medium transition-colors ${f==="name"?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[e.jsx(nm,{className:"h-4 w-4 inline mr-1"}),"Nome"]})]})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(rm,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx("input",{type:"text",placeholder:f==="phone"?"Digite o telefone (ex: 11999999999)":"Digite o nome do membro",value:r,onChange:_=>o(_.target.value),onKeyPress:v,className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",autoFocus:!0})]}),e.jsx("button",{onClick:g,disabled:u||!r.trim(),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:u?"Buscando...":"Buscar"})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:u?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):l.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-700 mb-3",children:[l.length," resultado(s) encontrado(s)"]}),l.map(_=>e.jsxs("div",{onClick:()=>b(_),className:"bg-gray-50 rounded-lg p-4 hover:bg-gray-100 cursor-pointer transition-colors border border-gray-200",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:_.name}),_.is_vip&&e.jsxs("div",{className:"flex items-center space-x-1 bg-yellow-100 px-2 py-1 rounded-full",children:[e.jsx(Z$,{className:"h-3 w-3 text-yellow-600"}),e.jsx("span",{className:"text-xs font-medium text-yellow-800",children:"VIP"})]})]}),e.jsxs("div",{className:"space-y-1 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(_0,{className:"h-4 w-4"}),e.jsx("span",{children:_.phone})]}),_.email&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(T$,{className:"h-4 w-4"}),e.jsx("span",{children:_.email})]})]})]}),e.jsxs("div",{className:"text-right text-sm",children:[e.jsxs("div",{className:"text-gray-900 font-medium",children:[_.loyalty_points," pontos"]}),_.last_visit&&e.jsxs("div",{className:"text-gray-500",children:["Última visita: ",new Date(_.last_visit).toLocaleDateString()]})]})]}),e.jsxs("div",{className:"mt-3 flex items-center justify-between text-xs",children:[e.jsx("span",{className:`px-2 py-1 rounded-full ${_.status==="active"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:_.status==="active"?"Ativo":"Inativo"}),e.jsxs("span",{className:"text-gray-500",children:["Limite: R$ ",_.credit_limit.toFixed(2)]})]})]},_.id))]}):r&&!u?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(nm,{className:"h-12 w-12 mx-auto text-gray-300 mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum membro encontrado"}),e.jsxs("p",{className:"text-gray-600",children:["Tente buscar por outro ",f==="phone"?"telefone":"nome"," ou verifique se o membro está cadastrado."]})]}):e.jsxs("div",{className:"text-center py-12",children:[e.jsx(rm,{className:"h-12 w-12 mx-auto text-gray-300 mb-4"}),e.jsx("h4",{className:"text-lg font-medium text-gray-900 mb-2",children:"Buscar Membro"}),e.jsxs("p",{className:"text-gray-600",children:["Digite o ",f==="phone"?"telefone":"nome"," do membro para aplicar descontos e benefícios."]})]})}),e.jsx("div",{className:"p-6 border-t bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsx("span",{children:"💡 Membros recebem 10% de desconto automaticamente"}),e.jsx("button",{onClick:s,className:"text-blue-600 hover:text-blue-800 font-medium",children:"Continuar sem identificar"})]})})]})}):null},t_=()=>{const{menuItems:t,loading:s}=F2(!0),{createOrder:a}=Em(),{currentSession:r}=H2(),{inventory:o,syncInventoryToMenu:l}=Tt(),[c,u]=y.useState([]),[h,f]=y.useState(null),[p,g]=y.useState(""),[v,b]=y.useState(""),[_,w]=y.useState("all"),[E,k]=y.useState(""),[N,C]=y.useState(!1),[S,T]=y.useState(!1),[M,$]=y.useState({}),A=y.useMemo(()=>Array.from(new Set(t.map(H=>H.category))).sort(),[t]),z=y.useMemo(()=>{let D=t.filter(H=>H.available);return _!=="all"&&(D=D.filter(H=>H.category===_)),E&&(D=D.filter(H=>{var F;return H.name.toLowerCase().includes(E.toLowerCase())||((F=H.description)==null?void 0:F.toLowerCase().includes(E.toLowerCase()))})),D},[t,_,E]);Ye.useEffect(()=>{const H=setTimeout(async()=>{try{await l()}catch(F){console.error("❌ Erro na sincronização:",F)}},1e3);return()=>clearTimeout(H)},[t.length,o.length]);const R=y.useMemo(()=>c.reduce((D,H)=>D+H.price*H.quantity,0),[c]),L=y.useMemo(()=>h?R*.1:0,[h,R]),I=y.useMemo(()=>R-L,[R,L]),X=(D,H)=>{if(D.item_type==="direct"&&D.direct_inventory_item_id){const F=o.find(Z=>Z.id===D.direct_inventory_item_id);return F?F.currentStock<H?{available:!1,currentStock:F.currentStock,warning:`Estoque insuficiente. Disponível: ${F.currentStock} ${F.unit}`}:F.currentStock<=F.minStock?{available:!0,currentStock:F.currentStock,warning:`Estoque baixo! Disponível: ${F.currentStock} ${F.unit}`}:{available:!0,currentStock:F.currentStock}:{available:!1,warning:"Item não encontrado no estoque"}}return{available:!0}},ce=D=>{const H=X(D,1);if(!H.available){alert(H.warning);return}u(F=>{const Z=F.find(re=>re.menu_item_id===D.id);if(Z){const re=Z.quantity+1,oe=X(D,re);return oe.available?(oe.warning?$(ae=>({...ae,[D.id]:oe.warning})):$(ae=>{const pe={...ae};return delete pe[D.id],pe}),F.map(ae=>ae.menu_item_id===D.id?{...ae,quantity:re}:ae)):(alert(oe.warning),F)}else return H.warning&&$(re=>({...re,[D.id]:H.warning})),[...F,{menu_item_id:D.id,name:D.name,price:D.price,quantity:1}]})},J=D=>{u(H=>H.filter(F=>F.menu_item_id!==D)),$(H=>{const F={...H};return delete F[D],F})},V=(D,H)=>{if(H<=0){J(D);return}const F=t.find(Z=>Z.id===D);if(F){const Z=X(F,H);if(!Z.available){alert(Z.warning);return}Z.warning?$(re=>({...re,[D]:Z.warning})):$(re=>{const oe={...re};return delete oe[D],oe})}u(Z=>Z.map(re=>re.menu_item_id===D?{...re,quantity:H}:re))},Y=()=>{u([]),f(null),g(""),b(""),$({})},ee=()=>{const D=[];for(const H of c){const F=t.find(Z=>Z.id===H.menu_item_id);if(F){const Z=X(F,H.quantity);Z.available||D.push(`${F.name}: ${Z.warning}`)}}return{valid:D.length===0,errors:D}},we=async()=>{if(c.length===0)return;const D=ee();if(!D.valid){alert(`Problemas de estoque encontrados:

`+D.errors.join(`
`));return}T(!0);try{const H={customer_name:h==null?void 0:h.name,customer_phone:h==null?void 0:h.phone,customer_notes:v||void 0,items:c.map(Z=>({menu_item_id:Z.menu_item_id,quantity:Z.quantity,unit_price:Z.price,notes:Z.notes})),discount_amount:L,notes:p||void 0},F=await a(H);Y(),alert(`Pedido #${F.slice(-4).toUpperCase()} criado com sucesso!

O pedido está aguardando pagamento no caixa.`)}catch(H){console.error("Erro ao criar pedido:",H),H instanceof Error&&H.message.includes("Estoque insuficiente")?alert("Estoque insuficiente para um ou mais itens. Verifique o estoque e tente novamente."):alert("Erro ao criar pedido. Tente novamente.")}finally{T(!1)}};return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"h-screen flex flex-col bg-gray-50",children:[e.jsx("div",{className:"bg-white shadow-sm p-4 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Criar Pedido de Balcão"}),e.jsx("p",{className:"text-gray-600",children:"O pedido ficará pendente até o pagamento ser processado no caixa"})]}),e.jsx("div",{className:"flex items-center space-x-4",children:r?e.jsx("div",{className:"bg-green-100 px-4 py-2 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ga,{className:"h-5 w-5 text-green-600"}),e.jsx("span",{className:"text-green-800 font-medium",children:"Caixa Aberto"})]})}):e.jsx("div",{className:"bg-yellow-100 px-4 py-2 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Za,{className:"h-5 w-5 text-yellow-600"}),e.jsxs("div",{children:[e.jsx("span",{className:"text-yellow-800 font-medium",children:"Caixa Fechado"}),e.jsx("p",{className:"text-yellow-700 text-sm",children:"Pedidos serão processados quando o caixa abrir"})]})]})})})]})}),e.jsxs("div",{className:"flex-1 flex overflow-hidden",children:[e.jsxs("div",{className:"flex-1 flex flex-col overflow-hidden",children:[e.jsx("div",{className:"bg-white p-4 border-b",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(rm,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar itens...",value:E,onChange:D=>k(D.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:_,onChange:D=>w(D.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todas Categorias"}),A.map(D=>e.jsx("option",{value:D,children:D},D))]})]})}),e.jsx("div",{className:"flex-1 overflow-auto p-4",children:e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:z.map(D=>{const H=X(D,1),F=H.warning&&H.available,Z=!H.available;return e.jsxs(be.div,{whileHover:{scale:Z?1:1.02},whileTap:{scale:Z?1:.98},onClick:()=>!Z&&ce(D),className:`bg-white rounded-lg p-4 shadow-sm border transition-all duration-200 relative ${Z?"cursor-not-allowed opacity-50 border-red-300":F?"cursor-pointer hover:shadow-lg hover:border-yellow-400 hover:bg-yellow-50 border-yellow-300":"cursor-pointer hover:shadow-lg hover:border-blue-400 hover:bg-blue-50 border-gray-200"}`,children:[Z&&e.jsxs("div",{className:"absolute top-2 right-2 bg-red-500 text-white text-xs px-2 py-1 rounded-full flex items-center space-x-1",children:[e.jsx(_r,{className:"h-3 w-3"}),e.jsx("span",{children:"Esgotado"})]}),F&&e.jsxs("div",{className:"absolute top-2 right-2 bg-yellow-500 text-white text-xs px-2 py-1 rounded-full flex items-center space-x-1",children:[e.jsx(_r,{className:"h-3 w-3"}),e.jsx("span",{children:"Baixo"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-2 line-clamp-2",children:D.name}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:D.category}),D.item_type==="direct"&&H.currentStock!==void 0&&e.jsxs("p",{className:`text-xs mb-2 ${Z?"text-red-600":F?"text-yellow-600":"text-gray-500"}`,children:["Estoque: ",H.currentStock]}),e.jsx("p",{className:`text-lg font-bold ${Z?"text-gray-400":"text-blue-600"}`,children:$e(D.price)})]})]},D.id)})})})]}),e.jsxs("div",{className:"w-96 bg-white border-l flex flex-col",children:[e.jsx("div",{className:"p-4 border-b",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Carrinho"}),c.length>0&&e.jsx("button",{onClick:Y,className:"text-red-600 hover:text-red-700 text-sm",children:"Limpar"})]})}),e.jsxs("div",{className:"flex-1 overflow-auto",children:[e.jsx("div",{className:"p-4",children:c.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{className:"text-gray-500",children:"Carrinho vazio"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Adicione itens do menu"})]}):e.jsx("div",{className:"space-y-4",children:c.map(D=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900",children:D.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[$e(D.price)," cada"]}),M[D.menu_item_id]&&e.jsxs("div",{className:"flex items-center space-x-1 mt-1",children:[e.jsx(_r,{className:"h-4 w-4 text-yellow-500"}),e.jsx("p",{className:"text-xs text-yellow-600",children:M[D.menu_item_id]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>V(D.menu_item_id,D.quantity-1),className:"p-1 rounded hover:bg-gray-200",children:e.jsx(I$,{className:"h-4 w-4"})}),e.jsx("span",{className:"w-8 text-center font-medium",children:D.quantity}),e.jsx("button",{onClick:()=>V(D.menu_item_id,D.quantity+1),className:"p-1 rounded hover:bg-gray-200",children:e.jsx(Ui,{className:"h-4 w-4"})}),e.jsx("button",{onClick:()=>J(D.menu_item_id),className:"p-1 rounded hover:bg-red-100 text-red-600 ml-2",children:e.jsx(Sm,{className:"h-4 w-4"})})]})]},D.menu_item_id))})}),h&&e.jsx("div",{className:"p-4 border-t bg-blue-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-blue-900",children:h.name}),e.jsx("p",{className:"text-sm text-blue-700",children:"Membro - Desconto 10%"})]}),e.jsx("button",{onClick:()=>f(null),className:"text-blue-600 hover:text-blue-700",children:e.jsx(Xi,{className:"h-5 w-5"})})]})}),c.length>0&&e.jsxs("div",{className:"p-4 border-t bg-gray-50",children:[e.jsxs("button",{onClick:()=>C(!0),className:"w-full mb-4 bg-blue-600 text-white py-2 rounded-lg hover:bg-blue-700 flex items-center justify-center space-x-2",children:[e.jsx(nm,{className:"h-5 w-5"}),e.jsx("span",{children:h?"Trocar Cliente":"Identificar Cliente"})]}),e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:"Subtotal:"}),e.jsx("span",{children:$e(R)})]}),L>0&&e.jsxs("div",{className:"flex justify-between text-sm text-green-600",children:[e.jsx("span",{children:"Desconto (10%):"}),e.jsxs("span",{children:["-",$e(L)]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold border-t pt-2",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{children:$e(I)})]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observações do Cliente"}),e.jsx("textarea",{value:v,onChange:D=>b(D.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Observações especiais..."})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observações Internas"}),e.jsx("textarea",{value:p,onChange:D=>g(D.target.value),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Observações sobre o pedido..."})]}),e.jsx("button",{onClick:we,disabled:S||c.length===0,className:"w-full bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 font-medium",children:S?"Criando Pedido...":"Enviar para Caixa"})]})]})]})]}),e.jsx(r7,{isOpen:N,onClose:()=>C(!1),onSelectCustomer:D=>{f(D),C(!1)}})]})},n7={pending_payment:"Aguardando Pagamento",paid:"Pago",preparing:"Preparando",ready:"Pronto",delivered:"Entregue",cancelled:"Cancelado"},o7={pending_payment:"bg-yellow-100 text-yellow-800",paid:"bg-blue-100 text-blue-800",preparing:"bg-orange-100 text-orange-800",ready:"bg-green-100 text-green-800",delivered:"bg-gray-100 text-gray-800",cancelled:"bg-red-100 text-red-800"},s_=t=>`#${t.toString().padStart(4,"0")}`,i7=()=>{var $;const{pendingOrders:t,preparingOrders:s,readyOrders:a,updateOrderStatus:r,processPayment:o,loading:l,refreshData:c}=Em(),{currentSession:u,refreshData:h}=H2(),[f,p]=y.useState(!1),[g,v]=y.useState(null),[b,_]=y.useState("dinheiro"),[w,E]=y.useState(!1),[k,N]=y.useState(!1),C=async()=>{if(!(!g||!u)){E(!0);try{await o({order_id:g.id,payment_method:b,cash_session_id:u.id,amount_paid:g.final_amount}),console.log("🔄 Forçando atualização dos dados após pagamento..."),await Promise.all([c(),h()]),setTimeout(async()=>{console.log("🔄 Segunda atualização dos dados..."),await Promise.all([c(),h()])},1e3),setTimeout(async()=>{console.log("🔄 Terceira atualização dos dados..."),await Promise.all([c(),h()])},2e3),p(!1),v(null)}catch(A){console.error("Erro ao processar pagamento:",A),alert("Erro ao processar pagamento. Tente novamente.")}finally{E(!1)}}},S=async A=>{try{await r(A,{status:"ready"})}catch(z){console.error("Erro ao marcar como pronto:",z),alert("Erro ao atualizar status. Tente novamente.")}},T=async A=>{try{await r(A,{status:"delivered"})}catch(z){console.error("Erro ao marcar como entregue:",z),alert("Erro ao atualizar status. Tente novamente.")}},M=({order:A})=>{var ce;const z=o7[A.status],R=n7[A.status],I=(()=>{const J=new Date(A.created_at);return Math.floor((new Date().getTime()-J.getTime())/(1e3*60))})(),X=I>15;return e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`bg-white rounded-lg shadow-md p-4 border-l-4 ${X?"border-red-500":A.status==="ready"?"border-green-500":"border-blue-500"}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:s_(A.order_number)}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${z}`,children:R})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-sm text-gray-600",children:[e.jsx(Za,{className:"h-4 w-4"}),e.jsxs("span",{className:X?"text-red-600 font-medium":"",children:[I,"min"]})]})]}),(A.customer_name||A.customer_phone)&&e.jsx("div",{className:"mb-3 p-2 bg-gray-50 rounded",children:e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[A.customer_name&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(nm,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:A.customer_name})]}),A.customer_phone&&e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(_0,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{children:A.customer_phone})]})]})}),e.jsx("div",{className:"space-y-2 mb-3",children:(ce=A.items)==null?void 0:ce.map(J=>{var V;return e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{children:[J.quantity,"x ",((V=J.menu_item)==null?void 0:V.name)||"Item",J.notes&&e.jsxs("span",{className:"text-gray-500 italic",children:[" - ",J.notes]})]}),e.jsx("span",{className:"font-medium",children:$e(J.total_price)})]},J.id)})}),(A.customer_notes||A.notes)&&e.jsxs("div",{className:"mb-3 p-2 bg-yellow-50 rounded",children:[A.customer_notes&&e.jsxs("div",{className:"flex items-start space-x-2 text-sm",children:[e.jsx(b$,{className:"h-4 w-4 text-yellow-600 mt-0.5"}),e.jsx("span",{className:"text-yellow-800",children:A.customer_notes})]}),A.notes&&e.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:["Obs. interna: ",A.notes]})]}),e.jsxs("div",{className:"flex justify-between items-center mb-3 pt-2 border-t",children:[e.jsx("span",{className:"font-medium text-gray-900",children:"Total:"}),e.jsx("span",{className:"text-lg font-bold text-green-600",children:$e(A.final_amount)})]}),e.jsxs("div",{className:"flex space-x-2",children:[A.status==="pending_payment"&&e.jsx("button",{onClick:()=>{v(A),p(!0)},disabled:!u,className:"flex-1 bg-green-600 text-white py-2 px-4 rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Receber Pagamento"}),A.status==="preparing"&&e.jsx("button",{onClick:()=>S(A.id),className:"flex-1 bg-blue-600 text-white py-2 px-4 rounded hover:bg-blue-700 text-sm font-medium",children:"Marcar como Pronto"}),A.status==="ready"&&e.jsx("button",{onClick:()=>T(A.id),className:"flex-1 bg-purple-600 text-white py-2 px-4 rounded hover:bg-purple-700 text-sm font-medium",children:"Entregar ao Cliente"})]})]})};return l?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Pedidos de Balcão"}),e.jsxs("div",{className:"flex items-center space-x-4",children:[u?e.jsx("div",{className:"bg-green-100 px-3 py-1 rounded-lg",children:e.jsx("span",{className:"text-green-800 text-sm font-medium",children:"Caixa Aberto"})}):e.jsx("div",{className:"bg-red-100 px-3 py-1 rounded-lg",children:e.jsx("span",{className:"text-red-800 text-sm font-medium",children:"Caixa Fechado"})}),e.jsxs("button",{onClick:async()=>{N(!0);try{console.log("🔄 Atualizando pedidos manualmente..."),await c(),console.log("✅ Pedidos atualizados!")}catch(A){console.error("❌ Erro ao atualizar:",A)}finally{N(!1)}},disabled:k,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2 disabled:opacity-50 disabled:cursor-not-allowed transition-all",children:[e.jsx(Qj,{className:`h-4 w-4 ${k?"animate-spin":""}`}),e.jsx("span",{children:k?"Atualizando...":"Atualizar"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-yellow-100 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-800 text-sm font-medium",children:"Aguardando Pagamento"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-900",children:t.length})]}),e.jsx(Za,{className:"h-8 w-8 text-yellow-600"})]})}),e.jsx("div",{className:"bg-blue-100 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-800 text-sm font-medium",children:"Preparando"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900",children:s.length})]}),e.jsx(Qj,{className:"h-8 w-8 text-blue-600"})]})}),e.jsx("div",{className:"bg-green-100 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-green-800 text-sm font-medium",children:"Prontos"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:a.length})]}),e.jsx(Ga,{className:"h-8 w-8 text-green-600"})]})})]}),e.jsxs("div",{className:"space-y-6",children:[t.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Aguardando Pagamento (",t.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(A=>e.jsx(M,{order:A},A.id))})]}),s.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Preparando (",s.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:s.map(A=>e.jsx(M,{order:A},A.id))})]}),a.length>0&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:["Prontos para Entrega (",a.length,")"]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:a.map(A=>e.jsx(M,{order:A},A.id))})]}),t.length===0&&s.length===0&&a.length===0&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx(Za,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhum pedido pendente"}),e.jsx("p",{className:"text-gray-600",children:"Todos os pedidos foram processados e entregues."})]})]}),f&&g&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-96",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Receber Pagamento - ",s_(g.order_number)]}),e.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx(Xi,{className:"h-5 w-5"})})]}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Resumo do Pedido"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[($=g.items)==null?void 0:$.map(A=>{var z;return e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[A.quantity,"x ",(z=A.menu_item)==null?void 0:z.name]}),e.jsx("span",{children:$e(A.total_price)})]},A.id)}),e.jsxs("div",{className:"border-t pt-2 flex justify-between font-medium",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{children:$e(g.final_amount)})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Método de Pagamento"}),e.jsxs("select",{value:b,onChange:A=>_(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"dinheiro",children:"Dinheiro"}),e.jsx("option",{value:"cartao_debito",children:"Cartão de Débito"}),e.jsx("option",{value:"cartao_credito",children:"Cartão de Crédito"}),e.jsx("option",{value:"pix",children:"PIX"}),e.jsx("option",{value:"transferencia",children:"Transferência"})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>p(!1),className:"flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:C,disabled:w||!u,className:"flex-1 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:w?"Processando...":"Confirmar Pagamento"})]})]})})]})},Cm={tableSize:120,margin:50,layoutWidth:800,layoutHeight:600},l7=(t,s={})=>{const{tableSize:a,margin:r,layoutWidth:o}={...Cm,...s},l=Math.floor((o-r)/a),c=t%l,u=Math.floor(t/l);return{x:r+c*a,y:r+u*a}},c7=(t,s={})=>{const{tableSize:a,margin:r,layoutWidth:o,layoutHeight:l}={...Cm,...s},c=Math.floor((o-r)/a),u=Math.floor((l-r)/a),h=new Set(t.map(f=>`${f.x},${f.y}`));for(let f=0;f<u;f++)for(let p=0;p<c;p++){const g=r+p*a,v=r+f*a,b=`${g},${v}`;if(!h.has(b))return{x:g,y:v}}return l7(t.length,s)},d7=(t,s={})=>{const a={...Cm,...s},r=Math.floor((a.layoutWidth-a.margin)/a.tableSize),o=Math.floor((a.layoutHeight-a.margin)/a.tableSize),l=r*o;console.log("Grid Organization:",{layoutWidth:a.layoutWidth,layoutHeight:a.layoutHeight,tableSize:a.tableSize,margin:a.margin,maxCols:r,maxRows:o,maxCapacity:l,tablesCount:t.length});let c=a.tableSize,u=a.margin;if(t.length>l){const h=Math.ceil(Math.sqrt(t.length)),f=Math.ceil(t.length/h);c=Math.min(Math.floor((a.layoutWidth-40)/h),Math.floor((a.layoutHeight-40)/f)),u=20,console.log("Adjusted for capacity:",{idealCols:h,idealRows:f,adjustedTableSize:c,adjustedMargin:u})}return t.map((h,f)=>{const p=Math.floor((a.layoutWidth-u)/c),g=f%p,v=Math.floor(f/p),b={x:u+g*c,y:u+v*c};return console.log(`Mesa ${f+1}:`,{col:g,row:v,position:b}),{id:h.id,position:b}})},Rr=()=>{const{user:t}=jt(),[s,a]=y.useState([]),[r,o]=y.useState(!0),[l,c]=y.useState(null),u=async()=>{try{if(o(!0),console.log("useBarTables - Fetching tables..."),!t){console.log("useBarTables - Usuário não autenticado"),a([]);return}const{data:C,error:S}=await B.from("usuarios_empresa").select("empresa_id").eq("user_id",t.id).eq("ativo",!0).single();if(S||!C){console.error("useBarTables - Erro ao buscar empresa do usuário:",S),c("Erro: Não foi possível identificar sua empresa");return}const T=C.empresa_id;console.log("useBarTables - Carregando mesas para empresa:",T);const{data:M,error:$}=await B.from("bar_tables").select("*").eq("empresa_id",T).order("number");if(console.log("useBarTables - Query result:",{data:M,error:$}),$)throw $;a(M||[]),console.log("useBarTables - Tables set:",M||[])}catch(C){console.error("useBarTables - Error:",C),c(C instanceof Error?C.message:"Erro ao carregar mesas")}finally{o(!1)}},h=async C=>{try{if(!t)throw new Error("Usuário não autenticado");const{data:S,error:T}=await B.from("usuarios_empresa").select("empresa_id").eq("user_id",t.id).eq("ativo",!0).single();if(T||!S)throw new Error("Erro: Não foi possível identificar sua empresa");const{data:M,error:$}=await B.from("bar_tables").insert({...C,empresa_id:S.empresa_id,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if($)throw $;return a(A=>[...A,M]),M}catch(S){throw new Error(S instanceof Error?S.message:"Erro ao criar mesa")}},f=async(C,S)=>{try{const{data:T,error:M}=await B.from("bar_tables").update({...S,updated_at:new Date().toISOString()}).eq("id",C).select().single();if(M)throw M;return a($=>$.map(A=>A.id===C?T:A)),T}catch(T){throw new Error(T instanceof Error?T.message:"Erro ao atualizar mesa")}},p=async C=>{try{const{error:S}=await B.from("bar_tables").delete().eq("id",C);if(S)throw S;a(T=>T.filter(M=>M.id!==C))}catch(S){throw new Error(S instanceof Error?S.message:"Erro ao excluir mesa")}},g=async(C,S)=>f(C,{status:S}),v=async(C,S,T)=>{try{const{error:M}=await B.from("bar_tables").update({position_x:S,position_y:T,updated_at:new Date().toISOString()}).eq("id",C);if(M)throw M;a($=>$.map(A=>A.id===C?{...A,position_x:S,position_y:T}:A))}catch(M){throw new Error(M instanceof Error?M.message:"Erro ao atualizar posição da mesa")}},b=C=>s.find(S=>S.id===C),_=C=>s.find(S=>S.number===C),w=()=>s.filter(C=>C.status==="available"),E=()=>s.filter(C=>C.status==="occupied"),k=C=>s.filter(S=>S.status===C),N=async(C=800,S=600)=>{console.log("Organizing tables with dimensions:",{layoutWidth:C,layoutHeight:S,tablesCount:s.length});const T={...Cm,layoutWidth:Math.max(C-100,600),layoutHeight:Math.max(S-150,400)},$=d7(s,T).map(({id:A,position:z})=>(console.log(`Updating table ${A} to position:`,z),v(A,z.x,z.y)));try{await Promise.all($),console.log("All tables organized successfully")}catch(A){throw console.error("Error organizing tables:",A),new Error("Erro ao organizar mesas automaticamente")}};return y.useEffect(()=>{t&&u();const C=B.channel("bar_tables_changes").on("postgres_changes",{event:"*",schema:"public",table:"bar_tables"},S=>{console.log("Mudança em mesas:",S),S.eventType==="INSERT"?a(T=>[...T,S.new]):S.eventType==="UPDATE"?a(T=>T.map(M=>M.id===S.new.id?S.new:M)):S.eventType==="DELETE"&&a(T=>T.filter(M=>M.id!==S.old.id))}).subscribe();return()=>{C.unsubscribe()}},[t]),{tables:s,loading:r,error:l,refetch:u,createTable:h,updateTable:f,deleteTable:p,updateTableStatus:g,updateTablePosition:v,organizeTablesAutomatically:N,getTableById:b,getTableByNumber:_,getAvailableTables:w,getOccupiedTables:E,getTablesByStatus:k}},Z2=({isOpen:t,onClose:s,table:a})=>{const{user:r}=jt(),{refetch:o,tables:l}=Rr(),[c,u]=y.useState({number:"",capacity:2,status:"available",notes:"",position_x:100,position_y:100}),[h,f]=y.useState(!1),[p,g]=y.useState(null),v=!!a,b=()=>{const k=l.filter(N=>N.position_x!==null&&N.position_y!==null).map(N=>({x:N.position_x,y:N.position_y}));return c7(k)};y.useEffect(()=>{if(a)u({number:a.number,capacity:a.capacity,status:a.status||"available",notes:a.notes||"",position_x:a.position_x||100,position_y:a.position_y||100});else{const k=b();u({number:"",capacity:2,status:"available",notes:"",position_x:k.x,position_y:k.y})}g(null)},[a,t,l.length]);const _=async k=>{k.preventDefault(),f(!0),g(null);try{if(v){const{error:N}=await B.from("bar_tables").update({number:c.number,capacity:c.capacity,status:c.status,notes:c.notes||null,position_x:c.position_x,position_y:c.position_y,updated_at:new Date().toISOString()}).eq("id",a.id);if(N)throw N}else{if(!r)throw new Error("Usuário não autenticado");const{data:N,error:C}=await B.from("usuarios_empresa").select("empresa_id").eq("user_id",r.id).eq("ativo",!0).single();if(C||!N)throw new Error("Erro: Não foi possível identificar sua empresa");const{error:S}=await B.from("bar_tables").insert({number:c.number,capacity:c.capacity,status:c.status,notes:c.notes||null,position_x:c.position_x,position_y:c.position_y,empresa_id:N.empresa_id});if(S)throw S}await o(),s()}catch(N){console.error("Erro ao salvar mesa:",N),N.code==="23505"?g("Já existe uma mesa com este número"):g(N.message||"Erro ao salvar mesa")}finally{f(!1)}},w=async()=>{if(!(!a||!confirm("Tem certeza que deseja excluir esta mesa?"))){f(!0);try{const{error:k}=await B.from("bar_tables").delete().eq("id",a.id);if(k)throw k;await o(),s()}catch(k){console.error("Erro ao excluir mesa:",k),g(k.message||"Erro ao excluir mesa")}finally{f(!1)}}},E=[{value:"available",label:"Disponível",color:"text-green-600"},{value:"occupied",label:"Ocupada",color:"text-red-600"},{value:"reserved",label:"Reservada",color:"text-yellow-600"},{value:"cleaning",label:"Limpeza",color:"text-blue-600"},{value:"maintenance",label:"Manutenção",color:"text-gray-600"}];return e.jsx(e.Fragment,{children:t&&e.jsxs("div",{className:"fixed inset-0 z-[9999] flex items-center justify-center p-4",children:[e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50",onClick:s}),e.jsx("div",{className:"relative bg-white rounded-lg shadow-xl max-w-lg w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:v?"Editar Mesa":"Nova Mesa"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 focus:outline-none",children:e.jsx(Xi,{className:"h-6 w-6"})})]}),p&&e.jsx("div",{className:"mb-4 bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx(_r,{className:"h-5 w-5 text-red-400"}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm text-red-800",children:p})})]})}),e.jsxs("form",{onSubmit:_,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Número da Mesa *"}),e.jsx("input",{type:"text",required:!0,value:c.number,onChange:k=>u(N=>({...N,number:k.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Ex: 1, A1, VIP-01"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Capacidade (pessoas) *"}),e.jsx("input",{type:"number",required:!0,min:"1",max:"20",value:c.capacity,onChange:k=>u(N=>({...N,capacity:parseInt(k.target.value)||1})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsx("select",{value:c.status,onChange:k=>u(N=>({...N,status:k.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:E.map(k=>e.jsx("option",{value:k.value,children:k.label},k.value))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Posição X"}),e.jsx("input",{type:"number",min:"0",value:c.position_x,onChange:k=>u(N=>({...N,position_x:parseInt(k.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Posição Y"}),e.jsx("input",{type:"number",min:"0",value:c.position_y,onChange:k=>u(N=>({...N,position_y:parseInt(k.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações"}),e.jsx("textarea",{rows:3,value:c.notes,onChange:k=>u(N=>({...N,notes:k.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Observações sobre a mesa..."})]}),e.jsxs("div",{className:"flex justify-between pt-4",children:[e.jsx("div",{children:v&&e.jsx("button",{type:"button",onClick:w,disabled:h,className:"bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-red-500 disabled:opacity-50",children:"Excluir"})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{type:"button",onClick:s,disabled:h,className:"bg-gray-300 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-gray-500 disabled:opacity-50",children:"Cancelar"}),e.jsxs("button",{type:"submit",disabled:h,className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 flex items-center",children:[h?e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}):e.jsx(j$,{className:"h-4 w-4 mr-2"}),v?"Salvar":"Criar"]})]})]})]})]})})]})})},u7=({table:t,x:s,y:a,onClose:r,onEdit:o})=>{const{updateTableStatus:l}=Rr(),c=y.useRef(null);y.useEffect(()=>{const f=g=>{c.current&&!c.current.contains(g.target)&&r()},p=g=>{g.key==="Escape"&&r()};return document.addEventListener("mousedown",f),document.addEventListener("keydown",p),()=>{document.removeEventListener("mousedown",f),document.removeEventListener("keydown",p)}},[r]);const u=async f=>{try{await l(t.id,f),r()}catch(p){console.error("Erro ao atualizar status da mesa:",p)}},h=[{value:"available",label:"Disponível",icon:O$,color:"text-green-600"},{value:"occupied",label:"Ocupada",icon:Wa,color:"text-red-600"},{value:"reserved",label:"Reservada",icon:Za,color:"text-yellow-600"},{value:"cleaning",label:"Limpeza",icon:e_,color:"text-blue-600"},{value:"maintenance",label:"Manutenção",icon:e_,color:"text-gray-600"}];return e.jsx(Ws,{children:e.jsx("div",{className:"fixed inset-0 z-50",children:e.jsxs(be.div,{ref:c,initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"absolute bg-white rounded-lg shadow-lg border border-gray-200 py-2 min-w-48",style:{left:s,top:a,transform:"translate(-50%, -10px)"},children:[e.jsxs("div",{className:"px-4 py-2 border-b border-gray-100",children:[e.jsxs("div",{className:"font-medium text-gray-900",children:["Mesa ",t.number]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[t.capacity," pessoas"]})]}),e.jsxs("div",{className:"py-1",children:[e.jsx("div",{className:"px-4 py-1 text-xs font-medium text-gray-500 uppercase tracking-wide",children:"Alterar Status"}),h.map(f=>{const p=f.icon,g=t.status===f.value;return e.jsxs("button",{onClick:()=>u(f.value),disabled:g,className:`w-full px-4 py-2 text-left flex items-center space-x-3 hover:bg-gray-50 transition-colors ${g?"bg-gray-50 cursor-not-allowed opacity-50":""}`,children:[e.jsx(p,{className:`h-4 w-4 ${f.color}`}),e.jsx("span",{className:"text-sm text-gray-700",children:f.label}),g&&e.jsx("span",{className:"ml-auto text-xs text-gray-500",children:"Atual"})]},f.value)})]}),e.jsx("div",{className:"border-t border-gray-100 my-1"}),e.jsx("div",{className:"py-1",children:e.jsxs("button",{onClick:o,className:"w-full px-4 py-2 text-left flex items-center space-x-3 hover:bg-gray-50 transition-colors",children:[e.jsx(Nm,{className:"h-4 w-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Editar Mesa"})]})})]})})})},m7=({table:t,onClose:s,onEdit:a,onStartOrder:r,onManageComandas:o,onFinalizarAtendimento:l})=>{const{updateTableStatus:c,deleteTable:u}=Rr(),{getOpenComandasByTableId:h,getComandasByTableId:f,getPendingPaymentComandasByTableId:p}=Ki(),g=h(t.id),v=p(t.id),b=f(t.id);console.log("TableActionPanel - Hook functions:",{updateTableStatus:typeof c,deleteTable:typeof u,tableId:t.id,tableStatus:t.status,openComandas:g.length,pendingComandas:v.length,allComandas:b.length});const _=async N=>{console.log("Alterando status da mesa:",t.id,"para:",N);try{await c(t.id,N),console.log("Status alterado com sucesso")}catch(C){console.error("Erro ao alterar status da mesa:",C),alert("Erro ao alterar status da mesa: "+(C instanceof Error?C.message:"Erro desconhecido"))}},w=async()=>{if(console.log("Tentando excluir mesa:",t.id,t.number),window.confirm(`Tem certeza que deseja excluir a Mesa ${t.number}?`))try{await u(t.id),console.log("Mesa excluída com sucesso"),s()}catch(N){console.error("Erro ao excluir mesa:",N),alert("Erro ao excluir mesa: "+(N instanceof Error?N.message:"Erro desconhecido"))}},E=N=>{switch(N){case"available":return"text-green-600 bg-green-50";case"occupied":return"text-red-600 bg-red-50";case"reserved":return"text-yellow-600 bg-yellow-50";case"cleaning":return"text-blue-600 bg-blue-50";case"maintenance":return"text-gray-600 bg-gray-50";default:return"text-gray-600 bg-gray-50"}},k=N=>{switch(N){case"available":return"Disponível";case"occupied":return"Ocupada";case"reserved":return"Reservada";case"cleaning":return"Em Limpeza";case"maintenance":return"Manutenção";default:return"Indefinido"}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Mesa ",t.number]}),e.jsxs("div",{className:"flex items-center space-x-2 mt-1",children:[e.jsx(Wa,{className:"h-4 w-4 text-gray-500"}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Capacidade: ",t.capacity," pessoas"]})]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(s7,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Status Atual:"}),e.jsx("div",{className:`px-3 py-1 rounded-full text-sm font-medium ${E(t.status||"available")}`,children:k(t.status||"available")})]})}),g.length>0&&e.jsx("div",{className:"px-6 py-3 bg-blue-50 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ln,{className:"h-5 w-5 text-blue-600"}),e.jsxs("span",{className:"text-sm font-medium text-blue-900",children:[g.length," comanda",g.length!==1?"s":""," aberta",g.length!==1?"s":""]})]}),e.jsxs("span",{className:"px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full",children:["ATIVA",g.length!==1?"S":""]})]})}),g.length===0&&v.length>0&&e.jsx("div",{className:"px-6 py-3 bg-yellow-50 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ln,{className:"h-5 w-5 text-yellow-600"}),e.jsxs("span",{className:"text-sm font-medium text-yellow-800",children:[v.length," comanda",v.length!==1?"s":""," no caixa"]})]}),e.jsx("span",{className:"px-2 py-1 bg-yellow-100 text-yellow-800 text-xs font-medium rounded-full",children:"AGUARDANDO PAGTO"})]})}),g.length===0&&v.length===0&&b.length>0&&e.jsx("div",{className:"px-6 py-3 bg-gray-50 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ln,{className:"h-5 w-5 text-gray-500"}),e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:[b.length," comanda",b.length!==1?"s":""," no histórico"]})]}),e.jsxs("span",{className:"px-2 py-1 bg-gray-100 text-gray-600 text-xs font-medium rounded-full",children:["PAGA",b.length!==1?"S":""]})]})}),e.jsxs("div",{className:"px-6 py-4 space-y-3",children:[o&&(g.length>0||t.status==="available")&&e.jsxs("button",{onClick:()=>o(t),className:"w-full flex items-center justify-center space-x-2 bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(ln,{className:"h-5 w-5"}),e.jsx("span",{children:g.length>0?`Gerenciar Comandas (${g.length})`:"Criar Nova Comanda"})]}),o&&g.length===0&&b.length>0&&t.status!=="available"&&e.jsxs("button",{onClick:()=>o(t),className:"w-full flex items-center justify-center space-x-2 bg-gray-600 text-white px-4 py-3 rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(ln,{className:"h-5 w-5"}),e.jsxs("span",{children:["Ver Histórico (",b.length,")"]})]}),t.status==="available"&&r&&e.jsxs("button",{onClick:()=>r(t),className:"w-full flex items-center justify-center space-x-2 bg-green-600 text-white px-4 py-3 rounded-lg hover:bg-green-700 transition-colors",children:[e.jsx(Wa,{className:"h-5 w-5"}),e.jsx("span",{children:"Iniciar Atendimento"})]}),t.status==="occupied"&&l&&e.jsxs("button",{onClick:()=>l(t),className:"w-full flex items-center justify-center space-x-2 bg-orange-600 text-white px-4 py-3 rounded-lg hover:bg-orange-700 transition-colors",children:[e.jsx(Ga,{className:"h-5 w-5"}),e.jsx("span",{children:"Finalizar Atendimento"})]}),t.status==="occupied"&&e.jsxs("button",{onClick:()=>_("available"),className:"w-full flex items-center justify-center space-x-2 bg-gray-600 text-white px-4 py-3 rounded-lg hover:bg-gray-700 transition-colors",children:[e.jsx(Ga,{className:"h-5 w-5"}),e.jsx("span",{children:"Liberar Mesa (Rápido)"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Alterar Status:"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[t.status!=="available"&&e.jsxs("button",{onClick:N=>{console.log("Clique no botão Disponível",N),_("available")},className:"flex items-center justify-center space-x-1 px-3 py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-sm",children:[e.jsx(Ga,{className:"h-4 w-4"}),e.jsx("span",{children:"Disponível"})]}),t.status!=="occupied"&&e.jsxs("button",{onClick:N=>{console.log("Clique no botão Ocupada",N),_("occupied")},className:"flex items-center justify-center space-x-1 px-3 py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors text-sm",children:[e.jsx(Wa,{className:"h-4 w-4"}),e.jsx("span",{children:"Ocupada"})]}),t.status!=="reserved"&&e.jsxs("button",{onClick:()=>_("reserved"),className:"flex items-center justify-center space-x-1 px-3 py-2 bg-yellow-100 text-yellow-700 rounded-lg hover:bg-yellow-200 transition-colors text-sm",children:[e.jsx(Za,{className:"h-4 w-4"}),e.jsx("span",{children:"Reservada"})]}),t.status!=="cleaning"&&e.jsxs("button",{onClick:()=>_("cleaning"),className:"flex items-center justify-center space-x-1 px-3 py-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200 transition-colors text-sm",children:[e.jsx(H$,{className:"h-4 w-4"}),e.jsx("span",{children:"Limpeza"})]}),t.status!=="maintenance"&&e.jsxs("button",{onClick:()=>_("maintenance"),className:"flex items-center justify-center space-x-1 px-3 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors text-sm",children:[e.jsx(e7,{className:"h-4 w-4"}),e.jsx("span",{children:"Manutenção"})]})]})]})]}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex space-x-3",children:[e.jsxs("button",{onClick:()=>a(t),className:"flex-1 flex items-center justify-center space-x-2 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors",children:[e.jsx(Nm,{className:"h-4 w-4"}),e.jsx("span",{children:"Editar"})]}),e.jsxs("button",{onClick:N=>{console.log("Clique no botão Excluir",N),w()},className:"flex-1 flex items-center justify-center space-x-2 bg-red-100 text-red-700 px-4 py-2 rounded-lg hover:bg-red-200 transition-colors",children:[e.jsx(Sm,{className:"h-4 w-4"}),e.jsx("span",{children:"Excluir"})]})]}),t.description&&e.jsxs("div",{className:"px-6 py-3 bg-gray-50 border-t border-gray-200",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Observações:"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:t.description})]})]})})},h7=({table:t,onClose:s,onCreateComanda:a})=>{const{user:r}=jt(),{getComandasByTableId:o,getOpenComandasByTableId:l,createComandaForTable:c,closeComanda:u,deleteComanda:h}=Ki(),[f,p]=y.useState(""),[g,v]=y.useState(1),[b,_]=y.useState(!1),w=o(t.id),E=l(t.id);console.log("TableComandasPanel - Comandas da mesa:",t.id,w),w.length>0&&console.log("Primeira comanda com itens:",w[0]);const k=async()=>{if(console.log("🔄 handleCreateComanda chamada para mesa:",t.id),!r){alert("Usuário não autenticado");return}try{_(!0),console.log("📝 Dados da comanda:",{table_id:t.id,employee_id:r.id,customer_name:f,people_count:g});const A=await c(t.id,r.id,f||void 0,g);console.log("✅ Nova comanda criada:",A),p(""),v(1),a&&a(A)}catch(A){console.error("Erro ao criar comanda:",A),alert("Erro ao criar comanda: "+(A instanceof Error?A.message:"Erro desconhecido"))}finally{_(!1)}},N=async A=>{const z=prompt("Método de pagamento (opcional):");try{await u(A,z||void 0),console.log("Comanda fechada:",A)}catch(R){console.error("Erro ao fechar comanda:",R),alert("Erro ao fechar comanda: "+(R instanceof Error?R.message:"Erro desconhecido"))}},C=async A=>{if(window.confirm("Tem certeza que deseja excluir esta comanda?"))try{await h(A),console.log("Comanda excluída:",A)}catch(z){console.error("Erro ao excluir comanda:",z),alert("Erro ao excluir comanda: "+(z instanceof Error?z.message:"Erro desconhecido"))}},S=A=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(A),T=A=>new Date(A).toLocaleString("pt-BR"),M=A=>{switch(A){case"open":return"bg-green-100 text-green-800";case"pending_payment":return"bg-yellow-100 text-yellow-800";case"closed":return"bg-gray-100 text-gray-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},$=A=>{switch(A){case"open":return"Aberta";case"pending_payment":return"Aguardando Pagamento";case"closed":return"Fechada";case"cancelled":return"Cancelada";default:return"Indefinido"}};return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Comandas - Mesa ",t.number]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Wa,{className:"h-4 w-4"}),e.jsxs("span",{children:["Capacidade: ",t.capacity]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ln,{className:"h-4 w-4"}),e.jsxs("span",{children:[w.length," comandas"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Za,{className:"h-4 w-4"}),e.jsxs("span",{children:[E.length," abertas"]})]})]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Xi,{className:"h-6 w-6"})})]})}),e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 bg-gray-50 flex-shrink-0",children:[e.jsx("h4",{className:"text-md font-medium text-gray-900 mb-3",children:"Nova Comanda"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome do Cliente (opcional)"}),e.jsx("input",{type:"text",value:f,onChange:A=>p(A.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nome do cliente"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Número de Pessoas"}),e.jsx("input",{type:"number",min:"1",max:t.capacity,value:g,onChange:A=>v(parseInt(A.target.value)||1),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("button",{onClick:k,disabled:b,className:"w-full bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center space-x-2",children:[e.jsx(Ui,{className:"h-4 w-4"}),e.jsx("span",{children:b?"Criando...":"Criar Comanda"})]})})]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:w.length===0?e.jsxs("div",{className:"px-6 py-8 text-center",children:[e.jsx(ln,{className:"h-12 w-12 text-gray-400 mx-auto mb-3"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma comanda encontrada"}),e.jsx("p",{className:"text-gray-500",children:"Crie a primeira comanda para esta mesa"})]}):e.jsx("div",{className:"px-6 py-4 space-y-3",children:w.map(A=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${M(A.status||"open")}`,children:$(A.status||"open")}),A.customer_name&&e.jsx("span",{className:"text-sm font-medium text-gray-900",children:A.customer_name}),A.people_count&&e.jsxs("span",{className:"text-sm text-gray-600",children:[A.people_count," pessoas"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Aberta em:"}),e.jsx("br",{}),A.opened_at?T(A.opened_at):"N/A"]}),A.closed_at&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Fechada em:"}),e.jsx("br",{}),T(A.closed_at)]})]}),A.total&&e.jsxs("div",{className:"mt-2 flex items-center space-x-2",children:[e.jsx(q2,{className:"h-4 w-4 text-green-600"}),e.jsx("span",{className:"font-semibold text-green-600",children:S(A.total)})]}),A.comanda_items&&A.comanda_items.length>0&&e.jsxs("div",{className:"mt-3 border-t pt-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 mb-2 block",children:["Itens (",A.comanda_items.length,"):"]}),e.jsx("div",{className:"space-y-1",children:A.comanda_items.map((z,R)=>{var L;return e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-gray-600",children:[z.quantity,"x"]}),e.jsx("span",{className:"text-gray-900",children:((L=z.menu_items)==null?void 0:L.name)||"Item sem nome"})]}),e.jsx("span",{className:"text-gray-600",children:S(z.price*z.quantity)})]},z.id||R)})})]}),A.notes&&e.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[e.jsx("span",{className:"font-medium",children:"Observações:"})," ",A.notes]})]}),e.jsxs("div",{className:"flex flex-col space-y-2 ml-4",children:[A.status==="open"&&e.jsxs("button",{onClick:()=>N(A.id),className:"flex items-center space-x-1 px-3 py-1 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 transition-colors text-sm",children:[e.jsx(Ga,{className:"h-4 w-4"}),e.jsx("span",{children:"Fechar"})]}),e.jsxs("button",{onClick:()=>C(A.id),className:"flex items-center space-x-1 px-3 py-1 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 transition-colors text-sm",children:[e.jsx(Sm,{className:"h-4 w-4"}),e.jsx("span",{children:"Excluir"})]})]})]})},A.id))})}),w.length>0&&e.jsx("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50 flex-shrink-0",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:w.length}),e.jsx("div",{className:"text-gray-600",children:"Total de Comandas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-green-600",children:E.length}),e.jsx("div",{className:"text-gray-600",children:"Comandas Abertas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-blue-600",children:S(w.filter(A=>A.status==="closed").reduce((A,z)=>A+(z.total||0),0))}),e.jsx("div",{className:"text-gray-600",children:"Total Faturado"})]})]})})]})})},f7=({table:t,onClose:s,onFinalized:a})=>{const{getOpenComandasByTableId:r,updateComanda:o}=Ki(),{updateTableStatus:l}=Rr(),[c,u]=y.useState(!1),[h,f]=y.useState(""),[p,g]=y.useState(!1),v=r(t.id),b=v.reduce((S,T)=>S+(T.total||0),0),_=v.reduce((S,T)=>{var M;return S+(((M=T.comanda_items)==null?void 0:M.reduce(($,A)=>$+A.quantity,0))||0)},0),w=S=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(S),E=S=>new Date(S).toLocaleString("pt-BR"),k=()=>{g(!0),setTimeout(()=>{const S=N(),T=window.open("","_blank");T&&(T.document.write(S),T.document.close(),T.print(),T.close()),g(!1)},1e3)},N=()=>{const S=new Date().toLocaleString("pt-BR");return`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Comanda - Mesa ${t.number}</title>
        <style>
          body { font-family: monospace; font-size: 12px; margin: 20px; }
          .header { text-align: center; border-bottom: 2px solid #000; padding-bottom: 10px; margin-bottom: 15px; }
          .mesa-info { text-align: center; margin-bottom: 15px; }
          .item { display: flex; justify-content: space-between; margin-bottom: 5px; }
          .total { border-top: 2px solid #000; padding-top: 10px; margin-top: 15px; font-weight: bold; }
          .footer { text-align: center; margin-top: 20px; font-size: 10px; }
        </style>
      </head>
      <body>
        <div class="header">
          <h2>CLUBE AABB</h2>
          <p>Sistema de Atendimento do Bar</p>
        </div>
        
        <div class="mesa-info">
          <h3>MESA ${t.number}</h3>
          <p>Capacidade: ${t.capacity} pessoas</p>
          <p>Data/Hora: ${S}</p>
        </div>

        <h4>ITENS CONSUMIDOS:</h4>
        ${v.map(T=>{var M;return`
          <div style="margin-bottom: 15px;">
            <strong>Comanda: ${T.customer_name||"Sem nome"}</strong>
            ${((M=T.comanda_items)==null?void 0:M.map($=>{var A;return`
              <div class="item">
                <span>${$.quantity}x ${((A=$.menu_items)==null?void 0:A.name)||"Item"}</span>
                <span>${w($.price*$.quantity)}</span>
              </div>
            `}).join(""))||""}
          </div>
        `}).join("")}

        <div class="total">
          <div class="item">
            <span>TOTAL DE ITENS: ${_}</span>
            <span></span>
          </div>
          <div class="item">
            <span>TOTAL GERAL:</span>
            <span>${w(b)}</span>
          </div>
        </div>

        <div class="footer">
          <p>Obrigado pela preferência!</p>
          <p>Esta comanda foi enviada para o caixa</p>
        </div>
      </body>
      </html>
    `},C=async()=>{if(!h){alert("Selecione um método de pagamento");return}u(!0);try{const S=v.map(T=>o(T.id,{status:"pending_payment",payment_method:h}));await Promise.all(S),await l(t.id,"available"),console.log("Comandas enviadas para o caixa:",{mesa:t.number,comandas:v.length,total:b,paymentMethod:h,status:"pending_payment"}),k(),alert(`Atendimento finalizado com sucesso!

Mesa ${t.number} liberada
Total: ${w(b)}
Método: ${h}

✅ Comandas enviadas para o CAIXA
💰 Aguardando pagamento`),a&&a(),s()}catch(S){console.error("Erro ao finalizar atendimento:",S),alert("Erro ao finalizar atendimento: "+(S instanceof Error?S.message:"Erro desconhecido"))}finally{u(!1)}};return v.length===0?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 p-6",children:e.jsxs("div",{className:"text-center",children:[e.jsx(_r,{className:"h-12 w-12 text-yellow-500 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Nenhuma Comanda Aberta"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Não há comandas abertas para finalizar nesta mesa."}),e.jsx("button",{onClick:s,className:"bg-gray-600 text-white px-4 py-2 rounded-lg hover:bg-gray-700 transition-colors",children:"Fechar"})]})})}):e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] flex flex-col",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Finalizar Atendimento - Mesa ",t.number]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(Wa,{className:"h-4 w-4"}),e.jsxs("span",{children:["Capacidade: ",t.capacity]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(ln,{className:"h-4 w-4"}),e.jsxs("span",{children:[v.length," comandas"]})]}),e.jsxs("div",{className:"flex items-center space-x-1",children:[e.jsx(q2,{className:"h-4 w-4"}),e.jsx("span",{children:w(b)})]})]})]}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(Xi,{className:"h-6 w-6"})})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto min-h-0",children:e.jsxs("div",{className:"px-6 py-4",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Comandas a Finalizar"}),e.jsx("div",{className:"space-y-3",children:v.map(S=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:S.customer_name||"Cliente sem nome"}),S.people_count&&e.jsxs("span",{className:"text-sm text-gray-600",children:["(",S.people_count," pessoas)"]})]}),e.jsx("span",{className:"font-semibold text-green-600",children:w(S.total||0)})]}),e.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:[e.jsx(Za,{className:"h-4 w-4 inline mr-1"}),"Aberta em: ",S.opened_at?E(S.opened_at):"N/A"]}),S.comanda_items&&S.comanda_items.length>0&&e.jsxs("div",{className:"mt-3 border-t pt-3",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700 mb-2 block",children:["Itens (",S.comanda_items.length,"):"]}),e.jsx("div",{className:"space-y-1",children:S.comanda_items.map((T,M)=>{var $;return e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-gray-600",children:[T.quantity,"x"]}),e.jsx("span",{className:"text-gray-900",children:(($=T.menu_items)==null?void 0:$.name)||"Item sem nome"})]}),e.jsx("span",{className:"text-gray-600",children:w(T.price*T.quantity)})]},T.id||M)})})]})]},S.id))})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-md font-semibold text-gray-900 mb-3",children:"Método de Pagamento"}),e.jsx("div",{className:"grid grid-cols-2 gap-3",children:[{value:"dinheiro",label:"Dinheiro",icon:"💵"},{value:"cartao_credito",label:"Cartão de Crédito",icon:"💳"},{value:"cartao_debito",label:"Cartão de Débito",icon:"💳"},{value:"pix",label:"PIX",icon:"📱"},{value:"credito_socio",label:"Crédito do Sócio",icon:"👤"},{value:"misto",label:"Pagamento Misto",icon:"🔄"}].map(S=>e.jsx("button",{onClick:()=>f(S.value),className:`p-3 rounded-lg border-2 transition-colors text-left ${h===S.value?"border-blue-500 bg-blue-50 text-blue-900":"border-gray-200 hover:border-gray-300"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-lg",children:S.icon}),e.jsx("span",{className:"font-medium",children:S.label})]})},S.value))})]})]})}),e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 bg-gray-50 flex-shrink-0",children:[e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm mb-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-gray-900",children:v.length}),e.jsx("div",{className:"text-gray-600",children:"Comandas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-blue-600",children:_}),e.jsx("div",{className:"text-gray-600",children:"Itens"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"font-semibold text-green-600 text-lg",children:w(b)}),e.jsx("div",{className:"text-gray-600",children:"Total"})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:k,disabled:p,className:"flex-1 flex items-center justify-center space-x-2 bg-gray-600 text-white px-4 py-3 rounded-lg hover:bg-gray-700 transition-colors disabled:opacity-50",children:[e.jsx(q$,{className:"h-5 w-5"}),e.jsx("span",{children:p?"Imprimindo...":"Imprimir Prévia"})]}),e.jsxs("button",{onClick:C,disabled:!h||c,className:"flex-2 flex items-center justify-center space-x-2 bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(Ga,{className:"h-5 w-5"}),e.jsx("span",{children:c?"Finalizando...":"Finalizar Atendimento"})]})]})]})]})})},p7=({readonly:t=!1,onTableSelect:s,selectedTableId:a})=>{const{tables:r,loading:o,updateTablePosition:l,updateTableStatus:c,organizeTablesAutomatically:u}=Rr(),[h,f]=y.useState(!1),[p,g]=y.useState(null),[v,b]=y.useState(null),[_,w]=y.useState(null),[E,k]=y.useState(null),[N,C]=y.useState(null),[S,T]=y.useState(!1),[M,$]=y.useState(new Set),A=y.useRef(null),z=H=>{switch(H){case"available":return"bg-green-500 border-green-600";case"occupied":return"bg-red-500 border-red-600";case"reserved":return"bg-yellow-500 border-yellow-600";case"cleaning":return"bg-blue-500 border-blue-600";case"maintenance":return"bg-gray-500 border-gray-600";default:return"bg-gray-300 border-gray-400"}},R=H=>{switch(H){case"available":return"Disponível";case"occupied":return"Ocupada";case"reserved":return"Reservada";case"cleaning":return"Limpeza";case"maintenance":return"Manutenção";default:return"Indefinido"}},L=y.useCallback((H,F)=>{var ae;if(t||!S)return;const Z=(ae=A.current)==null?void 0:ae.getBoundingClientRect();if(!Z)return;const re=Math.max(0,Math.min(F.point.x-Z.left-40,Z.width-80)),oe=Math.max(0,Math.min(F.point.y-Z.top-40,Z.height-80));l(H,re,oe)},[t,S,l]),I=(H,F)=>{if(!M.has(H.id)){if(S&&!t){s&&s(H);return}w(H),s&&s(H)}},X=(H,F)=>{t||(H.preventDefault(),b({table:F,x:H.clientX,y:H.clientY}))},ce=H=>{g(H),f(!0),b(null)},J=()=>{g(null),f(!0)},V=()=>{b(null)},Y=async H=>{console.log("Iniciando atendimento para mesa:",H.number);try{await c(H.id,"occupied"),console.log("Status da mesa alterado para ocupada"),w(null),console.log("Abrindo painel de comandas automaticamente..."),k({...H,status:"occupied"}),s&&s(H)}catch(F){console.error("Erro ao iniciar atendimento:",F),alert("Erro ao iniciar atendimento: "+(F instanceof Error?F.message:"Erro desconhecido"))}},ee=H=>{console.log("Gerenciando comandas para mesa:",H.number),w(null),k(H)},we=H=>{console.log("Finalizando atendimento para mesa:",H.number),w(null),C(H)},D=async()=>{if(!A.current)return;const H=A.current.getBoundingClientRect(),F=H.width,Z=H.height;try{await u(F,Z)}catch(re){console.error("Erro ao organizar mesas:",re),alert("Erro ao organizar mesas. Tente novamente.")}};return o?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[e.jsxs("div",{className:"bg-white border-b p-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Layout das Mesas"}),e.jsxs("span",{className:"text-sm text-gray-500",children:[r.length," mesa",r.length!==1?"s":""]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:!t&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>T(!S),className:`px-3 py-2 rounded-lg text-sm font-medium transition-colors ${S?"bg-blue-100 text-blue-700 hover:bg-blue-200":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:S?e.jsxs(e.Fragment,{children:[e.jsx(M$,{className:"h-4 w-4 inline mr-1"}),"Sair do Modo Edição"]}):e.jsxs(e.Fragment,{children:[e.jsx(Nm,{className:"h-4 w-4 inline mr-1"}),"Modo Edição"]})}),e.jsxs("button",{onClick:D,className:"bg-green-600 text-white px-3 py-2 rounded-lg hover:bg-green-700 transition-colors text-sm font-medium",title:"Organizar mesas automaticamente",children:[e.jsx(Jj,{className:"h-4 w-4 inline mr-1"}),"Organizar"]}),e.jsxs("button",{onClick:J,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:[e.jsx(Ui,{className:"h-4 w-4 inline mr-1"}),"Nova Mesa"]})]})})]}),e.jsxs("div",{className:"bg-yellow-100 border-b p-2 text-sm",children:[e.jsx("strong",{children:"Debug Layout:"})," ",r.length," mesas, Modo Edição: ",S?"ON":"OFF"]}),e.jsx("div",{className:"flex-1 relative min-h-[600px] overflow-visible",ref:A,children:e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-br from-gray-100 to-gray-200 min-h-[600px]",children:[e.jsx("div",{className:"absolute inset-0 opacity-20",style:{backgroundImage:`
                linear-gradient(rgba(0,0,0,0.1) 1px, transparent 1px),
                linear-gradient(90deg, rgba(0,0,0,0.1) 1px, transparent 1px)
              `,backgroundSize:"20px 20px"}}),r.map((H,F)=>{const Z=H.position_x??50+F%5*120,re=H.position_y??50+Math.floor(F/5)*120;return console.log("Mesa:",H.number,"Posição:",{x:Z,y:re,dbX:H.position_x,dbY:H.position_y}),e.jsxs(be.div,{drag:S&&!t,dragMomentum:!1,dragElastic:0,onDragStart:()=>$(oe=>new Set(oe).add(H.id)),onDragEnd:(oe,ae)=>{L(H.id,ae),$(pe=>{const P=new Set(pe);return P.delete(H.id),P})},initial:{x:Z,y:re},animate:{x:Z,y:re},whileHover:M.has(H.id)?{}:{scale:1.05},whileDrag:{scale:1.1,zIndex:1e3},className:`absolute cursor-pointer select-none ${S&&!t?"cursor-move":"cursor-pointer"}`,onClick:oe=>I(H),onContextMenu:oe=>X(oe,H),children:[e.jsx("div",{className:`
                  w-20 h-20 rounded-lg border-2 shadow-lg transition-all duration-200
                  ${z(H.status||"available")}
                  ${a===H.id||(_==null?void 0:_.id)===H.id?"ring-4 ring-blue-300 ring-offset-2":""}
                  ${M.has(H.id)?"shadow-2xl":""}
                  hover:shadow-xl
                `,children:e.jsxs("div",{className:"h-full flex flex-col items-center justify-center text-white",children:[e.jsx("div",{className:"text-lg font-bold",children:H.number}),e.jsxs("div",{className:"text-xs opacity-90",children:[H.capacity,"p"]})]})}),e.jsx("div",{className:"absolute -bottom-6 left-1/2 transform -translate-x-1/2",children:e.jsx("div",{className:"bg-white px-2 py-1 rounded text-xs font-medium text-gray-700 shadow-sm border",children:R(H.status||"available")})})]},H.id)}),r.length===0&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Jj,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"Nenhuma mesa configurada"}),e.jsx("p",{className:"text-gray-500 mb-4",children:"Crie sua primeira mesa para começar a organizar o layout"}),!t&&e.jsxs("button",{onClick:J,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Ui,{className:"h-4 w-4 inline mr-1"}),"Criar Mesa"]})]})})]})}),e.jsx("div",{className:"bg-white border-t p-4",children:e.jsxs("div",{className:"flex items-center justify-center space-x-6 text-sm",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-green-500 border border-green-600"}),e.jsx("span",{children:"Disponível"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-red-500 border border-red-600"}),e.jsx("span",{children:"Ocupada"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-yellow-500 border border-yellow-600"}),e.jsx("span",{children:"Reservada"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-blue-500 border border-blue-600"}),e.jsx("span",{children:"Limpeza"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 rounded bg-gray-500 border border-gray-600"}),e.jsx("span",{children:"Manutenção"})]})]})}),e.jsx(Z2,{isOpen:h,onClose:()=>{f(!1),g(null)},table:p}),v&&e.jsx(u7,{table:v.table,x:v.x,y:v.y,onClose:V,onEdit:()=>ce(v.table)}),_&&e.jsx(m7,{table:_,onClose:()=>w(null),onEdit:H=>{w(null),ce(H)},onStartOrder:Y,onManageComandas:ee,onFinalizarAtendimento:we}),E&&e.jsx(h7,{table:E,onClose:()=>k(null),onCreateComanda:H=>{console.log("Nova comanda criada:",H),E.status==="available"&&c(E.id,"occupied")}}),N&&e.jsx(f7,{table:N,onClose:()=>C(null),onFinalized:()=>{console.log("Atendimento finalizado para mesa:",N.number)}})]})},g7=({onTableSelect:t,selectedTableId:s})=>{const{tables:a,loading:r,deleteTable:o}=Rr(),[l,c]=y.useState(!1),[u,h]=y.useState(null),[f,p]=y.useState(""),[g,v]=y.useState("all"),[b,_]=y.useState("number"),w=M=>{switch(M){case"available":return e.jsx(Ga,{className:"h-5 w-5 text-green-500"});case"occupied":return e.jsx(Wa,{className:"h-5 w-5 text-red-500"});case"reserved":return e.jsx(Za,{className:"h-5 w-5 text-yellow-500"});case"cleaning":return e.jsx(_r,{className:"h-5 w-5 text-blue-500"});case"maintenance":return e.jsx(_r,{className:"h-5 w-5 text-gray-500"});default:return e.jsx(Ga,{className:"h-5 w-5 text-gray-400"})}},E=M=>{switch(M){case"available":return"Disponível";case"occupied":return"Ocupada";case"reserved":return"Reservada";case"cleaning":return"Limpeza";case"maintenance":return"Manutenção";default:return"Indefinido"}},k=M=>{switch(M){case"available":return"bg-green-100 text-green-800";case"occupied":return"bg-red-100 text-red-800";case"reserved":return"bg-yellow-100 text-yellow-800";case"cleaning":return"bg-blue-100 text-blue-800";case"maintenance":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},N=Ye.useMemo(()=>{let M=a;return f&&(M=M.filter($=>{var A;return $.number.toLowerCase().includes(f.toLowerCase())||((A=$.notes)==null?void 0:A.toLowerCase().includes(f.toLowerCase()))})),g!=="all"&&(M=M.filter($=>$.status===g)),M.sort(($,A)=>{switch(b){case"number":return $.number.localeCompare(A.number,void 0,{numeric:!0});case"capacity":return A.capacity-$.capacity;case"status":return($.status||"").localeCompare(A.status||"");default:return 0}}),M},[a,f,g,b]),C=M=>{h(M),c(!0)},S=async M=>{if(confirm(`Tem certeza que deseja excluir a mesa ${M.number}?`))try{await o(M.id)}catch($){console.error("Erro ao excluir mesa:",$),alert("Erro ao excluir mesa. Tente novamente.")}},T=()=>{h(null),c(!0)};return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"h-full flex flex-col bg-white",children:[e.jsx("div",{className:"border-b p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 flex-1",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(rm,{className:"h-5 w-5 absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Buscar mesas...",value:f,onChange:M=>p(M.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("select",{value:g,onChange:M=>v(M.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"available",children:"Disponível"}),e.jsx("option",{value:"occupied",children:"Ocupada"}),e.jsx("option",{value:"reserved",children:"Reservada"}),e.jsx("option",{value:"cleaning",children:"Limpeza"}),e.jsx("option",{value:"maintenance",children:"Manutenção"})]}),e.jsxs("select",{value:b,onChange:M=>_(M.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"number",children:"Ordenar por Número"}),e.jsx("option",{value:"capacity",children:"Ordenar por Capacidade"}),e.jsx("option",{value:"status",children:"Ordenar por Status"})]})]}),e.jsxs("button",{onClick:T,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors flex items-center space-x-2",children:[e.jsx(Ui,{className:"h-4 w-4"}),e.jsx("span",{children:"Nova Mesa"})]})]})}),e.jsx("div",{className:"flex-1 overflow-auto",children:N.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Wa,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:f||g!=="all"?"Nenhuma mesa encontrada":"Nenhuma mesa cadastrada"}),e.jsx("p",{className:"text-gray-500 mb-4",children:f||g!=="all"?"Tente ajustar os filtros de busca":"Crie sua primeira mesa para começar"}),!f&&g==="all"&&e.jsxs("button",{onClick:T,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors",children:[e.jsx(Ui,{className:"h-4 w-4 inline mr-1"}),"Criar Mesa"]})]})}):e.jsx("div",{className:"divide-y divide-gray-200",children:N.map(M=>e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:`p-4 hover:bg-gray-50 transition-colors cursor-pointer ${s===M.id?"bg-blue-50 border-l-4 border-blue-500":""}`,onClick:()=>t==null?void 0:t(M),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"flex-shrink-0",children:w(M.status)}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Mesa ",M.number]}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${k(M.status)}`,children:E(M.status)})]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-1 text-sm text-gray-600",children:[e.jsxs("span",{children:["Capacidade: ",M.capacity," pessoas"]}),M.position_x!==null&&M.position_y!==null&&e.jsxs("span",{children:["Posição: (",M.position_x,", ",M.position_y,")"]})]}),M.notes&&e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:M.notes})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:$=>{$.stopPropagation(),C(M)},className:"p-2 text-gray-400 hover:text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Editar mesa",children:e.jsx(Nm,{className:"h-4 w-4"})}),e.jsx("button",{onClick:$=>{$.stopPropagation(),S(M)},className:"p-2 text-gray-400 hover:text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Excluir mesa",children:e.jsx(Sm,{className:"h-4 w-4"})})]})]})},M.id))})}),e.jsx("div",{className:"border-t p-4 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between text-sm text-gray-600",children:[e.jsxs("span",{children:[N.length," de ",a.length," mesa",a.length!==1?"s":""]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-green-500"}),e.jsxs("span",{children:[a.filter(M=>M.status==="available").length," disponíveis"]})]}),e.jsxs("span",{className:"flex items-center space-x-1",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-red-500"}),e.jsxs("span",{children:[a.filter(M=>M.status==="occupied").length," ocupadas"]})]})]})]})}),e.jsx(Z2,{isOpen:l,onClose:()=>{c(!1),h(null)},table:u})]})},x7=()=>{const{tables:t,loading:s}=Rr(),a=Ye.useMemo(()=>{const l=t.length,c=t.filter(w=>w.status==="available").length,u=t.filter(w=>w.status==="occupied").length,h=t.filter(w=>w.status==="reserved").length,f=t.filter(w=>w.status==="cleaning").length,p=t.filter(w=>w.status==="maintenance").length,g=t.reduce((w,E)=>w+E.capacity,0),v=l>0?g/l:0,b=l>0?u/l*100:0,_=l>0?c/l*100:0;return{total:l,available:c,occupied:u,reserved:h,cleaning:f,maintenance:p,totalCapacity:g,averageCapacity:v,occupancyRate:b,availabilityRate:_}},[t]),r=[{title:"Disponíveis",value:a.available,icon:Ga,color:"text-green-600",bgColor:"bg-green-100",percentage:a.total>0?a.available/a.total*100:0},{title:"Ocupadas",value:a.occupied,icon:Wa,color:"text-red-600",bgColor:"bg-red-100",percentage:a.total>0?a.occupied/a.total*100:0},{title:"Reservadas",value:a.reserved,icon:Za,color:"text-yellow-600",bgColor:"bg-yellow-100",percentage:a.total>0?a.reserved/a.total*100:0},{title:"Limpeza",value:a.cleaning,icon:_r,color:"text-blue-600",bgColor:"bg-blue-100",percentage:a.total>0?a.cleaning/a.total*100:0},{title:"Manutenção",value:a.maintenance,icon:_r,color:"text-gray-600",bgColor:"bg-gray-100",percentage:a.total>0?a.maintenance/a.total*100:0}],o=Ye.useMemo(()=>{const l={};return t.forEach(c=>{l[c.capacity]=(l[c.capacity]||0)+1}),Object.entries(l).map(([c,u])=>({capacity:parseInt(c),count:u,percentage:a.total>0?u/a.total*100:0})).sort((c,u)=>c.capacity-u.capacity)},[t,a.total]);return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})}):e.jsx("div",{className:"h-full overflow-auto bg-gray-50 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Resumo Geral"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-blue-600",children:a.total}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total de Mesas"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-green-600",children:a.totalCapacity}),e.jsx("div",{className:"text-sm text-gray-600",children:"Capacidade Total"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-3xl font-bold text-purple-600",children:a.averageCapacity.toFixed(1)}),e.jsx("div",{className:"text-sm text-gray-600",children:"Capacidade Média"})]}),e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-bold text-orange-600",children:[a.occupancyRate.toFixed(1),"%"]}),e.jsx("div",{className:"text-sm text-gray-600",children:"Taxa de Ocupação"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Status das Mesas"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:r.map((l,c)=>{const u=l.icon;return e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:c*.1},className:"bg-white border rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:l.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:l.value}),e.jsxs("p",{className:"text-xs text-gray-500",children:[l.percentage.toFixed(1),"%"]})]}),e.jsx("div",{className:`p-3 rounded-full ${l.bgColor}`,children:e.jsx(u,{className:`h-6 w-6 ${l.color}`})})]}),e.jsx("div",{className:"mt-3",children:e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:`h-2 rounded-full transition-all duration-500 ${l.color.includes("green")?"bg-green-500":l.color.includes("red")?"bg-red-500":l.color.includes("yellow")?"bg-yellow-500":l.color.includes("blue")?"bg-blue-500":"bg-gray-500"}`,style:{width:`${l.percentage}%`}})})})]},l.title)})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Distribuição por Capacidade"}),o.length>0?e.jsx("div",{className:"space-y-4",children:o.map((l,c)=>e.jsxs(be.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:c*.1},className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Wa,{className:"h-5 w-5 text-gray-500"}),e.jsxs("span",{className:"font-medium text-gray-900",children:[l.capacity," pessoa",l.capacity!==1?"s":""]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[l.count," mesa",l.count!==1?"s":""]}),e.jsx("div",{className:"w-24 bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"h-2 bg-blue-500 rounded-full transition-all duration-500",style:{width:`${l.percentage}%`}})}),e.jsxs("span",{className:"text-sm font-medium text-gray-900 w-12 text-right",children:[l.percentage.toFixed(1),"%"]})]})]},l.capacity))}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx(V2,{className:"h-16 w-16 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhuma mesa cadastrada"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Taxa de Disponibilidade"}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"relative w-32 h-32",children:[e.jsxs("svg",{className:"w-32 h-32 transform -rotate-90",viewBox:"0 0 36 36",children:[e.jsx("path",{className:"text-gray-300",stroke:"currentColor",strokeWidth:"3",fill:"none",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"}),e.jsx("path",{className:"text-green-500",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:`${a.availabilityRate}, 100`,d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:[a.availabilityRate.toFixed(0),"%"]})})]})}),e.jsxs("p",{className:"text-center text-sm text-gray-600 mt-4",children:[a.available," de ",a.total," mesas disponíveis"]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Taxa de Ocupação"}),e.jsx("div",{className:"flex items-center justify-center",children:e.jsxs("div",{className:"relative w-32 h-32",children:[e.jsxs("svg",{className:"w-32 h-32 transform -rotate-90",viewBox:"0 0 36 36",children:[e.jsx("path",{className:"text-gray-300",stroke:"currentColor",strokeWidth:"3",fill:"none",d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"}),e.jsx("path",{className:"text-red-500",stroke:"currentColor",strokeWidth:"3",fill:"none",strokeDasharray:`${a.occupancyRate}, 100`,d:"M18 2.0845 a 15.9155 15.9155 0 0 1 0 31.831 a 15.9155 15.9155 0 0 1 0 -31.831"})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs("span",{className:"text-2xl font-bold text-gray-900",children:[a.occupancyRate.toFixed(0),"%"]})})]})}),e.jsxs("p",{className:"text-center text-sm text-gray-600 mt-4",children:[a.occupied," de ",a.total," mesas ocupadas"]})]})]})]})})},y7=()=>{const[t,s]=y.useState("layout"),[a,r]=y.useState(null),o=[{id:"layout",name:"Layout Visual",icon:Y$,description:"Visualizar e organizar mesas no layout"},{id:"list",name:"Lista",icon:P$,description:"Visualizar mesas em formato de lista"},{id:"stats",name:"Estatísticas",icon:V2,description:"Métricas e relatórios das mesas"}],l=u=>{r(u)},c=()=>{switch(t){case"layout":return e.jsx(p7,{onTableSelect:l,selectedTableId:a==null?void 0:a.id});case"list":return e.jsx(g7,{onTableSelect:l,selectedTableId:a==null?void 0:a.id});case"stats":return e.jsx(x7,{});default:return null}};return e.jsxs("div",{className:"h-full flex flex-col bg-gray-50",children:[e.jsx("div",{className:"bg-white border-b",children:e.jsxs("div",{className:"px-6 py-4",children:[e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Gerenciamento de Mesas"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Configure e monitore as mesas do estabelecimento"})]})}),e.jsx("div",{className:"mt-6",children:e.jsx("nav",{className:"flex space-x-8",children:o.map(u=>{const h=u.icon,f=t===u.id;return e.jsxs("button",{onClick:()=>s(u.id),className:`relative flex items-center space-x-2 py-2 px-1 border-b-2 font-medium text-sm transition-colors ${f?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(h,{className:"h-5 w-5"}),e.jsx("span",{children:u.name}),f&&e.jsx(be.div,{layoutId:"activeTab",className:"absolute inset-0 bg-blue-50 rounded-md -z-10",initial:!1,transition:{type:"spring",bounce:.2,duration:.6}})]},u.id)})})})]})}),e.jsx("div",{className:"flex-1 overflow-hidden",children:e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},className:"h-full",children:c()},t)}),a&&e.jsx(be.div,{initial:{opacity:0,y:100},animate:{opacity:1,y:0},exit:{opacity:0,y:100},className:"bg-white border-t p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-4 h-4 rounded-full ${a.status==="available"?"bg-green-500":a.status==="occupied"?"bg-red-500":a.status==="reserved"?"bg-yellow-500":a.status==="cleaning"?"bg-blue-500":"bg-gray-500"}`}),e.jsxs("span",{className:"font-medium",children:["Mesa ",a.number]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Capacidade: ",a.capacity," pessoas"]}),a.notes&&e.jsx("div",{className:"text-sm text-gray-500",children:a.notes})]}),e.jsx("button",{onClick:()=>r(null),className:"text-gray-400 hover:text-gray-600",children:"×"})]})})]})},b7=()=>e.jsx(y7,{}),v7=({isOpen:t,onClose:s,selectedTable:a,onComandaCreated:r})=>{const{user:o}=jt(),{tables:l}=Rr(),{createComanda:c}=Ki(),[u,h]=y.useState({table_id:(a==null?void 0:a.id)||"",customer_id:"",customer_name:"",people_count:1,notes:""}),[f,p]=y.useState(""),[g,v]=y.useState([]),[b,_]=y.useState(!1),[w,E]=y.useState(!1),k=async S=>{if(!S.trim()){v([]);return}try{_(!0);const{data:T,error:M}=await B.from("bar_customers").select("*").or(`phone.ilike.%${S}%,name.ilike.%${S}%`).eq("status","active").limit(10);if(M)throw M;v(T||[])}catch(T){console.error("Erro ao buscar clientes:",T)}finally{_(!1)}},N=S=>{h(T=>({...T,customer_id:S.id,customer_name:S.name})),p(S.name),v([])},C=async S=>{if(S.preventDefault(),!!o)try{E(!0);const T={table_id:u.table_id||void 0,customer_id:u.customer_id||void 0,customer_name:u.customer_name||void 0,employee_id:o.id,people_count:u.people_count,notes:u.notes||void 0};await c(T),r&&r(),s(),h({table_id:"",customer_id:"",customer_name:"",people_count:1,notes:""}),p("")}catch(T){console.error("Erro ao criar comanda:",T),alert("Erro ao criar comanda. Tente novamente.")}finally{E(!1)}};return y.useEffect(()=>{a&&h(S=>({...S,table_id:a.id}))},[a]),y.useEffect(()=>{const S=setTimeout(()=>{k(f)},300);return()=>clearTimeout(S)},[f]),t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Nova Comanda"}),e.jsx("button",{onClick:s,className:"text-gray-400 hover:text-gray-600",children:e.jsx(nt,{className:"w-6 h-6"})})]}),e.jsxs("form",{onSubmit:C,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Fc,{className:"w-4 h-4 inline mr-1"}),"Mesa (opcional)"]}),e.jsxs("select",{value:u.table_id,onChange:S=>h(T=>({...T,table_id:S.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Balcão (sem mesa)"}),l.filter(S=>S.status==="available").map(S=>e.jsxs("option",{value:S.id,children:["Mesa ",S.number," (",S.capacity," pessoas)"]},S.id))]})]}),e.jsxs("div",{className:"relative",children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Ks,{className:"w-4 h-4 inline mr-1"}),"Cliente (opcional)"]}),e.jsx("input",{type:"text",value:f,onChange:S=>{p(S.target.value),S.target.value||h(T=>({...T,customer_id:"",customer_name:""}))},placeholder:"Buscar por telefone ou nome...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"}),g.length>0&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-40 overflow-y-auto",children:g.map(S=>e.jsxs("button",{type:"button",onClick:()=>N(S),className:"w-full px-3 py-2 text-left hover:bg-gray-100 focus:bg-gray-100",children:[e.jsx("div",{className:"font-medium",children:S.name}),e.jsx("div",{className:"text-sm text-gray-600",children:S.phone})]},S.id))}),b&&e.jsx("div",{className:"absolute right-3 top-9",children:e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-blue-600"})})]}),f&&!u.customer_id&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome do cliente"}),e.jsx("input",{type:"text",value:u.customer_name,onChange:S=>h(T=>({...T,customer_name:S.target.value})),placeholder:"Digite o nome do cliente",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[e.jsx(Ns,{className:"w-4 h-4 inline mr-1"}),"Número de pessoas"]}),e.jsx("input",{type:"number",min:"1",max:"20",value:u.people_count,onChange:S=>h(T=>({...T,people_count:parseInt(S.target.value)||1})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observações"}),e.jsx("textarea",{value:u.notes,onChange:S=>h(T=>({...T,notes:S.target.value})),placeholder:"Observações sobre a comanda...",rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:w,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:w?"Criando...":"Criar Comanda"})]})]})]})}):null},w7=({comandas:t,onComandaClick:s,onDismissAlert:a})=>{const r=()=>{const h=new Date;return t.filter(f=>{if(f.status!=="open")return!1;const p=new Date(f.opened_at);return(h.getTime()-p.getTime())/(1e3*60*60)>2})},o=()=>{const h=new Date;return t.filter(f=>{if(f.status!=="open")return!1;const p=new Date(f.opened_at);return(h.getTime()-p.getTime())/(1e3*60*60)>4})},l=h=>{const f=new Date(h),g=new Date().getTime()-f.getTime(),v=Math.floor(g/(1e3*60*60)),b=Math.floor(g%(1e3*60*60)/(1e3*60));return v>0?`${v}h ${b}m`:`${b}m`},c=r(),u=o();return c.length===0?null:e.jsxs("div",{className:"mb-6 space-y-3",children:[u.map(h=>{var f,p;return e.jsx("div",{className:"bg-red-50 border-l-4 border-red-400 p-4 rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(yt,{className:"w-6 h-6 text-red-500"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-red-800 font-semibold",children:["Comanda Crítica - ",((f=h.table)==null?void 0:f.number)||"Balcão"]}),e.jsxs("p",{className:"text-red-700 text-sm",children:[((p=h.customer)==null?void 0:p.name)||h.customer_name||"Cliente não identificado"," • Aberta há ",l(h.opened_at)," • R$ ",h.total.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>s(h),className:"px-3 py-1 bg-red-600 text-white text-sm rounded hover:bg-red-700 transition-colors",children:"Ver Detalhes"}),a&&e.jsx("button",{onClick:()=>a(h.id),className:"p-1 text-red-500 hover:bg-red-100 rounded transition-colors",children:e.jsx(nt,{className:"w-4 h-4"})})]})]})},`critical-${h.id}`)}),c.filter(h=>!u.includes(h)).map(h=>{var f,p;return e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg shadow-sm",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Bt,{className:"w-5 h-5 text-yellow-500"}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-yellow-800 font-semibold",children:["Atenção - ",((f=h.table)==null?void 0:f.number)||"Balcão"]}),e.jsxs("p",{className:"text-yellow-700 text-sm",children:[((p=h.customer)==null?void 0:p.name)||h.customer_name||"Cliente não identificado"," • Aberta há ",l(h.opened_at)," • R$ ",h.total.toFixed(2)]})]})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("button",{onClick:()=>s(h),className:"px-3 py-1 bg-yellow-600 text-white text-sm rounded hover:bg-yellow-700 transition-colors",children:"Ver Detalhes"}),a&&e.jsx("button",{onClick:()=>a(h.id),className:"p-1 text-yellow-500 hover:bg-yellow-100 rounded transition-colors",children:e.jsx(nt,{className:"w-4 h-4"})})]})]})},`warning-${h.id}`)}),c.length>3&&e.jsx("div",{className:"bg-gray-50 border border-gray-200 p-3 rounded-lg text-center",children:e.jsxs("p",{className:"text-gray-600 text-sm",children:[c.length," comandas com tempo excessivo •",u.length," críticas"]})})]})},j7=({searchTerm:t,onSearchChange:s,statusFilter:a,onStatusFilterChange:r,employeeFilter:o,onEmployeeFilterChange:l,tableFilter:c,onTableFilterChange:u,timeFilter:h,onTimeFilterChange:f,employees:p,tables:g,onClearFilters:v})=>{var E,k;const b=t||a!=="all"||o||c||h!=="all",_=N=>{switch(N){case"all":return"Todos os Status";case"open":return"Abertas";case"pending_payment":return"Aguardando Pagamento";case"closed":return"Fechadas";case"cancelled":return"Canceladas";default:return N}},w=N=>{switch(N){case"all":return"Todos os Tempos";case"recent":return"Recentes (< 1h)";case"overdue":return"Atrasadas (> 2h)";case"critical":return"Críticas (> 4h)";default:return N}};return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(vg,{className:"w-5 h-5 text-gray-500"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Filtros"})]}),b&&e.jsxs("button",{onClick:v,className:"flex items-center space-x-1 px-3 py-1 text-sm text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:[e.jsx(nt,{className:"w-4 h-4"}),e.jsx("span",{children:"Limpar Filtros"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4",children:[e.jsxs("div",{className:"xl:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Buscar"}),e.jsxs("div",{className:"relative",children:[e.jsx(Xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400"}),e.jsx("input",{type:"text",value:t,onChange:N=>s(N.target.value),placeholder:"Mesa, cliente ou funcionário...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Status"}),e.jsxs("select",{value:a,onChange:N=>r(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Status"}),e.jsx("option",{value:"open",children:"Abertas"}),e.jsx("option",{value:"pending_payment",children:"Aguardando Pagamento"}),e.jsx("option",{value:"closed",children:"Fechadas"}),e.jsx("option",{value:"cancelled",children:"Canceladas"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Funcionário"}),e.jsxs("select",{value:o,onChange:N=>l(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todos os Funcionários"}),p.map(N=>e.jsx("option",{value:N.id,children:N.name},N.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Mesa"}),e.jsxs("select",{value:c,onChange:N=>u(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"",children:"Todas as Mesas"}),e.jsx("option",{value:"balcao",children:"Balcão"}),g.map(N=>e.jsxs("option",{value:N.id,children:["Mesa ",N.number]},N.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Tempo"}),e.jsxs("select",{value:h,onChange:N=>f(N.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todos os Tempos"}),e.jsx("option",{value:"recent",children:"Recentes (< 1h)"}),e.jsx("option",{value:"overdue",children:"Atrasadas (> 2h)"}),e.jsx("option",{value:"critical",children:"Críticas (> 4h)"})]})]})]}),b&&e.jsxs("div",{className:"mt-4 flex flex-wrap gap-2",children:[t&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-blue-100 text-blue-800 text-xs font-medium rounded-full",children:['Busca: "',t,'"',e.jsx("button",{onClick:()=>s(""),className:"ml-1 p-0.5 hover:bg-blue-200 rounded-full",children:e.jsx(nt,{className:"w-3 h-3"})})]}),a!=="all"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-green-100 text-green-800 text-xs font-medium rounded-full",children:["Status: ",_(a),e.jsx("button",{onClick:()=>r("all"),className:"ml-1 p-0.5 hover:bg-green-200 rounded-full",children:e.jsx(nt,{className:"w-3 h-3"})})]}),o&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-purple-100 text-purple-800 text-xs font-medium rounded-full",children:["Funcionário: ",(E=p.find(N=>N.id===o))==null?void 0:E.name,e.jsx("button",{onClick:()=>l(""),className:"ml-1 p-0.5 hover:bg-purple-200 rounded-full",children:e.jsx(nt,{className:"w-3 h-3"})})]}),c&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-orange-100 text-orange-800 text-xs font-medium rounded-full",children:["Mesa: ",c==="balcao"?"Balcão":(k=g.find(N=>N.id===c))==null?void 0:k.number,e.jsx("button",{onClick:()=>u(""),className:"ml-1 p-0.5 hover:bg-orange-200 rounded-full",children:e.jsx(nt,{className:"w-3 h-3"})})]}),h!=="all"&&e.jsxs("span",{className:"inline-flex items-center px-2 py-1 bg-red-100 text-red-800 text-xs font-medium rounded-full",children:["Tempo: ",w(h),e.jsx("button",{onClick:()=>f("all"),className:"ml-1 p-0.5 hover:bg-red-200 rounded-full",children:e.jsx(nt,{className:"w-3 h-3"})})]})]})]})},_7=[{value:"dinheiro",label:"Dinheiro",icon:"💵"},{value:"cartao_debito",label:"Cartão Débito",icon:"💳"},{value:"cartao_credito",label:"Cartão Crédito",icon:"💳"},{value:"pix",label:"PIX",icon:"📱"},{value:"vale_refeicao",label:"Vale Refeição",icon:"🎫"},{value:"credito_conta",label:"Crédito em Conta",icon:"👤"}],W2=({isOpen:t,comanda:s,onClose:a,onConfirm:r,loading:o=!1})=>{const[l,c]=y.useState("dinheiro"),[u,h]=y.useState("");if(!t||!s)return null;const f=async()=>{await r(l,u.trim()||void 0)},p=g=>new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(g);return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Wi,{className:"w-6 h-6 text-green-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Processar Pagamento"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Comanda #",_m(s.id),s.table&&` - Mesa ${s.table.number}`]})]})]}),e.jsx("button",{onClick:a,disabled:o,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(nt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Detalhes da Comanda"}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Cliente"}),e.jsx("p",{className:"font-medium",children:s.customer_name||"Cliente"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Mesa"}),e.jsx("p",{className:"font-medium",children:s.table?`Mesa ${s.table.number}`:"Balcão"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pessoas"}),e.jsx("p",{className:"font-medium",children:s.people_count||1})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Aberta em"}),e.jsx("p",{className:"font-medium",children:new Date(s.opened_at||s.created_at||"").toLocaleString("pt-BR")})]})]}),s.items&&s.items.length>0&&e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Itens (",s.items.length,")"]}),e.jsx("div",{className:"space-y-2 max-h-32 overflow-y-auto",children:s.items.map((g,v)=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("span",{children:[g.quantity,"x ",g.product_name]}),e.jsx("span",{className:"font-medium",children:p(g.total_price)})]},g.id))})]}),e.jsx("div",{className:"border-t pt-3 mt-3",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Total"}),e.jsx("span",{className:"text-2xl font-bold text-green-600",children:p(s.total||0)})]})})]})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Método de Pagamento"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 gap-3",children:_7.map(g=>e.jsx("button",{onClick:()=>c(g.value),disabled:o,className:`p-4 rounded-lg border-2 transition-all ${l===g.value?"border-green-500 bg-green-50 text-green-700":"border-gray-200 hover:border-gray-300 text-gray-700"}`,children:e.jsxs("div",{className:"flex flex-col items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:g.icon}),e.jsx("span",{className:"text-sm font-medium text-center",children:g.label})]})},g.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observações (opcional)"}),e.jsx("textarea",{value:u,onChange:g=>h(g.target.value),disabled:o,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Adicione observações sobre o pagamento..."})]})]}),e.jsx("div",{className:"border-t bg-gray-50 p-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,disabled:o,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancelar"}),e.jsx("button",{onClick:f,disabled:o,className:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Processando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ut,{className:"w-4 h-4"}),"Confirmar Pagamento"]})})]})})]})})},Y2=()=>{const{user:t}=jt(),[s,a]=y.useState({mesas:[],comandas:[],metricas:null,notificacoes:[],loading:!0,error:null}),r=y.useCallback(R=>{a(L=>({...L,...R}))},[]),o=y.useCallback((R,L)=>{console.error(`Erro em ${L}:`,R),r({error:`Erro em ${L}: ${R.message||"Erro desconhecido"}`,loading:!1})},[r]),l=y.useCallback(async()=>{if(t)try{r({loading:!0,error:null});const{data:R,error:L}=await B.from("bar_tables").select(`
          *,
          comandas!comandas_table_id_fkey(
            id,
            customer_name,
            people_count,
            total,
            opened_at,
            status,
            comanda_items(
              id,
              quantity,
              price,
              status
            )
          )
        `).order("number");if(L)throw L;const I=(R==null?void 0:R.map(ee=>{var D;const we=(D=ee.comandas)==null?void 0:D.find(H=>H.status==="open");return{...ee,currentComanda:we||void 0,occupiedSince:(we==null?void 0:we.opened_at)||void 0,currentTotal:(we==null?void 0:we.total)||0,peopleCount:(we==null?void 0:we.people_count)||0}}))||[],{data:X,error:ce}=await B.from("comandas").select(`
          *,
          bar_tables(number, capacity),
          bar_customers(name, phone),
          comanda_items(
            *,
            menu_items(name, price, category)
          )
        `).in("status",["open","pending_payment"]).order("opened_at",{ascending:!1});if(ce)throw ce;const J=(X==null?void 0:X.map(ee=>({...ee,items:ee.comanda_items||[],table:ee.bar_tables||void 0,customer:ee.bar_customers||void 0})))||[],{data:V,error:Y}=await B.from("attendance_metrics").select("*").eq("employee_id",t.id).eq("date",new Date().toISOString().split("T")[0]).maybeSingle();Y&&console.warn("Erro ao carregar métricas:",Y),r({mesas:I,comandas:J,metricas:V||null,loading:!1})}catch(R){o(R,"carregamento inicial")}},[t,r,o]);y.useEffect(()=>{if(!t)return;const R=[],L=B.channel("bar-tables-changes").on("postgres_changes",{event:"*",schema:"public",table:"bar_tables"},ce=>{console.log("Mudança em mesas:",ce),l()}).subscribe();R.push(L);const I=B.channel("comandas-changes").on("postgres_changes",{event:"*",schema:"public",table:"comandas"},ce=>{console.log("Mudança em comandas:",ce),l()}).subscribe();R.push(I);const X=B.channel("comanda-items-changes").on("postgres_changes",{event:"*",schema:"public",table:"comanda_items"},ce=>{console.log("Mudança em itens de comanda:",ce),l()}).subscribe();return R.push(X),()=>{R.forEach(ce=>B.removeChannel(ce))}},[t,l]),y.useEffect(()=>{t&&l()},[t,l]);const c=y.useCallback(async(R,L,I)=>{if(!t)throw new Error("Usuário não autenticado");try{r({loading:!0,error:null});const{data:X,error:ce}=await B.from("comandas").insert({table_id:R||null,customer_name:L||null,people_count:I||1,employee_id:t.id,status:"open",opened_at:new Date().toISOString(),total:0}).select().single();if(ce)throw ce;return R&&await h(R,"occupied"),await l(),X.id}catch(X){throw o(X,"criação de comanda"),X}},[t,r,o,l]),u=y.useCallback(async(R,L)=>{try{r({loading:!0,error:null});const{error:I}=await B.from("comandas").update({...L,updated_at:new Date().toISOString()}).eq("id",R);if(I)throw I;await l()}catch(I){throw o(I,"atualização de comanda"),I}},[r,o,l]),h=y.useCallback(async(R,L)=>{try{const{error:I}=await B.from("bar_tables").update({status:L,updated_at:new Date().toISOString()}).eq("id",R);if(I)throw I;await l()}catch(I){throw o(I,"atualização de status da mesa"),I}},[o,l]),f=y.useCallback(async R=>{try{await h(R,"cleaning"),setTimeout(async()=>{await h(R,"available")},5*60*1e3)}catch(L){throw o(L,"liberação de mesa"),L}},[h,o]),p=y.useCallback(async R=>{if(t)try{const L=new Date().toISOString().split("T")[0],{data:I,error:X}=await B.from("attendance_metrics").select("*").eq("employee_id",t.id).eq("date",L).single();if(X&&X.code!=="PGRST116")throw X;if(I){const{error:ce}=await B.from("attendance_metrics").update({total_sales:(I.total_sales||0)+R,orders_count:(I.orders_count||0)+1,comandas_count:(I.comandas_count||0)+1,updated_at:new Date().toISOString()}).eq("id",I.id);if(ce)throw ce}else{const{error:ce}=await B.from("attendance_metrics").insert({employee_id:t.id,date:L,total_sales:R,orders_count:1,comandas_count:1});if(ce)throw ce}}catch(L){console.error("Erro ao atualizar métricas de venda:",L)}},[t]),g=y.useCallback(async(R,L,I)=>{try{r({loading:!0,error:null});const{data:X,error:ce}=await B.from("comandas").select("table_id, total").eq("id",R).single();if(ce)throw ce;const{error:J}=await B.from("comandas").update({status:"pending_payment",payment_method:L,notes:I,updated_at:new Date().toISOString()}).eq("id",R);if(J)throw J;await l()}catch(X){throw o(X,"envio de comanda para caixa"),X}},[r,o,l]),v=y.useCallback(async(R,L,I,X)=>{try{r({loading:!0,error:null});const{data:ce,error:J}=await B.from("menu_items").select("price").eq("id",L).single();if(J)throw J;const{error:V}=await B.from("comanda_items").insert({comanda_id:R,menu_item_id:L,quantity:I,price:ce.price,notes:X,status:"pending",added_at:new Date().toISOString()});if(V)throw V;const{data:Y,error:ee}=await B.from("comanda_items").select("quantity, price").eq("comanda_id",R);if(ee)throw ee;const we=Y.reduce((D,H)=>D+H.quantity*H.price,0);await u(R,{total:we})}catch(ce){throw o(ce,"adição de item à comanda"),ce}},[r,o,u]),b=y.useCallback(async R=>{try{r({loading:!0,error:null});const{data:L,error:I}=await B.from("comanda_items").select("comanda_id").eq("id",R).single();if(I)throw I;const{error:X}=await B.from("comanda_items").delete().eq("id",R);if(X)throw X;const{data:ce,error:J}=await B.from("comanda_items").select("quantity, price").eq("comanda_id",L.comanda_id);if(J)throw J;const V=ce.reduce((Y,ee)=>Y+ee.quantity*ee.price,0);await u(L.comanda_id,{total:V})}catch(L){throw o(L,"remoção de item da comanda"),L}},[r,o,u]),_=y.useCallback(async(R,L)=>{try{const I={status:L,updated_at:new Date().toISOString()};L==="ready"?I.prepared_at=new Date().toISOString():L==="delivered"&&(I.delivered_at=new Date().toISOString());const{error:X}=await B.from("comanda_items").update(I).eq("id",R);if(X)throw X;await l()}catch(I){throw o(I,"atualização de status do item"),I}},[o,l]),w=y.useCallback(async(R,L)=>{try{await h(R,"occupied"),L&&await u(L,{table_id:R})}catch(I){throw o(I,"ocupação de mesa"),I}},[h,u,o]),E=y.useCallback(async(R,L,I)=>{try{const{error:X}=await B.from("bar_tables").update({status:"reserved",notes:`Reservado para ${L} às ${I.toLocaleTimeString()}`,updated_at:new Date().toISOString()}).eq("id",R);if(X)throw X;await l()}catch(X){throw o(X,"reserva de mesa"),X}},[o,l]),k=y.useCallback(async R=>{try{await h(R,"available")}catch(L){throw o(L,"limpeza de mesa"),L}},[h,o]),N=y.useCallback(async R=>{var L;if(!t)throw new Error("Usuário não autenticado");try{r({loading:!0,error:null});const{data:I,error:X}=await B.from("comandas").insert({customer_name:((L=R.customer)==null?void 0:L.name)||"Cliente Balcão",employee_id:t.id,status:"closed",opened_at:new Date().toISOString(),closed_at:new Date().toISOString(),total:R.total,payment_method:R.payment_method||"dinheiro",notes:R.notes}).select().single();if(X)throw X;const ce=R.items.map(V=>({comanda_id:I.id,menu_item_id:V.menu_item_id,quantity:V.quantity,price:V.price,notes:V.notes,status:"delivered",added_at:new Date().toISOString(),delivered_at:new Date().toISOString()})),{error:J}=await B.from("comanda_items").insert(ce);if(J)throw J;return await p(R.total),await l(),I.id}catch(I){throw o(I,"processamento de pedido do balcão"),I}},[t,r,o,l]),C=y.useCallback(async(R,L)=>{if(!t)throw new Error("Usuário não autenticado");try{r({loading:!0,error:null});const{error:I}=await B.from("bill_splits").insert({comanda_id:R,split_type:L.type,person_count:L.person_count,splits:L.splits,total_amount:L.splits.reduce((X,ce)=>X+ce.total,0),service_charge:L.service_charge_percentage||0,discount_amount:L.discount_amount||0,created_by:t.id});if(I)throw I;await l()}catch(I){throw o(I,"divisão de conta"),I}},[t,r,o,l]),S=y.useCallback(async()=>{if(t)try{const R=new Date().toISOString().split("T")[0],{data:L}=await B.from("attendance_metrics").select("*").eq("employee_id",t.id).eq("date",R).single(),{data:I}=await B.from("comandas").select("total, opened_at, closed_at").eq("employee_id",t.id).gte("opened_at",`${R}T00:00:00`).lt("opened_at",`${R}T23:59:59`),X=(I==null?void 0:I.reduce((V,Y)=>V+(Y.total||0),0))||0,ce=(I==null?void 0:I.length)||0,J={employee_id:t.id,date:R,comandas_count:ce,total_sales:X,orders_count:ce,updated_at:new Date().toISOString()};if(L){const{error:V}=await B.from("attendance_metrics").update(J).eq("id",L.id);if(V)throw V}else{const{error:V}=await B.from("attendance_metrics").insert(J);if(V)throw V}await l()}catch(R){o(R,"atualização de métricas")}},[t,o,l]),T=y.useCallback(async R=>{r({notificacoes:s.notificacoes.map(L=>L.id===R?{...L,read:!0}:L)})},[s.notificacoes,r]),M=y.useCallback(async()=>{r({notificacoes:[]})},[r]),$=y.useCallback(async()=>{await l()},[l]),A=y.useCallback(R=>s.comandas.find(L=>L.table_id===R&&L.status==="open"),[s.comandas]),z=y.useCallback(R=>s.mesas.find(L=>L.number===R),[s.mesas]);return{...s,criarComanda:c,atualizarComanda:u,fecharComanda:g,adicionarItemComanda:v,removerItemComanda:b,atualizarStatusItem:_,ocuparMesa:w,liberarMesa:f,reservarMesa:E,limparMesa:k,atualizarStatusMesa:h,processarPedidoBalcao:N,dividirConta:C,atualizarMetricas:S,marcarNotificacaoLida:T,limparNotificacoes:M,recarregarDados:$,obterComandaPorMesa:A,obterMesaPorNumero:z}},N7=()=>{var Ge,Qe;const{comandas:t,loading:s,refetch:a}=Ki(),{tables:r}=Rr(),[o,l]=y.useState(""),[c,u]=y.useState("all"),[h,f]=y.useState(""),[p,g]=y.useState(""),[v,b]=y.useState("all"),[_,w]=y.useState(!1),[E,k]=y.useState(null),[N,C]=y.useState(new Set),[S,T]=y.useState("list"),[M,$]=y.useState([]),[A,z]=y.useState("all"),[R,L]=y.useState(""),[I,X]=y.useState(!1),[ce,J]=y.useState(!1),[V,Y]=y.useState(""),[ee,we]=y.useState(!1),[D,H]=y.useState(null),[F,Z]=y.useState(!1),{menuItems:re,loading:oe}=F2(!0),{adicionarItemComanda:ae,fecharComanda:pe}=Y2(),{refreshBarOrders:P,refreshKitchenOrders:q}=Tt();y.useEffect(()=>{if(E&&t.length>0){const xe=t.find(Te=>Te.id===E.id);xe&&(console.log("🔄 Atualizando comanda selecionada com novos dados:",xe),k(xe))}},[t,E==null?void 0:E.id]);const Q=()=>{w(!0)},G=xe=>{k(xe),T("details")},me=()=>{T("list"),k(null),$([])},Ne=xe=>{console.log("Adicionando item ao carrinho:",xe);const Te=M.findIndex(he=>he.menu_item_id===xe.id);if(Te>=0){const he=[...M];he[Te].quantity+=1,$(he),console.log("Item já existia, quantidade atualizada:",he)}else{const he={menu_item_id:xe.id,name:xe.name,price:typeof xe.price=="string"?parseFloat(xe.price):xe.price,quantity:1,notes:""},le=[...M,he];$(le),console.log("Novo item adicionado ao carrinho:",le)}},je=(xe,Te)=>{Te<=0?$(M.filter(he=>he.menu_item_id!==xe)):$(M.map(he=>he.menu_item_id===xe?{...he,quantity:Te}:he))},Re=()=>M.reduce((xe,Te)=>xe+Te.price*Te.quantity,0),Ie=async()=>{if(console.log("🔥 Botão clicado! Iniciando adição de itens à comanda"),console.log("Comanda selecionada:",E),console.log("Itens no carrinho:",M),!E){console.error("❌ Nenhuma comanda selecionada");return}if(M.length===0){console.error("❌ Carrinho vazio");return}X(!0);try{console.log("📦 Adicionando",M.length,"itens à comanda",E.id);for(const Te of M)console.log("➕ Adicionando item:",Te),await ae(E.id,Te.menu_item_id,Te.quantity,Te.notes||""),console.log("✅ Item adicionado com sucesso");console.log("🧹 Limpando carrinho");const xe=M.length;$([]),console.log("🔄 Atualizando dados"),await a(),console.log("📋 Dados atualizados, comanda selecionada será atualizada automaticamente"),console.log("🍺 Forçando atualização dos pedidos do bar e cozinha..."),await P(),await q(),console.log("✅ Pedidos do bar e cozinha atualizados"),Y(`✅ ${xe} ${xe===1?"item adicionado":"itens adicionados"} com sucesso!`),J(!0),setTimeout(()=>{J(!1)},3e3),console.log("🎉 Processo concluído com sucesso!")}catch(xe){console.error("❌ Erro ao adicionar itens à comanda:",xe),Y("❌ Erro ao adicionar itens à comanda"),J(!0),setTimeout(()=>{J(!1)},3e3)}finally{X(!1)}},Ve=xe=>{C(Te=>new Set([...Te,xe]))},De=y.useMemo(()=>t.filter(xe=>{var bs,Ls,ka,Or,Ji,po;const Te=!o||((bs=xe.customer_name)==null?void 0:bs.toLowerCase().includes(o.toLowerCase()))||((ka=(Ls=xe.table)==null?void 0:Ls.number)==null?void 0:ka.toString().includes(o))||xe.id.toLowerCase().includes(o.toLowerCase()),he=c==="all"||xe.status===c,le=!h||((Or=xe.employee_name)==null?void 0:Or.toLowerCase().includes(h.toLowerCase())),Oe=!p||((po=(Ji=xe.table)==null?void 0:Ji.number)==null?void 0:po.toString().includes(p)),tt=(()=>{if(v==="all")return!0;const yn=new Date(xe.opened_at),go=(new Date().getTime()-yn.getTime())/(1e3*60*60);switch(v){case"recent":if(go>=1)return!1;break;case"overdue":if(go<=2)return!1;break;case"critical":if(go<=4)return!1;break}return!0})();return Te&&he&&le&&Oe&&tt}),[t,o,c,h,p,v]),Ue=De.filter(xe=>xe.status==="open"),W=De.filter(xe=>xe.status==="pending_payment"),se=De.filter(xe=>{if(xe.status!=="open")return!1;const Te=new Date(xe.opened_at);return(new Date().getTime()-Te.getTime())/(1e3*60*60)>2}),ue=se.filter(xe=>!N.has(xe.id)),Ce=xe=>new Date(xe).toLocaleDateString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"}),ke=xe=>{switch(xe){case"open":return"Aberta";case"pending_payment":return"Aguardando Pagamento";case"closed":return"Fechada";default:return xe}},ye=[...new Set(re.map(xe=>xe.category))],Me=re.filter(xe=>{const Te=A==="all"||xe.category===A,he=xe.name.toLowerCase().includes(R.toLowerCase());return Te&&he&&xe.available});if(console.log("Estado atual do carrinho:",M),console.log("Carrinho tem itens?",M.length>0),console.log("🔍 Debug botão Fechar Conta:",{selectedComanda:!!E,status:E==null?void 0:E.status,shouldShow:(E==null?void 0:E.status)==="open"}),S==="details"&&E)return e.jsxs("div",{className:"comanda-details-container h-full flex flex-col bg-gray-50",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b bg-white flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("button",{onClick:me,className:"flex items-center space-x-2 text-gray-600 hover:text-gray-900 transition-colors",children:[e.jsx(fo,{size:20}),e.jsx("span",{children:"Voltar para Comandas"})]}),e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900",children:[(Ge=E.table)!=null&&Ge.number?`Mesa ${E.table.number}`:"Balcão"," - ",E.customer_name||"Cliente"]}),e.jsxs("div",{className:"flex items-center space-x-4 mt-2",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Aberta em ",Ce(E.opened_at)]}),e.jsx("div",{className:"bg-green-100 px-4 py-2 rounded-lg border border-green-200",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{className:"text-sm font-medium text-green-800",children:"Total da Comanda:"}),e.jsxs("span",{className:"text-xl font-bold text-green-900",children:["R$ ",((Qe=E.total)==null?void 0:Qe.toFixed(2))||"0,00"]})]})})]})]})]}),e.jsx("div",{className:"flex flex-col space-y-2",children:e.jsxs("button",{onClick:async()=>{var xe;if(E)try{const{data:Te,error:he}=await B.from("comandas").select(`
                      *,
                      bar_tables(number, capacity),
                      comanda_items(
                        *,
                        menu_items(name, price, category)
                      )
                    `).eq("id",E.id).single();if(he)throw he;const le={...Te,items:((xe=Te.comanda_items)==null?void 0:xe.map(Oe=>{var tt;return{...Oe,menu_item:Oe.menu_items,product_name:((tt=Oe.menu_items)==null?void 0:tt.name)||"Item",total_price:Oe.price*Oe.quantity}}))||[],table:Te.bar_tables};H(le),we(!0)}catch(Te){console.error("Erro ao carregar comanda:",Te)}},className:"bg-red-600 text-white px-6 py-3 rounded-lg font-medium hover:bg-red-700 transition-colors flex items-center space-x-2",children:[e.jsx(Wi,{size:20}),e.jsx("span",{children:"Fechar Conta"})]})})]}),e.jsxs("div",{className:"flex-1 flex overflow-hidden min-h-0",children:[e.jsxs("div",{className:"flex-1 flex flex-col p-6",children:[e.jsxs("div",{className:"flex items-center space-x-4 mb-6",children:[e.jsx("div",{className:"flex-1 relative",children:e.jsx("input",{type:"text",placeholder:"Buscar itens...",value:R,onChange:xe=>L(xe.target.value),className:"w-full pl-4 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})}),e.jsxs("select",{value:A,onChange:xe=>z(xe.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"Todas as Categorias"}),ye.map(xe=>e.jsx("option",{value:xe,children:xe},xe))]})]}),e.jsx("div",{className:"flex-1 overflow-y-auto",children:oe?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):Me.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500 mb-2",children:"Nenhum item encontrado"})}):e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4",children:Me.map(xe=>e.jsxs("div",{onClick:()=>Ne(xe),className:"bg-white border border-gray-200 rounded-lg p-4 hover:shadow-md transition-all duration-200 group cursor-pointer hover:border-blue-300 hover:bg-blue-50",children:[e.jsxs("div",{className:"aspect-square bg-gray-100 rounded-lg mb-3 flex items-center justify-center group-hover:bg-blue-100 transition-colors",children:[xe.image_url?e.jsx("img",{src:xe.image_url,alt:xe.name,className:"max-w-full max-h-full object-contain rounded-lg",onError:Te=>{Te.currentTarget.style.display="none",Te.currentTarget.nextElementSibling.style.display="block"}}):null,e.jsx("div",{className:"text-gray-400 text-2xl group-hover:text-blue-500 transition-colors",style:{display:xe.image_url?"none":"block"},children:"🍺"})]}),e.jsx("h3",{className:"font-medium text-gray-900 mb-1 line-clamp-2 group-hover:text-blue-900",children:xe.name}),e.jsx("p",{className:"text-sm text-gray-500 mb-2 line-clamp-2 group-hover:text-blue-700",children:xe.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("span",{className:"text-lg font-bold text-green-600 group-hover:text-green-700",children:["R$ ",(typeof xe.price=="string"?parseFloat(xe.price):xe.price).toFixed(2)]}),e.jsx("div",{className:"bg-blue-600 text-white p-2 rounded-lg group-hover:bg-blue-700 transition-colors",children:e.jsx($s,{size:16})})]})]},xe.id))})})]}),e.jsxs("div",{className:"w-96 bg-gray-50 border-l border-gray-200 flex flex-col",children:[e.jsx("div",{className:"p-6 border-b border-gray-200 flex-shrink-0",children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Pedidos da Comanda"})})}),(E==null?void 0:E.items)&&E.items.length>0&&e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("div",{className:"p-4 bg-blue-50",children:[e.jsxs("h4",{className:"text-sm font-medium text-blue-900 mb-3",children:["Itens já pedidos (",E.items.length,")",e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(Debug: ",new Date().toLocaleTimeString(),")"]})]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:E.items.map(xe=>{var Te,he;return console.log("🔍 Debug item da comanda:",xe),e.jsxs("div",{className:"bg-white rounded-lg p-3 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h5",{className:"font-medium text-gray-900 text-sm",children:((Te=xe.menu_item)==null?void 0:Te.name)||((he=xe.menu_items)==null?void 0:he.name)||`Item ${xe.menu_item_id}`}),e.jsxs("p",{className:"text-xs text-gray-600",children:["R$ ",xe.price.toFixed(2)," cada"]})]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${xe.status==="pending"?"bg-yellow-100 text-yellow-800":xe.status==="preparing"?"bg-blue-100 text-blue-800":xe.status==="ready"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:xe.status==="pending"?"Pendente":xe.status==="preparing"?"Preparando":xe.status==="ready"?"Pronto":xe.status==="delivered"?"Entregue":xe.status})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Qtd: ",xe.quantity]}),e.jsxs("span",{className:"font-medium text-green-600 text-sm",children:["R$ ",(xe.price*xe.quantity).toFixed(2)]})]}),xe.notes&&e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Obs: ",xe.notes]})]},xe.id)})})]})}),e.jsx("div",{className:"p-4 border-b border-gray-200 bg-gray-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("h4",{className:"text-sm font-medium text-gray-900",children:["Novos Itens (",M.length,")"]}),M.length>0&&e.jsx("button",{onClick:()=>$([]),className:"text-xs text-red-600 hover:text-red-800",children:"Limpar"})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 min-h-0",children:M.length===0?e.jsxs("div",{className:"text-center text-gray-500 py-4 h-full flex flex-col items-center justify-center",children:[e.jsx(hn,{className:"h-8 w-8 mx-auto mb-2 text-gray-300"}),e.jsx("p",{className:"text-sm",children:"Nenhum item novo selecionado"})]}):e.jsxs("div",{className:"space-y-4",children:[M.map(xe=>e.jsxs("div",{className:"bg-white rounded-lg p-4 shadow-sm",children:[e.jsx("div",{className:"flex items-start justify-between mb-3",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-1",children:xe.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:["R$ ",xe.price.toFixed(2)," cada"]})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("button",{onClick:()=>je(xe.menu_item_id,xe.quantity-1),className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center hover:bg-gray-300 transition-colors",children:e.jsx(Ii,{size:14})}),e.jsx("span",{className:"w-8 text-center font-medium",children:xe.quantity}),e.jsx("button",{onClick:()=>je(xe.menu_item_id,xe.quantity+1),className:"w-8 h-8 bg-gray-200 rounded-full flex items-center justify-center hover:bg-gray-300 transition-colors",children:e.jsx($s,{size:14})})]}),e.jsxs("span",{className:"font-bold text-green-600",children:["R$ ",(xe.price*xe.quantity).toFixed(2)]})]})]},xe.menu_item_id)),e.jsxs("div",{className:"mt-6 pt-4 border-t border-gray-200",children:[e.jsx("div",{className:"bg-gradient-to-r from-green-50 to-green-100 p-4 rounded-lg border border-green-200 mb-4",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-semibold text-green-800",children:"Total dos Novos Itens:"}),e.jsxs("span",{className:"text-3xl font-bold text-green-900",children:["R$ ",Re().toFixed(2)]})]})}),e.jsx("button",{onClick:Ie,disabled:I,className:`w-full py-3 rounded-lg font-medium transition-colors flex items-center justify-center space-x-2 ${I?"bg-gray-400 cursor-not-allowed":"bg-green-600 hover:bg-green-700 text-white"}`,children:I?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Adicionando..."})]}):e.jsxs(e.Fragment,{children:[e.jsx($s,{size:20}),e.jsx("span",{children:"Adicionar à Comanda"})]})}),ce&&e.jsx("div",{className:`mt-3 p-3 rounded-lg text-sm font-medium text-center transition-all duration-300 ${V.includes("❌")?"bg-red-100 text-red-800 border border-red-200":"bg-green-100 text-green-800 border border-green-200"}`,children:V})]})]})})]})]}),(console.log("🔍 Debug Modal:",{showCloseModal:ee,closeModalComanda:!!D,isClosingComanda:F}),D&&e.jsx(W2,{isOpen:ee,comanda:D,onClose:()=>{we(!1),H(null)},onConfirm:async(xe,Te)=>{try{Z(!0),await pe(D.id,xe,Te),we(!1),H(null),a()}catch(he){console.error("Erro ao fechar comanda:",he),alert("Erro ao fechar comanda. Tente novamente.")}finally{Z(!1)}},loading:F}))]});return e.jsxs("div",{className:"comandas-container",children:[e.jsx(w7,{comandas:ue,onComandaClick:G,onDismissAlert:Ve}),e.jsx(j7,{searchTerm:o,onSearchChange:l,statusFilter:c,onStatusFilterChange:u,employeeFilter:h,onEmployeeFilterChange:f,tableFilter:p,onTableFilterChange:g,timeFilter:v,onTimeFilterChange:b,employees:[],tables:r||[],onClearFilters:()=>{l(""),u("all"),f(""),g(""),b("all")}}),e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex space-x-4",children:[e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:Ue.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Abertas"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:W.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Aguardando Pagamento"})]}),e.jsxs("div",{className:"bg-white p-4 rounded-lg border",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:se.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Com Atraso"})]})]}),e.jsx("button",{onClick:Q,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"+ Nova Comanda"})]}),e.jsx("div",{className:"bg-white rounded-lg border",children:s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Mesa/Cliente"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Funcionário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Abertura"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Total"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:De.map(xe=>{var le,Oe;const Te=Pe(xe.opened_at),he=new Date().getTime()-new Date(xe.opened_at).getTime()>2*60*60*1e3;return e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:[((le=xe.table)==null?void 0:le.number)||"Balcão",xe.customer_name&&e.jsx("div",{className:"text-xs text-gray-500",children:xe.customer_name})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex flex-col space-y-1",children:[e.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${xe.status==="open"?"bg-green-100 text-green-800":xe.status==="pending_payment"?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"}`,children:ke(xe.status)}),he&&xe.status==="open"&&e.jsx("span",{className:"inline-flex px-2 py-1 text-xs font-semibold rounded-full bg-red-100 text-red-800",children:"⚠️ Atrasada"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:xe.employee_name||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.jsxs("div",{children:[Ce(xe.opened_at),e.jsxs("div",{className:`text-xs ${he?"text-red-600 font-medium":"text-gray-400"}`,children:[Te," decorrido"]})]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-green-600",children:["R$ ",((Oe=xe.total)==null?void 0:Oe.toFixed(2))||"0,00"]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("button",{onClick:()=>G(xe),className:"inline-flex items-center px-3 py-1 bg-blue-600 text-white text-xs rounded hover:bg-blue-700 transition-colors",children:[e.jsx(Ys,{className:"w-3 h-3 mr-1"}),"Ver Detalhes"]})})]},xe.id)})})]})})}),e.jsx(v7,{isOpen:_,onClose:()=>w(!1),onComandaCreated:()=>{a()}}),console.log("🔍 Debug modal:",{showCloseModal:ee,selectedComanda:!!E,viewMode:S}),ce&&S==="list"&&e.jsx("div",{className:"fixed top-4 right-4 z-50",children:e.jsx("div",{className:`p-4 rounded-lg shadow-lg ${V.includes("❌")?"bg-red-100 text-red-800 border border-red-200":"bg-green-100 text-green-800 border border-green-200"}`,children:V})})]});function Pe(xe){const Te=new Date(xe),le=new Date().getTime()-Te.getTime(),Oe=Math.floor(le/(1e3*60*60)),tt=Math.floor(le%(1e3*60*60)/(1e3*60));return Oe>0?`${Oe}h ${tt}min`:`${tt}min`}},S7=()=>{const{user:t}=jt(),[s,a]=y.useState([]),[r,o]=y.useState({orderQueue:[],alerts:[],loading:!0,error:null}),l=y.useCallback(J=>{o(V=>({...V,...J}))},[]),c=y.useCallback((J,V)=>{console.error(`Erro em ${V}:`,J),l({error:`Erro em ${V}: ${J.message||"Erro desconhecido"}`,loading:!1})},[l]),u=y.useCallback(async()=>{if(t)try{l({loading:!0,error:null});const{data:J,error:V}=await B.rpc("get_order_queue_items");if(V)throw V;const Y=(J||[]).map(we=>{const D=b([we]);return{...we,priority:{level:D.priorityLevel,complexity:_(D.finalEstimate),estimatedTime:D.finalEstimate,isManuallyPrioritized:we.is_priority||!1,createdAt:new Date(we.added_at),timerStatus:h(new Date(we.added_at),D.finalEstimate),alertsEnabled:!0}}}),ee=S(Y);l({orderQueue:ee,loading:!1})}catch(J){c(J,"carregamento da fila de pedidos")}},[t,l,c]),h=(J,V)=>{const ee=(new Date().getTime()-J.getTime())/(1e3*60),we=V*.8,D=V*1.2;return ee>=D?"overdue":ee>=we?"warning":"normal"},f={bebidas:{baseTime:2,complexity:"simple"},drinks:{baseTime:3,complexity:"simple"},petiscos:{baseTime:8,complexity:"medium"},pratos:{baseTime:15,complexity:"complex"},sobremesas:{baseTime:5,complexity:"simple"},cafes:{baseTime:3,complexity:"simple"}},p={simple:1,medium:1.3,complex:1.8},g=y.useCallback(J=>{let V=0,Y="simple",ee=0;J.forEach(F=>{var Z,re;if(F.menu_items){const oe=F.menu_items.category.toLowerCase(),ae=F.menu_items.preparation_time||0,pe=ae>0?ae:((Z=f[oe])==null?void 0:Z.baseTime)||8;V+=pe*F.quantity;const P=((re=f[oe])==null?void 0:re.complexity)||"medium";v(P)>v(Y)&&(Y=P),oe==="pratos"&&(ee+=2),oe==="petiscos"&&(ee+=1)}});const we=p[Y],D=Math.ceil((V+ee)*we);let H="low";return D>=20?H="high":D>=12?H="medium":H="low",{baseTime:V,complexityMultiplier:we,categoryBonus:ee,finalEstimate:D,priorityLevel:H}},[]),v=J=>{switch(J){case"simple":return 1;case"medium":return 2;case"complex":return 3;default:return 1}},b=y.useCallback((J,V=!1,Y)=>{const ee=g(J);return{level:V&&Y?Y:ee.priorityLevel,complexity:_(ee.finalEstimate),estimatedTime:ee.finalEstimate,isManuallyPrioritized:V,createdAt:new Date,timerStatus:"normal",alertsEnabled:!0}},[g]),_=J=>J>=15?"complex":J>=8?"medium":"simple",w=y.useCallback((J,V)=>{const Y={id:J,startTime:new Date,estimatedTime:V,status:"normal",alertsSent:[]};a(ee=>[...ee.filter(we=>we.id!==J),Y])},[]),E=y.useCallback(J=>{a(V=>V.filter(Y=>Y.id!==J))},[]),k=y.useCallback((J,V,Y)=>{a(we=>we.map(D=>D.id===J?{...D,status:V==="urgent"?"warning":D.status}:D));const ee={id:`priority-${J}-${Date.now()}`,orderId:J,type:"warning",message:`Pedido marcado como ${N(V)}${Y?`: ${Y}`:""}`,timestamp:new Date,acknowledged:!1};setAlerts(we=>[ee,...we])},[]),N=J=>{switch(J){case"low":return"Baixa Prioridade";case"medium":return"Prioridade Média";case"high":return"Alta Prioridade";case"urgent":return"Urgente";default:return J}},C=J=>{switch(J){case"low":return"bg-green-100 text-green-800 border-green-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"high":return"bg-orange-100 text-orange-800 border-orange-200";case"urgent":return"bg-red-100 text-red-800 border-red-200";default:return"bg-gray-100 text-gray-800 border-gray-200"}},S=y.useCallback(J=>{const V={urgent:4,high:3,medium:2,low:1};return J.sort((Y,ee)=>{var oe,ae,pe,P,q,Q,G,me;if((oe=Y.priority)!=null&&oe.isManuallyPrioritized&&!((ae=ee.priority)!=null&&ae.isManuallyPrioritized))return-1;if(!((pe=Y.priority)!=null&&pe.isManuallyPrioritized)&&((P=ee.priority)!=null&&P.isManuallyPrioritized))return 1;const we=((q=Y.priority)==null?void 0:q.level)||"low",D=((Q=ee.priority)==null?void 0:Q.level)||"low",H=V[we],F=V[D];if(H!==F)return F-H;const Z=new Date(((G=Y.priority)==null?void 0:G.createdAt)||Y.added_at||0).getTime(),re=new Date(((me=ee.priority)==null?void 0:me.createdAt)||ee.added_at||0).getTime();return Z-re})},[]),T=y.useCallback(async(J,V)=>{try{const{error:Y}=await B.from("comanda_items").update({is_priority:V,updated_at:new Date().toISOString()}).eq("id",J);if(Y)throw Y;l({orderQueue:r.orderQueue.map(ee=>ee.id===J&&ee.priority?{...ee,priority:{...ee.priority,isManuallyPrioritized:V,level:V?"urgent":ee.priority.level}}:ee)}),await u()}catch(Y){throw c(Y,"marcação de prioridade"),Y}},[r.orderQueue,l,c,u]),M=y.useCallback(async(J,V)=>{try{const Y={status:V,updated_at:new Date().toISOString()};V==="preparing"?Y.started_at=new Date().toISOString():V==="ready"?Y.prepared_at=new Date().toISOString():V==="delivered"&&(Y.delivered_at=new Date().toISOString());const{error:ee}=await B.from("comanda_items").update(Y).eq("id",J);if(ee)throw ee;await u()}catch(Y){throw c(Y,"atualização de status"),Y}},[c,u]);y.useCallback((J,V,Y)=>{const ee={id:`alert-${J}-${Date.now()}`,orderId:J,type:V,message:Y,timestamp:new Date,acknowledged:!1};l({alerts:[ee,...r.alerts]})},[r.alerts,l]);const $=y.useCallback(J=>{l({alerts:r.alerts.map(V=>V.id===J?{...V,acknowledged:!0}:V)})},[r.alerts,l]),A=y.useCallback(()=>{l({alerts:[]})},[l]),z=y.useCallback(J=>{if(J.priority)return J.priority;const V=b([J]);return{level:V.priorityLevel,complexity:_(V.finalEstimate),estimatedTime:V.finalEstimate,isManuallyPrioritized:!1,createdAt:new Date(J.added_at),timerStatus:h(new Date(J.added_at),V.finalEstimate),alertsEnabled:!0}},[]),R=y.useCallback(J=>{const V=z(J);return h(V.createdAt,V.estimatedTime)},[z]),L=y.useCallback(J=>{const V=z(J),Y=(new Date().getTime()-V.createdAt.getTime())/(1e3*60);return Math.max(0,V.estimatedTime-Y)},[z]),I=y.useCallback(J=>{const V=L(J);if(V<1)return"< 1min";if(V<60)return`${Math.ceil(V)}min`;const Y=Math.floor(V/60),ee=Math.ceil(V%60);return ee===0?`${Y}h`:`${Y}h ${ee}min`},[L]),X=y.useCallback(()=>{const J={urgent:0,high:0,medium:0,low:0,overdue:0,warning:0};return r.orderQueue.forEach(V=>{const Y=z(V);J[Y.level]++,Y.timerStatus==="overdue"?J.overdue++:Y.timerStatus==="warning"&&J.warning++}),J},[r.orderQueue,z]),ce=y.useCallback(async()=>{await u()},[u]);return y.useEffect(()=>{if(!t)return;const J=B.channel("order-priority-changes").on("postgres_changes",{event:"*",schema:"public",table:"comanda_items"},V=>{console.log("Mudança em itens de comanda:",V),u()}).subscribe();return()=>{B.removeChannel(J)}},[t,u]),y.useEffect(()=>{t&&u()},[t,u]),y.useEffect(()=>{const J=setInterval(()=>{if(r.orderQueue.length>0){const V=r.orderQueue.map(Y=>{if(Y.priority){const ee=h(Y.priority.createdAt,Y.priority.estimatedTime);return{...Y,priority:{...Y.priority,timerStatus:ee}}}return Y});l({orderQueue:V})}},6e4);return()=>clearInterval(J)},[r.orderQueue,l]),{...r,markItemAsPriority:T,updateItemStatus:M,dismissAlert:$,clearAllAlerts:A,getItemPriority:z,getTimerStatus:R,getRemainingTime:L,formatRemainingTime:I,getPriorityStats:X,refreshQueue:ce,getPriorityLabel:N,getPriorityColor:C,sortOrdersByPriority:S,calculateOrderPriority:b,calculateAutoPriority:g,startOrderTimer:w,stopOrderTimer:E,markOrderAsPriority:k,orderTimers:s,allAlerts:r.alerts}},E7=({onUpdateItemStatus:t})=>{const{orderQueue:s,loading:a,markItemAsPriority:r,updateItemStatus:o,getItemPriority:l,getTimerStatus:c,formatRemainingTime:u,alerts:h,getPriorityLabel:f,getPriorityColor:p}=S7(),[g,v]=y.useState(!0),[b,_]=y.useState(null),w=s,k=(()=>{const z=new Map;return w.forEach(R=>{var I,X;const L=((X=(I=R.comandas)==null?void 0:I.bar_tables)==null?void 0:X.number)||"Balcão";z.has(L)||z.set(L,[]),z.get(L).push(R)}),z})(),N=z=>(k.get(z)||[]).length>1,C=z=>z.id.slice(-4).toUpperCase(),S=async(z,R)=>{try{t?await t(z,R):await o(z,R)}catch(L){console.error("Erro ao atualizar status:",L)}},T=async(z,R)=>{try{await r(z,R),_(null)}catch(L){console.error("Erro ao marcar prioridade:",L)}},M=z=>{switch(z){case"pending":return e.jsx(Bt,{className:"h-4 w-4"});case"preparing":return e.jsx(Ej,{className:"h-4 w-4"});case"ready":return e.jsx(ts,{className:"h-4 w-4"});default:return e.jsx(Bt,{className:"h-4 w-4"})}},$=z=>{switch(z){case"pending":return"text-yellow-600 bg-yellow-100";case"preparing":return"text-blue-600 bg-blue-100";case"ready":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},A=z=>{switch(z){case"pending":return"Pendente";case"preparing":return"Preparando";case"ready":return"Pronto";default:return z}};return a?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ws,{children:g&&h.length>0&&e.jsxs(be.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(uR,{className:"h-5 w-5 text-red-600"}),e.jsxs("h3",{className:"text-lg font-semibold text-red-800",children:["Alertas (",h.length,")"]})]}),e.jsx("button",{onClick:()=>v(!1),className:"text-red-600 hover:text-red-800",title:"Fechar alertas","aria-label":"Fechar alertas",children:e.jsx(nt,{className:"h-4 w-4"})})]}),e.jsx("div",{className:"space-y-2",children:h.slice(0,3).map(z=>e.jsxs("div",{className:"flex items-center justify-between bg-white p-3 rounded border",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-red-800",children:z.message}),e.jsx("p",{className:"text-xs text-red-600",children:wt(z.timestamp,"HH:mm",{locale:Wt})})]}),e.jsx("button",{onClick:()=>acknowledgeAlert(z.id),className:"text-red-600 hover:text-red-800 ml-2",title:"Reconhecer alerta","aria-label":"Reconhecer alerta",children:e.jsx(ts,{className:"h-4 w-4"})})]},z.id))})]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Fila de Pedidos"}),e.jsxs("p",{className:"text-gray-600",children:[w.length," itens na fila, ordenados por prioridade"]}),Array.from(k.entries()).filter(([z,R])=>R.length>1).length>0&&e.jsxs("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium mt-1 inline-block",children:[Array.from(k.entries()).filter(([z,R])=>R.length>1).length," mesa(s) com múltiplos pedidos"]})]}),h.length>0&&!g&&e.jsxs("button",{onClick:()=>v(!0),className:"flex items-center space-x-2 bg-red-100 text-red-800 px-3 py-2 rounded-lg hover:bg-red-200 transition-colors",title:"Mostrar alertas","aria-label":"Mostrar alertas",children:[e.jsx(yg,{className:"h-4 w-4"}),e.jsxs("span",{children:[h.length," alertas"]})]})]}),Array.from(k.entries()).filter(([z,R])=>R.length>1).length>0&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-sm font-semibold text-orange-800 mb-2",children:"⚠️ Mesas com Múltiplos Pedidos:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from(k.entries()).filter(([z,R])=>R.length>1).map(([z,R])=>e.jsxs("span",{className:"bg-orange-200 text-orange-800 px-3 py-1 rounded-full text-sm font-medium",children:["Mesa ",z,": ",R.length," itens"]},z))})]}),e.jsx("div",{className:"space-y-4",children:w.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Bt,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"Nenhum pedido na fila"})]}):w.map((z,R)=>{var X,ce,J,V,Y,ee;const L=c(z),I=l(z);return e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:R*.1},className:`bg-white rounded-lg shadow-md p-6 border-l-4 ${I!=null&&I.isManuallyPrioritized?"border-red-500":(I==null?void 0:I.level)==="high"?"border-orange-500":(I==null?void 0:I.level)==="medium"?"border-yellow-500":"border-green-500"} ${N(((ce=(X=z.comandas)==null?void 0:X.bar_tables)==null?void 0:ce.number)||"Balcão")?"ring-2 ring-orange-300 ring-offset-2":""}`,children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"bg-gray-100 text-gray-800 px-2 py-1 rounded text-sm font-medium",children:["#",R+1]}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:((J=z.menu_items)==null?void 0:J.name)||"Item sem nome"}),e.jsxs("span",{className:"text-sm text-gray-500",children:["x",z.quantity]}),e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:["#",C(z)]})]}),(I==null?void 0:I.isManuallyPrioritized)&&e.jsx(h0,{className:"h-5 w-5 text-red-500"})]}),e.jsxs("div",{className:"flex items-center space-x-4 text-sm text-gray-600 mb-3",children:[((Y=(V=z.comandas)==null?void 0:V.bar_tables)==null?void 0:Y.number)&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{children:["Mesa ",z.comandas.bar_tables.number]}),e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:["#",C(z)]}),N(z.comandas.bar_tables.number)&&e.jsxs("span",{className:"bg-orange-500 text-white px-2 py-1 rounded-full text-xs font-bold",children:[(k.get(z.comandas.bar_tables.number)||[]).length," itens"]})]}),((ee=z.comandas)==null?void 0:ee.customer_name)&&e.jsxs("span",{children:["Cliente: ",z.comandas.customer_name]}),e.jsxs("span",{children:["Pedido às ",wt(new Date(z.added_at||""),"HH:mm",{locale:Wt})]})]}),e.jsxs("div",{className:"flex items-center space-x-4 mb-4",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium border ${p((I==null?void 0:I.level)||"low")}`,children:f((I==null?void 0:I.level)||"low")}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Tempo estimado: ",(I==null?void 0:I.estimatedTime)||0,"min"]}),e.jsxs("div",{className:`flex items-center space-x-1 px-2 py-1 rounded text-sm ${L==="overdue"?"bg-red-100 text-red-800":L==="warning"?"bg-yellow-100 text-yellow-800":"bg-blue-100 text-blue-800"}`,children:[e.jsx(Ej,{className:"h-3 w-3"}),e.jsx("span",{children:u(z)}),L==="overdue"&&e.jsx(yt,{className:"h-3 w-3"})]})]}),e.jsx("div",{className:"flex items-center space-x-2",children:e.jsxs("span",{className:`flex items-center space-x-1 px-3 py-1 rounded-full text-sm font-medium ${$(z.status||"pending")}`,children:[M(z.status||"pending"),e.jsx("span",{children:A(z.status||"pending")})]})})]}),e.jsxs("div",{className:"flex flex-col space-y-2 ml-4",children:[e.jsxs("button",{onClick:()=>_(z.id),className:"flex items-center space-x-1 px-3 py-1 bg-orange-100 text-orange-800 rounded hover:bg-orange-200 transition-colors",title:"Marcar como prioritário","aria-label":"Marcar como prioritário",children:[e.jsx(rR,{className:"h-3 w-3"}),e.jsx("span",{className:"text-xs",children:"Priorizar"})]}),z.status==="pending"&&e.jsx("button",{onClick:()=>S(z.id,"preparing"),className:"px-3 py-1 bg-blue-600 text-white rounded text-sm hover:bg-blue-700 transition-colors",children:"Iniciar"}),z.status==="preparing"&&e.jsx("button",{onClick:()=>S(z.id,"ready"),className:"px-3 py-1 bg-green-600 text-white rounded text-sm hover:bg-green-700 transition-colors",children:"Pronto"})]})]})},z.id)})}),b&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-96",children:[e.jsx("h3",{className:"text-lg font-semibold mb-4",children:"Definir Prioridade"}),e.jsx("div",{className:"space-y-3",children:["urgent","high","medium","low"].map(z=>e.jsxs("button",{onClick:()=>T(b||"",!0),className:`w-full p-3 rounded border-2 text-left transition-colors ${p(z)} hover:opacity-80`,children:[e.jsx("div",{className:"font-medium",children:f(z)}),e.jsxs("div",{className:"text-sm opacity-75",children:[z==="urgent"&&"Para pedidos que precisam ser feitos imediatamente",z==="high"&&"Para pedidos importantes com prazo apertado",z==="medium"&&"Para pedidos com prioridade normal",z==="low"&&"Para pedidos que podem aguardar"]})]},z))}),e.jsx("div",{className:"mt-4 flex space-x-3",children:e.jsx("button",{onClick:()=>_(null),className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded hover:bg-gray-400 transition-colors",children:"Cancelar"})})]})})]})},C7=({orders:t,menuItems:s})=>{const{updateOrderStatus:a}=Tt(),[r,o]=y.useState(new Set),c=(()=>{const w=new Map;return t.forEach(E=>{const k=E.tableNumber||"Balcão";w.has(k)||w.set(k,[]),w.get(k).push(E)}),w})(),u=w=>w.items.reduce((E,k)=>{const N=s.find(S=>S.id===k.menuItemId)||k.menuItem,C=(N==null?void 0:N.preparation_time)||(N==null?void 0:N.preparationTime)||0;return E+C},0),h=w=>{const E=(new Date().getTime()-w.createdAt.getTime())/6e4;return E>20?"high":E>10?"medium":"low"},f=w=>{switch(w){case"high":return"border-red-400 bg-red-50";case"medium":return"border-yellow-400 bg-yellow-50";case"low":return"border-green-400 bg-green-50";default:return"border-gray-200 bg-white"}},p=w=>w.id.slice(-4).toUpperCase(),g=w=>w.id.startsWith("balcao-"),v=w=>w.id.startsWith("comanda-"),b=async(w,E)=>{o(k=>new Set([...k,w]));try{await a(w,E),console.log(`✅ Status do pedido ${w} atualizado para ${E}`)}catch(k){console.error("Erro ao atualizar status:",k)}finally{setTimeout(()=>{o(k=>{const N=new Set(k);return N.delete(w),N})},1e3)}},_=w=>(c.get(w)||[]).length>1;return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-800",children:"Pedidos do Bar"}),e.jsx("div",{className:"text-sm text-gray-600",children:Array.from(c.entries()).filter(([w,E])=>E.length>1).length>0&&e.jsxs("span",{className:"bg-orange-100 text-orange-800 px-2 py-1 rounded-full text-xs font-medium",children:[Array.from(c.entries()).filter(([w,E])=>E.length>1).length," mesa(s) com múltiplos pedidos"]})})]}),Array.from(c.entries()).filter(([w,E])=>E.length>1).length>0&&e.jsxs("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-6",children:[e.jsx("h3",{className:"text-sm font-semibold text-orange-800 mb-2",children:"⚠️ Mesas com Múltiplos Pedidos:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:Array.from(c.entries()).filter(([w,E])=>E.length>1).map(([w,E])=>e.jsxs("span",{className:"bg-orange-200 text-orange-800 px-3 py-1 rounded-full text-sm font-medium",children:["Mesa ",w,": ",E.length," pedidos"]},w))})]}),t.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhum pedido pendente no bar"})}):e.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-4",children:t.map(w=>{const E=h(w),k=u(w),N=w.items,C=_(w.tableNumber||"Balcão");return e.jsxs(be.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},className:`border-2 rounded-lg p-4 ${f(E)} ${C?"ring-2 ring-orange-300 ring-offset-2":""} ${g(w)?"border-green-400 bg-green-50 shadow-lg":""}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fc,{size:16,className:"text-gray-500"}),e.jsx("span",{className:"font-bold text-lg",children:Og(w.tableNumber)}),e.jsxs("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded-full text-xs font-medium",children:["#",p(w)]}),g(w)&&e.jsx("span",{className:"bg-green-600 text-white px-2 py-1 rounded-full text-xs font-bold animate-pulse",children:"✓ PAGO"}),v(w)&&e.jsx("span",{className:"bg-yellow-500 text-white px-2 py-1 rounded-full text-xs font-medium",children:"AGUARDA PAGTO"}),_(w.tableNumber||"Balcão")&&e.jsxs("span",{className:"bg-orange-500 text-white px-2 py-1 rounded-full text-xs font-bold",children:[(c.get(w.tableNumber||"Balcão")||[]).length," pedidos"]})]}),e.jsxs("div",{className:"flex items-center space-x-1 text-sm text-gray-600",children:[e.jsx(Bt,{size:14}),e.jsx("span",{children:wt(w.createdAt,"HH:mm",{locale:Wt})})]})]}),e.jsx("div",{className:"space-y-2 mb-4",children:N.map(S=>{const T=s.find(M=>M.id===S.menuItemId)||S.menuItem;return e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{className:"font-medium",children:[S.quantity,"x ",(T==null?void 0:T.name)||"Item não encontrado"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:[(T==null?void 0:T.preparation_time)||(T==null?void 0:T.preparationTime)||0,"min"]})]},S.id)})}),w.notes&&e.jsx("div",{className:"mb-4 p-2 bg-yellow-100 rounded border",children:e.jsx("p",{className:"text-sm text-yellow-800",children:w.notes})}),e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:["Tempo estimado: ",k,"min"]}),e.jsx("span",{className:`text-xs px-2 py-1 rounded-full ${E==="high"?"bg-red-200 text-red-800":E==="medium"?"bg-yellow-200 text-yellow-800":"bg-green-200 text-green-800"}`,children:E==="high"?"Urgente":E==="medium"?"Médio":"Normal"})]}),e.jsxs("div",{className:"space-y-2",children:[w.status==="pending"&&e.jsx("button",{onClick:()=>b(w.id,"preparing"),disabled:r.has(w.id),className:`w-full py-2 rounded-lg font-medium transition-all duration-300 ${r.has(w.id)?"bg-blue-300 text-blue-700 cursor-not-allowed animate-pulse scale-95":"bg-blue-600 text-white hover:bg-blue-700 hover:shadow-lg transform hover:scale-105 active:scale-95"}`,children:r.has(w.id)?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-700 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Iniciando..."})]}):"Iniciar Preparo"}),w.status==="preparing"&&e.jsx("button",{onClick:()=>b(w.id,"ready"),disabled:r.has(w.id),className:`w-full py-2 rounded-lg font-medium transition-all duration-300 ${r.has(w.id)?"bg-green-300 text-green-700 cursor-not-allowed animate-pulse scale-95":"bg-green-600 text-white hover:bg-green-700 hover:shadow-lg transform hover:scale-105 active:scale-95"}`,children:r.has(w.id)?e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-4 h-4 border-2 border-green-700 border-t-transparent rounded-full animate-spin"}),e.jsx("span",{children:"Finalizando..."})]}):"Marcar como Pronto"}),w.status==="ready"&&e.jsx("div",{className:"w-full py-2 rounded-lg font-medium bg-green-100 text-green-800 border-2 border-green-300 text-center animate-pulse",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("div",{className:"w-5 h-5 bg-green-600 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"✓"})}),e.jsx("span",{children:"Pronto para Entrega"})]})})]})]},w.id)})})]})},T7=()=>null,k7=()=>{const{user:t}=jt(),{updateItemStatus:s}=Ki(),{barOrders:a,menuItems:r}=Tt(),[o,l]=y.useState("balcao"),[c,u]=y.useState(!1),h=g=>{l(g)},f=async(g,v)=>{try{await s(g,v)}catch(b){throw console.error("Erro ao atualizar status do item:",b),b}},p=()=>{switch(o){case"balcao":return c?e.jsx(i7,{}):e.jsx(t_,{});case"mesas":return e.jsx(b7,{});case"comandas":return e.jsx(N7,{});case"fila":return e.jsx(E7,{onUpdateItemStatus:f});case"pedidos":return e.jsx(C7,{orders:a,menuItems:r});default:return e.jsx(t_,{})}};return e.jsxs("div",{className:"bar-attendance-container min-h-screen bg-gray-50 flex flex-col",children:[e.jsx(f$,{mode:o,onModeChange:h,user:t}),o==="balcao"&&e.jsx("div",{className:"bg-white border-b border-gray-200 px-4 py-2",children:e.jsxs("div",{className:"flex items-center justify-center space-x-2",children:[e.jsx("button",{onClick:()=>u(!1),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c?"bg-gray-100 text-gray-700 hover:bg-gray-200":"bg-blue-600 text-white"}`,children:"🛒 Criar Pedido"}),e.jsx("button",{onClick:()=>u(!0),className:`px-4 py-2 rounded-lg font-medium transition-colors ${c?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:"📋 Gerenciar Pedidos"})]})}),e.jsx("main",{className:"bar-content flex-1 p-4 md:p-6 overflow-auto",children:p()}),e.jsx(T7,{})]})};function Se(t,s,a){function r(u,h){var f;Object.defineProperty(u,"_zod",{value:u._zod??{},enumerable:!1}),(f=u._zod).traits??(f.traits=new Set),u._zod.traits.add(t),s(u,h);for(const p in c.prototype)p in u||Object.defineProperty(u,p,{value:c.prototype[p].bind(u)});u._zod.constr=c,u._zod.def=h}const o=(a==null?void 0:a.Parent)??Object;class l extends o{}Object.defineProperty(l,"name",{value:t});function c(u){var h;const f=a!=null&&a.Parent?new l:this;r(f,u),(h=f._zod).deferred??(h.deferred=[]);for(const p of f._zod.deferred)p();return f}return Object.defineProperty(c,"init",{value:r}),Object.defineProperty(c,Symbol.hasInstance,{value:u=>{var h,f;return a!=null&&a.Parent&&u instanceof a.Parent?!0:(f=(h=u==null?void 0:u._zod)==null?void 0:h.traits)==null?void 0:f.has(t)}}),Object.defineProperty(c,"name",{value:t}),c}class Mi extends Error{constructor(){super("Encountered Promise during synchronous parse. Use .parseAsync() instead.")}}class K2 extends Error{constructor(s){super(`Encountered unidirectional transform during encode: ${s}`),this.name="ZodEncodeError"}}const X2={};function uo(t){return X2}function A7(t){const s=Object.values(t).filter(r=>typeof r=="number");return Object.entries(t).filter(([r,o])=>s.indexOf(+r)===-1).map(([r,o])=>o)}function N0(t,s){return typeof s=="bigint"?s.toString():s}function Dg(t){return{get value(){{const s=t();return Object.defineProperty(this,"value",{value:s}),s}}}}function Pg(t){return t==null}function zg(t){const s=t.startsWith("^")?1:0,a=t.endsWith("$")?t.length-1:t.length;return t.slice(s,a)}function M7(t,s){const a=(t.toString().split(".")[1]||"").length,r=s.toString();let o=(r.split(".")[1]||"").length;if(o===0&&/\d?e-\d?/.test(r)){const h=r.match(/\d?e-(\d?)/);h!=null&&h[1]&&(o=Number.parseInt(h[1]))}const l=a>o?a:o,c=Number.parseInt(t.toFixed(l).replace(".","")),u=Number.parseInt(s.toFixed(l).replace(".",""));return c%u/10**l}const a_=Symbol("evaluating");function Et(t,s,a){let r;Object.defineProperty(t,s,{get(){if(r!==a_)return r===void 0&&(r=a_,r=a()),r},set(o){Object.defineProperty(t,s,{value:o})},configurable:!0})}function R7(t){return Object.create(Object.getPrototypeOf(t),Object.getOwnPropertyDescriptors(t))}function gn(t,s,a){Object.defineProperty(t,s,{value:a,writable:!0,enumerable:!0,configurable:!0})}function Qi(...t){const s={};for(const a of t){const r=Object.getOwnPropertyDescriptors(a);Object.assign(s,r)}return Object.defineProperties({},s)}function r_(t){return JSON.stringify(t)}const Q2="captureStackTrace"in Error?Error.captureStackTrace:(...t)=>{};function om(t){return typeof t=="object"&&t!==null&&!Array.isArray(t)}const O7=Dg(()=>{var t;if(typeof navigator<"u"&&((t=navigator==null?void 0:navigator.userAgent)!=null&&t.includes("Cloudflare")))return!1;try{const s=Function;return new s(""),!0}catch{return!1}});function Dc(t){if(om(t)===!1)return!1;const s=t.constructor;if(s===void 0)return!0;const a=s.prototype;return!(om(a)===!1||Object.prototype.hasOwnProperty.call(a,"isPrototypeOf")===!1)}function J2(t){return Dc(t)?{...t}:Array.isArray(t)?[...t]:t}const D7=new Set(["string","number","symbol"]);function Tm(t){return t.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function xn(t,s,a){const r=new t._zod.constr(s??t._zod.def);return(!s||a!=null&&a.parent)&&(r._zod.parent=t),r}function qe(t){const s=t;if(!s)return{};if(typeof s=="string")return{error:()=>s};if((s==null?void 0:s.message)!==void 0){if((s==null?void 0:s.error)!==void 0)throw new Error("Cannot specify both `message` and `error` params");s.error=s.message}return delete s.message,typeof s.error=="string"?{...s,error:()=>s.error}:s}function P7(t){return Object.keys(t).filter(s=>t[s]._zod.optin==="optional"&&t[s]._zod.optout==="optional")}const z7={safeint:[Number.MIN_SAFE_INTEGER,Number.MAX_SAFE_INTEGER],int32:[-2147483648,2147483647],uint32:[0,4294967295],float32:[-34028234663852886e22,34028234663852886e22],float64:[-Number.MAX_VALUE,Number.MAX_VALUE]};function $7(t,s){const a=t._zod.def,r=Qi(t._zod.def,{get shape(){const o={};for(const l in s){if(!(l in a.shape))throw new Error(`Unrecognized key: "${l}"`);s[l]&&(o[l]=a.shape[l])}return gn(this,"shape",o),o},checks:[]});return xn(t,r)}function I7(t,s){const a=t._zod.def,r=Qi(t._zod.def,{get shape(){const o={...t._zod.def.shape};for(const l in s){if(!(l in a.shape))throw new Error(`Unrecognized key: "${l}"`);s[l]&&delete o[l]}return gn(this,"shape",o),o},checks:[]});return xn(t,r)}function L7(t,s){if(!Dc(s))throw new Error("Invalid input to extend: expected a plain object");const a=t._zod.def.checks;if(a&&a.length>0)throw new Error("Object schemas containing refinements cannot be extended. Use `.safeExtend()` instead.");const o=Qi(t._zod.def,{get shape(){const l={...t._zod.def.shape,...s};return gn(this,"shape",l),l},checks:[]});return xn(t,o)}function U7(t,s){if(!Dc(s))throw new Error("Invalid input to safeExtend: expected a plain object");const a={...t._zod.def,get shape(){const r={...t._zod.def.shape,...s};return gn(this,"shape",r),r},checks:t._zod.def.checks};return xn(t,a)}function B7(t,s){const a=Qi(t._zod.def,{get shape(){const r={...t._zod.def.shape,...s._zod.def.shape};return gn(this,"shape",r),r},get catchall(){return s._zod.def.catchall},checks:[]});return xn(t,a)}function V7(t,s,a){const r=Qi(s._zod.def,{get shape(){const o=s._zod.def.shape,l={...o};if(a)for(const c in a){if(!(c in o))throw new Error(`Unrecognized key: "${c}"`);a[c]&&(l[c]=t?new t({type:"optional",innerType:o[c]}):o[c])}else for(const c in o)l[c]=t?new t({type:"optional",innerType:o[c]}):o[c];return gn(this,"shape",l),l},checks:[]});return xn(s,r)}function q7(t,s,a){const r=Qi(s._zod.def,{get shape(){const o=s._zod.def.shape,l={...o};if(a)for(const c in a){if(!(c in l))throw new Error(`Unrecognized key: "${c}"`);a[c]&&(l[c]=new t({type:"nonoptional",innerType:o[c]}))}else for(const c in o)l[c]=new t({type:"nonoptional",innerType:o[c]});return gn(this,"shape",l),l},checks:[]});return xn(s,r)}function Si(t,s=0){var a;if(t.aborted===!0)return!0;for(let r=s;r<t.issues.length;r++)if(((a=t.issues[r])==null?void 0:a.continue)!==!0)return!0;return!1}function eS(t,s){return s.map(a=>{var r;return(r=a).path??(r.path=[]),a.path.unshift(t),a})}function yu(t){return typeof t=="string"?t:t==null?void 0:t.message}function mo(t,s,a){var o,l,c,u,h,f;const r={...t,path:t.path??[]};if(!t.message){const p=yu((c=(l=(o=t.inst)==null?void 0:o._zod.def)==null?void 0:l.error)==null?void 0:c.call(l,t))??yu((u=s==null?void 0:s.error)==null?void 0:u.call(s,t))??yu((h=a.customError)==null?void 0:h.call(a,t))??yu((f=a.localeError)==null?void 0:f.call(a,t))??"Invalid input";r.message=p}return delete r.inst,delete r.continue,s!=null&&s.reportInput||delete r.input,r}function $g(t){return Array.isArray(t)?"array":typeof t=="string"?"string":"unknown"}function Pc(...t){const[s,a,r]=t;return typeof s=="string"?{message:s,code:"custom",input:a,inst:r}:{...s}}const tS=(t,s)=>{t.name="$ZodError",Object.defineProperty(t,"_zod",{value:t._zod,enumerable:!1}),Object.defineProperty(t,"issues",{value:s,enumerable:!1}),t.message=JSON.stringify(s,N0,2),Object.defineProperty(t,"toString",{value:()=>t.message,enumerable:!1})},sS=Se("$ZodError",tS),aS=Se("$ZodError",tS,{Parent:Error});function F7(t,s=a=>a.message){const a={},r=[];for(const o of t.issues)o.path.length>0?(a[o.path[0]]=a[o.path[0]]||[],a[o.path[0]].push(s(o))):r.push(s(o));return{formErrors:r,fieldErrors:a}}function H7(t,s){const a=s||function(l){return l.message},r={_errors:[]},o=l=>{for(const c of l.issues)if(c.code==="invalid_union"&&c.errors.length)c.errors.map(u=>o({issues:u}));else if(c.code==="invalid_key")o({issues:c.issues});else if(c.code==="invalid_element")o({issues:c.issues});else if(c.path.length===0)r._errors.push(a(c));else{let u=r,h=0;for(;h<c.path.length;){const f=c.path[h];h===c.path.length-1?(u[f]=u[f]||{_errors:[]},u[f]._errors.push(a(c))):u[f]=u[f]||{_errors:[]},u=u[f],h++}}};return o(t),r}const Ig=t=>(s,a,r,o)=>{const l=r?Object.assign(r,{async:!1}):{async:!1},c=s._zod.run({value:a,issues:[]},l);if(c instanceof Promise)throw new Mi;if(c.issues.length){const u=new((o==null?void 0:o.Err)??t)(c.issues.map(h=>mo(h,l,uo())));throw Q2(u,o==null?void 0:o.callee),u}return c.value},Lg=t=>async(s,a,r,o)=>{const l=r?Object.assign(r,{async:!0}):{async:!0};let c=s._zod.run({value:a,issues:[]},l);if(c instanceof Promise&&(c=await c),c.issues.length){const u=new((o==null?void 0:o.Err)??t)(c.issues.map(h=>mo(h,l,uo())));throw Q2(u,o==null?void 0:o.callee),u}return c.value},km=t=>(s,a,r)=>{const o=r?{...r,async:!1}:{async:!1},l=s._zod.run({value:a,issues:[]},o);if(l instanceof Promise)throw new Mi;return l.issues.length?{success:!1,error:new(t??sS)(l.issues.map(c=>mo(c,o,uo())))}:{success:!0,data:l.value}},G7=km(aS),Am=t=>async(s,a,r)=>{const o=r?Object.assign(r,{async:!0}):{async:!0};let l=s._zod.run({value:a,issues:[]},o);return l instanceof Promise&&(l=await l),l.issues.length?{success:!1,error:new t(l.issues.map(c=>mo(c,o,uo())))}:{success:!0,data:l.value}},Z7=Am(aS),W7=t=>(s,a,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Ig(t)(s,a,o)},Y7=t=>(s,a,r)=>Ig(t)(s,a,r),K7=t=>async(s,a,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Lg(t)(s,a,o)},X7=t=>async(s,a,r)=>Lg(t)(s,a,r),Q7=t=>(s,a,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return km(t)(s,a,o)},J7=t=>(s,a,r)=>km(t)(s,a,r),e9=t=>async(s,a,r)=>{const o=r?Object.assign(r,{direction:"backward"}):{direction:"backward"};return Am(t)(s,a,o)},t9=t=>async(s,a,r)=>Am(t)(s,a,r),s9=/^[cC][^\s-]{8,}$/,a9=/^[0-9a-z]+$/,r9=/^[0-9A-HJKMNP-TV-Za-hjkmnp-tv-z]{26}$/,n9=/^[0-9a-vA-V]{20}$/,o9=/^[A-Za-z0-9]{27}$/,i9=/^[a-zA-Z0-9_-]{21}$/,l9=/^P(?:(\d+W)|(?!.*W)(?=\d|T\d)(\d+Y)?(\d+M)?(\d+D)?(T(?=\d)(\d+H)?(\d+M)?(\d+([.,]\d+)?S)?)?)$/,c9=/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12})$/,n_=t=>t?new RegExp(`^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-${t}[0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12})$`):/^([0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[1-8][0-9a-fA-F]{3}-[89abAB][0-9a-fA-F]{3}-[0-9a-fA-F]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/,d9=/^(?!\.)(?!.*\.\.)([A-Za-z0-9_'+\-\.]*)[A-Za-z0-9_+-]@([A-Za-z0-9][A-Za-z0-9\-]*\.)+[A-Za-z]{2,}$/,u9="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";function m9(){return new RegExp(u9,"u")}const h9=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,f9=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:))$/,p9=/^((25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/([0-9]|[1-2][0-9]|3[0-2])$/,g9=/^(([0-9a-fA-F]{1,4}:){7}[0-9a-fA-F]{1,4}|::|([0-9a-fA-F]{1,4})?::([0-9a-fA-F]{1,4}:?){0,6})\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,x9=/^$|^(?:[0-9a-zA-Z+/]{4})*(?:(?:[0-9a-zA-Z+/]{2}==)|(?:[0-9a-zA-Z+/]{3}=))?$/,rS=/^[A-Za-z0-9_-]*$/,y9=/^(?=.{1,253}\.?$)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[-0-9a-zA-Z]{0,61}[0-9a-zA-Z])?)*\.?$/,b9=/^\+(?:[0-9]){6,14}[0-9]$/,nS="(?:(?:\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-(?:(?:0[13578]|1[02])-(?:0[1-9]|[12]\\d|3[01])|(?:0[469]|11)-(?:0[1-9]|[12]\\d|30)|(?:02)-(?:0[1-9]|1\\d|2[0-8])))",v9=new RegExp(`^${nS}$`);function oS(t){const s="(?:[01]\\d|2[0-3]):[0-5]\\d";return typeof t.precision=="number"?t.precision===-1?`${s}`:t.precision===0?`${s}:[0-5]\\d`:`${s}:[0-5]\\d\\.\\d{${t.precision}}`:`${s}(?::[0-5]\\d(?:\\.\\d+)?)?`}function w9(t){return new RegExp(`^${oS(t)}$`)}function j9(t){const s=oS({precision:t.precision}),a=["Z"];t.local&&a.push(""),t.offset&&a.push("([+-](?:[01]\\d|2[0-3]):[0-5]\\d)");const r=`${s}(?:${a.join("|")})`;return new RegExp(`^${nS}T(?:${r})$`)}const _9=t=>{const s=t?`[\\s\\S]{${(t==null?void 0:t.minimum)??0},${(t==null?void 0:t.maximum)??""}}`:"[\\s\\S]*";return new RegExp(`^${s}$`)},N9=/^-?\d+$/,S9=/^-?\d+(?:\.\d+)?/,E9=/^(?:true|false)$/i,C9=/^[^A-Z]*$/,T9=/^[^a-z]*$/,Is=Se("$ZodCheck",(t,s)=>{var a;t._zod??(t._zod={}),t._zod.def=s,(a=t._zod).onattach??(a.onattach=[])}),iS={number:"number",bigint:"bigint",object:"date"},lS=Se("$ZodCheckLessThan",(t,s)=>{Is.init(t,s);const a=iS[typeof s.value];t._zod.onattach.push(r=>{const o=r._zod.bag,l=(s.inclusive?o.maximum:o.exclusiveMaximum)??Number.POSITIVE_INFINITY;s.value<l&&(s.inclusive?o.maximum=s.value:o.exclusiveMaximum=s.value)}),t._zod.check=r=>{(s.inclusive?r.value<=s.value:r.value<s.value)||r.issues.push({origin:a,code:"too_big",maximum:s.value,input:r.value,inclusive:s.inclusive,inst:t,continue:!s.abort})}}),cS=Se("$ZodCheckGreaterThan",(t,s)=>{Is.init(t,s);const a=iS[typeof s.value];t._zod.onattach.push(r=>{const o=r._zod.bag,l=(s.inclusive?o.minimum:o.exclusiveMinimum)??Number.NEGATIVE_INFINITY;s.value>l&&(s.inclusive?o.minimum=s.value:o.exclusiveMinimum=s.value)}),t._zod.check=r=>{(s.inclusive?r.value>=s.value:r.value>s.value)||r.issues.push({origin:a,code:"too_small",minimum:s.value,input:r.value,inclusive:s.inclusive,inst:t,continue:!s.abort})}}),k9=Se("$ZodCheckMultipleOf",(t,s)=>{Is.init(t,s),t._zod.onattach.push(a=>{var r;(r=a._zod.bag).multipleOf??(r.multipleOf=s.value)}),t._zod.check=a=>{if(typeof a.value!=typeof s.value)throw new Error("Cannot mix number and bigint in multiple_of check.");(typeof a.value=="bigint"?a.value%s.value===BigInt(0):M7(a.value,s.value)===0)||a.issues.push({origin:typeof a.value,code:"not_multiple_of",divisor:s.value,input:a.value,inst:t,continue:!s.abort})}}),A9=Se("$ZodCheckNumberFormat",(t,s)=>{var c;Is.init(t,s),s.format=s.format||"float64";const a=(c=s.format)==null?void 0:c.includes("int"),r=a?"int":"number",[o,l]=z7[s.format];t._zod.onattach.push(u=>{const h=u._zod.bag;h.format=s.format,h.minimum=o,h.maximum=l,a&&(h.pattern=N9)}),t._zod.check=u=>{const h=u.value;if(a){if(!Number.isInteger(h)){u.issues.push({expected:r,format:s.format,code:"invalid_type",continue:!1,input:h,inst:t});return}if(!Number.isSafeInteger(h)){h>0?u.issues.push({input:h,code:"too_big",maximum:Number.MAX_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,continue:!s.abort}):u.issues.push({input:h,code:"too_small",minimum:Number.MIN_SAFE_INTEGER,note:"Integers must be within the safe integer range.",inst:t,origin:r,continue:!s.abort});return}}h<o&&u.issues.push({origin:"number",input:h,code:"too_small",minimum:o,inclusive:!0,inst:t,continue:!s.abort}),h>l&&u.issues.push({origin:"number",input:h,code:"too_big",maximum:l,inst:t})}}),M9=Se("$ZodCheckMaxLength",(t,s)=>{var a;Is.init(t,s),(a=t._zod.def).when??(a.when=r=>{const o=r.value;return!Pg(o)&&o.length!==void 0}),t._zod.onattach.push(r=>{const o=r._zod.bag.maximum??Number.POSITIVE_INFINITY;s.maximum<o&&(r._zod.bag.maximum=s.maximum)}),t._zod.check=r=>{const o=r.value;if(o.length<=s.maximum)return;const c=$g(o);r.issues.push({origin:c,code:"too_big",maximum:s.maximum,inclusive:!0,input:o,inst:t,continue:!s.abort})}}),R9=Se("$ZodCheckMinLength",(t,s)=>{var a;Is.init(t,s),(a=t._zod.def).when??(a.when=r=>{const o=r.value;return!Pg(o)&&o.length!==void 0}),t._zod.onattach.push(r=>{const o=r._zod.bag.minimum??Number.NEGATIVE_INFINITY;s.minimum>o&&(r._zod.bag.minimum=s.minimum)}),t._zod.check=r=>{const o=r.value;if(o.length>=s.minimum)return;const c=$g(o);r.issues.push({origin:c,code:"too_small",minimum:s.minimum,inclusive:!0,input:o,inst:t,continue:!s.abort})}}),O9=Se("$ZodCheckLengthEquals",(t,s)=>{var a;Is.init(t,s),(a=t._zod.def).when??(a.when=r=>{const o=r.value;return!Pg(o)&&o.length!==void 0}),t._zod.onattach.push(r=>{const o=r._zod.bag;o.minimum=s.length,o.maximum=s.length,o.length=s.length}),t._zod.check=r=>{const o=r.value,l=o.length;if(l===s.length)return;const c=$g(o),u=l>s.length;r.issues.push({origin:c,...u?{code:"too_big",maximum:s.length}:{code:"too_small",minimum:s.length},inclusive:!0,exact:!0,input:r.value,inst:t,continue:!s.abort})}}),Mm=Se("$ZodCheckStringFormat",(t,s)=>{var a,r;Is.init(t,s),t._zod.onattach.push(o=>{const l=o._zod.bag;l.format=s.format,s.pattern&&(l.patterns??(l.patterns=new Set),l.patterns.add(s.pattern))}),s.pattern?(a=t._zod).check??(a.check=o=>{s.pattern.lastIndex=0,!s.pattern.test(o.value)&&o.issues.push({origin:"string",code:"invalid_format",format:s.format,input:o.value,...s.pattern?{pattern:s.pattern.toString()}:{},inst:t,continue:!s.abort})}):(r=t._zod).check??(r.check=()=>{})}),D9=Se("$ZodCheckRegex",(t,s)=>{Mm.init(t,s),t._zod.check=a=>{s.pattern.lastIndex=0,!s.pattern.test(a.value)&&a.issues.push({origin:"string",code:"invalid_format",format:"regex",input:a.value,pattern:s.pattern.toString(),inst:t,continue:!s.abort})}}),P9=Se("$ZodCheckLowerCase",(t,s)=>{s.pattern??(s.pattern=C9),Mm.init(t,s)}),z9=Se("$ZodCheckUpperCase",(t,s)=>{s.pattern??(s.pattern=T9),Mm.init(t,s)}),$9=Se("$ZodCheckIncludes",(t,s)=>{Is.init(t,s);const a=Tm(s.includes),r=new RegExp(typeof s.position=="number"?`^.{${s.position}}${a}`:a);s.pattern=r,t._zod.onattach.push(o=>{const l=o._zod.bag;l.patterns??(l.patterns=new Set),l.patterns.add(r)}),t._zod.check=o=>{o.value.includes(s.includes,s.position)||o.issues.push({origin:"string",code:"invalid_format",format:"includes",includes:s.includes,input:o.value,inst:t,continue:!s.abort})}}),I9=Se("$ZodCheckStartsWith",(t,s)=>{Is.init(t,s);const a=new RegExp(`^${Tm(s.prefix)}.*`);s.pattern??(s.pattern=a),t._zod.onattach.push(r=>{const o=r._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(a)}),t._zod.check=r=>{r.value.startsWith(s.prefix)||r.issues.push({origin:"string",code:"invalid_format",format:"starts_with",prefix:s.prefix,input:r.value,inst:t,continue:!s.abort})}}),L9=Se("$ZodCheckEndsWith",(t,s)=>{Is.init(t,s);const a=new RegExp(`.*${Tm(s.suffix)}$`);s.pattern??(s.pattern=a),t._zod.onattach.push(r=>{const o=r._zod.bag;o.patterns??(o.patterns=new Set),o.patterns.add(a)}),t._zod.check=r=>{r.value.endsWith(s.suffix)||r.issues.push({origin:"string",code:"invalid_format",format:"ends_with",suffix:s.suffix,input:r.value,inst:t,continue:!s.abort})}}),U9=Se("$ZodCheckOverwrite",(t,s)=>{Is.init(t,s),t._zod.check=a=>{a.value=s.tx(a.value)}});class B9{constructor(s=[]){this.content=[],this.indent=0,this&&(this.args=s)}indented(s){this.indent+=1,s(this),this.indent-=1}write(s){if(typeof s=="function"){s(this,{execution:"sync"}),s(this,{execution:"async"});return}const r=s.split(`
`).filter(c=>c),o=Math.min(...r.map(c=>c.length-c.trimStart().length)),l=r.map(c=>c.slice(o)).map(c=>" ".repeat(this.indent*2)+c);for(const c of l)this.content.push(c)}compile(){const s=Function,a=this==null?void 0:this.args,o=[...((this==null?void 0:this.content)??[""]).map(l=>`  ${l}`)];return new s(...a,o.join(`
`))}}const V9={major:4,minor:1,patch:9},Kt=Se("$ZodType",(t,s)=>{var o;var a;t??(t={}),t._zod.def=s,t._zod.bag=t._zod.bag||{},t._zod.version=V9;const r=[...t._zod.def.checks??[]];t._zod.traits.has("$ZodCheck")&&r.unshift(t);for(const l of r)for(const c of l._zod.onattach)c(t);if(r.length===0)(a=t._zod).deferred??(a.deferred=[]),(o=t._zod.deferred)==null||o.push(()=>{t._zod.run=t._zod.parse});else{const l=(u,h,f)=>{let p=Si(u),g;for(const v of h){if(v._zod.def.when){if(!v._zod.def.when(u))continue}else if(p)continue;const b=u.issues.length,_=v._zod.check(u);if(_ instanceof Promise&&(f==null?void 0:f.async)===!1)throw new Mi;if(g||_ instanceof Promise)g=(g??Promise.resolve()).then(async()=>{await _,u.issues.length!==b&&(p||(p=Si(u,b)))});else{if(u.issues.length===b)continue;p||(p=Si(u,b))}}return g?g.then(()=>u):u},c=(u,h,f)=>{if(Si(u))return u.aborted=!0,u;const p=l(h,r,f);if(p instanceof Promise){if(f.async===!1)throw new Mi;return p.then(g=>t._zod.parse(g,f))}return t._zod.parse(p,f)};t._zod.run=(u,h)=>{if(h.skipChecks)return t._zod.parse(u,h);if(h.direction==="backward"){const p=t._zod.parse({value:u.value,issues:[]},{...h,skipChecks:!0});return p instanceof Promise?p.then(g=>c(g,u,h)):c(p,u,h)}const f=t._zod.parse(u,h);if(f instanceof Promise){if(h.async===!1)throw new Mi;return f.then(p=>l(p,r,h))}return l(f,r,h)}}t["~standard"]={validate:l=>{var c;try{const u=G7(t,l);return u.success?{value:u.data}:{issues:(c=u.error)==null?void 0:c.issues}}catch{return Z7(t,l).then(h=>{var f;return h.success?{value:h.data}:{issues:(f=h.error)==null?void 0:f.issues}})}},vendor:"zod",version:1}}),Ug=Se("$ZodString",(t,s)=>{var a;Kt.init(t,s),t._zod.pattern=[...((a=t==null?void 0:t._zod.bag)==null?void 0:a.patterns)??[]].pop()??_9(t._zod.bag),t._zod.parse=(r,o)=>{if(s.coerce)try{r.value=String(r.value)}catch{}return typeof r.value=="string"||r.issues.push({expected:"string",code:"invalid_type",input:r.value,inst:t}),r}}),Rt=Se("$ZodStringFormat",(t,s)=>{Mm.init(t,s),Ug.init(t,s)}),q9=Se("$ZodGUID",(t,s)=>{s.pattern??(s.pattern=c9),Rt.init(t,s)}),F9=Se("$ZodUUID",(t,s)=>{if(s.version){const r={v1:1,v2:2,v3:3,v4:4,v5:5,v6:6,v7:7,v8:8}[s.version];if(r===void 0)throw new Error(`Invalid UUID version: "${s.version}"`);s.pattern??(s.pattern=n_(r))}else s.pattern??(s.pattern=n_());Rt.init(t,s)}),H9=Se("$ZodEmail",(t,s)=>{s.pattern??(s.pattern=d9),Rt.init(t,s)}),G9=Se("$ZodURL",(t,s)=>{Rt.init(t,s),t._zod.check=a=>{try{const r=a.value.trim(),o=new URL(r);s.hostname&&(s.hostname.lastIndex=0,s.hostname.test(o.hostname)||a.issues.push({code:"invalid_format",format:"url",note:"Invalid hostname",pattern:y9.source,input:a.value,inst:t,continue:!s.abort})),s.protocol&&(s.protocol.lastIndex=0,s.protocol.test(o.protocol.endsWith(":")?o.protocol.slice(0,-1):o.protocol)||a.issues.push({code:"invalid_format",format:"url",note:"Invalid protocol",pattern:s.protocol.source,input:a.value,inst:t,continue:!s.abort})),s.normalize?a.value=o.href:a.value=r;return}catch{a.issues.push({code:"invalid_format",format:"url",input:a.value,inst:t,continue:!s.abort})}}}),Z9=Se("$ZodEmoji",(t,s)=>{s.pattern??(s.pattern=m9()),Rt.init(t,s)}),W9=Se("$ZodNanoID",(t,s)=>{s.pattern??(s.pattern=i9),Rt.init(t,s)}),Y9=Se("$ZodCUID",(t,s)=>{s.pattern??(s.pattern=s9),Rt.init(t,s)}),K9=Se("$ZodCUID2",(t,s)=>{s.pattern??(s.pattern=a9),Rt.init(t,s)}),X9=Se("$ZodULID",(t,s)=>{s.pattern??(s.pattern=r9),Rt.init(t,s)}),Q9=Se("$ZodXID",(t,s)=>{s.pattern??(s.pattern=n9),Rt.init(t,s)}),J9=Se("$ZodKSUID",(t,s)=>{s.pattern??(s.pattern=o9),Rt.init(t,s)}),eI=Se("$ZodISODateTime",(t,s)=>{s.pattern??(s.pattern=j9(s)),Rt.init(t,s)}),tI=Se("$ZodISODate",(t,s)=>{s.pattern??(s.pattern=v9),Rt.init(t,s)}),sI=Se("$ZodISOTime",(t,s)=>{s.pattern??(s.pattern=w9(s)),Rt.init(t,s)}),aI=Se("$ZodISODuration",(t,s)=>{s.pattern??(s.pattern=l9),Rt.init(t,s)}),rI=Se("$ZodIPv4",(t,s)=>{s.pattern??(s.pattern=h9),Rt.init(t,s),t._zod.onattach.push(a=>{const r=a._zod.bag;r.format="ipv4"})}),nI=Se("$ZodIPv6",(t,s)=>{s.pattern??(s.pattern=f9),Rt.init(t,s),t._zod.onattach.push(a=>{const r=a._zod.bag;r.format="ipv6"}),t._zod.check=a=>{try{new URL(`http://[${a.value}]`)}catch{a.issues.push({code:"invalid_format",format:"ipv6",input:a.value,inst:t,continue:!s.abort})}}}),oI=Se("$ZodCIDRv4",(t,s)=>{s.pattern??(s.pattern=p9),Rt.init(t,s)}),iI=Se("$ZodCIDRv6",(t,s)=>{s.pattern??(s.pattern=g9),Rt.init(t,s),t._zod.check=a=>{const r=a.value.split("/");try{if(r.length!==2)throw new Error;const[o,l]=r;if(!l)throw new Error;const c=Number(l);if(`${c}`!==l)throw new Error;if(c<0||c>128)throw new Error;new URL(`http://[${o}]`)}catch{a.issues.push({code:"invalid_format",format:"cidrv6",input:a.value,inst:t,continue:!s.abort})}}});function dS(t){if(t==="")return!0;if(t.length%4!==0)return!1;try{return atob(t),!0}catch{return!1}}const lI=Se("$ZodBase64",(t,s)=>{s.pattern??(s.pattern=x9),Rt.init(t,s),t._zod.onattach.push(a=>{a._zod.bag.contentEncoding="base64"}),t._zod.check=a=>{dS(a.value)||a.issues.push({code:"invalid_format",format:"base64",input:a.value,inst:t,continue:!s.abort})}});function cI(t){if(!rS.test(t))return!1;const s=t.replace(/[-_]/g,r=>r==="-"?"+":"/"),a=s.padEnd(Math.ceil(s.length/4)*4,"=");return dS(a)}const dI=Se("$ZodBase64URL",(t,s)=>{s.pattern??(s.pattern=rS),Rt.init(t,s),t._zod.onattach.push(a=>{a._zod.bag.contentEncoding="base64url"}),t._zod.check=a=>{cI(a.value)||a.issues.push({code:"invalid_format",format:"base64url",input:a.value,inst:t,continue:!s.abort})}}),uI=Se("$ZodE164",(t,s)=>{s.pattern??(s.pattern=b9),Rt.init(t,s)});function mI(t,s=null){try{const a=t.split(".");if(a.length!==3)return!1;const[r]=a;if(!r)return!1;const o=JSON.parse(atob(r));return!("typ"in o&&(o==null?void 0:o.typ)!=="JWT"||!o.alg||s&&(!("alg"in o)||o.alg!==s))}catch{return!1}}const hI=Se("$ZodJWT",(t,s)=>{Rt.init(t,s),t._zod.check=a=>{mI(a.value,s.alg)||a.issues.push({code:"invalid_format",format:"jwt",input:a.value,inst:t,continue:!s.abort})}}),uS=Se("$ZodNumber",(t,s)=>{Kt.init(t,s),t._zod.pattern=t._zod.bag.pattern??S9,t._zod.parse=(a,r)=>{if(s.coerce)try{a.value=Number(a.value)}catch{}const o=a.value;if(typeof o=="number"&&!Number.isNaN(o)&&Number.isFinite(o))return a;const l=typeof o=="number"?Number.isNaN(o)?"NaN":Number.isFinite(o)?void 0:"Infinity":void 0;return a.issues.push({expected:"number",code:"invalid_type",input:o,inst:t,...l?{received:l}:{}}),a}}),fI=Se("$ZodNumber",(t,s)=>{A9.init(t,s),uS.init(t,s)}),pI=Se("$ZodBoolean",(t,s)=>{Kt.init(t,s),t._zod.pattern=E9,t._zod.parse=(a,r)=>{if(s.coerce)try{a.value=!!a.value}catch{}const o=a.value;return typeof o=="boolean"||a.issues.push({expected:"boolean",code:"invalid_type",input:o,inst:t}),a}}),gI=Se("$ZodUnknown",(t,s)=>{Kt.init(t,s),t._zod.parse=a=>a}),xI=Se("$ZodNever",(t,s)=>{Kt.init(t,s),t._zod.parse=(a,r)=>(a.issues.push({expected:"never",code:"invalid_type",input:a.value,inst:t}),a)});function o_(t,s,a){t.issues.length&&s.issues.push(...eS(a,t.issues)),s.value[a]=t.value}const yI=Se("$ZodArray",(t,s)=>{Kt.init(t,s),t._zod.parse=(a,r)=>{const o=a.value;if(!Array.isArray(o))return a.issues.push({expected:"array",code:"invalid_type",input:o,inst:t}),a;a.value=Array(o.length);const l=[];for(let c=0;c<o.length;c++){const u=o[c],h=s.element._zod.run({value:u,issues:[]},r);h instanceof Promise?l.push(h.then(f=>o_(f,a,c))):o_(h,a,c)}return l.length?Promise.all(l).then(()=>a):a}});function im(t,s,a,r){t.issues.length&&s.issues.push(...eS(a,t.issues)),t.value===void 0?a in r&&(s.value[a]=void 0):s.value[a]=t.value}function mS(t){var r,o,l,c;const s=Object.keys(t.shape);for(const u of s)if(!((c=(l=(o=(r=t.shape)==null?void 0:r[u])==null?void 0:o._zod)==null?void 0:l.traits)!=null&&c.has("$ZodType")))throw new Error(`Invalid element at key "${u}": expected a Zod schema`);const a=P7(t.shape);return{...t,keys:s,keySet:new Set(s),numKeys:s.length,optionalKeys:new Set(a)}}function hS(t,s,a,r,o,l){const c=[],u=o.keySet,h=o.catchall._zod,f=h.def.type;for(const p of Object.keys(s)){if(u.has(p))continue;if(f==="never"){c.push(p);continue}const g=h.run({value:s[p],issues:[]},r);g instanceof Promise?t.push(g.then(v=>im(v,a,p,s))):im(g,a,p,s)}return c.length&&a.issues.push({code:"unrecognized_keys",keys:c,input:s,inst:l}),t.length?Promise.all(t).then(()=>a):a}const bI=Se("$ZodObject",(t,s)=>{Kt.init(t,s);const a=Dg(()=>mS(s));Et(t._zod,"propValues",()=>{const c=s.shape,u={};for(const h in c){const f=c[h]._zod;if(f.values){u[h]??(u[h]=new Set);for(const p of f.values)u[h].add(p)}}return u});const r=om,o=s.catchall;let l;t._zod.parse=(c,u)=>{l??(l=a.value);const h=c.value;if(!r(h))return c.issues.push({expected:"object",code:"invalid_type",input:h,inst:t}),c;c.value={};const f=[],p=l.shape;for(const g of l.keys){const b=p[g]._zod.run({value:h[g],issues:[]},u);b instanceof Promise?f.push(b.then(_=>im(_,c,g,h))):im(b,c,g,h)}return o?hS(f,h,c,u,a.value,t):f.length?Promise.all(f).then(()=>c):c}}),vI=Se("$ZodObjectJIT",(t,s)=>{bI.init(t,s);const a=t._zod.parse,r=Dg(()=>mS(s)),o=v=>{const b=new B9(["shape","payload","ctx"]),_=r.value,w=C=>{const S=r_(C);return`shape[${S}]._zod.run({ value: input[${S}], issues: [] }, ctx)`};b.write("const input = payload.value;");const E=Object.create(null);let k=0;for(const C of _.keys)E[C]=`key_${k++}`;b.write("const newResult = {};");for(const C of _.keys){const S=E[C],T=r_(C);b.write(`const ${S} = ${w(C)};`),b.write(`
        if (${S}.issues.length) {
          payload.issues = payload.issues.concat(${S}.issues.map(iss => ({
            ...iss,
            path: iss.path ? [${T}, ...iss.path] : [${T}]
          })));
        }
        
        
        if (${S}.value === undefined) {
          if (${T} in input) {
            newResult[${T}] = undefined;
          }
        } else {
          newResult[${T}] = ${S}.value;
        }
        
      `)}b.write("payload.value = newResult;"),b.write("return payload;");const N=b.compile();return(C,S)=>N(v,C,S)};let l;const c=om,u=!X2.jitless,f=u&&O7.value,p=s.catchall;let g;t._zod.parse=(v,b)=>{g??(g=r.value);const _=v.value;return c(_)?u&&f&&(b==null?void 0:b.async)===!1&&b.jitless!==!0?(l||(l=o(s.shape)),v=l(v,b),p?hS([],_,v,b,g,t):v):a(v,b):(v.issues.push({expected:"object",code:"invalid_type",input:_,inst:t}),v)}});function i_(t,s,a,r){for(const l of t)if(l.issues.length===0)return s.value=l.value,s;const o=t.filter(l=>!Si(l));return o.length===1?(s.value=o[0].value,o[0]):(s.issues.push({code:"invalid_union",input:s.value,inst:a,errors:t.map(l=>l.issues.map(c=>mo(c,r,uo())))}),s)}const wI=Se("$ZodUnion",(t,s)=>{Kt.init(t,s),Et(t._zod,"optin",()=>s.options.some(o=>o._zod.optin==="optional")?"optional":void 0),Et(t._zod,"optout",()=>s.options.some(o=>o._zod.optout==="optional")?"optional":void 0),Et(t._zod,"values",()=>{if(s.options.every(o=>o._zod.values))return new Set(s.options.flatMap(o=>Array.from(o._zod.values)))}),Et(t._zod,"pattern",()=>{if(s.options.every(o=>o._zod.pattern)){const o=s.options.map(l=>l._zod.pattern);return new RegExp(`^(${o.map(l=>zg(l.source)).join("|")})$`)}});const a=s.options.length===1,r=s.options[0]._zod.run;t._zod.parse=(o,l)=>{if(a)return r(o,l);let c=!1;const u=[];for(const h of s.options){const f=h._zod.run({value:o.value,issues:[]},l);if(f instanceof Promise)u.push(f),c=!0;else{if(f.issues.length===0)return f;u.push(f)}}return c?Promise.all(u).then(h=>i_(h,o,t,l)):i_(u,o,t,l)}}),jI=Se("$ZodIntersection",(t,s)=>{Kt.init(t,s),t._zod.parse=(a,r)=>{const o=a.value,l=s.left._zod.run({value:o,issues:[]},r),c=s.right._zod.run({value:o,issues:[]},r);return l instanceof Promise||c instanceof Promise?Promise.all([l,c]).then(([h,f])=>l_(a,h,f)):l_(a,l,c)}});function S0(t,s){if(t===s)return{valid:!0,data:t};if(t instanceof Date&&s instanceof Date&&+t==+s)return{valid:!0,data:t};if(Dc(t)&&Dc(s)){const a=Object.keys(s),r=Object.keys(t).filter(l=>a.indexOf(l)!==-1),o={...t,...s};for(const l of r){const c=S0(t[l],s[l]);if(!c.valid)return{valid:!1,mergeErrorPath:[l,...c.mergeErrorPath]};o[l]=c.data}return{valid:!0,data:o}}if(Array.isArray(t)&&Array.isArray(s)){if(t.length!==s.length)return{valid:!1,mergeErrorPath:[]};const a=[];for(let r=0;r<t.length;r++){const o=t[r],l=s[r],c=S0(o,l);if(!c.valid)return{valid:!1,mergeErrorPath:[r,...c.mergeErrorPath]};a.push(c.data)}return{valid:!0,data:a}}return{valid:!1,mergeErrorPath:[]}}function l_(t,s,a){if(s.issues.length&&t.issues.push(...s.issues),a.issues.length&&t.issues.push(...a.issues),Si(t))return t;const r=S0(s.value,a.value);if(!r.valid)throw new Error(`Unmergable intersection. Error path: ${JSON.stringify(r.mergeErrorPath)}`);return t.value=r.data,t}const _I=Se("$ZodEnum",(t,s)=>{Kt.init(t,s);const a=A7(s.entries),r=new Set(a);t._zod.values=r,t._zod.pattern=new RegExp(`^(${a.filter(o=>D7.has(typeof o)).map(o=>typeof o=="string"?Tm(o):o.toString()).join("|")})$`),t._zod.parse=(o,l)=>{const c=o.value;return r.has(c)||o.issues.push({code:"invalid_value",values:a,input:c,inst:t}),o}}),NI=Se("$ZodTransform",(t,s)=>{Kt.init(t,s),t._zod.parse=(a,r)=>{if(r.direction==="backward")throw new K2(t.constructor.name);const o=s.transform(a.value,a);if(r.async)return(o instanceof Promise?o:Promise.resolve(o)).then(c=>(a.value=c,a));if(o instanceof Promise)throw new Mi;return a.value=o,a}});function c_(t,s){return t.issues.length&&s===void 0?{issues:[],value:void 0}:t}const SI=Se("$ZodOptional",(t,s)=>{Kt.init(t,s),t._zod.optin="optional",t._zod.optout="optional",Et(t._zod,"values",()=>s.innerType._zod.values?new Set([...s.innerType._zod.values,void 0]):void 0),Et(t._zod,"pattern",()=>{const a=s.innerType._zod.pattern;return a?new RegExp(`^(${zg(a.source)})?$`):void 0}),t._zod.parse=(a,r)=>{if(s.innerType._zod.optin==="optional"){const o=s.innerType._zod.run(a,r);return o instanceof Promise?o.then(l=>c_(l,a.value)):c_(o,a.value)}return a.value===void 0?a:s.innerType._zod.run(a,r)}}),EI=Se("$ZodNullable",(t,s)=>{Kt.init(t,s),Et(t._zod,"optin",()=>s.innerType._zod.optin),Et(t._zod,"optout",()=>s.innerType._zod.optout),Et(t._zod,"pattern",()=>{const a=s.innerType._zod.pattern;return a?new RegExp(`^(${zg(a.source)}|null)$`):void 0}),Et(t._zod,"values",()=>s.innerType._zod.values?new Set([...s.innerType._zod.values,null]):void 0),t._zod.parse=(a,r)=>a.value===null?a:s.innerType._zod.run(a,r)}),CI=Se("$ZodDefault",(t,s)=>{Kt.init(t,s),t._zod.optin="optional",Et(t._zod,"values",()=>s.innerType._zod.values),t._zod.parse=(a,r)=>{if(r.direction==="backward")return s.innerType._zod.run(a,r);if(a.value===void 0)return a.value=s.defaultValue,a;const o=s.innerType._zod.run(a,r);return o instanceof Promise?o.then(l=>d_(l,s)):d_(o,s)}});function d_(t,s){return t.value===void 0&&(t.value=s.defaultValue),t}const TI=Se("$ZodPrefault",(t,s)=>{Kt.init(t,s),t._zod.optin="optional",Et(t._zod,"values",()=>s.innerType._zod.values),t._zod.parse=(a,r)=>(r.direction==="backward"||a.value===void 0&&(a.value=s.defaultValue),s.innerType._zod.run(a,r))}),kI=Se("$ZodNonOptional",(t,s)=>{Kt.init(t,s),Et(t._zod,"values",()=>{const a=s.innerType._zod.values;return a?new Set([...a].filter(r=>r!==void 0)):void 0}),t._zod.parse=(a,r)=>{const o=s.innerType._zod.run(a,r);return o instanceof Promise?o.then(l=>u_(l,t)):u_(o,t)}});function u_(t,s){return!t.issues.length&&t.value===void 0&&t.issues.push({code:"invalid_type",expected:"nonoptional",input:t.value,inst:s}),t}const AI=Se("$ZodCatch",(t,s)=>{Kt.init(t,s),Et(t._zod,"optin",()=>s.innerType._zod.optin),Et(t._zod,"optout",()=>s.innerType._zod.optout),Et(t._zod,"values",()=>s.innerType._zod.values),t._zod.parse=(a,r)=>{if(r.direction==="backward")return s.innerType._zod.run(a,r);const o=s.innerType._zod.run(a,r);return o instanceof Promise?o.then(l=>(a.value=l.value,l.issues.length&&(a.value=s.catchValue({...a,error:{issues:l.issues.map(c=>mo(c,r,uo()))},input:a.value}),a.issues=[]),a)):(a.value=o.value,o.issues.length&&(a.value=s.catchValue({...a,error:{issues:o.issues.map(l=>mo(l,r,uo()))},input:a.value}),a.issues=[]),a)}}),MI=Se("$ZodPipe",(t,s)=>{Kt.init(t,s),Et(t._zod,"values",()=>s.in._zod.values),Et(t._zod,"optin",()=>s.in._zod.optin),Et(t._zod,"optout",()=>s.out._zod.optout),Et(t._zod,"propValues",()=>s.in._zod.propValues),t._zod.parse=(a,r)=>{if(r.direction==="backward"){const l=s.out._zod.run(a,r);return l instanceof Promise?l.then(c=>bu(c,s.in,r)):bu(l,s.in,r)}const o=s.in._zod.run(a,r);return o instanceof Promise?o.then(l=>bu(l,s.out,r)):bu(o,s.out,r)}});function bu(t,s,a){return t.issues.length?(t.aborted=!0,t):s._zod.run({value:t.value,issues:t.issues},a)}const RI=Se("$ZodReadonly",(t,s)=>{Kt.init(t,s),Et(t._zod,"propValues",()=>s.innerType._zod.propValues),Et(t._zod,"values",()=>s.innerType._zod.values),Et(t._zod,"optin",()=>s.innerType._zod.optin),Et(t._zod,"optout",()=>s.innerType._zod.optout),t._zod.parse=(a,r)=>{if(r.direction==="backward")return s.innerType._zod.run(a,r);const o=s.innerType._zod.run(a,r);return o instanceof Promise?o.then(m_):m_(o)}});function m_(t){return t.value=Object.freeze(t.value),t}const OI=Se("$ZodCustom",(t,s)=>{Is.init(t,s),Kt.init(t,s),t._zod.parse=(a,r)=>a,t._zod.check=a=>{const r=a.value,o=s.fn(r);if(o instanceof Promise)return o.then(l=>h_(l,a,r,t));h_(o,a,r,t)}});function h_(t,s,a,r){if(!t){const o={code:"custom",input:a,inst:r,path:[...r._zod.def.path??[]],continue:!r._zod.def.abort};r._zod.def.params&&(o.params=r._zod.def.params),s.issues.push(Pc(o))}}class DI{constructor(){this._map=new WeakMap,this._idmap=new Map}add(s,...a){const r=a[0];if(this._map.set(s,r),r&&typeof r=="object"&&"id"in r){if(this._idmap.has(r.id))throw new Error(`ID ${r.id} already exists in the registry`);this._idmap.set(r.id,s)}return this}clear(){return this._map=new WeakMap,this._idmap=new Map,this}remove(s){const a=this._map.get(s);return a&&typeof a=="object"&&"id"in a&&this._idmap.delete(a.id),this._map.delete(s),this}get(s){const a=s._zod.parent;if(a){const r={...this.get(a)??{}};delete r.id;const o={...r,...this._map.get(s)};return Object.keys(o).length?o:void 0}return this._map.get(s)}has(s){return this._map.has(s)}}function PI(){return new DI}const vu=PI();function zI(t,s){return new t({type:"string",...qe(s)})}function $I(t,s){return new t({type:"string",format:"email",check:"string_format",abort:!1,...qe(s)})}function f_(t,s){return new t({type:"string",format:"guid",check:"string_format",abort:!1,...qe(s)})}function II(t,s){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,...qe(s)})}function LI(t,s){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v4",...qe(s)})}function UI(t,s){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v6",...qe(s)})}function BI(t,s){return new t({type:"string",format:"uuid",check:"string_format",abort:!1,version:"v7",...qe(s)})}function VI(t,s){return new t({type:"string",format:"url",check:"string_format",abort:!1,...qe(s)})}function qI(t,s){return new t({type:"string",format:"emoji",check:"string_format",abort:!1,...qe(s)})}function FI(t,s){return new t({type:"string",format:"nanoid",check:"string_format",abort:!1,...qe(s)})}function HI(t,s){return new t({type:"string",format:"cuid",check:"string_format",abort:!1,...qe(s)})}function GI(t,s){return new t({type:"string",format:"cuid2",check:"string_format",abort:!1,...qe(s)})}function ZI(t,s){return new t({type:"string",format:"ulid",check:"string_format",abort:!1,...qe(s)})}function WI(t,s){return new t({type:"string",format:"xid",check:"string_format",abort:!1,...qe(s)})}function YI(t,s){return new t({type:"string",format:"ksuid",check:"string_format",abort:!1,...qe(s)})}function KI(t,s){return new t({type:"string",format:"ipv4",check:"string_format",abort:!1,...qe(s)})}function XI(t,s){return new t({type:"string",format:"ipv6",check:"string_format",abort:!1,...qe(s)})}function QI(t,s){return new t({type:"string",format:"cidrv4",check:"string_format",abort:!1,...qe(s)})}function JI(t,s){return new t({type:"string",format:"cidrv6",check:"string_format",abort:!1,...qe(s)})}function eL(t,s){return new t({type:"string",format:"base64",check:"string_format",abort:!1,...qe(s)})}function tL(t,s){return new t({type:"string",format:"base64url",check:"string_format",abort:!1,...qe(s)})}function sL(t,s){return new t({type:"string",format:"e164",check:"string_format",abort:!1,...qe(s)})}function aL(t,s){return new t({type:"string",format:"jwt",check:"string_format",abort:!1,...qe(s)})}function rL(t,s){return new t({type:"string",format:"datetime",check:"string_format",offset:!1,local:!1,precision:null,...qe(s)})}function nL(t,s){return new t({type:"string",format:"date",check:"string_format",...qe(s)})}function oL(t,s){return new t({type:"string",format:"time",check:"string_format",precision:null,...qe(s)})}function iL(t,s){return new t({type:"string",format:"duration",check:"string_format",...qe(s)})}function lL(t,s){return new t({type:"number",checks:[],...qe(s)})}function cL(t,s){return new t({type:"number",check:"number_format",abort:!1,format:"safeint",...qe(s)})}function dL(t,s){return new t({type:"boolean",...qe(s)})}function uL(t){return new t({type:"unknown"})}function mL(t,s){return new t({type:"never",...qe(s)})}function p_(t,s){return new lS({check:"less_than",...qe(s),value:t,inclusive:!1})}function Ep(t,s){return new lS({check:"less_than",...qe(s),value:t,inclusive:!0})}function g_(t,s){return new cS({check:"greater_than",...qe(s),value:t,inclusive:!1})}function Cp(t,s){return new cS({check:"greater_than",...qe(s),value:t,inclusive:!0})}function x_(t,s){return new k9({check:"multiple_of",...qe(s),value:t})}function fS(t,s){return new M9({check:"max_length",...qe(s),maximum:t})}function lm(t,s){return new R9({check:"min_length",...qe(s),minimum:t})}function pS(t,s){return new O9({check:"length_equals",...qe(s),length:t})}function hL(t,s){return new D9({check:"string_format",format:"regex",...qe(s),pattern:t})}function fL(t){return new P9({check:"string_format",format:"lowercase",...qe(t)})}function pL(t){return new z9({check:"string_format",format:"uppercase",...qe(t)})}function gL(t,s){return new $9({check:"string_format",format:"includes",...qe(s),includes:t})}function xL(t,s){return new I9({check:"string_format",format:"starts_with",...qe(s),prefix:t})}function yL(t,s){return new L9({check:"string_format",format:"ends_with",...qe(s),suffix:t})}function Gc(t){return new U9({check:"overwrite",tx:t})}function bL(t){return Gc(s=>s.normalize(t))}function vL(){return Gc(t=>t.trim())}function wL(){return Gc(t=>t.toLowerCase())}function jL(){return Gc(t=>t.toUpperCase())}function _L(t,s,a){return new t({type:"array",element:s,...qe(a)})}function NL(t,s,a){return new t({type:"custom",check:"custom",fn:s,...qe(a)})}function SL(t){const s=EL(a=>(a.addIssue=r=>{if(typeof r=="string")a.issues.push(Pc(r,a.value,s._zod.def));else{const o=r;o.fatal&&(o.continue=!1),o.code??(o.code="custom"),o.input??(o.input=a.value),o.inst??(o.inst=s),o.continue??(o.continue=!s._zod.def.abort),a.issues.push(Pc(o))}},t(a.value,a)));return s}function EL(t,s){const a=new Is({check:"custom",...qe(s)});return a._zod.check=t,a}const CL=Se("ZodISODateTime",(t,s)=>{eI.init(t,s),zt.init(t,s)});function TL(t){return rL(CL,t)}const kL=Se("ZodISODate",(t,s)=>{tI.init(t,s),zt.init(t,s)});function AL(t){return nL(kL,t)}const ML=Se("ZodISOTime",(t,s)=>{sI.init(t,s),zt.init(t,s)});function RL(t){return oL(ML,t)}const OL=Se("ZodISODuration",(t,s)=>{aI.init(t,s),zt.init(t,s)});function DL(t){return iL(OL,t)}const PL=(t,s)=>{sS.init(t,s),t.name="ZodError",Object.defineProperties(t,{format:{value:a=>H7(t,a)},flatten:{value:a=>F7(t,a)},addIssue:{value:a=>{t.issues.push(a),t.message=JSON.stringify(t.issues,N0,2)}},addIssues:{value:a=>{t.issues.push(...a),t.message=JSON.stringify(t.issues,N0,2)}},isEmpty:{get(){return t.issues.length===0}}})},fa=Se("ZodError",PL,{Parent:Error}),zL=Ig(fa),$L=Lg(fa),IL=km(fa),LL=Am(fa),UL=W7(fa),BL=Y7(fa),VL=K7(fa),qL=X7(fa),FL=Q7(fa),HL=J7(fa),GL=e9(fa),ZL=t9(fa),ss=Se("ZodType",(t,s)=>(Kt.init(t,s),t.def=s,t.type=s.type,Object.defineProperty(t,"_def",{value:s}),t.check=(...a)=>t.clone({...s,checks:[...s.checks??[],...a.map(r=>typeof r=="function"?{_zod:{check:r,def:{check:"custom"},onattach:[]}}:r)]}),t.clone=(a,r)=>xn(t,a,r),t.brand=()=>t,t.register=(a,r)=>(a.add(t,r),t),t.parse=(a,r)=>zL(t,a,r,{callee:t.parse}),t.safeParse=(a,r)=>IL(t,a,r),t.parseAsync=async(a,r)=>$L(t,a,r,{callee:t.parseAsync}),t.safeParseAsync=async(a,r)=>LL(t,a,r),t.spa=t.safeParseAsync,t.encode=(a,r)=>UL(t,a,r),t.decode=(a,r)=>BL(t,a,r),t.encodeAsync=async(a,r)=>VL(t,a,r),t.decodeAsync=async(a,r)=>qL(t,a,r),t.safeEncode=(a,r)=>FL(t,a,r),t.safeDecode=(a,r)=>HL(t,a,r),t.safeEncodeAsync=async(a,r)=>GL(t,a,r),t.safeDecodeAsync=async(a,r)=>ZL(t,a,r),t.refine=(a,r)=>t.check(LU(a,r)),t.superRefine=a=>t.check(UU(a)),t.overwrite=a=>t.check(Gc(a)),t.optional=()=>w_(t),t.nullable=()=>j_(t),t.nullish=()=>w_(j_(t)),t.nonoptional=a=>RU(t,a),t.array=()=>bU(t),t.or=a=>jU([t,a]),t.and=a=>NU(t,a),t.transform=a=>__(t,EU(a)),t.default=a=>kU(t,a),t.prefault=a=>MU(t,a),t.catch=a=>DU(t,a),t.pipe=a=>__(t,a),t.readonly=()=>$U(t),t.describe=a=>{const r=t.clone();return vu.add(r,{description:a}),r},Object.defineProperty(t,"description",{get(){var a;return(a=vu.get(t))==null?void 0:a.description},configurable:!0}),t.meta=(...a)=>{if(a.length===0)return vu.get(t);const r=t.clone();return vu.add(r,a[0]),r},t.isOptional=()=>t.safeParse(void 0).success,t.isNullable=()=>t.safeParse(null).success,t)),gS=Se("_ZodString",(t,s)=>{Ug.init(t,s),ss.init(t,s);const a=t._zod.bag;t.format=a.format??null,t.minLength=a.minimum??null,t.maxLength=a.maximum??null,t.regex=(...r)=>t.check(hL(...r)),t.includes=(...r)=>t.check(gL(...r)),t.startsWith=(...r)=>t.check(xL(...r)),t.endsWith=(...r)=>t.check(yL(...r)),t.min=(...r)=>t.check(lm(...r)),t.max=(...r)=>t.check(fS(...r)),t.length=(...r)=>t.check(pS(...r)),t.nonempty=(...r)=>t.check(lm(1,...r)),t.lowercase=r=>t.check(fL(r)),t.uppercase=r=>t.check(pL(r)),t.trim=()=>t.check(vL()),t.normalize=(...r)=>t.check(bL(...r)),t.toLowerCase=()=>t.check(wL()),t.toUpperCase=()=>t.check(jL())}),WL=Se("ZodString",(t,s)=>{Ug.init(t,s),gS.init(t,s),t.email=a=>t.check($I(YL,a)),t.url=a=>t.check(VI(KL,a)),t.jwt=a=>t.check(aL(uU,a)),t.emoji=a=>t.check(qI(XL,a)),t.guid=a=>t.check(f_(y_,a)),t.uuid=a=>t.check(II(wu,a)),t.uuidv4=a=>t.check(LI(wu,a)),t.uuidv6=a=>t.check(UI(wu,a)),t.uuidv7=a=>t.check(BI(wu,a)),t.nanoid=a=>t.check(FI(QL,a)),t.guid=a=>t.check(f_(y_,a)),t.cuid=a=>t.check(HI(JL,a)),t.cuid2=a=>t.check(GI(eU,a)),t.ulid=a=>t.check(ZI(tU,a)),t.base64=a=>t.check(eL(lU,a)),t.base64url=a=>t.check(tL(cU,a)),t.xid=a=>t.check(WI(sU,a)),t.ksuid=a=>t.check(YI(aU,a)),t.ipv4=a=>t.check(KI(rU,a)),t.ipv6=a=>t.check(XI(nU,a)),t.cidrv4=a=>t.check(QI(oU,a)),t.cidrv6=a=>t.check(JI(iU,a)),t.e164=a=>t.check(sL(dU,a)),t.datetime=a=>t.check(TL(a)),t.date=a=>t.check(AL(a)),t.time=a=>t.check(RL(a)),t.duration=a=>t.check(DL(a))});function Zt(t){return zI(WL,t)}const zt=Se("ZodStringFormat",(t,s)=>{Rt.init(t,s),gS.init(t,s)}),YL=Se("ZodEmail",(t,s)=>{H9.init(t,s),zt.init(t,s)}),y_=Se("ZodGUID",(t,s)=>{q9.init(t,s),zt.init(t,s)}),wu=Se("ZodUUID",(t,s)=>{F9.init(t,s),zt.init(t,s)}),KL=Se("ZodURL",(t,s)=>{G9.init(t,s),zt.init(t,s)}),XL=Se("ZodEmoji",(t,s)=>{Z9.init(t,s),zt.init(t,s)}),QL=Se("ZodNanoID",(t,s)=>{W9.init(t,s),zt.init(t,s)}),JL=Se("ZodCUID",(t,s)=>{Y9.init(t,s),zt.init(t,s)}),eU=Se("ZodCUID2",(t,s)=>{K9.init(t,s),zt.init(t,s)}),tU=Se("ZodULID",(t,s)=>{X9.init(t,s),zt.init(t,s)}),sU=Se("ZodXID",(t,s)=>{Q9.init(t,s),zt.init(t,s)}),aU=Se("ZodKSUID",(t,s)=>{J9.init(t,s),zt.init(t,s)}),rU=Se("ZodIPv4",(t,s)=>{rI.init(t,s),zt.init(t,s)}),nU=Se("ZodIPv6",(t,s)=>{nI.init(t,s),zt.init(t,s)}),oU=Se("ZodCIDRv4",(t,s)=>{oI.init(t,s),zt.init(t,s)}),iU=Se("ZodCIDRv6",(t,s)=>{iI.init(t,s),zt.init(t,s)}),lU=Se("ZodBase64",(t,s)=>{lI.init(t,s),zt.init(t,s)}),cU=Se("ZodBase64URL",(t,s)=>{dI.init(t,s),zt.init(t,s)}),dU=Se("ZodE164",(t,s)=>{uI.init(t,s),zt.init(t,s)}),uU=Se("ZodJWT",(t,s)=>{hI.init(t,s),zt.init(t,s)}),xS=Se("ZodNumber",(t,s)=>{uS.init(t,s),ss.init(t,s),t.gt=(r,o)=>t.check(g_(r,o)),t.gte=(r,o)=>t.check(Cp(r,o)),t.min=(r,o)=>t.check(Cp(r,o)),t.lt=(r,o)=>t.check(p_(r,o)),t.lte=(r,o)=>t.check(Ep(r,o)),t.max=(r,o)=>t.check(Ep(r,o)),t.int=r=>t.check(b_(r)),t.safe=r=>t.check(b_(r)),t.positive=r=>t.check(g_(0,r)),t.nonnegative=r=>t.check(Cp(0,r)),t.negative=r=>t.check(p_(0,r)),t.nonpositive=r=>t.check(Ep(0,r)),t.multipleOf=(r,o)=>t.check(x_(r,o)),t.step=(r,o)=>t.check(x_(r,o)),t.finite=()=>t;const a=t._zod.bag;t.minValue=Math.max(a.minimum??Number.NEGATIVE_INFINITY,a.exclusiveMinimum??Number.NEGATIVE_INFINITY)??null,t.maxValue=Math.min(a.maximum??Number.POSITIVE_INFINITY,a.exclusiveMaximum??Number.POSITIVE_INFINITY)??null,t.isInt=(a.format??"").includes("int")||Number.isSafeInteger(a.multipleOf??.5),t.isFinite=!0,t.format=a.format??null});function cn(t){return lL(xS,t)}const mU=Se("ZodNumberFormat",(t,s)=>{fI.init(t,s),xS.init(t,s)});function b_(t){return cL(mU,t)}const hU=Se("ZodBoolean",(t,s)=>{pI.init(t,s),ss.init(t,s)});function fU(t){return dL(hU,t)}const pU=Se("ZodUnknown",(t,s)=>{gI.init(t,s),ss.init(t,s)});function v_(){return uL(pU)}const gU=Se("ZodNever",(t,s)=>{xI.init(t,s),ss.init(t,s)});function xU(t){return mL(gU,t)}const yU=Se("ZodArray",(t,s)=>{yI.init(t,s),ss.init(t,s),t.element=s.element,t.min=(a,r)=>t.check(lm(a,r)),t.nonempty=a=>t.check(lm(1,a)),t.max=(a,r)=>t.check(fS(a,r)),t.length=(a,r)=>t.check(pS(a,r)),t.unwrap=()=>t.element});function bU(t,s){return _L(yU,t,s)}const vU=Se("ZodObject",(t,s)=>{vI.init(t,s),ss.init(t,s),Et(t,"shape",()=>s.shape),t.keyof=()=>Nr(Object.keys(t._zod.def.shape)),t.catchall=a=>t.clone({...t._zod.def,catchall:a}),t.passthrough=()=>t.clone({...t._zod.def,catchall:v_()}),t.loose=()=>t.clone({...t._zod.def,catchall:v_()}),t.strict=()=>t.clone({...t._zod.def,catchall:xU()}),t.strip=()=>t.clone({...t._zod.def,catchall:void 0}),t.extend=a=>L7(t,a),t.safeExtend=a=>U7(t,a),t.merge=a=>B7(t,a),t.pick=a=>$7(t,a),t.omit=a=>I7(t,a),t.partial=(...a)=>V7(yS,t,a[0]),t.required=(...a)=>q7(bS,t,a[0])});function Zc(t,s){const a={type:"object",get shape(){return gn(this,"shape",t?R7(t):{}),this.shape},...qe(s)};return new vU(a)}const wU=Se("ZodUnion",(t,s)=>{wI.init(t,s),ss.init(t,s),t.options=s.options});function jU(t,s){return new wU({type:"union",options:t,...qe(s)})}const _U=Se("ZodIntersection",(t,s)=>{jI.init(t,s),ss.init(t,s)});function NU(t,s){return new _U({type:"intersection",left:t,right:s})}const E0=Se("ZodEnum",(t,s)=>{_I.init(t,s),ss.init(t,s),t.enum=s.entries,t.options=Object.values(s.entries);const a=new Set(Object.keys(s.entries));t.extract=(r,o)=>{const l={};for(const c of r)if(a.has(c))l[c]=s.entries[c];else throw new Error(`Key ${c} not found in enum`);return new E0({...s,checks:[],...qe(o),entries:l})},t.exclude=(r,o)=>{const l={...s.entries};for(const c of r)if(a.has(c))delete l[c];else throw new Error(`Key ${c} not found in enum`);return new E0({...s,checks:[],...qe(o),entries:l})}});function Nr(t,s){const a=Array.isArray(t)?Object.fromEntries(t.map(r=>[r,r])):t;return new E0({type:"enum",entries:a,...qe(s)})}const SU=Se("ZodTransform",(t,s)=>{NI.init(t,s),ss.init(t,s),t._zod.parse=(a,r)=>{if(r.direction==="backward")throw new K2(t.constructor.name);a.addIssue=l=>{if(typeof l=="string")a.issues.push(Pc(l,a.value,s));else{const c=l;c.fatal&&(c.continue=!1),c.code??(c.code="custom"),c.input??(c.input=a.value),c.inst??(c.inst=t),a.issues.push(Pc(c))}};const o=s.transform(a.value,a);return o instanceof Promise?o.then(l=>(a.value=l,a)):(a.value=o,a)}});function EU(t){return new SU({type:"transform",transform:t})}const yS=Se("ZodOptional",(t,s)=>{SI.init(t,s),ss.init(t,s),t.unwrap=()=>t._zod.def.innerType});function w_(t){return new yS({type:"optional",innerType:t})}const CU=Se("ZodNullable",(t,s)=>{EI.init(t,s),ss.init(t,s),t.unwrap=()=>t._zod.def.innerType});function j_(t){return new CU({type:"nullable",innerType:t})}const TU=Se("ZodDefault",(t,s)=>{CI.init(t,s),ss.init(t,s),t.unwrap=()=>t._zod.def.innerType,t.removeDefault=t.unwrap});function kU(t,s){return new TU({type:"default",innerType:t,get defaultValue(){return typeof s=="function"?s():J2(s)}})}const AU=Se("ZodPrefault",(t,s)=>{TI.init(t,s),ss.init(t,s),t.unwrap=()=>t._zod.def.innerType});function MU(t,s){return new AU({type:"prefault",innerType:t,get defaultValue(){return typeof s=="function"?s():J2(s)}})}const bS=Se("ZodNonOptional",(t,s)=>{kI.init(t,s),ss.init(t,s),t.unwrap=()=>t._zod.def.innerType});function RU(t,s){return new bS({type:"nonoptional",innerType:t,...qe(s)})}const OU=Se("ZodCatch",(t,s)=>{AI.init(t,s),ss.init(t,s),t.unwrap=()=>t._zod.def.innerType,t.removeCatch=t.unwrap});function DU(t,s){return new OU({type:"catch",innerType:t,catchValue:typeof s=="function"?s:()=>s})}const PU=Se("ZodPipe",(t,s)=>{MI.init(t,s),ss.init(t,s),t.in=s.in,t.out=s.out});function __(t,s){return new PU({type:"pipe",in:t,out:s})}const zU=Se("ZodReadonly",(t,s)=>{RI.init(t,s),ss.init(t,s),t.unwrap=()=>t._zod.def.innerType});function $U(t){return new zU({type:"readonly",innerType:t})}const IU=Se("ZodCustom",(t,s)=>{OI.init(t,s),ss.init(t,s)});function LU(t,s={}){return NL(IU,t,s)}function UU(t){return SL(t)}const BU=Zc({amount:cn().positive("O valor deve ser positivo").max(Ct.MAX_SUPPLY_WITHOUT_APPROVAL*10,"Valor muito alto para suprimento").refine(t=>Number.isFinite(t)&&t>0,"Valor inválido"),reason:Zt().min(5,"A justificativa deve ter pelo menos 5 caracteres").max(500,"A justificativa não pode exceder 500 caracteres"),source:Zt().min(3,"A origem deve ter pelo menos 3 caracteres").max(100,"A origem não pode exceder 100 caracteres"),authorized_by:Zt().uuid("ID de autorização inválido").optional(),purpose:Nr(["change_fund","security","expense","transfer","correction","other"]),reference_number:Zt().max(50).optional(),notes:Zt().max(1e3).optional()}).refine(t=>t.amount>Ct.MAX_SUPPLY_WITHOUT_APPROVAL?!!t.authorized_by:!0,{message:`Suprimentos acima de R$ ${Ct.MAX_SUPPLY_WITHOUT_APPROVAL} requerem autorização de supervisor`,path:["authorized_by"]}),VU=Zc({amount:cn().positive("O valor deve ser positivo").max(Ct.AUTO_SANGRIA_THRESHOLD*2,"Valor muito alto para sangria").refine(t=>Number.isFinite(t)&&t>0,"Valor inválido"),reason:Zt().min(5,"A justificativa deve ter pelo menos 5 caracteres").max(500,"A justificativa não pode exceder 500 caracteres"),destination:Zt().min(3,"O destino deve ter pelo menos 3 caracteres").max(100,"O destino não pode exceder 100 caracteres"),authorized_by:Zt().uuid("ID de autorização inválido").optional(),purpose:Nr(["change_fund","security","expense","transfer","correction","other"]),recipient:Zt().max(100).optional(),reference_number:Zt().max(50).optional(),notes:Zt().max(1e3).optional()}).refine(t=>t.amount>Ct.SUPERVISOR_APPROVAL_THRESHOLD?!!t.authorized_by:!0,{message:`Sangrias acima de R$ ${Ct.SUPERVISOR_APPROVAL_THRESHOLD} requerem autorização de supervisor`,path:["authorized_by"]});Zc({cash_session_id:Zt().uuid("ID de sessão inválido"),movement_type:Nr(["supply","withdrawal","transfer"]),amount:cn().positive("O valor deve ser positivo"),reason:Zt().min(5).max(500),authorized_by:Zt().uuid().optional(),authorization_status:Nr(["pending","approved","rejected","not_required"]),recipient:Zt().max(100).optional(),purpose:Nr(["change_fund","security","expense","transfer","correction","other"]),reference_number:Zt().max(50).optional()});Zc({user_id:Zt().uuid("ID de usuário inválido"),role:Zt().min(1,"Função é obrigatória"),max_supply_amount:cn().nonnegative("O limite de suprimento não pode ser negativo").max(1e5,"Limite muito alto"),max_withdrawal_amount:cn().nonnegative("O limite de sangria não pode ser negativo").max(1e5,"Limite muito alto"),requires_supervisor_approval_above:cn().nonnegative("O limite de aprovação não pode ser negativo"),can_authorize_movements:fU()});Zc({start_date:Zt().datetime().optional(),end_date:Zt().datetime().optional(),movement_type:Nr(["supply","withdrawal","transfer"]).optional(),purpose:Nr(["change_fund","security","expense","transfer","correction","other"]).optional(),min_amount:cn().nonnegative().optional(),max_amount:cn().positive().optional(),authorized_by:Zt().uuid().optional(),authorization_status:Nr(["pending","approved","rejected","not_required"]).optional()}).refine(t=>t.start_date&&t.end_date?new Date(t.start_date)<=new Date(t.end_date):!0,{message:"A data inicial deve ser anterior à data final",path:["end_date"]}).refine(t=>t.min_amount!==void 0&&t.max_amount!==void 0?t.min_amount<=t.max_amount:!0,{message:"O valor mínimo deve ser menor ou igual ao valor máximo",path:["max_amount"]});const N_=(t,s,a)=>{if(s==="supply"){if(t>a.max_supply_amount)return{requiresApproval:!0,reason:`Valor excede o limite de suprimento (R$ ${a.max_supply_amount})`}}else if(s==="withdrawal"&&t>a.max_withdrawal_amount)return{requiresApproval:!0,reason:`Valor excede o limite de sangria (R$ ${a.max_withdrawal_amount})`};return{requiresApproval:!1}},qU=(t,s)=>{const a=t-s;return a<0?{isValid:!1,reason:"Saldo insuficiente para realizar a sangria"}:a<Ct.MIN_CASH_BALANCE?{isValid:!1,reason:`A sangria deixaria o caixa abaixo do saldo mínimo recomendado (R$ ${Ct.MIN_CASH_BALANCE})`}:{isValid:!0}},FU=t=>t>=Ct.AUTO_SANGRIA_THRESHOLD?{required:!0,severity:"critical",message:`Caixa com valor muito alto (R$ ${t.toFixed(2)}). Sangria urgente recomendada!`}:t>=Ct.MAX_CASH_IN_REGISTER?{required:!0,severity:"warning",message:`Caixa com valor elevado (R$ ${t.toFixed(2)}). Considere realizar uma sangria.`}:{required:!1,severity:null},HU=t=>BU.safeParse(t),GU=t=>VU.safeParse(t),Rm=()=>{const{user:t}=jt(),{fecharComanda:s,recarregarDados:a}=Y2(),{refreshKitchenOrders:r,refreshBarOrders:o}=Tt(),[l,c]=y.useState({currentSession:null,pendingComandas:[],todaysTransactions:[],todaysSessions:[],todaysSummary:{session_date:new Date().toISOString().split("T")[0],total_sessions:0,total_sales:0,total_transactions:0,total_cash_withdrawals:0,total_treasury_transfers:0,cash_balance:0,by_payment_method:[],by_employee:[],discrepancies:[],avg_ticket:0,peak_hours:[]},loading:!0,error:null}),u=y.useCallback(P=>{c(q=>({...q,...P}))},[]),h=y.useCallback((P,q)=>{console.error(`Erro em ${q}:`,P),u({error:`Erro em ${q}: ${P.message||"Erro desconhecido"}`,loading:!1})},[u]),f=y.useCallback(async()=>{if(!t){console.log("useCashManagement: Usuário não encontrado, pulando carregamento");return}try{console.log("useCashManagement: Iniciando carregamento para usuário:",t),u({loading:!0,error:null});const P=new Date().toISOString().split("T")[0];console.log("useCashManagement: Data atual:",P),console.log("useCashManagement: Buscando sessão para usuário ID:",t.id);const{data:q,error:Q}=await B.from("cash_sessions").select("*").eq("employee_id",t.id).eq("status","open").maybeSingle();if(console.log("useCashManagement: Resultado da busca de sessão:",{currentSessionData:q,sessionError:Q}),Q&&Q.code!=="PGRST116")throw console.error("Erro ao carregar sessão:",Q),Q;const{data:G,error:me}=await B.from("comandas").select("*").eq("status","pending_payment").order("opened_at",{ascending:!1});if(me)throw me;console.log("🔍 Buscando TODAS as transações...");const{data:Ne,error:je}=await B.from("cash_transactions").select("id, transaction_type, payment_method, amount, created_at").order("created_at",{ascending:!1}).limit(10);console.log("📊 Últimas 10 transações no banco:",(Ne==null?void 0:Ne.length)||0),Ne&&Ne.length>0&&console.table(Ne.map(Pe=>({id:Pe.id.slice(-8),tipo:Pe.transaction_type,metodo:Pe.payment_method,valor:Pe.amount,data:new Date(Pe.created_at).toLocaleDateString("pt-BR")}))),console.log("🔍 Buscando transações para o dia:",P);const Re=fu(P);console.log("📅 Range de datas para busca:",Re);let Ie=[],Ve=null;const{data:De,error:Ue}=await B.from("cash_transactions").select(`
          *,
          comandas(id, customer_name, table_id, total),
          profiles!cash_transactions_processed_by_fkey(id, name),
          cash_sessions(id, session_date, employee_id)
        `).gte("created_at",Re.start).lte("created_at",Re.end).order("created_at",{ascending:!1});if(!Ue&&De&&(Ie=De,console.log("📊 Transações encontradas por created_at:",Ie.length)),Ie.length===0){const{data:Pe,error:Ge}=await B.from("cash_transactions").select(`
            *,
            comandas(id, customer_name, table_id, total),
            profiles!cash_transactions_processed_by_fkey(id, name),
            cash_sessions(id, session_date, employee_id)
          `).gte("processed_at",Re.start).lte("processed_at",Re.end).order("processed_at",{ascending:!1});!Ge&&Pe?(Ie=Pe,console.log("📊 Transações encontradas por processed_at:",Ie.length)):Ve=Ge}if(console.log("📊 Transações de hoje encontradas:",(Ie==null?void 0:Ie.length)||0),Ie&&Ie.length>0&&(console.log("📋 Primeira transação de hoje:",Ie[0]),console.log("💰 Métodos de pagamento de hoje:",[...new Set(Ie.map(Pe=>Pe.payment_method))])),Ve)throw console.error("❌ Erro ao buscar transações:",Ve),Ve;const{data:W,error:se}=await B.from("cash_sessions").select("*").eq("session_date",P).order("opened_at",{ascending:!1});if(se)throw se;console.log("Dados da sessão atual:",q),console.log("Usuário atual:",t);const ue=q?{...q,employee:{id:t.id,name:t.name||"Usuário",role:t.role||"employee"},supervisor:void 0}:null;console.log("Sessão processada:",ue);const Ce=(G==null?void 0:G.map(Pe=>({...Pe,items:[],table:void 0,customer:void 0})))||[],ke=(Ie==null?void 0:Ie.map(Pe=>({...Pe,comanda:Pe.comandas||void 0,processed_by_employee:Pe.profiles||{id:t.id,name:t.name||"Usuário"},session:Pe.cash_sessions||void 0})))||[],ye=(W==null?void 0:W.map(Pe=>({...Pe,employee:{id:t.id,name:t.name||"Usuário",role:"employee"}})))||[],Me=await Y(new Date);u({currentSession:ue,pendingComandas:Ce,todaysTransactions:ke,todaysSessions:ye,todaysSummary:Me,loading:!1})}catch(P){h(P,"carregamento inicial")}},[t,u,h]),p=y.useCallback(async P=>{try{const q=P||(t==null?void 0:t.id);if(!q)return 0;const{data:Q,error:G}=await B.from("cash_sessions").select("closing_amount, session_date").eq("employee_id",q).eq("status","closed").order("session_date",{ascending:!1}).order("closed_at",{ascending:!1}).limit(1).maybeSingle();return G&&G.code!=="PGRST116"?(console.error("Erro ao buscar última sessão fechada:",G),0):(Q==null?void 0:Q.closing_amount)||0}catch(q){return console.error("Erro ao obter saldo da última sessão:",q),0}},[t]),g=y.useCallback(async P=>{try{const{data:q,error:Q}=await B.from("cash_sessions").select(`
          *,
          profiles!cash_sessions_employee_id_fkey(id, name, role)
        `).eq("session_date",P).order("opened_at",{ascending:!0});if(Q)throw Q;console.log("🔍 Buscando transações para movimento do dia:",P);const G=fu(P);console.log("📅 Range de datas:",G);const{data:me,error:Ne}=await B.from("cash_transactions").select(`
          *,
          comandas(id, customer_name, table_id, total),
          profiles!cash_transactions_processed_by_fkey(id, name),
          cash_sessions(id, session_date, employee_id)
        `).gte("created_at",G.start).lte("created_at",G.end).order("created_at",{ascending:!0});if(console.log("📊 Transações encontradas para movimento:",(me==null?void 0:me.length)||0),Ne)throw Ne;const je=(q==null?void 0:q.map(ye=>({...ye,employee:ye.profiles||{id:ye.employee_id,name:"Usuário",role:"employee"}})))||[],Re=(me==null?void 0:me.map(ye=>({...ye,comanda:ye.comandas||void 0,processed_by_employee:ye.profiles||{id:ye.processed_by,name:"Usuário"},session:ye.cash_sessions||void 0})))||[],Ie=je.reduce((ye,Me)=>ye+(Me.opening_amount||0),0),Ve=je.reduce((ye,Me)=>ye+(Me.closing_amount||0),0),De=je.reduce((ye,Me)=>ye+(Me.cash_discrepancy||0),0),Ue=Re.filter(ye=>ye.transaction_type==="sale"),W=Ue.reduce((ye,Me)=>ye+Me.amount,0),se=Ue.filter(ye=>ye.payment_method==="dinheiro").reduce((ye,Me)=>ye+Me.amount,0),ue=Ue.filter(ye=>["cartao_debito","cartao_credito"].includes(ye.payment_method)).reduce((ye,Me)=>ye+Me.amount,0),Ce=Ue.filter(ye=>ye.payment_method==="pix").reduce((ye,Me)=>ye+Me.amount,0),ke=Re.filter(ye=>ye.transaction_type==="adjustment").reduce((ye,Me)=>ye+Me.amount,0);return{sessions:je,transactions:Re,summary:{opening_total:Ie,closing_total:Ve,sales_total:W,cash_sales:se,card_sales:ue,pix_sales:Ce,adjustments:ke,discrepancy_total:De,transaction_count:Re.length}}}catch(q){return console.error("Erro ao obter movimento diário:",q),{sessions:[],transactions:[],summary:{opening_total:0,closing_total:0,sales_total:0,cash_sales:0,card_sales:0,pix_sales:0,adjustments:0,discrepancy_total:0,transaction_count:0}}}},[]),v=y.useCallback(async P=>{if(!t)throw new Error("Usuário não autenticado");try{console.log("Iniciando abertura de caixa para usuário:",t.id),u({loading:!0,error:null}),console.log("Buscando empresa_id para o usuário...");const{data:q,error:Q}=await B.from("usuarios_empresa").select("empresa_id").eq("user_id",t.id).single();Q&&(console.error("Erro ao buscar empresa do usuário:",Q),console.log("Usando empresa padrão..."));const G=(q==null?void 0:q.empresa_id)||"1",me={employee_id:t.id,empresa_id:G,opening_amount:P.opening_amount,opening_notes:P.opening_notes,supervisor_approval_id:P.supervisor_approval_id,status:"open"};console.log("Dados da sessão com empresa_id:",me);const{data:Ne,error:je}=await B.from("cash_sessions").insert(me).select("*").single();if(je)throw console.error("Erro ao inserir sessão:",je),je;console.log("Sessão criada com sucesso:",Ne),await f()}catch(q){throw h(q,"abertura de caixa"),q}},[t,u,h,f]),b=y.useCallback(async P=>{if(!l.currentSession)throw new Error("Nenhuma sessão aberta");try{u({loading:!0,error:null});const q=P.closing_amount-l.currentSession.expected_amount,{error:Q}=await B.from("cash_sessions").update({status:"closed",closed_at:new Date().toISOString(),closing_amount:P.closing_amount,cash_discrepancy:q,closing_notes:P.closing_notes}).eq("id",l.currentSession.id);if(Q)throw Q;const G=P.reconciliation.map(Ne=>({cash_session_id:l.currentSession.id,payment_method:Ne.payment_method,expected_amount:Ne.expected_amount,actual_amount:Ne.actual_amount,transaction_count:Ne.transaction_count,reconciled_by:t.id,notes:Ne.notes})),{error:me}=await B.from("payment_reconciliation").insert(G);if(me)throw me;await f()}catch(q){throw h(q,"fechamento de caixa"),q}},[l.currentSession,t,u,h,f]),_=y.useCallback(()=>l.currentSession,[l.currentSession]),w=y.useCallback(async P=>{if(console.log("🏦🏦🏦 NOVA VERSÃO - Processando pagamento de comanda..."),console.log("📊 Sessão atual:",l.currentSession),console.log("💳 Dados do pagamento:",P),!l.currentSession)throw console.error("❌ Nenhuma sessão de caixa aberta!"),new Error("Nenhuma sessão de caixa aberta");try{u({loading:!0,error:null});const q=await vt();if(!q)throw new Error("Não foi possível identificar a empresa do usuário");console.log("📋 Buscando dados da comanda...");const{data:Q,error:G}=await B.from("comandas").select("table_id, total, customer_name").eq("id",P.comanda_id).single();if(G)throw console.error("❌ Erro ao buscar comanda:",G),G;console.log("✅ Comanda encontrada:",Q),console.log("🔒 Fechando comanda...");const{error:me}=await B.from("comandas").update({status:"closed",payment_method:P.payment_method,notes:P.notes,updated_at:new Date().toISOString()}).eq("id",P.comanda_id);if(me)throw console.error("❌ Erro ao fechar comanda:",me),me;if(console.log("✅ Comanda fechada com sucesso"),Q.table_id){console.log("🪑 Liberando mesa:",Q.table_id);const{error:Ie}=await B.from("bar_tables").update({status:"available",current_comanda_id:null,updated_at:new Date().toISOString()}).eq("id",Q.table_id);Ie?console.warn("⚠️ Erro ao liberar mesa:",Ie):console.log("✅ Mesa liberada com sucesso")}console.log("💰 Criando transação de pagamento...");const Ne={cash_session_id:l.currentSession.id,comanda_id:P.comanda_id,transaction_type:"sale",payment_method:P.payment_method,amount:P.amount,processed_by:t.id,reference_number:P.reference_number,customer_name:P.customer_name||Q.customer_name,notes:P.notes,empresa_id:q};console.log("📋 Dados da transação:",Ne);const{data:je,error:Re}=await B.from("cash_transactions").insert(Ne).select().single();if(Re)throw console.error("❌ Erro ao inserir transação:",Re),Re;console.log("✅ Transação criada com sucesso:",je),await pe(P.amount),await f(),await a(),P.notes&&P.notes.includes("balcão")&&(console.log("🔄 Forçando atualização dos monitores após pagamento de balcão..."),setTimeout(async()=>{await Promise.all([r(),o()]),console.log("🚀 Monitores atualizados imediatamente!")},500),setTimeout(async()=>{await Promise.all([r(),o()]),console.log("🎉 Atualização backup dos monitores concluída!")},2e3))}catch(q){throw h(q,"processamento de pagamento"),q}},[l.currentSession,t,s,u,h,f,a]),E=y.useCallback(async P=>{if(!l.currentSession)throw new Error("Nenhuma sessão de caixa aberta");try{u({loading:!0,error:null});const q=await vt();if(!q)throw new Error("Não foi possível identificar a empresa do usuário");const Q={cash_session_id:l.currentSession.id,transaction_type:"refund",payment_method:P.refund_method,amount:-Math.abs(P.amount),processed_by:t.id,notes:`Estorno: ${P.reason}. Transação original: ${P.original_transaction_id}`,empresa_id:q},{error:G}=await B.from("cash_transactions").insert(Q);if(G)throw G;await f()}catch(q){throw h(q,"processamento de estorno"),q}},[l.currentSession,t,u,h,f]),k=y.useCallback(async P=>{if(!l.currentSession)throw new Error("Nenhuma sessão de caixa aberta");try{u({loading:!0,error:null});const q=await vt();if(!q)throw new Error("Não foi possível identificar a empresa do usuário");const Q=P.adjustment_type==="add"?P.amount:-P.amount,G={cash_session_id:l.currentSession.id,transaction_type:"adjustment",payment_method:P.payment_method||"dinheiro",amount:Q,processed_by:t.id,notes:`Ajuste ${P.adjustment_type==="add"?"positivo":"negativo"}: ${P.reason}`,empresa_id:q},{error:me}=await B.from("cash_transactions").insert(G);if(me)throw me;await f()}catch(q){throw h(q,"processamento de ajuste"),q}},[l.currentSession,t,u,h,f]),N=y.useCallback(async P=>{if(!l.currentSession)throw new Error("Nenhuma sessão de caixa aberta");try{u({loading:!0,error:null});const q=await vt();if(!q)throw new Error("Não foi possível identificar a empresa do usuário");const Q={cash_session_id:l.currentSession.id,transaction_type:"adjustment",payment_method:"dinheiro",amount:-Math.abs(P.amount),processed_by:t.id,notes:`[SAÍDA] ${P.purpose}: ${P.reason}. Autorizado por: ${P.authorized_by}${P.recipient?`. Destinatário: ${P.recipient}`:""}`,empresa_id:q},{data:G,error:me}=await B.from("cash_transactions").insert(Q).select("*").single();if(me)throw me;const Ne=l.currentSession.expected_amount-P.amount,{error:je}=await B.from("cash_sessions").update({expected_amount:Ne}).eq("id",l.currentSession.id);if(je)throw je;return await f(),G.id}catch(q){throw h(q,"processamento de saída de dinheiro"),q}},[l.currentSession,t,u,h,f]),C=y.useCallback(async P=>{if(!l.currentSession)throw new Error("Nenhuma sessão de caixa aberta");try{u({loading:!0,error:null});const q=await vt();if(!q)throw new Error("Não foi possível identificar a empresa do usuário");const Q={cash_session_id:l.currentSession.id,transaction_type:"adjustment",payment_method:"dinheiro",amount:-Math.abs(P.amount),processed_by:t.id,notes:`[TRANSFERÊNCIA TESOURARIA] Autorizado por: ${P.authorized_by}${P.treasury_receipt_number?`. Comprovante: ${P.treasury_receipt_number}`:""}${P.notes?`. Obs: ${P.notes}`:""}`,empresa_id:q},{data:G,error:me}=await B.from("cash_transactions").insert(Q).select("*").single();if(me)throw me;const Ne=l.currentSession.expected_amount-P.amount,{error:je}=await B.from("cash_sessions").update({expected_amount:Ne}).eq("id",l.currentSession.id);if(je)throw je;return await f(),G.id}catch(q){throw h(q,"processamento de transferência para tesouraria"),q}},[l.currentSession,t,u,h,f]),S=y.useCallback(async P=>{if(!l.currentSession)throw new Error("Nenhuma sessão de caixa aberta");try{u({loading:!0,error:null});const q=HU(P);if(!q.success)throw new Error(`Dados inválidos: ${q.error.errors.map(se=>se.message).join(", ")}`);const Q=await vt();if(!Q)throw new Error("Não foi possível identificar a empresa do usuário");const G={max_supply_amount:Ct.MAX_SUPPLY_WITHOUT_APPROVAL,max_withdrawal_amount:Ct.MAX_WITHDRAWAL_WITHOUT_APPROVAL},me=N_(P.amount,"supply",G);if(me.requiresApproval&&!P.authorized_by)throw new Error(me.reason||"Autorização de supervisor necessária");const Ne={cash_session_id:l.currentSession.id,movement_type:"supply",amount:P.amount,reason:P.reason,authorized_by:P.authorized_by||t.id,authorization_status:P.authorized_by?"approved":"not_required",purpose:P.purpose,reference_number:P.reference_number,empresa_id:Q},{data:je,error:Re}=await B.from("cash_movements").insert(Ne).select("*").single();if(Re)throw Re;const Ie={cash_session_id:l.currentSession.id,transaction_type:"adjustment",payment_method:"dinheiro",amount:P.amount,processed_by:t.id,notes:`[SUPRIMENTO] ${P.source} - ${P.reason}${P.notes?` | ${P.notes}`:""}`,reference_number:P.reference_number,empresa_id:Q},{data:Ve,error:De}=await B.from("cash_transactions").insert(Ie).select("*").single();if(De)throw De;const Ue=l.currentSession.expected_amount+P.amount,{error:W}=await B.from("cash_sessions").update({expected_amount:Ue}).eq("id",l.currentSession.id);if(W)throw W;return await B.from("cash_audit_enhanced").insert({cash_session_id:l.currentSession.id,action_type:"cash_supply",performed_by:t.id,new_values:{movement_id:je.id,amount:P.amount,source:P.source},reason:P.reason,risk_level:P.amount>Ct.SUPERVISOR_APPROVAL_THRESHOLD?"medium":"low",empresa_id:Q}),await f(),je.id}catch(q){throw h(q,"processamento de suprimento"),q}},[l.currentSession,t,u,h,f]),T=y.useCallback(async P=>{if(!l.currentSession)throw new Error("Nenhuma sessão de caixa aberta");try{u({loading:!0,error:null});const q=GU(P);if(!q.success)throw new Error(`Dados inválidos: ${q.error.errors.map(Ce=>Ce.message).join(", ")}`);const Q=l.currentSession.expected_amount,G=qU(Q,P.amount);if(!G.isValid)throw new Error(G.reason||"Saldo insuficiente");const me={max_supply_amount:Ct.MAX_SUPPLY_WITHOUT_APPROVAL,max_withdrawal_amount:Ct.MAX_WITHDRAWAL_WITHOUT_APPROVAL},Ne=N_(P.amount,"withdrawal",me);if(Ne.requiresApproval&&!P.authorized_by)throw new Error(Ne.reason||"Autorização de supervisor necessária");const je=await vt();if(!je)throw new Error("Não foi possível identificar a empresa do usuário");const Re={cash_session_id:l.currentSession.id,movement_type:"withdrawal",amount:P.amount,reason:P.reason,authorized_by:P.authorized_by||t.id,authorization_status:P.authorized_by?"approved":"not_required",recipient:P.recipient,purpose:P.purpose,reference_number:P.reference_number,empresa_id:je},{data:Ie,error:Ve}=await B.from("cash_movements").insert(Re).select("*").single();if(Ve)throw Ve;const De={cash_session_id:l.currentSession.id,transaction_type:"adjustment",payment_method:"dinheiro",amount:-Math.abs(P.amount),processed_by:t.id,notes:`[SANGRIA] ${P.destination} - ${P.reason}${P.recipient?` | Destinatário: ${P.recipient}`:""}${P.notes?` | ${P.notes}`:""}`,reference_number:P.reference_number,empresa_id:je},{data:Ue,error:W}=await B.from("cash_transactions").insert(De).select("*").single();if(W)throw W;const se=l.currentSession.expected_amount-P.amount,{error:ue}=await B.from("cash_sessions").update({expected_amount:se}).eq("id",l.currentSession.id);if(ue)throw ue;return await B.from("cash_audit_enhanced").insert({cash_session_id:l.currentSession.id,action_type:"cash_withdrawal",performed_by:t.id,new_values:{movement_id:Ie.id,amount:P.amount,destination:P.destination},reason:P.reason,risk_level:P.amount>Ct.SUPERVISOR_APPROVAL_THRESHOLD?"high":"medium",empresa_id:je}),await f(),Ie.id}catch(q){throw h(q,"processamento de sangria"),q}},[l.currentSession,t,u,h,f]),M=y.useCallback(async P=>{var q;try{const Q=P||((q=l.currentSession)==null?void 0:q.id);if(!Q)return[];const{data:G,error:me}=await B.from("cash_movements").select(`
          *,
          cash_sessions(id, session_date, employee_id),
          authorized_by_profile:profiles!cash_movements_authorized_by_fkey(id, name, role)
        `).eq("cash_session_id",Q).order("created_at",{ascending:!1});if(me)throw me;return(G==null?void 0:G.map(Ne=>({...Ne,session:Ne.cash_sessions,authorized_by_employee:Ne.authorized_by_profile})))||[]}catch(Q){return console.error("Erro ao buscar movimentações:",Q),[]}},[l.currentSession]),$=y.useCallback(async()=>{if(!l.currentSession)return[];const P=[],q=l.currentSession.expected_amount,Q=FU(q);return Q.required&&P.push({id:`alert-${Date.now()}`,alert_type:"high_cash_amount",severity:Q.severity==="critical"?"critical":"high",message:Q.message||"Sangria recomendada",cash_session_id:l.currentSession.id,threshold_value:Q.severity==="critical"?Ct.AUTO_SANGRIA_THRESHOLD:Ct.MAX_CASH_IN_REGISTER,current_value:q,created_at:new Date().toISOString(),acknowledged:!1}),q<Ct.MIN_CASH_BALANCE&&P.push({id:`alert-low-${Date.now()}`,alert_type:"high_cash_amount",severity:"medium",message:`Saldo baixo no caixa (R$ ${q.toFixed(2)}). Considere um suprimento.`,cash_session_id:l.currentSession.id,threshold_value:Ct.MIN_CASH_BALANCE,current_value:q,created_at:new Date().toISOString(),acknowledged:!1}),P},[l.currentSession]),A=y.useCallback(async P=>{var q,Q;try{const{data:G,error:me}=await B.from("cash_movements").select(`
          *,
          cash_sessions(session_date, opening_amount, expected_amount),
          authorized_by_profile:profiles!cash_movements_authorized_by_fkey(name),
          created_by_profile:profiles(name)
        `).eq("id",P).single();if(me)throw me;if(!G)return null;const Ne=`MOV-${G.created_at.split("T")[0].replace(/-/g,"")}-${P.slice(-6).toUpperCase()}`;return{movement_id:G.id,receipt_number:Ne,movement_type:G.movement_type,amount:G.amount,date:new Date(G.created_at).toLocaleDateString("pt-BR"),time:new Date(G.created_at).toLocaleTimeString("pt-BR"),employee_name:((q=G.created_by_profile)==null?void 0:q.name)||"Desconhecido",authorized_by_name:(Q=G.authorized_by_profile)==null?void 0:Q.name,reason:G.reason,purpose:G.purpose,session_info:{session_date:G.cash_sessions.session_date,opening_amount:G.cash_sessions.opening_amount,current_balance:G.cash_sessions.expected_amount},signature_required:G.amount>Ct.SUPERVISOR_APPROVAL_THRESHOLD}}catch(G){return console.error("Erro ao gerar comprovante:",G),null}},[]),z=y.useCallback(async(P,q)=>{try{const{data:Q,error:G}=await B.from("cash_movements").select(`
          *,
          cash_sessions(employee_id),
          profiles(name)
        `).gte("created_at",P).lte("created_at",q);if(G)throw G;const me=(Q==null?void 0:Q.filter(De=>De.movement_type==="supply"))||[],Ne=(Q==null?void 0:Q.filter(De=>De.movement_type==="withdrawal"))||[],je=me.reduce((De,Ue)=>De+Ue.amount,0),Re=Ne.reduce((De,Ue)=>De+Ue.amount,0),Ie=(Q==null?void 0:Q.reduce((De,Ue)=>{const W=De.find(se=>se.purpose===Ue.purpose);return W?(W.total_amount+=Ue.amount,W.count+=1):De.push({purpose:Ue.purpose,total_amount:Ue.amount,count:1}),De},[]))||[],Ve=(Q==null?void 0:Q.reduce((De,Ue)=>{var ue,Ce;const W=(ue=Ue.cash_sessions)==null?void 0:ue.employee_id,se=De.find(ke=>ke.employee_id===W);return se?(se.total_movements+=1,se.total_amount+=Math.abs(Ue.amount)):De.push({employee_id:W,employee_name:((Ce=Ue.profiles)==null?void 0:Ce.name)||"Desconhecido",total_movements:1,total_amount:Math.abs(Ue.amount)}),De},[]))||[];return{period:{start:P,end:q},total_supplies:je,total_withdrawals:Re,net_movement:je-Re,movement_count:(Q==null?void 0:Q.length)||0,by_purpose:Ie,by_employee:Ve,alerts_generated:0,pending_authorizations:(Q==null?void 0:Q.filter(De=>De.authorization_status==="pending").length)||0}}catch(Q){throw console.error("Erro ao gerar resumo de movimentações:",Q),Q}},[]),R=y.useCallback(async P=>{try{const{data:q,error:Q}=await B.from("cash_transactions").select("*").eq("cash_session_id",P).in("transaction_type",["sale","refund","adjustment"]);if(Q)throw Q;const G={dinheiro:{payment_method:"dinheiro",expected_amount:0,actual_amount:0,transaction_count:0,discrepancy:0,discrepancy_percentage:0,transactions:[]},cartao_debito:{payment_method:"cartao_debito",expected_amount:0,actual_amount:0,transaction_count:0,discrepancy:0,discrepancy_percentage:0,transactions:[]},cartao_credito:{payment_method:"cartao_credito",expected_amount:0,actual_amount:0,transaction_count:0,discrepancy:0,discrepancy_percentage:0,transactions:[]},pix:{payment_method:"pix",expected_amount:0,actual_amount:0,transaction_count:0,discrepancy:0,discrepancy_percentage:0,transactions:[]},transferencia:{payment_method:"transferencia",expected_amount:0,actual_amount:0,transaction_count:0,discrepancy:0,discrepancy_percentage:0,transactions:[]}};return q==null||q.forEach(me=>{const Ne=me.payment_method;G[Ne]&&(G[Ne].expected_amount+=me.amount,G[Ne].transaction_count+=1,G[Ne].transactions.push(me))}),Object.values(G)}catch(q){return console.error("Erro ao calcular breakdown de pagamentos:",q),[]}},[]),L=y.useCallback(async(P,q)=>{try{const Q=l.todaysSessions.find(Ie=>Ie.id===P)||l.currentSession;if(!Q)return{valid:!1,discrepancy:0,requires_approval:!1,expected_amount:0,closing_amount:q,warnings:[],errors:["Sessão não encontrada"]};if(Q.status!=="open")return{valid:!1,discrepancy:0,requires_approval:!1,expected_amount:Q.expected_amount,closing_amount:q,warnings:[],errors:["Sessão já está fechada"]};const G=q-Q.expected_amount,me=Q.expected_amount>0?Math.abs(G/Q.expected_amount*100):0,Ne=Math.abs(G)>Ct.MAX_DISCREPANCY_WITHOUT_APPROVAL,je=[],Re=[];return Math.abs(G)>Ct.MAX_DISCREPANCY_AUTO_ACCEPT&&je.push(`Discrepância de ${$e(Math.abs(G))} detectada`),me>Ct.MAX_DISCREPANCY_PERCENTAGE&&je.push(`Discrepância de ${me.toFixed(2)}% excede o limite de ${Ct.MAX_DISCREPANCY_PERCENTAGE}%`),Ne&&je.push("Aprovação de supervisor necessária"),{valid:Re.length===0,discrepancy:G,requires_approval:Ne,expected_amount:Q.expected_amount,closing_amount:q,warnings:je,errors:Re}}catch(Q){return console.error("Erro ao validar fechamento:",Q),{valid:!1,discrepancy:0,requires_approval:!1,expected_amount:0,closing_amount:q,warnings:[],errors:["Erro ao validar fechamento"]}}},[l.currentSession,l.todaysSessions]),I=y.useCallback(async(P,q)=>{try{const Q=await vt();if(!Q)throw new Error("Não foi possível identificar a empresa do usuário");const{data:G,error:me}=await B.from("treasury_transfers").insert({cash_session_id:P,amount:q.amount,transferred_at:q.transferred_at||new Date().toISOString(),authorized_by:q.authorized_by,recipient_name:q.recipient_name,destination:q.destination,receipt_number:q.receipt_number,notes:q.notes,empresa_id:Q}).select("id").single();if(me)throw me;return await B.from("cash_audit_enhanced").insert({cash_session_id:P,action_type:"treasury_transfer",performed_by:t.id,new_values:q,reason:`Transferência para ${q.destination}`,risk_level:q.amount>1e3?"medium":"low",empresa_id:Q}),G.id}catch(Q){throw console.error("Erro ao registrar transferência:",Q),Q}},[t]),X=y.useCallback(async(P,q)=>{try{const Q=await vt();if(!Q)throw new Error("Não foi possível identificar a empresa do usuário");const{data:G,error:me}=await B.from("discrepancy_handling").insert({cash_session_id:P,discrepancy_amount:q.discrepancy_amount,reason:q.reason,action_taken:q.action_taken,approved_by:q.approved_by,resolution_notes:q.resolution_notes,resolved_at:q.action_taken!=="pending"?new Date().toISOString():null,empresa_id:Q}).select("id").single();if(me)throw me;return await B.from("cash_audit_enhanced").insert({cash_session_id:P,action_type:"discrepancy_handling",performed_by:t.id,new_values:q,reason:q.reason,risk_level:Math.abs(q.discrepancy_amount)>50?"high":"medium",empresa_id:Q}),G.id}catch(Q){throw console.error("Erro ao registrar discrepância:",Q),Q}},[t]),ce=y.useCallback(async P=>{var q,Q;try{const G=await vt();if(!G)throw new Error("Não foi possível identificar a empresa do usuário");const{data:me,error:Ne}=await B.from("cash_sessions").select(`
          *,
          employee:profiles!cash_sessions_employee_id_fkey(id, name),
          supervisor:profiles!cash_sessions_supervisor_approval_id_fkey(id, name)
        `).eq("id",P).single();if(Ne)throw Ne;const je=await R(P),{data:Re}=await B.from("payment_reconciliation").select("*").eq("cash_session_id",P),Ie=je.map(ue=>{const Ce=Re==null?void 0:Re.find(ke=>ke.payment_method===ue.payment_method);return{...ue,actual_amount:(Ce==null?void 0:Ce.actual_amount)||0,discrepancy:((Ce==null?void 0:Ce.actual_amount)||0)-ue.expected_amount,discrepancy_percentage:ue.expected_amount>0?(((Ce==null?void 0:Ce.actual_amount)||0)-ue.expected_amount)/ue.expected_amount*100:0}}),{data:Ve}=await B.from("treasury_transfers").select("*").eq("cash_session_id",P).maybeSingle(),{data:De}=await B.from("discrepancy_handling").select(`
          *,
          approved_by_profile:profiles!discrepancy_handling_approved_by_fkey(name)
        `).eq("cash_session_id",P).maybeSingle(),{data:Ue}=await B.rpc("generate_closing_receipt_number"),W=Ue||`FECH-${Date.now()}`,se={id:P,session_id:P,receipt_number:W,closing_date:new Date(me.closed_at).toLocaleDateString("pt-BR"),closing_time:new Date(me.closed_at).toLocaleTimeString("pt-BR"),employee_name:((q=me.employee)==null?void 0:q.name)||"Desconhecido",employee_id:me.employee_id,opening_amount:me.opening_amount,closing_amount:me.closing_amount,expected_amount:me.expected_amount,total_sales:Ie.reduce((ue,Ce)=>ue+Ce.expected_amount,0),cash_discrepancy:me.cash_discrepancy||0,payment_breakdown:Ie,treasury_transfer:Ve?{amount:Ve.amount,destination:Ve.destination,receipt_number:Ve.receipt_number,recipient_name:Ve.recipient_name}:void 0,discrepancy_handling:De?{reason:De.reason,action_taken:De.action_taken,approved_by_name:(Q=De.approved_by_profile)==null?void 0:Q.name}:void 0,supervisor_approval:me.supervisor?{name:me.supervisor.name,approved_at:me.closed_at}:void 0,generated_at:new Date().toISOString()};return await B.from("cash_closing_receipts").insert({cash_session_id:P,receipt_number:W,receipt_data:se,generated_by:t.id,empresa_id:G}),se}catch(G){throw console.error("Erro ao gerar comprovante:",G),G}},[t,R]),J=y.useCallback(async(P,q)=>{try{console.log("📊 Registrando movimentação diária...");const Q={};q.reconciliation.forEach(je=>{Q[je.payment_method]={expected:je.expected_amount,actual:je.actual_amount,count:je.transaction_count}});const G=q.treasury_transfer?[{amount:q.treasury_transfer.amount,payment_method:"dinheiro",destination:q.treasury_transfer.destination,received_by_name:q.treasury_transfer.recipient_name,receipt_number:q.treasury_transfer.receipt_number,notes:q.treasury_transfer.notes}]:null,{data:me,error:Ne}=await B.rpc("register_cash_closing",{p_session_id:P,p_employee_id:t.id,p_payment_breakdown:Q,p_total_expected:q.reconciliation.reduce((je,Re)=>je+Re.expected_amount,0),p_total_actual:q.reconciliation.reduce((je,Re)=>je+Re.actual_amount,0),p_transfers:G,p_notes:q.closing_notes});if(Ne)throw console.error("❌ Erro ao registrar movimentação diária:",Ne),Ne;console.log("✅ Movimentação diária registrada com sucesso:",me)}catch(Q){throw console.error("Erro ao registrar movimentação diária:",Q),Q}},[t]),V=y.useCallback(async P=>{var q,Q,G;if(!l.currentSession)throw new Error("Nenhuma sessão aberta");try{u({loading:!0,error:null});const me=await L(l.currentSession.id,P.closing_amount);if(!me.valid)throw new Error(`Validação falhou: ${me.errors.join(", ")}`);if(me.requires_approval&&!((q=P.discrepancy_handling)!=null&&q.approved_by))throw new Error("Discrepância requer aprovação de supervisor");const Ne=await vt();if(!Ne)throw new Error("Não foi possível identificar a empresa do usuário");const{error:je}=await B.from("cash_sessions").update({status:"closed",closed_at:new Date().toISOString(),closing_amount:P.closing_amount,cash_discrepancy:me.discrepancy,closing_notes:P.closing_notes,supervisor_approval_id:(Q=P.discrepancy_handling)==null?void 0:Q.approved_by}).eq("id",l.currentSession.id);if(je)throw je;const Re=P.reconciliation.map(De=>({cash_session_id:l.currentSession.id,payment_method:De.payment_method,expected_amount:De.expected_amount,actual_amount:De.actual_amount,transaction_count:De.transaction_count,reconciled_by:t.id,notes:De.notes})),{error:Ie}=await B.from("payment_reconciliation").insert(Re);if(Ie)throw Ie;if(P.treasury_transfer)try{await I(l.currentSession.id,P.treasury_transfer)}catch(De){console.warn("⚠️ Erro ao registrar transferência (tabela pode não existir):",De)}try{await J(l.currentSession.id,P)}catch(De){console.warn("⚠️ Erro ao registrar movimentação diária:",De)}if(P.discrepancy_handling&&Math.abs(me.discrepancy)>.01)try{await X(l.currentSession.id,{...P.discrepancy_handling,discrepancy_amount:me.discrepancy})}catch(De){console.warn("⚠️ Erro ao registrar discrepância (tabela pode não existir):",De)}let Ve;try{Ve=await ce(l.currentSession.id)}catch(De){console.warn("⚠️ Erro ao gerar comprovante (tabela pode não existir):",De),Ve={id:l.currentSession.id,receipt_number:`FECH-${new Date().toISOString().split("T")[0]}-TEMP`,session_id:l.currentSession.id,closing_date:new Date().toISOString().split("T")[0],closing_time:new Date().toLocaleTimeString("pt-BR"),employee_name:((G=session==null?void 0:session.employee)==null?void 0:G.name)||"Desconhecido",opening_amount:(session==null?void 0:session.opening_amount)||0,closing_amount:P.closing_amount,total_sales:me.expected_amount,cash_discrepancy:me.discrepancy,payment_breakdown:[],generated_at:new Date().toISOString()}}return await B.from("cash_audit_enhanced").insert({cash_session_id:l.currentSession.id,action_type:"close_session",performed_by:t.id,new_values:{closing_amount:P.closing_amount,discrepancy:me.discrepancy,treasury_transfer:P.treasury_transfer,discrepancy_handling:P.discrepancy_handling},reason:P.closing_notes||"Fechamento de caixa",risk_level:me.requires_approval?"high":"low",empresa_id:Ne}),await f(),Ve}catch(me){throw h(me,"fechamento aprimorado de caixa"),me}},[l.currentSession,t,u,h,f,L,I,X,ce]),Y=y.useCallback(async P=>{const Q=(P||new Date).toISOString().split("T")[0];try{console.log("🔍 Gerando resumo para o dia:",Q);let G=[];const me=fu(Q);console.log("📅 Range de datas para resumo:",me);const{data:Ne,error:je}=await B.from("cash_transactions").select(`
          *,
          comandas(id, customer_name, table_id, total),
          profiles!cash_transactions_processed_by_fkey(id, name),
          cash_sessions(id, session_date, employee_id)
        `).gte("created_at",me.start).lte("created_at",me.end);if(!je&&Ne&&(G=Ne,console.log("📊 Resumo: transações por created_at:",G.length)),G.length===0){const{data:Te,error:he}=await B.from("cash_transactions").select(`
            *,
            comandas(id, customer_name, table_id, total),
            profiles!cash_transactions_processed_by_fkey(id, name),
            cash_sessions(id, session_date, employee_id)
          `).gte("processed_at",me.start).lte("processed_at",me.end);!he&&Te&&(G=Te,console.log("📊 Resumo: transações por processed_at:",G.length))}const Re=null;console.log("📊 TODAS as transações encontradas:",(G==null?void 0:G.length)||0);const Ie=(G==null?void 0:G.filter(Te=>Te.transaction_type==="sale"))||[];console.log("💰 Transações de venda:",Ie.length),G&&G.length>0&&(console.log("📋 Tipos de transação encontrados:",[...new Set(G.map(Te=>Te.transaction_type))]),console.log("💳 Métodos de pagamento encontrados:",[...new Set(G.map(Te=>Te.payment_method))]),console.log("🔍 Primeira transação:",G[0]));const{data:Ve,error:De}=await B.from("cash_sessions").select(`
          *,
          profiles!cash_sessions_employee_id_fkey(id, name, role)
        `).eq("session_date",Q);if(De)throw console.error("Erro ao buscar sessões para resumo:",De),De;const Ue=Ie||[],W=Ve||[];console.log("🧮 Iniciando cálculo de totais..."),console.log("📊 Transações para calcular:",Ue.length);const se={};Ue.forEach((Te,he)=>{const le=Te.payment_method||"desconhecido",Oe=Number(Te.amount)||0;console.log(`💳 [${he+1}] ${le}: R$ ${Oe}`),se[le]||(se[le]={amount:0,count:0}),se[le].amount+=Oe,se[le].count+=1}),console.log("📊 Totais finais por método:",se);const ue=Ue.reduce((Te,he)=>Te+he.amount,0),Ce=Ue.length;console.log("🏗️ Criando array de métodos de pagamento...");const ye=["dinheiro","cartao_debito","cartao_credito","pix","transferencia"].map(Te=>{const he=se[Te]||{amount:0,count:0},le=ue>0?he.amount/ue*100:0;return console.log(`📋 ${Te}: R$ ${he.amount} (${he.count} transações) - ${le.toFixed(1)}%`),{payment_method:Te,amount:he.amount,transaction_count:he.count,percentage:le,expected_amount:he.amount,actual_amount:he.amount,discrepancy:0}});console.log("✅ Array de métodos criado:",ye);const Me=Ue.reduce((Te,he)=>{var tt;const le=he.processed_by,Oe=((tt=he.profiles)==null?void 0:tt.name)||"Funcionário";return Te[le]||(Te[le]={employee_id:le,employee_name:Oe,session_count:0,total_sales:0,transaction_count:0,avg_ticket:0,cash_discrepancy:0,session_duration:"8:00"}),Te[le].total_sales+=he.amount,Te[le].transaction_count+=1,Te},{});Object.values(Me).forEach(Te=>{Te.avg_ticket=Te.transaction_count>0?Te.total_sales/Te.transaction_count:0});const Pe=fu(Q),{data:Ge}=await B.from("cash_transactions").select("amount, notes, transaction_type").gte("created_at",Pe.start).lte("created_at",Pe.end).in("transaction_type",["adjustment","refund"]),Qe=(Ge||[]).filter(Te=>{var he;return(he=Te.notes)==null?void 0:he.includes("[SAÍDA]")}).reduce((Te,he)=>Te+Math.abs(he.amount),0),xe=(Ge||[]).filter(Te=>{var he;return(he=Te.notes)==null?void 0:he.includes("[TRANSFERÊNCIA TESOURARIA]")}).reduce((Te,he)=>Te+Math.abs(he.amount),0);return{session_date:Q,total_sessions:W.length,total_sales:ue,total_transactions:Ce,total_cash_withdrawals:Qe,total_treasury_transfers:xe,cash_balance:ue-Qe-xe,by_payment_method:ye,by_employee:Object.values(Me),discrepancies:W.filter(Te=>Math.abs(Te.cash_discrepancy||0)>0).map(Te=>{var he;return{employee_id:Te.employee_id,employee_name:((he=Te.profiles)==null?void 0:he.name)||"Funcionário",session_id:Te.id,cash_discrepancy:Te.cash_discrepancy||0,payment_discrepancies:[],total_discrepancy:Te.cash_discrepancy||0}}),avg_ticket:Ce>0?ue/Ce:0,peak_hours:[]}}catch(G){throw console.error("Erro ao gerar resumo diário:",G),G}},[]),ee=y.useCallback(async P=>Y(P),[Y]),we=y.useCallback(async P=>{throw new Error("Relatório mensal ainda não implementado")},[]),D=y.useCallback(async(P,q)=>{throw new Error("Relatório de performance ainda não implementado")},[]),H=y.useCallback(async P=>{if(!l.currentSession)return{isValid:!1,warnings:[],errors:[{type:"invalid_state",message:"Nenhuma sessão ativa"}],suggestions:["Abra uma sessão de caixa primeiro"]};const q=P-l.currentSession.expected_amount,Q=Math.abs(q/l.currentSession.expected_amount)*100,G=[],me=[],Ne=[];return Math.abs(q)>10&&(G.push({type:"discrepancy",message:`Discrepância alta: R$ ${q.toFixed(2)}`,severity:"high",data:{discrepancy:q,percentage:Q}}),Ne.push("Recontagem recomendada")),{isValid:Math.abs(q)<=5,warnings:G,errors:me,suggestions:Ne}},[l.currentSession]),F=y.useCallback(async P=>({isValid:!0,warnings:[],errors:[],suggestions:[]}),[]),Z=y.useCallback(async()=>{await f()},[f]),re=y.useCallback(async(P,q)=>{throw new Error("Exportação de relatórios ainda não implementada")},[]),oe=y.useCallback(async P=>{try{let q=B.from("cash_transactions").select(`
          *,
          comandas(id, customer_name, table_id, total),
          profiles!cash_transactions_processed_by_fkey(id, name),
          cash_sessions(id, session_date, employee_id)
        `);P.start_date&&(q=q.gte("processed_at",P.start_date)),P.end_date&&(q=q.lte("processed_at",P.end_date)),P.payment_method&&(q=q.eq("payment_method",P.payment_method)),P.transaction_type&&(q=q.eq("transaction_type",P.transaction_type)),P.employee_id&&(q=q.eq("processed_by",P.employee_id)),P.session_id&&(q=q.eq("cash_session_id",P.session_id)),P.min_amount&&(q=q.gte("amount",P.min_amount)),P.max_amount&&(q=q.lte("amount",P.max_amount));const{data:Q,error:G}=await q.order("processed_at",{ascending:!1});if(G)throw G;return(Q==null?void 0:Q.map(me=>({...me,comanda:me.comandas||void 0,processed_by_employee:me.profiles||void 0,session:me.cash_sessions||void 0})))||[]}catch(q){throw console.error("Erro na busca de transações:",q),q}},[]),ae=y.useCallback(async P=>{try{let q=B.from("cash_sessions").select(`
          *,
          profiles!cash_sessions_employee_id_fkey(id, name, role)
        `);P.start_date&&(q=q.gte("session_date",P.start_date)),P.end_date&&(q=q.lte("session_date",P.end_date)),P.employee_id&&(q=q.eq("employee_id",P.employee_id)),P.status&&(q=q.eq("status",P.status)),P.has_discrepancy&&(q=q.neq("cash_discrepancy",0));const{data:Q,error:G}=await q.order("session_date",{ascending:!1});if(G)throw G;return(Q==null?void 0:Q.map(me=>({...me,employee:me.profiles||void 0})))||[]}catch(q){throw console.error("Erro na busca de sessões:",q),q}},[]),pe=y.useCallback(async P=>{if(t)try{const q=new Date().toISOString().split("T")[0],{error:Q}=await B.rpc("atualizar_metricas_venda",{p_employee_id:t.id,p_date:q,p_sale_amount:P});Q&&console.warn("Erro ao atualizar métricas:",Q)}catch(q){console.warn("Erro ao atualizar métricas:",q)}},[t]);return y.useEffect(()=>{f()},[f]),y.useEffect(()=>{if(!t)return;const P=[],q=B.channel("cash-sessions-changes").on("postgres_changes",{event:"*",schema:"public",table:"cash_sessions"},me=>{console.log("Mudança em sessões de caixa:",me),f()}).subscribe();P.push(q);const Q=B.channel("cash-transactions-changes").on("postgres_changes",{event:"*",schema:"public",table:"cash_transactions"},me=>{console.log("Mudança em transações:",me),f()}).subscribe();P.push(Q);const G=B.channel("comandas-changes").on("postgres_changes",{event:"*",schema:"public",table:"comandas"},me=>{console.log("Mudança em comandas:",me),f()}).subscribe();return P.push(G),()=>{P.forEach(me=>{B.removeChannel(me)})}},[t,f]),{...l,openCashSession:v,closeCashSession:b,getCurrentSession:_,processComandaPayment:w,processRefund:E,processAdjustment:k,processCashWithdrawal:N,processTreasuryTransfer:C,processCashSupply:S,processCashWithdrawalAdvanced:T,getCashMovements:M,checkCashAlerts:$,generateMovementReceipt:A,getCashMovementSummary:z,calculatePaymentBreakdown:R,validateCashClosing:L,registerTreasuryTransfer:I,registerDiscrepancyHandling:X,generateClosingReceipt:ce,closeCashSessionEnhanced:V,getDailySummary:ee,getMonthlyCashReport:we,getEmployeePerformance:D,validateCashCount:H,validateSession:F,refreshData:Z,exportReport:re,searchTransactions:oe,searchSessions:ae,getLastClosedSessionBalance:p,getDailyCashMovement:g}},ZU=({isOpen:t,onClose:s,onOpenCash:a,getLastClosedSessionBalance:r})=>{const[o,l]=y.useState({opening_amount:0,opening_notes:""}),[c,u]=y.useState(!1),[h,f]=y.useState(null),[p,g]=y.useState(!1);y.useEffect(()=>{(async()=>{if(t&&r){g(!0);try{const w=await r();f(w),w>0&&o.opening_amount===0&&l(E=>({...E,opening_amount:w}))}catch(w){console.error("Erro ao carregar saldo da última sessão:",w)}finally{g(!1)}}})()},[t,r,o.opening_amount]);const v=()=>{h!==null&&l(_=>({..._,opening_amount:h}))},b=async _=>{_.preventDefault(),u(!0);try{await a(o),s(),l({opening_amount:0,opening_notes:""})}catch(w){console.error("Erro ao abrir caixa:",w)}finally{u(!1)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-green-100 p-2 rounded-lg",children:e.jsx(Ut,{className:"h-6 w-6 text-green-600"})}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Abrir Caixa"})]}),e.jsx("button",{onClick:s,disabled:c,className:"text-gray-400 hover:text-gray-600","aria-label":"Fechar modal",children:e.jsx(nt,{className:"h-6 w-6"})})]}),e.jsxs("form",{onSubmit:b,className:"space-y-4",children:[h!==null&&h>0&&e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(Bt,{className:"h-5 w-5 text-blue-600 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-blue-900",children:"Saldo da última sessão fechada"}),e.jsxs("p",{className:"text-lg font-bold text-blue-700",children:["R$ ",h.toFixed(2)]}),e.jsx("button",{type:"button",onClick:v,className:"mt-2 text-sm text-blue-600 hover:text-blue-800 underline",disabled:c,children:"Usar este valor como abertura"})]})]})}),p&&e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4 text-center",children:e.jsxs("div",{className:"inline-flex items-center space-x-2 text-gray-600",children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-gray-600"}),e.jsx("span",{className:"text-sm",children:"Carregando histórico..."})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Valor Inicial (R$) *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:o.opening_amount,onChange:_=>l(w=>({...w,opening_amount:parseFloat(_.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-green-500",required:!0,disabled:c,"aria-label":"Valor inicial em reais"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observações"}),e.jsx("textarea",{value:o.opening_notes||"",onChange:_=>l(w=>({...w,opening_notes:_.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-green-500 focus:border-green-500",placeholder:"Observações sobre a abertura do caixa...",disabled:c})]}),e.jsxs("div",{className:"flex space-x-3 pt-4",children:[e.jsx("button",{type:"button",onClick:s,disabled:c,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:c,className:"flex-1 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 disabled:opacity-50",children:c?"Abrindo...":"Abrir Caixa"})]})]})]})}):null},WU=({isOpen:t,onClose:s,session:a})=>{var we;const{preparingOrders:r,readyOrders:o}=Em(),{closeCashSessionEnhanced:l}=Rm(),{user:c}=jt(),[u,h]=y.useState("reconciliation"),[f,p]=y.useState({closing_amount:a.expected_amount,closing_notes:"",reconciliation:[{payment_method:"dinheiro",expected_amount:0,actual_amount:0,transaction_count:0},{payment_method:"cartao_debito",expected_amount:0,actual_amount:0,transaction_count:0},{payment_method:"cartao_credito",expected_amount:0,actual_amount:0,transaction_count:0},{payment_method:"pix",expected_amount:0,actual_amount:0,transaction_count:0},{payment_method:"transferencia",expected_amount:0,actual_amount:0,transaction_count:0}]}),[g,v]=y.useState(!1),[b,_]=y.useState({amount:0,transferred_at:new Date().toISOString(),authorized_by:(c==null?void 0:c.id)||"",destination:"cofre",notes:""}),[w,E]=y.useState(!1),[k,N]=y.useState([]),[C,S]=y.useState(!1),[T,M]=y.useState(!1);y.useEffect(()=>{t&&a&&($(),A())},[t,a]);const $=async()=>{M(!0);try{console.log("🔍 Carregando breakdown para sessão:",a.id);const{data:D,error:H}=await B.from("cash_transactions").select("*").eq("cash_session_id",a.id);if(H)throw console.error("❌ Erro ao buscar transações:",H),H;console.log("📊 Transações encontradas:",(D==null?void 0:D.length)||0),console.log("📋 Transações:",D),D&&D.length>0&&(console.log("🔍 Tipos de transação:",[...new Set(D.map(Z=>Z.transaction_type))]),console.log("💳 Métodos de pagamento:",[...new Set(D.map(Z=>Z.payment_method))]));const F={dinheiro:{expected_amount:a.opening_amount,transaction_count:0},cartao_debito:{expected_amount:0,transaction_count:0},cartao_credito:{expected_amount:0,transaction_count:0},pix:{expected_amount:0,transaction_count:0},transferencia:{expected_amount:0,transaction_count:0}};D==null||D.forEach(Z=>{if(Z.transaction_type!=="sale"){console.log("⏭️ Ignorando transação não-venda:",Z.transaction_type);return}const re=Z.payment_method,oe=Number(Z.amount)||0;console.log(`💰 Processando: ${re} = R$ ${oe.toFixed(2)}`),F[re]&&(F[re].expected_amount+=oe,F[re].transaction_count+=1)}),console.log("💰 Breakdown calculado:",F),console.log("💵 Dinheiro esperado:",F.dinheiro.expected_amount),console.log("💳 Cartão Débito esperado:",F.cartao_debito.expected_amount),console.log("📱 PIX esperado:",F.pix.expected_amount),p(Z=>({...Z,closing_amount:a.expected_amount,reconciliation:Object.entries(F).map(([re,oe])=>({payment_method:re,expected_amount:oe.expected_amount,actual_amount:0,transaction_count:oe.transaction_count}))}))}catch(D){console.error("❌ Erro ao carregar breakdown de pagamentos:",D)}finally{M(!1)}},A=async()=>{S(!0);try{const{data:D,error:H}=await B.from("comanda_items").select(`
          *,
          comanda:comandas!inner(
            id,
            customer_name,
            table_id,
            employee_id,
            bar_tables(number)
          ),
          menu_item:menu_items(name)
        `).in("status",["pending","preparing","ready"]).eq("comanda.status","open").eq("comanda.employee_id",a.employee_id).order("added_at",{ascending:!0});H?(console.error("Erro ao carregar itens pendentes:",H),N([])):N(D||[])}catch(D){console.error("Erro ao validar pedidos pendentes:",D),N([])}finally{S(!1)}},z=async D=>{D.preventDefault();const H=await R();if(H.length>0){alert(`❌ Não é possível fechar o caixa:

${H.join(`
`)}`);return}const F=f.reconciliation.find(re=>re.payment_method==="dinheiro"),Z=(F==null?void 0:F.actual_amount)||0;if(Z>0&&!g){alert(`❌ Transferência obrigatória!

Existe R$ ${$e(Z)} em dinheiro no caixa.

Você deve transferir o dinheiro para o cofre/tesouraria antes de fechar o caixa.`),h("transfer");return}if(g&&b.amount!==Z){alert(`❌ Valor de transferência incorreto!

Dinheiro no caixa: ${$e(Z)}
Valor a transferir: ${$e(b.amount)}

O valor da transferência deve ser igual ao saldo em dinheiro.`),h("transfer");return}if(g&&Z>0&&!b.recipient_name){alert("❌ Informe o nome do responsável que recebeu o dinheiro."),h("transfer");return}E(!0);try{const re={...f,treasury_transfer:g?b:void 0,discrepancy_handling:I()},oe=await l(re);L(oe,re),alert(`✅ Caixa fechado com sucesso!

Comprovante: ${oe.receipt_number}`),s()}catch(re){console.error("Erro ao fechar caixa:",re),alert(`❌ Erro ao fechar caixa: ${re.message}`)}finally{E(!1)}},R=async()=>{const D=[];try{const{data:H,error:F}=await B.from("comandas").select("id, customer_name, table_id, bar_tables(number)").eq("status","open").eq("employee_id",a.employee_id);if(F)throw F;if(H&&H.length>0&&(D.push(`⚠️ ${H.length} comanda(s) ainda aberta(s):`),H.slice(0,5).forEach(oe=>{const ae=oe.bar_tables?`Mesa ${oe.bar_tables.number}`:"Balcão";D.push(`   • ${ae} - ${oe.customer_name||"Sem nome"}`)}),H.length>5&&D.push(`   ... e mais ${H.length-5} comanda(s)`)),H&&H.length>0){const oe=H.filter(ae=>ae.table_id).map(ae=>ae.table_id);if(oe.length>0){const{data:ae,error:pe}=await B.from("bar_tables").select("id, number").in("id",oe).eq("status","occupied");if(pe)throw pe;ae&&ae.length>0&&(D.push(`⚠️ ${ae.length} mesa(s) com comandas suas ainda ocupada(s):`),ae.slice(0,5).forEach(P=>{D.push(`   • Mesa ${P.number}`)}))}}const{data:Z,error:re}=await B.from("balcao_orders").select("id, order_number, status, employee_id").in("status",["pending","preparing","ready"]).eq("employee_id",a.employee_id);if(re)throw re;Z&&Z.length>0&&(D.push(`⚠️ ${Z.length} pedido(s) de balcão seus pendente(s):`),Z.slice(0,5).forEach(oe=>{D.push(`   • Pedido #${oe.order_number} - ${oe.status}`)})),k.length>0&&D.push(`⚠️ ${k.length} item(ns) de comanda seus não entregue(s)`)}catch(H){console.error("Erro na validação:",H),D.push("❌ Erro ao validar pendências. Tente novamente.")}return D},L=(D,H)=>{var re,oe;const F=window.open("","_blank");if(!F){alert("⚠️ Não foi possível abrir a janela de impressão. Verifique se pop-ups estão bloqueados.");return}const Z=`
      <!DOCTYPE html>
      <html>
      <head>
        <meta charset="UTF-8">
        <title>Comprovante de Fechamento - ${D.receipt_number}</title>
        <style>
          @media print {
            @page { margin: 0; }
            body { margin: 1cm; }
          }
          body {
            font-family: 'Courier New', monospace;
            max-width: 80mm;
            margin: 0 auto;
            padding: 10px;
            font-size: 12px;
          }
          .header {
            text-align: center;
            border-bottom: 2px dashed #000;
            padding-bottom: 10px;
            margin-bottom: 10px;
          }
          .header h1 {
            margin: 0;
            font-size: 18px;
          }
          .header p {
            margin: 5px 0;
            font-size: 11px;
          }
          .section {
            margin: 15px 0;
            border-bottom: 1px dashed #ccc;
            padding-bottom: 10px;
          }
          .section h2 {
            font-size: 14px;
            margin: 0 0 8px 0;
            font-weight: bold;
          }
          .row {
            display: flex;
            justify-content: space-between;
            margin: 3px 0;
          }
          .row.total {
            font-weight: bold;
            font-size: 14px;
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #000;
          }
          .highlight {
            background: #f0f0f0;
            padding: 8px;
            margin: 10px 0;
            border-radius: 4px;
          }
          .footer {
            text-align: center;
            margin-top: 20px;
            font-size: 10px;
            border-top: 2px dashed #000;
            padding-top: 10px;
          }
          .signature {
            margin-top: 30px;
            border-top: 1px solid #000;
            padding-top: 5px;
            text-align: center;
          }
        </style>
      </head>
      <body>
        <div class="header">
          <h1>COMPROVANTE DE FECHAMENTO</h1>
          <p>Nº ${D.receipt_number}</p>
          <p>${new Date().toLocaleString("pt-BR")}</p>
        </div>

        <div class="section">
          <h2>DADOS DA SESSÃO</h2>
          <div class="row">
            <span>Sessão:</span>
            <span>#${a.id.slice(0,8)}</span>
          </div>
          <div class="row">
            <span>Funcionário:</span>
            <span>${((re=a.employee)==null?void 0:re.name)||"N/A"}</span>
          </div>
          <div class="row">
            <span>Abertura:</span>
            <span>${new Date(a.opened_at).toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})}</span>
          </div>
          <div class="row">
            <span>Fechamento:</span>
            <span>${new Date().toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",hour:"2-digit",minute:"2-digit"})}</span>
          </div>
          <div class="row">
            <span>Valor Inicial:</span>
            <span>${$e(a.opening_amount)}</span>
          </div>
        </div>

        <div class="section">
          <h2>RECONCILIAÇÃO POR MÉTODO</h2>
          ${H.reconciliation.map(ae=>`
            <div style="margin-bottom: 10px;">
              <div class="row" style="font-weight: bold;">
                <span>${Oc[ae.payment_method]}</span>
                <span>${ae.transaction_count} transações</span>
              </div>
              <div class="row">
                <span>Esperado:</span>
                <span>${$e(ae.expected_amount)}</span>
              </div>
              <div class="row">
                <span>Contado:</span>
                <span>${$e(ae.actual_amount)}</span>
              </div>
              ${Math.abs(ae.actual_amount-ae.expected_amount)>.01?`
                <div class="row" style="color: ${ae.actual_amount>ae.expected_amount?"green":"red"};">
                  <span>${ae.actual_amount>ae.expected_amount?"Sobra:":"Falta:"}</span>
                  <span>${$e(Math.abs(ae.actual_amount-ae.expected_amount))}</span>
                </div>
              `:""}
            </div>
          `).join("")}
        </div>

        <div class="section">
          <h2>RESUMO FINANCEIRO</h2>
          <div class="row">
            <span>Total Esperado:</span>
            <span>${$e(ce)}</span>
          </div>
          <div class="row">
            <span>Total Contado:</span>
            <span>${$e(J)}</span>
          </div>
          <div class="row total" style="color: ${Math.abs(V)<.01||V>0?"green":"red"};">
            <span>Diferença:</span>
            <span>${Math.abs(V)<.01?"EXATO ✓":$e(V)}</span>
          </div>
        </div>

        ${g&&b.amount>0?`
          <div class="section">
            <h2>TRANSFERÊNCIA PARA TESOURARIA</h2>
            <div class="highlight">
              <div class="row">
                <span>Valor Transferido:</span>
                <span style="font-weight: bold;">${$e(b.amount)}</span>
              </div>
              <div class="row">
                <span>Destino:</span>
                <span>${b.destination==="cofre"?"Cofre":b.destination==="banco"?"Banco":"Tesouraria Central"}</span>
              </div>
              <div class="row">
                <span>Recebido por:</span>
                <span>${b.recipient_name||"N/A"}</span>
              </div>
              ${b.receipt_number?`
                <div class="row">
                  <span>Comprovante:</span>
                  <span>${b.receipt_number}</span>
                </div>
              `:""}
            </div>
          </div>
        `:""}

        ${H.closing_notes?`
          <div class="section">
            <h2>OBSERVAÇÕES</h2>
            <p style="margin: 5px 0; white-space: pre-wrap;">${H.closing_notes}</p>
          </div>
        `:""}

        <div class="signature">
          <p>_________________________________</p>
          <p>Assinatura do Responsável</p>
          <p style="margin-top: 5px; font-size: 10px;">${((oe=a.employee)==null?void 0:oe.name)||""}</p>
        </div>

        <div class="footer">
          <p>Sistema de Gestão - Fechamento de Caixa</p>
          <p>Documento gerado automaticamente</p>
          <p>Guarde este comprovante para auditoria</p>
        </div>

        <script>
          window.onload = function() {
            window.print();
          };
        <\/script>
      </body>
      </html>
    `;F.document.write(Z),F.document.close()},I=()=>{const D=V;if(Math.abs(D)<.01)return;if(Math.abs(D)<5)return{discrepancy_amount:D,reason:f.closing_notes||"Diferença pequena - aceita automaticamente",action_taken:"accepted"};if(Math.abs(D)<=50){if(!f.closing_notes||f.closing_notes.length<5)throw new Error("Para discrepâncias entre R$ 5,00 e R$ 50,00, é necessário informar o motivo (mínimo 5 caracteres)");return{discrepancy_amount:D,reason:f.closing_notes,action_taken:"accepted",resolution_notes:"Discrepância média - justificada pelo operador"}}if(!f.closing_notes||f.closing_notes.length<10)throw new Error("Para discrepâncias acima de R$ 50,00, é necessário informar o motivo detalhadamente (mínimo 10 caracteres)");const H=prompt("Discrepância alta detectada! Informe o ID do supervisor que aprovou:");if(!H)throw new Error("Aprovação de supervisor é obrigatória para discrepâncias acima de R$ 50,00");return{discrepancy_amount:D,reason:f.closing_notes,action_taken:"investigation",approved_by:H,resolution_notes:"Discrepância alta - requer investigação"}},X=(D,H,F)=>{p(Z=>({...Z,reconciliation:Z.reconciliation.map(re=>re.payment_method===D?{...re,[H]:F}:re)}))},ce=f.reconciliation.reduce((D,H)=>D+H.expected_amount,0),J=f.reconciliation.reduce((D,H)=>D+H.actual_amount,0),V=J-ce,ee=r.length+o.length+k.length>0;return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-full max-w-5xl mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-red-100 p-2 rounded-lg",children:e.jsx(Ut,{className:"h-6 w-6 text-red-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Fechar Caixa"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Sessão #",a.id.slice(0,8)]})]})]}),e.jsx("button",{onClick:s,disabled:w,className:"text-gray-400 hover:text-gray-600",children:e.jsx(nt,{className:"h-6 w-6"})})]}),e.jsxs("div",{className:"flex space-x-1 mb-6 border-b border-gray-200",children:[e.jsx("button",{type:"button",onClick:()=>h("reconciliation"),className:`px-4 py-2 font-medium text-sm transition-colors ${u==="reconciliation"?"text-red-600 border-b-2 border-red-600":"text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ut,{className:"h-4 w-4"}),e.jsx("span",{children:"Reconciliação"})]})}),e.jsx("button",{type:"button",onClick:()=>h("transfer"),className:`px-4 py-2 font-medium text-sm transition-colors ${u==="transfer"?"text-red-600 border-b-2 border-red-600":"text-gray-500 hover:text-gray-700"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(no,{className:"h-4 w-4"}),e.jsx("span",{children:"Transferência"})]})}),Math.abs(V)>.01&&e.jsx("button",{type:"button",onClick:()=>h("discrepancy"),className:`px-4 py-2 font-medium text-sm transition-colors ${u==="discrepancy"?"text-red-600 border-b-2 border-red-600":"text-orange-500 hover:text-orange-700"}`,children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(yt,{className:"h-4 w-4"}),e.jsx("span",{children:"Discrepância"})]})})]}),e.jsxs("form",{onSubmit:z,className:"space-y-6",children:[ee&&e.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(yt,{className:"h-6 w-6 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-medium text-yellow-800 mb-2",children:"⚠️ Atenção: Pedidos Pendentes de Entrega"}),e.jsxs("div",{className:"text-sm text-yellow-700 space-y-1",children:[r.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Bt,{className:"h-4 w-4"}),e.jsxs("span",{children:[r.length," pedidos de balcão em preparo"]})]}),o.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(m0,{className:"h-4 w-4"}),e.jsxs("span",{children:[o.length," pedidos de balcão prontos para entrega"]})]}),k.length>0&&e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Bt,{className:"h-4 w-4"}),e.jsxs("span",{children:[k.length," itens de comandas não entregues"]})]})]}),e.jsx("p",{className:"text-xs text-yellow-600 mt-2",children:"Recomenda-se entregar todos os pedidos antes de fechar o caixa."})]})]})}),u==="reconciliation"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-3",children:"Resumo da Sessão"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Valor inicial:"}),e.jsx("span",{className:"font-medium",children:$e(a.opening_amount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Valor esperado total:"}),e.jsx("span",{className:"font-medium",children:$e(ce)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Aberta em:"}),e.jsx("span",{className:"font-medium",children:new Date(a.opened_at).toLocaleString("pt-BR")})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Funcionário:"}),e.jsx("span",{className:"font-medium",children:(we=a.employee)==null?void 0:we.name})]})]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Reconciliação por Método de Pagamento"}),T&&e.jsx("span",{className:"text-sm text-gray-500",children:"Carregando valores..."})]}),e.jsx("div",{className:"space-y-4",children:f.reconciliation.map(D=>{const H=F=>{switch(F){case"dinheiro":return e.jsx(Ut,{className:"h-5 w-5"});case"cartao_debito":case"cartao_credito":return e.jsx(Wi,{className:"h-5 w-5"});case"pix":return e.jsx(fn,{className:"h-5 w-5"});case"transferencia":return e.jsx(wj,{className:"h-5 w-5"});default:return e.jsx(Ut,{className:"h-5 w-5"})}};return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-3",children:[H(D.payment_method),e.jsx("h4",{className:"font-medium text-gray-900",children:Oc[D.payment_method]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Valor Esperado"}),e.jsx("div",{className:"px-3 py-2 bg-gray-50 rounded text-sm font-medium",children:$e(D.expected_amount)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Valor Real *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",value:D.actual_amount,onChange:F=>X(D.payment_method,"actual_amount",parseFloat(F.target.value)||0),className:"w-full px-3 py-2 border border-gray-300 rounded text-sm focus:ring-2 focus:ring-red-500 focus:border-red-500",disabled:w||T})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-500 mb-1",children:"Transações"}),e.jsx("div",{className:"px-3 py-2 bg-gray-50 rounded text-sm font-medium",children:D.transaction_count})]})]}),Math.abs(D.actual_amount-D.expected_amount)>.01&&e.jsxs("div",{className:`mt-2 p-2 rounded text-xs ${D.actual_amount>D.expected_amount?"bg-green-50 text-green-800":"bg-red-50 text-red-800"}`,children:[D.actual_amount>D.expected_amount?"Sobra":"Falta",":",$e(Math.abs(D.actual_amount-D.expected_amount))]})]},D.payment_method)})})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"text-lg font-medium text-blue-900 mb-3",children:"Resumo Final"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total esperado:"}),e.jsx("span",{className:"font-medium",children:$e(ce)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Total contado:"}),e.jsx("span",{className:"font-medium",children:$e(J)})]}),e.jsxs("div",{className:"flex justify-between col-span-2 pt-2 border-t border-blue-200",children:[e.jsx("span",{className:"font-medium",children:"Diferença:"}),e.jsxs("span",{className:`font-bold ${Math.abs(V)<.01||V>0?"text-green-600":"text-red-600"}`,children:[Math.abs(V)<.01?"Exato ✓":$e(V),V>0&&" (Sobra)",V<0&&" (Falta)"]})]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Observações do Fechamento",Math.abs(V)>=5&&e.jsx("span",{className:"text-red-600 ml-1",children:"*"})]}),e.jsx("textarea",{value:f.closing_notes||"",onChange:D=>p(H=>({...H,closing_notes:D.target.value})),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:Math.abs(V)>=50?"Obrigatório: Descreva detalhadamente o motivo da discrepância (mín. 10 caracteres)":Math.abs(V)>=5?"Obrigatório: Informe o motivo da discrepância (mín. 5 caracteres)":"Observações sobre o fechamento...",disabled:w}),Math.abs(V)>=5&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:Math.abs(V)>=50?"⚠️ Discrepância alta - Justificativa detalhada obrigatória":"⚠️ Justificativa obrigatória para discrepâncias acima de R$ 5,00"})]})]}),u==="transfer"&&e.jsxs("div",{className:"space-y-6",children:[(()=>{const D=f.reconciliation.find(F=>F.payment_method==="dinheiro"),H=(D==null?void 0:D.actual_amount)||0;return H>0?e.jsx("div",{className:"bg-red-50 border-l-4 border-red-500 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(yt,{className:"h-6 w-6 text-red-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-bold text-red-800 mb-2",children:"⚠️ TRANSFERÊNCIA OBRIGATÓRIA"}),e.jsxs("p",{className:"text-sm text-red-700 mb-2",children:["Existe ",e.jsx("span",{className:"font-bold",children:$e(H)})," em dinheiro no caixa."]}),e.jsxs("p",{className:"text-sm text-red-700",children:["O fechamento só será permitido após transferir todo o dinheiro para o cofre/tesouraria.",e.jsx("br",{}),e.jsx("strong",{children:"O caixa deve ser fechado com saldo ZERO em dinheiro."})]})]})]})}):e.jsx("div",{className:"bg-green-50 border-l-4 border-green-500 p-4 rounded-lg",children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(ts,{className:"h-6 w-6 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-sm font-bold text-green-800",children:"✓ Sem dinheiro no caixa"}),e.jsx("p",{className:"text-sm text-green-700",children:"Não há valores em dinheiro para transferir."})]})]})})})(),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(wj,{className:"h-6 w-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-blue-900",children:"Transferência para Tesouraria"}),e.jsx("p",{className:"text-sm text-blue-700",children:(()=>{const D=f.reconciliation.find(F=>F.payment_method==="dinheiro");return((D==null?void 0:D.actual_amount)||0)>0?"⚠️ OBRIGATÓRIO: Registre a transferência do dinheiro":"Registre a transferência de valores do caixa (opcional)"})()})]})]}),e.jsxs("label",{className:"flex items-center space-x-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:D=>{const H=f.reconciliation.find(Z=>Z.payment_method==="dinheiro"),F=(H==null?void 0:H.actual_amount)||0;D.target.checked&&F>0&&_(Z=>({...Z,amount:F})),v(D.target.checked)},className:"w-5 h-5 text-red-600 rounded focus:ring-red-500"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Registrar transferência"})]})]}),g&&e.jsxs("div",{className:"space-y-4 mt-4 pt-4 border-t border-blue-200",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Valor a Transferir *"}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:J,value:b.amount,onChange:D=>_(H=>({...H,amount:parseFloat(D.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-red-500",disabled:w}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Saldo disponível: ",$e(J)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Destino *"}),e.jsxs("select",{value:b.destination,onChange:D=>_(H=>({...H,destination:D.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-red-500",disabled:w,children:[e.jsx("option",{value:"cofre",children:"Cofre"}),e.jsx("option",{value:"banco",children:"Banco"}),e.jsx("option",{value:"tesouraria_central",children:"Tesouraria Central"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Responsável pelo Recebimento"}),e.jsx("input",{type:"text",value:b.recipient_name||"",onChange:D=>_(H=>({...H,recipient_name:D.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:"Nome de quem recebeu",disabled:w})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Número do Comprovante"}),e.jsx("input",{type:"text",value:b.receipt_number||"",onChange:D=>_(H=>({...H,receipt_number:D.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:"Ex: COMP-2025-001",disabled:w})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observações"}),e.jsx("textarea",{value:b.notes||"",onChange:D=>_(H=>({...H,notes:D.target.value})),rows:2,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:"Detalhes adicionais sobre a transferência...",disabled:w})]}),b.amount>0&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3",children:e.jsxs("div",{className:"flex items-center space-x-2 text-sm",children:[e.jsx(ts,{className:"h-5 w-5 text-green-600"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium text-green-900",children:["Saldo restante no caixa: ",$e(J-b.amount)]}),e.jsxs("p",{className:"text-green-700 text-xs",children:["Transferindo ",$e(b.amount)," para ",b.destination]})]})]})})]}),!g&&e.jsx("p",{className:"text-sm text-gray-600 text-center py-4",children:"Ative a opção acima para registrar uma transferência para tesouraria"})]})]}),u==="discrepancy"&&Math.abs(V)>.01&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:`border-l-4 rounded-lg p-4 ${Math.abs(V)>=50?"bg-red-50 border-red-500":Math.abs(V)>=5?"bg-orange-50 border-orange-500":"bg-yellow-50 border-yellow-500"}`,children:e.jsxs("div",{className:"flex items-start space-x-3",children:[e.jsx(yt,{className:`h-6 w-6 mt-0.5 ${Math.abs(V)>=50?"text-red-600":Math.abs(V)>=5?"text-orange-600":"text-yellow-600"}`}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:`text-lg font-medium mb-2 ${Math.abs(V)>=50?"text-red-900":Math.abs(V)>=5?"text-orange-900":"text-yellow-900"}`,children:Math.abs(V)>=50?"🚨 Aprovação de Supervisor Necessária":Math.abs(V)>=5?"⚠️ Justificativa Necessária":"✅ Discrepância Aceitável"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Valor da Discrepância:"}),e.jsxs("span",{className:`font-bold ${V>0?"text-green-600":"text-red-600"}`,children:[$e(Math.abs(V))," (",V>0?"Sobra":"Falta",")"]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"font-medium",children:"Nível de Risco:"}),e.jsx("span",{className:`font-bold ${Math.abs(V)>=50?"text-red-600":Math.abs(V)>=5?"text-orange-600":"text-yellow-600"}`,children:Math.abs(V)>=50?"ALTA":Math.abs(V)>=5?"MÉDIA":"BAIXA"})]})]}),e.jsx("p",{className:`text-sm mt-3 ${Math.abs(V)>=50?"text-red-700":Math.abs(V)>=5?"text-orange-700":"text-yellow-700"}`,children:Math.abs(V)>=50?"A discrepância excede R$ 50,00. É necessária a aprovação de um supervisor para prosseguir com o fechamento.":Math.abs(V)>=5?"Por favor, informe o motivo da discrepância. Uma justificativa detalhada é necessária.":"A diferença está dentro do limite aceitável. Você pode aceitar automaticamente ou informar o motivo."})]})]})}),e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Informações Adicionais"}),e.jsx("p",{className:"text-sm text-gray-600",children:'Volte para a aba "Reconciliação" e preencha o campo "Observações do Fechamento" com:'}),e.jsxs("ul",{className:"list-disc list-inside text-sm text-gray-600 mt-2 space-y-1",children:[e.jsx("li",{children:"Motivo da discrepância"}),e.jsx("li",{children:"Ações tomadas para investigar"}),Math.abs(V)>=50&&e.jsx("li",{className:"text-red-600 font-medium",children:"ID do supervisor que aprovou (será solicitado no fechamento)"})]})]})]}),e.jsxs("div",{className:"flex space-x-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:s,disabled:w,className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-md hover:bg-gray-50 disabled:opacity-50 transition-colors",children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:w||C||T,className:`flex-1 px-4 py-2 text-white rounded-md disabled:opacity-50 transition-colors ${Math.abs(V)>=50?"bg-red-600 hover:bg-red-700":ee?"bg-yellow-600 hover:bg-yellow-700":"bg-red-600 hover:bg-red-700"}`,children:w?"Fechando...":C?"Validando...":T?"Carregando...":Math.abs(V)>=50?"Fechar com Aprovação":ee?"Fechar Mesmo Assim":"Fechar Caixa"})]})]})]})}):null},YU=({isOpen:t,onClose:s,onProcessWithdrawal:a,currentCashBalance:r,loading:o=!1})=>{const[l,c]=y.useState({amount:0,reason:"",authorized_by:"",recipient:"",purpose:"other"}),[u,h]=y.useState({}),[f,p]=y.useState(!1),g=(E,k)=>{c(N=>({...N,[E]:k})),u[E]&&h(N=>({...N,[E]:""}))},v=()=>{var k;const E={};return(!l.amount||l.amount<=0)&&(E.amount="Valor deve ser maior que zero"),l.amount>r&&(E.amount="Valor não pode ser maior que o saldo em caixa"),l.reason.trim()||(E.reason="Motivo é obrigatório"),l.authorized_by.trim()||(E.authorized_by="Nome do autorizador é obrigatório"),l.purpose==="transfer"&&!((k=l.recipient)!=null&&k.trim())&&(E.recipient="Destinatário é obrigatório para transferências"),h(E),Object.keys(E).length===0},b=async E=>{if(E.preventDefault(),!!v()){p(!0);try{await a(l),_()}catch(k){console.error("Erro ao processar saída:",k)}finally{p(!1)}}},_=()=>{c({amount:0,reason:"",authorized_by:"",recipient:"",purpose:"other"}),h({}),p(!1),s()},w=[{value:"change",label:"Troco"},{value:"expense",label:"Despesa"},{value:"transfer",label:"Transferência"},{value:"other",label:"Outros"}];return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(be.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-lg shadow-xl w-full max-w-md max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-orange-100 p-2 rounded-full",children:e.jsx(Ii,{className:"h-5 w-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Saída de Dinheiro"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Saldo disponível: ",$e(r)]})]})]}),e.jsx("button",{onClick:_,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:f,title:"Fechar modal","aria-label":"Fechar modal",children:e.jsx(nt,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"p-6 pb-0",children:e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4 flex items-start space-x-3",children:[e.jsx(yt,{className:"h-5 w-5 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-yellow-800",children:"Atenção"}),e.jsx("p",{className:"text-yellow-700 mt-1",children:"Esta operação reduzirá o saldo em caixa e deve ser autorizada por um supervisor."})]})]})}),e.jsxs("form",{onSubmit:b,className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Valor da Saída *"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"R$"}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:r,value:l.amount||"",onChange:E=>g("amount",parseFloat(E.target.value)||0),className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent ${u.amount?"border-red-300":"border-gray-300"}`,placeholder:"0,00",disabled:f})]}),u.amount&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.amount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Finalidade *"}),e.jsx("select",{value:l.purpose,onChange:E=>g("purpose",E.target.value),className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",disabled:f,title:"Selecione a finalidade da saída","aria-label":"Finalidade da saída de dinheiro",children:w.map(E=>e.jsx("option",{value:E.value,children:E.label},E.value))})]}),l.purpose==="transfer"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Destinatário *"}),e.jsx("input",{type:"text",value:l.recipient||"",onChange:E=>g("recipient",E.target.value),className:`w-full px-3 py-3 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent ${u.recipient?"border-red-300":"border-gray-300"}`,placeholder:"Nome do destinatário",disabled:f}),u.recipient&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.recipient})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Motivo/Descrição *"}),e.jsx("textarea",{value:l.reason,onChange:E=>g("reason",E.target.value),rows:3,className:`w-full px-3 py-3 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent resize-none ${u.reason?"border-red-300":"border-gray-300"}`,placeholder:"Descreva o motivo da saída de dinheiro...",disabled:f}),u.reason&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.reason})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autorizado por *"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ks,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",value:l.authorized_by,onChange:E=>g("authorized_by",E.target.value),className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent ${u.authorized_by?"border-red-300":"border-gray-300"}`,placeholder:"Nome do supervisor/gerente",disabled:f})]}),u.authorized_by&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.authorized_by})]})]}),l.amount>0&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-2",children:"Resumo da Operação"}),e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Saldo atual:"}),e.jsx("span",{className:"font-medium",children:$e(r)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Valor da saída:"}),e.jsxs("span",{className:"font-medium text-red-600",children:["-",$e(l.amount)]})]}),e.jsx("div",{className:"border-t pt-1 mt-2",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-900 font-medium",children:"Saldo após saída:"}),e.jsx("span",{className:"font-bold",children:$e(r-l.amount)})]})})]})]}),e.jsxs("div",{className:"flex space-x-3 mt-6 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:_,className:"flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-400 transition-colors font-medium",disabled:f,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"flex-1 bg-orange-600 text-white py-3 rounded-lg hover:bg-orange-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",disabled:f||o||!l.amount||!l.reason.trim()||!l.authorized_by.trim(),children:f?"Processando...":"Processar Saída"})]})]})]})}):null},KU=({isOpen:t,onClose:s,onProcessTransfer:a,currentCashBalance:r,loading:o=!1})=>{const[l,c]=y.useState({amount:r,transfer_date:new Date().toISOString().split("T")[0],authorized_by:"",treasury_receipt_number:"",notes:""}),[u,h]=y.useState({}),[f,p]=y.useState(!1),g=(E,k)=>{c(N=>({...N,[E]:k})),u[E]&&h(N=>({...N,[E]:""}))},v=()=>{const E={};(!l.amount||l.amount<=0)&&(E.amount="Valor deve ser maior que zero"),l.amount>r&&(E.amount="Valor não pode ser maior que o saldo em caixa"),l.transfer_date||(E.transfer_date="Data da transferência é obrigatória"),l.authorized_by.trim()||(E.authorized_by="Nome do autorizador é obrigatório");const k=new Date(l.transfer_date),N=new Date;return N.setHours(23,59,59,999),k>N&&(E.transfer_date="Data não pode ser futura"),h(E),Object.keys(E).length===0},b=async E=>{if(E.preventDefault(),!!v()){p(!0);try{await a(l),_()}catch(k){console.error("Erro ao processar transferência:",k)}finally{p(!1)}}},_=()=>{c({amount:r,transfer_date:new Date().toISOString().split("T")[0],authorized_by:"",treasury_receipt_number:"",notes:""}),h({}),p(!1),s()},w=()=>{g("amount",r)};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs(be.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.95},className:"bg-white rounded-lg shadow-xl w-full max-w-lg max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-purple-100 p-2 rounded-full",children:e.jsx(Tc,{className:"h-5 w-5 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Transferência para Tesouraria"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Saldo disponível: ",$e(r)]})]})]}),e.jsx("button",{onClick:_,className:"text-gray-400 hover:text-gray-600 transition-colors",disabled:f,title:"Fechar modal","aria-label":"Fechar modal",children:e.jsx(nt,{className:"h-5 w-5"})})]}),e.jsx("div",{className:"p-6 pb-0",children:e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 flex items-start space-x-3",children:[e.jsx(pR,{className:"h-5 w-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-blue-800",children:"Transferência para Tesouraria"}),e.jsx("p",{className:"text-blue-700 mt-1",children:"Esta operação transfere o dinheiro em caixa para a tesouraria central. Um comprovante será gerado para assinatura do conferente."})]})]})}),e.jsxs("form",{onSubmit:b,className:"p-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Valor da Transferência *"}),e.jsx("button",{type:"button",onClick:w,className:"text-xs text-purple-600 hover:text-purple-700 underline",disabled:f,children:"Transferir todo o saldo"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-500",children:"R$"}),e.jsx("input",{type:"number",step:"0.01",min:"0",max:r,value:l.amount||"",onChange:E=>g("amount",parseFloat(E.target.value)||0),className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent ${u.amount?"border-red-300":"border-gray-300"}`,placeholder:"0,00",disabled:f})]}),u.amount&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.amount})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Data da Transferência *"}),e.jsxs("div",{className:"relative",children:[e.jsx(Mr,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"date",value:l.transfer_date,onChange:E=>g("transfer_date",E.target.value),max:new Date().toISOString().split("T")[0],className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent ${u.transfer_date?"border-red-300":"border-gray-300"}`,disabled:f,title:"Selecione a data da transferência","aria-label":"Data da transferência"})]}),u.transfer_date&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.transfer_date})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Autorizado por *"}),e.jsxs("div",{className:"relative",children:[e.jsx(Ks,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",value:l.authorized_by,onChange:E=>g("authorized_by",E.target.value),className:`w-full pl-10 pr-4 py-3 border rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent ${u.authorized_by?"border-red-300":"border-gray-300"}`,placeholder:"Nome do supervisor/gerente",disabled:f})]}),u.authorized_by&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:u.authorized_by})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Número do Comprovante da Tesouraria"}),e.jsxs("div",{className:"relative",children:[e.jsx(QN,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",value:l.treasury_receipt_number||"",onChange:E=>g("treasury_receipt_number",E.target.value),className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent",placeholder:"Ex: TSR-2024-001234",disabled:f})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Número de referência do comprovante da tesouraria (opcional)"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Observações"}),e.jsx("textarea",{value:l.notes||"",onChange:E=>g("notes",E.target.value),rows:3,className:"w-full px-3 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-transparent resize-none",placeholder:"Observações adicionais sobre a transferência...",disabled:f})]})]}),l.amount>0&&e.jsxs("div",{className:"mt-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Resumo da Transferência"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Saldo atual em caixa:"}),e.jsx("span",{className:"font-medium",children:$e(r)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Valor a transferir:"}),e.jsx("span",{className:"font-medium text-purple-600",children:$e(l.amount)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Data da transferência:"}),e.jsx("span",{className:"font-medium",children:wt(new Date(l.transfer_date),"dd 'de' MMMM 'de' yyyy",{locale:Wt})})]}),e.jsx("div",{className:"border-t pt-2 mt-2",children:e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-900 font-medium",children:"Saldo restante em caixa:"}),e.jsx("span",{className:"font-bold",children:$e(r-l.amount)})]})})]})]}),l.amount===r&&l.amount>0&&e.jsxs("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg flex items-start space-x-2",children:[e.jsx(yt,{className:"h-4 w-4 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-yellow-800",children:"Transferência Total"}),e.jsx("p",{className:"text-yellow-700",children:"Você está transferindo todo o saldo em caixa. O caixa ficará zerado após esta operação."})]})]}),e.jsxs("div",{className:"flex space-x-3 mt-6 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:_,className:"flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-400 transition-colors font-medium",disabled:f,children:"Cancelar"}),e.jsx("button",{type:"submit",className:"flex-1 bg-purple-600 text-white py-3 rounded-lg hover:bg-purple-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",disabled:f||o||!l.amount||!l.authorized_by.trim(),children:f?"Processando...":"Transferir e Imprimir Comprovante"})]})]})]})}):null},XU=({receiptData:t,onPrint:s})=>{const a=()=>{const r=document.getElementById("treasury-transfer-receipt");if(!r)return;const o=window.open("","_blank");o&&(o.document.write(`
      <html>
        <head>
          <title>Comprovante de Transferência - Tesouraria</title>
          <style>
            body {
              font-family: 'Courier New', monospace;
              font-size: 12px;
              line-height: 1.4;
              margin: 0;
              padding: 20px;
              background: white;
            }
            .receipt {
              max-width: 300px;
              margin: 0 auto;
            }
            .header {
              text-align: center;
              border-bottom: 2px solid #000;
              padding-bottom: 10px;
              margin-bottom: 15px;
            }
            .company-name {
              font-size: 16px;
              font-weight: bold;
              margin-bottom: 5px;
            }
            .receipt-title {
              font-size: 14px;
              font-weight: bold;
              margin-top: 10px;
            }
            .section {
              margin-bottom: 15px;
            }
            .section-title {
              font-weight: bold;
              border-bottom: 1px solid #000;
              margin-bottom: 5px;
              text-transform: uppercase;
            }
            .row {
              display: flex;
              justify-content: space-between;
              margin-bottom: 3px;
            }
            .row-full {
              margin-bottom: 3px;
            }
            .total {
              border-top: 2px solid #000;
              border-bottom: 2px solid #000;
              padding: 8px 0;
              margin: 15px 0;
              font-weight: bold;
              font-size: 14px;
            }
            .signatures {
              margin-top: 30px;
              border-top: 1px solid #000;
              padding-top: 20px;
            }
            .signature-line {
              border-bottom: 1px solid #000;
              margin: 30px 0 10px 0;
              height: 1px;
            }
            .signature-label {
              text-align: center;
              font-size: 10px;
              margin-top: 5px;
            }
            .footer {
              text-align: center;
              margin-top: 30px;
              font-size: 10px;
              border-top: 1px solid #000;
              padding-top: 10px;
            }
            @media print {
              body { margin: 0; padding: 10px; }
              .no-print { display: none; }
            }
          </style>
        </head>
        <body>
          ${r.innerHTML}
        </body>
      </html>
    `),o.document.close(),o.focus(),o.print(),s&&s())};return e.jsxs("div",{className:"bg-white p-6 rounded-lg",children:[e.jsxs("div",{id:"treasury-transfer-receipt",className:"receipt",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"company-name",children:"AABB - SISTEMA DE GESTÃO"}),e.jsx("div",{children:"Associação Atlética Banco do Brasil"}),e.jsx("div",{className:"receipt-title",children:"COMPROVANTE DE TRANSFERÊNCIA"}),e.jsx("div",{className:"receipt-title",children:"TESOURARIA"})]}),e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Dados da Transferência"}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"ID Transferência:"}),e.jsxs("span",{children:["#",t.transferId.slice(-8).toUpperCase()]})]}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"Data/Hora:"}),e.jsx("span",{children:wt(t.timestamp,"dd/MM/yyyy HH:mm",{locale:Wt})})]}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"Data Transferência:"}),e.jsx("span",{children:wt(new Date(t.transferDate),"dd/MM/yyyy",{locale:Wt})})]}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"Sessão Caixa:"}),e.jsxs("span",{children:["#",t.sessionId.slice(-6).toUpperCase()]})]})]}),e.jsx("div",{className:"total",children:e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"VALOR TRANSFERIDO:"}),e.jsx("span",{children:$e(t.amount)})]})}),e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Autorização"}),e.jsxs("div",{className:"row-full",children:[e.jsx("strong",{children:"Autorizado por:"})," ",t.authorizedBy]}),e.jsxs("div",{className:"row-full",children:[e.jsx("strong",{children:"Operador:"})," ",t.cashierName]}),t.treasuryReceiptNumber&&e.jsxs("div",{className:"row-full",children:[e.jsx("strong",{children:"Comprovante Tesouraria:"})," ",t.treasuryReceiptNumber]})]}),t.notes&&e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Observações"}),e.jsx("div",{className:"row-full",children:t.notes})]}),e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Informações"}),e.jsx("div",{className:"row-full",style:{fontSize:"10px"},children:"Este comprovante confirma a transferência de valores em dinheiro do caixa operacional para a tesouraria central."}),e.jsx("div",{className:"row-full",style:{fontSize:"10px",marginTop:"5px"},children:"Confira os dados e guarde este comprovante."})]}),e.jsxs("div",{className:"signatures",children:[e.jsx("div",{className:"section-title",children:"Assinaturas"}),e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx("div",{className:"signature-line"}),e.jsx("div",{className:"signature-label",children:"OPERADOR DE CAIXA"}),e.jsx("div",{className:"signature-label",children:t.cashierName})]}),e.jsxs("div",{style:{marginTop:"25px"},children:[e.jsx("div",{className:"signature-line"}),e.jsx("div",{className:"signature-label",children:"SUPERVISOR/AUTORIZAÇÃO"}),e.jsx("div",{className:"signature-label",children:t.authorizedBy})]}),e.jsxs("div",{style:{marginTop:"25px"},children:[e.jsx("div",{className:"signature-line"}),e.jsx("div",{className:"signature-label",children:"CONFERENTE TESOURARIA"}),e.jsx("div",{className:"signature-label",children:"Nome: ___________________________"})]})]}),e.jsxs("div",{className:"footer",children:[e.jsx("div",{children:"AABB - Sistema de Gestão v1.0"}),e.jsx("div",{children:"Documento gerado automaticamente"}),e.jsx("div",{children:wt(new Date,"dd/MM/yyyy HH:mm:ss",{locale:Wt})})]})]}),e.jsx("div",{className:"flex justify-center mt-6 no-print",children:e.jsxs("button",{onClick:a,className:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700 transition-colors flex items-center space-x-2",children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a2 2 0 002 2h6a2 2 0 002-2v-2h1a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z",clipRule:"evenodd"})}),e.jsx("span",{children:"Imprimir Comprovante"})]})})]})},QU={change:"Troco",expense:"Despesa",transfer:"Transferência",other:"Outros"},JU=({receiptData:t,onPrint:s})=>{const a=()=>{const r=document.getElementById("cash-withdrawal-receipt");if(!r)return;const o=window.open("","_blank");o&&(o.document.write(`
      <html>
        <head>
          <title>Comprovante de Saída de Dinheiro</title>
          <style>
            body {
              font-family: 'Courier New', monospace;
              font-size: 12px;
              line-height: 1.4;
              margin: 0;
              padding: 20px;
              background: white;
            }
            .receipt {
              max-width: 300px;
              margin: 0 auto;
            }
            .header {
              text-align: center;
              border-bottom: 2px solid #000;
              padding-bottom: 10px;
              margin-bottom: 15px;
            }
            .company-name {
              font-size: 16px;
              font-weight: bold;
              margin-bottom: 5px;
            }
            .receipt-title {
              font-size: 14px;
              font-weight: bold;
              margin-top: 10px;
            }
            .section {
              margin-bottom: 15px;
            }
            .section-title {
              font-weight: bold;
              border-bottom: 1px solid #000;
              margin-bottom: 5px;
              text-transform: uppercase;
            }
            .row {
              display: flex;
              justify-content: space-between;
              margin-bottom: 3px;
            }
            .row-full {
              margin-bottom: 3px;
            }
            .total {
              border-top: 2px solid #000;
              border-bottom: 2px solid #000;
              padding: 8px 0;
              margin: 15px 0;
              font-weight: bold;
              font-size: 14px;
            }
            .signatures {
              margin-top: 30px;
              border-top: 1px solid #000;
              padding-top: 20px;
            }
            .signature-line {
              border-bottom: 1px solid #000;
              margin: 30px 0 10px 0;
              height: 1px;
            }
            .signature-label {
              text-align: center;
              font-size: 10px;
              margin-top: 5px;
            }
            .footer {
              text-align: center;
              margin-top: 30px;
              font-size: 10px;
              border-top: 1px solid #000;
              padding-top: 10px;
            }
            .highlight {
              background-color: #f0f0f0;
              padding: 5px;
              border: 1px solid #000;
              margin: 10px 0;
            }
            @media print {
              body { margin: 0; padding: 10px; }
              .no-print { display: none; }
            }
          </style>
        </head>
        <body>
          ${r.innerHTML}
        </body>
      </html>
    `),o.document.close(),o.focus(),o.print(),s&&s())};return e.jsxs("div",{className:"bg-white p-6 rounded-lg",children:[e.jsxs("div",{id:"cash-withdrawal-receipt",className:"receipt",children:[e.jsxs("div",{className:"header",children:[e.jsx("div",{className:"company-name",children:"AABB - SISTEMA DE GESTÃO"}),e.jsx("div",{children:"Associação Atlética Banco do Brasil"}),e.jsx("div",{className:"receipt-title",children:"COMPROVANTE DE SAÍDA"}),e.jsx("div",{className:"receipt-title",children:"DE DINHEIRO"})]}),e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Dados da Operação"}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"ID Operação:"}),e.jsxs("span",{children:["#",t.withdrawalId.slice(-8).toUpperCase()]})]}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"Data/Hora:"}),e.jsx("span",{children:wt(t.timestamp,"dd/MM/yyyy HH:mm",{locale:Wt})})]}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"Sessão Caixa:"}),e.jsxs("span",{children:["#",t.sessionId.slice(-6).toUpperCase()]})]}),e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"Finalidade:"}),e.jsx("span",{children:QU[t.purpose]})]})]}),e.jsx("div",{className:"total",children:e.jsxs("div",{className:"row",children:[e.jsx("span",{children:"VALOR DA SAÍDA:"}),e.jsx("span",{children:$e(t.amount)})]})}),e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Justificativa"}),e.jsx("div",{className:"highlight",children:e.jsx("div",{className:"row-full",children:t.reason})})]}),e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Autorização"}),e.jsxs("div",{className:"row-full",children:[e.jsx("strong",{children:"Autorizado por:"})," ",t.authorizedBy]}),e.jsxs("div",{className:"row-full",children:[e.jsx("strong",{children:"Operador de Caixa:"})," ",t.cashierName]}),t.recipient&&e.jsxs("div",{className:"row-full",children:[e.jsx("strong",{children:"Beneficiário:"})," ",t.recipient]})]}),e.jsxs("div",{className:"section",children:[e.jsx("div",{className:"section-title",children:"Informações"}),e.jsx("div",{className:"row-full",style:{fontSize:"10px"},children:"Este comprovante documenta a saída de dinheiro do caixa operacional."}),e.jsx("div",{className:"row-full",style:{fontSize:"10px",marginTop:"5px"},children:"Operação devidamente autorizada e registrada no sistema."}),e.jsx("div",{className:"row-full",style:{fontSize:"10px",marginTop:"5px"},children:"Confira os dados e mantenha este comprovante arquivado."})]}),e.jsxs("div",{className:"signatures",children:[e.jsx("div",{className:"section-title",children:"Assinaturas e Confirmações"}),e.jsxs("div",{style:{marginTop:"20px"},children:[e.jsx("div",{className:"signature-line"}),e.jsx("div",{className:"signature-label",children:"OPERADOR DE CAIXA"}),e.jsx("div",{className:"signature-label",children:t.cashierName})]}),e.jsxs("div",{style:{marginTop:"25px"},children:[e.jsx("div",{className:"signature-line"}),e.jsx("div",{className:"signature-label",children:"SUPERVISOR/AUTORIZAÇÃO"}),e.jsx("div",{className:"signature-label",children:t.authorizedBy})]}),t.recipient&&e.jsxs("div",{style:{marginTop:"25px"},children:[e.jsx("div",{className:"signature-line"}),e.jsx("div",{className:"signature-label",children:"BENEFICIÁRIO/RECEBEDOR"}),e.jsx("div",{className:"signature-label",children:t.recipient})]}),e.jsxs("div",{style:{marginTop:"25px"},children:[e.jsx("div",{className:"signature-line"}),e.jsx("div",{className:"signature-label",children:"TESTEMUNHA (se necessário)"}),e.jsx("div",{className:"signature-label",children:"Nome: ___________________________"})]})]}),e.jsxs("div",{className:"footer",children:[e.jsx("div",{children:"AABB - Sistema de Gestão v1.0"}),e.jsx("div",{children:"Documento gerado automaticamente"}),e.jsx("div",{children:wt(new Date,"dd/MM/yyyy HH:mm:ss",{locale:Wt})}),e.jsx("div",{style:{marginTop:"10px",fontSize:"8px"},children:"⚠️ Este documento possui valor legal e deve ser arquivado"})]})]}),e.jsx("div",{className:"flex justify-center mt-6 no-print",children:e.jsxs("button",{onClick:a,className:"bg-orange-600 text-white px-6 py-2 rounded-lg hover:bg-orange-700 transition-colors flex items-center space-x-2",children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a2 2 0 002 2h6a2 2 0 002-2v-2h1a2 2 0 002-2V9a2 2 0 00-2-2h-1V4a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z",clipRule:"evenodd"})}),e.jsx("span",{children:"Imprimir Comprovante"})]})})]})},eB=({transactions:t,onAddWithdrawal:s,onExportReport:a,isCashSessionOpen:r=!1})=>{const[o,l]=y.useState("all"),[c,u]=y.useState("all"),h=b=>{var _,w;return(_=b.notes)!=null&&_.includes("[SAÍDA]")?"cash_withdrawal":(w=b.notes)!=null&&w.includes("[TRANSFERÊNCIA TESOURARIA]")?"treasury_transfer":b.transaction_type},f=t.filter(b=>{const _=h(b),w=o==="all"||_===o,E=c==="all"||b.payment_method===c;return w&&E}),p={entradas:t.filter(b=>{const _=h(b);return["sale","adjustment"].includes(_)&&b.amount>0}).reduce((b,_)=>b+_.amount,0),saidas:t.filter(b=>{const _=h(b);return["refund","cash_withdrawal","treasury_transfer"].includes(_)||_==="adjustment"&&b.amount<0}).reduce((b,_)=>b+Math.abs(_.amount),0),saldo:0};p.saldo=p.entradas-p.saidas;const g=b=>{switch(b){case"sale":return e.jsx(Sa,{className:"h-4 w-4 text-green-600"});case"refund":return e.jsx(Wu,{className:"h-4 w-4 text-red-600"});case"adjustment":return e.jsx(Tc,{className:"h-4 w-4 text-blue-600"});case"cash_withdrawal":return e.jsx(Ii,{className:"h-4 w-4 text-orange-600"});case"treasury_transfer":return e.jsx(Tc,{className:"h-4 w-4 text-purple-600"});default:return e.jsx(Ut,{className:"h-4 w-4 text-gray-600"})}},v=(b,_)=>b==="sale"||b==="adjustment"&&_>0?"text-green-600":["refund","cash_withdrawal","treasury_transfer"].includes(b)||b==="adjustment"&&_<0?"text-red-600":"text-gray-600";return e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Movimentação do Dia"}),e.jsx("p",{className:"text-sm text-gray-600",children:wt(new Date,"dd 'de' MMMM 'de' yyyy",{locale:Wt})})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:s,disabled:!r,className:`px-4 py-2 rounded-lg flex items-center space-x-2 text-sm transition-colors ${r?"bg-orange-600 text-white hover:bg-orange-700":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,title:r?"Registrar saída de dinheiro":"Caixa deve estar aberto para realizar saídas de dinheiro",children:[e.jsx(Ii,{className:"h-4 w-4"}),e.jsx("span",{children:"Saída de Dinheiro"})]}),e.jsxs("button",{onClick:a,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2 text-sm",children:[e.jsx(qc,{className:"h-4 w-4"}),e.jsx("span",{children:"Exportar"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-green-800",children:"Entradas"}),e.jsx("p",{className:"text-2xl font-bold text-green-900",children:$e(p.entradas)})]}),e.jsx(Sa,{className:"h-8 w-8 text-green-600"})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-red-800",children:"Saídas"}),e.jsx("p",{className:"text-2xl font-bold text-red-900",children:$e(p.saidas)})]}),e.jsx(Wu,{className:"h-8 w-8 text-red-600"})]})}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},className:`border rounded-lg p-4 ${p.saldo>=0?"bg-blue-50 border-blue-200":"bg-orange-50 border-orange-200"}`,children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:`text-sm font-medium ${p.saldo>=0?"text-blue-800":"text-orange-800"}`,children:"Saldo"}),e.jsx("p",{className:`text-2xl font-bold ${p.saldo>=0?"text-blue-900":"text-orange-900"}`,children:$e(Math.abs(p.saldo))})]}),e.jsx(Ut,{className:`h-8 w-8 ${p.saldo>=0?"text-blue-600":"text-orange-600"}`})]})})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between mb-6 space-y-3 sm:space-y-0",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs("select",{value:o,onChange:b=>l(b.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",title:"Filtrar por tipo de transação","aria-label":"Filtro por tipo de transação",children:[e.jsx("option",{value:"all",children:"Todos os Tipos"}),e.jsx("option",{value:"sale",children:"Vendas"}),e.jsx("option",{value:"refund",children:"Estornos"}),e.jsx("option",{value:"adjustment",children:"Ajustes"}),e.jsx("option",{value:"cash_withdrawal",children:"Saídas de Dinheiro"}),e.jsx("option",{value:"treasury_transfer",children:"Transferências"})]}),e.jsxs("select",{value:c,onChange:b=>u(b.target.value),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent text-sm",title:"Filtrar por método de pagamento","aria-label":"Filtro por método de pagamento",children:[e.jsx("option",{value:"all",children:"Todos os Métodos"}),e.jsx("option",{value:"dinheiro",children:"Dinheiro"}),e.jsx("option",{value:"cartao_debito",children:"Cartão de Débito"}),e.jsx("option",{value:"cartao_credito",children:"Cartão de Crédito"}),e.jsx("option",{value:"pix",children:"PIX"}),e.jsx("option",{value:"transferencia",children:"Transferência"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[f.length," de ",t.length," transações"]})]}),e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:f.length===0?e.jsx("div",{className:"text-center py-8",children:e.jsx("p",{className:"text-gray-500",children:"Nenhuma transação encontrada"})}):f.map(b=>{var w,E;const _=h(b);return e.jsxs(be.div,{initial:{opacity:0},animate:{opacity:1},className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[g(_),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900",children:[G2[_]||"Transação",b.comanda&&e.jsxs("span",{className:"ml-2 text-blue-600",children:["- Comanda #",_m(b.comanda.id)]}),!b.comanda&&b.notes&&(b.notes.includes("Pedido Balcão")||b.notes.includes("Pedido de balcão"))&&e.jsxs("span",{className:"ml-2 text-green-600",children:["- Pedido Balcão ",B2(b.notes)]})]}),e.jsxs("div",{className:"flex items-center space-x-2 text-xs text-gray-600",children:[e.jsx(Bt,{className:"h-3 w-3"}),e.jsx("span",{children:wt(new Date(b.processed_at),"HH:mm",{locale:Wt})}),e.jsx("span",{children:"•"}),e.jsx("span",{children:Oc[b.payment_method]}),((w=b.comanda)==null?void 0:w.customer_name)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx("span",{children:b.comanda.customer_name})]}),((E=b.comanda)==null?void 0:E.table_number)&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsxs("span",{children:["Mesa ",b.comanda.table_number]})]}),b.processed_by_employee&&e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"•"}),e.jsx(Ks,{className:"h-3 w-3"}),e.jsx("span",{children:b.processed_by_employee.name})]})]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:`text-sm font-bold ${v(_,b.amount)}`,children:[["refund","cash_withdrawal","treasury_transfer"].includes(_)||_==="adjustment"&&b.amount<0?"-":"+",$e(Math.abs(b.amount))]}),b.reference_number&&e.jsxs("p",{className:"text-xs text-gray-500",children:["Ref: ",b.reference_number]})]})]},b.id)})})]})},tB=({receiptData:t,onPrint:s})=>{var g;const{order:a,paymentMethod:r,amountPaid:o,cashierName:l,referenceNumber:c,timestamp:u}=t,h=v=>({dinheiro:"Dinheiro",cartao_debito:"Cartão Débito",cartao_credito:"Cartão Crédito",pix:"PIX",transferencia:"Transferência"})[v]||v,f=()=>{s&&s();const v=window.open("","_blank");v&&(v.document.write(p()),v.document.close(),v.print(),v.close())},p=()=>{var v;return`
      <!DOCTYPE html>
      <html>
      <head>
        <title>Comprovante - ${a.order_number.toString().padStart(4,"0")}</title>
        <style>
          body {
            font-family: 'Courier New', monospace;
            font-size: 12px;
            line-height: 1.4;
            margin: 0;
            padding: 20px;
            width: 300px;
          }
          .header {
            text-align: center;
            border-bottom: 2px solid #000;
            padding-bottom: 10px;
            margin-bottom: 15px;
          }
          .title {
            font-size: 16px;
            font-weight: bold;
            margin-bottom: 5px;
          }
          .subtitle {
            font-size: 10px;
            color: #666;
          }
          .section {
            margin-bottom: 15px;
          }
          .section-title {
            font-weight: bold;
            border-bottom: 1px solid #ccc;
            padding-bottom: 2px;
            margin-bottom: 5px;
          }
          .item-row {
            display: flex;
            justify-content: space-between;
            margin-bottom: 3px;
          }
          .item-name {
            flex: 1;
          }
          .item-qty {
            width: 30px;
            text-align: center;
          }
          .item-price {
            width: 60px;
            text-align: right;
          }
          .total-row {
            display: flex;
            justify-content: space-between;
            font-weight: bold;
            border-top: 1px solid #000;
            padding-top: 5px;
            margin-top: 10px;
          }
          .footer {
            text-align: center;
            border-top: 2px solid #000;
            padding-top: 10px;
            margin-top: 15px;
            font-size: 10px;
          }
          .dashed-line {
            border-top: 1px dashed #666;
            margin: 10px 0;
          }
          .payment-status {
            background-color: #d4edda;
            border: 1px solid #c3e6cb;
            color: #155724;
            padding: 10px;
            text-align: center;
            font-weight: bold;
            margin: 15px 0;
          }
          @media print {
            body { margin: 0; padding: 10px; }
          }
        </style>
      </head>
      <body>
        <div class="header">
          <div class="title">CLUBE SOCIAL</div>
          <div class="subtitle">Bar & Restaurante</div>
          <div class="subtitle">CNPJ: 12.345.678/0001-90</div>
        </div>

        <div class="section">
          <div class="section-title">COMPROVANTE DE PAGAMENTO</div>
          <div>Pedido: #${a.order_number.toString().padStart(4,"0")}</div>
          <div>Data Pedido: ${new Date(a.created_at).toLocaleDateString("pt-BR")}</div>
          <div>Hora Pedido: ${new Date(a.created_at).toLocaleTimeString("pt-BR")}</div>
          <div>Data Pagto: ${u.toLocaleDateString("pt-BR")}</div>
          <div>Hora Pagto: ${u.toLocaleTimeString("pt-BR")}</div>
          <div>Atendente: ${a.employee_name||"N/A"}</div>
          <div>Caixa: ${l}</div>
          ${a.customer_name?`<div>Cliente: ${a.customer_name}</div>`:""}
          ${a.customer_phone?`<div>Telefone: ${a.customer_phone}</div>`:""}
        </div>

        <div class="dashed-line"></div>

        <div class="section">
          <div class="section-title">ITENS VENDIDOS</div>
          ${((v=a.items)==null?void 0:v.map(b=>{var _;return`
            <div class="item-row">
              <div class="item-name">${((_=b.menu_item)==null?void 0:_.name)||"Item"}</div>
              <div class="item-qty">${b.quantity}x</div>
              <div class="item-price">R$ ${(b.unit_price*b.quantity).toFixed(2)}</div>
            </div>
            ${b.notes?`<div style="font-size: 10px; color: #666; margin-left: 10px;">Obs: ${b.notes}</div>`:""}
          `}).join(""))||"<div>Nenhum item encontrado</div>"}
        </div>

        <div class="dashed-line"></div>

        <div class="section">
          <div class="item-row">
            <div>Subtotal:</div>
            <div>R$ ${a.total_amount.toFixed(2)}</div>
          </div>
          ${a.discount_amount&&a.discount_amount>0?`
            <div class="item-row" style="color: #666;">
              <div>Desconto:</div>
              <div>-R$ ${a.discount_amount.toFixed(2)}</div>
            </div>
          `:""}
          <div class="total-row">
            <div>TOTAL PAGO:</div>
            <div>R$ ${o.toFixed(2)}</div>
          </div>
        </div>

        <div class="dashed-line"></div>

        <div class="section">
          <div class="section-title">INFORMAÇÕES DE PAGAMENTO</div>
          <div>Forma de Pagamento: ${h(r)}</div>
          <div>Valor Pago: R$ ${o.toFixed(2)}</div>
          ${c?`<div>Ref. Transação: ${c}</div>`:""}
          <div>Status: PAGO ✓</div>
        </div>

        ${a.notes?`
          <div class="dashed-line"></div>
          <div class="section">
            <div class="section-title">OBSERVAÇÕES DO PEDIDO</div>
            <div>${a.notes}</div>
          </div>
        `:""}

        ${a.customer_notes?`
          <div class="dashed-line"></div>
          <div class="section">
            <div class="section-title">OBSERVAÇÕES DO CLIENTE</div>
            <div>${a.customer_notes}</div>
          </div>
        `:""}

        <div class="payment-status">
          <div>✅ PAGAMENTO APROVADO ✅</div>
          <div style="margin-top: 5px; font-size: 10px;">
            Transação processada com sucesso
          </div>
        </div>

        <div class="footer">
          <div>Obrigado pela preferência!</div>
          <div>Volte sempre!</div>
          <div style="margin-top: 10px;">
            ${a.customer_name?`Pontos acumulados: +${Math.floor(a.final_amount/10)}`:"Cadastre-se e ganhe pontos!"}
          </div>
          <div style="margin-top: 10px;">
            ID: ${a.id.substring(0,8).toUpperCase()}
          </div>
        </div>
      </body>
      </html>
    `};return e.jsxs("div",{className:"payment-receipt",children:[e.jsxs("div",{className:"bg-white border border-gray-300 rounded-lg p-6 max-w-sm mx-auto font-mono text-sm",children:[e.jsxs("div",{className:"text-center border-b-2 border-black pb-3 mb-4",children:[e.jsx("div",{className:"font-bold text-lg",children:"CLUBE SOCIAL"}),e.jsx("div",{className:"text-xs text-gray-600",children:"Bar & Restaurante"}),e.jsx("div",{className:"text-xs text-gray-600",children:"CNPJ: 12.345.678/0001-90"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("div",{className:"font-bold border-b border-gray-400 pb-1 mb-2",children:"COMPROVANTE DE PAGAMENTO"}),e.jsxs("div",{children:["Pedido: #",a.order_number.toString().padStart(4,"0")]}),e.jsxs("div",{children:["Data Pedido: ",new Date(a.created_at).toLocaleDateString("pt-BR")]}),e.jsxs("div",{children:["Hora Pedido: ",new Date(a.created_at).toLocaleTimeString("pt-BR")]}),e.jsxs("div",{children:["Data Pagto: ",u.toLocaleDateString("pt-BR")]}),e.jsxs("div",{children:["Hora Pagto: ",u.toLocaleTimeString("pt-BR")]}),e.jsxs("div",{children:["Atendente: ",a.employee_name||"N/A"]}),e.jsxs("div",{children:["Caixa: ",l]}),a.customer_name&&e.jsxs("div",{children:["Cliente: ",a.customer_name]}),a.customer_phone&&e.jsxs("div",{children:["Telefone: ",a.customer_phone]})]}),e.jsxs("div",{className:"border-t border-dashed border-gray-400 pt-3 mb-4",children:[e.jsx("div",{className:"font-bold border-b border-gray-400 pb-1 mb-2",children:"ITENS VENDIDOS"}),((g=a.items)==null?void 0:g.map((v,b)=>{var _;return e.jsxs("div",{className:"mb-1",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"flex-1",children:((_=v.menu_item)==null?void 0:_.name)||"Item"}),e.jsxs("span",{className:"w-8 text-center",children:[v.quantity,"x"]}),e.jsxs("span",{className:"w-16 text-right",children:["R$ ",(v.unit_price*v.quantity).toFixed(2)]})]}),v.notes&&e.jsxs("div",{className:"text-xs text-gray-600 ml-2",children:["Obs: ",v.notes]})]},b)}))||e.jsx("div",{className:"text-gray-500 text-center py-2",children:"Nenhum item encontrado"})]}),e.jsxs("div",{className:"border-t border-dashed border-gray-400 pt-3 mb-4",children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{children:"Subtotal:"}),e.jsxs("span",{children:["R$ ",a.total_amount.toFixed(2)]})]}),a.discount_amount&&a.discount_amount>0&&e.jsxs("div",{className:"flex justify-between mb-1 text-gray-600",children:[e.jsx("span",{children:"Desconto:"}),e.jsxs("span",{children:["-R$ ",a.discount_amount.toFixed(2)]})]}),e.jsxs("div",{className:"flex justify-between font-bold border-t border-black pt-2",children:[e.jsx("span",{children:"TOTAL PAGO:"}),e.jsxs("span",{children:["R$ ",o.toFixed(2)]})]})]}),e.jsxs("div",{className:"border-t border-dashed border-gray-400 pt-3 mb-4",children:[e.jsx("div",{className:"font-bold border-b border-gray-400 pb-1 mb-2",children:"INFORMAÇÕES DE PAGAMENTO"}),e.jsxs("div",{children:["Forma: ",h(r)]}),e.jsxs("div",{children:["Valor Pago: ",$e(o)]}),c&&e.jsxs("div",{children:["Ref.: ",c]}),e.jsx("div",{children:"Status: PAGO ✓"})]}),a.notes&&e.jsxs("div",{className:"border-t border-dashed border-gray-400 pt-3 mb-4",children:[e.jsx("div",{className:"font-bold border-b border-gray-400 pb-1 mb-2",children:"OBSERVAÇÕES DO PEDIDO"}),e.jsx("div",{children:a.notes})]}),a.customer_notes&&e.jsxs("div",{className:"border-t border-dashed border-gray-400 pt-3 mb-4",children:[e.jsx("div",{className:"font-bold border-b border-gray-400 pb-1 mb-2",children:"OBSERVAÇÕES DO CLIENTE"}),e.jsx("div",{children:a.customer_notes})]}),e.jsxs("div",{className:"bg-green-100 border border-green-300 text-green-800 p-3 text-center font-bold mb-4",children:[e.jsx("div",{children:"✅ PAGAMENTO APROVADO ✅"}),e.jsx("div",{className:"text-xs mt-1",children:"Transação processada com sucesso"})]}),e.jsxs("div",{className:"text-center border-t-2 border-black pt-3 text-xs",children:[e.jsx("div",{children:"Obrigado pela preferência!"}),e.jsx("div",{children:"Volte sempre!"}),e.jsx("div",{className:"mt-2",children:a.customer_name?`Pontos acumulados: +${Math.floor(a.final_amount/10)}`:"Cadastre-se e ganhe pontos!"}),e.jsxs("div",{className:"mt-2",children:["ID: ",a.id.substring(0,8).toUpperCase()]})]})]}),e.jsx("div",{className:"text-center mt-4",children:e.jsx("button",{onClick:f,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors",children:"Imprimir Comprovante"})})]})},sB=({comandas:t,onPayComanda:s,disabled:a=!1})=>{const r=l=>{const c=new Date,u=new Date(l),h=Math.floor((c.getTime()-u.getTime())/(1e3*60));if(h<60)return`${h}min`;const f=Math.floor(h/60),p=h%60;return`${f}h ${p}min`},o=l=>{const c=Math.floor((new Date().getTime()-new Date(l).getTime())/6e4);return c>120?"text-red-600 bg-red-50":c>60?"text-orange-600 bg-orange-50":"text-green-600 bg-green-50"};return t.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center space-x-3 mb-4",children:[e.jsx(ts,{className:"h-6 w-6 text-green-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Comandas Pendentes de Pagamento"})]}),e.jsxs("div",{className:"text-center py-8",children:[e.jsx(ts,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"Todas as comandas foram pagas!"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Não há comandas aguardando pagamento no momento."})]})]}):e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Bt,{className:"h-6 w-6 text-orange-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Comandas Pendentes de Pagamento"}),e.jsx("span",{className:"bg-orange-100 text-orange-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:t.length})]}),a&&e.jsxs("div",{className:"flex items-center space-x-2 text-amber-600",children:[e.jsx(Ya,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm font-medium",children:"Abra o caixa para processar pagamentos"})]})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:t.map(l=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:border-gray-300 transition-colors",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("div",{className:"flex items-center space-x-2",children:l.table?e.jsxs(e.Fragment,{children:[e.jsx(Fc,{className:"h-4 w-4 text-gray-600"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:["Mesa ",l.table.number]})]}):e.jsxs(e.Fragment,{children:[e.jsx(Wi,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:"Balcão"})]})}),e.jsx("div",{className:`px-2 py-1 rounded-full text-xs font-medium ${o(l.opened_at)}`,children:r(l.opened_at)})]}),l.customer_name&&e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(Ns,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:l.customer_name}),e.jsxs("span",{className:"text-xs text-gray-500",children:["(",l.people_count," pessoas)"]})]}),e.jsxs("div",{className:"flex items-center space-x-2 mb-3",children:[e.jsx(Mr,{className:"h-4 w-4 text-gray-600"}),e.jsx("span",{className:"text-sm text-gray-700",children:new Date(l.opened_at).toLocaleString("pt-BR")})]}),e.jsx("div",{className:"mb-4",children:e.jsxs("p",{className:"text-xs text-gray-600 mb-2",children:[l.items.length," ",l.items.length===1?"item":"itens"]})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-bold text-gray-900",children:$e(l.total)}),e.jsx("p",{className:"text-xs text-gray-600",children:"Total da comanda"})]}),e.jsx("button",{onClick:()=>s(l),disabled:a,className:"bg-green-600 text-white px-4 py-2 rounded-md hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Receber"})]})]},l.id))})]})},aB=()=>{const{user:t}=jt(),s=Xs(),{currentSession:a,pendingComandas:r,todaysSummary:o,todaysTransactions:l,loading:c,error:u,openCashSession:h,processComandaPayment:f,processCashWithdrawal:p,processTreasuryTransfer:g,refreshData:v}=Rm(),{pendingOrders:b,processPayment:_,refreshData:w}=Em(),[E,k]=y.useState(!1),[N,C]=y.useState(!1),[S,T]=y.useState(!1),[M,$]=y.useState(!1),[A,z]=y.useState(!1),[R,L]=y.useState(!1),[I,X]=y.useState(!1),[ce,J]=y.useState(!1),[V,Y]=y.useState(null),[ee,we]=y.useState(null),[D,H]=y.useState(!1),[F,Z]=y.useState("dinheiro"),[re,oe]=y.useState(!1),[ae,pe]=y.useState(null),[P,q]=y.useState(null),[Q,G]=y.useState(null),[me,Ne]=y.useState(!0),[je,Re]=y.useState(!1),[Ie,Ve]=y.useState(0),[De,Ue]=y.useState(!1),W=async le=>{if(!a){alert("É necessário ter uma sessão de caixa aberta para processar pagamentos.");return}Y(le),T(!0)},se=le=>{if(!a){alert("É necessário ter uma sessão de caixa aberta para processar pagamentos.");return}we(le),H(!0)},ue=async(le,Oe)=>{if(!(!ee||!a))try{oe(!0),await f({comanda_id:ee.id,payment_method:le,amount:ee.total||0,notes:Oe}),console.log("✅ Pagamento da comanda processado com sucesso"),H(!1),we(null)}catch(tt){console.error("❌ Erro ao processar pagamento da comanda:",tt),alert("Erro ao processar pagamento da comanda")}finally{oe(!1)}},Ce=async()=>{if(!(!V||!a)){oe(!0);try{await _({order_id:V.id,payment_method:F,cash_session_id:a.id,amount_paid:V.final_amount}),console.log("🔄 Forçando atualização dos dados após pagamento..."),await Promise.all([w(),v()]),setTimeout(async()=>{console.log("🔄 Segunda atualização dos dados..."),await Promise.all([w(),v()])},1e3),pe({order:V,paymentMethod:F,amountPaid:V.final_amount,cashierName:(t==null?void 0:t.name)||(t==null?void 0:t.email)||"Operador de Caixa",timestamp:new Date}),T(!1),$(!0),Y(null)}catch(le){console.error("Erro ao processar pagamento:",le),alert("Erro ao processar pagamento. Tente novamente.")}finally{oe(!1)}}},ke=()=>{$(!1),pe(null)},ye=async le=>{try{const Oe=await p(le);G({withdrawalId:Oe,amount:le.amount,reason:le.reason,authorizedBy:le.authorized_by,recipient:le.recipient,purpose:le.purpose,cashierName:(t==null?void 0:t.name)||(t==null?void 0:t.email)||"Operador de Caixa",timestamp:new Date,sessionId:(a==null?void 0:a.id)||""}),z(!1),J(!0)}catch(Oe){console.error("Erro ao processar saída de dinheiro:",Oe),alert("Erro ao processar saída de dinheiro. Tente novamente.")}},Me=async le=>{try{const Oe=await g(le);q({transferId:Oe,amount:le.amount,transferDate:le.transfer_date,authorizedBy:le.authorized_by,treasuryReceiptNumber:le.treasury_receipt_number,notes:le.notes,cashierName:(t==null?void 0:t.name)||(t==null?void 0:t.email)||"Operador de Caixa",timestamp:new Date,sessionId:(a==null?void 0:a.id)||""}),L(!1),X(!0)}catch(Oe){console.error("Erro ao processar transferência:",Oe),alert("Erro ao processar transferência. Tente novamente.")}},Pe=()=>{z(!0)},Ge=()=>{console.log("Exportando relatório...")},Qe=()=>{X(!1),q(null)},xe=()=>{J(!1),G(null)};y.useEffect(()=>{const le=b.length;if(le>Ie&&Ie>0){Re(!0),Ne(!0);const Oe=setTimeout(()=>{Re(!1)},1e4);return()=>clearTimeout(Oe)}Ve(le)},[b.length,Ie]);const Te=()=>{Ne(!1),Re(!1);const le=document.getElementById("pending-orders-section");le&&le.scrollIntoView({behavior:"smooth"})},he=()=>{Ne(!1),Re(!1)};return c?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600"})}):u?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-6",children:e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(yt,{className:"h-6 w-6 text-red-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-red-800",children:"Erro no Sistema"}),e.jsx("p",{className:"text-red-600",children:u})]})]})})}):e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestão de Caixa"}),e.jsx("p",{className:"text-gray-600 mt-1",children:new Date().toLocaleDateString("pt-BR",{weekday:"long",year:"numeric",month:"long",day:"numeric"})})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{onClick:()=>s("/cash/movement"),className:"bg-blue-600 text-white px-4 py-3 rounded-lg hover:bg-blue-700 flex items-center space-x-2 transition-colors",children:[e.jsx(QN,{className:"h-5 w-5"}),e.jsx("span",{children:"Movimento"})]}),a?e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:()=>L(!0),className:"bg-purple-600 text-white px-4 py-3 rounded-lg hover:bg-purple-700 flex items-center space-x-2 transition-colors",children:[e.jsx(Tc,{className:"h-5 w-5"}),e.jsx("span",{children:"Transferência"})]}),e.jsxs("button",{onClick:()=>C(!0),className:"bg-red-600 text-white px-6 py-3 rounded-lg hover:bg-red-700 flex items-center space-x-2 transition-colors",children:[e.jsx(Ut,{className:"h-5 w-5"}),e.jsx("span",{children:"Fechar Caixa"})]})]}):e.jsxs("button",{onClick:()=>k(!0),className:"bg-green-600 text-white px-6 py-3 rounded-lg hover:bg-green-700 flex items-center space-x-2 transition-colors",children:[e.jsx($s,{className:"h-5 w-5"}),e.jsx("span",{children:"Abrir Caixa"})]})]})]}),a?e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6 mb-8",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:e.jsx(Ut,{className:"h-8 w-8 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-green-800",children:"Caixa Aberto"}),e.jsxs("p",{className:"text-green-600",children:["Aberto às ",new Date(a.opened_at).toLocaleTimeString("pt-BR")]}),e.jsxs("p",{className:"text-sm text-green-600",children:["Valor inicial: ",$e(a.opening_amount)]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-2xl font-bold text-green-800",children:$e(a.expected_amount)}),e.jsx("p",{className:"text-sm text-green-600",children:"Valor esperado"})]})]})}):e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-6 mb-8",children:e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:"bg-yellow-100 p-3 rounded-full",children:e.jsx(yt,{className:"h-8 w-8 text-yellow-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-yellow-800",children:"Caixa Fechado"}),e.jsx("p",{className:"text-yellow-600",children:"É necessário abrir o caixa para processar pagamentos"})]})]})}),b.length>0&&me&&e.jsx("div",{className:`mb-8 transition-all duration-300 ${je?"animate-pulse":""}`,children:e.jsxs("div",{className:"bg-gradient-to-r from-orange-50 to-red-50 border-2 border-orange-300 rounded-lg p-6 shadow-lg",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("div",{className:`p-3 rounded-full ${je?"bg-red-200 animate-bounce":"bg-orange-100"}`,children:e.jsxs("div",{className:"relative",children:[e.jsx(m0,{className:`h-8 w-8 ${je?"text-red-600":"text-orange-600"}`}),b.length>0&&e.jsx("div",{className:`absolute -top-2 -right-2 h-6 w-6 rounded-full flex items-center justify-center text-xs font-bold text-white ${je?"bg-red-500 animate-ping":"bg-orange-500"}`,children:b.length})]})}),e.jsxs("div",{children:[e.jsxs("h3",{className:`text-xl font-bold flex items-center space-x-2 ${je?"text-red-800":"text-orange-800"}`,children:[e.jsx("span",{children:"Pedidos Aguardando Pagamento"}),je&&e.jsx(yg,{className:"h-5 w-5 text-red-600 animate-bounce"})]}),e.jsxs("p",{className:`${je?"text-red-600":"text-orange-600"} font-medium`,children:[b.length," ",b.length===1?"pedido pendente":"pedidos pendentes"]}),e.jsx("div",{className:"mt-2 text-sm text-gray-700",children:e.jsxs("p",{children:["Valor total: ",e.jsx("span",{className:"font-semibold text-green-600",children:$e(b.reduce((le,Oe)=>le+Oe.final_amount,0))})]})})]})]}),e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsxs("button",{onClick:Te,className:`px-6 py-3 rounded-lg font-medium flex items-center space-x-2 transition-all duration-200 ${je?"bg-red-600 hover:bg-red-700 text-white shadow-lg transform hover:scale-105":"bg-orange-600 hover:bg-orange-700 text-white"}`,children:[e.jsx(Ys,{className:"h-5 w-5"}),e.jsx("span",{children:"Ver Pedidos"})]}),e.jsx("button",{onClick:he,className:"p-2 text-gray-400 hover:text-gray-600 rounded-full hover:bg-gray-100 transition-colors",title:"Dispensar alerta","aria-label":"Dispensar alerta",children:e.jsx(nt,{className:"h-5 w-5"})})]})]}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-orange-200",children:[e.jsx("h4",{className:"text-sm font-medium text-orange-800 mb-3",children:"Pedidos mais recentes:"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-3",children:b.slice(0,3).map(le=>e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-orange-200 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("span",{className:"font-bold text-gray-900",children:["#",le.order_number.toString().padStart(4,"0")]}),e.jsx("span",{className:"text-xs text-gray-500",children:new Date(le.created_at).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]}),le.customer_name&&e.jsx("p",{className:"text-sm text-gray-700 mb-1 truncate",children:le.customer_name}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{className:"text-sm text-gray-600",children:[(le.items||[]).length," ",(le.items||[]).length===1?"item":"itens"]}),e.jsx("span",{className:"font-bold text-green-600",children:$e(le.final_amount)})]})]},le.id))}),b.length>3&&e.jsxs("p",{className:"text-sm text-orange-600 mt-3 text-center",children:["+",b.length-3," pedidos adicionais aguardando pagamento"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsx(Sa,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Vendas Hoje"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:$e(o.total_sales)})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:e.jsx(_O,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Transações"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:o.total_transactions})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:e.jsx(bg,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Ticket Médio"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:$e(o.avg_ticket)})]})]})}),e.jsx("div",{className:`bg-white rounded-lg shadow p-6 relative ${r.length>0?"ring-2 ring-orange-300":""}`,children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:`p-3 rounded-full ${r.length>0,"bg-orange-100"}`,children:e.jsx(Bt,{className:`h-6 w-6 ${r.length>0,"text-orange-600"}`})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Comandas Pendentes"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.length})]}),r.length>0&&e.jsx("div",{className:"absolute -top-2 -right-2 h-6 w-6 bg-orange-500 rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold animate-pulse",children:"!"})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Vendas por Método de Pagamento"}),e.jsx("div",{className:"space-y-4",children:o.by_payment_method.map(le=>{const Oe=le.payment_method==="dinheiro"?cR:le.payment_method==="pix"?fn:Wi;return e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(Oe,{className:"h-5 w-5 text-gray-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:Oc[le.payment_method]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:$e(le.amount)}),e.jsxs("p",{className:"text-xs text-gray-600",children:[le.percentage.toFixed(1),"%"]})]})]},le.payment_method)})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Performance por Funcionário"}),e.jsx("div",{className:"space-y-4",children:o.by_employee.map(le=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-gray-100 p-2 rounded-full",children:e.jsx(Ns,{className:"h-4 w-4 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:le.employee_name}),e.jsxs("p",{className:"text-xs text-gray-600",children:[le.transaction_count," transações"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:$e(le.total_sales)}),e.jsxs("p",{className:"text-xs text-gray-600",children:["Média: ",$e(le.avg_ticket)]})]})]},le.employee_id))})]})]}),e.jsx(eB,{transactions:l,onAddWithdrawal:Pe,onExportReport:Ge,isCashSessionOpen:(a==null?void 0:a.status)==="open"}),e.jsx("div",{className:"mb-8",children:e.jsx(sB,{comandas:r,onPayComanda:se,disabled:!a||re})}),e.jsxs("div",{id:"pending-orders-section",className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx(hn,{className:"h-6 w-6 text-blue-600"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Pedidos de Balcão Aguardando Pagamento"}),e.jsx("span",{className:"bg-blue-100 text-blue-800 text-xs font-medium px-2.5 py-0.5 rounded-full",children:b.length})]}),e.jsxs("button",{onClick:async()=>{Ue(!0);try{console.log("🔄 Atualizando pedidos de balcão..."),await w(),console.log("✅ Pedidos atualizados!")}catch(le){console.error("❌ Erro ao atualizar:",le)}finally{Ue(!1)}},disabled:De,className:"bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 flex items-center space-x-2 transition-all disabled:opacity-50 disabled:cursor-not-allowed",title:"Atualizar lista de pedidos",children:[e.jsx(Tc,{className:`h-4 w-4 ${De?"animate-spin":""}`}),e.jsx("span",{children:De?"Atualizando...":"Atualizar"})]})]}),b.length===0?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(hn,{className:"h-12 w-12 text-green-600 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 text-lg font-medium",children:"Todos os pedidos foram pagos!"}),e.jsx("p",{className:"text-gray-500 text-sm mt-1",children:"Não há pedidos de balcão aguardando pagamento."})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:b.map(le=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsxs("span",{className:"text-lg font-bold text-gray-900",children:["#",le.order_number.toString().padStart(4,"0")]}),e.jsx("span",{className:"bg-yellow-100 text-yellow-800 text-xs font-medium px-2 py-1 rounded-full",children:"Aguardando Pagamento"})]}),e.jsx("span",{className:"text-sm text-gray-500",children:new Date(le.created_at).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"})})]}),le.customer_name&&e.jsxs("div",{className:"mb-3",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:le.customer_name}),le.customer_phone&&e.jsx("p",{className:"text-xs text-gray-600",children:le.customer_phone})]}),e.jsxs("div",{className:"mb-3",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-700 mb-1",children:[(le.items||[]).length," ",(le.items||[]).length===1?"item":"itens"]}),e.jsxs("div",{className:"space-y-1",children:[(le.items||[]).slice(0,3).map((Oe,tt)=>{var bs;return e.jsxs("p",{className:"text-xs text-gray-600",children:[Oe.quantity,"x ",((bs=Oe.menu_item)==null?void 0:bs.name)||"Item"]},tt)}),(le.items||[]).length>3&&e.jsxs("p",{className:"text-xs text-gray-500 italic",children:["+",(le.items||[]).length-3," mais..."]})]})]}),le.customer_notes&&e.jsx("div",{className:"mb-3 p-2 bg-yellow-50 rounded border",children:e.jsx("p",{className:"text-xs text-yellow-800",children:le.customer_notes})}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-lg font-bold text-green-600",children:$e(le.final_amount)}),e.jsx("button",{onClick:()=>W(le),disabled:!a,className:"bg-green-600 text-white px-4 py-2 rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed text-sm font-medium",children:"Receber Pagamento"})]})]},le.id))})]}),e.jsx(ZU,{isOpen:E,onClose:()=>k(!1),onOpenCash:h}),a&&e.jsx(WU,{isOpen:N,onClose:()=>C(!1),session:a}),S&&V&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 w-96 max-h-screen overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("h3",{className:"text-lg font-semibold",children:["Receber Pagamento - #",V.order_number.toString().padStart(4,"0")]}),e.jsx("button",{onClick:()=>T(!1),className:"text-gray-400 hover:text-gray-600","aria-label":"Fechar modal",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"mb-6 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Resumo do Pedido"}),V.customer_name&&e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Cliente: ",V.customer_name]}),e.jsxs("div",{className:"space-y-1 text-sm",children:[(V.items||[]).map((le,Oe)=>{var tt;return e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[le.quantity,"x ",(tt=le.menu_item)==null?void 0:tt.name]}),e.jsx("span",{children:$e(le.unit_price*le.quantity)})]},Oe)}),(V.discount_amount||0)>0&&e.jsxs("div",{className:"flex justify-between text-green-600 border-t pt-1",children:[e.jsx("span",{children:"Desconto:"}),e.jsxs("span",{children:["-",$e(V.discount_amount||0)]})]}),e.jsxs("div",{className:"border-t pt-2 flex justify-between font-medium",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{children:$e(V.final_amount)})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Método de Pagamento"}),e.jsxs("select",{value:F,onChange:le=>Z(le.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent","aria-label":"Método de pagamento",children:[e.jsx("option",{value:"dinheiro",children:"Dinheiro"}),e.jsx("option",{value:"cartao_debito",children:"Cartão de Débito"}),e.jsx("option",{value:"cartao_credito",children:"Cartão de Crédito"}),e.jsx("option",{value:"pix",children:"PIX"}),e.jsx("option",{value:"transferencia",children:"Transferência"})]})]}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsx("button",{onClick:()=>T(!1),className:"flex-1 bg-gray-300 text-gray-700 py-3 rounded-lg hover:bg-gray-400 transition-colors",children:"Cancelar"}),e.jsx("button",{onClick:Ce,disabled:re||!a,className:"flex-1 bg-green-600 text-white py-3 rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50",children:re?"Processando...":"Processar e Imprimir"})]})]})}),e.jsx(W2,{isOpen:D,comanda:ee,onClose:()=>{H(!1),we(null)},onConfirm:ue,loading:re}),M&&ae&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6 sticky top-0 bg-white pb-4 border-b",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Pagamento Processado!"})]}),e.jsx("button",{onClick:ke,className:"text-gray-400 hover:text-gray-600",title:"Fechar modal de comprovante","aria-label":"Fechar modal de comprovante",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"mb-6 text-center",children:[e.jsxs("p",{className:"text-gray-600 mb-2",children:["Pagamento de #",ae.order.order_number.toString().padStart(4,"0")," processado com sucesso!"]}),e.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Comprovante de pagamento gerado"})]}),e.jsx("div",{className:"mb-6",children:e.jsx(tB,{receiptData:ae,onPrint:ke})}),e.jsxs("div",{className:"flex space-x-3 sticky bottom-0 bg-white pt-4 border-t",children:[e.jsx("button",{onClick:ke,className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Fechar"}),e.jsxs("button",{onClick:()=>{console.log("Reimprimindo comprovante de pagamento...")},className:"flex-1 bg-green-600 text-white py-2 rounded-lg hover:bg-green-700 transition-colors flex items-center justify-center space-x-2",children:[e.jsx("svg",{className:"h-4 w-4",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M5 4v3H4a2 2 0 00-2 2v3a2 2 0 002 2h1v2a2 2 0 002 2h6a2 2 0 002-2v-2h1a2 2 0 002-2V9a2 2 0 00-2-2H7a2 2 0 00-2 2zm8 0H7v3h6V4zm0 8H7v4h6v-4z",clipRule:"evenodd"})}),e.jsx("span",{children:"Reimprimir"})]})]})]})}),e.jsx(YU,{isOpen:A,onClose:()=>z(!1),onProcessWithdrawal:ye,currentCashBalance:(a==null?void 0:a.expected_amount)||0,loading:re}),e.jsx(KU,{isOpen:R,onClose:()=>L(!1),onProcessTransfer:Me,currentCashBalance:(a==null?void 0:a.expected_amount)||0,loading:re}),I&&P&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Transferência Processada!"})]}),e.jsx("button",{onClick:Qe,className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Fechar modal de comprovante","aria-label":"Fechar modal de comprovante",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-600 mb-4 text-center",children:"Transferência para tesouraria processada com sucesso!"}),e.jsx("p",{className:"text-sm text-green-600 font-medium text-center mb-4",children:"Comprovante de transferência gerado"}),e.jsx(XU,{receiptData:P,onPrint:Qe})]}),e.jsx("div",{className:"flex space-x-3 p-6 pt-0 border-t border-gray-200",children:e.jsx("button",{onClick:Qe,className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Fechar"})})]})}),ce&&Q&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200 sticky top-0 bg-white",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Saída de Dinheiro Processada!"})]}),e.jsx("button",{onClick:xe,className:"text-gray-400 hover:text-gray-600 transition-colors",title:"Fechar modal de comprovante","aria-label":"Fechar modal de comprovante",children:e.jsx("svg",{className:"h-5 w-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z",clipRule:"evenodd"})})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("p",{className:"text-gray-600 mb-4 text-center",children:"Saída de dinheiro processada com sucesso!"}),e.jsx("p",{className:"text-sm text-orange-600 font-medium text-center mb-4",children:"Comprovante gerado para assinatura"}),e.jsx(JU,{receiptData:Q,onPrint:xe})]}),e.jsx("div",{className:"flex space-x-3 p-6 pt-0 border-t border-gray-200",children:e.jsx("button",{onClick:xe,className:"flex-1 bg-gray-300 text-gray-700 py-2 rounded-lg hover:bg-gray-400 transition-colors",children:"Fechar"})})]})}),b.length>0&&!me&&e.jsx("div",{className:"fixed bottom-6 right-6 z-40",children:e.jsxs("button",{onClick:Te,className:"bg-gradient-to-r from-orange-500 to-red-500 text-white rounded-full p-4 shadow-lg hover:shadow-xl transform hover:scale-110 transition-all duration-200 flex items-center space-x-2 animate-bounce",title:`${b.length} pedidos aguardando pagamento`,children:[e.jsxs("div",{className:"relative",children:[e.jsx(m0,{className:"h-6 w-6"}),e.jsx("div",{className:"absolute -top-2 -right-2 h-5 w-5 bg-white rounded-full flex items-center justify-center",children:e.jsx("span",{className:"text-orange-600 text-xs font-bold",children:b.length})})]}),e.jsx("span",{className:"hidden sm:block font-medium",children:"Pedidos Pendentes"})]})})]})},rB=()=>e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsxs("div",{className:"flex justify-between items-center mb-8",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Relatórios de Caixa"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Análise detalhada das operações financeiras"})]}),e.jsxs("button",{className:"bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 flex items-center space-x-2",children:[e.jsx(qc,{className:"h-5 w-5"}),e.jsx("span",{children:"Exportar"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Filtros"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Período"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{children:"Hoje"}),e.jsx("option",{children:"Esta Semana"}),e.jsx("option",{children:"Este Mês"}),e.jsx("option",{children:"Personalizado"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Funcionário"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{children:"Todos"}),e.jsx("option",{children:"João Silva"}),e.jsx("option",{children:"Maria Santos"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Método de Pagamento"}),e.jsxs("select",{className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{children:"Todos"}),e.jsx("option",{children:"Dinheiro"}),e.jsx("option",{children:"Cartão"}),e.jsx("option",{children:"PIX"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{className:"w-full bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700",children:"Aplicar Filtros"})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:e.jsx(Sa,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Vendas Totais"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"R$ 12.450,00"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-full",children:e.jsx(bg,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Transações"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"247"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-full",children:e.jsx(Mr,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Sessões"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"8"})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"bg-orange-100 p-3 rounded-full",children:e.jsx(Sa,{className:"h-6 w-6 text-orange-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Ticket Médio"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:"R$ 50,40"})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Vendas por Dia"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Gráfico de vendas diárias (a implementar)"})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Métodos de Pagamento"}),e.jsx("div",{className:"h-64 bg-gray-100 rounded flex items-center justify-center",children:e.jsx("p",{className:"text-gray-500",children:"Gráfico de pizza (a implementar)"})})]})]})]}),nB=()=>e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsx("div",{className:"flex justify-between items-center mb-8",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Histórico de Transações"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Todas as transações registradas no sistema"})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-8",children:e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between space-y-4 md:space-y-0 md:space-x-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(Xa,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 h-5 w-5"}),e.jsx("input",{type:"text",placeholder:"Buscar por cliente, valor, método...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500"})]})}),e.jsxs("div",{className:"flex space-x-3",children:[e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[e.jsx(vg,{className:"h-4 w-4"}),e.jsx("span",{children:"Filtros"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[e.jsx(Mr,{className:"h-4 w-4"}),e.jsx("span",{children:"Período"})]}),e.jsxs("button",{className:"flex items-center space-x-2 px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:[e.jsx(eR,{className:"h-4 w-4"}),e.jsx("span",{children:"Ordenar"})]})]})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data/Hora"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Tipo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cliente"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Método"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Valor"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Funcionário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsxs("tbody",{className:"bg-white divide-y divide-gray-200",children:[e.jsxs("tr",{children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"08/09/2025 14:30"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Venda"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"Maria Silva"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"PIX"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:"R$ 45,80"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"João Santos"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 inline-flex text-xs leading-5 font-semibold rounded-full bg-green-100 text-green-800",children:"Concluída"})})]}),e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:[e.jsx("p",{children:"Carregando transações..."}),e.jsx("p",{className:"text-sm mt-1",children:"A integração com dados reais será implementada"})]})})]})]})}),e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200 sm:px-6",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Anterior"}),e.jsx("button",{className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50",children:"Próximo"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Mostrando ",e.jsx("span",{className:"font-medium",children:"1"})," até ",e.jsx("span",{className:"font-medium",children:"10"})," de"," ",e.jsx("span",{className:"font-medium",children:"247"})," resultados"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px","aria-label":"Pagination",children:[e.jsx("button",{className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Anterior"}),e.jsx("button",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",children:"1"}),e.jsx("button",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-blue-600 text-sm font-medium text-white",children:"2"}),e.jsx("button",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700 hover:bg-gray-50",children:"3"}),e.jsx("button",{className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50",children:"Próximo"})]})})]})]})]})]}),oB=()=>{const{user:t}=jt(),{currentSession:s,loading:a,error:r}=Rm();return y.useEffect(()=>{console.log("CashTest: Usuário:",t),console.log("CashTest: Sessão atual:",s),console.log("CashTest: Loading:",a),console.log("CashTest: Error:",r)},[t,s,a,r]),e.jsxs("div",{className:"p-6",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Teste de Cash Management"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"p-4 bg-gray-100 rounded",children:[e.jsx("h3",{className:"font-semibold",children:"Usuário:"}),e.jsx("pre",{children:JSON.stringify(t,null,2)})]}),e.jsxs("div",{className:"p-4 bg-gray-100 rounded",children:[e.jsx("h3",{className:"font-semibold",children:"Sessão Atual:"}),e.jsx("pre",{children:JSON.stringify(s,null,2)})]}),e.jsxs("div",{className:"p-4 bg-gray-100 rounded",children:[e.jsx("h3",{className:"font-semibold",children:"Status:"}),e.jsxs("p",{children:["Loading: ",a.toString()]}),e.jsxs("p",{children:["Error: ",r||"Nenhum erro"]})]}),e.jsx("button",{onClick:()=>window.location.reload(),className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Recarregar Página"})]})]})},iB=({onNewOrder:t,onOrderUpdate:s,empresaId:a})=>{const r=y.useCallback(o=>{var l;console.log("💰 REALTIME CAIXA:",o.eventType,(l=o.new)==null?void 0:l.status),o.eventType==="INSERT"&&(console.log("📥 Novo pedido no caixa!"),t==null||t()),o.eventType==="UPDATE"&&(console.log("🔄 Pedido atualizado no caixa"),s==null||s())},[t,s]);y.useEffect(()=>{console.log("🔌 Conectando realtime do caixa...");const o=B.channel("cash-realtime").on("postgres_changes",{event:"*",schema:"public",table:"balcao_orders",filter:a?`empresa_id=eq.${a}`:void 0},r).subscribe(l=>{l==="SUBSCRIBED"?console.log("✅ Realtime do caixa ativo!"):l==="CHANNEL_ERROR"&&console.error("❌ Erro no realtime do caixa")});return()=>{console.log("🔌 Desconectando realtime do caixa"),o.unsubscribe()}},[r,a])},lB=()=>{const{getDailyCashMovement:t}=Rm();iB({onNewOrder:()=>{console.log("🔔 Novo pedido detectado! Recarregando..."),s===pc()&&w(s)},onOrderUpdate:()=>{console.log("🔔 Pedido atualizado! Recarregando..."),s===pc()&&w(s)}});const[s,a]=y.useState(pc()),[r,o]=y.useState(null),[l,c]=y.useState(!1),[u,h]=y.useState(null),[f,p]=y.useState(!0),[g,v]=y.useState(!0),[b,_]=y.useState(!0),w=async S=>{c(!0),h(null);try{const T=await t(S);o(T)}catch(T){const M=T.message||"Erro ao carregar dados do movimento";h(M),console.error("Erro ao carregar movimento diário:",T),o({sessions:[],transactions:[],summary:{opening_total:0,closing_total:0,sales_total:0,cash_sales:0,card_sales:0,pix_sales:0,adjustments:0,discrepancy_total:0,transaction_count:0}})}finally{c(!1)}};y.useEffect(()=>{w(s)},[s]);const E=S=>new Date(S).toLocaleTimeString("pt-BR",{hour:"2-digit",minute:"2-digit"}),k=S=>{const T={open:{bg:"bg-green-100",text:"text-green-800",label:"Aberto"},closed:{bg:"bg-gray-100",text:"text-gray-800",label:"Fechado"},reconciled:{bg:"bg-blue-100",text:"text-blue-800",label:"Reconciliado"}},M=T[S]||T.closed;return e.jsx("span",{className:`px-2 py-1 text-xs font-medium rounded-full ${M.bg} ${M.text}`,children:M.label})},N=S=>({sale:"text-green-600",refund:"text-red-600",adjustment:"text-blue-600",tip:"text-purple-600"})[S]||"text-gray-600",C=({isVisible:S,onClick:T,title:M})=>e.jsxs("button",{onClick:T,className:"flex items-center space-x-1 text-sm text-gray-600 hover:text-gray-800",title:S?`Ocultar ${M}`:`Mostrar ${M}`,children:[S?e.jsx(mn,{className:"h-4 w-4"}):e.jsx(Ys,{className:"h-4 w-4"}),e.jsx("span",{children:S?"Ocultar":"Mostrar"})]});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:e.jsx(Mr,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Movimento do Caixa"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Consulte o movimento detalhado por data"})]})]}),e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsx("input",{type:"date",value:s,onChange:S=>a(S.target.value),className:"px-3 py-2 border border-gray-300 rounded-md focus:ring-2 focus:ring-blue-500 focus:border-blue-500",disabled:l,"aria-label":"Selecione a data"}),e.jsx("button",{onClick:()=>w(s),disabled:l,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:l?"Carregando...":"Consultar"})]})]}),u&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Ya,{className:"h-5 w-5 text-red-600"}),e.jsx("p",{className:"text-red-800",children:u})]})}),l&&e.jsx("div",{className:"text-center py-8",children:e.jsxs("div",{className:"inline-flex items-center space-x-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),e.jsx("span",{className:"text-gray-600",children:"Carregando movimento..."})]})}),r&&!l&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Resumo do Dia"}),e.jsx(C,{isVisible:b,onClick:()=>_(!b),title:"resumo"})]}),b&&e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-green-100 p-3 rounded-lg inline-flex",children:e.jsx(Ut,{className:"h-6 w-6 text-green-600"})}),e.jsx("p",{className:"mt-2 text-sm font-medium text-gray-600",children:"Vendas Totais"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:$e(r.summary.sales_total)})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-blue-100 p-3 rounded-lg inline-flex",children:e.jsx(Ns,{className:"h-6 w-6 text-blue-600"})}),e.jsx("p",{className:"mt-2 text-sm font-medium text-gray-600",children:"Sessões"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.sessions.length})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-purple-100 p-3 rounded-lg inline-flex",children:e.jsx(Sa,{className:"h-6 w-6 text-purple-600"})}),e.jsx("p",{className:"mt-2 text-sm font-medium text-gray-600",children:"Transações"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.summary.transaction_count})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"bg-yellow-100 p-3 rounded-lg inline-flex",children:e.jsx(Ya,{className:"h-6 w-6 text-yellow-600"})}),e.jsx("p",{className:"mt-2 text-sm font-medium text-gray-600",children:"Discrepâncias"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:$e(Math.abs(r.summary.discrepancy_total))})]})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsx("h4",{className:"text-md font-medium text-gray-900 mb-4",children:"Por Método de Pagamento"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Dinheiro"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:$e(r.summary.cash_sales)})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Cartões"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:$e(r.summary.card_sales)})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"PIX"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:$e(r.summary.pix_sales)})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Ajustes"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:$e(r.summary.adjustments)})]})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Sessões do Dia (",r.sessions.length,")"]}),e.jsx(C,{isVisible:f,onClick:()=>p(!f),title:"sessões"})]}),f&&e.jsx("div",{className:"p-6",children:r.sessions.length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"Nenhuma sessão encontrada para esta data"}):e.jsx("div",{className:"space-y-4",children:r.sessions.map(S=>{var T;return e.jsxs("div",{className:"border border-gray-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"bg-blue-100 p-2 rounded-lg",children:e.jsx(Ns,{className:"h-5 w-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:((T=S.employee)==null?void 0:T.name)||"Funcionário"}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Sessão #",S.id.slice(-8)]})]})]}),k(S.status)]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Abertura"}),e.jsx("p",{className:"text-lg font-bold text-green-600",children:$e(S.opening_amount)}),e.jsx("p",{className:"text-xs text-gray-500",children:E(S.opened_at)})]}),S.closed_at&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Fechamento"}),e.jsx("p",{className:"text-lg font-bold text-red-600",children:$e(S.closing_amount||0)}),e.jsx("p",{className:"text-xs text-gray-500",children:E(S.closed_at)})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Esperado"}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:$e(S.expected_amount)})]}),S.cash_discrepancy!==null&&S.cash_discrepancy!==void 0&&e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Discrepância"}),e.jsx("p",{className:`text-lg font-bold ${S.cash_discrepancy>=0?"text-green-600":"text-red-600"}`,children:$e(S.cash_discrepancy)})]})]}),(S.opening_notes||S.closing_notes)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200",children:[S.opening_notes&&e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Obs. Abertura:"})," ",S.opening_notes]}),S.closing_notes&&e.jsxs("p",{className:"text-sm text-gray-600",children:[e.jsx("strong",{children:"Obs. Fechamento:"})," ",S.closing_notes]})]})]},S.id)})})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200",children:[e.jsxs("div",{className:"px-6 py-4 border-b border-gray-200 flex items-center justify-between",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Transações do Dia (",r.transactions.length,")"]}),e.jsx(C,{isVisible:g,onClick:()=>v(!g),title:"transações"})]}),g&&e.jsx("div",{className:"p-6",children:r.transactions.length===0?e.jsx("p",{className:"text-center text-gray-500 py-8",children:"Nenhuma transação encontrada para esta data"}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Horário"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Tipo"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Método"}),e.jsx("th",{className:"text-right py-3 px-4 font-medium text-gray-600",children:"Valor"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Cliente/Obs"}),e.jsx("th",{className:"text-left py-3 px-4 font-medium text-gray-600",children:"Funcionário"})]})}),e.jsx("tbody",{children:r.transactions.map(S=>{var T;return e.jsxs("tr",{className:"border-b border-gray-100 hover:bg-gray-50",children:[e.jsx("td",{className:"py-3 px-4 text-sm text-gray-900",children:E(S.processed_at)}),e.jsx("td",{className:"py-3 px-4",children:e.jsx("span",{className:`text-sm font-medium ${N(S.transaction_type)}`,children:G2[S.transaction_type]||S.transaction_type})}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:Oc[S.payment_method]||S.payment_method}),e.jsx("td",{className:`py-3 px-4 text-right text-sm font-medium ${S.amount>=0?"text-green-600":"text-red-600"}`,children:$e(S.amount)}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:S.comanda?e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium text-blue-600",children:["Comanda #",_m(S.comanda.id)]}),S.comanda.customer_name&&e.jsx("div",{className:"text-xs text-gray-500",children:S.comanda.customer_name}),S.comanda.table_number&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Mesa ",S.comanda.table_number]})]}):S.notes&&(S.notes.includes("Pedido Balcão")||S.notes.includes("Pedido de balcão"))?e.jsxs("div",{children:[e.jsxs("span",{className:"font-medium text-green-600",children:["Pedido Balcão ",B2(S.notes)]}),S.customer_name&&e.jsx("div",{className:"text-xs text-gray-500",children:S.customer_name}),e.jsx("div",{className:"text-xs text-gray-500",children:"Balcão"})]}):S.customer_name||S.notes||"-"}),e.jsx("td",{className:"py-3 px-4 text-sm text-gray-600",children:((T=S.processed_by_employee)==null?void 0:T.name)||"Funcionário"})]},S.id)})})]})})})]})]})]})},cB=()=>e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs(z_,{children:[e.jsx(it,{path:"/",element:e.jsx(aB,{})}),e.jsx(it,{path:"/reports",element:e.jsx(rB,{})}),e.jsx(it,{path:"/transactions",element:e.jsx(nB,{})}),e.jsx(it,{path:"/movement",element:e.jsx(lB,{})}),e.jsx(it,{path:"/test",element:e.jsx(oB,{})})]})});var vS=(t=>(t.ABERTA="aberta",t.PENDENTE_PAGAMENTO="pendente_pagamento",t.FECHADA="fechada",t.CANCELADA="cancelada",t))(vS||{}),Ou=(t=>(t.PENDENTE="pendente",t.PREPARANDO="preparando",t.PRONTO="pronto",t.ENTREGUE="entregue",t.CANCELADO="cancelado",t))(Ou||{});const S_=10,pi=0,gi=30;class Ps{static validatePercentage(s){return s>=pi&&s<=gi&&!isNaN(s)&&isFinite(s)}static calculateCommission(s,a){if(!this.validatePercentage(a))throw new Error(`Percentual de comissão deve estar entre ${pi}% e ${gi}%`);if(s<=0)throw new Error("Valor base deve ser maior que zero");return s*a/100}static calculateTotal(s,a){const r=this.calculateCommission(s,a);return s+r}static calculateWithValidation(s,a){try{if(!this.validatePercentage(a))return{valor_base:s,percentual_comissao:a,valor_comissao:0,valor_total:s,percentual_valido:!1,erro:`Percentual deve estar entre ${pi}% e ${gi}%`};if(s<=0)return{valor_base:s,percentual_comissao:a,valor_comissao:0,valor_total:s,percentual_valido:!1,erro:"Valor base deve ser maior que zero"};const o=this.calculateCommission(s,a),l=s+o;return{valor_base:s,percentual_comissao:a,valor_comissao:o,valor_total:l,percentual_valido:!0}}catch(r){return{valor_base:s,percentual_comissao:a,valor_comissao:0,valor_total:s,percentual_valido:!1,erro:r instanceof Error?r.message:"Erro desconhecido"}}}static validateCommissionData(s,a){const r=[];let o=!0,l;s<=0&&(o=!1,l="Valor base deve ser maior que zero"),this.validatePercentage(a)||(o=!1,l=`Percentual deve estar entre ${pi}% e ${gi}%`,a<pi?r.push(`Percentual mínimo é ${pi}%`):a>gi&&r.push(`Percentual máximo é ${gi}%`)),o&&(a===0?r.push("Comissão zerada - confirme se está correto"):a<5?r.push("Percentual baixo - considere o padrão de 10%"):a>20&&r.push("Percentual alto - verifique se está correto"));const c=o?this.calculateCommission(s,a):0;return{valido:o,percentual:a,valor_calculado:c,mensagem_erro:l,sugestoes:r.length>0?r:void 0}}static calculatePercentageFromAmount(s,a){if(s<=0)throw new Error("Valor base deve ser maior que zero");return a/s*100}static formatCurrency(s){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(s)}static formatPercentage(s){return`${s.toFixed(1)}%`}}Ps.validatePercentage;Ps.calculateCommission;Ps.calculateTotal;Ps.formatCurrency;const dB=({isOpen:t,comanda:s,onClose:a,onConfirm:r,loading:o=!1})=>{var _;const[l,c]=y.useState(S_),[u,h]=y.useState(""),[f,p]=y.useState(),g=Ps.calculateWithValidation(s.total,l);y.useEffect(()=>{t&&(c(S_),h(""),p(void 0))},[t]);const v=w=>{const E=parseFloat(w)||0;c(E),p(void 0)},b=async()=>{try{if(p(void 0),!g.percentual_valido){p(g.erro);return}const w={comanda_id:s.id,valor_base:s.total,percentual_comissao:l,valor_comissao:g.valor_comissao,valor_total:g.valor_total,metodo_pagamento:"dinheiro",observacoes:u.trim()||void 0};await r(w)}catch(w){p(w instanceof Error?w.message:"Erro ao processar fechamento")}};return t?e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(jj,{className:"w-6 h-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Fechamento de Conta"}),e.jsxs("p",{className:"text-sm text-gray-500",children:["Comanda #",_m(s.id),((_=s.mesa)==null?void 0:_.numero)&&` - Mesa ${s.mesa.numero}`]})]})]}),e.jsx("button",{onClick:a,disabled:o,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(nt,{className:"w-5 h-5"})})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"Itens Consumidos"}),s.itens&&s.itens.length>0&&e.jsxs("span",{className:"text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded-full",children:[s.itens.length," ",s.itens.length===1?"item":"itens"]})]}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 max-h-60 overflow-y-auto",children:s.itens&&s.itens.length>0?e.jsxs("div",{className:"space-y-3",children:[s.itens.map((w,E)=>e.jsxs("div",{className:"flex justify-between items-start bg-white rounded-lg p-3 shadow-sm",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs bg-gray-200 text-gray-600 px-2 py-1 rounded-full",children:E+1}),e.jsx("div",{className:"font-medium text-gray-900",children:w.nome_produto})]}),e.jsxs("div",{className:"text-sm text-gray-500 mt-1",children:[e.jsxs("span",{className:"font-medium",children:[w.quantidade,"x"]})," ",Ps.formatCurrency(w.preco_unitario),w.observacoes&&e.jsxs("div",{className:"text-xs text-gray-400 italic mt-1",children:["Obs: ",w.observacoes]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium text-gray-900",children:Ps.formatCurrency(w.preco_total)}),e.jsx("div",{className:"text-xs text-gray-500",children:w.quantidade>1&&`${w.quantidade} unidades`})]})]},w.id)),e.jsx("div",{className:"border-t pt-3 mt-3 bg-white rounded-lg p-3",children:e.jsxs("div",{className:"flex justify-between items-center font-semibold text-gray-900",children:[e.jsx("span",{children:"Subtotal dos Itens"}),e.jsx("span",{className:"text-lg",children:Ps.formatCurrency(s.total)})]})})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("div",{className:"text-gray-400 mb-2",children:e.jsx(jj,{className:"w-12 h-12 mx-auto"})}),e.jsx("p",{className:"text-gray-500",children:"Nenhum item encontrado na comanda"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Verifique se a comanda possui itens adicionados"})]})})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Comissão do Garçom"}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Percentual de Comissão (0% - 30%)"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"number",min:"0",max:"30",step:"0.1",value:l,onChange:w=>v(w.target.value),disabled:o,className:`flex-1 px-3 py-2 border rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 ${g.percentual_valido?"border-gray-300":"border-red-300 bg-red-50"}`,placeholder:"10.0"}),e.jsx("span",{className:"text-sm text-gray-500",children:"%"}),e.jsx("button",{type:"button",onClick:()=>c(0),disabled:o,className:"px-3 py-2 text-sm bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Zerar"})]}),!g.percentual_valido&&g.erro&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:g.erro}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Você pode ajustar o percentual ou zerá-lo completamente"})]}),g.percentual_valido&&e.jsxs("div",{className:"bg-white rounded-lg p-3 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Valor da comissão:"}),e.jsx("span",{className:"font-medium",children:Ps.formatCurrency(g.valor_comissao)})]}),e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Percentual aplicado:"}),e.jsx("span",{className:"font-medium",children:Ps.formatPercentage(g.percentual_comissao)})]})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Observações (opcional)"}),e.jsx("textarea",{value:u,onChange:w=>h(w.target.value),disabled:o,rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Adicione observações sobre o fechamento..."})]}),e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-blue-600 mt-0.5",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-blue-800 mb-1",children:"Envio para Caixa"}),e.jsxs("p",{className:"text-sm text-blue-700",children:["Esta comanda será enviada como ",e.jsx("strong",{children:"pendente de pagamento"})," para o caixa. O operador do caixa escolherá o método de pagamento (dinheiro, cartão, PIX, etc.) no momento do processamento."]})]})]})}),f&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"text-red-600 mt-0.5",children:e.jsx("svg",{className:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-sm font-medium text-red-800 mb-1",children:"Erro no Processamento"}),e.jsx("p",{className:"text-red-700 text-sm",children:f})]})]})})]}),e.jsx("div",{className:"border-t bg-gray-50 p-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white rounded-lg p-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Valor dos itens:"}),e.jsx("span",{children:Ps.formatCurrency(s.total)})]}),g.percentual_valido&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsxs("span",{className:"text-gray-600",children:["Comissão (",Ps.formatPercentage(l),"):"]}),e.jsx("span",{children:Ps.formatCurrency(g.valor_comissao)})]}),e.jsx("div",{className:"border-t pt-2",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Total a Pagar:"}),e.jsx("span",{className:"text-2xl font-bold text-green-600",children:Ps.formatCurrency(g.percentual_valido?g.valor_total:s.total)})]})})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:a,disabled:o,className:"flex-1 px-4 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancelar"}),e.jsx("button",{onClick:b,disabled:o||!g.percentual_valido,className:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 flex items-center justify-center gap-2",children:o?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Enviando para Caixa..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Wi,{className:"w-4 h-4"}),"Fechar e Enviar para Caixa"]})})]})]})})]})}):null},uB=(t={})=>{const[s,a]=y.useState(!1),[r,o]=y.useState(null),[l,c]=y.useState(!1),[u,h]=y.useState(null),f=y.useCallback(b=>{o(b),a(!0),h(null)},[]),p=y.useCallback(()=>{a(!1),o(null),h(null),c(!1)},[]),g=y.useCallback(()=>{h(null)},[]),v=y.useCallback(async b=>{try{c(!0),h(null),console.log("📋 Processando fechamento de comanda:",b),await new Promise(w=>setTimeout(w,1e3));const _={success:!0,data:{transaction_id:`TXN-${Date.now()}`,reference_number:`REF-${Date.now()}`,pending_id:`PEND-${Date.now()}`,total_amount:b.valor_total,commission_amount:b.valor_comissao,payment_method:b.metodo_pagamento,receipt:void 0,processed_at:new Date().toISOString(),additional_data:{status:"pending_payment",message:"Comanda enviada para processamento no caixa"}}};return t.onSuccess&&t.onSuccess(_),setTimeout(()=>{p()},1500),_}catch(_){const w=_ instanceof Error?_:new Error("Erro interno do sistema");return h(w.message),t.onError&&t.onError(w),{success:!1,error:{type:"system",message:w.message,details:{error:w instanceof Error?w.stack:String(w)}}}}finally{c(!1)}},[p,t]);return{isOpen:s,selectedComanda:r,loading:l,error:u,openModal:f,closeModal:p,handleConfirm:v,clearError:g}},mB={id:"CMD-TEST-001",mesa_id:"MESA-05",cliente_id:"CLI-123",nome_cliente:"João Silva",funcionario_id:"FUNC-001",status:"aberta",total:87.5,quantidade_pessoas:4,aberta_em:new Date().toISOString(),created_at:new Date().toISOString(),updated_at:new Date().toISOString(),data_abertura:new Date().toISOString(),mesa:{id:"MESA-05",numero:5,capacidade:6},itens:[{id:"ITEM-001",comanda_id:"CMD-TEST-001",produto_id:"PROD-001",nome_produto:"Bolinho de Bacalhau",quantidade:2,preco_unitario:16.9,preco_total:33.8,status:"entregue",adicionado_em:new Date().toISOString(),entregue_em:new Date().toISOString(),created_at:new Date().toISOString(),observacoes:"Sem cebola"},{id:"ITEM-002",comanda_id:"CMD-TEST-001",produto_id:"PROD-002",nome_produto:"Cerveja Heineken 350ml",quantidade:3,preco_unitario:10.3,preco_total:30.9,status:"entregue",adicionado_em:new Date().toISOString(),entregue_em:new Date().toISOString(),created_at:new Date().toISOString()}]},hB=()=>{const{isOpen:t,selectedComanda:s,loading:a,error:r,openModal:o,closeModal:l,handleConfirm:c,clearError:u}=uB({onSuccess:h=>{console.log("✅ Teste - Modal funcionou:",h),alert("Modal funcionou! Verifique o console.")},onError:h=>{console.error("❌ Teste - Erro no modal:",h),alert(`Erro no modal: ${h.message}`)}});return e.jsxs("div",{className:"p-8",children:[e.jsx("h1",{className:"text-2xl font-bold mb-4",children:"Teste do Novo Modal"}),e.jsx("button",{onClick:()=>o(mB),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Abrir Modal de Teste"}),r&&e.jsx("div",{className:"mt-4 p-4 bg-red-100 border border-red-400 text-red-700 rounded",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("span",{children:["Erro: ",r]}),e.jsx("button",{onClick:u,className:"text-red-600 hover:text-red-800",children:"✕"})]})}),s&&e.jsx(dB,{isOpen:t,comanda:s,onClose:l,onConfirm:c,loading:a})]})},fB=()=>{const{user:t}=jt(),[s,a]=y.useState("empresa"),[r,o]=y.useState(!0),[l,c]=y.useState(!1),[u,h]=y.useState(""),[f,p]=y.useState(""),[g,v]=y.useState({nome:"",cnpj:"",email_admin:"",telefone:"",endereco:{logradouro:"",cidade:"",estado:"",cep:""}});y.useEffect(()=>{(async()=>{if(!t){console.log("🔍 ConfiguracoesEmpresa: Usuário não autenticado");return}try{o(!0),h(""),console.log("🔍 ConfiguracoesEmpresa: Carregando dados para usuário:",t.id,t.email);let w=null;console.log("🔍 ConfiguracoesEmpresa: Buscando na tabela usuarios_empresa...");const{data:E,error:k}=await B.from("usuarios_empresa").select("empresa_id").eq("user_id",t.id).single();if(console.log("🔍 ConfiguracoesEmpresa: Resultado usuarios_empresa:",{usuarioEmpresa:E,userError:k}),E!=null&&E.empresa_id)w=E.empresa_id,console.log("✅ ConfiguracoesEmpresa: Empresa encontrada via usuarios_empresa:",w);else{console.log("⚠️ ConfiguracoesEmpresa: Não encontrou na usuarios_empresa, tentando por email...");const{data:S,error:T}=await B.from("empresas").select("id").eq("email_admin",t.email).limit(1);console.log("🔍 ConfiguracoesEmpresa: Resultado empresas por email:",{empresasPorEmail:S,emailError:T}),S&&S.length>0&&(w=S[0].id,console.log("✅ ConfiguracoesEmpresa: Empresa encontrada via email:",w))}if(!w){console.error("❌ ConfiguracoesEmpresa: Usuário não está associado a nenhuma empresa"),h("Usuário não está associado a nenhuma empresa. Entre em contato com o suporte.");return}console.log("🔍 ConfiguracoesEmpresa: Carregando dados da empresa:",w);const{data:N,error:C}=await B.from("empresas").select("nome, cnpj, email_admin, telefone, endereco").eq("id",w).single();if(console.log("🔍 ConfiguracoesEmpresa: Resultado dados empresa:",{empresaData:N,empresaError:C}),C){console.error("❌ ConfiguracoesEmpresa: Erro ao carregar dados da empresa:",C),h(`Erro ao carregar dados da empresa: ${C.message}`);return}if(N){const S=N.endereco||{};v({nome:N.nome||"",cnpj:N.cnpj||"",email_admin:N.email_admin||"",telefone:N.telefone||"",endereco:{logradouro:S.logradouro||"",cidade:S.cidade||"",estado:S.estado||"",cep:S.cep||""}})}}catch(w){console.error("Erro ao carregar dados:",w),h("Erro interno ao carregar dados")}finally{o(!1)}})()},[t]);const b=async()=>{if(t)try{c(!0),h(""),p("");const _=await vt();if(!_){h("Erro ao identificar empresa do usuário. Verifique se você está logado corretamente.");return}if(!g.nome.trim()){h("Nome da empresa é obrigatório");return}if(!g.email_admin.trim()){h("Email é obrigatório");return}const w={nome:g.nome.trim(),cnpj:g.cnpj.replace(/[^\d]/g,"")||null,email_admin:g.email_admin.trim(),telefone:g.telefone.trim(),endereco:{logradouro:g.endereco.logradouro.trim(),cidade:g.endereco.cidade.trim(),estado:g.endereco.estado,cep:g.endereco.cep.replace(/[^\d]/g,"")},updated_at:new Date().toISOString()},{error:E}=await B.from("empresas").update(w).eq("id",_);if(E){console.error("Erro ao atualizar empresa:",E),h("Erro ao salvar dados da empresa");return}p("Dados salvos com sucesso!"),setTimeout(()=>p(""),3e3)}catch(_){console.error("Erro ao salvar dados:",_),h("Erro interno ao salvar dados")}finally{c(!1)}};return r?e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Carregando configurações..."})]})}):e.jsx("div",{className:"min-h-screen bg-gray-50 py-8",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Configurações da Empresa"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Configure as informações da sua empresa"})]}),f&&e.jsx("div",{className:"mb-6 rounded-md bg-green-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-green-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-green-800",children:f})})]})}),u&&e.jsx("div",{className:"mb-6 rounded-md bg-red-50 p-4",children:e.jsxs("div",{className:"flex",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("svg",{className:"h-5 w-5 text-red-400",viewBox:"0 0 20 20",fill:"currentColor",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z",clipRule:"evenodd"})})}),e.jsx("div",{className:"ml-3",children:e.jsx("p",{className:"text-sm font-medium text-red-800",children:u})})]})}),e.jsxs("div",{className:"bg-white shadow rounded-lg overflow-hidden",children:[e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"-mb-px flex space-x-8 px-6","aria-label":"Tabs",children:e.jsxs("button",{onClick:()=>a("empresa"),className:`group inline-flex items-center py-4 px-1 border-b-2 font-medium text-sm ${s==="empresa"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx("span",{className:"text-lg mr-2",children:"🏢"}),"Dados da Empresa"]})})}),e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Informações da Empresa"}),e.jsx("p",{className:"text-sm text-gray-600 mb-6",children:"Configure as informações básicas da sua empresa."})]}),e.jsx("button",{onClick:b,disabled:l,className:"inline-flex items-center px-4 py-2 border border-transparent text-sm font-medium rounded-md shadow-sm text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:l?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-2 h-4 w-4 text-white",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Salvando..."]}):"Salvar Dados"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Nome da Empresa *"}),e.jsx("input",{type:"text",value:g.nome,onChange:_=>v(w=>({...w,nome:_.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Digite o nome da empresa",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CNPJ"}),e.jsx("input",{type:"text",value:g.cnpj,onChange:_=>v(w=>({...w,cnpj:_.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"00.000.000/0000-00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),e.jsx("input",{type:"email",value:g.email_admin,onChange:_=>v(w=>({...w,email_admin:_.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"contato@empresa.com",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Telefone"}),e.jsx("input",{type:"tel",value:g.telefone,onChange:_=>v(w=>({...w,telefone:_.target.value})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"(11) 99999-9999"})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Endereço"}),e.jsx("input",{type:"text",value:g.endereco.logradouro,onChange:_=>v(w=>({...w,endereco:{...w.endereco,logradouro:_.target.value}})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Rua, número, bairro"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cidade"}),e.jsx("input",{type:"text",value:g.endereco.cidade,onChange:_=>v(w=>({...w,endereco:{...w.endereco,cidade:_.target.value}})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Nome da cidade"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Estado"}),e.jsxs("select",{value:g.endereco.estado,onChange:_=>v(w=>({...w,endereco:{...w.endereco,estado:_.target.value}})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:[e.jsx("option",{value:"",children:"Selecione o estado"}),e.jsx("option",{value:"AC",children:"Acre"}),e.jsx("option",{value:"AL",children:"Alagoas"}),e.jsx("option",{value:"AP",children:"Amapá"}),e.jsx("option",{value:"AM",children:"Amazonas"}),e.jsx("option",{value:"BA",children:"Bahia"}),e.jsx("option",{value:"CE",children:"Ceará"}),e.jsx("option",{value:"DF",children:"Distrito Federal"}),e.jsx("option",{value:"ES",children:"Espírito Santo"}),e.jsx("option",{value:"GO",children:"Goiás"}),e.jsx("option",{value:"MA",children:"Maranhão"}),e.jsx("option",{value:"MT",children:"Mato Grosso"}),e.jsx("option",{value:"MS",children:"Mato Grosso do Sul"}),e.jsx("option",{value:"MG",children:"Minas Gerais"}),e.jsx("option",{value:"PA",children:"Pará"}),e.jsx("option",{value:"PB",children:"Paraíba"}),e.jsx("option",{value:"PR",children:"Paraná"}),e.jsx("option",{value:"PE",children:"Pernambuco"}),e.jsx("option",{value:"PI",children:"Piauí"}),e.jsx("option",{value:"RJ",children:"Rio de Janeiro"}),e.jsx("option",{value:"RN",children:"Rio Grande do Norte"}),e.jsx("option",{value:"RS",children:"Rio Grande do Sul"}),e.jsx("option",{value:"RO",children:"Rondônia"}),e.jsx("option",{value:"RR",children:"Roraima"}),e.jsx("option",{value:"SC",children:"Santa Catarina"}),e.jsx("option",{value:"SP",children:"São Paulo"}),e.jsx("option",{value:"SE",children:"Sergipe"}),e.jsx("option",{value:"TO",children:"Tocantins"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"CEP"}),e.jsx("input",{type:"text",value:g.endereco.cep,onChange:_=>v(w=>({...w,endereco:{...w.endereco,cep:_.target.value}})),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"00000-000"})]})]})]})})]})]})})};class pB{async createBasicEmployee(s,a){try{const r=await vt();if(!r||r!==a)return{success:!1,error:"Acesso negado: você não tem permissão para esta empresa"};const{data:o,error:l}=await B.from("employees").select("id, email").eq("empresa_id",a).eq("email",s.email).single();if(l&&l.code!=="PGRST116")return console.error("Erro ao verificar email existente:",l),{success:!1,error:"Erro ao verificar email existente"};if(o)return{success:!1,error:"Já existe um funcionário com este email nesta empresa"};const u={employee_code:s.employee_code||`EMP${Date.now().toString().slice(-6)}`,name:s.name,email:s.email,phone:s.phone||null,cpf:s.cpf||null,position_id:s.position_id,department_id:s.department_id,empresa_id:a,status:"active",tem_acesso_sistema:!1,auth_user_id:null,hire_date:new Date().toISOString().split("T")[0]};console.log("🔍 DEBUG - Dados para inserção:",u),console.log("🔍 DEBUG - CPF recebido:",s.cpf);const{data:h,error:f}=await B.from("employees").insert(u).select(`
          *,
          position:positions(name),
          department:departments(name)
        `).single();return f?(console.error("Erro ao criar funcionário básico:",f),{success:!1,error:"Erro ao criar funcionário básico"}):(console.log("✅ DEBUG - Funcionário criado:",h),console.log("✅ DEBUG - CPF no retorno:",h==null?void 0:h.cpf),{success:!0,employee:h})}catch(r){return console.error("Erro inesperado ao criar funcionário básico:",r),{success:!1,error:"Erro inesperado ao criar funcionário básico"}}}async getBasicEmployees(s){try{const a=await vt();if(!a||a!==s)return{success:!1,error:"Acesso negado: você não tem permissão para esta empresa"};const{data:r,error:o}=await B.from("employees").select(`
          id, name, email, phone, cpf, employee_code, status, 
          tem_acesso_sistema, auth_user_id, position_id, department_id,
          created_at, updated_at, hire_date
        `).eq("empresa_id",s).eq("tem_acesso_sistema",!1).eq("status","active").order("name");return o?(console.error("Erro ao buscar funcionários básicos:",o),{success:!1,error:"Erro ao buscar funcionários básicos"}):{success:!0,employees:r}}catch(a){return console.error("Erro inesperado ao buscar funcionários básicos:",a),{success:!1,error:"Erro inesperado ao buscar funcionários básicos"}}}async updateBasicEmployee(s,a,r){try{const o=await vt();if(!o||o!==r)return{success:!1,error:"Acesso negado: você não tem permissão para esta empresa"};const{data:l,error:c}=await B.from("employees").update({name:a.name,email:a.email,phone:a.phone,cpf:a.cpf,position_id:a.position_id,department_id:a.department_id,updated_at:new Date().toISOString()}).eq("id",s).eq("empresa_id",r).select(`
          *,
          position:positions(name),
          department:departments(name)
        `).single();return c?(console.error("Erro ao atualizar funcionário básico:",c),{success:!1,error:"Erro ao atualizar funcionário básico"}):{success:!0,employee:l}}catch(o){return console.error("Erro inesperado ao atualizar funcionário básico:",o),{success:!1,error:"Erro inesperado ao atualizar funcionário básico"}}}}class gB{generateTemporaryPassword(){const s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789@#$%";let a="";a+="ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(Math.random()*26)],a+="abcdefghijklmnopqrstuvwxyz"[Math.floor(Math.random()*26)],a+="0123456789"[Math.floor(Math.random()*10)],a+="@#$%"[Math.floor(Math.random()*4)];for(let r=4;r<12;r++)a+=s[Math.floor(Math.random()*s.length)];return a.split("").sort(()=>Math.random()-.5).join("")}async assignCredentials(s,a){var r,o,l,c;try{const u=await vt();if(!u||u!==a)return{success:!1,error:"Acesso negado: você não tem permissão para esta empresa"};const{data:h,error:f}=await B.from("employees").select(`
          id, name, email, phone, cpf, employee_code, status,
          tem_acesso_sistema, auth_user_id, position_id, department_id,
          created_at, updated_at, hire_date
        `).eq("id",s).eq("empresa_id",a).eq("status","active").single();if(f||!h)return console.error("Funcionário não encontrado:",f),{success:!1,error:"Funcionário não encontrado"};if(h.tem_acesso_sistema&&h.auth_user_id)return{success:!1,error:"Este funcionário já possui credenciais de acesso"};const p=this.generateTemporaryPassword();let g,v;if(Ht){const w=await ut.auth.admin.createUser({email:h.email,password:p,email_confirm:!0,user_metadata:{name:h.name,position:(r=h.position)==null?void 0:r.name,department:(o=h.department)==null?void 0:o.name,empresa_id:a,employee_id:s,tipo_usuario:"funcionario"}});g=w.data,v=w.error}else{const w=await B.auth.signUp({email:h.email,password:p,options:{data:{name:h.name,position:(l=h.position)==null?void 0:l.name,department:(c=h.department)==null?void 0:c.name,empresa_id:a,employee_id:s,tipo_usuario:"funcionario"}}});g=w.data,v=w.error}if(v||!g.user)return console.error("Erro ao criar usuário Auth:",v),{success:!1,error:"Erro ao criar credenciais de acesso"};const{error:b}=await B.from("employees").update({auth_user_id:g.user.id,tem_acesso_sistema:!0,data_credenciais_criadas:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",s).eq("empresa_id",a);if(b){console.error("Erro ao atualizar funcionário:",b);try{await B.auth.admin.deleteUser(g.user.id)}catch(w){console.error("Erro ao limpar usuário Auth:",w)}return{success:!1,error:"Erro ao vincular credenciais ao funcionário"}}const _=null;return{success:!0,credentials:{email:h.email,temporaryPassword:p,authUserId:g.user.id}}}catch(u){return console.error("Erro inesperado ao atribuir credenciais:",u),{success:!1,error:"Erro inesperado ao atribuir credenciais"}}}async removeCredentials(s,a){try{const r=await vt();if(!r||r!==a)return{success:!1,error:"Acesso negado: você não tem permissão para esta empresa"};const{data:o,error:l}=await B.from("employees").select("auth_user_id").eq("id",s).eq("empresa_id",a).single();if(l||!o||!o.auth_user_id)return{success:!1,error:"Funcionário não encontrado ou sem credenciais"};const{error:c}=Ht?await ut.auth.admin.deleteUser(o.auth_user_id):await B.auth.admin.deleteUser(o.auth_user_id);if(c)return console.error("Erro ao remover usuário Auth:",c),{success:!1,error:"Erro ao remover credenciais"};const{error:u}=await B.from("employees").update({auth_user_id:null,tem_acesso_sistema:!1,data_credenciais_criadas:null,updated_at:new Date().toISOString()}).eq("id",s).eq("empresa_id",a);if(u)return console.error("Erro ao atualizar funcionário:",u),{success:!1,error:"Erro ao atualizar funcionário"};const h=null;return{success:!0}}catch(r){return console.error("Erro inesperado ao remover credenciais:",r),{success:!1,error:"Erro inesperado ao remover credenciais"}}}async getEmployeesWithCredentials(s){try{const a=await vt();if(!a||a!==s)return{success:!1,error:"Acesso negado: você não tem permissão para esta empresa"};const{data:r,error:o}=await B.from("employees").select(`
          id, name, email, phone, cpf, employee_code, status,
          tem_acesso_sistema, auth_user_id, position_id, department_id,
          created_at, updated_at, hire_date, data_credenciais_criadas
        `).eq("empresa_id",s).eq("tem_acesso_sistema",!0).eq("status","active").not("auth_user_id","is",null).order("name");return o?(console.error("Erro ao buscar funcionários com credenciais:",o),{success:!1,error:"Erro ao buscar funcionários com credenciais"}):{success:!0,employees:r}}catch(a){return console.error("Erro inesperado ao buscar funcionários com credenciais:",a),{success:!1,error:"Erro inesperado ao buscar funcionários com credenciais"}}}}const xB=t=>{const[s,a]=y.useState({isLoading:!1,error:null,basicEmployees:[],employeesWithCredentials:[]}),r=new pB,o=new gB,l=y.useCallback(w=>{a(E=>({...E,isLoading:w}))},[]),c=y.useCallback(w=>{a(E=>({...E,error:w}))},[]),u=y.useCallback(async w=>{l(!0),c(null);try{const E=await r.createBasicEmployee(w,t);return E.success?await g():c(E.error||"Erro ao criar funcionário"),E}catch{const k="Erro inesperado ao criar funcionário";return c(k),{success:!1,error:k}}finally{l(!1)}},[t]),h=y.useCallback(async w=>{l(!0),c(null);try{const E=await o.assignCredentials(w,t);return E.success?await Promise.all([g(),v()]):c(E.error||"Erro ao atribuir credenciais"),E}catch{const k="Erro inesperado ao atribuir credenciais";return c(k),{success:!1,error:k}}finally{l(!1)}},[t]),f=y.useCallback(async w=>{l(!0),c(null);try{const E=await o.removeCredentials(w,t);return E.success?await Promise.all([g(),v()]):c(E.error||"Erro ao remover credenciais"),E}catch{const k="Erro inesperado ao remover credenciais";return c(k),{success:!1,error:k}}finally{l(!1)}},[t]),p=y.useCallback(async(w,E)=>{l(!0),c(null);try{const k=await r.updateBasicEmployee(w,E,t);return k.success?(await g(),await v()):c(k.error||"Erro ao atualizar funcionário"),k}catch{const N="Erro inesperado ao atualizar funcionário";return c(N),{success:!1,error:N}}finally{l(!1)}},[t]),g=y.useCallback(async()=>{l(!0),c(null);try{const w=await r.getBasicEmployees(t);w.success?a(E=>({...E,basicEmployees:w.employees||[]})):c(w.error||"Erro ao carregar funcionários básicos")}catch{c("Erro inesperado ao carregar funcionários básicos")}finally{l(!1)}},[t]),v=y.useCallback(async()=>{l(!0),c(null);try{const w=await o.getEmployeesWithCredentials(t);w.success?a(E=>({...E,employeesWithCredentials:w.employees||[]})):c(w.error||"Erro ao carregar funcionários com credenciais")}catch{c("Erro inesperado ao carregar funcionários com credenciais")}finally{l(!1)}},[t]),b=y.useCallback(async()=>{l(!0),c(null);try{await Promise.all([g(),v()])}catch{c("Erro ao carregar funcionários")}finally{l(!1)}},[g,v]),_=y.useCallback(()=>{c(null)},[]);return{isLoading:s.isLoading,error:s.error,basicEmployees:s.basicEmployees,employeesWithCredentials:s.employeesWithCredentials,createBasicEmployee:u,updateBasicEmployee:p,loadBasicEmployees:g,assignCredentials:h,removeCredentials:f,loadEmployeesWithCredentials:v,loadAllEmployees:b,clearError:_}};class yB{async getDepartments(){try{const{data:s,error:a}=await B.from("departments").select("id, name").order("name");return a?(console.error("Erro ao buscar departamentos:",a),{success:!1,error:"Erro ao buscar departamentos"}):{success:!0,departments:s}}catch(s){return console.error("Erro inesperado ao buscar departamentos:",s),{success:!1,error:"Erro inesperado ao buscar departamentos"}}}async getPositions(){try{const{data:s,error:a}=await B.from("positions").select(`
          id,
          name,
          department_id,
          department:departments(id, name)
        `).order("name");return a?(console.error("Erro ao buscar posições:",a),{success:!1,error:"Erro ao buscar posições"}):{success:!0,positions:s}}catch(s){return console.error("Erro inesperado ao buscar posições:",s),{success:!1,error:"Erro inesperado ao buscar posições"}}}async getPositionsByDepartment(s){try{const{data:a,error:r}=await B.from("positions").select(`
          id,
          name,
          department_id,
          department:departments(id, name)
        `).eq("department_id",s).order("name");return r?(console.error("Erro ao buscar posições por departamento:",r),{success:!1,error:"Erro ao buscar posições por departamento"}):{success:!0,positions:a}}catch(a){return console.error("Erro inesperado ao buscar posições por departamento:",a),{success:!1,error:"Erro inesperado ao buscar posições por departamento"}}}}const bB=({className:t})=>{var pe;const{user:s}=jt(),a=(pe=s==null?void 0:s.user_metadata)==null?void 0:pe.empresa_id,{isLoading:r,error:o,basicEmployees:l,employeesWithCredentials:c,createBasicEmployee:u,assignCredentials:h,removeCredentials:f,updateBasicEmployee:p,loadAllEmployees:g,clearError:v}=xB(a),[b,_]=y.useState("basic"),[w,E]=y.useState(!1),[k,N]=y.useState(!1),[C,S]=y.useState(null),[T,M]=y.useState(null),[$,A]=y.useState(null),[z,R]=y.useState({name:"",email:"",phone:"",cpf:"",position_id:"",department_id:"",employee_code:""}),[L,I]=y.useState([]),[X,ce]=y.useState([]),[J,V]=y.useState([]),Y=new yB;y.useEffect(()=>{a&&(g(),ee())},[a,g]);const ee=async()=>{try{const[P,q]=await Promise.all([Y.getDepartments(),Y.getPositions()]);P.success&&P.departments&&I(P.departments),q.success&&q.positions&&(ce(q.positions),V(q.positions))}catch(P){console.error("Erro ao carregar departamentos e posições:",P)}},we=P=>{if(R(q=>({...q,department_id:P,position_id:""})),P){const q=X.filter(Q=>Q.department_id===P);V(q)}else V(X)},D=async P=>{P.preventDefault();try{const q=await u(z);q.success&&(E(!1),oe(),console.log("✅ Funcionário criado com sucesso:",q.employee))}catch(q){console.error("Erro ao criar funcionário:",q)}},H=async P=>{try{const q=await h(P.id);q.success&&q.credentials&&(M(q.credentials),S(P),N(!0))}catch(q){console.error("Erro ao atribuir credenciais:",q)}},F=async P=>{if(window.confirm(`Tem certeza que deseja remover as credenciais de acesso de ${P.nome_completo}?`))try{await f(P.id)}catch(q){console.error("Erro ao remover credenciais:",q)}},Z=async P=>{if(P.preventDefault(),!!$)try{(await p($.id,z)).success&&(A(null),oe(),E(!1))}catch(q){console.error("Erro ao atualizar funcionário:",q)}},re=P=>{if(A(P),R({name:P.name,email:P.email,phone:P.phone||"",cpf:P.cpf||"",position_id:P.position_id,department_id:P.department_id,employee_code:P.employee_code}),P.department_id){const q=X.filter(Q=>Q.department_id===P.department_id);V(q)}E(!0)},oe=()=>{R({name:"",email:"",phone:"",cpf:"",position_id:"",department_id:"",employee_code:""}),V(X)},ae=()=>{A(null),E(!1),oe()};return a?e.jsxs("div",{className:`bg-white rounded-lg shadow-md ${t}`,children:[e.jsx("div",{className:"border-b border-gray-200 px-6 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-xl font-semibold text-gray-900 flex items-center",children:[e.jsx(Ns,{className:"w-6 h-6 mr-2 text-blue-600"}),"Gestão de Funcionários"]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Sistema de duas etapas: Criar funcionário → Atribuir credenciais"})]}),e.jsxs("button",{onClick:()=>g(),disabled:r,className:"flex items-center px-3 py-2 text-sm bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 disabled:opacity-50",children:[e.jsx(ma,{className:`w-4 h-4 mr-1 ${r?"animate-spin":""}`}),"Atualizar"]})]})}),o&&e.jsx("div",{className:"mx-6 mt-4 bg-red-50 border border-red-200 rounded-md p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx(Ya,{className:"w-5 h-5 text-red-600 mr-2"}),e.jsx("p",{className:"text-red-800",children:o})]}),e.jsx("button",{onClick:v,className:"text-red-600 hover:text-red-800",children:"×"})]})}),e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex space-x-8 px-6",children:[e.jsxs("button",{onClick:()=>_("basic"),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center ${b==="basic"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(Mu,{className:"w-4 h-4 mr-2"}),"Funcionários Básicos",e.jsx("span",{className:"ml-2 bg-gray-100 text-gray-900 py-0.5 px-2.5 rounded-full text-xs",children:l.length})]}),e.jsxs("button",{onClick:()=>_("credentials"),className:`py-4 px-1 border-b-2 font-medium text-sm flex items-center ${b==="credentials"?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[e.jsx(jr,{className:"w-4 h-4 mr-2"}),"Com Credenciais",e.jsx("span",{className:"ml-2 bg-green-100 text-green-900 py-0.5 px-2.5 rounded-full text-xs",children:c.length})]})]})}),e.jsxs("div",{className:"p-6",children:[b==="basic"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Etapa 1: Funcionários Básicos"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Funcionários cadastrados sem credenciais de acesso ao sistema"})]}),e.jsxs("button",{onClick:()=>E(!0),className:"bg-blue-600 text-white px-4 py-2 rounded-md hover:bg-blue-700 transition-colors flex items-center",children:[e.jsx(Mu,{className:"w-4 h-4 mr-2"}),"Novo Funcionário"]})]}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Funcionário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cargo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Telefone"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:l.map(P=>{var q,Q;return e.jsxs(be.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:P.name}),e.jsx("div",{className:"text-sm text-gray-500",children:P.email}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Código: ",P.employee_code]}),P.cpf&&e.jsxs("div",{className:"text-sm text-gray-400",children:["CPF: ",P.cpf]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:((q=P.position)==null?void 0:q.name)||"N/A"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:((Q=P.department)==null?void 0:Q.name)||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:P.phone||"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-yellow-100 text-yellow-800",children:"Sem credenciais"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[e.jsxs("button",{onClick:()=>H(P),className:"bg-green-600 text-white px-3 py-1 rounded text-xs hover:bg-green-700 flex items-center",disabled:r,children:[e.jsx(jr,{className:"w-3 h-3 mr-1"}),"Criar Credenciais"]}),e.jsxs("button",{onClick:()=>re(P),className:"text-blue-600 hover:text-blue-900 flex items-center",children:[e.jsx(lo,{className:"w-3 h-3 mr-1"}),"Editar"]})]})]},P.id)})})]}),l.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(Mu,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-2",children:"Nenhum funcionário básico cadastrado"}),e.jsx("button",{onClick:()=>E(!0),className:"text-blue-600 hover:text-blue-800 text-sm font-medium",children:"Cadastrar primeiro funcionário →"})]})]})]}),b==="credentials"&&e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Etapa 2: Funcionários com Credenciais"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Funcionários que possuem acesso ao sistema"})]})}),e.jsxs("div",{className:"overflow-x-auto",children:[e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Funcionário"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Cargo"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Credenciais Criadas"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Ações"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(P=>{var q,Q;return e.jsxs(be.tr,{initial:{opacity:0},animate:{opacity:1},className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:P.name}),e.jsx("div",{className:"text-sm text-gray-500",children:P.email}),e.jsxs("div",{className:"text-sm text-gray-400",children:["Código: ",P.employee_code]}),P.cpf&&e.jsxs("div",{className:"text-sm text-gray-400",children:["CPF: ",P.cpf]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:((q=P.position)==null?void 0:q.name)||"N/A"}),e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:((Q=P.department)==null?void 0:Q.name)||"N/A"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:P.data_credenciais_criadas?new Date(P.data_credenciais_criadas).toLocaleDateString("pt-BR"):"-"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:[e.jsx(ts,{className:"w-3 h-3 mr-1"}),"Com acesso"]})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium space-x-2",children:[e.jsxs("button",{onClick:()=>re(P),className:"text-blue-600 hover:text-blue-900 flex items-center",children:[e.jsx(lo,{className:"w-3 h-3 mr-1"}),"Editar"]}),e.jsxs("button",{onClick:()=>F(P),className:"text-red-600 hover:text-red-900 flex items-center",disabled:r,children:[e.jsx(Yi,{className:"w-3 h-3 mr-1"}),"Remover Acesso"]})]})]},P.id)})})]}),c.length===0&&e.jsxs("div",{className:"text-center py-8",children:[e.jsx(jr,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500 mb-2",children:"Nenhum funcionário com credenciais ainda"}),e.jsx("p",{className:"text-sm text-gray-400",children:"Crie funcionários básicos primeiro, depois atribua credenciais"})]})]})]})]}),w&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",children:e.jsx("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",children:e.jsxs("div",{className:"mt-3",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:$?"Editar Funcionário":"Novo Funcionário"}),e.jsxs("form",{onSubmit:$?Z:D,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Nome Completo *"}),e.jsx("input",{type:"text",required:!0,value:z.name,onChange:P=>R(q=>({...q,name:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Nome completo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email *"}),e.jsx("input",{type:"email",required:!0,value:z.email,onChange:P=>R(q=>({...q,email:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"email@exemplo.com"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"CPF"}),e.jsx("input",{type:"text",value:z.cpf,onChange:P=>R(q=>({...q,cpf:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"000.000.000-00",maxLength:14})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Telefone"}),e.jsx("input",{type:"tel",value:z.phone,onChange:P=>R(q=>({...q,phone:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"(11) 99999-9999"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Código do Funcionário"}),e.jsx("input",{type:"text",value:z.employee_code,onChange:P=>R(q=>({...q,employee_code:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Deixe vazio para gerar automaticamente"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Departamento *"}),e.jsxs("select",{required:!0,value:z.department_id,onChange:P=>we(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"Selecione um departamento"}),L.map(P=>e.jsx("option",{value:P.id,children:P.name},P.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Posição *"}),e.jsxs("select",{required:!0,value:z.position_id,onChange:P=>R(q=>({...q,position_id:P.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",disabled:!z.department_id,children:[e.jsx("option",{value:"",children:"Selecione uma posição"}),J.map(P=>e.jsx("option",{value:P.id,children:P.name},P.id))]}),!z.department_id&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Selecione um departamento primeiro"})]})]}),e.jsxs("div",{className:"flex justify-end space-x-3 mt-6",children:[e.jsx("button",{type:"button",onClick:ae,className:"px-4 py-2 text-sm font-medium text-gray-700 bg-gray-100 rounded-md hover:bg-gray-200",disabled:r,children:"Cancelar"}),e.jsx("button",{type:"submit",disabled:r,className:"px-4 py-2 text-sm font-medium text-white bg-blue-600 rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:r?"Salvando...":$?"Atualizar":"Criar Funcionário"})]})]})]})})}),k&&T&&C&&e.jsx(T2,{isOpen:k,onClose:()=>{N(!1),M(null),S(null)},credentials:{system:{email:T.email,password:T.temporaryPassword}},employeeName:C.nome_completo})]}):e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-4",children:e.jsx("p",{className:"text-red-800",children:"Erro: Empresa não identificada"})})},vB=()=>e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5},className:"mb-8",children:[e.jsx("div",{className:"flex items-center space-x-4 mb-4",children:e.jsxs(fs,{to:"/",className:"flex items-center text-gray-600 hover:text-gray-800 transition-colors",children:[e.jsx(fo,{className:"w-5 h-5 mr-2"}),"Voltar ao Dashboard"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gestão de Funcionários"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Sistema completo de cadastro e gerenciamento de funcionários com fluxo de duas etapas"})]})]}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.1},className:"grid grid-cols-1 md:grid-cols-2 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-blue-900 mb-2",children:"🎯 Etapa 1: Funcionário Básico"}),e.jsx("p",{className:"text-blue-800 text-sm",children:"Cadastre os dados básicos do funcionário (nome, email, cargo, etc.) sem criar credenciais de acesso ainda."})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-green-900 mb-2",children:"🔐 Etapa 2: Credenciais de Acesso"}),e.jsx("p",{className:"text-green-800 text-sm",children:"Após criar o funcionário básico, atribua credenciais de acesso ao sistema quando necessário."})]})]}),e.jsx(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.2},children:e.jsx(bB,{})}),e.jsxs(be.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,delay:.3},className:"mt-8 bg-gray-50 border border-gray-200 rounded-lg p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"💡 Como usar o sistema"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Fluxo Recomendado:"}),e.jsxs("ol",{className:"text-sm text-gray-600 space-y-1 list-decimal list-inside",children:[e.jsx("li",{children:"Cadastre o funcionário básico com dados pessoais"}),e.jsx("li",{children:"Verifique se os dados estão corretos"}),e.jsx("li",{children:'Clique em "Criar Credenciais" quando necessário'}),e.jsx("li",{children:"Entregue as credenciais geradas ao funcionário"}),e.jsx("li",{children:"O funcionário deve alterar a senha no primeiro acesso"})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-800 mb-2",children:"Vantagens do Sistema:"}),e.jsxs("ul",{className:"text-sm text-gray-600 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"Controle total sobre quem tem acesso ao sistema"}),e.jsx("li",{children:"Possibilidade de cadastrar funcionários sem dar acesso imediato"}),e.jsx("li",{children:"Credenciais seguras geradas automaticamente"}),e.jsx("li",{children:"Fácil remoção de acesso quando necessário"}),e.jsx("li",{children:"Histórico completo de criação de credenciais"})]})]})]})]})]})});vS.ABERTA,Ou.ENTREGUE,Ou.ENTREGUE,Ou.ENTREGUE;new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString(),new Date().toISOString();const wB=()=>{const t=[{tableNumber:5,expected:"Mesa 5"},{tableNumber:"10",expected:"Mesa 10"},{tableNumber:null,expected:"Balcão"},{tableNumber:void 0,expected:"Balcão"},{tableNumber:"",expected:"Balcão"}];return e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-lg",children:[e.jsx("h2",{className:"text-xl font-semibold mb-4",children:"Teste de Formatação Mesa/Balcão"}),e.jsx("div",{className:"space-y-3",children:t.map((s,a)=>{const r=Og(s.tableNumber),o=r===s.expected;return e.jsx("div",{className:`p-3 rounded border ${o?"bg-green-50 border-green-200":"bg-red-50 border-red-200"}`,children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Input:"})," ",JSON.stringify(s.tableNumber)]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Resultado:"}),e.jsx("span",{className:`ml-2 px-2 py-1 rounded text-sm ${o?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:r})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium",children:"Esperado:"})," ",s.expected]}),e.jsx("div",{children:o?e.jsx("span",{className:"text-green-600 font-bold",children:"✓"}):e.jsx("span",{className:"text-red-600 font-bold",children:"✗"})})]})},a)})}),e.jsxs("div",{className:"mt-6 p-4 bg-blue-50 border border-blue-200 rounded",children:[e.jsx("h3",{className:"font-semibold text-blue-800 mb-2",children:"Exemplos de Uso:"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{children:[e.jsx("code",{children:"formatTableDisplay(5)"})," → ",e.jsx("strong",{children:"Mesa 5"})]}),e.jsxs("div",{children:[e.jsx("code",{children:"formatTableDisplay('10')"})," → ",e.jsx("strong",{children:"Mesa 10"})]}),e.jsxs("div",{children:[e.jsx("code",{children:"formatTableDisplay(null)"})," → ",e.jsx("strong",{children:"Balcão"})]}),e.jsxs("div",{children:[e.jsx("code",{children:"formatTableDisplay(undefined)"})," → ",e.jsx("strong",{children:"Balcão"})]})]})]})]})},jB=()=>{const[t,s]=y.useState(null),[a,r]=y.useState(!1),[o,l]=y.useState(null),c=async()=>{r(!0),l(null),s(null);try{console.log("Testing bar_tables connection...");const{data:h,error:f}=await B.from("bar_tables").select("*").limit(5);if(console.log("Tables query result:",{tables:h,tablesError:f}),f)throw new Error(`Erro na consulta: ${f.message}`);const{data:p,error:g}=await B.rpc("get_table_info",{table_name:"bar_tables"}).single();console.log("Table info result:",{tableInfo:p,infoError:g}),s({tablesCount:(h==null?void 0:h.length)||0,tables:h||[],tableExists:!f,error:(f==null?void 0:f.message)||null})}catch(h){console.error("Test error:",h),l(h instanceof Error?h.message:"Erro desconhecido")}finally{r(!1)}},u=async()=>{r(!0),l(null);try{const{data:h,error:f}=await B.from("empresas").select("id").limit(1);if(f||!h||h.length===0)throw new Error("Nenhuma empresa encontrada para teste");const{data:p,error:g}=await B.from("bar_tables").insert({number:"TEST-1",capacity:4,status:"available",position_x:100,position_y:100,notes:"Mesa de teste",empresa_id:h[0].id}).select().single();if(g)throw g;console.log("Table created:",p),alert("Mesa de teste criada com sucesso!"),c()}catch(h){console.error("Create error:",h),l(h instanceof Error?h.message:"Erro ao criar mesa")}finally{r(!1)}};return y.useEffect(()=>{c()},[]),e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-lg max-w-2xl mx-auto",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Teste de Conexão - bar_tables"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("button",{onClick:c,disabled:a,className:"bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:a?"Testando...":"Testar Conexão"}),e.jsx("button",{onClick:u,disabled:a,className:"bg-green-600 text-white py-2 px-4 rounded-lg hover:bg-green-700 disabled:opacity-50 ml-2",children:a?"Criando...":"Criar Mesa de Teste"}),o&&e.jsxs("div",{className:"p-3 bg-red-100 text-red-800 rounded-lg border border-red-200",children:[e.jsx("strong",{children:"Erro:"})," ",o]}),t&&e.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg",children:[e.jsx("h3",{className:"font-semibold mb-2",children:"Resultado do Teste:"}),e.jsx("pre",{className:"text-sm overflow-auto",children:JSON.stringify(t,null,2)})]})]})]})},_B=()=>{const[t,s]=y.useState(!1),[a,r]=y.useState(""),o=async()=>{s(!0),r("");try{const{data:l,error:c}=await B.from("bar_tables").select("id").limit(1);if(c&&c.code==="42P01"){r("Tabela bar_tables não encontrada. Criando...");const f=`
          CREATE TABLE IF NOT EXISTS public.bar_tables (
              id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
              number VARCHAR(50) NOT NULL UNIQUE,
              capacity INTEGER NOT NULL CHECK (capacity > 0),
              status VARCHAR(20) DEFAULT 'available' CHECK (status IN ('available', 'occupied', 'reserved', 'cleaning', 'maintenance')),
              position_x INTEGER DEFAULT 100,
              position_y INTEGER DEFAULT 100,
              notes TEXT,
              created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
              updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
          );
        `,{error:p}=await B.rpc("exec_sql",{sql:f});if(p)throw new Error(`Erro ao criar tabela: ${p.message}`);r("Tabela bar_tables criada com sucesso!")}else{if(c)throw c;r(`Tabela bar_tables já existe. Encontradas ${(l==null?void 0:l.length)||0} mesas.`)}const{data:u,error:h}=await B.from("bar_tables").select("*");if(h)throw h;if(!u||u.length===0){r(g=>g+`

Nenhuma mesa encontrada. Criando mesas de exemplo...`);const f=[{number:"1",capacity:2,status:"available",position_x:100,position_y:100},{number:"2",capacity:4,status:"available",position_x:200,position_y:100},{number:"3",capacity:2,status:"available",position_x:300,position_y:100},{number:"4",capacity:6,status:"available",position_x:400,position_y:100},{number:"5",capacity:4,status:"available",position_x:100,position_y:200},{number:"6",capacity:2,status:"available",position_x:200,position_y:200},{number:"7",capacity:8,status:"available",position_x:300,position_y:200},{number:"8",capacity:4,status:"available",position_x:400,position_y:200},{number:"9",capacity:2,status:"available",position_x:100,position_y:300},{number:"10",capacity:6,status:"available",position_x:200,position_y:300}],{error:p}=await B.from("bar_tables").insert(f);if(p)throw p;r(g=>g+`

${f.length} mesas de exemplo criadas com sucesso!`)}else r(f=>f+`

Encontradas ${u.length} mesas no sistema.`)}catch(l){console.error("Erro ao inicializar tabelas:",l),r(`Erro: ${l.message}`)}finally{s(!1)}};return e.jsxs("div",{className:"p-6 bg-white rounded-lg shadow-lg max-w-2xl mx-auto",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Inicializar Sistema de Mesas"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600",children:"Este utilitário verifica se a tabela bar_tables existe e cria mesas de exemplo se necessário."}),e.jsx("button",{onClick:o,disabled:t,className:"bg-blue-600 text-white py-2 px-4 rounded-lg hover:bg-blue-700 disabled:opacity-50",children:t?"Inicializando...":"Inicializar Sistema de Mesas"}),a&&e.jsx("div",{className:`p-4 rounded-lg text-sm whitespace-pre-line ${a.includes("Erro")?"bg-red-100 text-red-800 border border-red-200":"bg-green-100 text-green-800 border border-green-200"}`,children:a})]})]})},NB=()=>{const{config:t,healthStatus:s,performHealthCheck:a,isLoading:r}=jg(),[o,l]=y.useState(!1),[c,u]=y.useState(null),h=t&&t.supabaseUrl!=="https://your-project-dev.supabase.co"&&t.supabaseUrl!=="https://your-project-prod.supabase.co"&&t.supabaseUrl!=="https://mock.supabase.co"&&t.supabaseAnonKey!=="your_development_anon_key_here"&&t.supabaseAnonKey!=="your_production_anon_key_here"&&t.supabaseAnonKey!=="mock-anon-key",f=async()=>{l(!0);try{await a()}finally{l(!1)}},p=async(_,w)=>{try{await navigator.clipboard.writeText(_),u(w),setTimeout(()=>u(null),2e3)}catch(E){console.error("Erro ao copiar:",E)}},g=()=>h?s?s.overall.status==="healthy"?e.jsx(ts,{className:"text-green-500",size:24}):s.overall.status==="degraded"?e.jsx(yt,{className:"text-yellow-500",size:24}):e.jsx(Ia,{className:"text-red-500",size:24}):e.jsx(yt,{className:"text-yellow-500",size:24}):e.jsx(Ia,{className:"text-red-500",size:24}),v=()=>h?s?s.overall.status==="healthy"?"Configuração Perfeita":s.overall.status==="degraded"?"Configuração Parcial":"Configuração com Problemas":"Validação Pendente":"Configuração Necessária",b=()=>h?s?s.overall.status==="healthy"?"border-green-200 bg-green-50":s.overall.status==="degraded"?"border-yellow-200 bg-yellow-50":"border-red-200 bg-red-50":"border-yellow-200 bg-yellow-50":"border-red-200 bg-red-50";return e.jsxs("div",{className:`border rounded-lg p-6 ${b()}`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[g(),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Status da Configuração Supabase"}),e.jsx("p",{className:"text-sm text-gray-600",children:v()})]})]}),e.jsxs("button",{onClick:f,disabled:o||r,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(ma,{size:16,className:o?"animate-spin":""}),e.jsx("span",{children:"Validar"})]})]}),t&&e.jsx("div",{className:"space-y-3 mb-4",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"URL do Projeto:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[h&&t.supabaseUrl.includes(".supabase.co")?e.jsx(ts,{size:16,className:"text-green-500"}):e.jsx(Ia,{size:16,className:"text-red-500"}),e.jsx("span",{className:"font-mono text-xs",children:t.supabaseUrl.length>30?`${t.supabaseUrl.substring(0,30)}...`:t.supabaseUrl})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Chave Anônima:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[h&&t.supabaseAnonKey.length>50?e.jsx(ts,{size:16,className:"text-green-500"}):e.jsx(Ia,{size:16,className:"text-red-500"}),e.jsx("span",{className:"font-mono text-xs",children:t.supabaseAnonKey.length>20?`${t.supabaseAnonKey.substring(0,20)}...`:t.supabaseAnonKey})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Chave de Serviço:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[t.supabaseServiceRoleKey&&t.supabaseServiceRoleKey!=="mock-service-role-key"&&t.supabaseServiceRoleKey.length>50?e.jsx(ts,{size:16,className:"text-green-500"}):e.jsx(yt,{size:16,className:"text-yellow-500"}),e.jsx("span",{className:"font-mono text-xs",children:t.supabaseServiceRoleKey&&t.supabaseServiceRoleKey.length>20?`${t.supabaseServiceRoleKey.substring(0,20)}...`:"Não configurada"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Ambiente:"}),e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium ${t.name==="production"?"bg-red-100 text-red-700":"bg-green-100 text-green-700"}`,children:t.name==="production"?"PRODUÇÃO":"DESENVOLVIMENTO"})]})]})}),s&&e.jsxs("div",{className:"border-t pt-4 mb-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Status dos Serviços"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:[{name:"Database",status:s.database},{name:"Auth",status:s.auth},{name:"Storage",status:s.storage},{name:"Realtime",status:s.realtime}].map(({name:_,status:w})=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 bg-white rounded border",children:[w.isConnected?e.jsx(ts,{size:14,className:"text-green-500"}):e.jsx(Ia,{size:14,className:"text-red-500"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium",children:_}),e.jsx("div",{className:"text-xs text-gray-500",children:w.isConnected?`${w.responseTime}ms`:"Falha"})]})]},_))})]}),!h&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium text-gray-900 mb-3",children:"Como Configurar:"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("span",{children:"1."}),e.jsx("span",{children:"Acesse o"}),e.jsxs("a",{href:"https://supabase.com/dashboard",target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:text-blue-800 flex items-center space-x-1",children:[e.jsx("span",{children:"Dashboard do Supabase"}),e.jsx(qR,{size:12})]})]}),e.jsx("div",{children:"2. Selecione seu projeto → Settings → API"}),e.jsx("div",{children:"3. Configure o arquivo .env.local com suas credenciais:"})]}),e.jsxs("div",{className:"mt-3 bg-gray-800 text-green-400 p-3 rounded font-mono text-xs relative",children:[e.jsx("button",{onClick:()=>p(`VITE_SUPABASE_URL=https://seu-projeto.supabase.co
VITE_SUPABASE_ANON_KEY=sua_chave_anonima
VITE_SUPABASE_SERVICE_ROLE_KEY=sua_chave_service_role`,"config"),className:"absolute top-2 right-2 text-gray-400 hover:text-white",title:"Copiar configuração",children:c==="config"?e.jsx(Hu,{size:14}):e.jsx(La,{size:14})}),e.jsx("pre",{children:`VITE_SUPABASE_URL=https://seu-projeto.supabase.co
VITE_SUPABASE_ANON_KEY=sua_chave_anonima
VITE_SUPABASE_SERVICE_ROLE_KEY=sua_chave_service_role`})]}),e.jsx("div",{className:"mt-2 text-xs text-gray-600",children:"4. Recarregue a página após configurar"})]}),s&&e.jsx("div",{className:"border-t pt-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Score Geral:"}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:`w-16 h-2 rounded-full ${s.overall.score>=80?"bg-green-200":s.overall.score>=50?"bg-yellow-200":"bg-red-200"}`,children:e.jsx("div",{className:`h-full rounded-full ${s.overall.score>=80?"bg-green-500":s.overall.score>=50?"bg-yellow-500":"bg-red-500"}`,style:{width:`${s.overall.score}%`}})}),e.jsxs("span",{className:"text-sm font-medium",children:[s.overall.score,"%"]})]})]})})]})},SB=()=>{const{config:t,environment:s,isConnected:a,healthStatus:r,isLoading:o,error:l,switchEnvironment:c,performHealthCheck:u,getSystemInfo:h}=jg(),[f,p]=y.useState(null),[g,v]=y.useState(!1),b=async()=>{await u()},_=async()=>{const E=s==="development"?"production":"development";window.confirm(`Tem certeza que deseja trocar para ${E}?`)&&await c(E)},w=async()=>{v(!0);try{const E=await h();p(E)}catch(E){console.error("Erro ao obter informações do sistema:",E)}finally{v(!1)}};return o?e.jsx("div",{className:"p-6 bg-white rounded-lg shadow",children:e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(ma,{className:"animate-spin",size:20}),e.jsx("span",{children:"Carregando configurações..."})]})}):l&&!t?e.jsx("div",{className:"p-6 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center space-x-2 text-red-700",children:[e.jsx(yt,{size:20}),e.jsxs("span",{children:["Erro: ",l]})]})}):e.jsxs("div",{className:"space-y-6",children:[e.jsx(NB,{}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h2",{className:"text-xl font-semibold flex items-center space-x-2",children:[e.jsx(io,{size:24}),e.jsx("span",{children:"Configurações de Ambiente"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:b,disabled:o,className:"flex items-center space-x-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50",children:[e.jsx(ma,{size:16,className:o?"animate-spin":""}),e.jsx("span",{children:"Verificar Saúde"})]}),e.jsxs("button",{onClick:_,disabled:o,className:"flex items-center space-x-2 px-4 py-2 bg-gray-600 text-white rounded hover:bg-gray-700 disabled:opacity-50",children:[e.jsx(hc,{size:16}),e.jsx("span",{children:"Trocar Ambiente"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(hc,{size:20,className:"text-blue-600"}),e.jsx("span",{className:"font-medium",children:"Ambiente Atual"})]}),e.jsx("div",{className:`text-lg font-bold ${s==="production"?"text-red-600":"text-green-600"}`,children:s==="production"?"PRODUÇÃO":"DESENVOLVIMENTO"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[a?e.jsx(ts,{size:20,className:"text-green-600"}):e.jsx(Ia,{size:20,className:"text-red-600"}),e.jsx("span",{className:"font-medium",children:"Conectividade"})]}),e.jsx("div",{className:`text-lg font-bold ${a?"text-green-600":"text-red-600"}`,children:a?"CONECTADO":"DESCONECTADO"})]}),e.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[e.jsxs("div",{className:"flex items-center space-x-2 mb-2",children:[e.jsx(hc,{size:20,className:"text-purple-600"}),e.jsx("span",{className:"font-medium",children:"Banco de Dados"})]}),e.jsx("div",{className:"text-lg font-bold text-purple-600",children:(t==null?void 0:t.databaseName)||"N/A"})]})]}),t&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Configurações Detalhadas"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"URL do Supabase:"}),e.jsx("div",{className:"font-mono bg-gray-100 p-2 rounded mt-1 break-all",children:t.supabaseUrl})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Chave Anônima:"}),e.jsx("div",{className:"font-mono bg-gray-100 p-2 rounded mt-1",children:t.supabaseAnonKey?`${t.supabaseAnonKey.substring(0,20)}...`:"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Modo Debug:"}),e.jsx("div",{className:`font-medium mt-1 ${t.debugMode?"text-green-600":"text-gray-600"}`,children:t.debugMode?"Ativo":"Inativo"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Nível de Log:"}),e.jsx("div",{className:"font-medium mt-1 text-blue-600",children:t.logLevel.toUpperCase()})]})]})]})]}),r&&e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"font-semibold mb-4",children:"Status dos Serviços"}),e.jsx("div",{className:"mb-4",children:e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"font-medium",children:"Status Geral"}),e.jsxs("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${r.overall.status==="healthy"?"bg-green-100 text-green-800":r.overall.status==="degraded"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:[r.overall.status.toUpperCase()," (",r.overall.score,"%)"]})]})}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[{name:"Database",status:r.database},{name:"Auth",status:r.auth},{name:"Storage",status:r.storage},{name:"Realtime",status:r.realtime}].map(({name:E,status:k})=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded",children:[e.jsx("span",{className:"font-medium",children:E}),e.jsxs("div",{className:"flex items-center space-x-2",children:[k.isConnected?e.jsx(ts,{size:16,className:"text-green-600"}):e.jsx(Ia,{size:16,className:"text-red-600"}),e.jsx("span",{className:`text-sm ${k.isConnected?"text-green-600":"text-red-600"}`,children:k.isConnected?"OK":"Falha"}),k.responseTime&&e.jsxs("span",{className:"text-xs text-gray-500",children:["(",k.responseTime,"ms)"]})]})]},E))})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"font-semibold",children:"Informações do Sistema"}),e.jsxs("button",{onClick:w,disabled:g,className:"flex items-center space-x-2 px-3 py-1 bg-gray-100 text-gray-700 rounded hover:bg-gray-200 disabled:opacity-50",children:[e.jsx(ma,{size:14,className:g?"animate-spin":""}),e.jsx("span",{children:"Atualizar"})]})]}),f?e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Ambiente:"}),e.jsx("span",{className:"font-medium",children:f.environment})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Branch Git:"}),e.jsx("span",{className:"font-mono",children:f.branch})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Banco:"}),e.jsx("span",{className:"font-mono",children:f.database})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Inicializado:"}),e.jsx("span",{className:f.initialized?"text-green-600":"text-red-600",children:f.initialized?"Sim":"Não"})]})]}):e.jsx("p",{className:"text-gray-500 text-sm",children:'Clique em "Atualizar" para obter informações do sistema'})]})]})};function EB(t={}){const{immediate:s=!1,onNeedRefresh:a,onOfflineReady:r,onRegistered:o,onRegisteredSW:l,onRegisterError:c}=t;let u,h;const f=async(g=!0)=>{await h};async function p(){if("serviceWorker"in navigator){if(u=await ha(async()=>{const{Workbox:g}=await import("./workbox-window.prod.es5-B9K5rw8f.js");return{Workbox:g}},[]).then(({Workbox:g})=>new g("/sw.js",{scope:"/",type:"classic"})).catch(g=>{c==null||c(g)}),!u)return;u.addEventListener("activated",g=>{(g.isUpdate||g.isExternal)&&window.location.reload()}),u.addEventListener("installed",g=>{g.isUpdate||r==null||r()}),u.register({immediate:s}).then(g=>{l?l("/sw.js",g):o==null||o(g)}).catch(g=>{c==null||c(g)})}}return h=p(),f}function CB(t={}){const{immediate:s=!0,onNeedRefresh:a,onOfflineReady:r,onRegistered:o,onRegisteredSW:l,onRegisterError:c}=t,[u,h]=y.useState(!1),[f,p]=y.useState(!1),[g]=y.useState(()=>EB({immediate:s,onOfflineReady(){p(!0),r==null||r()},onNeedRefresh(){h(!0),a==null||a()},onRegistered:o,onRegisteredSW:l,onRegisterError:c}));return{needRefresh:[u,h],offlineReady:[f,p],updateServiceWorker:g}}const TB=()=>{const[t,s]=y.useState(!1),{offlineReady:[a,r],needRefresh:[o,l],updateServiceWorker:c}=CB({onRegistered(f){console.log("✅ Service Worker registrado")},onRegisterError(f){console.error("❌ Erro ao registrar Service Worker:",f)}});y.useEffect(()=>{(a||o)&&s(!0)},[a,o]);const u=()=>{s(!1),r(!1),l(!1)},h=()=>{c(!0)};return t?e.jsx(Ws,{children:e.jsx(be.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},className:"fixed bottom-4 right-4 z-50 max-w-sm",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-2xl border border-gray-200 p-4",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:e.jsx(ma,{className:"text-blue-600",size:20})}),e.jsx("div",{children:e.jsx("h3",{className:"font-semibold text-gray-900",children:o?"Atualização Disponível":"App Pronto para Offline"})})]}),e.jsx("button",{onClick:u,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(nt,{size:20})})]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:o?"Uma nova versão do ClubManager está disponível. Atualize para obter as últimas funcionalidades.":"O ClubManager está pronto para funcionar offline!"}),e.jsxs("div",{className:"flex space-x-2",children:[o&&e.jsx("button",{onClick:h,className:"flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium text-sm",children:"Atualizar Agora"}),e.jsx("button",{onClick:u,className:"flex-1 bg-gray-100 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-200 transition-colors font-medium text-sm",children:o?"Mais Tarde":"Entendi"})]})]})})}):null},kB=()=>{const[t,s]=y.useState(null),[a,r]=y.useState(!1),[o,l]=y.useState(!1);y.useEffect(()=>{if(window.matchMedia("(display-mode: standalone)").matches){l(!0);return}const h=localStorage.getItem("pwa-install-prompt-seen");if(localStorage.getItem("pwa-install-declined"))return;const p=v=>{v.preventDefault(),s(v),h||setTimeout(()=>{r(!0),localStorage.setItem("pwa-install-prompt-seen","true")},3e4)},g=()=>{console.log("✅ PWA instalado com sucesso!"),l(!0),r(!1),localStorage.setItem("pwa-installed","true")};return window.addEventListener("beforeinstallprompt",p),window.addEventListener("appinstalled",g),()=>{window.removeEventListener("beforeinstallprompt",p),window.removeEventListener("appinstalled",g)}},[]);const c=async()=>{if(t)try{await t.prompt();const{outcome:h}=await t.userChoice;h==="accepted"?console.log("✅ Usuário aceitou instalar o PWA"):(console.log("❌ Usuário recusou instalar o PWA"),localStorage.setItem("pwa-install-declined","true")),s(null),r(!1)}catch(h){console.error("Erro ao instalar PWA:",h)}},u=()=>{r(!1),localStorage.setItem("pwa-install-declined","true")};return o||!t||!a?null:e.jsx(Ws,{children:e.jsx(be.div,{initial:{opacity:0,scale:.9},animate:{opacity:1,scale:1},exit:{opacity:0,scale:.9},className:"fixed bottom-4 left-4 right-4 md:left-auto md:right-4 md:max-w-md z-50",children:e.jsxs("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 rounded-lg shadow-2xl p-5 text-white",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center space-x-3",children:[e.jsx("div",{className:"p-2 bg-white bg-opacity-20 rounded-lg",children:e.jsx(fn,{size:24})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-lg",children:"Instalar ClubManager"}),e.jsx("p",{className:"text-blue-100 text-sm",children:"Acesso rápido e offline"})]})]}),e.jsx("button",{onClick:u,className:"text-white hover:bg-white hover:bg-opacity-20 rounded-lg p-1 transition-colors",children:e.jsx(nt,{size:20})})]}),e.jsx("p",{className:"text-sm text-blue-50 mb-4",children:"Instale o ClubManager na sua tela inicial para acesso rápido e funcionalidade offline."}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs("button",{onClick:c,className:"flex-1 bg-white text-blue-600 px-4 py-3 rounded-lg hover:bg-blue-50 transition-colors font-semibold text-sm flex items-center justify-center space-x-2",children:[e.jsx(qc,{size:18}),e.jsx("span",{children:"Instalar App"})]}),e.jsx("button",{onClick:u,className:"px-4 py-3 rounded-lg hover:bg-white hover:bg-opacity-10 transition-colors font-medium text-sm",children:"Agora Não"})]}),e.jsx("div",{className:"mt-3 pt-3 border-t border-white border-opacity-20",children:e.jsxs("ul",{className:"text-xs text-blue-100 space-y-1",children:[e.jsx("li",{children:"✓ Acesso instantâneo da tela inicial"}),e.jsx("li",{children:"✓ Funciona offline"}),e.jsx("li",{children:"✓ Atualizações automáticas"})]})})]})})})},AB=async()=>{console.log("🔍 INICIANDO DEBUG DE TRANSAÇÕES"),console.log("================================");try{const{data:t,error:s}=await B.from("cash_transactions").select("*").order("created_at",{ascending:!1}).limit(10);console.log("📊 Últimas 10 transações no banco:",(t==null?void 0:t.length)||0),t&&t.length>0&&console.table(t.map(f=>({id:f.id.slice(-8),tipo:f.transaction_type,metodo:f.payment_method,valor:f.amount,data:new Date(f.created_at).toLocaleString("pt-BR")})));const a=new Date().toISOString().split("T")[0],{data:r,error:o}=await B.from("cash_transactions").select("*").gte("created_at",`${a}T00:00:00.000Z`).lt("created_at",`${a}T23:59:59.999Z`).order("created_at",{ascending:!1});if(console.log(`📅 Transações de hoje (${a}):`,(r==null?void 0:r.length)||0),r&&r.length>0){console.table(r.map(p=>({id:p.id.slice(-8),tipo:p.transaction_type,metodo:p.payment_method,valor:p.amount,hora:new Date(p.created_at).toLocaleTimeString("pt-BR")})));const f=r.reduce((p,g)=>(g.transaction_type==="sale"&&(p[g.payment_method]||(p[g.payment_method]={valor:0,quantidade:0}),p[g.payment_method].valor+=g.amount,p[g.payment_method].quantidade+=1),p),{});console.log("💰 Totais por método de pagamento:",f)}const{data:l,error:c}=await B.from("cash_sessions").select("*").eq("session_date",a).order("opened_at",{ascending:!1});console.log("🏦 Sessões de caixa de hoje:",(l==null?void 0:l.length)||0),l&&l.length>0&&console.table(l.map(f=>({id:f.id.slice(-8),funcionario:f.employee_id.slice(-8),status:f.status,abertura:f.opening_amount,esperado:f.expected_amount,aberto_em:new Date(f.opened_at).toLocaleTimeString("pt-BR")})));const{data:u,error:h}=await B.from("comandas").select("*").eq("status","pending_payment").limit(5);return console.log("📋 Comandas pendentes de pagamento:",(u==null?void 0:u.length)||0),console.log("✅ DEBUG CONCLUÍDO"),console.log("=================="),{allTransactions:(t==null?void 0:t.length)||0,todayTransactions:(r==null?void 0:r.length)||0,sessions:(l==null?void 0:l.length)||0,comandas:(u==null?void 0:u.length)||0}}catch(t){return console.error("❌ Erro no debug:",t),null}},MB=async()=>{console.log("🧪 Criando transação de teste...");try{const t={transaction_type:"sale",payment_method:"dinheiro",amount:50,processed_by:"test-user-id",notes:"Transação de teste para debug"},{data:s,error:a}=await B.from("cash_transactions").insert(t).select().single();if(a)throw a;return console.log("✅ Transação de teste criada:",s),s}catch(t){return console.error("❌ Erro ao criar transação de teste:",t),null}},RB=async()=>{console.log("🔍 Verificando notas das transações...");try{const{data:t,error:s}=await B.from("cash_transactions").select("id, notes, created_at, amount, payment_method").order("created_at",{ascending:!1}).limit(10);if(s)throw s;return console.log("📋 Últimas transações com notas:"),t==null||t.forEach((a,r)=>{console.log(`${r+1}. ${a.notes} (R$ ${a.amount} - ${a.payment_method})`)}),t}catch(t){return console.error("❌ Erro ao verificar notas:",t),null}},OB=async()=>{console.log("🧪 Testando inserção direta de transação...");try{const t={transaction_type:"sale",payment_method:"dinheiro",amount:25.5,processed_by:"test-user-123",notes:"Teste direto de inserção"};console.log("📋 Dados para inserir:",t);const{data:s,error:a}=await B.from("cash_transactions").insert(t).select().single();return a?(console.error("❌ Erro na inserção:",a),{success:!1,error:a}):(console.log("✅ Transação inserida com sucesso:",s),{success:!0,data:s})}catch(t){return console.error("❌ Erro geral:",t),{success:!1,error:t}}};typeof window<"u"&&(window.debugTransactions=AB,window.createTestTransaction=MB,window.testDirectInsert=OB,window.checkTransactionNotes=RB);const DB=()=>{const{user:t}=jt();if(!t)return e.jsx(Ri,{to:"/login",replace:!0});const s=oD;return e.jsx(rD,{children:e.jsx(s,{children:e.jsxs(iD,{children:[e.jsx(CD,{})," "]})})})},PB=()=>{const{user:t}=jt();return t?e.jsx(Ri,{to:"/",replace:!0}):e.jsx(vD,{})},zB=()=>{const{user:t}=jt();return t?e.jsx(Ri,{to:"/",replace:!0}):e.jsx(wD,{})};function $B(){return e.jsx(N8,{children:e.jsx(SD,{children:e.jsx(n5,{children:e.jsxs(aD,{children:[e.jsx(TB,{}),e.jsx(kB,{}),e.jsxs(z_,{children:[e.jsx(it,{path:"/login",element:e.jsx(PB,{})}),e.jsx(it,{path:"/register",element:e.jsx(zB,{})}),e.jsx(it,{path:"/alterar-senha-provisoria",element:e.jsx(pD,{})}),e.jsxs(it,{element:e.jsx(DB,{}),children:[e.jsx(it,{index:!0,element:e.jsx(Dt,{module:"dashboard",children:e.jsx(b8,{})})}),e.jsx(it,{path:"dashboard/complete",element:e.jsx(Dt,{module:"dashboard",children:e.jsx(_8,{})})}),e.jsx(it,{path:"dashboard/simple",element:e.jsx(Dt,{module:"dashboard",children:e.jsx(m8,{})})}),e.jsx(it,{path:"dashboard/optimized",element:e.jsx(Dt,{module:"dashboard",children:e.jsx(y8,{})})}),e.jsx(it,{path:"bar",element:e.jsx(Dt,{module:"monitor_bar",children:e.jsx(A8,{})})}),e.jsx(it,{path:"bar/pedidos-entregues",element:e.jsx(Dt,{module:"monitor_bar",children:e.jsx(R8,{})})}),e.jsx(it,{path:"bar/attendance",element:e.jsx(Dt,{module:"atendimento_bar",children:e.jsx(k7,{})})}),e.jsx(it,{path:"bar-customers",element:e.jsx(Dt,{module:"clientes",children:e.jsx(O8,{})})}),e.jsx(it,{path:"members",element:e.jsx(Dt,{module:"clientes",children:e.jsx(h$,{})})}),e.jsx(it,{path:"bar-employees",element:e.jsx(Dt,{module:"funcionarios",children:e.jsx(Tz,{})})}),e.jsx(it,{path:"admin/funcionarios",element:e.jsx(Dt,{module:"funcionarios",children:e.jsx(vB,{})})}),e.jsx(it,{path:"kitchen",element:e.jsx(Dt,{module:"monitor_cozinha",children:e.jsx(Qz,{})})}),e.jsx(it,{path:"cash/*",element:e.jsx(Dt,{module:"gestao_caixa",children:e.jsx(cB,{})})}),e.jsx(it,{path:"inventory",element:e.jsx(Dt,{module:"funcionarios",children:e.jsx(n$,{})})}),e.jsx(it,{path:"inventory/movements",element:e.jsx(Dt,{module:"funcionarios",children:e.jsx(d$,{})})}),e.jsx(it,{path:"inventory/estoque-baixo",element:e.jsx(Dt,{module:"funcionarios",children:e.jsx(i$,{})})}),e.jsx(it,{path:"inventory/atualizacao-massiva",element:e.jsx(Dt,{module:"funcionarios",children:e.jsx(l$,{})})}),e.jsx(it,{path:"settings",element:e.jsx(Dt,{module:"configuracoes",children:e.jsx(fB,{})})}),e.jsx(it,{path:"environment",element:e.jsx(Dt,{module:"configuracoes",children:e.jsx(SB,{})})}),e.jsx(it,{path:"test-modal",element:e.jsx(Dt,{module:"configuracoes",children:e.jsx(hB,{})})}),e.jsx(it,{path:"test-table-display",element:e.jsx(Dt,{module:"configuracoes",children:e.jsx(wB,{})})}),e.jsx(it,{path:"test-bar-tables",element:e.jsx(Dt,{module:"configuracoes",children:e.jsx(jB,{})})}),e.jsx(it,{path:"init-bar-tables",element:e.jsx(Dt,{module:"configuracoes",children:e.jsx(_B,{})})})]}),e.jsx(it,{path:"*",element:e.jsx(Ri,{to:"/",replace:!0})})]})]})})})})}FC.createRoot(document.getElementById("root")).render(e.jsx(y.StrictMode,{children:e.jsx($B,{})}));export{vS as C,Ou as I,B as s};
